# Comparing `tmp/pycaret-3.0.0rc9-py3-none-any.whl.zip` & `tmp/pycaret-3.0.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,115 +1,113 @@
-Zip file size: 480147 bytes, number of entries: 113
--rw-rw-r--  2.0 unx      665 b- defN 23-Feb-09 17:34 pycaret/__init__.py
--rw-rw-r--  2.0 unx     4729 b- defN 23-Feb-09 04:08 pycaret/datasets.py
+Zip file size: 483510 bytes, number of entries: 111
+-rw-rw-r--  2.0 unx      634 b- defN 23-May-14 21:24 pycaret/__init__.py
+-rw-rw-r--  2.0 unx     4728 b- defN 23-May-14 21:14 pycaret/datasets.py
 -rw-rw-r--  2.0 unx      162 b- defN 23-Jan-16 18:09 pycaret/distributions.py
 -rw-rw-r--  2.0 unx      805 b- defN 23-Feb-09 04:08 pycaret/anomaly/__init__.py
--rw-rw-r--  2.0 unx    41436 b- defN 23-Feb-09 04:08 pycaret/anomaly/functional.py
+-rw-rw-r--  2.0 unx    41625 b- defN 23-May-14 21:14 pycaret/anomaly/functional.py
 -rw-rw-r--  2.0 unx     5121 b- defN 23-Jan-16 18:09 pycaret/anomaly/oop.py
 -rw-rw-r--  2.0 unx     1747 b- defN 23-Feb-09 04:08 pycaret/classification/__init__.py
--rw-rw-r--  2.0 unx   116237 b- defN 23-Feb-09 04:08 pycaret/classification/functional.py
--rw-rw-r--  2.0 unx   130305 b- defN 23-Feb-09 04:08 pycaret/classification/oop.py
+-rw-rw-r--  2.0 unx   116404 b- defN 23-May-14 21:14 pycaret/classification/functional.py
+-rw-rw-r--  2.0 unx   130585 b- defN 23-May-14 21:14 pycaret/classification/oop.py
 -rw-rw-r--  2.0 unx     1013 b- defN 23-Feb-09 04:08 pycaret/clustering/__init__.py
--rw-rw-r--  2.0 unx    46874 b- defN 23-Feb-09 04:08 pycaret/clustering/functional.py
+-rw-rw-r--  2.0 unx    46863 b- defN 23-May-14 21:14 pycaret/clustering/functional.py
 -rw-rw-r--  2.0 unx    10407 b- defN 23-Jan-16 18:09 pycaret/clustering/oop.py
 -rw-rw-r--  2.0 unx        0 b- defN 22-Apr-23 22:34 pycaret/containers/__init__.py
 -rw-rw-r--  2.0 unx     3929 b- defN 23-Jan-16 18:09 pycaret/containers/base_container.py
 -rw-rw-r--  2.0 unx      465 b- defN 23-Jan-16 18:09 pycaret/containers/metrics/__init__.py
--rw-rw-r--  2.0 unx     6391 b- defN 23-Jan-16 18:09 pycaret/containers/metrics/anomaly.py
+-rw-rw-r--  2.0 unx     6390 b- defN 23-May-14 21:14 pycaret/containers/metrics/anomaly.py
 -rw-rw-r--  2.0 unx     3780 b- defN 23-Jan-16 18:09 pycaret/containers/metrics/base_metric.py
--rw-rw-r--  2.0 unx    10466 b- defN 23-Jan-16 18:09 pycaret/containers/metrics/classification.py
--rw-rw-r--  2.0 unx     8111 b- defN 23-Jan-16 18:09 pycaret/containers/metrics/clustering.py
--rw-rw-r--  2.0 unx     9483 b- defN 23-Jan-16 18:09 pycaret/containers/metrics/regression.py
--rw-rw-r--  2.0 unx    11225 b- defN 23-Jan-16 18:09 pycaret/containers/metrics/time_series.py
+-rw-rw-r--  2.0 unx    10567 b- defN 23-May-14 21:14 pycaret/containers/metrics/classification.py
+-rw-rw-r--  2.0 unx     8110 b- defN 23-May-14 21:14 pycaret/containers/metrics/clustering.py
+-rw-rw-r--  2.0 unx     9480 b- defN 23-May-14 21:14 pycaret/containers/metrics/regression.py
+-rw-rw-r--  2.0 unx    11222 b- defN 23-May-14 21:14 pycaret/containers/metrics/time_series.py
 -rw-rw-r--  2.0 unx      453 b- defN 23-Jan-16 18:09 pycaret/containers/models/__init__.py
--rw-rw-r--  2.0 unx    13138 b- defN 23-Feb-09 04:08 pycaret/containers/models/anomaly.py
+-rw-rw-r--  2.0 unx    13053 b- defN 23-May-14 21:14 pycaret/containers/models/anomaly.py
 -rw-rw-r--  2.0 unx     7622 b- defN 23-Jan-16 18:09 pycaret/containers/models/base_model.py
--rw-rw-r--  2.0 unx    53330 b- defN 23-Feb-09 04:08 pycaret/containers/models/classification.py
--rw-rw-r--  2.0 unx    14622 b- defN 23-Feb-09 04:08 pycaret/containers/models/clustering.py
--rw-rw-r--  2.0 unx    62807 b- defN 23-Feb-09 04:08 pycaret/containers/models/regression.py
--rw-rw-r--  2.0 unx   104790 b- defN 23-Feb-09 04:08 pycaret/containers/models/time_series.py
+-rw-rw-r--  2.0 unx    53230 b- defN 23-May-14 21:14 pycaret/containers/models/classification.py
+-rw-rw-r--  2.0 unx    14621 b- defN 23-May-14 21:14 pycaret/containers/models/clustering.py
+-rw-rw-r--  2.0 unx    62707 b- defN 23-May-14 21:14 pycaret/containers/models/regression.py
+-rw-rw-r--  2.0 unx   106861 b- defN 23-May-14 21:14 pycaret/containers/models/time_series.py
 -rw-rw-r--  2.0 unx        0 b- defN 22-Apr-23 22:34 pycaret/internal/__init__.py
 -rw-rw-r--  2.0 unx      385 b- defN 23-Feb-05 20:52 pycaret/internal/cloudpickle_compat.py
--rw-rw-r--  2.0 unx     4271 b- defN 23-Feb-09 04:08 pycaret/internal/cuml_wrappers.py
+-rw-rw-r--  2.0 unx     4269 b- defN 23-May-14 21:14 pycaret/internal/cuml_wrappers.py
 -rw-rw-r--  2.0 unx    12818 b- defN 23-Jan-16 18:09 pycaret/internal/distributions.py
--rw-rw-r--  2.0 unx     4550 b- defN 23-Jan-16 18:09 pycaret/internal/ensemble.py
--rw-rw-r--  2.0 unx     5533 b- defN 23-Feb-09 04:08 pycaret/internal/logging.py
--rw-rw-r--  2.0 unx    15524 b- defN 23-Feb-09 04:08 pycaret/internal/memory.py
+-rw-rw-r--  2.0 unx     6284 b- defN 23-Apr-16 16:57 pycaret/internal/logging.py
+-rw-rw-r--  2.0 unx    17163 b- defN 23-Apr-16 16:57 pycaret/internal/memory.py
 -rw-rw-r--  2.0 unx     8211 b- defN 23-Jan-16 18:09 pycaret/internal/meta_estimators.py
--rw-rw-r--  2.0 unx     8757 b- defN 23-Jan-16 18:09 pycaret/internal/metrics.py
--rw-rw-r--  2.0 unx    25532 b- defN 23-Jan-16 18:09 pycaret/internal/persistence.py
--rw-rw-r--  2.0 unx    19970 b- defN 23-Feb-09 04:08 pycaret/internal/pipeline.py
+-rw-rw-r--  2.0 unx    10086 b- defN 23-Apr-16 16:57 pycaret/internal/metrics.py
+-rw-rw-r--  2.0 unx    25541 b- defN 23-May-14 21:14 pycaret/internal/persistence.py
+-rw-rw-r--  2.0 unx    20325 b- defN 23-May-14 21:14 pycaret/internal/pipeline.py
 -rw-rw-r--  2.0 unx    45347 b- defN 23-Jan-16 18:09 pycaret/internal/tunable.py
 -rw-rw-r--  2.0 unx     1990 b- defN 23-Jan-16 18:09 pycaret/internal/validation.py
 -rw-rw-r--  2.0 unx      181 b- defN 23-Jan-16 18:09 pycaret/internal/display/__init__.py
 -rw-rw-r--  2.0 unx     3375 b- defN 23-Jan-16 18:09 pycaret/internal/display/display.py
--rw-rw-r--  2.0 unx     5854 b- defN 23-Feb-09 04:08 pycaret/internal/display/display_backend.py
--rw-rw-r--  2.0 unx     1632 b- defN 23-Jan-16 18:09 pycaret/internal/display/display_component.py
+-rw-rw-r--  2.0 unx     5854 b- defN 23-Apr-16 17:27 pycaret/internal/display/display_backend.py
+-rw-rw-r--  2.0 unx     1632 b- defN 23-Feb-28 04:53 pycaret/internal/display/display_component.py
 -rw-rw-r--  2.0 unx     4678 b- defN 23-Feb-09 04:08 pycaret/internal/display/progress_bar.py
 -rw-rw-r--  2.0 unx       46 b- defN 23-Jan-16 18:09 pycaret/internal/parallel/__init__.py
 -rw-rw-r--  2.0 unx     1468 b- defN 23-Jan-16 18:09 pycaret/internal/parallel/parallel_backend.py
 -rw-rw-r--  2.0 unx        0 b- defN 22-Apr-23 22:34 pycaret/internal/patches/__init__.py
--rw-rw-r--  2.0 unx     1201 b- defN 23-Feb-09 04:08 pycaret/internal/patches/pyod.py
 -rw-rw-r--  2.0 unx     3239 b- defN 23-Jan-16 18:09 pycaret/internal/patches/sklearn.py
 -rw-rw-r--  2.0 unx      392 b- defN 23-Jan-16 18:09 pycaret/internal/patches/yellowbrick.py
 -rw-rw-r--  2.0 unx        0 b- defN 22-Apr-23 22:34 pycaret/internal/plots/__init__.py
 -rw-rw-r--  2.0 unx     4956 b- defN 23-Jan-16 18:09 pycaret/internal/plots/helper.py
 -rw-rw-r--  2.0 unx    28091 b- defN 23-Jan-16 18:09 pycaret/internal/plots/residual_plots.py
--rw-rw-r--  2.0 unx    46969 b- defN 23-Jan-16 18:09 pycaret/internal/plots/time_series.py
+-rw-rw-r--  2.0 unx    46967 b- defN 23-May-14 21:14 pycaret/internal/plots/time_series.py
 -rw-rw-r--  2.0 unx     3517 b- defN 23-Feb-09 04:08 pycaret/internal/plots/yellowbrick.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Jan-16 18:09 pycaret/internal/plots/utils/__init__.py
--rw-rw-r--  2.0 unx    39887 b- defN 23-Jan-16 18:09 pycaret/internal/plots/utils/time_series.py
+-rw-rw-r--  2.0 unx    39887 b- defN 23-May-07 20:21 pycaret/internal/plots/utils/time_series.py
 -rw-rw-r--  2.0 unx      258 b- defN 23-Jan-16 18:09 pycaret/internal/preprocess/__init__.py
 -rw-rw-r--  2.0 unx    20788 b- defN 23-Jan-16 18:09 pycaret/internal/preprocess/iterative_imputer.py
--rw-rw-r--  2.0 unx    39411 b- defN 23-Jan-16 23:23 pycaret/internal/preprocess/preprocessor.py
--rw-rw-r--  2.0 unx    21374 b- defN 23-Jan-16 23:23 pycaret/internal/preprocess/transformers.py
+-rw-rw-r--  2.0 unx    39991 b- defN 23-May-14 21:14 pycaret/internal/preprocess/preprocessor.py
+-rw-rw-r--  2.0 unx    21958 b- defN 23-Apr-16 16:57 pycaret/internal/preprocess/transformers.py
 -rw-rw-r--  2.0 unx     6667 b- defN 23-Jan-16 18:09 pycaret/internal/preprocess/target/TransformedTargetClassifier.py
 -rw-rw-r--  2.0 unx     1189 b- defN 23-Jan-16 18:09 pycaret/internal/preprocess/target/TransformedTargetRegressor.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Jan-16 18:09 pycaret/internal/preprocess/target/__init__.py
 -rw-rw-r--  2.0 unx     2055 b- defN 23-Jan-16 18:09 pycaret/internal/preprocess/target/utils.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Jan-16 18:09 pycaret/internal/preprocess/time_series/__init__.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Jan-16 18:09 pycaret/internal/preprocess/time_series/forecasting/__init__.py
 -rw-rw-r--  2.0 unx    12435 b- defN 23-Jan-16 18:09 pycaret/internal/preprocess/time_series/forecasting/preprocessor.py
 -rw-rw-r--  2.0 unx      316 b- defN 23-Jan-16 18:09 pycaret/internal/pycaret_experiment/__init__.py
--rw-rw-r--  2.0 unx     3131 b- defN 23-Feb-05 20:52 pycaret/internal/pycaret_experiment/non_ts_supervised_experiment.py
--rw-rw-r--  2.0 unx    18784 b- defN 23-Jan-16 18:09 pycaret/internal/pycaret_experiment/pycaret_experiment.py
--rw-rw-r--  2.0 unx   215837 b- defN 23-Feb-09 04:08 pycaret/internal/pycaret_experiment/supervised_experiment.py
--rw-rw-r--  2.0 unx   110937 b- defN 23-Feb-09 04:08 pycaret/internal/pycaret_experiment/tabular_experiment.py
+-rw-rw-r--  2.0 unx     3220 b- defN 23-Apr-16 16:57 pycaret/internal/pycaret_experiment/non_ts_supervised_experiment.py
+-rw-rw-r--  2.0 unx    18945 b- defN 23-May-14 21:14 pycaret/internal/pycaret_experiment/pycaret_experiment.py
+-rw-rw-r--  2.0 unx   217220 b- defN 23-May-14 21:14 pycaret/internal/pycaret_experiment/supervised_experiment.py
+-rw-rw-r--  2.0 unx   110969 b- defN 23-May-14 21:14 pycaret/internal/pycaret_experiment/tabular_experiment.py
 -rw-rw-r--  2.0 unx     6873 b- defN 23-Feb-05 20:52 pycaret/internal/pycaret_experiment/ts_supervised_experiment.py
--rw-rw-r--  2.0 unx    52825 b- defN 23-Feb-09 04:08 pycaret/internal/pycaret_experiment/unsupervised_experiment.py
+-rw-rw-r--  2.0 unx    53024 b- defN 23-Apr-16 16:57 pycaret/internal/pycaret_experiment/unsupervised_experiment.py
 -rw-rw-r--  2.0 unx     1340 b- defN 23-Jan-16 18:09 pycaret/internal/tests/__init__.py
--rw-rw-r--  2.0 unx     5820 b- defN 23-Jan-16 18:09 pycaret/internal/tests/stats.py
--rw-rw-r--  2.0 unx    21686 b- defN 23-Jan-16 18:09 pycaret/internal/tests/time_series.py
+-rw-rw-r--  2.0 unx     5840 b- defN 23-Apr-16 16:57 pycaret/internal/tests/stats.py
+-rw-rw-r--  2.0 unx    21716 b- defN 23-Apr-16 16:57 pycaret/internal/tests/time_series.py
 -rw-rw-r--  2.0 unx      375 b- defN 23-Feb-09 04:08 pycaret/loggers/__init__.py
--rw-rw-r--  2.0 unx     1009 b- defN 23-Feb-09 04:08 pycaret/loggers/base_logger.py
--rw-rw-r--  2.0 unx     2417 b- defN 23-Feb-09 04:08 pycaret/loggers/comet_logger.py
+-rw-rw-r--  2.0 unx     1485 b- defN 23-May-07 20:21 pycaret/loggers/base_logger.py
+-rw-rw-r--  2.0 unx     2499 b- defN 23-May-07 20:21 pycaret/loggers/comet_logger.py
 -rw-rw-r--  2.0 unx     3846 b- defN 23-Feb-09 04:08 pycaret/loggers/dagshub_logger.py
 -rw-rw-r--  2.0 unx    11906 b- defN 23-Feb-09 04:08 pycaret/loggers/dashboard_logger.py
--rw-rw-r--  2.0 unx     5505 b- defN 23-Feb-09 04:08 pycaret/loggers/mlflow_logger.py
--rw-rw-r--  2.0 unx     2740 b- defN 23-Feb-09 04:08 pycaret/loggers/wandb_logger.py
+-rw-rw-r--  2.0 unx     5419 b- defN 23-May-07 20:21 pycaret/loggers/mlflow_logger.py
+-rw-rw-r--  2.0 unx     2717 b- defN 23-May-07 20:21 pycaret/loggers/wandb_logger.py
 -rw-rw-r--  2.0 unx      184 b- defN 23-Jan-16 18:09 pycaret/parallel/__init__.py
--rw-rw-r--  2.0 unx     6932 b- defN 23-Feb-05 20:52 pycaret/parallel/fugue_backend.py
+-rw-rw-r--  2.0 unx     6965 b- defN 23-May-07 20:21 pycaret/parallel/fugue_backend.py
 -rw-rw-r--  2.0 unx     1637 b- defN 23-Feb-09 04:08 pycaret/regression/__init__.py
--rw-rw-r--  2.0 unx   105411 b- defN 23-Feb-09 04:08 pycaret/regression/functional.py
--rw-rw-r--  2.0 unx   107182 b- defN 23-Feb-09 04:08 pycaret/regression/oop.py
+-rw-rw-r--  2.0 unx   105586 b- defN 23-May-14 21:14 pycaret/regression/functional.py
+-rw-rw-r--  2.0 unx   107460 b- defN 23-May-14 21:14 pycaret/regression/oop.py
 -rw-rw-r--  2.0 unx     1157 b- defN 23-Jan-16 18:09 pycaret/time_series/__init__.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Jan-16 18:09 pycaret/time_series/forecasting/__init__.py
--rw-rw-r--  2.0 unx    79820 b- defN 23-Feb-09 04:08 pycaret/time_series/forecasting/functional.py
--rw-rw-r--  2.0 unx   218772 b- defN 23-Feb-09 04:08 pycaret/time_series/forecasting/oop.py
--rw-rw-r--  2.0 unx      494 b- defN 23-Feb-05 20:52 pycaret/utils/__init__.py
+-rw-rw-r--  2.0 unx    81666 b- defN 23-May-07 20:21 pycaret/time_series/forecasting/functional.py
+-rw-rw-r--  2.0 unx   225922 b- defN 23-May-07 20:21 pycaret/time_series/forecasting/oop.py
+-rw-rw-r--  2.0 unx      329 b- defN 23-Apr-16 16:57 pycaret/utils/__init__.py
 -rw-rw-r--  2.0 unx     5418 b- defN 23-Jan-16 18:09 pycaret/utils/_dependencies.py
 -rw-rw-r--  2.0 unx     3719 b- defN 23-Feb-09 04:08 pycaret/utils/_show_versions.py
 -rw-rw-r--  2.0 unx      729 b- defN 23-Jan-16 18:09 pycaret/utils/constants.py
--rw-rw-r--  2.0 unx     4281 b- defN 23-Jan-16 18:09 pycaret/utils/datetime.py
--rw-rw-r--  2.0 unx    36408 b- defN 23-Jan-16 23:23 pycaret/utils/generic.py
--rw-rw-r--  2.0 unx    15785 b- defN 23-Feb-09 04:08 pycaret/utils/time_series/__init__.py
+-rw-rw-r--  2.0 unx     4315 b- defN 23-Apr-16 16:57 pycaret/utils/datetime.py
+-rw-rw-r--  2.0 unx    36571 b- defN 23-May-14 21:14 pycaret/utils/generic.py
+-rw-rw-r--  2.0 unx    18663 b- defN 23-Apr-16 16:57 pycaret/utils/time_series/__init__.py
 -rw-rw-r--  2.0 unx      129 b- defN 23-Jan-16 18:09 pycaret/utils/time_series/exceptions.py
 -rw-rw-r--  2.0 unx     6813 b- defN 23-Jan-16 18:09 pycaret/utils/time_series/forecasting/__init__.py
--rw-rw-r--  2.0 unx    27871 b- defN 23-Feb-09 04:08 pycaret/utils/time_series/forecasting/model_selection.py
+-rw-rw-r--  2.0 unx    27874 b- defN 23-Apr-16 16:57 pycaret/utils/time_series/forecasting/model_selection.py
 -rw-rw-r--  2.0 unx     4817 b- defN 23-Jan-16 18:09 pycaret/utils/time_series/forecasting/models.py
 -rw-rw-r--  2.0 unx     9372 b- defN 23-Jan-16 18:09 pycaret/utils/time_series/forecasting/pipeline.py
--rw-rw-r--  2.0 unx     1085 b- defN 23-Feb-09 17:37 pycaret-3.0.0rc9.dist-info/LICENSE
--rw-rw-r--  2.0 unx    15832 b- defN 23-Feb-09 17:37 pycaret-3.0.0rc9.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 23-Feb-09 17:37 pycaret-3.0.0rc9.dist-info/WHEEL
--rw-rw-r--  2.0 unx        8 b- defN 23-Feb-09 17:37 pycaret-3.0.0rc9.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx    10630 b- defN 23-Feb-09 17:37 pycaret-3.0.0rc9.dist-info/RECORD
-113 files, 2202589 bytes uncompressed, 463045 bytes compressed:  79.0%
+-rw-rw-r--  2.0 unx     1085 b- defN 23-May-14 21:25 pycaret-3.0.1.dist-info/LICENSE
+-rw-rw-r--  2.0 unx    16960 b- defN 23-May-14 21:25 pycaret-3.0.1.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 23-May-14 21:25 pycaret-3.0.1.dist-info/WHEEL
+-rw-rw-r--  2.0 unx        8 b- defN 23-May-14 21:25 pycaret-3.0.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx    10442 b- defN 23-May-14 21:25 pycaret-3.0.1.dist-info/RECORD
+111 files, 2220250 bytes uncompressed, 466710 bytes compressed:  79.0%
```

## zipnote {}

```diff
@@ -90,17 +90,14 @@
 
 Filename: pycaret/internal/cuml_wrappers.py
 Comment: 
 
 Filename: pycaret/internal/distributions.py
 Comment: 
 
-Filename: pycaret/internal/ensemble.py
-Comment: 
-
 Filename: pycaret/internal/logging.py
 Comment: 
 
 Filename: pycaret/internal/memory.py
 Comment: 
 
 Filename: pycaret/internal/meta_estimators.py
@@ -141,17 +138,14 @@
 
 Filename: pycaret/internal/parallel/parallel_backend.py
 Comment: 
 
 Filename: pycaret/internal/patches/__init__.py
 Comment: 
 
-Filename: pycaret/internal/patches/pyod.py
-Comment: 
-
 Filename: pycaret/internal/patches/sklearn.py
 Comment: 
 
 Filename: pycaret/internal/patches/yellowbrick.py
 Comment: 
 
 Filename: pycaret/internal/plots/__init__.py
@@ -318,23 +312,23 @@
 
 Filename: pycaret/utils/time_series/forecasting/models.py
 Comment: 
 
 Filename: pycaret/utils/time_series/forecasting/pipeline.py
 Comment: 
 
-Filename: pycaret-3.0.0rc9.dist-info/LICENSE
+Filename: pycaret-3.0.1.dist-info/LICENSE
 Comment: 
 
-Filename: pycaret-3.0.0rc9.dist-info/METADATA
+Filename: pycaret-3.0.1.dist-info/METADATA
 Comment: 
 
-Filename: pycaret-3.0.0rc9.dist-info/WHEEL
+Filename: pycaret-3.0.1.dist-info/WHEEL
 Comment: 
 
-Filename: pycaret-3.0.0rc9.dist-info/top_level.txt
+Filename: pycaret-3.0.1.dist-info/top_level.txt
 Comment: 
 
-Filename: pycaret-3.0.0rc9.dist-info/RECORD
+Filename: pycaret-3.0.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## pycaret/__init__.py

```diff
@@ -13,13 +13,12 @@
     from joblib.externals.loky.backend.reduction import set_loky_pickler
 
     set_loky_pickler(pycaret.internal.cloudpickle_compat.__name__)
 
 
 from pycaret.utils._show_versions import show_versions
 
-version_ = "3.0.0.rc9"
-nightly_version_ = "3.0.0"
+version_ = "3.0.1"
 
 __version__ = version_
 
 __all__ = ["show_versions", "__version__"]
```

## pycaret/datasets.py

```diff
@@ -11,15 +11,14 @@
     dataset: str = "index",
     folder: Optional[str] = None,
     save_copy: bool = False,
     profile: bool = False,
     verbose: bool = True,
     address: Optional[str] = None,
 ):
-
     """
     Function to load sample datasets.
 
     Order of read:
     (1) Tries to read dataset from local folder first.
     (2) Then tries to read dataset from folder in GitHub "address" (see below)
     (3) Then tries to read from sktime (if installed)
```

## pycaret/anomaly/functional.py

```diff
@@ -19,15 +19,15 @@
     "_CURRENT_EXPERIMENT": _CURRENT_EXPERIMENT_EXCEPTION
 }
 
 
 def setup(
     data: Optional[DATAFRAME_LIKE] = None,
     data_func: Optional[Callable[[], DATAFRAME_LIKE]] = None,
-    index: Union[bool, int, str, SEQUENCE_LIKE] = False,
+    index: Union[bool, int, str, SEQUENCE_LIKE] = True,
     ordinal_features: Optional[Dict[str, list]] = None,
     numeric_features: Optional[List[str]] = None,
     categorical_features: Optional[List[str]] = None,
     date_features: Optional[List[str]] = None,
     text_features: Optional[List[str]] = None,
     ignore_features: Optional[List[str]] = None,
     keep_features: Optional[List[str]] = None,
@@ -42,14 +42,15 @@
     rare_to_value: Optional[float] = None,
     rare_value: str = "rare",
     polynomial_features: bool = False,
     polynomial_degree: int = 2,
     low_variance_threshold: Optional[float] = None,
     group_features: Optional[list] = None,
     group_names: Optional[Union[str, list]] = None,
+    drop_groups: bool = False,
     remove_multicollinearity: bool = False,
     multicollinearity_threshold: float = 0.9,
     bin_numeric_features: Optional[List[str]] = None,
     remove_outliers: bool = False,
     outliers_method: str = "iforest",
     outliers_threshold: float = 0.05,
     transformation: bool = False,
@@ -73,15 +74,14 @@
     log_profile: bool = False,
     log_data: bool = False,
     verbose: bool = True,
     memory: Union[bool, str, Memory] = True,
     profile: bool = False,
     profile_kwargs: Optional[Dict[str, Any]] = None,
 ):
-
     """
     This function initializes the training environment and creates the transformation
     pipeline. Setup function must be called before executing any other function. It
     takes one mandatory parameter: ``data``. All the other parameters are optional.
 
 
     Example
@@ -103,15 +103,15 @@
         The function that generate ``data`` (the dataframe-like input). This
         is useful when the dataset is large, and you need parallel operations
         such as ``compare_models``. It can avoid broadcasting large dataset
         from driver to workers. Notice one and only one of ``data`` and
         ``data_func`` must be set.
 
 
-    index: bool, int, str or sequence, default = False
+    index: bool, int, str or sequence, default = True
         Handle indices in the `data` dataframe.
             - If False: Reset to RangeIndex.
             - If True: Keep the provided index.
             - If int: Position of the column to use as index.
             - If str: Name of the column to use as index.
             - If sequence: Array with shape=(n_samples,) to use as index.
 
@@ -232,27 +232,31 @@
         threshold. If 0, keep all features with non-zero variance, i.e. remove
         the features that have the same value in all samples. If None, skip
         this transformation step.
 
 
     group_features: list, list of lists or None, default = None
         When the dataset contains features with related characteristics,
-        replace those fetaures with the following statistical properties
-        of that group: min, max, mean, std, median and mode. The parameter
-        takes a list of feature names or a list of lists of feature names
-        to specify multiple groups.
-
+        add new fetaures with the following statistical properties of that
+        group: min, max, mean, std, median and mode. The parameter takes a
+        list of feature names or a list of lists of feature names to specify
+        multiple groups.
 
     group_names: str, list, or None, default = None
         Group names to be used when naming the new features. The length
         should match with the number of groups specified in ``group_features``.
         If None, new features are named using the default form, e.g. group_1,
         group_2, etc... Ignored when ``group_features`` is None.
 
 
+    drop_groups: bool, default=False
+        Whether to drop the original features in the group. Ignored when
+        ``group_features`` is None.
+
+
     remove_multicollinearity: bool, default = False
         When set to True, features with the inter-correlations higher than
         the defined threshold are removed. For each group, it removes all
         except the first feature.
 
 
     multicollinearity_threshold: float, default = 0.9
@@ -464,14 +468,15 @@
         rare_to_value=rare_to_value,
         rare_value=rare_value,
         polynomial_features=polynomial_features,
         polynomial_degree=polynomial_degree,
         low_variance_threshold=low_variance_threshold,
         group_features=group_features,
         group_names=group_names,
+        drop_groups=drop_groups,
         remove_multicollinearity=remove_multicollinearity,
         multicollinearity_threshold=multicollinearity_threshold,
         bin_numeric_features=bin_numeric_features,
         remove_outliers=remove_outliers,
         outliers_method=outliers_method,
         outliers_threshold=outliers_threshold,
         transformation=transformation,
@@ -506,15 +511,14 @@
     model: Union[str, Any],
     fraction: float = 0.05,
     verbose: bool = True,
     fit_kwargs: Optional[dict] = None,
     experiment_custom_tags: Optional[Dict[str, Any]] = None,
     **kwargs,
 ):
-
     """
     This function trains a given model from the model library. All available
     models can be accessed using the ``models`` function.
 
 
     Example
     -------
@@ -582,15 +586,14 @@
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def assign_model(
     model, transformation: bool = False, score: bool = True, verbose: bool = True
 ) -> pd.DataFrame:
-
     """
     This function assigns anomaly labels to the dataset for a given model.
     (1 = outlier, 0 = inlier).
 
 
     Example
     -------
@@ -633,15 +636,14 @@
     plot: str = "tsne",
     feature: Optional[str] = None,
     label: bool = False,
     scale: float = 1,
     save: bool = False,
     display_format: Optional[str] = None,
 ) -> Optional[str]:
-
     """
     This function analyzes the performance of a trained model.
 
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -703,15 +705,14 @@
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def evaluate_model(
     model,
     feature: Optional[str] = None,
     fit_kwargs: Optional[dict] = None,
 ):
-
     """
     This function displays a user interface for analyzing performance of a trained
     model. It calls the ``plot_model`` function internally.
 
 
     Example
     -------
@@ -749,15 +750,14 @@
     return _CURRENT_EXPERIMENT.evaluate_model(
         estimator=model, feature_name=feature, fit_kwargs=fit_kwargs
     )
 
 
 # not using check_if_global_is_not_none on purpose
 def predict_model(model, data: pd.DataFrame) -> pd.DataFrame:
-
     """
     This function generates anomaly labels on using a trained model.
 
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -801,15 +801,14 @@
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def deploy_model(
     model,
     model_name: str,
     authentication: dict,
     platform: str = "aws",
 ):
-
     """
     This function deploys the transformation pipeline and trained model on cloud.
 
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -893,15 +892,14 @@
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def save_model(
     model, model_name: str, model_only: bool = False, verbose: bool = True, **kwargs
 ):
-
     """
     This function saves the transformation pipeline and trained model object
     into the current working directory as a pickle file for later use.
 
 
     Example
     -------
@@ -951,15 +949,14 @@
 # not using check_if_global_is_not_none on purpose
 def load_model(
     model_name: str,
     platform: Optional[str] = None,
     authentication: Optional[Dict[str, str]] = None,
     verbose: bool = True,
 ):
-
     """
     This function loads a previously saved pipeline.
 
 
     Example
     -------
     >>> from pycaret.anomaly import load_model
@@ -1029,15 +1026,14 @@
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def models(
     internal: bool = False,
     raise_errors: bool = True,
 ) -> pd.DataFrame:
-
     """
     Returns table of models available in the model library.
 
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -1061,15 +1057,14 @@
 
     """
     return _CURRENT_EXPERIMENT.models(internal=internal, raise_errors=raise_errors)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def get_logs(experiment_name: Optional[str] = None, save: bool = False) -> pd.DataFrame:
-
     """
     Returns a table of experiment logs. Only works when ``log_experiment``
     is True when initializing the ``setup`` function.
 
 
     Example
     -------
@@ -1095,15 +1090,14 @@
     """
 
     return _CURRENT_EXPERIMENT.get_logs(experiment_name=experiment_name, save=save)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def get_config(variable: Optional[str] = None):
-
     """
     This function is used to access global environment variables.
 
     Example
     -------
     >>> X_train = get_config('X_train')
 
@@ -1122,15 +1116,14 @@
     """
 
     return _CURRENT_EXPERIMENT.get_config(variable=variable)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def set_config(variable: str, value):
-
     """
     This function is used to reset global environment variables.
 
     Example
     -------
     >>> set_config('seed', 123)
 
@@ -1174,15 +1167,14 @@
 def load_experiment(
     path_or_file: Union[str, os.PathLike, BinaryIO],
     data: Optional[DATAFRAME_LIKE] = None,
     data_func: Optional[Callable[[], DATAFRAME_LIKE]] = None,
     preprocess_data: bool = True,
     **cloudpickle_kwargs,
 ) -> AnomalyExperiment:
-
     """
     Load an experiment saved with ``save_experiment`` from path
     or file.
 
     The data (and test data) is NOT saved with the experiment
     and will need to be specified again.
```

## pycaret/classification/functional.py

```diff
@@ -21,15 +21,15 @@
 }
 
 
 def setup(
     data: Optional[DATAFRAME_LIKE] = None,
     data_func: Optional[Callable[[], DATAFRAME_LIKE]] = None,
     target: TARGET_LIKE = -1,
-    index: Union[bool, int, str, SEQUENCE_LIKE] = False,
+    index: Union[bool, int, str, SEQUENCE_LIKE] = True,
     train_size: float = 0.7,
     test_data: Optional[DATAFRAME_LIKE] = None,
     ordinal_features: Optional[Dict[str, list]] = None,
     numeric_features: Optional[List[str]] = None,
     categorical_features: Optional[List[str]] = None,
     date_features: Optional[List[str]] = None,
     text_features: Optional[List[str]] = None,
@@ -49,14 +49,15 @@
     rare_to_value: Optional[float] = None,
     rare_value: str = "rare",
     polynomial_features: bool = False,
     polynomial_degree: int = 2,
     low_variance_threshold: Optional[float] = None,
     group_features: Optional[list] = None,
     group_names: Optional[Union[str, list]] = None,
+    drop_groups: bool = False,
     remove_multicollinearity: bool = False,
     multicollinearity_threshold: float = 0.9,
     bin_numeric_features: Optional[List[str]] = None,
     remove_outliers: bool = False,
     outliers_method: str = "iforest",
     outliers_threshold: float = 0.05,
     fix_imbalance: bool = False,
@@ -92,15 +93,14 @@
     log_profile: bool = False,
     log_data: bool = False,
     verbose: bool = True,
     memory: Union[bool, str, Memory] = True,
     profile: bool = False,
     profile_kwargs: Optional[Dict[str, Any]] = None,
 ):
-
     """
     This function initializes the training environment and creates the transformation
     pipeline. Setup function must be called before executing any other function. It takes
     two mandatory parameters: ``data`` and ``target``. All the other parameters are
     optional.
 
     Example
@@ -129,15 +129,15 @@
     target: int, str or sequence, default = -1
         If int or str, respectivcely index or name of the target column in data.
         The default value selects the last column in the dataset. If sequence,
         it should have shape (n_samples,). The target can be either binary or
         multiclass.
 
 
-    index: bool, int, str or sequence, default = False
+    index: bool, int, str or sequence, default = True
         Handle indices in the `data` dataframe.
             - If False: Reset to RangeIndex.
             - If True: Keep the provided index.
             - If int: Position of the column to use as index.
             - If str: Name of the column to use as index.
             - If sequence: Array with shape=(n_samples,) to use as index.
 
@@ -261,15 +261,15 @@
         is used. Note that columns with exactly two classes are always encoded
         ordinally. Set to below 0 to always use OneHotEncoding.
 
 
     encoding_method: category-encoders estimator, default = None
         A `category-encoders` estimator to encode the categorical columns
         with more than `max_encoding_ohe` unique values. If None,
-        `category_encoders.leave_one_out.LeaveOneOutEncoder` is used.
+        `category_encoders.target_encoder.TargetEncoder` is used.
 
 
     rare_to_value: float or None, default=None
         Minimum fraction of category occurrences in a categorical column.
         If a category is less frequent than `rare_to_value * len(X)`, it is
         replaced with the string in `rare_value`. Use this parameter to group
         rare categories before encoding the column. If None, ignores this step.
@@ -295,27 +295,31 @@
         threshold. If 0, keep all features with non-zero variance, i.e. remove
         the features that have the same value in all samples. If None, skip
         this transformation step.
 
 
     group_features: list, list of lists or None, default = None
         When the dataset contains features with related characteristics,
-        replace those fetaures with the following statistical properties
-        of that group: min, max, mean, std, median and mode. The parameter
-        takes a list of feature names or a list of lists of feature names
-        to specify multiple groups.
-
+        add new fetaures with the following statistical properties of that
+        group: min, max, mean, std, median and mode. The parameter takes a
+        list of feature names or a list of lists of feature names to specify
+        multiple groups.
 
     group_names: str, list, or None, default = None
         Group names to be used when naming the new features. The length
         should match with the number of groups specified in ``group_features``.
         If None, new features are named using the default form, e.g. group_1,
         group_2, etc... Ignored when ``group_features`` is None.
 
 
+    drop_groups: bool, default=False
+        Whether to drop the original features in the group. Ignored when
+        ``group_features`` is None.
+
+
     remove_multicollinearity: bool, default = False
         When set to True, features with the inter-correlations higher than
         the defined threshold are removed. For each group, it removes all
         except the feature with the highest correlation to `y`.
 
 
     multicollinearity_threshold: float, default = 0.9
@@ -623,14 +627,15 @@
         rare_to_value=rare_to_value,
         rare_value=rare_value,
         polynomial_features=polynomial_features,
         polynomial_degree=polynomial_degree,
         low_variance_threshold=low_variance_threshold,
         group_features=group_features,
         group_names=group_names,
+        drop_groups=drop_groups,
         remove_multicollinearity=remove_multicollinearity,
         multicollinearity_threshold=multicollinearity_threshold,
         bin_numeric_features=bin_numeric_features,
         remove_outliers=remove_outliers,
         outliers_method=outliers_method,
         outliers_threshold=outliers_threshold,
         fix_imbalance=fix_imbalance,
@@ -688,15 +693,14 @@
     groups: Optional[Union[str, Any]] = None,
     experiment_custom_tags: Optional[Dict[str, Any]] = None,
     probability_threshold: Optional[float] = None,
     engine: Optional[Dict[str, str]] = None,
     verbose: bool = True,
     parallel: Optional[ParallelBackend] = None,
 ) -> Union[Any, List[Any]]:
-
     """
     This function trains and evaluates performance of all estimators available in the
     model library using cross validation. The output of this function is a score grid
     with average cross validated scores. Metrics evaluated during CV can be accessed
     using the ``get_metrics`` function. Custom metrics can be added or removed using
     ``add_metric`` and ``remove_metric`` function.
 
@@ -884,15 +888,14 @@
     probability_threshold: Optional[float] = None,
     experiment_custom_tags: Optional[Dict[str, Any]] = None,
     engine: Optional[str] = None,
     verbose: bool = True,
     return_train_score: bool = False,
     **kwargs,
 ) -> Any:
-
     """
     This function trains and evaluates the performance of a given estimator
     using cross validation. The output of this function is a score grid with
     CV scores by fold. Metrics evaluated during CV can be accessed using the
     ``get_metrics`` function. Custom metrics can be added or removed using
     ``add_metric`` and ``remove_metric`` function. All the available models
     can be accessed using the ``models`` function.
@@ -1037,15 +1040,14 @@
     groups: Optional[Union[str, Any]] = None,
     return_tuner: bool = False,
     verbose: bool = True,
     tuner_verbose: Union[int, bool] = True,
     return_train_score: bool = False,
     **kwargs,
 ) -> Any:
-
     """
     This function tunes the hyperparameters of a given estimator. The output of
     this function is a score grid with CV scores by fold of the best selected
     model based on ``optimize`` parameter. Metrics evaluated during CV can be
     accessed using the ``get_metrics`` function. Custom metrics can be added
     or removed using ``add_metric`` and ``remove_metric`` function.
 
@@ -1245,15 +1247,14 @@
     optimize: str = "Accuracy",
     fit_kwargs: Optional[dict] = None,
     groups: Optional[Union[str, Any]] = None,
     probability_threshold: Optional[float] = None,
     verbose: bool = True,
     return_train_score: bool = False,
 ) -> Any:
-
     """
     This function ensembles a given estimator. The output of this function is
     a score grid with CV scores by fold. Metrics evaluated during CV can be
     accessed using the ``get_metrics`` function. Custom metrics can be added
     or removed using ``add_metric`` and ``remove_metric`` function.
 
 
@@ -1366,15 +1367,14 @@
     weights: Optional[List[float]] = None,
     fit_kwargs: Optional[dict] = None,
     groups: Optional[Union[str, Any]] = None,
     probability_threshold: Optional[float] = None,
     verbose: bool = True,
     return_train_score: bool = False,
 ) -> Any:
-
     """
     This function trains a Soft Voting / Majority Rule classifier for select
     models passed in the ``estimator_list`` param. The output of this function
     is a score grid with CV scores by fold. Metrics evaluated during CV can be
     accessed using the ``get_metrics`` function. Custom metrics can be added
     or removed using ``add_metric`` and ``remove_metric`` function.
 
@@ -1489,15 +1489,14 @@
     optimize: str = "Accuracy",
     fit_kwargs: Optional[dict] = None,
     groups: Optional[Union[str, Any]] = None,
     probability_threshold: Optional[float] = None,
     verbose: bool = True,
     return_train_score: bool = False,
 ) -> Any:
-
     """
     This function trains a meta model over select estimators passed in
     the ``estimator_list`` parameter. The output of this function is a
     score grid with CV scores by fold. Metrics evaluated during CV can
     be accessed using the ``get_metrics`` function. Custom metrics
     can be added or removed using ``add_metric`` and ``remove_metric``
     function.
@@ -1627,15 +1626,14 @@
     fit_kwargs: Optional[dict] = None,
     plot_kwargs: Optional[dict] = None,
     groups: Optional[Union[str, Any]] = None,
     use_train_data: bool = False,
     verbose: bool = True,
     display_format: Optional[str] = None,
 ) -> Optional[str]:
-
     """
     This function analyzes the performance of a trained model on holdout set.
     It may require re-training the model in certain cases.
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -1758,15 +1756,14 @@
     estimator,
     fold: Optional[Union[int, Any]] = None,
     fit_kwargs: Optional[dict] = None,
     plot_kwargs: Optional[dict] = None,
     groups: Optional[Union[str, Any]] = None,
     use_train_data: bool = False,
 ):
-
     """
     This function displays a user interface for analyzing performance of a trained
     model. It calls the ``plot_model`` function internally.
 
 
     Example
     -------
@@ -1837,15 +1834,14 @@
     observation: Optional[int] = None,
     use_train_data: bool = False,
     X_new_sample: Optional[pd.DataFrame] = None,
     y_new_sample: Optional[pd.DataFrame] = None,  # add for pfi explainer
     save: Union[str, bool] = False,
     **kwargs,
 ):
-
     """
     This function takes a trained model object and returns an interpretation plot
     based on the test / hold-out set.
 
     This function is implemented based on the SHAP (SHapley Additive exPlanations),
     which is a unified approach to explain the output of any machine learning model.
     SHAP connects game theory with local explanations.
@@ -1949,15 +1945,14 @@
     fold: Optional[Union[int, Any]] = None,
     round: int = 4,
     fit_kwargs: Optional[dict] = None,
     groups: Optional[Union[str, Any]] = None,
     verbose: bool = True,
     return_train_score: bool = False,
 ) -> Any:
-
     """
     This function calibrates the probability of a given estimator using isotonic
     or logistic regression. The output of this function is a score grid with CV
     scores by fold. Metrics evaluated during CV can be accessed using the
     ``get_metrics`` function. Custom metrics can be added or removed using
     ``add_metric`` and ``remove_metric`` function. The ouput of the original estimator
     and the calibrated estimator (created using this function) might not differ much.
@@ -2052,15 +2047,14 @@
 def optimize_threshold(
     estimator,
     optimize: str = "Accuracy",
     return_data: bool = False,
     plot_kwargs: Optional[dict] = None,
     **shgo_kwargs,
 ):
-
     """
     This function optimizes probability threshold for a trained classifier. It
     uses the SHGO optimizer from ``scipy`` to optimize for the given metric.
     This function will display a plot of the performance metrics at each probability
     threshold checked by the optimizer and returns the best model based on the metric
     defined under ``optimize`` parameter.
 
@@ -2121,15 +2115,14 @@
     data: Optional[pd.DataFrame] = None,
     probability_threshold: Optional[float] = None,
     encoded_labels: bool = False,
     raw_score: bool = False,
     round: int = 4,
     verbose: bool = True,
 ) -> pd.DataFrame:
-
     """
     This function predicts ``Label`` and ``Score`` (probability of predicted
     class) using a trained model. When ``data`` is None, it predicts label and
     score on the holdout set.
 
 
     Example
@@ -2207,15 +2200,14 @@
 def finalize_model(
     estimator,
     fit_kwargs: Optional[dict] = None,
     groups: Optional[Union[str, Any]] = None,
     model_only: bool = False,
     experiment_custom_tags: Optional[Dict[str, Any]] = None,
 ) -> Any:
-
     """
     This function trains a given estimator on the entire dataset including the
     holdout set.
 
 
     Example
     -------
@@ -2358,15 +2350,14 @@
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def save_model(
     model, model_name: str, model_only: bool = False, verbose: bool = True, **kwargs
 ):
-
     """
     This function saves the transformation pipeline and trained model object
     into the current working directory as a pickle file for later use.
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -2415,15 +2406,14 @@
 # not using check_if_global_is_not_none on purpose
 def load_model(
     model_name: str,
     platform: Optional[str] = None,
     authentication: Optional[Dict[str, str]] = None,
     verbose: bool = True,
 ):
-
     """
     This function loads a previously saved pipeline.
 
 
     Example
     -------
     >>> from pycaret.classification import load_model
@@ -2476,15 +2466,14 @@
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def automl(
     optimize: str = "Accuracy",
     use_holdout: bool = False,
     turbo: bool = True,
     return_train_score: bool = False,
 ) -> Any:
-
     """
     This function returns the best model out of all trained models in
     current session based on the ``optimize`` parameter. Metrics
     evaluated can be accessed using the ``get_metrics`` function.
 
 
     Example
@@ -2556,15 +2545,14 @@
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def models(
     type: Optional[str] = None,
     internal: bool = False,
     raise_errors: bool = True,
 ) -> pd.DataFrame:
-
     """
     Returns table of models available in the model library.
 
     Example
     -------
     >>> from pycaret.datasets import get_data
     >>> juice = get_data('juice')
@@ -2599,15 +2587,14 @@
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def get_metrics(
     reset: bool = False,
     include_custom: bool = True,
     raise_errors: bool = True,
 ) -> pd.DataFrame:
-
     """
     Returns table of available metrics used in the experiment.
 
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -2649,15 +2636,14 @@
     name: str,
     score_func: type,
     target: str = "pred",
     greater_is_better: bool = True,
     multiclass: bool = True,
     **kwargs,
 ) -> pd.Series:
-
     """
     Adds a custom metric to be used in the experiment.
 
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -2714,15 +2700,14 @@
         multiclass=multiclass,
         **kwargs,
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def remove_metric(name_or_id: str):
-
     """
     Removes a metric from the experiment.
 
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -2741,15 +2726,14 @@
 
     """
     return _CURRENT_EXPERIMENT.remove_metric(name_or_id=name_or_id)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def get_logs(experiment_name: Optional[str] = None, save: bool = False) -> pd.DataFrame:
-
     """
     Returns a table of experiment logs. Only works when ``log_experiment``
     is True when initializing the ``setup`` function.
 
 
     Example
     -------
@@ -2775,15 +2759,14 @@
     """
 
     return _CURRENT_EXPERIMENT.get_logs(experiment_name=experiment_name, save=save)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def get_config(variable: Optional[str] = None):
-
     """
     This function is used to access global environment variables.
 
     Example
     -------
     >>> X_train = get_config('X_train')
 
@@ -2802,15 +2785,14 @@
     """
 
     return _CURRENT_EXPERIMENT.get_config(variable=variable)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def set_config(variable: str, value):
-
     """
     This function is used to reset global environment variables.
 
     Example
     -------
     >>> set_config('seed', 123)
 
@@ -2856,15 +2838,14 @@
     path_or_file: Union[str, os.PathLike, BinaryIO],
     data: Optional[DATAFRAME_LIKE] = None,
     data_func: Optional[Callable[[], DATAFRAME_LIKE]] = None,
     test_data: Optional[DATAFRAME_LIKE] = None,
     preprocess_data: bool = True,
     **cloudpickle_kwargs,
 ) -> ClassificationExperiment:
-
     """
     Load an experiment saved with ``save_experiment`` from path
     or file.
 
     The data (and test data) is NOT saved with the experiment
     and will need to be specified again.
 
@@ -2928,15 +2909,14 @@
 def get_leaderboard(
     finalize_models: bool = False,
     model_only: bool = False,
     fit_kwargs: Optional[dict] = None,
     groups: Optional[Union[str, Any]] = None,
     verbose: bool = True,
 ) -> pd.DataFrame:
-
     """
     This function returns the leaderboard of all models trained in the
     current setup.
 
 
     Example
     -------
@@ -3039,15 +3019,14 @@
     return _CURRENT_EXPERIMENT.dashboard(
         estimator, display_format, dashboard_kwargs, run_kwargs, **kwargs
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def convert_model(estimator, language: str = "python") -> str:
-
     """
     This function transpiles trained machine learning models into native
     inference script in different programming languages (Python, C, Java,
     Go, JavaScript, Visual Basic, C#, PowerShell, R, PHP, Dart, Haskell,
     Ruby, F#). This functionality is very useful if you want to deploy models
     into environments where you can't install your normal Python stack to
     support model inference.
@@ -3092,15 +3071,14 @@
 
     """
     return _CURRENT_EXPERIMENT.convert_model(estimator, language)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def eda(display_format: str = "bokeh", **kwargs):
-
     """
     This function generates AutoEDA using AutoVIZ library. You must
     install Autoviz separately ``pip install autoviz`` to use this
     function.
 
 
     Example
@@ -3124,15 +3102,14 @@
         None
     """
     return _CURRENT_EXPERIMENT.eda(display_format=display_format, **kwargs)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def check_fairness(estimator, sensitive_features: list, plot_kwargs: dict = {}):
-
     """
     There are many approaches to conceptualizing fairness. This function follows
     the approach known as group fairness, which asks: Which groups of individuals
     are at risk for experiencing harms. This function provides fairness-related
     metrics between different groups (also called subpopulation).
 
 
@@ -3170,15 +3147,14 @@
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def create_api(
     estimator, api_name: str, host: str = "127.0.0.1", port: int = 8000
 ) -> None:
-
     """
     This function takes an input ``estimator`` and creates a POST API for
     inference. It only creates the API and doesn't run it automatically.
     To run the API, you must run the Python file using ``!python``.
 
 
     Example
@@ -3216,15 +3192,14 @@
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def create_docker(
     api_name: str, base_image: str = "python:3.8-slim", expose_port: int = 8000
 ) -> None:
-
     """
     This function creates a ``Dockerfile`` and ``requirements.txt`` for
     productionalizing API end-point.
 
 
     Example
     -------
@@ -3255,15 +3230,14 @@
     return _CURRENT_EXPERIMENT.create_docker(
         api_name=api_name, base_image=base_image, expose_port=expose_port
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def create_app(estimator, app_kwargs: Optional[dict] = None) -> None:
-
     """
     This function creates a basic gradio app for inference.
     It will later be expanded for other app types such as
     Streamlit.
 
 
     Example
```

## pycaret/classification/oop.py

```diff
@@ -116,15 +116,15 @@
         return ["auc", "confusion_matrix", "feature"]
 
     def setup(
         self,
         data: Optional[DATAFRAME_LIKE] = None,
         data_func: Optional[Callable[[], DATAFRAME_LIKE]] = None,
         target: TARGET_LIKE = -1,
-        index: Union[bool, int, str, SEQUENCE_LIKE] = False,
+        index: Union[bool, int, str, SEQUENCE_LIKE] = True,
         train_size: float = 0.7,
         test_data: Optional[DATAFRAME_LIKE] = None,
         ordinal_features: Optional[Dict[str, list]] = None,
         numeric_features: Optional[List[str]] = None,
         categorical_features: Optional[List[str]] = None,
         date_features: Optional[List[str]] = None,
         text_features: Optional[List[str]] = None,
@@ -144,14 +144,15 @@
         rare_to_value: Optional[float] = None,
         rare_value: str = "rare",
         polynomial_features: bool = False,
         polynomial_degree: int = 2,
         low_variance_threshold: Optional[float] = None,
         group_features: Optional[list] = None,
         group_names: Optional[Union[str, list]] = None,
+        drop_groups: bool = False,
         remove_multicollinearity: bool = False,
         multicollinearity_threshold: float = 0.9,
         bin_numeric_features: Optional[List[str]] = None,
         remove_outliers: bool = False,
         outliers_method: str = "iforest",
         outliers_threshold: float = 0.05,
         fix_imbalance: bool = False,
@@ -190,15 +191,14 @@
         log_data: bool = False,
         engine: Optional[Dict[str, str]] = None,
         verbose: bool = True,
         memory: Union[bool, str, Memory] = True,
         profile: bool = False,
         profile_kwargs: Optional[Dict[str, Any]] = None,
     ):
-
         """
         This function initializes the training environment and creates the transformation
         pipeline. Setup function must be called before executing any other function. It takes
         two mandatory parameters: ``data`` and ``target``. All the other parameters are
         optional.
 
         Example
@@ -227,15 +227,15 @@
         target: int, str or sequence, default = -1
             If int or str, respectivcely index or name of the target column in data.
             The default value selects the last column in the dataset. If sequence,
             it should have shape (n_samples,). The target can be either binary or
             multiclass.
 
 
-        index: bool, int, str or sequence, default = False
+        index: bool, int, str or sequence, default = True
             Handle indices in the `data` dataframe.
                 - If False: Reset to RangeIndex.
                 - If True: Keep the provided index.
                 - If int: Position of the column to use as index.
                 - If str: Name of the column to use as index.
                 - If sequence: Array with shape=(n_samples,) to use as index.
 
@@ -359,15 +359,15 @@
             is used. Note that columns with exactly two classes are always encoded
             ordinally. Set to below 0 to always use OneHotEncoding.
 
 
         encoding_method: category-encoders estimator, default = None
             A `category-encoders` estimator to encode the categorical columns
             with more than `max_encoding_ohe` unique values. If None,
-            `category_encoders.leave_one_out.LeaveOneOutEncoder` is used.
+            `category_encoders.target_encoder.TargetEncoder` is used.
 
 
         rare_to_value: float or None, default=None
             Minimum fraction of category occurrences in a categorical column.
             If a category is less frequent than `rare_to_value * len(X)`, it is
             replaced with the string in `rare_value`. Use this parameter to group
             rare categories before encoding the column. If None, ignores this step.
@@ -393,26 +393,30 @@
             threshold. If 0, keep all features with non-zero variance, i.e. remove
             the features that have the same value in all samples. If None, skip
             this transformation step.
 
 
         group_features: list, list of lists or None, default = None
             When the dataset contains features with related characteristics,
-            replace those fetaures with the following statistical properties
-            of that group: min, max, mean, std, median and mode. The parameter
-            takes a list of feature names or a list of lists of feature names
-            to specify multiple groups.
+            add new fetaures with the following statistical properties of that
+            group: min, max, mean, std, median and mode. The parameter takes a
+            list of feature names or a list of lists of feature names to specify
+            multiple groups.
 
 
         group_names: str, list, or None, default = None
             Group names to be used when naming the new features. The length
             should match with the number of groups specified in ``group_features``.
             If None, new features are named using the default form, e.g. group_1,
             group_2, etc... Ignored when ``group_features`` is None.
 
+        drop_groups: bool, default=False
+            Whether to drop the original features in the group. Ignored when
+            ``group_features`` is None.
+
 
         remove_multicollinearity: bool, default = False
             When set to True, features with the inter-correlations higher than
             the defined threshold are removed. For each group, it removes all
             except the feature with the highest correlation to `y`.
 
 
@@ -790,18 +794,14 @@
             steps=[("placeholder", None)],
             memory=self.memory,
         )
 
         if preprocess:
             self.logger.info("Preparing preprocessing pipeline...")
 
-            # Remove weird characters from column names
-            if any(re.search("[^A-Za-z0-9_]", col) for col in self.dataset):
-                self._clean_column_names()
-
             # Encode the target column
             y_unique = self.y.unique()
             if sorted(list(y_unique)) != list(range(len(y_unique))):
                 self._encode_target_column()
 
             # Convert date feature to numerical values
             if self._fxs["Date"]:
@@ -841,15 +841,15 @@
 
             # Drop features with too low variance
             if low_variance_threshold is not None:
                 self._low_variance(low_variance_threshold)
 
             # Get statistical properties of a group of features
             if group_features:
-                self._group_features(group_features, group_names)
+                self._group_features(group_features, group_names, drop_groups)
 
             # Drop features that are collinear with other features
             if remove_multicollinearity:
                 self._remove_multicollinearity(multicollinearity_threshold)
 
             # Bin numerical features to 5 clusters
             if bin_numeric_features:
@@ -883,14 +883,20 @@
                     n_features_to_select=n_features_to_select,
                 )
 
         # Add custom transformers to the pipeline
         if custom_pipeline:
             self._add_custom_pipeline(custom_pipeline, custom_pipeline_position)
 
+        # Remove weird characters from column names
+        # This has to be done right before the estimator, as modifying column
+        # names early messes self._fxs up
+        if any(re.search("[^A-Za-z0-9_]", col) for col in self.dataset):
+            self._clean_column_names()
+
         # Remove placeholder step
         if ("placeholder", None) in self.pipeline.steps and len(self.pipeline) > 1:
             self.pipeline.steps.remove(("placeholder", None))
 
         self.pipeline.fit(self.X_train, self.y_train)
 
         self.logger.info("Finished creating preprocessing pipeline.")
@@ -1043,15 +1049,14 @@
         groups: Optional[Union[str, Any]] = None,
         experiment_custom_tags: Optional[Dict[str, Any]] = None,
         probability_threshold: Optional[float] = None,
         engine: Optional[Dict[str, str]] = None,
         verbose: bool = True,
         parallel: Optional[ParallelBackend] = None,
     ) -> Union[Any, List[Any]]:
-
         """
         This function trains and evaluates performance of all estimators available in the
         model library using cross validation. The output of this function is a score grid
         with average cross validated scores. Metrics evaluated during CV can be accessed
         using the ``get_metrics`` function. Custom metrics can be added or removed using
         ``add_metric`` and ``remove_metric`` function.
 
@@ -1222,15 +1227,14 @@
         experiment_custom_tags: Optional[Dict[str, Any]] = None,
         probability_threshold: Optional[float] = None,
         engine: Optional[str] = None,
         verbose: bool = True,
         return_train_score: bool = False,
         **kwargs,
     ) -> Any:
-
         """
         This function trains and evaluates the performance of a given estimator
         using cross validation. The output of this function is a score grid with
         CV scores by fold. Metrics evaluated during CV can be accessed using the
         ``get_metrics`` function. Custom metrics can be added or removed using
         ``add_metric`` and ``remove_metric`` function. All the available models
         can be accessed using the ``models`` function.
@@ -1388,15 +1392,14 @@
         groups: Optional[Union[str, Any]] = None,
         return_tuner: bool = False,
         verbose: bool = True,
         tuner_verbose: Union[int, bool] = True,
         return_train_score: bool = False,
         **kwargs,
     ) -> Any:
-
         """
         This function tunes the hyperparameters of a given estimator. The output of
         this function is a score grid with CV scores by fold of the best selected
         model based on ``optimize`` parameter. Metrics evaluated during CV can be
         accessed using the ``get_metrics`` function. Custom metrics can be added
         or removed using ``add_metric`` and ``remove_metric`` function.
 
@@ -1595,15 +1598,14 @@
         optimize: str = "Accuracy",
         fit_kwargs: Optional[dict] = None,
         groups: Optional[Union[str, Any]] = None,
         probability_threshold: Optional[float] = None,
         verbose: bool = True,
         return_train_score: bool = False,
     ) -> Any:
-
         """
         This function ensembles a given estimator. The output of this function is
         a score grid with CV scores by fold. Metrics evaluated during CV can be
         accessed using the ``get_metrics`` function. Custom metrics can be added
         or removed using ``add_metric`` and ``remove_metric`` function.
 
 
@@ -1715,15 +1717,14 @@
         weights: Optional[List[float]] = None,
         fit_kwargs: Optional[dict] = None,
         groups: Optional[Union[str, Any]] = None,
         probability_threshold: Optional[float] = None,
         verbose: bool = True,
         return_train_score: bool = False,
     ) -> Any:
-
         """
         This function trains a Soft Voting / Majority Rule classifier for select
         models passed in the ``estimator_list`` param. The output of this function
         is a score grid with CV scores by fold. Metrics evaluated during CV can be
         accessed using the ``get_metrics`` function. Custom metrics can be added
         or removed using ``add_metric`` and ``remove_metric`` function.
 
@@ -1837,15 +1838,14 @@
         optimize: str = "Accuracy",
         fit_kwargs: Optional[dict] = None,
         groups: Optional[Union[str, Any]] = None,
         probability_threshold: Optional[float] = None,
         verbose: bool = True,
         return_train_score: bool = False,
     ) -> Any:
-
         """
         This function trains a meta model over select estimators passed in
         the ``estimator_list`` parameter. The output of this function is a
         score grid with CV scores by fold. Metrics evaluated during CV can
         be accessed using the ``get_metrics`` function. Custom metrics
         can be added or removed using ``add_metric`` and ``remove_metric``
         function.
@@ -1974,15 +1974,14 @@
         fit_kwargs: Optional[dict] = None,
         plot_kwargs: Optional[dict] = None,
         groups: Optional[Union[str, Any]] = None,
         use_train_data: bool = False,
         verbose: bool = True,
         display_format: Optional[str] = None,
     ) -> Optional[str]:
-
         """
         This function analyzes the performance of a trained model on holdout set.
         It may require re-training the model in certain cases.
 
         Example
         -------
         >>> from pycaret.datasets import get_data
@@ -2104,15 +2103,14 @@
         estimator,
         fold: Optional[Union[int, Any]] = None,
         fit_kwargs: Optional[dict] = None,
         plot_kwargs: Optional[dict] = None,
         groups: Optional[Union[str, Any]] = None,
         use_train_data: bool = False,
     ):
-
         """
         This function displays a user interface for analyzing performance of a trained
         model. It calls the ``plot_model`` function internally.
 
 
         Example
         -------
@@ -2182,15 +2180,14 @@
         observation: Optional[int] = None,
         use_train_data: bool = False,
         X_new_sample: Optional[pd.DataFrame] = None,
         y_new_sample: Optional[pd.DataFrame] = None,  # add for pfi explainer
         save: Union[str, bool] = False,
         **kwargs,
     ):
-
         """
         This function takes a trained model object and returns an interpretation plot
         based on the test / hold-out set.
 
         This function is implemented based on the SHAP (SHapley Additive exPlanations),
         which is a unified approach to explain the output of any machine learning model.
         SHAP connects game theory with local explanations.
@@ -2293,15 +2290,14 @@
         fold: Optional[Union[int, Any]] = None,
         round: int = 4,
         fit_kwargs: Optional[dict] = None,
         groups: Optional[Union[str, Any]] = None,
         verbose: bool = True,
         return_train_score: bool = False,
     ) -> Any:
-
         """
         This function calibrates the probability of a given estimator using isotonic
         or logistic regression. The output of this function is a score grid with CV
         scores by fold. Metrics evaluated during CV can be accessed using the
         ``get_metrics`` function. Custom metrics can be added or removed using
         ``add_metric`` and ``remove_metric`` function. The ouput of the original estimator
         and the calibrated estimator (created using this function) might not differ much.
@@ -2568,15 +2564,14 @@
         self,
         estimator,
         optimize: str = "Accuracy",
         return_data: bool = False,
         plot_kwargs: Optional[dict] = None,
         **shgo_kwargs,
     ):
-
         """
         This function optimizes probability threshold for a trained classifier. It
         uses the SHGO optimizer from ``scipy`` to optimize for the given metric.
         This function will display a plot of the performance metrics at each probability
         threshold checked by the optimizer and returns the best model based on the metric
         defined under ``optimize`` parameter.
 
@@ -2766,15 +2761,14 @@
         data: Optional[pd.DataFrame] = None,
         probability_threshold: Optional[float] = None,
         encoded_labels: bool = False,
         raw_score: bool = False,
         round: int = 4,
         verbose: bool = True,
     ) -> pd.DataFrame:
-
         """
         This function predicts ``Label`` and ``Score`` (probability of predicted
         class) using a trained model. When ``data`` is None, it predicts label and
         score on the holdout set.
 
 
         Example
@@ -2847,15 +2841,14 @@
         self,
         estimator,
         fit_kwargs: Optional[dict] = None,
         groups: Optional[Union[str, Any]] = None,
         model_only: bool = False,
         experiment_custom_tags: Optional[Dict[str, Any]] = None,
     ) -> Any:
-
         """
         This function trains a given estimator on the entire dataset including the
         holdout set.
 
 
         Example
         -------
@@ -2907,15 +2900,14 @@
     def deploy_model(
         self,
         model,
         model_name: str,
         authentication: dict,
         platform: str = "aws",
     ):
-
         """
         This function deploys the transformation pipeline and trained model on cloud.
 
 
         Example
         -------
         >>> from pycaret.datasets import get_data
@@ -3001,15 +2993,14 @@
         self,
         model,
         model_name: str,
         model_only: bool = False,
         verbose: bool = True,
         **kwargs,
     ):
-
         """
         This function saves the transformation pipeline and trained model object
         into the current working directory as a pickle file for later use.
 
         Example
         -------
         >>> from pycaret.datasets import get_data
@@ -3057,15 +3048,14 @@
     def load_model(
         self,
         model_name: str,
         platform: Optional[str] = None,
         authentication: Optional[Dict[str, str]] = None,
         verbose: bool = True,
     ):
-
         """
         This function loads a previously saved pipeline.
 
 
         Example
         -------
         >>> from pycaret.classification import load_model
@@ -3113,15 +3103,14 @@
     def automl(
         self,
         optimize: str = "Accuracy",
         use_holdout: bool = False,
         turbo: bool = True,
         return_train_score: bool = False,
     ) -> Any:
-
         """
         This function returns the best model out of all trained models in
         current session based on the ``optimize`` parameter. Metrics
         evaluated can be accessed using the ``get_metrics`` function.
 
 
         Example
@@ -3172,15 +3161,14 @@
 
     def models(
         self,
         type: Optional[str] = None,
         internal: bool = False,
         raise_errors: bool = True,
     ) -> pd.DataFrame:
-
         """
         Returns table of models available in the model library.
 
         Example
         -------
         >>> from pycaret.datasets import get_data
         >>> juice = get_data('juice')
@@ -3212,15 +3200,14 @@
 
     def get_metrics(
         self,
         reset: bool = False,
         include_custom: bool = True,
         raise_errors: bool = True,
     ) -> pd.DataFrame:
-
         """
         Returns table of available metrics used in the experiment.
 
 
         Example
         -------
         >>> from pycaret.datasets import get_data
@@ -3261,15 +3248,14 @@
         name: str,
         score_func: type,
         target: str = "pred",
         greater_is_better: bool = True,
         multiclass: bool = True,
         **kwargs,
     ) -> pd.Series:
-
         """
         Adds a custom metric to be used in the experiment.
 
 
         Example
         -------
         >>> from pycaret.datasets import get_data
@@ -3324,15 +3310,14 @@
             target=target,
             greater_is_better=greater_is_better,
             multiclass=multiclass,
             **kwargs,
         )
 
     def remove_metric(self, name_or_id: str):
-
         """
         Removes a metric from the experiment.
 
 
         Example
         -------
         >>> from pycaret.datasets import get_data
@@ -3352,15 +3337,14 @@
         """
 
         return super().remove_metric(name_or_id=name_or_id)
 
     def get_logs(
         self, experiment_name: Optional[str] = None, save: bool = False
     ) -> pd.DataFrame:
-
         """
         Returns a table of experiment logs. Only works when ``log_experiment``
         is True when initializing the ``setup`` function.
 
 
         Example
         -------
```

## pycaret/clustering/functional.py

```diff
@@ -19,15 +19,15 @@
     "_CURRENT_EXPERIMENT": _CURRENT_EXPERIMENT_EXCEPTION
 }
 
 
 def setup(
     data: Optional[DATAFRAME_LIKE] = None,
     data_func: Optional[Callable[[], DATAFRAME_LIKE]] = None,
-    index: Union[bool, int, str, SEQUENCE_LIKE] = False,
+    index: Union[bool, int, str, SEQUENCE_LIKE] = True,
     ordinal_features: Optional[Dict[str, list]] = None,
     numeric_features: Optional[List[str]] = None,
     categorical_features: Optional[List[str]] = None,
     date_features: Optional[List[str]] = None,
     text_features: Optional[List[str]] = None,
     ignore_features: Optional[List[str]] = None,
     keep_features: Optional[List[str]] = None,
@@ -71,15 +71,14 @@
     log_profile: bool = False,
     log_data: bool = False,
     verbose: bool = True,
     memory: Union[bool, str, Memory] = True,
     profile: bool = False,
     profile_kwargs: Optional[Dict[str, Any]] = None,
 ):
-
     """
 
     This function initializes the training environment and creates the transformation
     pipeline. Setup function must be called before executing any other function. It
     takes one mandatory parameter: ``data``. All the other parameters are optional.
 
 
@@ -102,15 +101,15 @@
         The function that generate ``data`` (the dataframe-like input). This
         is useful when the dataset is large, and you need parallel operations
         such as ``compare_models``. It can avoid broadcasting large dataset
         from driver to workers. Notice one and only one of ``data`` and
         ``data_func`` must be set.
 
 
-    index: bool, int, str or sequence, default = False
+    index: bool, int, str or sequence, default = True
         Handle indices in the `data` dataframe.
             - If False: Reset to RangeIndex.
             - If True: Keep the provided index.
             - If int: Position of the column to use as index.
             - If str: Name of the column to use as index.
             - If sequence: Array with shape=(n_samples,) to use as index.
 
@@ -534,15 +533,14 @@
     round: int = 4,
     fit_kwargs: Optional[dict] = None,
     verbose: bool = True,
     experiment_custom_tags: Optional[Dict[str, Any]] = None,
     engine: Optional[str] = None,
     **kwargs,
 ):
-
     """
     This function trains and evaluates the performance of a given model.
     Metrics evaluated can be accessed using the ``get_metrics`` function.
     Custom metrics can be added or removed using the ``add_metric`` and
     ``remove_metric`` function. All the available models can be accessed
     using the ``models`` function.
 
@@ -644,15 +642,14 @@
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def assign_model(
     model, transformation: bool = False, verbose: bool = True
 ) -> pd.DataFrame:
-
     """
     This function assigns cluster labels to the dataset for a given model.
 
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -692,15 +689,14 @@
     plot: str = "cluster",
     feature: Optional[str] = None,
     label: bool = False,
     scale: float = 1,
     save: bool = False,
     display_format: Optional[str] = None,
 ) -> Optional[str]:
-
     """
     This function analyzes the performance of a trained model.
 
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -769,15 +765,14 @@
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def evaluate_model(
     model,
     feature: Optional[str] = None,
     fit_kwargs: Optional[dict] = None,
 ):
-
     """
     This function displays a user interface for analyzing performance of a trained
     model. It calls the ``plot_model`` function internally.
 
     Example
     --------
     >>> from pycaret.datasets import get_data
@@ -817,15 +812,14 @@
     return _CURRENT_EXPERIMENT.evaluate_model(
         estimator=model, feature_name=feature, fit_kwargs=fit_kwargs
     )
 
 
 # not using check_if_global_is_not_none on purpose
 def predict_model(model, data: pd.DataFrame) -> pd.DataFrame:
-
     """
     This function generates cluster labels using a trained model.
 
     Example
     -------
     >>> from pycaret.datasets import get_data
     >>> jewellery = get_data('jewellery')
@@ -963,28 +957,27 @@
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def save_model(
     model, model_name: str, model_only: bool = False, verbose: bool = True, **kwargs
 ):
-
     """
     This function saves the transformation pipeline and trained model object
     into the current working directory as a pickle file for later use.
 
 
     Example
     -------
     >>> from pycaret.datasets import get_data
     >>> jewellery = get_data('jewellery')
     >>> from pycaret.clustering import *
     >>> exp_name = setup(data = jewellery)
     >>> kmeans = create_model('kmeans')
-    >>> save_model(lr, 'saved_kmeans_model')
+    >>> save_model(kmeans, 'saved_kmeans_model')
 
 
     model: scikit-learn compatible object
         Trained model object
 
 
     model_name: str
@@ -1021,15 +1014,14 @@
 # not using check_if_global_is_not_none on purpose
 def load_model(
     model_name: str,
     platform: Optional[str] = None,
     authentication: Optional[Dict[str, str]] = None,
     verbose: bool = True,
 ):
-
     """
     This function loads a previously saved pipeline.
 
 
     Example
     -------
     >>> from pycaret.clustering import load_model
@@ -1096,15 +1088,14 @@
 
     """
     return _CURRENT_EXPERIMENT.pull(pop=pop)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def models(internal: bool = False, raise_errors: bool = True) -> pd.DataFrame:
-
     """
     Returns table of models available in the model library.
 
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -1133,15 +1124,14 @@
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def get_metrics(
     reset: bool = False,
     include_custom: bool = True,
     raise_errors: bool = True,
 ) -> pd.DataFrame:
-
     """
     Returns table of metrics available.
 
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -1264,15 +1254,14 @@
     """
 
     return _CURRENT_EXPERIMENT.remove_metric(name_or_id=name_or_id)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def get_logs(experiment_name: Optional[str] = None, save: bool = False) -> pd.DataFrame:
-
     """
     Returns a table of experiment logs. Only works when ``log_experiment``
     is True when initializing the ``setup`` function.
 
 
     Example
     -------
@@ -1298,15 +1287,14 @@
     """
 
     return _CURRENT_EXPERIMENT.get_logs(experiment_name=experiment_name, save=save)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def get_config(variable: Optional[str] = None):
-
     """
     This function is used to access global environment variables.
 
     Example
     -------
     >>> X_train = get_config('X_train')
 
@@ -1325,15 +1313,14 @@
     """
 
     return _CURRENT_EXPERIMENT.get_config(variable=variable)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def set_config(variable: str, value):
-
     """
     This function is used to reset global environment variables.
 
     Example
     -------
     >>> set_config('seed', 123)
```

## pycaret/containers/metrics/anomaly.py

```diff
@@ -90,15 +90,14 @@
         target: str = "pred",
         args: Dict[str, Any] = None,
         display_name: Optional[str] = None,
         greater_is_better: bool = True,
         needs_ground_truth: bool = False,
         is_custom: bool = False,
     ) -> None:
-
         allowed_targets = ["pred"]
         if target not in allowed_targets:
             raise ValueError(f"Target must be one of {', '.join(allowed_targets)}.")
 
         if not args:
             args = {}
         if not isinstance(args, dict):
```

## pycaret/containers/metrics/classification.py

```diff
@@ -96,15 +96,14 @@
         target: str = "pred",
         args: Optional[Dict[str, Any]] = None,
         display_name: Optional[str] = None,
         greater_is_better: bool = True,
         is_multiclass: bool = True,
         is_custom: bool = False,
     ) -> None:
-
         allowed_targets = ["pred", "pred_proba", "threshold"]
         if target not in allowed_targets:
             raise ValueError(f"Target must be one of {', '.join(allowed_targets)}.")
 
         if not args:
             args = {}
         if not isinstance(args, dict):
@@ -189,76 +188,79 @@
             scorer="accuracy",
         )
 
 
 class ROCAUCMetricContainer(ClassificationMetricContainer):
     def __init__(self, globals_dict: dict) -> None:
         args = {"average": "weighted", "multi_class": "ovr"}
+        score_func = pycaret.internal.metrics.BinaryMulticlassScoreFunc(
+            metrics.roc_auc_score,
+            kwargs_if_binary={"average": "macro", "multi_class": "raise"},
+        )
         super().__init__(
             id="auc",
             name="AUC",
-            score_func=metrics.roc_auc_score,
+            score_func=score_func,
             scorer=pycaret.internal.metrics.make_scorer_with_error_score(
-                metrics.roc_auc_score, needs_proba=True, error_score=0.0, **args
+                score_func, needs_proba=True, error_score=0.0, **args
             ),
             target="pred_proba",
             args=args,
         )
 
 
 class RecallMetricContainer(ClassificationMetricContainer):
     def __init__(self, globals_dict: dict) -> None:
         args = {"average": "weighted", **_get_pos_label_arg(globals_dict)}
+        score_func = pycaret.internal.metrics.BinaryMulticlassScoreFunc(
+            metrics.recall_score, kwargs_if_binary={"average": "binary"}
+        )
         super().__init__(
             id="recall",
             name="Recall",
-            score_func=pycaret.internal.metrics.BinaryMulticlassScoreFunc(
-                metrics.recall_score
-            ),
+            score_func=score_func,
             scorer=metrics.make_scorer(
-                pycaret.internal.metrics.BinaryMulticlassScoreFunc(
-                    metrics.recall_score
-                ),
+                score_func,
                 **args,
             ),
             args=args,
         )
 
 
 class PrecisionMetricContainer(ClassificationMetricContainer):
     def __init__(self, globals_dict: dict) -> None:
         args = {"average": "weighted", **_get_pos_label_arg(globals_dict)}
+        score_func = pycaret.internal.metrics.BinaryMulticlassScoreFunc(
+            metrics.precision_score, kwargs_if_binary={"average": "binary"}
+        )
         super().__init__(
             id="precision",
             name="Precision",
             display_name="Prec.",
-            score_func=pycaret.internal.metrics.BinaryMulticlassScoreFunc(
-                metrics.precision_score
-            ),
+            score_func=score_func,
             scorer=metrics.make_scorer(
-                pycaret.internal.metrics.BinaryMulticlassScoreFunc(
-                    metrics.precision_score
-                ),
+                score_func,
                 **args,
             ),
             args=args,
         )
 
 
 class F1MetricContainer(ClassificationMetricContainer):
     def __init__(self, globals_dict: dict) -> None:
         args = {"average": "weighted", **_get_pos_label_arg(globals_dict)}
+        score_func = pycaret.internal.metrics.BinaryMulticlassScoreFunc(
+            metrics.f1_score, kwargs_if_binary={"average": "binary"}
+        )
         super().__init__(
             id="f1",
             name="F1",
-            score_func=pycaret.internal.metrics.BinaryMulticlassScoreFunc(
-                metrics.f1_score
-            ),
+            score_func=score_func,
             scorer=metrics.make_scorer(
-                pycaret.internal.metrics.BinaryMulticlassScoreFunc(metrics.f1_score),
+                score_func,
                 **args,
             ),
             args=args,
         )
 
 
 class KappaMetricContainer(ClassificationMetricContainer):
```

## pycaret/containers/metrics/clustering.py

```diff
@@ -91,15 +91,14 @@
         target: str = "pred",
         args: Dict[str, Any] = None,
         display_name: Optional[str] = None,
         greater_is_better: bool = True,
         needs_ground_truth: bool = False,
         is_custom: bool = False,
     ) -> None:
-
         allowed_targets = ["pred"]
         if target not in allowed_targets:
             raise ValueError(f"Target must be one of {', '.join(allowed_targets)}.")
 
         if not args:
             args = {}
         if not isinstance(args, dict):
```

## pycaret/containers/metrics/regression.py

```diff
@@ -87,15 +87,14 @@
         scorer: Optional[Union[str, _BaseScorer]] = None,
         target: str = "pred",
         args: Dict[str, Any] = None,
         display_name: Optional[str] = None,
         greater_is_better: bool = True,
         is_custom: bool = False,
     ) -> None:
-
         allowed_targets = ["pred"]
         if target not in allowed_targets:
             raise ValueError(f"Target must be one of {', '.join(allowed_targets)}.")
 
         if not args:
             args = {}
         if not isinstance(args, dict):
@@ -176,28 +175,26 @@
             greater_is_better=False,
             scorer="neg_mean_squared_error",
         )
 
 
 class RMSEMetricContainer(RegressionMetricContainer):
     def __init__(self, globals_dict: dict) -> None:
-
         super().__init__(
             id="rmse",
             name="RMSE",
             score_func=metrics.mean_squared_error,
             greater_is_better=False,
             args={"squared": False},
             scorer="neg_root_mean_squared_error",
         )
 
 
 class R2MetricContainer(RegressionMetricContainer):
     def __init__(self, globals_dict: dict) -> None:
-
         super().__init__(
             id="r2",
             name="R2",
             score_func=metrics.r2_score,
             greater_is_better=True,
             scorer="r2",
         )
```

## pycaret/containers/metrics/time_series.py

```diff
@@ -87,15 +87,14 @@
         scorer: Optional[Union[str, _BaseScorer]] = None,
         target: str = "pred",
         args: Dict[str, Any] = None,
         display_name: Optional[str] = None,
         greater_is_better: bool = True,
         is_custom: bool = False,
     ) -> None:
-
         allowed_targets = ["pred"]
         if target not in allowed_targets:
             raise ValueError(f"Target must be one of {', '.join(allowed_targets)}.")
 
         if not args:
             args = {}
         if not isinstance(args, dict):
@@ -266,15 +265,14 @@
             greater_is_better=False,
             scorer="neg_mean_absolute_error",
         )
 
 
 class RMSEMetricContainer(TimeSeriesMetricContainer):
     def __init__(self, globals_dict: dict) -> None:
-
         super().__init__(
             id="rmse",
             name="RMSE",
             score_func=metrics.mean_squared_error,
             greater_is_better=False,
             args={"squared": False},
             scorer="neg_root_mean_squared_error",
@@ -293,15 +291,14 @@
         super().__init__(
             id="smape", name="SMAPE", score_func=_smape_loss, greater_is_better=False
         )
 
 
 class R2MetricContainer(TimeSeriesMetricContainer):
     def __init__(self, globals_dict: dict) -> None:
-
         super().__init__(
             id="r2",
             name="R2",
             score_func=metrics.r2_score,
             greater_is_better=True,
             scorer="r2",
         )
```

## pycaret/containers/models/anomaly.py

```diff
@@ -85,15 +85,14 @@
         args: Dict[str, Any] = None,
         is_special: bool = False,
         tune_grid: Dict[str, list] = None,
         tune_distribution: Dict[str, Distribution] = None,
         tune_args: Dict[str, Any] = None,
         is_gpu_enabled: Optional[bool] = None,
     ) -> None:
-
         if not args:
             args = {}
 
         if not tune_grid:
             tune_grid = {}
 
         if not tune_distribution:
@@ -203,25 +202,25 @@
         )
 
 
 class COFAnomalyContainer(AnomalyContainer):
     def __init__(self, experiment):
         get_logger()
         np.random.seed(experiment.seed)
-        from pycaret.internal.patches.pyod import COFPatched
+        from pyod.models.cof import COF
 
         args = {}
         tune_args = {}
         tune_grid = {}
         tune_distributions = {}
 
         super().__init__(
             id="cof",
             name="Connectivity-Based Local Outlier",
-            class_def=COFPatched,
+            class_def=COF,
             args=args,
             tune_grid=tune_grid,
             tune_distribution=tune_distributions,
             tune_args=tune_args,
         )
 
 
@@ -391,47 +390,47 @@
         )
 
 
 class SODAnomalyContainer(AnomalyContainer):
     def __init__(self, experiment):
         get_logger()
         np.random.seed(experiment.seed)
-        from pycaret.internal.patches.pyod import SODPatched
+        from pyod.models.sod import SOD
 
         args = {}
         tune_args = {}
         tune_grid = {}
         tune_distributions = {}
 
         super().__init__(
             id="sod",
             name="Subspace Outlier Detection",
-            class_def=SODPatched,
+            class_def=SOD,
             args=args,
             tune_grid=tune_grid,
             tune_distribution=tune_distributions,
             tune_args=tune_args,
         )
 
 
 class SOSAnomalyContainer(AnomalyContainer):
     def __init__(self, experiment):
         get_logger()
         np.random.seed(experiment.seed)
-        from pycaret.internal.patches.pyod import SOSPatched
+        from pyod.models.sos import SOS
 
         args = {}
         tune_args = {}
         tune_grid = {}
         tune_distributions = {}
 
         super().__init__(
             id="sos",
             name="Stochastic Outlier Selection",
-            class_def=SOSPatched,
+            class_def=SOS,
             args=args,
             tune_grid=tune_grid,
             tune_distribution=tune_distributions,
             tune_args=tune_args,
         )
```

## pycaret/containers/models/classification.py

```diff
@@ -146,15 +146,14 @@
         tune_args: Dict[str, Any] = None,
         shap: Union[bool, str] = False,
         is_gpu_enabled: Optional[bool] = None,
         is_boosting_supported: Optional[bool] = None,
         is_soft_voting_supported: Optional[bool] = None,
         tunable: Optional[type] = None,
     ) -> None:
-
         self.shap = shap
         if not (isinstance(shap, bool) or shap in ["type1", "type2"]):
             raise ValueError("shap must be either bool or 'type1', 'type2'.")
 
         if not args:
             args = {}
 
@@ -1420,17 +1419,15 @@
             return
 
         from catboost import CatBoostClassifier
 
         # suppress output
         logging.getLogger("catboost").setLevel(logging.ERROR)
 
-        use_gpu = experiment.gpu_param == "force" or (
-            experiment.gpu_param and len(experiment.X_train) >= 50000
-        )
+        use_gpu = experiment.gpu_param
 
         args = {
             "random_state": experiment.seed,
             "verbose": False,
             "thread_count": experiment.n_jobs_param,
             "task_type": "GPU" if use_gpu else "CPU",
             "border_count": 32 if use_gpu else 254,
@@ -1464,15 +1461,15 @@
             "n_estimators": IntUniformDistribution(10, 300),
             "random_strength": UniformDistribution(0, 0.8),
             "l2_leaf_reg": IntUniformDistribution(1, 200, log=True),
         }
 
         if use_gpu:
             tune_grid["depth"] = list(range(1, 9))
-            tune_distributions["depth"] = (IntUniformDistribution(1, 8),)
+            tune_distributions["depth"] = IntUniformDistribution(1, 8)
 
         leftover_parameters_to_categorical_distributions(tune_grid, tune_distributions)
 
         super().__init__(
             id="catboost",
             name="CatBoost Classifier",
             class_def=CatBoostClassifier,
```

## pycaret/containers/models/clustering.py

```diff
@@ -107,15 +107,14 @@
         args: Dict[str, Any] = None,
         is_special: bool = False,
         tune_grid: Dict[str, list] = None,
         tune_distribution: Dict[str, Distribution] = None,
         tune_args: Dict[str, Any] = None,
         is_gpu_enabled: Optional[bool] = None,
     ) -> None:
-
         if not args:
             args = {}
 
         if not tune_grid:
             tune_grid = {}
 
         if not tune_distribution:
```

## pycaret/containers/models/regression.py

```diff
@@ -137,15 +137,14 @@
         tune_grid: Dict[str, list] = None,
         tune_distribution: Dict[str, Distribution] = None,
         tune_args: Dict[str, Any] = None,
         shap: Union[bool, str] = False,
         is_gpu_enabled: Optional[bool] = None,
         tunable: Optional[type] = None,
     ) -> None:
-
         self.shap = shap
         if not (isinstance(shap, bool) or shap in ["type1", "type2"]):
             raise ValueError("shap must be either bool or 'type1', 'type2'.")
 
         if not args:
             args = {}
 
@@ -1798,17 +1797,15 @@
             return
 
         from catboost import CatBoostRegressor
 
         # suppress output
         logging.getLogger("catboost").setLevel(logging.ERROR)
 
-        use_gpu = experiment.gpu_param == "force" or (
-            experiment.gpu_param and len(experiment.X_train) >= 50000
-        )
+        use_gpu = experiment.gpu_param
 
         args = {
             "random_state": experiment.seed,
             "verbose": False,
             "thread_count": experiment.n_jobs_param,
             "task_type": "GPU" if use_gpu else "CPU",
             "border_count": 32 if use_gpu else 254,
@@ -1842,15 +1839,15 @@
             "n_estimators": IntUniformDistribution(10, 300),
             "random_strength": UniformDistribution(0, 0.8),
             "l2_leaf_reg": IntUniformDistribution(1, 200, log=True),
         }
 
         if use_gpu:
             tune_grid["depth"] = list(range(1, 9))
-            tune_distributions["depth"] = (IntUniformDistribution(1, 8),)
+            tune_distributions["depth"] = IntUniformDistribution(1, 8)
 
         leftover_parameters_to_categorical_distributions(tune_grid, tune_distributions)
 
         super().__init__(
             id="catboost",
             name="CatBoost Regressor",
             class_def=CatBoostRegressor,
```

## pycaret/containers/models/time_series.py

```diff
@@ -170,15 +170,14 @@
         is_special: bool = False,
         tune_grid: Dict[str, list] = None,
         tune_distribution: Dict[str, Union[List[Any], Distribution]] = None,
         tune_args: Dict[str, Any] = None,
         is_gpu_enabled: Optional[bool] = None,
         tunable: Optional[type] = None,
     ) -> None:
-
         if not args:
             args = {}
 
         if not tune_grid:
             tune_grid = {}
 
         if not tune_distribution:
@@ -556,15 +555,14 @@
             D_start: int,
             D_end: int,
             Q_start: int,
             Q_end: int,
             sp: int,
             seasonal_max_multiplier: int,
         ) -> Tuple[List[Tuple[int, int, int]], List[Tuple[int, int, int, int]]]:
-
             random.seed(experiment.seed)
             np.random.seed(experiment.seed)
             p_values = [random.randint(p_start, p_end) for _ in range(n_samples)]
             q_values = [random.randint(q_start, q_end) for _ in range(n_samples)]
             d_values = [random.randint(d_start, d_end) for _ in range(n_samples)]
             orders = list(zip(p_values, d_values, q_values))
 
@@ -773,14 +771,15 @@
         self.active = _check_enforcements(forecaster=dummy, experiment=experiment)
         if not self.active:
             return
 
         self.seasonality_present = experiment.seasonality_present
         self.sp = experiment.primary_sp_to_use
         self.strictly_positive = experiment.strictly_positive
+        self.seasonality_type = experiment.seasonality_type
 
         args = self._set_args
         tune_args = self._set_tune_args
         tune_grid = self._set_tune_grid
         tune_distributions = self._set_tune_distributions
         leftover_parameters_to_categorical_distributions(tune_grid, tune_distributions)
 
@@ -796,148 +795,84 @@
             tune_args=tune_args,
             is_gpu_enabled=self.gpu_imported,
             eq_function=eq_function,  # Added to differentiate between ExponentialSmoothing and Theta which are of same parent class
         )
 
     @property
     def _set_args(self) -> Dict[str, Any]:
-        # TODO: Check if there is a formal test for type of seasonality
-        if self.seasonality_present and self.strictly_positive:
-            seasonal = "mul"
-        elif self.seasonality_present and not self.strictly_positive:
-            seasonal = "add"
-        else:
-            seasonal = None
-        args = {"sp": self.sp, "seasonal": seasonal}
+        args = {"sp": self.sp, "seasonal": self.seasonality_type}
         # Add irrespective of whether seasonality is present or not
         args["trend"] = "add"
         return args
 
     @property
     def _set_tune_grid(self) -> Dict[str, List[Any]]:
         if self.seasonality_present:
             tune_grid = {
-                # TODO: Check if add and additive are doing the same thing
-                "trend": ["add", "mul", "additive", "multiplicative", None]
+                "trend": ["add", "mul", None]
                 if self.strictly_positive
-                else ["add", "additive", None],
+                else ["add", None],
                 # "damped_trend": [True, False],
-                "seasonal": ["add", "mul", "additive", "multiplicative"]
-                if self.strictly_positive
-                else ["add", "additive"],
+                "seasonal": ["add", "mul"] if self.strictly_positive else ["add"],
                 "use_boxcox": [True, False] if self.strictly_positive else [False],
                 "sp": [self.sp],
             }
         else:
             tune_grid = {
-                # TODO: Check if add and additive are doing the same thing
-                "trend": ["add", "mul", "additive", "multiplicative", None]
+                "trend": ["add", "mul", None]
                 if self.strictly_positive
-                else ["add", "additive", None],
+                else ["add", None],
                 # "damped_trend": [True, False],
                 "seasonal": [None],
                 "use_boxcox": [True, False] if self.strictly_positive else [False],
                 "sp": [None],
             }
         return tune_grid
 
     @property
     def _set_tune_distributions(self) -> Dict[str, List[Any]]:
         if self.seasonality_present:
             tune_distributions = {
                 "trend": CategoricalDistribution(
-                    values=["add", "mul", "additive", "multiplicative", None]
+                    values=["add", "mul", None]
                     if self.strictly_positive
-                    else ["add", "additive", None],
+                    else ["add", None],
                 ),
                 # "damped_trend": [True, False],
                 "seasonal": CategoricalDistribution(
-                    values=["add", "mul", "additive", "multiplicative"]
-                    if self.strictly_positive
-                    else ["add", "additive"],
+                    values=["add", "mul"] if self.strictly_positive else ["add"],
                 ),
                 # "initial_level": UniformDistribution(lower=0, upper=1),  # ValueError: initialization method is estimated but initial_level has been set.
                 # "initial_trend": UniformDistribution(lower=0, upper=1),  # ValueError: initialization method is estimated but initial_trend has been set.
                 # "initial_seasonal": UniformDistribution(lower=0, upper=1), # ValueError: initialization method is estimated but initial_seasonal has been set.
                 "use_boxcox": CategoricalDistribution(
                     values=[True, False] if self.strictly_positive else [False]
                 ),  # 'log', float
                 "sp": CategoricalDistribution(values=[self.sp, 2 * self.sp]),
             }
         else:
             tune_distributions = {
                 "trend": CategoricalDistribution(
-                    values=["add", "mul", "additive", "multiplicative", None]
+                    values=["add", "mul", None]
                     if self.strictly_positive
-                    else ["add", "additive", None],
+                    else ["add", None],
                 ),
                 # "damped_trend": [True, False],
                 "seasonal": CategoricalDistribution(values=[None]),
                 # "initial_level": UniformDistribution(lower=0, upper=1),  # ValueError: initialization method is estimated but initial_level has been set.
                 # "initial_trend": UniformDistribution(lower=0, upper=1),  # ValueError: initialization method is estimated but initial_trend has been set.
                 # "initial_seasonal": UniformDistribution(lower=0, upper=1), # ValueError: initialization method is estimated but initial_seasonal has been set.
                 "use_boxcox": CategoricalDistribution(
                     values=[True, False] if self.strictly_positive else [False]
                 ),  # 'log', float
                 "sp": CategoricalDistribution(values=[None]),
             }
         return tune_distributions
 
 
-class CrostonContainer(TimeSeriesContainer):
-    """
-    SKtime documentation:
-    https://www.sktime.org/en/latest/api_reference/auto_generated/sktime.forecasting.croston.Croston.html
-
-    """
-
-    model_type = TSModelTypes.CLASSICAL
-
-    def __init__(self, experiment) -> None:
-        self.logger = get_logger()
-        np.random.seed(experiment.seed)
-        self.gpu_imported = False
-
-        from sktime.forecasting.croston import Croston  # type: ignore
-
-        # Disable container if certain features are not supported but enforced ----
-        dummy = Croston()
-        self.active = _check_enforcements(forecaster=dummy, experiment=experiment)
-        if not self.active:
-            return
-
-        tune_grid = self._set_tune_grid
-        tune_distributions = self._set_tune_distributions
-        leftover_parameters_to_categorical_distributions(tune_grid, tune_distributions)
-
-        super().__init__(
-            id="croston",
-            name="Croston",
-            class_def=Croston,
-            tune_grid=tune_grid,
-            tune_distribution=tune_distributions,
-            is_gpu_enabled=self.gpu_imported,
-        )
-
-    @property
-    def _set_tune_grid(self) -> Dict[str, List[Any]]:
-        # lack of research/evidence for suitable range here,
-        # SKtime and R implementations are default 0.1
-        smoothing_grid: List[float] = [0.01, 0.03, 0.1, 0.2, 0.4, 0.6, 0.8, 1.0]
-        tune_grid = {"smoothing": smoothing_grid}
-        return tune_grid
-
-    @property
-    def _set_tune_distributions(self) -> Dict[str, List[Any]]:
-        tune_distributions = {
-            "smoothing": UniformDistribution(lower=0.01, upper=1, log=True)
-        }
-        return tune_distributions
-
-
 class ETSContainer(TimeSeriesContainer):
     model_type = TSModelTypes.CLASSICAL
 
     def __init__(self, experiment) -> None:
         self.logger = get_logger()
         np.random.seed(experiment.seed)
         self.gpu_imported = False
@@ -949,14 +884,15 @@
         self.active = _check_enforcements(forecaster=dummy, experiment=experiment)
         if not self.active:
             return
 
         self.seasonality_present = experiment.seasonality_present
         self.sp = experiment.primary_sp_to_use
         self.strictly_positive = experiment.strictly_positive
+        self.seasonality_type = experiment.seasonality_type
 
         args = self._set_args
         tune_args = self._set_tune_args
         tune_grid = self._set_tune_grid
         tune_distributions = self._set_tune_distributions
         leftover_parameters_to_categorical_distributions(tune_grid, tune_distributions)
 
@@ -969,22 +905,15 @@
             tune_distribution=tune_distributions,
             tune_args=tune_args,
             is_gpu_enabled=self.gpu_imported,
         )
 
     @property
     def _set_args(self) -> Dict[str, Any]:
-        # TODO: Check if there is a formal test for type of seasonality
-        if self.seasonality_present and self.strictly_positive:
-            seasonal = "mul"
-        elif self.seasonality_present and not self.strictly_positive:
-            seasonal = "add"
-        else:
-            seasonal = None
-        args = {"sp": self.sp, "seasonal": seasonal}
+        args = {"sp": self.sp, "seasonal": self.seasonality_type}
         # Add irrespective of whether seasonality is present or not
         args["trend"] = "add"
         return args
 
     @property
     def _set_tune_grid(self) -> Dict[str, List[Any]]:
         if self.seasonality_present:
@@ -1093,45 +1022,152 @@
         else:
             tune_distributions = {
                 # "initial_level": UniformDistribution(lower=0, upper=1),  # ValueError: initialization method is estimated but initial_level has been set.
             }
         return tune_distributions
 
 
-class TBATSContainer(TimeSeriesContainer):
+class STLFContainer(TimeSeriesContainer):
     model_type = TSModelTypes.CLASSICAL
 
     def __init__(self, experiment) -> None:
         self.logger = get_logger()
         np.random.seed(experiment.seed)
         self.gpu_imported = False
 
-        from sktime.forecasting.tbats import TBATS
+        from sktime.forecasting.trend import STLForecaster
 
         # Disable container if certain features are not supported but enforced ----
-        dummy = TBATS()
+        dummy = STLForecaster()
         self.active = _check_enforcements(forecaster=dummy, experiment=experiment)
         if not self.active:
             return
 
-        self.sp = experiment.all_sps_to_use
+        self.seasonality_present = experiment.seasonality_present
+        self.sp = experiment.primary_sp_to_use
+        self.strictly_positive = experiment.strictly_positive
+
+        if self.sp == 1:
+            self.active = False
+            return
+
+        args = self._set_args
+        tune_args = self._set_tune_args
+        tune_grid = self._set_tune_grid
+        tune_distributions = self._set_tune_distributions
+        leftover_parameters_to_categorical_distributions(tune_grid, tune_distributions)
 
+        super().__init__(
+            id="stlf",
+            name="STLF",
+            class_def=STLForecaster,
+            args=args,
+            tune_grid=tune_grid,
+            tune_distribution=tune_distributions,
+            tune_args=tune_args,
+            is_gpu_enabled=self.gpu_imported,
+        )
+
+    @property
+    def _set_args(self) -> Dict[str, Any]:
+        args = {"sp": self.sp}
+        return args
+
+    @property
+    def _set_tune_grid(self) -> Dict[str, List[Any]]:
+        # TODO: There may be other hyperparameters to tune. Check:
+        # http://www.sktime.net/en/latest/api_reference/auto_generated/sktime.forecasting.trend.STLForecaster.html
+        tune_grid = {
+            "sp": [self.sp],
+            "seasonal_deg": [0, 1],
+            "trend_deg": [0, 1],
+            "low_pass_deg": [0, 1],
+            "robust": [True, False],
+        }
+        return tune_grid
+
+
+class CrostonContainer(TimeSeriesContainer):
+    """
+    SKtime documentation:
+    https://www.sktime.org/en/latest/api_reference/auto_generated/sktime.forecasting.croston.Croston.html
+    """
+
+    model_type = TSModelTypes.CLASSICAL
+
+    def __init__(self, experiment) -> None:
+        self.logger = get_logger()
+        np.random.seed(experiment.seed)
+        self.gpu_imported = False
+        from sktime.forecasting.croston import Croston  # type: ignore
+
+        # Disable container if certain features are not supported but enforced ----
+        dummy = Croston()
+        self.active = _check_enforcements(forecaster=dummy, experiment=experiment)
+        if not self.active:
+            return
+        tune_grid = self._set_tune_grid
+        tune_distributions = self._set_tune_distributions
+        leftover_parameters_to_categorical_distributions(tune_grid, tune_distributions)
+        super().__init__(
+            id="croston",
+            name="Croston",
+            class_def=Croston,
+            tune_grid=tune_grid,
+            tune_distribution=tune_distributions,
+            is_gpu_enabled=self.gpu_imported,
+        )
+
+    @property
+    def _set_tune_grid(self) -> Dict[str, List[Any]]:
+        # lack of research/evidence for suitable range here,
+        # SKtime and R implementations are default 0.1
+        smoothing_grid: List[float] = [0.01, 0.03, 0.1, 0.2, 0.4, 0.6, 0.8, 1.0]
+        tune_grid = {"smoothing": smoothing_grid}
+        return tune_grid
+
+    @property
+    def _set_tune_distributions(self) -> Dict[str, List[Any]]:
+        tune_distributions = {
+            "smoothing": UniformDistribution(lower=0.01, upper=1, log=True)
+        }
+        return tune_distributions
+
+
+class BATSContainer(TimeSeriesContainer):
+    model_type = TSModelTypes.CLASSICAL
+
+    def __init__(self, experiment) -> None:
+        self.logger = get_logger()
+        np.random.seed(experiment.seed)
+        self.gpu_imported = False
+
+        from sktime.forecasting.bats import BATS  # type: ignore
+
+        # Disable container if certain features are not supported but enforced ----
+        dummy = BATS()
+        self.active = _check_enforcements(forecaster=dummy, experiment=experiment)
+        if not self.active:
+            return
+
+        self.sp = experiment.primary_sp_to_use
         self.seasonality_present = experiment.seasonality_present
+        self.n_jobs_param = experiment.n_jobs_param
 
         args = self._set_args
         tune_args = self._set_tune_args
         tune_grid = self._set_tune_grid
         tune_distributions = self._set_tune_distributions
 
         leftover_parameters_to_categorical_distributions(tune_grid, tune_distributions)
 
         super().__init__(
-            id="tbats",
-            name="TBATS",
-            class_def=TBATS,
+            id="bats",
+            name="BATS",
+            class_def=BATS,
             args=args,
             tune_grid=tune_grid,
             tune_distribution=tune_distributions,
             tune_args=tune_args,
             is_gpu_enabled=self.gpu_imported,
             is_turbo=False,
         )
@@ -1139,61 +1175,68 @@
     @property
     def _set_args(self) -> dict:
         args = (
             {
                 "sp": self.sp,
                 "use_box_cox": True,
                 "use_arma_errors": True,
+                # "n_jobs": self.n_jobs_param,  # causes issues with multiprocessing
                 "show_warnings": False,
             }
             if self.seasonality_present
             else {}
         )
         return args
 
     @property
     def _set_tune_grid(self) -> dict:
+        # None considers both True and False and selects the best one.
         tune_grid = {
-            "use_damped_trend": [True, False],
-            "use_trend": [True, False],
             "sp": [self.sp],
+            "use_box_cox": [None],
+            "use_trend": [None],
+            "use_damped_trend": [None],
+            "use_arma_errors": [None],
+            # "n_jobs": [self.n_jobs_param],  # causes issues with multiprocessing
+            "show_warnings": [False],
         }
         return tune_grid
 
 
-class BATSContainer(TimeSeriesContainer):
+class TBATSContainer(TimeSeriesContainer):
     model_type = TSModelTypes.CLASSICAL
 
     def __init__(self, experiment) -> None:
         self.logger = get_logger()
         np.random.seed(experiment.seed)
         self.gpu_imported = False
 
-        from sktime.forecasting.bats import BATS  # type: ignore
+        from sktime.forecasting.tbats import TBATS
 
         # Disable container if certain features are not supported but enforced ----
-        dummy = BATS()
+        dummy = TBATS()
         self.active = _check_enforcements(forecaster=dummy, experiment=experiment)
         if not self.active:
             return
 
-        self.sp = experiment.primary_sp_to_use
+        self.sp = experiment.all_sps_to_use
         self.seasonality_present = experiment.seasonality_present
+        self.n_jobs_param = experiment.n_jobs_param
 
         args = self._set_args
         tune_args = self._set_tune_args
         tune_grid = self._set_tune_grid
         tune_distributions = self._set_tune_distributions
 
         leftover_parameters_to_categorical_distributions(tune_grid, tune_distributions)
 
         super().__init__(
-            id="bats",
-            name="BATS",
-            class_def=BATS,
+            id="tbats",
+            name="TBATS",
+            class_def=TBATS,
             args=args,
             tune_grid=tune_grid,
             tune_distribution=tune_distributions,
             tune_args=tune_args,
             is_gpu_enabled=self.gpu_imported,
             is_turbo=False,
         )
@@ -1201,27 +1244,33 @@
     @property
     def _set_args(self) -> dict:
         args = (
             {
                 "sp": self.sp,
                 "use_box_cox": True,
                 "use_arma_errors": True,
+                # "n_jobs": self.n_jobs_param,  # causes issues with multiprocessing
                 "show_warnings": False,
             }
             if self.seasonality_present
             else {}
         )
         return args
 
     @property
     def _set_tune_grid(self) -> dict:
+        # None considers both True and False and selects the best one.
         tune_grid = {
-            "use_damped_trend": [True, False],
-            "use_trend": [True, False],
             "sp": [self.sp],
+            "use_box_cox": [None],
+            "use_trend": [None],
+            "use_damped_trend": [None],
+            "use_arma_errors": [None],
+            # "n_jobs": [self.n_jobs_param],  # causes issues with multiprocessing
+            "show_warnings": [False],
         }
         return tune_grid
 
 
 class ProphetContainer(TimeSeriesContainer):
     model_type = TSModelTypes.LINEAR
 
@@ -1434,15 +1483,14 @@
 class LinearCdsDtContainer(CdsDtContainer):
     id = "lr_cds_dt"
     name = "Linear w/ Cond. Deseasonalize & Detrending"
     active = True  # set back to True as the parent has False
     model_type = TSModelTypes.LINEAR
 
     def return_regressor_class(self):
-
         if self.engine == "sklearn":
             from sklearn.linear_model import LinearRegression
         elif self.engine == "sklearnex":
             _check_soft_dependencies("sklearnex", extra=None, severity="error")
             from sklearnex.linear_model import LinearRegression
 
         if self.gpu_param == "force":
@@ -1490,15 +1538,14 @@
 class ElasticNetCdsDtContainer(CdsDtContainer):
     id = "en_cds_dt"
     name = "Elastic Net w/ Cond. Deseasonalize & Detrending"
     active = True  # set back to True as the parent has False
     model_type = TSModelTypes.LINEAR
 
     def return_regressor_class(self):
-
         if self.engine == "sklearn":
             from sklearn.linear_model import ElasticNet
         elif self.engine == "sklearnex":
             _check_soft_dependencies("sklearnex", extra=None, severity="error")
             from sklearnex.linear_model import ElasticNet
 
         if self.gpu_param == "force":
@@ -1550,15 +1597,14 @@
 class RidgeCdsDtContainer(CdsDtContainer):
     id = "ridge_cds_dt"
     name = "Ridge w/ Cond. Deseasonalize & Detrending"
     active = True  # set back to True as the parent has False
     model_type = TSModelTypes.LINEAR
 
     def return_regressor_class(self):
-
         if self.engine == "sklearn":
             from sklearn.linear_model import Ridge
         elif self.engine == "sklearnex":
             _check_soft_dependencies("sklearnex", extra=None, severity="error")
             from sklearnex.linear_model import Ridge
 
         if self.gpu_param == "force":
@@ -1609,15 +1655,14 @@
 class LassoCdsDtContainer(CdsDtContainer):
     id = "lasso_cds_dt"
     name = "Lasso w/ Cond. Deseasonalize & Detrending"
     active = True  # set back to True as the parent has False
     model_type = TSModelTypes.LINEAR
 
     def return_regressor_class(self):
-
         if self.engine == "sklearn":
             from sklearn.linear_model import Lasso
         elif self.engine == "sklearnex":
             _check_soft_dependencies("sklearnex", extra=None, severity="error")
             from sklearnex.linear_model import Lasso
 
         if self.gpu_param == "force":
@@ -1661,54 +1706,54 @@
             "window_length": IntUniformDistribution(lower=self.sp, upper=2 * self.sp),
             "regressor__alpha": UniformDistribution(0.001, 10),
             "regressor__fit_intercept": CategoricalDistribution(values=[True, False]),
         }
         return tune_distributions
 
 
-class LarsCdsDtContainer(CdsDtContainer):
-    id = "lar_cds_dt"
-    name = "Least Angular Regressor w/ Cond. Deseasonalize & Detrending"
-    active = True  # set back to True as the parent has False
-    model_type = TSModelTypes.LINEAR
-
-    def return_regressor_class(self):
-        from sklearn.linear_model import Lars
-
-        return Lars
-
-    @property
-    def _set_tune_grid(self) -> Dict[str, List[Any]]:
-        tune_grid = {
-            "sp": [self.sp],
-            "deseasonal_model": ["additive"],
-            "degree": [1],
-            "window_length": [10],
-            "regressor__eps": [0.0001, 0.001, 0.01, 0.1],
-            "regressor__fit_intercept": [True, False],
-        }
-        return tune_grid
-
-    @property
-    def _set_tune_distributions(self) -> Dict[str, List[Any]]:
-        tune_distributions = {
-            "sp": CategoricalDistribution(
-                values=[self.sp, 2 * self.sp]
-            ),  # TODO: 'None' errors out here
-            "deseasonal_model": CategoricalDistribution(
-                values=["additive", "multiplicative"]
-                if self.strictly_positive
-                else ["additive"]
-            ),
-            "degree": IntUniformDistribution(lower=1, upper=10),
-            "window_length": IntUniformDistribution(lower=self.sp, upper=2 * self.sp),
-            "regressor__eps": UniformDistribution(0.00001, 0.1, log=True),
-            "regressor__fit_intercept": CategoricalDistribution(values=[True, False]),
-        }
-        return tune_distributions
+# class LarsCdsDtContainer(CdsDtContainer):
+#     id = "lar_cds_dt"
+#     name = "Least Angular Regressor w/ Cond. Deseasonalize & Detrending"
+#     active = True  # set back to True as the parent has False
+#     model_type = TSModelTypes.LINEAR
+
+#     def return_regressor_class(self):
+#         from sklearn.linear_model import Lars
+
+#         return Lars
+
+#     @property
+#     def _set_tune_grid(self) -> Dict[str, List[Any]]:
+#         tune_grid = {
+#             "sp": [self.sp],
+#             "deseasonal_model": ["additive"],
+#             "degree": [1],
+#             "window_length": [10],
+#             "regressor__eps": [0.0001, 0.001, 0.01, 0.1],
+#             "regressor__fit_intercept": [True, False],
+#         }
+#         return tune_grid
+
+#     @property
+#     def _set_tune_distributions(self) -> Dict[str, List[Any]]:
+#         tune_distributions = {
+#             "sp": CategoricalDistribution(
+#                 values=[self.sp, 2 * self.sp]
+#             ),  # TODO: 'None' errors out here
+#             "deseasonal_model": CategoricalDistribution(
+#                 values=["additive", "multiplicative"]
+#                 if self.strictly_positive
+#                 else ["additive"]
+#             ),
+#             "degree": IntUniformDistribution(lower=1, upper=10),
+#             "window_length": IntUniformDistribution(lower=self.sp, upper=2 * self.sp),
+#             "regressor__eps": UniformDistribution(0.00001, 0.1, log=True),
+#             "regressor__fit_intercept": CategoricalDistribution(values=[True, False]),
+#         }
+#         return tune_distributions
 
 
 class LassoLarsCdsDtContainer(CdsDtContainer):
     id = "llar_cds_dt"
     name = "Lasso Least Angular Regressor w/ Cond. Deseasonalize & Detrending"
     active = True  # set back to True as the parent has False
     model_type = TSModelTypes.LINEAR
@@ -1854,57 +1899,57 @@
             "window_length": IntUniformDistribution(lower=self.sp, upper=2 * self.sp),
             "regressor__epsilon": UniformDistribution(1, 2),
             "regressor__alpha": UniformDistribution(0.0000000001, 0.9999999999),
         }
         return tune_distributions
 
 
-class PassiveAggressiveCdsDtContainer(CdsDtContainer):
-    id = "par_cds_dt"
-    name = "Passive Aggressive w/ Cond. Deseasonalize & Detrending"
-    active = True  # set back to True as the parent has False
-    model_type = TSModelTypes.LINEAR
-
-    def return_regressor_class(self):
-        from sklearn.linear_model import PassiveAggressiveRegressor
-
-        return PassiveAggressiveRegressor
-
-    @property
-    def _set_tune_grid(self) -> Dict[str, List[Any]]:
-        tune_grid = {
-            "sp": [self.sp],
-            "deseasonal_model": ["additive"],
-            "degree": [1],
-            "window_length": [10],
-            "regressor__epsilon": [0.1, 0.5, 0.9],
-            "regressor__C": [0, 5, 10],
-            "regressor__fit_intercept": [True, False],
-            "regressor__loss": ["epsilon_insensitive", "squared_epsilon_insensitive"],
-            "regressor__shuffle": [True, False],
-        }
-        return tune_grid
-
-    @property
-    def _set_tune_distributions(self) -> Dict[str, List[Any]]:
-        tune_distributions = {
-            "sp": CategoricalDistribution(
-                values=[self.sp, 2 * self.sp]
-            ),  # TODO: 'None' errors out here
-            "deseasonal_model": CategoricalDistribution(
-                values=["additive", "multiplicative"]
-                if self.strictly_positive
-                else ["additive"]
-            ),
-            "degree": IntUniformDistribution(lower=1, upper=10),
-            "window_length": IntUniformDistribution(lower=self.sp, upper=2 * self.sp),
-            "regressor__C": UniformDistribution(0, 10),
-            "regressor__epsilon": UniformDistribution(0.0000000001, 0.9999999999),
-        }
-        return tune_distributions
+# class PassiveAggressiveCdsDtContainer(CdsDtContainer):
+#     id = "par_cds_dt"
+#     name = "Passive Aggressive w/ Cond. Deseasonalize & Detrending"
+#     active = True  # set back to True as the parent has False
+#     model_type = TSModelTypes.LINEAR
+
+#     def return_regressor_class(self):
+#         from sklearn.linear_model import PassiveAggressiveRegressor
+
+#         return PassiveAggressiveRegressor
+
+#     @property
+#     def _set_tune_grid(self) -> Dict[str, List[Any]]:
+#         tune_grid = {
+#             "sp": [self.sp],
+#             "deseasonal_model": ["additive"],
+#             "degree": [1],
+#             "window_length": [10],
+#             "regressor__epsilon": [0.1, 0.5, 0.9],
+#             "regressor__C": [0, 5, 10],
+#             "regressor__fit_intercept": [True, False],
+#             "regressor__loss": ["epsilon_insensitive", "squared_epsilon_insensitive"],
+#             "regressor__shuffle": [True, False],
+#         }
+#         return tune_grid
+
+#     @property
+#     def _set_tune_distributions(self) -> Dict[str, List[Any]]:
+#         tune_distributions = {
+#             "sp": CategoricalDistribution(
+#                 values=[self.sp, 2 * self.sp]
+#             ),  # TODO: 'None' errors out here
+#             "deseasonal_model": CategoricalDistribution(
+#                 values=["additive", "multiplicative"]
+#                 if self.strictly_positive
+#                 else ["additive"]
+#             ),
+#             "degree": IntUniformDistribution(lower=1, upper=10),
+#             "window_length": IntUniformDistribution(lower=self.sp, upper=2 * self.sp),
+#             "regressor__C": UniformDistribution(0, 10),
+#             "regressor__epsilon": UniformDistribution(0.0000000001, 0.9999999999),
+#         }
+#         return tune_distributions
 
 
 class OrthogonalMatchingPursuitCdsDtContainer(CdsDtContainer):
     id = "omp_cds_dt"
     name = "Orthogonal Matching Pursuit w/ Cond. Deseasonalize & Detrending"
     active = True  # set back to True as the parent has False
     model_type = TSModelTypes.LINEAR
@@ -2444,17 +2489,15 @@
     active = True  # set back to True as the parent has False
     model_type = TSModelTypes.TREE
 
     def __init__(self, experiment) -> None:
         # suppress output
         logging.getLogger("catboost").setLevel(logging.ERROR)
 
-        self.use_gpu = experiment.gpu_param == "force" or (
-            experiment.gpu_param and len(experiment.y_train) >= 50000
-        )
+        self.use_gpu = experiment.gpu_param
 
         super().__init__(experiment=experiment)
 
     def return_regressor_class(self):
         if _check_soft_dependencies("catboost", extra="models", severity="warning"):
             import catboost
         else:
@@ -2768,37 +2811,43 @@
     model_type = "ensemble"
 
     def __init__(self, experiment) -> None:
         self.logger = get_logger()
         np.random.seed(experiment.seed)
         self.gpu_imported = False
 
-        from pycaret.internal.ensemble import _EnsembleForecasterWithVoting
-
-        args = {}
-        tune_args = {}
-        tune_grid = {}
-        tune_distributions = {}
-
-        # if not self.gpu_imported:
-        #     args["n_jobs"] = experiment.n_jobs_param
+        from sktime.forecasting.compose import EnsembleForecaster
 
+        args = self._set_args
+        tune_args = self._set_tune_args
+        tune_grid = self._set_tune_grid
+        tune_distributions = self._set_tune_distributions
         leftover_parameters_to_categorical_distributions(tune_grid, tune_distributions)
 
         super().__init__(
             id="ensemble_forecaster",
             name="EnsembleForecaster",
-            class_def=_EnsembleForecasterWithVoting,
+            class_def=EnsembleForecaster,
             args=args,
             tune_grid=tune_grid,
             tune_distribution=tune_distributions,
             tune_args=tune_args,
             is_gpu_enabled=self.gpu_imported,
         )
 
+    @property
+    def _set_args(self) -> Dict[str, Any]:
+        args = {"aggfunc": "mean"}
+        return args
+
+    @property
+    def _set_tune_grid(self) -> Dict[str, List[Any]]:
+        tune_grid = {"aggfunc": ["mean", "median", "min", "max", "gmean"]}
+        return tune_grid
+
 
 def get_all_model_containers(
     experiment, raise_errors: bool = True
 ) -> Dict[str, TimeSeriesContainer]:
     return pycaret.containers.base_container.get_all_containers(
         globals(), experiment, TimeSeriesContainer, raise_errors
     )
```

## pycaret/internal/cuml_wrappers.py

```diff
@@ -32,15 +32,14 @@
             return super().fit_predict(X, sample_weight=sample_weight)
 
 else:
     KMeans = None
 
 
 def get_kmeans():
-
     return KMeans
 
 
 if _check_soft_dependencies("cuml", extra=None, severity="warning"):
     from cuml.svm import SVC
 else:
     SVC = None
@@ -111,15 +110,14 @@
             return self._label_binarizer.inverse_transform(ret)
 
 else:
     RidgeClassifier = None
 
 
 def get_ridge_classifier():
-
     return RidgeClassifier
 
 
 def get_random_forest_classifier():
     from cuml.ensemble import RandomForestClassifier as cuMLRandomForestClassifier
 
     class RandomForestClassifier(cuMLRandomForestClassifier):
```

## pycaret/internal/logging.py

```diff
@@ -5,50 +5,71 @@
 import logging
 import os
 import traceback
 import warnings
 from contextlib import redirect_stderr, redirect_stdout
 from typing import Callable, Optional, Union
 
+try:
+    from wurlitzer import pipes
+except ImportError:
+    # Fails on windows. See https://github.com/minrk/wurlitzer/pull/63
+    pipes = None
+
 
 # From https://stackoverflow.com/a/66209331
 class LoggerWriter:
     """Writer allowing redirection of streams to logger methods."""
 
-    def __init__(self, logfct: Callable):
-        self.logfct = logfct
-        self.buf = []
-
-    def write(self, msg: str):
-        if msg.endswith("\n"):
-            self.buf.append(msg.rstrip("\n"))
-            self.logfct("".join(self.buf))
-            self.buf = []
-        else:
-            self.buf.append(msg)
+    def __init__(self, writer: Callable):
+        self._writer = writer
+        self._msg = ""
+
+    def write(self, message: str):
+        self._msg = self._msg + message
+        while "\n" in self._msg:
+            pos = self._msg.find("\n")
+            self._writer(self._msg[:pos])
+            self._msg = self._msg[pos + 1 :]
 
     def flush(self):
-        pass
+        if self._msg != "":
+            self._writer(self._msg)
+            self._msg = ""
 
 
 class redirect_output:
     """Context manager to redirect stdout and stderr to logger."""
 
     def __init__(self, logger: Optional[logging.Logger] = None):
         self.logger = logger or DummyLogger("dummy")
-        self.redirect_stdout = redirect_stdout(LoggerWriter(logger.info))
-        self.redirect_stderr = redirect_stderr(LoggerWriter(logger.warning))
+        # Current Python process redirects
+        self.redirect_stdout = redirect_stdout(LoggerWriter(self.logger.info))
+        self.redirect_stderr = redirect_stderr(LoggerWriter(self.logger.warning))
+        # This redirects stdout/stderr from C libraries and child processes (joblib)
+        self.c_redirect = (
+            pipes(
+                stdout=LoggerWriter(self.logger.info),
+                stderr=LoggerWriter(self.logger.warning),
+            )
+            if pipes
+            else None
+        )
 
     def __enter__(self):
         self.redirect_stdout.__enter__()
         self.redirect_stderr.__enter__()
+        if self.c_redirect:
+            self.c_redirect.__enter__()
 
     def __exit__(self, *args, **kwargs):
-        self.redirect_stdout.__exit__(*args, **kwargs)
+        if self.c_redirect:
+            self.c_redirect.__exit__(*args, **kwargs)
         self.redirect_stderr.__exit__(*args, **kwargs)
+        self.redirect_stdout.__exit__(*args, **kwargs)
 
 
 class DummyLogger(logging.Logger):
     """Logger class that does nothing.
 
     This class is a dummy logger class assigned to self.logger
     when system_log=None to overwrite commands to the logger.
```

## pycaret/internal/memory.py

```diff
@@ -9,14 +9,15 @@
 4. Special support for pandas/numpy object arrays.
 5. Caching the function output only if the call takes more than 0.1 seconds.
 6. Avoiding hashing the function signature twice in Memory class.
 """
 
 import hashlib
 import pickle
+import struct
 import sys
 import tempfile
 import time
 import traceback
 from pathlib import Path
 from typing import TYPE_CHECKING, Union
 
@@ -45,14 +46,16 @@
         return reduce(operator.mul, iterable, 1)
 
 
 if TYPE_CHECKING:
     import numpy as np
 
 DEFAULT_MIN_TIME_TO_CACHE = 0.1
+DEFAULT_BYTES_LIMIT = 1024 * 1024 * 1024 * 10  # 10 GB
+DEFAULT_CALLS_BETWEEN_REDUCE = 20
 
 
 # From https://github.com/joblib/joblib/pull/1011
 class _FileWriteToHash:
     """For Pickler, a file-like api that translates file.write(bytes) to
     hash.update(bytes)
 
@@ -95,14 +98,40 @@
         except pickle.PicklingError as e:
             e.args += ("PicklingError while hashing %r: %r" % (obj, e),)
             raise
         if return_digest:
             # Read the resulting hash
             return self._hash.hexdigest()
 
+    def save_global(self, obj, name=None, pack=struct.pack):
+        # Fixes joblib issue. In the except block,
+        # Pickler.save_global has been moved to bottom so it
+        # can actually work.
+        kwargs = dict(name=name, pack=pack)
+        del kwargs["pack"]
+        try:
+            Pickler.save_global(self, obj, **kwargs)
+        except pickle.PicklingError:
+            module = getattr(obj, "__module__", None)
+            if module == "__main__":
+                my_name = name
+                if my_name is None:
+                    my_name = obj.__name__
+                mod = sys.modules[module]
+                if not hasattr(mod, my_name):
+                    # IPython doesn't inject the variables define
+                    # interactively in __main__
+                    setattr(mod, my_name, obj)
+            Pickler.save_global(self, obj, **kwargs)
+
+    dispatch = Hasher.dispatch.copy()
+    for key in dispatch:
+        if dispatch[key] == Hasher.save_global:
+            dispatch[key] = save_global
+
 
 # Based on joblib.hashing.NumpyHasher
 class FastNumpyHasher(FastHasher):
     def __init__(self, hash_name="xxhash", coerce_mmap=False, protocol=None):
         self.coerce_mmap = coerce_mmap
         super().__init__(hash_name=hash_name, protocol=protocol)
         # delayed import of numpy, to avoid tight coupling
@@ -394,32 +423,50 @@
             metadata=metadata,
             verbose=self._verbose - 1,
             timestamp=self.timestamp,
         )
 
 
 class FastMemory(Memory):
-    def __init__(self, *args, min_time_to_cache=DEFAULT_MIN_TIME_TO_CACHE, **kwargs):
+    def __init__(
+        self,
+        *args,
+        min_time_to_cache=DEFAULT_MIN_TIME_TO_CACHE,
+        caches_between_reduce=DEFAULT_CALLS_BETWEEN_REDUCE,
+        **kwargs,
+    ):
         super().__init__(*args, **kwargs)
         self.min_time_to_cache = min_time_to_cache
+        self.caches_between_reduce = caches_between_reduce
+        self.reduce_size()
+
+    def reduce_size(self):
+        self._cache_counter = 0
+        return super().reduce_size()
 
     def cache(self, func=None, ignore=None, verbose=None, mmap_mode=False):
         ret = super().cache(func, ignore, verbose, mmap_mode)
         if isinstance(ret, MemorizedFunc):
             ret.__class__ = FastMemorizedFunc
             ret.min_time_to_cache = self.min_time_to_cache
             ret._cached_output_identifiers = None
+            self._cache_counter += 1
+            if self._cache_counter >= self.caches_between_reduce:
+                self.reduce_size()
         return ret
 
+    def __del__(self):
+        self.reduce_size()
+
 
 def get_memory(memory: Union[bool, str, Path, Memory]) -> Memory:
     if memory is None or isinstance(memory, Memory):
         return memory
     if isinstance(memory, (str, Path, bool)):
         if not memory:
             return None
         if memory:
             tmpdir = tempfile.gettempdir() if isinstance(memory, bool) else str(memory)
-            return FastMemory(tmpdir, verbose=0)
+            return FastMemory(tmpdir, verbose=0, bytes_limit=DEFAULT_BYTES_LIMIT)
     raise TypeError(
         f"memory must be a bool, str or joblib.Memory object, got {type(memory)}"
     )
```

## pycaret/internal/metrics.py

```diff
@@ -1,21 +1,41 @@
+import traceback
+import warnings
+from typing import Callable
+
 import numpy as np
+from sklearn.exceptions import FitFailedWarning
 from sklearn.metrics._scorer import _PredictScorer, _ProbaScorer, _ThresholdScorer
 
+_fit_failed_message_warning = (
+    "Metric '{0}' failed and error score {1} has been returned instead. "
+    "If this is a custom metric, this usually means that the error is "
+    "in the metric code. "
+    "Full exception below:\n{2}"
+)
+
 
 class BinaryMulticlassScoreFunc:
-    def __init__(self, score_func):
+    """Wrapper to replace call kwargs with preset values if target is binary."""
+
+    def __init__(self, score_func: Callable, kwargs_if_binary: dict):
         self.score_func = score_func
+        self.kwargs_if_binary = kwargs_if_binary
         self.__name__ = score_func.__name__
 
     def __call__(self, y_true, y_pred, **kwargs):
-        if "average" in kwargs:
-            known_values = kwargs.get("labels", np.unique(y_true))
-            if len(known_values) <= 2:
-                kwargs["average"] = "binary"
+        if self.kwargs_if_binary:
+            labels = kwargs.get("labels", None)
+            is_binary = (
+                len(labels) <= 2
+                if labels is not None
+                else ((y_true == 0) | (y_true == 1)).all()
+            )
+            if is_binary:
+                kwargs = {**kwargs, **self.kwargs_if_binary}
         return self.score_func(y_true, y_pred, **kwargs)
 
 
 class _ThresholdScorerWithErrorScore(_ThresholdScorer):
     def __init__(self, score_func, sign, kwargs, error_score=np.nan):
         super().__init__(score_func=score_func, sign=sign, kwargs=kwargs)
         self.error_score = error_score
@@ -56,14 +76,20 @@
                 method_caller=method_caller,
                 clf=clf,
                 X=X,
                 y=y,
                 sample_weight=sample_weight,
             )
         except Exception:
+            warnings.warn(
+                _fit_failed_message_warning.format(
+                    repr(self), self.error_score, traceback.format_exc()
+                ),
+                FitFailedWarning,
+            )
             return self.error_score
 
     def _factory_args(self):
         return f", needs_threshold=True, error_score={self.error_score}"
 
 
 class _ProbaScorerWithErrorScore(_ProbaScorer):
@@ -105,14 +131,20 @@
                 method_caller=method_caller,
                 clf=clf,
                 X=X,
                 y=y,
                 sample_weight=sample_weight,
             )
         except Exception:
+            warnings.warn(
+                _fit_failed_message_warning.format(
+                    repr(self), self.error_score, traceback.format_exc()
+                ),
+                FitFailedWarning,
+            )
             return self.error_score
 
     def _factory_args(self):
         return f", needs_proba=True, error_score={self.error_score}"
 
 
 class _PredictScorerWithErrorScore(_PredictScorer):
@@ -153,14 +185,20 @@
                 method_caller=method_caller,
                 estimator=estimator,
                 X=X,
                 y_true=y_true,
                 sample_weight=sample_weight,
             )
         except Exception:
+            warnings.warn(
+                _fit_failed_message_warning.format(
+                    repr(self), self.error_score, traceback.format_exc()
+                ),
+                FitFailedWarning,
+            )
             return self.error_score
 
 
 def make_scorer_with_error_score(
     score_func,
     *,
     greater_is_better=True,
```

## pycaret/internal/persistence.py

```diff
@@ -127,15 +127,14 @@
 
     logger.info("Saving model in active working directory")
     logger.info("SubProcess save_model() called ==================================")
     save_model(model, prep_pipe_=prep_pipe_, model_name=model_name, verbose=False)
     logger.info("SubProcess save_model() end ==================================")
 
     if platform == "aws":
-
         logger.info("Platform : AWS S3")
 
         # checking if boto3 is available
         _check_soft_dependencies("boto3", extra=None, severity="error")
         import boto3
 
         # initialize s3
@@ -172,15 +171,14 @@
             )
         os.remove(filename)
         print("Model Successfully Deployed on AWS S3")
         logger.info("Model Successfully Deployed on AWS S3")
         logger.info(str(model))
 
     elif platform == "gcp":
-
         logger.info("Platform : GCP")
 
         _check_soft_dependencies(
             "google", extra=None, severity="error", install_name="google-cloud-storage"
         )
 
         # initialize deployment
@@ -206,15 +204,14 @@
             _upload_blob_gcp(project_name, bucket_name, filename, key)
         os.remove(filename)
         print("Model Successfully Deployed on GCP")
         logger.info("Model Successfully Deployed on GCP")
         logger.info(str(model))
 
     elif platform == "azure":
-
         logger.info("Platform : Azure Blob Storage")
 
         _check_soft_dependencies(
             "azure", extra=None, severity="error", install_name="azure-storage-blob"
         )
 
         # initialize deployment
@@ -293,47 +290,49 @@
     logger.info(f"save_model({function_params_str})")
 
     from copy import deepcopy
 
     logger.info("Adding model into prep_pipe")
 
     if use_case == MLUsecase.TIME_SERIES:
-        model_ = deepcopy(model)
         if prep_pipe_:
             pipeline = deepcopy(prep_pipe_)
-            model_ = _add_model_to_pipeline(pipeline=pipeline, model=model_)
+            model = _add_model_to_pipeline(pipeline=pipeline, model=model)
         else:
             logger.warning(
                 "Only Model saved. Transformations in prep_pipe are ignored."
             )
     else:
         if isinstance(model, Pipeline):
-            model_ = deepcopy(model)
             logger.warning("Only Model saved as it was a pipeline.")
         elif not prep_pipe_:
-            model_ = deepcopy(model)
             logger.warning(
                 "Only Model saved. Transformations in prep_pipe are ignored."
             )
         else:
             model_ = deepcopy(prep_pipe_)
             model_.steps.append(("trained_model", model))
+            model = model_
 
     model_name = f"{model_name}.pkl"
-    joblib.dump(model_, model_name, **kwargs)
+    joblib.dump(model, model_name, **kwargs)
     if verbose:
-        print("Transformation Pipeline and Model Successfully Saved")
+        if prep_pipe_:
+            pipe_msg = "Transformation Pipeline and "
+        else:
+            pipe_msg = ""
+        print(f"{pipe_msg}Model Successfully Saved")
 
     logger.info(f"{model_name} saved in current working directory")
-    logger.info(str(model_))
+    logger.info(str(model))
     logger.info(
         "save_model() successfully completed......................................"
     )
     gc.collect()
-    return model_, model_name
+    return model, model_name
 
 
 def load_model(
     model_name: str,
     platform: Optional[str] = None,
     authentication: Optional[Dict[str, str]] = None,
     verbose: bool = True,
@@ -391,15 +390,14 @@
         model = joblib.load(model_name)
         if verbose:
             print("Transformation Pipeline and Model Successfully Loaded")
         return model
 
     # cloud providers
     elif platform == "aws":
-
         import os
 
         # checking if boto3 is available
         _check_soft_dependencies("boto3", extra=None, severity="error")
         import boto3
 
         bucketname = authentication.get("bucket")
@@ -434,15 +432,14 @@
 
         if verbose:
             print("Transformation Pipeline and Model Successfully Loaded")
 
         return model
 
     elif platform == "gcp":
-
         bucket_name = authentication.get("bucket")
         project_name = authentication.get("project")
 
         if bucket_name is None or project_name is None:
             logger.error(
                 "Project and Bucket name missing. Provide `bucket` and `project` as part of "
                 "authentication parameter"
@@ -459,15 +456,14 @@
         model = load_model(model_name, verbose=False)
 
         if verbose:
             print("Transformation Pipeline and Model Successfully Loaded")
         return model
 
     elif platform == "azure":
-
         container_name = authentication.get("container")
 
         if container_name is None:
             logger.error(
                 "Storage Container name missing. Provide `container` as part of authentication parameter"
             )
             raise ValueError(
```

## pycaret/internal/pipeline.py

```diff
@@ -173,25 +173,33 @@
     @property
     def _memory_full_transform(self):
         if self._cache_full_transform:
             return self.__memory_full_transform
         else:
             return _full_transform
 
-    def _iter(self, with_final=True, filter_passthrough=True, filter_train_only=True):
+    def _iter(
+        self,
+        with_final=True,
+        filter_passthrough=True,
+        filter_train_only=True,
+        reverse=False,
+    ):
         """Generate (idx, name, trans) tuples from self.steps.
 
         When `filter_passthrough=True`, 'passthrough' and None
         transformers are filtered out. When `filter_train_only=True`,
         the RemoveOutliers and FixImbalancer classes are only used for
         fitting. They are skipped for all prediction methods since we
         want to keep the original distribution of target classes.
 
         """
         it = super()._iter(with_final, filter_passthrough)
+        if reverse:
+            it = reversed(list(it))
         if filter_train_only:
             return filter(lambda x: not getattr(x[-1], "_train_only", False), it)
         else:
             return it
 
     def _fit(self, X=None, y=None, **fit_params_steps):
         self.steps = list(self.steps)
@@ -199,15 +207,15 @@
 
         # Save the incoming feature names (if pandas objects)
         if hasattr(X, "columns"):
             self._feature_names_in = list(X.columns) + (
                 [y.name] if hasattr(y, "name") else []
             )
 
-        for (step_idx, name, transformer) in self._iter(False, False, False):
+        for step_idx, name, transformer in self._iter(False, False, False):
             if transformer is None or transformer == "passthrough":
                 with _print_elapsed_time("Pipeline", self._log_message(step_idx)):
                     continue
 
             if hasattr(transformer, "transform"):
                 if self._memory_fit.__class__.__name__ == "NotMemorizedFunc":
                     # Don't clone when caching is disabled to
@@ -286,22 +294,27 @@
             # loaded from cache is carried over to the estimator
             # in steps
             _copy_estimator_state(fitted_estimator, self.steps[-1][1])
             X, y = self._memory_transform(self._final_estimator, X, y)
 
         return variable_return(X, y)
 
+    def inverse_transform(self, y):
+        for _, _, transformer in self._iter(with_final=False, reverse=True):
+            # Duplicate hasattr check here so we don't cache unnecessarily
+            if hasattr(transformer, "inverse_transform"):
+                y = _inverse_transform_one(transformer, y)
+        return y
+
     @available_if(_final_estimator_has("predict"))
     def predict(self, X, **predict_params):
         X, _ = self._memory_full_transform(self, X, None, with_final=False)
 
         y = self.steps[-1][-1].predict(X, **predict_params)
-
-        for _, name, transformer in self._iter(with_final=False):
-            y = _inverse_transform_one(transformer, y)
+        y = self.inverse_transform(y)
 
         return y
 
     @available_if(_final_estimator_has("predict_proba"))
     def predict_proba(self, X):
         X, _ = self._memory_full_transform(self, X, None, with_final=False)
```

## pycaret/internal/plots/time_series.py

```diff
@@ -321,15 +321,14 @@
             train_windows.append(train)
             test_windows.append(test)
         return train_windows, test_windows
 
     def plot_windows(data, train_windows, test_windows):
         fig = go.Figure()
         for num_window in reversed(range(len(train_windows))):
-
             x = (
                 data.index.to_timestamp()
                 if isinstance(data.index, pd.PeriodIndex)
                 else data.index
             )
             time_stamps = x
 
@@ -1071,15 +1070,14 @@
     # Should the following be plotted - Time Series, ACF, PACF, Periodogram, FFT
     plots = [True, plot_acf, plot_pacf, plot_periodogram, plot_fft]
 
     # Which column should the plots be in
     plot_cols = np.cumsum(plots).tolist()
 
     for i, subplot_data in enumerate(diff_list):
-
         # Add difference data ----
 
         ts_to_plot = pd.DataFrame(subplot_data)
         ts_to_plot.columns = [name_list[i]]
         fig = time_series_subplot(
             fig=fig,
             data=ts_to_plot,
```

## pycaret/internal/plots/utils/time_series.py

```diff
@@ -566,15 +566,15 @@
         try:
             decomp_result = seasonal_decompose(
                 data_, period=period, model=classical_decomp_type
             )
         except ValueError as exception:
             logger.warning(exception)
             logger.warning(
-                "Seasonal Decompose plot failed most likely sue to missing data"
+                "Seasonal Decompose plot failed most likely due to missing data"
             )
             return fig, None
     elif plot == "decomp_stl":
         decomp_result = STL(data_, period=period).fit()
 
     row = 2
     fig.add_trace(
```

## pycaret/internal/preprocess/preprocessor.py

```diff
@@ -2,17 +2,17 @@
 # License: MIT
 
 from copy import deepcopy
 
 import numpy as np
 import pandas as pd
 from category_encoders.basen import BaseNEncoder
-from category_encoders.leave_one_out import LeaveOneOutEncoder
 from category_encoders.one_hot import OneHotEncoder
 from category_encoders.ordinal import OrdinalEncoder
+from category_encoders.target_encoder import TargetEncoder
 from imblearn.combine import SMOTEENN, SMOTETomek
 from imblearn.over_sampling import (
     ADASYN,
     SMOTE,
     SMOTEN,
     SMOTENC,
     SVMSMOTE,
@@ -115,14 +115,18 @@
 
         """
         self.logger.info("Set up data.")
 
         # Make copy to not overwrite mutable arguments
         X = to_df(deepcopy(X))
 
+        # No duplicate column names are allowed
+        if len(set(X.columns)) != len(X.columns):
+            raise ValueError("Duplicate column names found in X.")
+
         # Prepare target column
         if isinstance(y, (list, tuple, np.ndarray, pd.Series)):
             if not isinstance(y, pd.Series):
                 # Check that y is one-dimensional
                 ndim = np.array(y).ndim
                 if ndim != 1:
                     raise ValueError(f"y should be one-dimensional, got ndim={ndim}.")
@@ -168,15 +172,15 @@
     def _set_index(self, df):
         """Assign an index to the dataframe."""
         self.logger.info("Set up index.")
 
         target = df.columns[-1]
 
         if getattr(self, "index", True) is True:  # True gets caught by isinstance(int)
-            return df
+            pass
         elif self.index is False:
             df = df.reset_index(drop=True)
         elif isinstance(self.index, int):
             if -df.shape[1] <= self.index <= df.shape[1]:
                 df = df.set_index(df.columns[self.index], drop=True)
             else:
                 raise ValueError(
@@ -194,14 +198,20 @@
 
         if df.index.name == target:
             raise ValueError(
                 "Invalid value for the index parameter. The index column "
                 f"can not be the same as the target column, got {target}."
             )
 
+        if df.index.duplicated().any():
+            raise ValueError(
+                "Invalid value for the index parameter. There are duplicate indices "
+                "in the dataset. Use index=False to reset the index to RangeIndex."
+            )
+
         return df
 
     def _prepare_train_test(
         self,
         train_size,
         test_data,
         data_split_stratify,
@@ -276,15 +286,19 @@
             self._fxs["Ordinal"] = {}
 
         # Numerical features
         if numeric_features:
             check_features_exist(numeric_features, self.X)
             self._fxs["Numeric"] = numeric_features
         else:
-            self._fxs["Numeric"] = list(self.X.select_dtypes(include="number").columns)
+            self._fxs["Numeric"] = [
+                col
+                for col in self.X.select_dtypes(include="number").columns
+                if col not in (categorical_features or [])
+            ]
 
         # Date features
         if date_features:
             check_features_exist(date_features, self.X)
             self._fxs["Date"] = date_features
         else:
             self._fxs["Date"] = list(self.X.select_dtypes(include="datetime").columns)
@@ -669,14 +683,15 @@
 
         if self._fxs["Categorical"]:
             self.logger.info("Set up encoding of categorical features.")
 
             if len(one_hot_cols) > 0:
                 onehot_estimator = TransformerWrapper(
                     transformer=OneHotEncoder(
+                        cols=one_hot_cols,
                         use_cat_names=True,
                         handle_missing="return_nan",
                         handle_unknown="value",
                     ),
                     include=one_hot_cols,
                 )
 
@@ -688,18 +703,17 @@
                     if self._ml_usecase in (MLUsecase.ANOMALY, MLUsecase.CLUSTERING):
                         encoding_method = BaseNEncoder(
                             base=5,
                             handle_missing="return_nan",
                             handle_unknown="value",
                         )
                     else:
-                        encoding_method = LeaveOneOutEncoder(
+                        encoding_method = TargetEncoder(
                             handle_missing="return_nan",
                             handle_unknown="value",
-                            random_state=self.seed,
                         )
 
                 rest_estimator = TransformerWrapper(
                     transformer=encoding_method,
                     include=rest_cols,
                 )
 
@@ -733,15 +747,15 @@
             variance_estimator = TransformerWrapper(
                 transformer=VarianceThreshold(low_variance_threshold),
                 exclude=self._fxs["Keep"],
             )
 
         self.pipeline.steps.append(("low_variance", variance_estimator))
 
-    def _group_features(self, group_features, group_names):
+    def _group_features(self, group_features, group_names, drop_groups):
         """Get statistical properties of a group of features."""
         self.logger.info("Set up feature grouping.")
 
         # Convert a single group to sequence
         if np.array(group_features).ndim == 1:
             group_features = [group_features]
 
@@ -753,15 +767,15 @@
                 raise ValueError(
                     "Invalid value for the group_names parameter. Length "
                     f"({len(group_names)}) does not match with length of "
                     f"group_features ({len(group_features)})."
                 )
 
         grouping_estimator = TransformerWrapper(
-            transformer=GroupFeatures(group_features, group_names),
+            transformer=GroupFeatures(group_features, group_names, drop_groups),
             exclude=self._fxs["Keep"],
         )
 
         self.pipeline.steps.append(("group_features", grouping_estimator))
 
     def _remove_multicollinearity(self, multicollinearity_threshold):
         """Drop features that are collinear with other features."""
@@ -804,14 +818,15 @@
                 "'iforest', 'ee' or 'lof'."
             )
 
         outliers = TransformerWrapper(
             RemoveOutliers(
                 method=outliers_method,
                 threshold=outliers_threshold,
+                random_state=self.seed,
             ),
         )
 
         self.pipeline.steps.append(("remove_outliers", outliers))
 
     def _balance(self, fix_imbalance_method):
         """Balance the classes in the target column."""
```

## pycaret/internal/preprocess/transformers.py

```diff
@@ -4,14 +4,15 @@
 
 import re
 from collections import defaultdict
 from inspect import signature
 
 import numpy as np
 import pandas as pd
+from pandas.api.types import is_numeric_dtype
 from scipy import stats
 from sklearn.base import BaseEstimator, TransformerMixin, clone
 from sklearn.covariance import EllipticEnvelope
 from sklearn.ensemble import IsolationForest
 from sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer
 from sklearn.neighbors import LocalOutlierFactor
 
@@ -77,15 +78,23 @@
         # If columns were only transformed, return og names
         if array.shape[1] == len(self._include):
             return self._include
 
         # If columns were added or removed
         temp_cols = []
         for i, col in enumerate(array.T, start=2):
-            mask = df.apply(lambda c: np.array_equal(c, col, equal_nan=True))
+            # equal_nan=True fails for non-numeric arrays
+            mask = df.apply(
+                lambda c: np.array_equal(
+                    c,
+                    col,
+                    equal_nan=is_numeric_dtype(c)
+                    and np.issubdtype(col.dtype, np.number),
+                )
+            )
             if any(mask) and mask[mask].index.values[0] not in temp_cols:
                 temp_cols.append(mask[mask].index.values[0])
             else:
                 # If the column is new, use a default name
                 counter = 1
                 while True:
                     n = f"feature {i + counter + df.shape[1] - len(self._include)}"
@@ -163,40 +172,43 @@
 
         return new_df[columns]
 
     def _prepare_df(self, X, out):
         """Convert to df and set correct column names and order."""
         # Convert to pandas and assign proper column names
         if not isinstance(out, pd.DataFrame):
-            if hasattr(self.transformer, "get_feature_names"):
-                columns = self.transformer.get_feature_names()
-            elif hasattr(self.transformer, "get_feature_names_out"):
+            if hasattr(self.transformer, "get_feature_names_out"):
                 try:  # Fails for some estimators in Python 3.7
                     # TODO: Remove try after dropping support of Python 3.7
                     columns = self.transformer.get_feature_names_out()
                 except AttributeError:
                     columns = self._name_cols(out, X)
+            elif hasattr(self.transformer, "get_feature_names"):
+                # Some estimators have legacy method, e.g. category_encoders
+                columns = self.transformer.get_feature_names()
             else:
                 columns = self._name_cols(out, X)
 
             out = to_df(out, index=X.index, columns=columns)
 
         # Reorder columns if only a subset was used
         if len(self._include) != X.shape[1]:
             return self._reorder_cols(out, X)
         else:
             return out
 
     def fit(self, X=None, y=None, **fit_params):
         # Save the incoming feature names
+        self.target_name_ = None
         feature_names_in = []
         if hasattr(X, "columns"):
             feature_names_in += list(X.columns)
         if hasattr(y, "name"):
             feature_names_in += [y.name]
+            self.target_name_ = y.name
         if feature_names_in:
             self._feature_names_in = feature_names_in
 
         args = []
         transformer_params = signature(self.transformer.fit).parameters
         if "X" in transformer_params and X is not None:
             if self._include is None:
@@ -214,15 +226,15 @@
             args.append(y)
 
         self.transformer.fit(*args, **fit_params)
         return self
 
     def transform(self, X=None, y=None):
         X = to_df(X, index=getattr(y, "index", None))
-        y = to_series(y, index=getattr(X, "index", None))
+        y = to_series(y, index=getattr(X, "index", None), name=self.target_name_)
 
         args = []
         transform_params = signature(self.transformer.transform).parameters
         if "X" in transform_params:
             if X is not None:
                 if self._include is None:
                     self._include = [
@@ -254,15 +266,15 @@
                 new_X = X if X is None else X.set_index(new_y.index)
 
         return variable_return(new_X, new_y)
 
 
 class TransformerWrapperWithInverse(TransformerWrapper):
     def inverse_transform(self, y):
-        y = to_series(y, index=getattr(y, "index", None))
+        y = to_series(y, index=getattr(y, "index", None), name=self.target_name_)
         output = self.transformer.inverse_transform(y)
         return to_series(output, index=y.index, name=y.name)
 
 
 class CleanColumnNames(BaseEstimator, TransformerMixin):
     """Remove weird characters from column names."""
 
@@ -318,37 +330,39 @@
 
         return variable_return(X, y)
 
 
 class EmbedTextFeatures(BaseEstimator, TransformerMixin):
     """Embed text features to an array representation."""
 
-    def __init__(self, method="tf-idf", **kwargs):
+    def __init__(self, method="tf-idf", kwargs=None):
         self.method = method
         self.kwargs = kwargs
-        self._estimators = {}
 
     def fit(self, X, y=None):
+        self.estimators_ = {}
+
+        kwargs = self.kwargs or {}
         if self.method.lower() == "bow":
-            estimator = CountVectorizer(**self.kwargs)
+            estimator = CountVectorizer(**kwargs)
         else:
-            estimator = TfidfVectorizer(**self.kwargs)
+            estimator = TfidfVectorizer(**kwargs)
 
         # Fit every text column in a separate estimator
         for col in X:
-            self._estimators[col] = clone(estimator).fit(X[col])
+            self.estimators_[col] = clone(estimator).fit(X[col])
 
         return self
 
     def transform(self, X, y=None):
         for col in X:
-            data = self._estimators[col].transform(X[col]).toarray()
+            data = self.estimators_[col].transform(X[col]).toarray()
             columns = [
                 f"{col}_{word}"
-                for word in self._estimators[col].get_feature_names_out()
+                for word in self.estimators_[col].get_feature_names_out()
             ]
 
             # Merge the new columns with the dataset
             X = pd.concat(
                 [X, pd.DataFrame(data=data, index=X.index, columns=columns)],
                 axis=1,
             )
@@ -361,43 +375,44 @@
 
 class RareCategoryGrouping(BaseEstimator, TransformerMixin):
     """Replace rare categories with the string `other`."""
 
     def __init__(self, rare_to_value, value="rare"):
         self.rare_to_value = rare_to_value
         self.value = value
-        self._to_other = defaultdict(list)
 
     def fit(self, X, y=None):
+        self.to_other_ = defaultdict(list)
         for name, column in X.items():
             for category, count in column.value_counts().items():
                 if count < self.rare_to_value * len(X):
-                    self._to_other[name].append(category)
+                    self.to_other_[name].append(category)
 
         return self
 
     def transform(self, X, y=None):
         for name, column in X.items():
-            if self._to_other[name]:
-                X[name] = column.replace(self._to_other[name], self.value)
+            if self.to_other_[name]:
+                X[name] = column.replace(self.to_other_[name], self.value)
 
         return X
 
 
 class GroupFeatures(BaseEstimator, TransformerMixin):
     """Get statistical properties of similar features.
 
     Replace a group of features for columns with statistical
     properties of that group.
 
     """
 
-    def __init__(self, group_features, group_names=None):
+    def __init__(self, group_features, group_names=None, drop_groups=False):
         self.group_features = group_features
         self.group_names = group_names
+        self.drop_groups = drop_groups
 
     def fit(self, X, y=None):
         return self
 
     def transform(self, X, y=None):
         if not self.group_names:
             self.group_names = [
@@ -411,54 +426,55 @@
             group_df = X[group]
             X[f"min({name})"] = group_df.apply(np.min, axis=1)
             X[f"max({name})"] = group_df.apply(np.max, axis=1)
             X[f"mean({name})"] = group_df.apply(np.mean, axis=1)
             X[f"std({name})"] = group_df.apply(np.std, axis=1)
             X[f"median({name})"] = group_df.apply(np.median, axis=1)
             X[f"mode({name})"] = stats.mode(group_df, axis=1)[0]
-            X = X.drop(group, axis=1)
+
+            if self.drop_groups:
+                X = X.drop(group, axis=1)
 
         return X
 
 
 class RemoveMulticollinearity(BaseEstimator, TransformerMixin):
     """Drop multicollinear features."""
 
     def __init__(self, threshold=1):
         self.threshold = threshold
-        self._drop = None
 
     def fit(self, X, y=None):
         # Get the Pearson correlation coefficient matrix
         if y is None:
             corr_X = X.corr()
         else:
             data = X.merge(y.to_frame(), left_index=True, right_index=True)
             corr_matrix = data.corr()
             corr_X, corr_y = corr_matrix.iloc[:-1, :-1], corr_matrix.iloc[:-1, -1]
 
-        self._drop = []
+        self.drop_ = []
         for col in corr_X:
             # Select columns that are corr
             corr = corr_X[col][corr_X[col] >= self.threshold]
 
             # Always finds himself with correlation 1
             if len(corr) > 1:
                 if y is None:
                     # Drop all but the first one
-                    self._drop.extend(list(corr[1:].index))
+                    self.drop_.extend(list(corr[1:].index))
                 else:
                     # Keep feature with the highest correlation with y
                     keep = corr_y[corr.index].idxmax()
-                    self._drop.extend(list(corr.index.drop(keep)))
+                    self.drop_.extend(list(corr.index.drop(keep)))
 
         return self
 
     def transform(self, X):
-        return X.drop(set(self._drop), axis=1)
+        return X.drop(set(self.drop_), axis=1)
 
 
 class RemoveOutliers(BaseEstimator, TransformerMixin):
     """Transformer to drop outliers from a dataset."""
 
     def __init__(self, method="iforest", threshold=0.05, n_jobs=1, random_state=None):
         self.method = method
```

## pycaret/internal/pycaret_experiment/non_ts_supervised_experiment.py

```diff
@@ -6,91 +6,94 @@
 
 
 class _NonTSSupervisedExperiment(_SupervisedExperiment):
     def __init__(self) -> None:
         super().__init__()
 
     @property
+    def test(self):
+        """Test set."""
+        return self.dataset.loc[self.idx[1], :]
+
+    @property
     def X(self):
         """Feature set."""
         return self.dataset.drop(self.target_param, axis=1)
 
     @property
-    def dataset_transformed(self):
-        """Transformed dataset."""
-        return pd.concat([self.train_transformed, self.test_transformed])
-
-    @property
-    def X_train_transformed(self):
-        """Transformed feature set of the training set."""
-        return self.pipeline.transform(
-            X=self.X_train,
-            y=self.y_train,
-            filter_train_only=False,
-        )[0]
-
-    @property
-    def train_transformed(self):
-        """Transformed training set."""
-        return pd.concat(
-            [self.X_train_transformed, self.y_train_transformed],
-            axis=1,
-        )
-
-    @property
-    def X_transformed(self):
-        """Transformed feature set."""
-        return pd.concat([self.X_train_transformed, self.X_test_transformed])
-
-    @property
     def X_train(self):
         """Feature set of the training set."""
         return self.train.drop(self.target_param, axis=1)
 
     @property
     def X_test(self):
         """Feature set of the test set."""
         return self.test.drop(self.target_param, axis=1)
 
     @property
-    def test(self):
-        """Test set."""
-        return self.dataset.loc[self.idx[1], :]
+    def dataset_transformed(self):
+        """Transformed dataset."""
+        return pd.concat([self.train_transformed, self.test_transformed])
+
+    @property
+    def train_transformed(self):
+        """Transformed training set."""
+        return pd.concat(
+            [
+                *self.pipeline.transform(
+                    X=self.X_train,
+                    y=self.y_train,
+                    filter_train_only=False,
+                )
+            ],
+            axis=1,
+        )
 
     @property
     def test_transformed(self):
         """Transformed test set."""
         return pd.concat(
-            [self.X_test_transformed, self.y_test_transformed],
+            [
+                *self.pipeline.transform(
+                    X=self.X_test,
+                    y=self.y_test,
+                )
+            ],
             axis=1,
         )
 
     @property
+    def X_transformed(self):
+        """Transformed feature set."""
+        return pd.concat([self.X_train_transformed, self.X_test_transformed])
+
+    @property
     def y_transformed(self):
         """Transformed target column."""
         return pd.concat([self.y_train_transformed, self.y_test_transformed])
 
     @property
-    def X_test_transformed(self):
-        """Transformed feature set of the test set."""
-        return self.pipeline.transform(self.X_test)
+    def X_train_transformed(self):
+        """Transformed feature set of the training set."""
+        return self.train_transformed.drop(self.target_param, axis=1)
 
     @property
     def y_train_transformed(self):
         """Transformed target column of the training set."""
-        return self.pipeline.transform(
-            X=self.X_train,
-            y=self.y_train,
-            filter_train_only=False,
-        )[1]
+        return self.train_transformed[self.target_param]
+
+    @property
+    def X_test_transformed(self):
+        """Transformed feature set of the test set."""
+        return self.test_transformed.drop(self.target_param, axis=1)
 
     @property
     def y_test_transformed(self):
         """Transformed target column of the test set."""
-        return self.pipeline.transform(y=self.y_test)
+        return self.test_transformed[self.target_param]
 
     def _create_model_get_train_X_y(self, X_train, y_train):
         """Return appropriate training X and y values depending on whether
         X_train and y_train are passed or not. If X_train and y_train are not
         passes, internal self.X_train and self.y_train are returned. If they are
         passed, then a copy of them is returned.
         """
```

## pycaret/internal/pycaret_experiment/pycaret_experiment.py

```diff
@@ -6,15 +6,14 @@
 
 import cloudpickle
 import pandas as pd
 
 import pycaret.internal.patches.sklearn
 import pycaret.internal.patches.yellowbrick
 import pycaret.internal.persistence
-from pycaret import show_versions
 from pycaret.internal.logging import get_logger
 from pycaret.utils.constants import DATAFRAME_LIKE
 from pycaret.utils.generic import LazyExperimentMapping
 
 LOGGER = get_logger()
 
 
@@ -112,14 +111,16 @@
 
         import psutil
 
         self.logger.info(f"Memory: {psutil.virtual_memory()}")
         self.logger.info(f"Physical Core: {psutil.cpu_count(logical=False)}")
         self.logger.info(f"Logical Core: {psutil.cpu_count(logical=True)}")
 
+        from pycaret.utils._show_versions import show_versions
+
         self.logger.info("Checking libraries")
         self.logger.info(show_versions(logger=self.logger))
 
     def setup(self, *args, **kwargs) -> None:
         return
 
     def _check_setup_ran(self):
@@ -161,15 +162,14 @@
     def load_model(
         self,
         model_name: str,
         platform: Optional[str] = None,
         authentication: Optional[Dict[str, str]] = None,
         verbose: bool = True,
     ):
-
         """
         This function loads a previously saved transformation pipeline and model
         from the current active directory into the current python environment.
         Load object must be a pickle file.
 
         Example
         -------
@@ -211,15 +211,14 @@
         return pycaret.internal.persistence.load_model(
             model_name, platform, authentication, verbose
         )
 
     def get_logs(
         self, experiment_name: Optional[str] = None, save: bool = False
     ) -> pd.DataFrame:
-
         """
         Returns a table with experiment logs consisting
         run details, parameter, metrics and tags.
 
         Example
         -------
         >>> logs = get_logs()
@@ -350,16 +349,21 @@
         self.logger.info("Initializing set_config()")
         self.logger.info(f"set_config({function_params_str})")
 
         if kwargs and variable:
             raise ValueError(
                 "variable parameter cannot be used together with keyword arguments."
             )
-
-        variables = kwargs if kwargs else {variable: value}
+        else:
+            if kwargs:
+                variables = kwargs
+            elif variable:
+                variables = {variable: value}
+            else:
+                variables = {}
 
         for k, v in variables.items():
             if k.startswith("_"):
                 raise ValueError(f"Variable {k} is read only ('_' prefix).")
 
             writeable_keys = [
                 x
```

## pycaret/internal/pycaret_experiment/supervised_experiment.py

```diff
@@ -825,12666 +825,12753 @@
 00003380: 0a20 2020 2020 2020 2070 6172 616c 6c65  .        paralle
 00003390: 6c3a 204f 7074 696f 6e61 6c5b 5061 7261  l: Optional[Para
 000033a0: 6c6c 656c 4261 636b 656e 645d 203d 204e  llelBackend] = N
 000033b0: 6f6e 652c 0a20 2020 2020 2020 2063 616c  one,.        cal
 000033c0: 6c65 725f 7061 7261 6d73 3a20 4f70 7469  ler_params: Opti
 000033d0: 6f6e 616c 5b64 6963 745d 203d 204e 6f6e  onal[dict] = Non
 000033e0: 652c 0a20 2020 2029 202d 3e20 4c69 7374  e,.    ) -> List
-000033f0: 5b41 6e79 5d3a 0a0a 2020 2020 2020 2020  [Any]:..        
-00003400: 2222 220a 2020 2020 2020 2020 5468 6973  """.        This
-00003410: 2066 756e 6374 696f 6e20 7472 6169 6e20   function train 
-00003420: 616c 6c20 7468 6520 6d6f 6465 6c73 2061  all the models a
-00003430: 7661 696c 6162 6c65 2069 6e20 7468 6520  vailable in the 
-00003440: 6d6f 6465 6c20 6c69 6272 6172 7920 616e  model library an
-00003450: 6420 7363 6f72 6573 2074 6865 6d0a 2020  d scores them.  
-00003460: 2020 2020 2020 7573 696e 6720 4372 6f73        using Cros
-00003470: 7320 5661 6c69 6461 7469 6f6e 2e20 5468  s Validation. Th
-00003480: 6520 6f75 7470 7574 2070 7269 6e74 7320  e output prints 
-00003490: 6120 7363 6f72 6520 6772 6964 2077 6974  a score grid wit
-000034a0: 6820 4163 6375 7261 6379 2c0a 2020 2020  h Accuracy,.    
-000034b0: 2020 2020 4155 432c 2052 6563 616c 6c2c      AUC, Recall,
-000034c0: 2050 7265 6369 7369 6f6e 2c20 4631 2c20   Precision, F1, 
-000034d0: 4b61 7070 6120 616e 6420 4d43 4320 2861  Kappa and MCC (a
-000034e0: 7665 7261 6765 6420 6163 726f 7373 2066  veraged across f
-000034f0: 6f6c 6473 292e 0a0a 2020 2020 2020 2020  olds)...        
-00003500: 5468 6973 2066 756e 6374 696f 6e20 7265  This function re
-00003510: 7475 726e 7320 616c 6c20 6f66 2074 6865  turns all of the
-00003520: 206d 6f64 656c 7320 636f 6d70 6172 6564   models compared
-00003530: 2c20 736f 7274 6564 2062 7920 7468 6520  , sorted by the 
-00003540: 7661 6c75 6520 6f66 2074 6865 2073 656c  value of the sel
-00003550: 6563 7465 6420 6d65 7472 6963 2e0a 0a20  ected metric... 
-00003560: 2020 2020 2020 2057 6865 6e20 7475 7262         When turb
-00003570: 6f20 6973 2073 6574 2074 6f20 5472 7565  o is set to True
-00003580: 2028 2772 6266 7376 6d27 2c20 2767 7063   ('rbfsvm', 'gpc
-00003590: 2720 616e 6420 276d 6c70 2729 2061 7265  ' and 'mlp') are
-000035a0: 2065 7863 6c75 6465 6420 6475 6520 746f   excluded due to
-000035b0: 206c 6f6e 6765 720a 2020 2020 2020 2020   longer.        
-000035c0: 7472 6169 6e69 6e67 2074 696d 652e 2042  training time. B
-000035d0: 7920 6465 6661 756c 7420 7475 7262 6f20  y default turbo 
-000035e0: 7061 7261 6d65 7465 7220 6973 2073 6574  parameter is set
-000035f0: 2074 6f20 5472 7565 2e0a 0a20 2020 2020   to True...     
-00003600: 2020 2045 7861 6d70 6c65 0a20 2020 2020     Example.     
-00003610: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-00003620: 2020 203e 3e3e 2066 726f 6d20 7079 6361     >>> from pyca
-00003630: 7265 742e 6461 7461 7365 7473 2069 6d70  ret.datasets imp
-00003640: 6f72 7420 6765 745f 6461 7461 0a20 2020  ort get_data.   
-00003650: 2020 2020 203e 3e3e 206a 7569 6365 203d       >>> juice =
-00003660: 2067 6574 5f64 6174 6128 276a 7569 6365   get_data('juice
-00003670: 2729 0a20 2020 2020 2020 203e 3e3e 2065  ').        >>> e
-00003680: 7870 6572 696d 656e 745f 6e61 6d65 203d  xperiment_name =
-00003690: 2073 6574 7570 2864 6174 6120 3d20 6a75   setup(data = ju
-000036a0: 6963 652c 2020 7461 7267 6574 203d 2027  ice,  target = '
-000036b0: 5075 7263 6861 7365 2729 0a20 2020 2020  Purchase').     
-000036c0: 2020 203e 3e3e 2062 6573 745f 6d6f 6465     >>> best_mode
-000036d0: 6c20 3d20 636f 6d70 6172 655f 6d6f 6465  l = compare_mode
-000036e0: 6c73 2829 0a0a 2020 2020 2020 2020 5468  ls()..        Th
-000036f0: 6973 2077 696c 6c20 7265 7475 726e 2074  is will return t
-00003700: 6865 2061 7665 7261 6765 6420 7363 6f72  he averaged scor
-00003710: 6520 6772 6964 206f 6620 616c 6c20 7468  e grid of all th
-00003720: 6520 6d6f 6465 6c73 2065 7863 6570 7420  e models except 
-00003730: 2772 6266 7376 6d27 2c20 2767 7063 270a  'rbfsvm', 'gpc'.
-00003740: 2020 2020 2020 2020 616e 6420 276d 6c70          and 'mlp
-00003750: 272e 2057 6865 6e20 7475 7262 6f20 7061  '. When turbo pa
-00003760: 7261 6d65 7465 7220 6973 2073 6574 2074  rameter is set t
-00003770: 6f20 4661 6c73 652c 2061 6c6c 206d 6f64  o False, all mod
-00003780: 656c 7320 696e 636c 7564 696e 6720 2772  els including 'r
-00003790: 6266 7376 6d27 2c20 2767 7063 270a 2020  bfsvm', 'gpc'.  
-000037a0: 2020 2020 2020 616e 6420 276d 6c70 2720        and 'mlp' 
-000037b0: 6172 6520 7573 6564 2062 7574 2074 6869  are used but thi
-000037c0: 7320 6d61 7920 7265 7375 6c74 2069 6e20  s may result in 
-000037d0: 6c6f 6e67 6572 2074 7261 696e 696e 6720  longer training 
-000037e0: 7469 6d65 2e0a 0a20 2020 2020 2020 203e  time...        >
-000037f0: 3e3e 2062 6573 745f 6d6f 6465 6c20 3d20  >> best_model = 
-00003800: 636f 6d70 6172 655f 6d6f 6465 6c73 2820  compare_models( 
-00003810: 6578 636c 7564 6520 3d20 5b20 276b 6e6e  exclude = [ 'knn
-00003820: 272c 2027 6762 6327 205d 202c 2074 7572  ', 'gbc' ] , tur
-00003830: 626f 203d 2046 616c 7365 290a 0a20 2020  bo = False)..   
-00003840: 2020 2020 2054 6869 7320 7769 6c6c 2072       This will r
-00003850: 6574 7572 6e20 6120 636f 6d70 6172 6973  eturn a comparis
-00003860: 6f6e 206f 6620 616c 6c20 6d6f 6465 6c73  on of all models
-00003870: 2065 7863 6570 7420 4b20 4e65 6172 6573   except K Neares
-00003880: 7420 4e65 6967 6862 6f75 7220 616e 640a  t Neighbour and.
-00003890: 2020 2020 2020 2020 4772 6164 6965 6e74          Gradient
-000038a0: 2042 6f6f 7374 696e 6720 436c 6173 7369   Boosting Classi
-000038b0: 6669 6572 2e0a 0a20 2020 2020 2020 203e  fier...        >
-000038c0: 3e3e 2062 6573 745f 6d6f 6465 6c20 3d20  >> best_model = 
-000038d0: 636f 6d70 6172 655f 6d6f 6465 6c73 2820  compare_models( 
-000038e0: 6578 636c 7564 6520 3d20 5b20 276b 6e6e  exclude = [ 'knn
-000038f0: 272c 2027 6762 6327 205d 202c 2074 7572  ', 'gbc' ] , tur
-00003900: 626f 203d 2054 7275 6529 0a0a 2020 2020  bo = True)..    
-00003910: 2020 2020 5468 6973 2077 696c 6c20 7265      This will re
-00003920: 7475 726e 2063 6f6d 7061 7269 736f 6e20  turn comparison 
-00003930: 6f66 2061 6c6c 206d 6f64 656c 7320 6578  of all models ex
-00003940: 6365 7074 204b 204e 6561 7265 7374 204e  cept K Nearest N
-00003950: 6569 6768 626f 7572 2c0a 2020 2020 2020  eighbour,.      
-00003960: 2020 4772 6164 6965 6e74 2042 6f6f 7374    Gradient Boost
-00003970: 696e 6720 436c 6173 7369 6669 6572 2c20  ing Classifier, 
-00003980: 5356 4d20 2852 4246 292c 2047 6175 7373  SVM (RBF), Gauss
-00003990: 6961 6e20 5072 6f63 6573 7320 436c 6173  ian Process Clas
-000039a0: 7369 6669 6572 2061 6e64 0a20 2020 2020  sifier and.     
-000039b0: 2020 204d 756c 7469 204c 6576 656c 2050     Multi Level P
-000039c0: 6572 6365 7074 726f 6e2e 0a0a 0a20 2020  erceptron....   
-000039d0: 2020 2020 203e 3e3e 2074 756e 6564 5f6d       >>> tuned_m
-000039e0: 6f64 656c 203d 2074 756e 655f 6d6f 6465  odel = tune_mode
-000039f0: 6c28 6372 6561 7465 5f6d 6f64 656c 2827  l(create_model('
-00003a00: 6c72 2729 290a 2020 2020 2020 2020 3e3e  lr')).        >>
-00003a10: 3e20 6265 7374 5f6d 6f64 656c 203d 2063  > best_model = c
-00003a20: 6f6d 7061 7265 5f6d 6f64 656c 7328 2069  ompare_models( i
-00003a30: 6e63 6c75 6465 203d 205b 2027 6c72 272c  nclude = [ 'lr',
-00003a40: 2074 756e 6564 5f6d 6f64 656c 205d 290a   tuned_model ]).
-00003a50: 0a20 2020 2020 2020 2054 6869 7320 7769  .        This wi
-00003a60: 6c6c 2063 6f6d 7061 7265 2061 2074 756e  ll compare a tun
-00003a70: 6564 204c 696e 6561 7220 5265 6772 6573  ed Linear Regres
-00003a80: 7369 6f6e 206d 6f64 656c 2077 6974 6820  sion model with 
-00003a90: 616e 2075 6e74 756e 6564 206f 6e65 2e0a  an untuned one..
-00003aa0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00003ab0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00003ac0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2065  ------.        e
-00003ad0: 7863 6c75 6465 3a20 6c69 7374 206f 6620  xclude: list of 
-00003ae0: 7374 7269 6e67 732c 2064 6566 6175 6c74  strings, default
-00003af0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00003b00: 2020 2020 496e 206f 7264 6572 2074 6f20      In order to 
-00003b10: 6f6d 6974 2063 6572 7461 696e 206d 6f64  omit certain mod
-00003b20: 656c 7320 6672 6f6d 2074 6865 2063 6f6d  els from the com
-00003b30: 7061 7269 736f 6e20 6d6f 6465 6c20 4944  parison model ID
-00003b40: 2773 2063 616e 2062 6520 7061 7373 6564  's can be passed
-00003b50: 2061 730a 2020 2020 2020 2020 2020 2020   as.            
-00003b60: 6120 6c69 7374 206f 6620 7374 7269 6e67  a list of string
-00003b70: 7320 696e 2065 7863 6c75 6465 2070 6172  s in exclude par
-00003b80: 616d 2e0a 0a20 2020 2020 2020 2069 6e63  am...        inc
-00003b90: 6c75 6465 3a20 6c69 7374 206f 6620 7374  lude: list of st
-00003ba0: 7269 6e67 7320 6f72 206f 626a 6563 7473  rings or objects
-00003bb0: 2c20 6465 6661 756c 7420 3d20 4e6f 6e65  , default = None
-00003bc0: 0a20 2020 2020 2020 2020 2020 2049 6e20  .            In 
-00003bd0: 6f72 6465 7220 746f 2072 756e 206f 6e6c  order to run onl
-00003be0: 7920 6365 7274 6169 6e20 6d6f 6465 6c73  y certain models
-00003bf0: 2066 6f72 2074 6865 2063 6f6d 7061 7269   for the compari
-00003c00: 736f 6e2c 2074 6865 206d 6f64 656c 2049  son, the model I
-00003c10: 4427 7320 6361 6e20 6265 0a20 2020 2020  D's can be.     
-00003c20: 2020 2020 2020 2070 6173 7365 6420 6173         passed as
-00003c30: 2061 206c 6973 7420 6f66 2073 7472 696e   a list of strin
-00003c40: 6773 2069 6e20 696e 636c 7564 6520 7061  gs in include pa
-00003c50: 7261 6d2e 2054 6865 206c 6973 7420 6361  ram. The list ca
-00003c60: 6e20 616c 736f 2069 6e63 6c75 6465 2065  n also include e
-00003c70: 7374 696d 6174 6f72 0a20 2020 2020 2020  stimator.       
-00003c80: 2020 2020 206f 626a 6563 7473 2074 6f20       objects to 
-00003c90: 6265 2063 6f6d 7061 7265 642e 0a0a 2020  be compared...  
-00003ca0: 2020 2020 2020 666f 6c64 3a20 696e 7465        fold: inte
-00003cb0: 6765 7220 6f72 2073 6369 6b69 742d 6c65  ger or scikit-le
-00003cc0: 6172 6e20 636f 6d70 6174 6962 6c65 2043  arn compatible C
-00003cd0: 5620 6765 6e65 7261 746f 722c 2064 6566  V generator, def
-00003ce0: 6175 6c74 203d 204e 6f6e 650a 2020 2020  ault = None.    
-00003cf0: 2020 2020 2020 2020 436f 6e74 726f 6c73          Controls
-00003d00: 2063 726f 7373 2d76 616c 6964 6174 696f   cross-validatio
-00003d10: 6e2e 2049 6620 4e6f 6e65 2c20 7769 6c6c  n. If None, will
-00003d20: 2075 7365 2074 6865 2043 5620 6765 6e65   use the CV gene
-00003d30: 7261 746f 7220 6465 6669 6e65 6420 696e  rator defined in
-00003d40: 2073 6574 7570 2829 2e0a 2020 2020 2020   setup()..      
-00003d50: 2020 2020 2020 4966 2069 6e74 6567 6572        If integer
-00003d60: 2c20 7769 6c6c 2075 7365 204b 466f 6c64  , will use KFold
-00003d70: 2043 5620 7769 7468 2074 6861 7420 6d61   CV with that ma
-00003d80: 6e79 2066 6f6c 6473 2e0a 2020 2020 2020  ny folds..      
-00003d90: 2020 2020 2020 5768 656e 2063 726f 7373        When cross
-00003da0: 5f76 616c 6964 6174 696f 6e20 6973 2046  _validation is F
-00003db0: 616c 7365 2c20 7468 6973 2070 6172 616d  alse, this param
-00003dc0: 6574 6572 2069 7320 6967 6e6f 7265 642e  eter is ignored.
-00003dd0: 0a0a 2020 2020 2020 2020 726f 756e 643a  ..        round:
-00003de0: 2069 6e74 6567 6572 2c20 6465 6661 756c   integer, defaul
-00003df0: 7420 3d20 340a 2020 2020 2020 2020 2020  t = 4.          
-00003e00: 2020 4e75 6d62 6572 206f 6620 6465 6369    Number of deci
-00003e10: 6d61 6c20 706c 6163 6573 2074 6865 206d  mal places the m
-00003e20: 6574 7269 6373 2069 6e20 7468 6520 7363  etrics in the sc
-00003e30: 6f72 6520 6772 6964 2077 696c 6c20 6265  ore grid will be
-00003e40: 2072 6f75 6e64 6564 2074 6f2e 0a0a 2020   rounded to...  
-00003e50: 2020 2020 2020 6372 6f73 735f 7661 6c69        cross_vali
-00003e60: 6461 7469 6f6e 3a20 626f 6f6c 2c20 6465  dation: bool, de
-00003e70: 6661 756c 7420 3d20 5472 7565 0a20 2020  fault = True.   
-00003e80: 2020 2020 2020 2020 2057 6865 6e20 6372           When cr
-00003e90: 6f73 735f 7661 6c69 6461 7469 6f6e 2073  oss_validation s
-00003ea0: 6574 2074 6f20 4661 6c73 6520 666f 6c64  et to False fold
-00003eb0: 2070 6172 616d 6574 6572 2069 7320 6967   parameter is ig
-00003ec0: 6e6f 7265 6420 616e 6420 6d6f 6465 6c73  nored and models
-00003ed0: 2061 7265 2074 7261 696e 6564 0a20 2020   are trained.   
-00003ee0: 2020 2020 2020 2020 206f 6e20 656e 7469           on enti
-00003ef0: 7265 2074 7261 696e 696e 6720 6461 7461  re training data
-00003f00: 7365 742c 2072 6574 7572 6e69 6e67 206d  set, returning m
-00003f10: 6574 7269 6373 2063 616c 6375 6c61 7465  etrics calculate
-00003f20: 6420 7573 696e 6720 7468 6520 7472 6169  d using the trai
-00003f30: 6e20 2868 6f6c 646f 7574 2920 7365 742e  n (holdout) set.
-00003f40: 0a0a 2020 2020 2020 2020 736f 7274 3a20  ..        sort: 
-00003f50: 7374 722c 2064 6566 6175 6c74 203d 2027  str, default = '
-00003f60: 4163 6375 7261 6379 270a 2020 2020 2020  Accuracy'.      
-00003f70: 2020 2020 2020 5468 6520 7363 6f72 696e        The scorin
-00003f80: 6720 6d65 6173 7572 6520 7370 6563 6966  g measure specif
-00003f90: 6965 6420 6973 2075 7365 6420 666f 7220  ied is used for 
-00003fa0: 736f 7274 696e 6720 7468 6520 6176 6572  sorting the aver
-00003fb0: 6167 6520 7363 6f72 6520 6772 6964 0a20  age score grid. 
-00003fc0: 2020 2020 2020 2020 2020 204f 7468 6572             Other
-00003fd0: 206f 7074 696f 6e73 2061 7265 2027 4155   options are 'AU
-00003fe0: 4327 2c20 2752 6563 616c 6c27 2c20 2750  C', 'Recall', 'P
-00003ff0: 7265 6369 7369 6f6e 272c 2027 4631 272c  recision', 'F1',
-00004000: 2027 4b61 7070 6127 2061 6e64 2027 4d43   'Kappa' and 'MC
-00004010: 4327 2e0a 0a20 2020 2020 2020 206e 5f73  C'...        n_s
-00004020: 656c 6563 743a 2069 6e74 2c20 6465 6661  elect: int, defa
-00004030: 756c 7420 3d20 310a 2020 2020 2020 2020  ult = 1.        
-00004040: 2020 2020 4e75 6d62 6572 206f 6620 746f      Number of to
-00004050: 705f 6e20 6d6f 6465 6c73 2074 6f20 7265  p_n models to re
-00004060: 7475 726e 2e20 7573 6520 6e65 6761 7469  turn. use negati
-00004070: 7665 2061 7267 756d 656e 7420 666f 7220  ve argument for 
-00004080: 626f 7474 6f6d 2073 656c 6563 7469 6f6e  bottom selection
-00004090: 2e0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-000040a0: 7220 6578 616d 706c 652c 206e 5f73 656c  r example, n_sel
-000040b0: 6563 7420 3d20 2d33 206d 6561 6e73 2062  ect = -3 means b
-000040c0: 6f74 746f 6d20 3320 6d6f 6465 6c73 2e0a  ottom 3 models..
-000040d0: 0a20 2020 2020 2020 2062 7564 6765 745f  .        budget_
-000040e0: 7469 6d65 3a20 696e 7420 6f72 2066 6c6f  time: int or flo
-000040f0: 6174 2c20 6465 6661 756c 7420 3d20 4e6f  at, default = No
-00004100: 6e65 0a20 2020 2020 2020 2020 2020 2049  ne.            I
-00004110: 6620 6e6f 7420 3020 6f72 204e 6f6e 652c  f not 0 or None,
-00004120: 2077 696c 6c20 7465 726d 696e 6174 6520   will terminate 
-00004130: 6578 6563 7574 696f 6e20 6f66 2074 6865  execution of the
-00004140: 2066 756e 6374 696f 6e20 6166 7465 7220   function after 
-00004150: 6275 6467 6574 5f74 696d 650a 2020 2020  budget_time.    
-00004160: 2020 2020 2020 2020 6d69 6e75 7465 7320          minutes 
-00004170: 6861 7665 2070 6173 7365 6420 616e 6420  have passed and 
-00004180: 7265 7475 726e 2072 6573 756c 7473 2075  return results u
-00004190: 7020 746f 2074 6861 7420 706f 696e 742e  p to that point.
-000041a0: 0a0a 2020 2020 2020 2020 7475 7262 6f3a  ..        turbo:
-000041b0: 2062 6f6f 6c2c 2064 6566 6175 6c74 203d   bool, default =
-000041c0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
-000041d0: 2020 5768 656e 2074 7572 626f 2069 7320    When turbo is 
-000041e0: 7365 7420 746f 2054 7275 652c 2069 7420  set to True, it 
-000041f0: 6578 636c 7564 6573 2065 7374 696d 6174  excludes estimat
-00004200: 6f72 7320 7468 6174 2068 6176 6520 6c6f  ors that have lo
-00004210: 6e67 6572 0a20 2020 2020 2020 2020 2020  nger.           
-00004220: 2074 7261 696e 696e 6720 7469 6d65 2e0a   training time..
-00004230: 0a20 2020 2020 2020 2065 7272 6f72 733a  .        errors:
-00004240: 2073 7472 2c20 6465 6661 756c 7420 3d20   str, default = 
-00004250: 2769 676e 6f72 6527 0a20 2020 2020 2020  'ignore'.       
-00004260: 2020 2020 2049 6620 2769 676e 6f72 6527       If 'ignore'
-00004270: 2c20 7769 6c6c 2073 7570 7072 6573 7320  , will suppress 
-00004280: 6d6f 6465 6c20 6578 6365 7074 696f 6e73  model exceptions
-00004290: 2061 6e64 2063 6f6e 7469 6e75 652e 0a20   and continue.. 
-000042a0: 2020 2020 2020 2020 2020 2049 6620 2772             If 'r
-000042b0: 6169 7365 272c 2077 696c 6c20 616c 6c6f  aise', will allo
-000042c0: 7720 6578 6365 7074 696f 6e73 2074 6f20  w exceptions to 
-000042d0: 6265 2072 6169 7365 642e 0a0a 2020 2020  be raised...    
-000042e0: 2020 2020 6669 745f 6b77 6172 6773 3a20      fit_kwargs: 
-000042f0: 6469 6374 2c20 6465 6661 756c 7420 3d20  dict, default = 
-00004300: 7b7d 2028 656d 7074 7920 6469 6374 290a  {} (empty dict).
-00004310: 2020 2020 2020 2020 2020 2020 4469 6374              Dict
-00004320: 696f 6e61 7279 206f 6620 6172 6775 6d65  ionary of argume
-00004330: 6e74 7320 7061 7373 6564 2074 6f20 7468  nts passed to th
-00004340: 6520 6669 7420 6d65 7468 6f64 206f 6620  e fit method of 
-00004350: 7468 6520 6d6f 6465 6c2e 2054 6865 2070  the model. The p
-00004360: 6172 616d 6574 6572 7320 7769 6c6c 2062  arameters will b
-00004370: 6520 6170 706c 6965 6420 746f 2061 6c6c  e applied to all
-00004380: 206d 6f64 656c 732c 0a20 2020 2020 2020   models,.       
-00004390: 2020 2020 2074 6865 7265 666f 7265 2069       therefore i
-000043a0: 7420 6973 2072 6563 6f6d 6d65 6e64 6564  t is recommended
-000043b0: 2074 6f20 7365 7420 6572 726f 7273 2070   to set errors p
-000043c0: 6172 616d 6574 6572 2074 6f20 2769 676e  arameter to 'ign
-000043d0: 6f72 6527 2e0a 0a20 2020 2020 2020 2067  ore'...        g
-000043e0: 726f 7570 733a 2073 7472 206f 7220 6172  roups: str or ar
-000043f0: 7261 792d 6c69 6b65 2c20 7769 7468 2073  ray-like, with s
-00004400: 6861 7065 2028 6e5f 7361 6d70 6c65 732c  hape (n_samples,
-00004410: 292c 2064 6566 6175 6c74 203d 204e 6f6e  ), default = Non
-00004420: 650a 2020 2020 2020 2020 2020 2020 4f70  e.            Op
-00004430: 7469 6f6e 616c 2047 726f 7570 206c 6162  tional Group lab
-00004440: 656c 7320 666f 7220 7468 6520 7361 6d70  els for the samp
-00004450: 6c65 7320 7573 6564 2077 6869 6c65 2073  les used while s
-00004460: 706c 6974 7469 6e67 2074 6865 2064 6174  plitting the dat
-00004470: 6173 6574 2069 6e74 6f20 7472 6169 6e2f  aset into train/
-00004480: 7465 7374 2073 6574 2e0a 2020 2020 2020  test set..      
-00004490: 2020 2020 2020 4966 2073 7472 696e 6720        If string 
-000044a0: 6973 2070 6173 7365 642c 2077 696c 6c20  is passed, will 
-000044b0: 7573 6520 7468 6520 6461 7461 2063 6f6c  use the data col
-000044c0: 756d 6e20 7769 7468 2074 6861 7420 6e61  umn with that na
-000044d0: 6d65 2061 7320 7468 6520 6772 6f75 7073  me as the groups
-000044e0: 2e0a 2020 2020 2020 2020 2020 2020 4f6e  ..            On
-000044f0: 6c79 2075 7365 6420 6966 2061 2067 726f  ly used if a gro
-00004500: 7570 2062 6173 6564 2063 726f 7373 2d76  up based cross-v
-00004510: 616c 6964 6174 696f 6e20 6765 6e65 7261  alidation genera
-00004520: 746f 7220 6973 2075 7365 6420 2865 672e  tor is used (eg.
-00004530: 2047 726f 7570 4b46 6f6c 6429 2e0a 2020   GroupKFold)..  
-00004540: 2020 2020 2020 2020 2020 4966 204e 6f6e            If Non
-00004550: 652c 2077 696c 6c20 7573 6520 7468 6520  e, will use the 
-00004560: 7661 6c75 6520 7365 7420 696e 2066 6f6c  value set in fol
-00004570: 645f 6772 6f75 7073 2070 6172 616d 6574  d_groups paramet
-00004580: 6572 2069 6e20 7365 7475 7028 292e 0a0a  er in setup()...
-00004590: 2020 2020 2020 2020 7665 7262 6f73 653a          verbose:
-000045a0: 2062 6f6f 6c2c 2064 6566 6175 6c74 203d   bool, default =
-000045b0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
-000045c0: 2020 5363 6f72 6520 6772 6964 2069 7320    Score grid is 
-000045d0: 6e6f 7420 7072 696e 7465 6420 7768 656e  not printed when
-000045e0: 2076 6572 626f 7365 2069 7320 7365 7420   verbose is set 
-000045f0: 746f 2046 616c 7365 2e0a 0a0a 2020 2020  to False....    
-00004600: 2020 2020 7061 7261 6c6c 656c 3a20 7079      parallel: py
-00004610: 6361 7265 742e 696e 7465 726e 616c 2e70  caret.internal.p
-00004620: 6172 616c 6c65 6c2e 7061 7261 6c6c 656c  arallel.parallel
-00004630: 5f62 6163 6b65 6e64 2e50 6172 616c 6c65  _backend.Paralle
-00004640: 6c42 6163 6b65 6e64 2c20 6465 6661 756c  lBackend, defaul
-00004650: 7420 3d20 4e6f 6e65 0a20 2020 2020 2020  t = None.       
-00004660: 2020 2020 2041 2050 6172 616c 6c65 6c42       A ParallelB
-00004670: 6163 6b65 6e64 2069 6e73 7461 6e63 652e  ackend instance.
-00004680: 2046 6f72 2065 7861 6d70 6c65 2069 6620   For example if 
-00004690: 796f 7520 6861 7665 2061 2053 7061 726b  you have a Spark
-000046a0: 5365 7373 696f 6e20 6060 7365 7373 696f  Session ``sessio
-000046b0: 6e60 602c 0a20 2020 2020 2020 2020 2020  n``,.           
-000046c0: 2079 6f75 2063 616e 2075 7365 2060 6046   you can use ``F
-000046d0: 7567 7565 4261 636b 656e 6428 7365 7373  ugueBackend(sess
-000046e0: 696f 6e29 6060 2074 6f20 6d61 6b65 2074  ion)`` to make t
-000046f0: 6869 7320 6675 6e63 7469 6f6e 2072 756e  his function run
-00004700: 6e69 6e67 2075 7369 6e67 0a20 2020 2020  ning using.     
-00004710: 2020 2020 2020 2053 7061 726b 2e20 466f         Spark. Fo
-00004720: 7220 6d6f 7265 2064 6574 6169 6c73 2c20  r more details, 
-00004730: 7365 650a 2020 2020 2020 2020 2020 2020  see.            
-00004740: 3a63 6c61 7373 3a60 7e70 7963 6172 6574  :class:`~pycaret
-00004750: 2e70 6172 616c 6c65 6c2e 6675 6775 655f  .parallel.fugue_
-00004760: 6261 636b 656e 642e 4675 6775 6542 6163  backend.FugueBac
-00004770: 6b65 6e64 600a 0a0a 2020 2020 2020 2020  kend`...        
-00004780: 6361 6c6c 6572 5f70 6172 616d 733a 2064  caller_params: d
-00004790: 6963 742c 2064 6566 6175 6c74 203d 204e  ict, default = N
-000047a0: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-000047b0: 5468 6520 7061 7261 6d65 7465 7273 2075  The parameters u
-000047c0: 7365 6420 746f 2063 616c 6c20 7468 6973  sed to call this
-000047d0: 2066 756e 6374 696f 6e20 696e 2074 6865   function in the
-000047e0: 2073 7562 636c 6173 732e 2054 6865 7265   subclass. There
-000047f0: 2061 7265 2069 6e63 6f6e 7369 7374 656e   are inconsisten
-00004800: 6369 6573 0a20 2020 2020 2020 2020 2020  cies.           
-00004810: 2069 6e20 7468 6973 2066 756e 6374 696f   in this functio
-00004820: 6e27 7320 7369 676e 6174 7572 6520 6265  n's signature be
-00004830: 7477 6565 6e20 7468 6973 2062 6173 6520  tween this base 
-00004840: 636c 6173 7320 616e 6420 7468 6520 7375  class and the su
-00004850: 6263 6c61 7373 6573 2c20 736f 2074 6869  bclasses, so thi
-00004860: 7320 6973 0a20 2020 2020 2020 2020 2020  s is.           
-00004870: 2075 7365 6420 746f 2070 7265 7665 6e74   used to prevent
-00004880: 2069 6e63 6f6e 7369 7374 656e 6369 6573   inconsistencies
-00004890: 2e20 4974 206d 7573 7420 6265 2073 6574  . It must be set
-000048a0: 2077 6865 6e20 6060 7061 7261 6c6c 656c   when ``parallel
-000048b0: 6060 2069 7320 6e6f 7420 4e6f 6e65 0a0a  `` is not None..
-000048c0: 0a20 2020 2020 2020 2065 7874 7261 5f70  .        extra_p
-000048d0: 6172 616d 733a 2041 6e79 0a20 2020 2020  arams: Any.     
-000048e0: 2020 2020 2020 2045 7874 7261 2070 6172         Extra par
-000048f0: 616d 6574 6572 7320 7573 6564 2074 6f20  ameters used to 
-00004900: 6361 6c6c 2074 6865 2073 616d 6520 6d65  call the same me
-00004910: 7468 6f64 2069 6e20 7468 6520 6465 7269  thod in the deri
-00004920: 7665 6420 636c 6173 732e 2054 6865 7365  ved class. These
-00004930: 2070 6172 616d 6574 6572 730a 2020 2020   parameters.    
-00004940: 2020 2020 2020 2020 6172 6520 6d61 696e          are main
-00004950: 6c79 2075 7365 6420 7768 656e 2060 6070  ly used when ``p
-00004960: 6172 616c 6c65 6c60 6020 6973 206e 6f74  arallel`` is not
-00004970: 204e 6f6e 652e 0a0a 0a20 2020 2020 2020   None....       
-00004980: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
-00004990: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
-000049a0: 2073 636f 7265 5f67 7269 640a 2020 2020   score_grid.    
-000049b0: 2020 2020 2020 2020 4120 7461 626c 6520          A table 
-000049c0: 636f 6e74 6169 6e69 6e67 2074 6865 2073  containing the s
-000049d0: 636f 7265 7320 6f66 2074 6865 206d 6f64  cores of the mod
-000049e0: 656c 2061 6372 6f73 7320 7468 6520 6b66  el across the kf
-000049f0: 6f6c 6473 2e0a 2020 2020 2020 2020 2020  olds..          
-00004a00: 2020 5363 6f72 696e 6720 6d65 7472 6963    Scoring metric
-00004a10: 7320 7573 6564 2061 7265 2041 6363 7572  s used are Accur
-00004a20: 6163 792c 2041 5543 2c20 5265 6361 6c6c  acy, AUC, Recall
-00004a30: 2c20 5072 6563 6973 696f 6e2c 2046 312c  , Precision, F1,
-00004a40: 0a20 2020 2020 2020 2020 2020 204b 6170  .            Kap
-00004a50: 7061 2061 6e64 204d 4343 2e20 4d65 616e  pa and MCC. Mean
-00004a60: 2061 6e64 2073 7461 6e64 6172 6420 6465   and standard de
-00004a70: 7669 6174 696f 6e20 6f66 2074 6865 2073  viation of the s
-00004a80: 636f 7265 7320 6163 726f 7373 0a20 2020  cores across.   
-00004a90: 2020 2020 2020 2020 2074 6865 2066 6f6c           the fol
-00004aa0: 6473 2061 7265 2061 6c73 6f20 7265 7475  ds are also retu
-00004ab0: 726e 6564 2e0a 0a20 2020 2020 2020 206c  rned...        l
-00004ac0: 6973 740a 2020 2020 2020 2020 2020 2020  ist.            
-00004ad0: 4c69 7374 206f 6620 6669 7474 6564 206d  List of fitted m
-00004ae0: 6f64 656c 206f 626a 6563 7473 2074 6861  odel objects tha
-00004af0: 7420 7765 7265 2063 6f6d 7061 7265 642e  t were compared.
-00004b00: 0a0a 2020 2020 2020 2020 5761 726e 696e  ..        Warnin
-00004b10: 6773 0a20 2020 2020 2020 202d 2d2d 2d2d  gs.        -----
-00004b20: 2d2d 2d0a 2020 2020 2020 2020 2d20 636f  ---.        - co
-00004b30: 6d70 6172 655f 6d6f 6465 6c73 2829 2074  mpare_models() t
-00004b40: 686f 7567 6820 6174 7472 6163 7469 7665  hough attractive
-00004b50: 2c20 6d69 6768 7420 6265 2074 696d 6520  , might be time 
-00004b60: 636f 6e73 756d 696e 6720 7769 7468 206c  consuming with l
-00004b70: 6172 6765 0a20 2020 2020 2020 2064 6174  arge.        dat
-00004b80: 6173 6574 732e 2042 7920 6465 6661 756c  asets. By defaul
-00004b90: 7420 7475 7262 6f20 6973 2073 6574 2074  t turbo is set t
-00004ba0: 6f20 5472 7565 2c20 7768 6963 6820 6578  o True, which ex
-00004bb0: 636c 7564 6573 206d 6f64 656c 7320 7468  cludes models th
-00004bc0: 6174 0a20 2020 2020 2020 2068 6176 6520  at.        have 
-00004bd0: 6c6f 6e67 6572 2074 7261 696e 696e 6720  longer training 
-00004be0: 7469 6d65 732e 2043 6861 6e67 696e 6720  times. Changing 
-00004bf0: 7475 7262 6f20 7061 7261 6d65 7465 7220  turbo parameter 
-00004c00: 746f 2046 616c 7365 206d 6179 2072 6573  to False may res
-00004c10: 756c 740a 2020 2020 2020 2020 696e 2076  ult.        in v
-00004c20: 6572 7920 6869 6768 2074 7261 696e 696e  ery high trainin
-00004c30: 6720 7469 6d65 7320 7769 7468 2064 6174  g times with dat
-00004c40: 6173 6574 7320 7768 6572 6520 6e75 6d62  asets where numb
-00004c50: 6572 206f 6620 7361 6d70 6c65 7320 6578  er of samples ex
-00004c60: 6365 6564 0a20 2020 2020 2020 2031 302c  ceed.        10,
-00004c70: 3030 302e 0a0a 2020 2020 2020 2020 2d20  000...        - 
-00004c80: 4966 2074 6172 6765 7420 7661 7269 6162  If target variab
-00004c90: 6c65 2069 7320 6d75 6c74 6963 6c61 7373  le is multiclass
-00004ca0: 2028 6d6f 7265 2074 6861 6e20 3220 636c   (more than 2 cl
-00004cb0: 6173 7365 7329 2c20 4155 4320 7769 6c6c  asses), AUC will
-00004cc0: 2062 650a 2020 2020 2020 2020 7265 7475   be.        retu
-00004cd0: 726e 6564 2061 7320 7a65 726f 2028 302e  rned as zero (0.
-00004ce0: 3029 0a0a 2020 2020 2020 2020 2d20 4966  0)..        - If
-00004cf0: 2063 726f 7373 5f76 616c 6964 6174 696f   cross_validatio
-00004d00: 6e20 7061 7261 6d65 7465 7220 6973 2073  n parameter is s
-00004d10: 6574 2074 6f20 4661 6c73 652c 206e 6f20  et to False, no 
-00004d20: 6d6f 6465 6c73 2077 696c 6c20 6265 206c  models will be l
-00004d30: 6f67 6765 6420 7769 7468 204d 4c46 6c6f  ogged with MLFlo
-00004d40: 772e 0a0a 2020 2020 2020 2020 2222 220a  w...        """.
-00004d50: 2020 2020 2020 2020 7365 6c66 2e5f 6368          self._ch
-00004d60: 6563 6b5f 7365 7475 705f 7261 6e28 290a  eck_setup_ran().
-00004d70: 0a20 2020 2020 2020 2069 6620 7061 7261  .        if para
-00004d80: 6c6c 656c 2069 7320 6e6f 7420 4e6f 6e65  llel is not None
-00004d90: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00004da0: 7475 726e 2073 656c 662e 5f70 6172 616c  turn self._paral
-00004db0: 6c65 6c5f 636f 6d70 6172 655f 6d6f 6465  lel_compare_mode
-00004dc0: 6c73 2870 6172 616c 6c65 6c2c 2063 616c  ls(parallel, cal
-00004dd0: 6c65 725f 7061 7261 6d73 2c20 7475 7262  ler_params, turb
-00004de0: 6f3d 7475 7262 6f29 0a0a 2020 2020 2020  o=turbo)..      
-00004df0: 2020 2320 4e6f 2065 7874 7261 2063 6f64    # No extra cod
-00004e00: 6520 7368 6f75 6c64 2062 6520 6164 6465  e should be adde
-00004e10: 6420 6162 6f76 6520 7468 6973 206c 696e  d above this lin
-00004e20: 650a 2020 2020 2020 2020 2320 2d2d 2d2d  e.        # ----
+000033f0: 5b41 6e79 5d3a 0a20 2020 2020 2020 2022  [Any]:.        "
+00003400: 2222 0a20 2020 2020 2020 2054 6869 7320  "".        This 
+00003410: 6675 6e63 7469 6f6e 2074 7261 696e 2061  function train a
+00003420: 6c6c 2074 6865 206d 6f64 656c 7320 6176  ll the models av
+00003430: 6169 6c61 626c 6520 696e 2074 6865 206d  ailable in the m
+00003440: 6f64 656c 206c 6962 7261 7279 2061 6e64  odel library and
+00003450: 2073 636f 7265 7320 7468 656d 0a20 2020   scores them.   
+00003460: 2020 2020 2075 7369 6e67 2043 726f 7373       using Cross
+00003470: 2056 616c 6964 6174 696f 6e2e 2054 6865   Validation. The
+00003480: 206f 7574 7075 7420 7072 696e 7473 2061   output prints a
+00003490: 2073 636f 7265 2067 7269 6420 7769 7468   score grid with
+000034a0: 2041 6363 7572 6163 792c 0a20 2020 2020   Accuracy,.     
+000034b0: 2020 2041 5543 2c20 5265 6361 6c6c 2c20     AUC, Recall, 
+000034c0: 5072 6563 6973 696f 6e2c 2046 312c 204b  Precision, F1, K
+000034d0: 6170 7061 2061 6e64 204d 4343 2028 6176  appa and MCC (av
+000034e0: 6572 6167 6564 2061 6372 6f73 7320 666f  eraged across fo
+000034f0: 6c64 7329 2e0a 0a20 2020 2020 2020 2054  lds)...        T
+00003500: 6869 7320 6675 6e63 7469 6f6e 2072 6574  his function ret
+00003510: 7572 6e73 2061 6c6c 206f 6620 7468 6520  urns all of the 
+00003520: 6d6f 6465 6c73 2063 6f6d 7061 7265 642c  models compared,
+00003530: 2073 6f72 7465 6420 6279 2074 6865 2076   sorted by the v
+00003540: 616c 7565 206f 6620 7468 6520 7365 6c65  alue of the sele
+00003550: 6374 6564 206d 6574 7269 632e 0a0a 2020  cted metric...  
+00003560: 2020 2020 2020 5768 656e 2074 7572 626f        When turbo
+00003570: 2069 7320 7365 7420 746f 2054 7275 6520   is set to True 
+00003580: 2827 7262 6673 766d 272c 2027 6770 6327  ('rbfsvm', 'gpc'
+00003590: 2061 6e64 2027 6d6c 7027 2920 6172 6520   and 'mlp') are 
+000035a0: 6578 636c 7564 6564 2064 7565 2074 6f20  excluded due to 
+000035b0: 6c6f 6e67 6572 0a20 2020 2020 2020 2074  longer.        t
+000035c0: 7261 696e 696e 6720 7469 6d65 2e20 4279  raining time. By
+000035d0: 2064 6566 6175 6c74 2074 7572 626f 2070   default turbo p
+000035e0: 6172 616d 6574 6572 2069 7320 7365 7420  arameter is set 
+000035f0: 746f 2054 7275 652e 0a0a 2020 2020 2020  to True...      
+00003600: 2020 4578 616d 706c 650a 2020 2020 2020    Example.      
+00003610: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+00003620: 2020 3e3e 3e20 6672 6f6d 2070 7963 6172    >>> from pycar
+00003630: 6574 2e64 6174 6173 6574 7320 696d 706f  et.datasets impo
+00003640: 7274 2067 6574 5f64 6174 610a 2020 2020  rt get_data.    
+00003650: 2020 2020 3e3e 3e20 6a75 6963 6520 3d20      >>> juice = 
+00003660: 6765 745f 6461 7461 2827 6a75 6963 6527  get_data('juice'
+00003670: 290a 2020 2020 2020 2020 3e3e 3e20 6578  ).        >>> ex
+00003680: 7065 7269 6d65 6e74 5f6e 616d 6520 3d20  periment_name = 
+00003690: 7365 7475 7028 6461 7461 203d 206a 7569  setup(data = jui
+000036a0: 6365 2c20 2074 6172 6765 7420 3d20 2750  ce,  target = 'P
+000036b0: 7572 6368 6173 6527 290a 2020 2020 2020  urchase').      
+000036c0: 2020 3e3e 3e20 6265 7374 5f6d 6f64 656c    >>> best_model
+000036d0: 203d 2063 6f6d 7061 7265 5f6d 6f64 656c   = compare_model
+000036e0: 7328 290a 0a20 2020 2020 2020 2054 6869  s()..        Thi
+000036f0: 7320 7769 6c6c 2072 6574 7572 6e20 7468  s will return th
+00003700: 6520 6176 6572 6167 6564 2073 636f 7265  e averaged score
+00003710: 2067 7269 6420 6f66 2061 6c6c 2074 6865   grid of all the
+00003720: 206d 6f64 656c 7320 6578 6365 7074 2027   models except '
+00003730: 7262 6673 766d 272c 2027 6770 6327 0a20  rbfsvm', 'gpc'. 
+00003740: 2020 2020 2020 2061 6e64 2027 6d6c 7027         and 'mlp'
+00003750: 2e20 5768 656e 2074 7572 626f 2070 6172  . When turbo par
+00003760: 616d 6574 6572 2069 7320 7365 7420 746f  ameter is set to
+00003770: 2046 616c 7365 2c20 616c 6c20 6d6f 6465   False, all mode
+00003780: 6c73 2069 6e63 6c75 6469 6e67 2027 7262  ls including 'rb
+00003790: 6673 766d 272c 2027 6770 6327 0a20 2020  fsvm', 'gpc'.   
+000037a0: 2020 2020 2061 6e64 2027 6d6c 7027 2061       and 'mlp' a
+000037b0: 7265 2075 7365 6420 6275 7420 7468 6973  re used but this
+000037c0: 206d 6179 2072 6573 756c 7420 696e 206c   may result in l
+000037d0: 6f6e 6765 7220 7472 6169 6e69 6e67 2074  onger training t
+000037e0: 696d 652e 0a0a 2020 2020 2020 2020 3e3e  ime...        >>
+000037f0: 3e20 6265 7374 5f6d 6f64 656c 203d 2063  > best_model = c
+00003800: 6f6d 7061 7265 5f6d 6f64 656c 7328 2065  ompare_models( e
+00003810: 7863 6c75 6465 203d 205b 2027 6b6e 6e27  xclude = [ 'knn'
+00003820: 2c20 2767 6263 2720 5d20 2c20 7475 7262  , 'gbc' ] , turb
+00003830: 6f20 3d20 4661 6c73 6529 0a0a 2020 2020  o = False)..    
+00003840: 2020 2020 5468 6973 2077 696c 6c20 7265      This will re
+00003850: 7475 726e 2061 2063 6f6d 7061 7269 736f  turn a compariso
+00003860: 6e20 6f66 2061 6c6c 206d 6f64 656c 7320  n of all models 
+00003870: 6578 6365 7074 204b 204e 6561 7265 7374  except K Nearest
+00003880: 204e 6569 6768 626f 7572 2061 6e64 0a20   Neighbour and. 
+00003890: 2020 2020 2020 2047 7261 6469 656e 7420         Gradient 
+000038a0: 426f 6f73 7469 6e67 2043 6c61 7373 6966  Boosting Classif
+000038b0: 6965 722e 0a0a 2020 2020 2020 2020 3e3e  ier...        >>
+000038c0: 3e20 6265 7374 5f6d 6f64 656c 203d 2063  > best_model = c
+000038d0: 6f6d 7061 7265 5f6d 6f64 656c 7328 2065  ompare_models( e
+000038e0: 7863 6c75 6465 203d 205b 2027 6b6e 6e27  xclude = [ 'knn'
+000038f0: 2c20 2767 6263 2720 5d20 2c20 7475 7262  , 'gbc' ] , turb
+00003900: 6f20 3d20 5472 7565 290a 0a20 2020 2020  o = True)..     
+00003910: 2020 2054 6869 7320 7769 6c6c 2072 6574     This will ret
+00003920: 7572 6e20 636f 6d70 6172 6973 6f6e 206f  urn comparison o
+00003930: 6620 616c 6c20 6d6f 6465 6c73 2065 7863  f all models exc
+00003940: 6570 7420 4b20 4e65 6172 6573 7420 4e65  ept K Nearest Ne
+00003950: 6967 6862 6f75 722c 0a20 2020 2020 2020  ighbour,.       
+00003960: 2047 7261 6469 656e 7420 426f 6f73 7469   Gradient Boosti
+00003970: 6e67 2043 6c61 7373 6966 6965 722c 2053  ng Classifier, S
+00003980: 564d 2028 5242 4629 2c20 4761 7573 7369  VM (RBF), Gaussi
+00003990: 616e 2050 726f 6365 7373 2043 6c61 7373  an Process Class
+000039a0: 6966 6965 7220 616e 640a 2020 2020 2020  ifier and.      
+000039b0: 2020 4d75 6c74 6920 4c65 7665 6c20 5065    Multi Level Pe
+000039c0: 7263 6570 7472 6f6e 2e0a 0a0a 2020 2020  rceptron....    
+000039d0: 2020 2020 3e3e 3e20 7475 6e65 645f 6d6f      >>> tuned_mo
+000039e0: 6465 6c20 3d20 7475 6e65 5f6d 6f64 656c  del = tune_model
+000039f0: 2863 7265 6174 655f 6d6f 6465 6c28 276c  (create_model('l
+00003a00: 7227 2929 0a20 2020 2020 2020 203e 3e3e  r')).        >>>
+00003a10: 2062 6573 745f 6d6f 6465 6c20 3d20 636f   best_model = co
+00003a20: 6d70 6172 655f 6d6f 6465 6c73 2820 696e  mpare_models( in
+00003a30: 636c 7564 6520 3d20 5b20 276c 7227 2c20  clude = [ 'lr', 
+00003a40: 7475 6e65 645f 6d6f 6465 6c20 5d29 0a0a  tuned_model ])..
+00003a50: 2020 2020 2020 2020 5468 6973 2077 696c          This wil
+00003a60: 6c20 636f 6d70 6172 6520 6120 7475 6e65  l compare a tune
+00003a70: 6420 4c69 6e65 6172 2052 6567 7265 7373  d Linear Regress
+00003a80: 696f 6e20 6d6f 6465 6c20 7769 7468 2061  ion model with a
+00003a90: 6e20 756e 7475 6e65 6420 6f6e 652e 0a0a  n untuned one...
+00003aa0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00003ab0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+00003ac0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6578  -----.        ex
+00003ad0: 636c 7564 653a 206c 6973 7420 6f66 2073  clude: list of s
+00003ae0: 7472 696e 6773 2c20 6465 6661 756c 7420  trings, default 
+00003af0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2020  = None.         
+00003b00: 2020 2049 6e20 6f72 6465 7220 746f 206f     In order to o
+00003b10: 6d69 7420 6365 7274 6169 6e20 6d6f 6465  mit certain mode
+00003b20: 6c73 2066 726f 6d20 7468 6520 636f 6d70  ls from the comp
+00003b30: 6172 6973 6f6e 206d 6f64 656c 2049 4427  arison model ID'
+00003b40: 7320 6361 6e20 6265 2070 6173 7365 6420  s can be passed 
+00003b50: 6173 0a20 2020 2020 2020 2020 2020 2061  as.            a
+00003b60: 206c 6973 7420 6f66 2073 7472 696e 6773   list of strings
+00003b70: 2069 6e20 6578 636c 7564 6520 7061 7261   in exclude para
+00003b80: 6d2e 0a0a 2020 2020 2020 2020 696e 636c  m...        incl
+00003b90: 7564 653a 206c 6973 7420 6f66 2073 7472  ude: list of str
+00003ba0: 696e 6773 206f 7220 6f62 6a65 6374 732c  ings or objects,
+00003bb0: 2064 6566 6175 6c74 203d 204e 6f6e 650a   default = None.
+00003bc0: 2020 2020 2020 2020 2020 2020 496e 206f              In o
+00003bd0: 7264 6572 2074 6f20 7275 6e20 6f6e 6c79  rder to run only
+00003be0: 2063 6572 7461 696e 206d 6f64 656c 7320   certain models 
+00003bf0: 666f 7220 7468 6520 636f 6d70 6172 6973  for the comparis
+00003c00: 6f6e 2c20 7468 6520 6d6f 6465 6c20 4944  on, the model ID
+00003c10: 2773 2063 616e 2062 650a 2020 2020 2020  's can be.      
+00003c20: 2020 2020 2020 7061 7373 6564 2061 7320        passed as 
+00003c30: 6120 6c69 7374 206f 6620 7374 7269 6e67  a list of string
+00003c40: 7320 696e 2069 6e63 6c75 6465 2070 6172  s in include par
+00003c50: 616d 2e20 5468 6520 6c69 7374 2063 616e  am. The list can
+00003c60: 2061 6c73 6f20 696e 636c 7564 6520 6573   also include es
+00003c70: 7469 6d61 746f 720a 2020 2020 2020 2020  timator.        
+00003c80: 2020 2020 6f62 6a65 6374 7320 746f 2062      objects to b
+00003c90: 6520 636f 6d70 6172 6564 2e0a 0a20 2020  e compared...   
+00003ca0: 2020 2020 2066 6f6c 643a 2069 6e74 6567       fold: integ
+00003cb0: 6572 206f 7220 7363 696b 6974 2d6c 6561  er or scikit-lea
+00003cc0: 726e 2063 6f6d 7061 7469 626c 6520 4356  rn compatible CV
+00003cd0: 2067 656e 6572 6174 6f72 2c20 6465 6661   generator, defa
+00003ce0: 756c 7420 3d20 4e6f 6e65 0a20 2020 2020  ult = None.     
+00003cf0: 2020 2020 2020 2043 6f6e 7472 6f6c 7320         Controls 
+00003d00: 6372 6f73 732d 7661 6c69 6461 7469 6f6e  cross-validation
+00003d10: 2e20 4966 204e 6f6e 652c 2077 696c 6c20  . If None, will 
+00003d20: 7573 6520 7468 6520 4356 2067 656e 6572  use the CV gener
+00003d30: 6174 6f72 2064 6566 696e 6564 2069 6e20  ator defined in 
+00003d40: 7365 7475 7028 292e 0a20 2020 2020 2020  setup()..       
+00003d50: 2020 2020 2049 6620 696e 7465 6765 722c       If integer,
+00003d60: 2077 696c 6c20 7573 6520 4b46 6f6c 6420   will use KFold 
+00003d70: 4356 2077 6974 6820 7468 6174 206d 616e  CV with that man
+00003d80: 7920 666f 6c64 732e 0a20 2020 2020 2020  y folds..       
+00003d90: 2020 2020 2057 6865 6e20 6372 6f73 735f       When cross_
+00003da0: 7661 6c69 6461 7469 6f6e 2069 7320 4661  validation is Fa
+00003db0: 6c73 652c 2074 6869 7320 7061 7261 6d65  lse, this parame
+00003dc0: 7465 7220 6973 2069 676e 6f72 6564 2e0a  ter is ignored..
+00003dd0: 0a20 2020 2020 2020 2072 6f75 6e64 3a20  .        round: 
+00003de0: 696e 7465 6765 722c 2064 6566 6175 6c74  integer, default
+00003df0: 203d 2034 0a20 2020 2020 2020 2020 2020   = 4.           
+00003e00: 204e 756d 6265 7220 6f66 2064 6563 696d   Number of decim
+00003e10: 616c 2070 6c61 6365 7320 7468 6520 6d65  al places the me
+00003e20: 7472 6963 7320 696e 2074 6865 2073 636f  trics in the sco
+00003e30: 7265 2067 7269 6420 7769 6c6c 2062 6520  re grid will be 
+00003e40: 726f 756e 6465 6420 746f 2e0a 0a20 2020  rounded to...   
+00003e50: 2020 2020 2063 726f 7373 5f76 616c 6964       cross_valid
+00003e60: 6174 696f 6e3a 2062 6f6f 6c2c 2064 6566  ation: bool, def
+00003e70: 6175 6c74 203d 2054 7275 650a 2020 2020  ault = True.    
+00003e80: 2020 2020 2020 2020 5768 656e 2063 726f          When cro
+00003e90: 7373 5f76 616c 6964 6174 696f 6e20 7365  ss_validation se
+00003ea0: 7420 746f 2046 616c 7365 2066 6f6c 6420  t to False fold 
+00003eb0: 7061 7261 6d65 7465 7220 6973 2069 676e  parameter is ign
+00003ec0: 6f72 6564 2061 6e64 206d 6f64 656c 7320  ored and models 
+00003ed0: 6172 6520 7472 6169 6e65 640a 2020 2020  are trained.    
+00003ee0: 2020 2020 2020 2020 6f6e 2065 6e74 6972          on entir
+00003ef0: 6520 7472 6169 6e69 6e67 2064 6174 6173  e training datas
+00003f00: 6574 2c20 7265 7475 726e 696e 6720 6d65  et, returning me
+00003f10: 7472 6963 7320 6361 6c63 756c 6174 6564  trics calculated
+00003f20: 2075 7369 6e67 2074 6865 2074 7261 696e   using the train
+00003f30: 2028 686f 6c64 6f75 7429 2073 6574 2e0a   (holdout) set..
+00003f40: 0a20 2020 2020 2020 2073 6f72 743a 2073  .        sort: s
+00003f50: 7472 2c20 6465 6661 756c 7420 3d20 2741  tr, default = 'A
+00003f60: 6363 7572 6163 7927 0a20 2020 2020 2020  ccuracy'.       
+00003f70: 2020 2020 2054 6865 2073 636f 7269 6e67       The scoring
+00003f80: 206d 6561 7375 7265 2073 7065 6369 6669   measure specifi
+00003f90: 6564 2069 7320 7573 6564 2066 6f72 2073  ed is used for s
+00003fa0: 6f72 7469 6e67 2074 6865 2061 7665 7261  orting the avera
+00003fb0: 6765 2073 636f 7265 2067 7269 640a 2020  ge score grid.  
+00003fc0: 2020 2020 2020 2020 2020 4f74 6865 7220            Other 
+00003fd0: 6f70 7469 6f6e 7320 6172 6520 2741 5543  options are 'AUC
+00003fe0: 272c 2027 5265 6361 6c6c 272c 2027 5072  ', 'Recall', 'Pr
+00003ff0: 6563 6973 696f 6e27 2c20 2746 3127 2c20  ecision', 'F1', 
+00004000: 274b 6170 7061 2720 616e 6420 274d 4343  'Kappa' and 'MCC
+00004010: 272e 0a0a 2020 2020 2020 2020 6e5f 7365  '...        n_se
+00004020: 6c65 6374 3a20 696e 742c 2064 6566 6175  lect: int, defau
+00004030: 6c74 203d 2031 0a20 2020 2020 2020 2020  lt = 1.         
+00004040: 2020 204e 756d 6265 7220 6f66 2074 6f70     Number of top
+00004050: 5f6e 206d 6f64 656c 7320 746f 2072 6574  _n models to ret
+00004060: 7572 6e2e 2075 7365 206e 6567 6174 6976  urn. use negativ
+00004070: 6520 6172 6775 6d65 6e74 2066 6f72 2062  e argument for b
+00004080: 6f74 746f 6d20 7365 6c65 6374 696f 6e2e  ottom selection.
+00004090: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+000040a0: 2065 7861 6d70 6c65 2c20 6e5f 7365 6c65   example, n_sele
+000040b0: 6374 203d 202d 3320 6d65 616e 7320 626f  ct = -3 means bo
+000040c0: 7474 6f6d 2033 206d 6f64 656c 732e 0a0a  ttom 3 models...
+000040d0: 2020 2020 2020 2020 6275 6467 6574 5f74          budget_t
+000040e0: 696d 653a 2069 6e74 206f 7220 666c 6f61  ime: int or floa
+000040f0: 742c 2064 6566 6175 6c74 203d 204e 6f6e  t, default = Non
+00004100: 650a 2020 2020 2020 2020 2020 2020 4966  e.            If
+00004110: 206e 6f74 2030 206f 7220 4e6f 6e65 2c20   not 0 or None, 
+00004120: 7769 6c6c 2074 6572 6d69 6e61 7465 2065  will terminate e
+00004130: 7865 6375 7469 6f6e 206f 6620 7468 6520  xecution of the 
+00004140: 6675 6e63 7469 6f6e 2061 6674 6572 2062  function after b
+00004150: 7564 6765 745f 7469 6d65 0a20 2020 2020  udget_time.     
+00004160: 2020 2020 2020 206d 696e 7574 6573 2068         minutes h
+00004170: 6176 6520 7061 7373 6564 2061 6e64 2072  ave passed and r
+00004180: 6574 7572 6e20 7265 7375 6c74 7320 7570  eturn results up
+00004190: 2074 6f20 7468 6174 2070 6f69 6e74 2e0a   to that point..
+000041a0: 0a20 2020 2020 2020 2074 7572 626f 3a20  .        turbo: 
+000041b0: 626f 6f6c 2c20 6465 6661 756c 7420 3d20  bool, default = 
+000041c0: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+000041d0: 2057 6865 6e20 7475 7262 6f20 6973 2073   When turbo is s
+000041e0: 6574 2074 6f20 5472 7565 2c20 6974 2065  et to True, it e
+000041f0: 7863 6c75 6465 7320 6573 7469 6d61 746f  xcludes estimato
+00004200: 7273 2074 6861 7420 6861 7665 206c 6f6e  rs that have lon
+00004210: 6765 720a 2020 2020 2020 2020 2020 2020  ger.            
+00004220: 7472 6169 6e69 6e67 2074 696d 652e 0a0a  training time...
+00004230: 2020 2020 2020 2020 6572 726f 7273 3a20          errors: 
+00004240: 7374 722c 2064 6566 6175 6c74 203d 2027  str, default = '
+00004250: 6967 6e6f 7265 270a 2020 2020 2020 2020  ignore'.        
+00004260: 2020 2020 4966 2027 6967 6e6f 7265 272c      If 'ignore',
+00004270: 2077 696c 6c20 7375 7070 7265 7373 206d   will suppress m
+00004280: 6f64 656c 2065 7863 6570 7469 6f6e 7320  odel exceptions 
+00004290: 616e 6420 636f 6e74 696e 7565 2e0a 2020  and continue..  
+000042a0: 2020 2020 2020 2020 2020 4966 2027 7261            If 'ra
+000042b0: 6973 6527 2c20 7769 6c6c 2061 6c6c 6f77  ise', will allow
+000042c0: 2065 7863 6570 7469 6f6e 7320 746f 2062   exceptions to b
+000042d0: 6520 7261 6973 6564 2e0a 0a20 2020 2020  e raised...     
+000042e0: 2020 2066 6974 5f6b 7761 7267 733a 2064     fit_kwargs: d
+000042f0: 6963 742c 2064 6566 6175 6c74 203d 207b  ict, default = {
+00004300: 7d20 2865 6d70 7479 2064 6963 7429 0a20  } (empty dict). 
+00004310: 2020 2020 2020 2020 2020 2044 6963 7469             Dicti
+00004320: 6f6e 6172 7920 6f66 2061 7267 756d 656e  onary of argumen
+00004330: 7473 2070 6173 7365 6420 746f 2074 6865  ts passed to the
+00004340: 2066 6974 206d 6574 686f 6420 6f66 2074   fit method of t
+00004350: 6865 206d 6f64 656c 2e20 5468 6520 7061  he model. The pa
+00004360: 7261 6d65 7465 7273 2077 696c 6c20 6265  rameters will be
+00004370: 2061 7070 6c69 6564 2074 6f20 616c 6c20   applied to all 
+00004380: 6d6f 6465 6c73 2c0a 2020 2020 2020 2020  models,.        
+00004390: 2020 2020 7468 6572 6566 6f72 6520 6974      therefore it
+000043a0: 2069 7320 7265 636f 6d6d 656e 6465 6420   is recommended 
+000043b0: 746f 2073 6574 2065 7272 6f72 7320 7061  to set errors pa
+000043c0: 7261 6d65 7465 7220 746f 2027 6967 6e6f  rameter to 'igno
+000043d0: 7265 272e 0a0a 2020 2020 2020 2020 6772  re'...        gr
+000043e0: 6f75 7073 3a20 7374 7220 6f72 2061 7272  oups: str or arr
+000043f0: 6179 2d6c 696b 652c 2077 6974 6820 7368  ay-like, with sh
+00004400: 6170 6520 286e 5f73 616d 706c 6573 2c29  ape (n_samples,)
+00004410: 2c20 6465 6661 756c 7420 3d20 4e6f 6e65  , default = None
+00004420: 0a20 2020 2020 2020 2020 2020 204f 7074  .            Opt
+00004430: 696f 6e61 6c20 4772 6f75 7020 6c61 6265  ional Group labe
+00004440: 6c73 2066 6f72 2074 6865 2073 616d 706c  ls for the sampl
+00004450: 6573 2075 7365 6420 7768 696c 6520 7370  es used while sp
+00004460: 6c69 7474 696e 6720 7468 6520 6461 7461  litting the data
+00004470: 7365 7420 696e 746f 2074 7261 696e 2f74  set into train/t
+00004480: 6573 7420 7365 742e 0a20 2020 2020 2020  est set..       
+00004490: 2020 2020 2049 6620 7374 7269 6e67 2069       If string i
+000044a0: 7320 7061 7373 6564 2c20 7769 6c6c 2075  s passed, will u
+000044b0: 7365 2074 6865 2064 6174 6120 636f 6c75  se the data colu
+000044c0: 6d6e 2077 6974 6820 7468 6174 206e 616d  mn with that nam
+000044d0: 6520 6173 2074 6865 2067 726f 7570 732e  e as the groups.
+000044e0: 0a20 2020 2020 2020 2020 2020 204f 6e6c  .            Onl
+000044f0: 7920 7573 6564 2069 6620 6120 6772 6f75  y used if a grou
+00004500: 7020 6261 7365 6420 6372 6f73 732d 7661  p based cross-va
+00004510: 6c69 6461 7469 6f6e 2067 656e 6572 6174  lidation generat
+00004520: 6f72 2069 7320 7573 6564 2028 6567 2e20  or is used (eg. 
+00004530: 4772 6f75 704b 466f 6c64 292e 0a20 2020  GroupKFold)..   
+00004540: 2020 2020 2020 2020 2049 6620 4e6f 6e65           If None
+00004550: 2c20 7769 6c6c 2075 7365 2074 6865 2076  , will use the v
+00004560: 616c 7565 2073 6574 2069 6e20 666f 6c64  alue set in fold
+00004570: 5f67 726f 7570 7320 7061 7261 6d65 7465  _groups paramete
+00004580: 7220 696e 2073 6574 7570 2829 2e0a 0a20  r in setup()... 
+00004590: 2020 2020 2020 2076 6572 626f 7365 3a20         verbose: 
+000045a0: 626f 6f6c 2c20 6465 6661 756c 7420 3d20  bool, default = 
+000045b0: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+000045c0: 2053 636f 7265 2067 7269 6420 6973 206e   Score grid is n
+000045d0: 6f74 2070 7269 6e74 6564 2077 6865 6e20  ot printed when 
+000045e0: 7665 7262 6f73 6520 6973 2073 6574 2074  verbose is set t
+000045f0: 6f20 4661 6c73 652e 0a0a 0a20 2020 2020  o False....     
+00004600: 2020 2070 6172 616c 6c65 6c3a 2070 7963     parallel: pyc
+00004610: 6172 6574 2e69 6e74 6572 6e61 6c2e 7061  aret.internal.pa
+00004620: 7261 6c6c 656c 2e70 6172 616c 6c65 6c5f  rallel.parallel_
+00004630: 6261 636b 656e 642e 5061 7261 6c6c 656c  backend.Parallel
+00004640: 4261 636b 656e 642c 2064 6566 6175 6c74  Backend, default
+00004650: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+00004660: 2020 2020 4120 5061 7261 6c6c 656c 4261      A ParallelBa
+00004670: 636b 656e 6420 696e 7374 616e 6365 2e20  ckend instance. 
+00004680: 466f 7220 6578 616d 706c 6520 6966 2079  For example if y
+00004690: 6f75 2068 6176 6520 6120 5370 6172 6b53  ou have a SparkS
+000046a0: 6573 7369 6f6e 2060 6073 6573 7369 6f6e  ession ``session
+000046b0: 6060 2c0a 2020 2020 2020 2020 2020 2020  ``,.            
+000046c0: 796f 7520 6361 6e20 7573 6520 6060 4675  you can use ``Fu
+000046d0: 6775 6542 6163 6b65 6e64 2873 6573 7369  gueBackend(sessi
+000046e0: 6f6e 2960 6020 746f 206d 616b 6520 7468  on)`` to make th
+000046f0: 6973 2066 756e 6374 696f 6e20 7275 6e6e  is function runn
+00004700: 696e 6720 7573 696e 670a 2020 2020 2020  ing using.      
+00004710: 2020 2020 2020 5370 6172 6b2e 2046 6f72        Spark. For
+00004720: 206d 6f72 6520 6465 7461 696c 732c 2073   more details, s
+00004730: 6565 0a20 2020 2020 2020 2020 2020 203a  ee.            :
+00004740: 636c 6173 733a 607e 7079 6361 7265 742e  class:`~pycaret.
+00004750: 7061 7261 6c6c 656c 2e66 7567 7565 5f62  parallel.fugue_b
+00004760: 6163 6b65 6e64 2e46 7567 7565 4261 636b  ackend.FugueBack
+00004770: 656e 6460 0a0a 0a20 2020 2020 2020 2063  end`...        c
+00004780: 616c 6c65 725f 7061 7261 6d73 3a20 6469  aller_params: di
+00004790: 6374 2c20 6465 6661 756c 7420 3d20 4e6f  ct, default = No
+000047a0: 6e65 0a20 2020 2020 2020 2020 2020 2054  ne.            T
+000047b0: 6865 2070 6172 616d 6574 6572 7320 7573  he parameters us
+000047c0: 6564 2074 6f20 6361 6c6c 2074 6869 7320  ed to call this 
+000047d0: 6675 6e63 7469 6f6e 2069 6e20 7468 6520  function in the 
+000047e0: 7375 6263 6c61 7373 2e20 5468 6572 6520  subclass. There 
+000047f0: 6172 6520 696e 636f 6e73 6973 7465 6e63  are inconsistenc
+00004800: 6965 730a 2020 2020 2020 2020 2020 2020  ies.            
+00004810: 696e 2074 6869 7320 6675 6e63 7469 6f6e  in this function
+00004820: 2773 2073 6967 6e61 7475 7265 2062 6574  's signature bet
+00004830: 7765 656e 2074 6869 7320 6261 7365 2063  ween this base c
+00004840: 6c61 7373 2061 6e64 2074 6865 2073 7562  lass and the sub
+00004850: 636c 6173 7365 732c 2073 6f20 7468 6973  classes, so this
+00004860: 2069 730a 2020 2020 2020 2020 2020 2020   is.            
+00004870: 7573 6564 2074 6f20 7072 6576 656e 7420  used to prevent 
+00004880: 696e 636f 6e73 6973 7465 6e63 6965 732e  inconsistencies.
+00004890: 2049 7420 6d75 7374 2062 6520 7365 7420   It must be set 
+000048a0: 7768 656e 2060 6070 6172 616c 6c65 6c60  when ``parallel`
+000048b0: 6020 6973 206e 6f74 204e 6f6e 650a 0a0a  ` is not None...
+000048c0: 2020 2020 2020 2020 6578 7472 615f 7061          extra_pa
+000048d0: 7261 6d73 3a20 416e 790a 2020 2020 2020  rams: Any.      
+000048e0: 2020 2020 2020 4578 7472 6120 7061 7261        Extra para
+000048f0: 6d65 7465 7273 2075 7365 6420 746f 2063  meters used to c
+00004900: 616c 6c20 7468 6520 7361 6d65 206d 6574  all the same met
+00004910: 686f 6420 696e 2074 6865 2064 6572 6976  hod in the deriv
+00004920: 6564 2063 6c61 7373 2e20 5468 6573 6520  ed class. These 
+00004930: 7061 7261 6d65 7465 7273 0a20 2020 2020  parameters.     
+00004940: 2020 2020 2020 2061 7265 206d 6169 6e6c         are mainl
+00004950: 7920 7573 6564 2077 6865 6e20 6060 7061  y used when ``pa
+00004960: 7261 6c6c 656c 6060 2069 7320 6e6f 7420  rallel`` is not 
+00004970: 4e6f 6e65 2e0a 0a0a 2020 2020 2020 2020  None....        
+00004980: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+00004990: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000049a0: 7363 6f72 655f 6772 6964 0a20 2020 2020  score_grid.     
+000049b0: 2020 2020 2020 2041 2074 6162 6c65 2063         A table c
+000049c0: 6f6e 7461 696e 696e 6720 7468 6520 7363  ontaining the sc
+000049d0: 6f72 6573 206f 6620 7468 6520 6d6f 6465  ores of the mode
+000049e0: 6c20 6163 726f 7373 2074 6865 206b 666f  l across the kfo
+000049f0: 6c64 732e 0a20 2020 2020 2020 2020 2020  lds..           
+00004a00: 2053 636f 7269 6e67 206d 6574 7269 6373   Scoring metrics
+00004a10: 2075 7365 6420 6172 6520 4163 6375 7261   used are Accura
+00004a20: 6379 2c20 4155 432c 2052 6563 616c 6c2c  cy, AUC, Recall,
+00004a30: 2050 7265 6369 7369 6f6e 2c20 4631 2c0a   Precision, F1,.
+00004a40: 2020 2020 2020 2020 2020 2020 4b61 7070              Kapp
+00004a50: 6120 616e 6420 4d43 432e 204d 6561 6e20  a and MCC. Mean 
+00004a60: 616e 6420 7374 616e 6461 7264 2064 6576  and standard dev
+00004a70: 6961 7469 6f6e 206f 6620 7468 6520 7363  iation of the sc
+00004a80: 6f72 6573 2061 6372 6f73 730a 2020 2020  ores across.    
+00004a90: 2020 2020 2020 2020 7468 6520 666f 6c64          the fold
+00004aa0: 7320 6172 6520 616c 736f 2072 6574 7572  s are also retur
+00004ab0: 6e65 642e 0a0a 2020 2020 2020 2020 6c69  ned...        li
+00004ac0: 7374 0a20 2020 2020 2020 2020 2020 204c  st.            L
+00004ad0: 6973 7420 6f66 2066 6974 7465 6420 6d6f  ist of fitted mo
+00004ae0: 6465 6c20 6f62 6a65 6374 7320 7468 6174  del objects that
+00004af0: 2077 6572 6520 636f 6d70 6172 6564 2e0a   were compared..
+00004b00: 0a20 2020 2020 2020 2057 6172 6e69 6e67  .        Warning
+00004b10: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00004b20: 2d2d 0a20 2020 2020 2020 202d 2063 6f6d  --.        - com
+00004b30: 7061 7265 5f6d 6f64 656c 7328 2920 7468  pare_models() th
+00004b40: 6f75 6768 2061 7474 7261 6374 6976 652c  ough attractive,
+00004b50: 206d 6967 6874 2062 6520 7469 6d65 2063   might be time c
+00004b60: 6f6e 7375 6d69 6e67 2077 6974 6820 6c61  onsuming with la
+00004b70: 7267 650a 2020 2020 2020 2020 6461 7461  rge.        data
+00004b80: 7365 7473 2e20 4279 2064 6566 6175 6c74  sets. By default
+00004b90: 2074 7572 626f 2069 7320 7365 7420 746f   turbo is set to
+00004ba0: 2054 7275 652c 2077 6869 6368 2065 7863   True, which exc
+00004bb0: 6c75 6465 7320 6d6f 6465 6c73 2074 6861  ludes models tha
+00004bc0: 740a 2020 2020 2020 2020 6861 7665 206c  t.        have l
+00004bd0: 6f6e 6765 7220 7472 6169 6e69 6e67 2074  onger training t
+00004be0: 696d 6573 2e20 4368 616e 6769 6e67 2074  imes. Changing t
+00004bf0: 7572 626f 2070 6172 616d 6574 6572 2074  urbo parameter t
+00004c00: 6f20 4661 6c73 6520 6d61 7920 7265 7375  o False may resu
+00004c10: 6c74 0a20 2020 2020 2020 2069 6e20 7665  lt.        in ve
+00004c20: 7279 2068 6967 6820 7472 6169 6e69 6e67  ry high training
+00004c30: 2074 696d 6573 2077 6974 6820 6461 7461   times with data
+00004c40: 7365 7473 2077 6865 7265 206e 756d 6265  sets where numbe
+00004c50: 7220 6f66 2073 616d 706c 6573 2065 7863  r of samples exc
+00004c60: 6565 640a 2020 2020 2020 2020 3130 2c30  eed.        10,0
+00004c70: 3030 2e0a 0a20 2020 2020 2020 202d 2049  00...        - I
+00004c80: 6620 7461 7267 6574 2076 6172 6961 626c  f target variabl
+00004c90: 6520 6973 206d 756c 7469 636c 6173 7320  e is multiclass 
+00004ca0: 286d 6f72 6520 7468 616e 2032 2063 6c61  (more than 2 cla
+00004cb0: 7373 6573 292c 2041 5543 2077 696c 6c20  sses), AUC will 
+00004cc0: 6265 0a20 2020 2020 2020 2072 6574 7572  be.        retur
+00004cd0: 6e65 6420 6173 207a 6572 6f20 2830 2e30  ned as zero (0.0
+00004ce0: 290a 0a20 2020 2020 2020 202d 2049 6620  )..        - If 
+00004cf0: 6372 6f73 735f 7661 6c69 6461 7469 6f6e  cross_validation
+00004d00: 2070 6172 616d 6574 6572 2069 7320 7365   parameter is se
+00004d10: 7420 746f 2046 616c 7365 2c20 6e6f 206d  t to False, no m
+00004d20: 6f64 656c 7320 7769 6c6c 2062 6520 6c6f  odels will be lo
+00004d30: 6767 6564 2077 6974 6820 4d4c 466c 6f77  gged with MLFlow
+00004d40: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
+00004d50: 2020 2020 2020 2073 656c 662e 5f63 6865         self._che
+00004d60: 636b 5f73 6574 7570 5f72 616e 2829 0a0a  ck_setup_ran()..
+00004d70: 2020 2020 2020 2020 6966 2070 6172 616c          if paral
+00004d80: 6c65 6c20 6973 206e 6f74 204e 6f6e 653a  lel is not None:
+00004d90: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00004da0: 7572 6e20 7365 6c66 2e5f 7061 7261 6c6c  urn self._parall
+00004db0: 656c 5f63 6f6d 7061 7265 5f6d 6f64 656c  el_compare_model
+00004dc0: 7328 7061 7261 6c6c 656c 2c20 6361 6c6c  s(parallel, call
+00004dd0: 6572 5f70 6172 616d 732c 2074 7572 626f  er_params, turbo
+00004de0: 3d74 7572 626f 290a 0a20 2020 2020 2020  =turbo)..       
+00004df0: 2023 204e 6f20 6578 7472 6120 636f 6465   # No extra code
+00004e00: 2073 686f 756c 6420 6265 2061 6464 6564   should be added
+00004e10: 2061 626f 7665 2074 6869 7320 6c69 6e65   above this line
+00004e20: 0a20 2020 2020 2020 2023 202d 2d2d 2d2d  .        # -----
 00004e30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00004e40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00004e50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004e60: 2d2d 2d2d 2d2d 2d2d 2d2d 0a0a 2020 2020  ----------..    
-00004e70: 2020 2020 6675 6e63 7469 6f6e 5f70 6172      function_par
-00004e80: 616d 735f 7374 7220 3d20 222c 2022 2e6a  ams_str = ", ".j
-00004e90: 6f69 6e28 5b66 227b 6b7d 3d7b 767d 2220  oin([f"{k}={v}" 
-00004ea0: 666f 7220 6b2c 2076 2069 6e20 6c6f 6361  for k, v in loca
-00004eb0: 6c73 2829 2e69 7465 6d73 2829 5d29 0a0a  ls().items()])..
-00004ec0: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-00004ed0: 6765 722e 696e 666f 2822 496e 6974 6961  ger.info("Initia
-00004ee0: 6c69 7a69 6e67 2063 6f6d 7061 7265 5f6d  lizing compare_m
-00004ef0: 6f64 656c 7328 2922 290a 2020 2020 2020  odels()").      
-00004f00: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
-00004f10: 666f 2866 2263 6f6d 7061 7265 5f6d 6f64  fo(f"compare_mod
-00004f20: 656c 7328 7b66 756e 6374 696f 6e5f 7061  els({function_pa
-00004f30: 7261 6d73 5f73 7472 7d29 2229 0a0a 2020  rams_str})")..  
-00004f40: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
-00004f50: 722e 696e 666f 2822 4368 6563 6b69 6e67  r.info("Checking
-00004f60: 2065 7863 6570 7469 6f6e 7322 290a 0a20   exceptions").. 
-00004f70: 2020 2020 2020 2069 6620 6e6f 7420 6669         if not fi
-00004f80: 745f 6b77 6172 6773 3a0a 2020 2020 2020  t_kwargs:.      
-00004f90: 2020 2020 2020 6669 745f 6b77 6172 6773        fit_kwargs
-00004fa0: 203d 207b 7d0a 0a20 2020 2020 2020 2023   = {}..        #
-00004fb0: 2063 6865 636b 696e 6720 6572 726f 7220   checking error 
-00004fc0: 666f 7220 6578 636c 7564 6520 2873 7472  for exclude (str
-00004fd0: 696e 6729 0a20 2020 2020 2020 2061 7661  ing).        ava
-00004fe0: 696c 6162 6c65 5f65 7374 696d 6174 6f72  ilable_estimator
-00004ff0: 7320 3d20 7365 6c66 2e5f 616c 6c5f 6d6f  s = self._all_mo
-00005000: 6465 6c73 0a0a 2020 2020 2020 2020 6966  dels..        if
-00005010: 2069 6e63 6c75 6465 2069 7320 6e6f 7420   include is not 
-00005020: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00005030: 2020 666f 7220 6920 696e 2069 6e63 6c75    for i in inclu
-00005040: 6465 3a0a 2020 2020 2020 2020 2020 2020  de:.            
-00005050: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00005060: 6528 692c 2073 7472 293a 0a20 2020 2020  e(i, str):.     
-00005070: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00005080: 6620 6920 6e6f 7420 696e 2061 7661 696c  f i not in avail
-00005090: 6162 6c65 5f65 7374 696d 6174 6f72 733a  able_estimators:
-000050a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000050b0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-000050c0: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+00004e60: 2d2d 2d2d 2d2d 2d2d 2d0a 0a20 2020 2020  ---------..     
+00004e70: 2020 2066 756e 6374 696f 6e5f 7061 7261     function_para
+00004e80: 6d73 5f73 7472 203d 2022 2c20 222e 6a6f  ms_str = ", ".jo
+00004e90: 696e 285b 6622 7b6b 7d3d 7b76 7d22 2066  in([f"{k}={v}" f
+00004ea0: 6f72 206b 2c20 7620 696e 206c 6f63 616c  or k, v in local
+00004eb0: 7328 292e 6974 656d 7328 295d 290a 0a20  s().items()]).. 
+00004ec0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+00004ed0: 6572 2e69 6e66 6f28 2249 6e69 7469 616c  er.info("Initial
+00004ee0: 697a 696e 6720 636f 6d70 6172 655f 6d6f  izing compare_mo
+00004ef0: 6465 6c73 2829 2229 0a20 2020 2020 2020  dels()").       
+00004f00: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
+00004f10: 6f28 6622 636f 6d70 6172 655f 6d6f 6465  o(f"compare_mode
+00004f20: 6c73 287b 6675 6e63 7469 6f6e 5f70 6172  ls({function_par
+00004f30: 616d 735f 7374 727d 2922 290a 0a20 2020  ams_str})")..   
+00004f40: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
+00004f50: 2e69 6e66 6f28 2243 6865 636b 696e 6720  .info("Checking 
+00004f60: 6578 6365 7074 696f 6e73 2229 0a0a 2020  exceptions")..  
+00004f70: 2020 2020 2020 6966 206e 6f74 2066 6974        if not fit
+00004f80: 5f6b 7761 7267 733a 0a20 2020 2020 2020  _kwargs:.       
+00004f90: 2020 2020 2066 6974 5f6b 7761 7267 7320       fit_kwargs 
+00004fa0: 3d20 7b7d 0a0a 2020 2020 2020 2020 2320  = {}..        # 
+00004fb0: 6368 6563 6b69 6e67 2065 7272 6f72 2066  checking error f
+00004fc0: 6f72 2065 7863 6c75 6465 2028 7374 7269  or exclude (stri
+00004fd0: 6e67 290a 2020 2020 2020 2020 6176 6169  ng).        avai
+00004fe0: 6c61 626c 655f 6573 7469 6d61 746f 7273  lable_estimators
+00004ff0: 203d 2073 656c 662e 5f61 6c6c 5f6d 6f64   = self._all_mod
+00005000: 656c 730a 0a20 2020 2020 2020 2069 6620  els..        if 
+00005010: 696e 636c 7564 6520 6973 206e 6f74 204e  include is not N
+00005020: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00005030: 2066 6f72 2069 2069 6e20 696e 636c 7564   for i in includ
+00005040: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00005050: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00005060: 2869 2c20 7374 7229 3a0a 2020 2020 2020  (i, str):.      
+00005070: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00005080: 2069 206e 6f74 2069 6e20 6176 6169 6c61   i not in availa
+00005090: 626c 655f 6573 7469 6d61 746f 7273 3a0a  ble_estimators:.
+000050a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000050b0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+000050c0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
 000050d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000050e0: 2020 2020 2020 2066 2245 7374 696d 6174         f"Estimat
-000050f0: 6f72 207b 697d 204e 6f74 2041 7661 696c  or {i} Not Avail
-00005100: 6162 6c65 2e20 506c 6561 7365 2073 6565  able. Please see
-00005110: 2064 6f63 7374 7269 6e67 2066 6f72 206c   docstring for l
-00005120: 6973 7420 6f66 2061 7661 696c 6162 6c65  ist of available
-00005130: 2065 7374 696d 6174 6f72 732e 220a 2020   estimators.".  
+000050e0: 2020 2020 2020 6622 4573 7469 6d61 746f        f"Estimato
+000050f0: 7220 7b69 7d20 4e6f 7420 4176 6169 6c61  r {i} Not Availa
+00005100: 626c 652e 2050 6c65 6173 6520 7365 6520  ble. Please see 
+00005110: 646f 6373 7472 696e 6720 666f 7220 6c69  docstring for li
+00005120: 7374 206f 6620 6176 6169 6c61 626c 6520  st of available 
+00005130: 6573 7469 6d61 746f 7273 2e22 0a20 2020  estimators.".   
 00005140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005150: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00005160: 2020 2020 2020 2020 656c 6966 206e 6f74          elif not
-00005170: 2068 6173 6174 7472 2869 2c20 2266 6974   hasattr(i, "fit
-00005180: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
-00005190: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-000051a0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+00005150: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00005160: 2020 2020 2020 2065 6c69 6620 6e6f 7420         elif not 
+00005170: 6861 7361 7474 7228 692c 2022 6669 7422  hasattr(i, "fit"
+00005180: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00005190: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+000051a0: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
 000051b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000051c0: 2020 6622 4573 7469 6d61 746f 7220 7b69    f"Estimator {i
-000051d0: 7d20 646f 6573 206e 6f74 2068 6176 6520  } does not have 
-000051e0: 7468 6520 7265 7175 6972 6564 2066 6974  the required fit
-000051f0: 2829 206d 6574 686f 642e 220a 2020 2020  () method.".    
-00005200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005210: 290a 0a20 2020 2020 2020 2023 2069 6e63  )..        # inc
-00005220: 6c75 6465 2061 6e64 2065 7863 6c75 6465  lude and exclude
-00005230: 2074 6f67 6574 6865 7220 6368 6563 6b0a   together check.
-00005240: 2020 2020 2020 2020 6966 2069 6e63 6c75          if inclu
-00005250: 6465 2069 7320 6e6f 7420 4e6f 6e65 2061  de is not None a
-00005260: 6e64 2065 7863 6c75 6465 2069 7320 6e6f  nd exclude is no
-00005270: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00005280: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-00005290: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-000052a0: 2020 2020 2022 4361 6e6e 6f74 2075 7365       "Cannot use
-000052b0: 2065 7863 6c75 6465 2070 6172 616d 6574   exclude paramet
-000052c0: 6572 2077 6865 6e20 696e 636c 7564 6520  er when include 
-000052d0: 6973 2075 7365 6420 746f 2063 6f6d 7061  is used to compa
-000052e0: 7265 206d 6f64 656c 732e 220a 2020 2020  re models.".    
-000052f0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00005300: 2020 2023 2063 6865 636b 696e 6720 666f     # checking fo
-00005310: 6c64 2070 6172 616d 6574 6572 0a20 2020  ld parameter.   
-00005320: 2020 2020 2069 6620 666f 6c64 2069 7320       if fold is 
-00005330: 6e6f 7420 4e6f 6e65 2061 6e64 206e 6f74  not None and not
-00005340: 2028 0a20 2020 2020 2020 2020 2020 2074   (.            t
-00005350: 7970 6528 666f 6c64 2920 6973 2069 6e74  ype(fold) is int
-00005360: 206f 7220 6973 5f73 6b6c 6561 726e 5f63   or is_sklearn_c
-00005370: 765f 6765 6e65 7261 746f 7228 666f 6c64  v_generator(fold
-00005380: 290a 2020 2020 2020 2020 293a 0a20 2020  ).        ):.   
-00005390: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-000053a0: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
-000053b0: 2020 2020 2020 2020 2020 2266 6f6c 6420            "fold 
-000053c0: 7061 7261 6d65 7465 7220 6d75 7374 2062  parameter must b
-000053d0: 6520 6569 7468 6572 204e 6f6e 652c 2061  e either None, a
-000053e0: 6e20 696e 7465 6765 7220 6f72 2061 2073  n integer or a s
-000053f0: 6369 6b69 742d 6c65 6172 6e20 636f 6d70  cikit-learn comp
-00005400: 6174 6962 6c65 2043 5620 6765 6e65 7261  atible CV genera
-00005410: 746f 7220 6f62 6a65 6374 2e22 0a20 2020  tor object.".   
-00005420: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00005430: 2020 2020 2320 6368 6563 6b69 6e67 2072      # checking r
-00005440: 6f75 6e64 2070 6172 616d 6574 6572 0a20  ound parameter. 
-00005450: 2020 2020 2020 2069 6620 7479 7065 2872         if type(r
-00005460: 6f75 6e64 2920 6973 206e 6f74 2069 6e74  ound) is not int
-00005470: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00005480: 6973 6520 5479 7065 4572 726f 7228 2252  ise TypeError("R
-00005490: 6f75 6e64 2070 6172 616d 6574 6572 206f  ound parameter o
-000054a0: 6e6c 7920 6163 6365 7074 7320 696e 7465  nly accepts inte
-000054b0: 6765 7220 7661 6c75 652e 2229 0a0a 2020  ger value.")..  
-000054c0: 2020 2020 2020 2320 6368 6563 6b69 6e67        # checking
-000054d0: 2062 7564 6765 745f 7469 6d65 2070 6172   budget_time par
-000054e0: 616d 6574 6572 0a20 2020 2020 2020 2069  ameter.        i
-000054f0: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
-00005500: 6275 6467 6574 5f74 696d 650a 2020 2020  budget_time.    
-00005510: 2020 2020 2020 2020 616e 6420 7479 7065          and type
-00005520: 2862 7564 6765 745f 7469 6d65 2920 6973  (budget_time) is
-00005530: 206e 6f74 2069 6e74 0a20 2020 2020 2020   not int.       
-00005540: 2020 2020 2061 6e64 2074 7970 6528 6275       and type(bu
-00005550: 6467 6574 5f74 696d 6529 2069 7320 6e6f  dget_time) is no
-00005560: 7420 666c 6f61 740a 2020 2020 2020 2020  t float.        
-00005570: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00005580: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
-00005590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000055a0: 2262 7564 6765 745f 7469 6d65 2070 6172  "budget_time par
-000055b0: 616d 6574 6572 206f 6e6c 7920 6163 6365  ameter only acce
-000055c0: 7074 7320 696e 7465 6765 7220 6f72 2066  pts integer or f
-000055d0: 6c6f 6174 2076 616c 7565 732e 220a 2020  loat values.".  
-000055e0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-000055f0: 2020 2020 2023 2063 6865 636b 696e 6720       # checking 
-00005600: 736f 7274 2070 6172 616d 6574 6572 0a20  sort parameter. 
-00005610: 2020 2020 2020 2069 6620 6e6f 7420 2869         if not (i
-00005620: 7369 6e73 7461 6e63 6528 736f 7274 2c20  sinstance(sort, 
-00005630: 7374 7229 2061 6e64 2028 736f 7274 203d  str) and (sort =
-00005640: 3d20 2254 5422 206f 7220 736f 7274 203d  = "TT" or sort =
-00005650: 3d20 2254 5420 2853 6563 2922 2929 3a0a  = "TT (Sec)")):.
-00005660: 2020 2020 2020 2020 2020 2020 736f 7274              sort
-00005670: 203d 2073 656c 662e 5f67 6574 5f6d 6574   = self._get_met
-00005680: 7269 635f 6279 5f6e 616d 655f 6f72 5f69  ric_by_name_or_i
-00005690: 6428 736f 7274 290a 2020 2020 2020 2020  d(sort).        
-000056a0: 2020 2020 6966 2073 6f72 7420 6973 204e      if sort is N
-000056b0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-000056c0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-000056d0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-000056e0: 2020 2020 2020 2020 2020 2022 536f 7274             "Sort
-000056f0: 206d 6574 686f 6420 6e6f 7420 7375 7070   method not supp
-00005700: 6f72 7465 642e 2053 6565 2064 6f63 7374  orted. See docst
-00005710: 7269 6e67 2066 6f72 206c 6973 7420 6f66  ring for list of
-00005720: 2061 7661 696c 6162 6c65 2070 6172 616d   available param
-00005730: 6574 6572 732e 220a 2020 2020 2020 2020  eters.".        
-00005740: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00005750: 2020 2023 2063 6865 636b 696e 6720 6572     # checking er
-00005760: 726f 7273 2070 6172 616d 6574 6572 0a20  rors parameter. 
-00005770: 2020 2020 2020 2070 6f73 7369 626c 655f         possible_
-00005780: 6572 726f 7273 203d 205b 2269 676e 6f72  errors = ["ignor
-00005790: 6522 2c20 2272 6169 7365 225d 0a20 2020  e", "raise"].   
-000057a0: 2020 2020 2069 6620 6572 726f 7273 206e       if errors n
-000057b0: 6f74 2069 6e20 706f 7373 6962 6c65 5f65  ot in possible_e
-000057c0: 7272 6f72 733a 0a20 2020 2020 2020 2020  rrors:.         
-000057d0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000057e0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-000057f0: 2020 2020 2066 2265 7272 6f72 7320 7061       f"errors pa
-00005800: 7261 6d65 7465 7220 6d75 7374 2062 6520  rameter must be 
-00005810: 6f6e 6520 6f66 3a20 7b27 2c20 272e 6a6f  one of: {', '.jo
-00005820: 696e 2870 6f73 7369 626c 655f 6572 726f  in(possible_erro
-00005830: 7273 297d 2e22 0a20 2020 2020 2020 2020  rs)}.".         
-00005840: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
-00005850: 6368 6563 6b69 6e67 206f 7074 696d 697a  checking optimiz
-00005860: 6520 7061 7261 6d65 7465 7220 666f 7220  e parameter for 
-00005870: 6d75 6c74 6963 6c61 7373 0a20 2020 2020  multiclass.     
-00005880: 2020 2069 6620 7365 6c66 2e69 735f 6d75     if self.is_mu
-00005890: 6c74 6963 6c61 7373 3a0a 2020 2020 2020  lticlass:.      
-000058a0: 2020 2020 2020 6966 206e 6f74 2073 6f72        if not sor
-000058b0: 742e 6973 5f6d 756c 7469 636c 6173 733a  t.is_multiclass:
-000058c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000058d0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-000058e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000058f0: 2020 2020 2020 6622 7b73 6f72 747d 206d        f"{sort} m
-00005900: 6574 7269 6320 6e6f 7420 7375 7070 6f72  etric not suppor
-00005910: 7465 6420 666f 7220 6d75 6c74 6963 6c61  ted for multicla
-00005920: 7373 2070 726f 626c 656d 732e 2053 6565  ss problems. See
-00005930: 2064 6f63 7374 7269 6e67 2066 6f72 206c   docstring for l
-00005940: 6973 7420 6f66 206f 7468 6572 206f 7074  ist of other opt
-00005950: 696d 697a 6174 696f 6e20 7061 7261 6d65  imization parame
-00005960: 7465 7273 2e22 0a20 2020 2020 2020 2020  ters.".         
-00005970: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00005980: 2020 2222 220a 0a20 2020 2020 2020 2045    """..        E
-00005990: 5252 4f52 2048 414e 444c 494e 4720 454e  RROR HANDLING EN
-000059a0: 4453 2048 4552 450a 0a20 2020 2020 2020  DS HERE..       
-000059b0: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
-000059c0: 2073 656c 662e 5f6d 6c5f 7573 6563 6173   self._ml_usecas
-000059d0: 6520 213d 204d 4c55 7365 6361 7365 2e54  e != MLUsecase.T
-000059e0: 494d 455f 5345 5249 4553 3a0a 2020 2020  IME_SERIES:.    
-000059f0: 2020 2020 2020 2020 666f 6c64 203d 2073          fold = s
-00005a00: 656c 662e 5f67 6574 5f63 765f 7370 6c69  elf._get_cv_spli
-00005a10: 7474 6572 2866 6f6c 6429 0a0a 2020 2020  tter(fold)..    
-00005a20: 2020 2020 6772 6f75 7073 203d 2073 656c      groups = sel
-00005a30: 662e 5f67 6574 5f67 726f 7570 7328 6772  f._get_groups(gr
-00005a40: 6f75 7073 290a 0a20 2020 2020 2020 2070  oups)..        p
-00005a50: 642e 7365 745f 6f70 7469 6f6e 2822 6469  d.set_option("di
-00005a60: 7370 6c61 792e 6d61 785f 636f 6c75 6d6e  splay.max_column
-00005a70: 7322 2c20 3530 3029 0a0a 2020 2020 2020  s", 500)..      
-00005a80: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
-00005a90: 666f 2822 5072 6570 6172 696e 6720 6469  fo("Preparing di
-00005aa0: 7370 6c61 7920 6d6f 6e69 746f 7222 290a  splay monitor").
-00005ab0: 0a20 2020 2020 2020 206c 656e 5f6d 6f64  .        len_mod
-00005ac0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-00005ad0: 206c 656e 287b 6b3a 2076 2066 6f72 206b   len({k: v for k
-00005ae0: 2c20 7620 696e 2073 656c 662e 5f61 6c6c  , v in self._all
-00005af0: 5f6d 6f64 656c 732e 6974 656d 7328 2920  _models.items() 
-00005b00: 6966 2076 2e69 735f 7475 7262 6f7d 290a  if v.is_turbo}).
-00005b10: 2020 2020 2020 2020 2020 2020 6966 2074              if t
-00005b20: 7572 626f 0a20 2020 2020 2020 2020 2020  urbo.           
-00005b30: 2065 6c73 6520 6c65 6e28 7365 6c66 2e5f   else len(self._
-00005b40: 616c 6c5f 6d6f 6465 6c73 290a 2020 2020  all_models).    
-00005b50: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
-00005b60: 6620 696e 636c 7564 653a 0a20 2020 2020  f include:.     
-00005b70: 2020 2020 2020 206c 656e 5f6d 6f64 203d         len_mod =
-00005b80: 206c 656e 2869 6e63 6c75 6465 290a 2020   len(include).  
-00005b90: 2020 2020 2020 656c 6966 2065 7863 6c75        elif exclu
-00005ba0: 6465 3a0a 2020 2020 2020 2020 2020 2020  de:.            
-00005bb0: 6c65 6e5f 6d6f 6420 2d3d 206c 656e 2865  len_mod -= len(e
-00005bc0: 7863 6c75 6465 290a 0a20 2020 2020 2020  xclude)..       
-00005bd0: 2070 726f 6772 6573 735f 6172 6773 203d   progress_args =
-00005be0: 207b 226d 6178 223a 2028 3420 2a20 6c65   {"max": (4 * le
-00005bf0: 6e5f 6d6f 6429 202b 2034 202b 206d 696e  n_mod) + 4 + min
-00005c00: 286c 656e 5f6d 6f64 2c20 6162 7328 6e5f  (len_mod, abs(n_
-00005c10: 7365 6c65 6374 2929 7d0a 2020 2020 2020  select))}.      
-00005c20: 2020 6d61 7374 6572 5f64 6973 706c 6179    master_display
-00005c30: 5f63 6f6c 756d 6e73 203d 2028 0a20 2020  _columns = (.   
-00005c40: 2020 2020 2020 2020 205b 224d 6f64 656c           ["Model
-00005c50: 225d 0a20 2020 2020 2020 2020 2020 202b  "].            +
-00005c60: 205b 762e 6469 7370 6c61 795f 6e61 6d65   [v.display_name
-00005c70: 2066 6f72 206b 2c20 7620 696e 2073 656c   for k, v in sel
-00005c80: 662e 5f61 6c6c 5f6d 6574 7269 6373 2e69  f._all_metrics.i
-00005c90: 7465 6d73 2829 5d0a 2020 2020 2020 2020  tems()].        
-00005ca0: 2020 2020 2b20 5b22 5454 2028 5365 6329      + ["TT (Sec)
-00005cb0: 225d 0a20 2020 2020 2020 2029 0a20 2020  "].        ).   
-00005cc0: 2020 2020 206d 6173 7465 725f 6469 7370       master_disp
-00005cd0: 6c61 7920 3d20 7064 2e44 6174 6146 7261  lay = pd.DataFra
-00005ce0: 6d65 2863 6f6c 756d 6e73 3d6d 6173 7465  me(columns=maste
-00005cf0: 725f 6469 7370 6c61 795f 636f 6c75 6d6e  r_display_column
-00005d00: 7329 0a20 2020 2020 2020 2074 696d 6573  s).        times
-00005d10: 7461 6d70 5374 7220 3d20 6461 7465 7469  tampStr = dateti
-00005d20: 6d65 2e64 6174 6574 696d 652e 6e6f 7728  me.datetime.now(
-00005d30: 292e 7374 7266 7469 6d65 2822 2548 3a25  ).strftime("%H:%
-00005d40: 4d3a 2553 2229 0a20 2020 2020 2020 206d  M:%S").        m
-00005d50: 6f6e 6974 6f72 5f72 6f77 7320 3d20 5b0a  onitor_rows = [.
-00005d60: 2020 2020 2020 2020 2020 2020 5b22 496e              ["In
-00005d70: 6974 6961 7465 6422 2c20 222e 202e 202e  itiated", ". . .
-00005d80: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
-00005d90: 202e 202e 202e 202e 202e 202e 202e 222c   . . . . . . .",
-00005da0: 2074 696d 6573 7461 6d70 5374 725d 2c0a   timestampStr],.
-00005db0: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-00005dc0: 2020 2020 2020 2020 2020 2020 2020 2253                "S
-00005dd0: 7461 7475 7322 2c0a 2020 2020 2020 2020  tatus",.        
-00005de0: 2020 2020 2020 2020 222e 202e 202e 202e          ". . . .
-00005df0: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
-00005e00: 202e 202e 202e 202e 202e 202e 222c 0a20   . . . . . .",. 
-00005e10: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00005e20: 4c6f 6164 696e 6720 4465 7065 6e64 656e  Loading Dependen
-00005e30: 6369 6573 222c 0a20 2020 2020 2020 2020  cies",.         
-00005e40: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
-00005e50: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-00005e60: 2020 2020 2245 7374 696d 6174 6f72 222c      "Estimator",
-00005e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005e80: 2022 2e20 2e20 2e20 2e20 2e20 2e20 2e20   ". . . . . . . 
-00005e90: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
-00005ea0: 2e20 2e20 2e22 2c0a 2020 2020 2020 2020  . . .",.        
-00005eb0: 2020 2020 2020 2020 2243 6f6d 7069 6c69          "Compili
-00005ec0: 6e67 204c 6962 7261 7279 222c 0a20 2020  ng Library",.   
-00005ed0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-00005ee0: 2020 2020 5d0a 2020 2020 2020 2020 6469      ].        di
-00005ef0: 7370 6c61 7920 3d20 280a 2020 2020 2020  splay = (.      
-00005f00: 2020 2020 2020 4475 6d6d 7944 6973 706c        DummyDispl
-00005f10: 6179 2829 0a20 2020 2020 2020 2020 2020  ay().           
-00005f20: 2069 6620 7365 6c66 2e5f 7265 6d6f 7465   if self._remote
-00005f30: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00005f40: 6520 436f 6d6d 6f6e 4469 7370 6c61 7928  e CommonDisplay(
-00005f50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005f60: 2076 6572 626f 7365 3d76 6572 626f 7365   verbose=verbose
-00005f70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00005f80: 2020 6874 6d6c 5f70 6172 616d 3d73 656c    html_param=sel
-00005f90: 662e 6874 6d6c 5f70 6172 616d 2c0a 2020  f.html_param,.  
-00005fa0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00005fb0: 6f67 7265 7373 5f61 7267 733d 7072 6f67  ogress_args=prog
-00005fc0: 7265 7373 5f61 7267 732c 0a20 2020 2020  ress_args,.     
-00005fd0: 2020 2020 2020 2020 2020 206d 6f6e 6974             monit
-00005fe0: 6f72 5f72 6f77 733d 6d6f 6e69 746f 725f  or_rows=monitor_
-00005ff0: 726f 7773 2c0a 2020 2020 2020 2020 2020  rows,.          
-00006000: 2020 290a 2020 2020 2020 2020 290a 2020    ).        ).  
-00006010: 2020 2020 2020 6966 2064 6973 706c 6179        if display
-00006020: 2e63 616e 5f75 7064 6174 655f 7465 7874  .can_update_text
-00006030: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
-00006040: 7370 6c61 792e 6469 7370 6c61 7928 6d61  splay.display(ma
-00006050: 7374 6572 5f64 6973 706c 6179 2c20 6669  ster_display, fi
-00006060: 6e61 6c5f 6469 7370 6c61 793d 4661 6c73  nal_display=Fals
-00006070: 6529 0a0a 2020 2020 2020 2020 696e 7075  e)..        inpu
-00006080: 745f 6d6c 5f75 7365 6361 7365 203d 2073  t_ml_usecase = s
-00006090: 656c 662e 5f6d 6c5f 7573 6563 6173 650a  elf._ml_usecase.
-000060a0: 2020 2020 2020 2020 7461 7267 6574 5f6d          target_m
-000060b0: 6c5f 7573 6563 6173 6520 3d20 4d4c 5573  l_usecase = MLUs
-000060c0: 6563 6173 652e 5449 4d45 5f53 4552 4945  ecase.TIME_SERIE
-000060d0: 530a 0a20 2020 2020 2020 206e 702e 7261  S..        np.ra
-000060e0: 6e64 6f6d 2e73 6565 6428 7365 6c66 2e73  ndom.seed(self.s
-000060f0: 6565 6429 0a0a 2020 2020 2020 2020 6469  eed)..        di
-00006100: 7370 6c61 792e 6d6f 7665 5f70 726f 6772  splay.move_progr
-00006110: 6573 7328 290a 0a20 2020 2020 2020 2023  ess()..        #
-00006120: 2064 6566 696e 696e 6720 736f 7274 2070   defining sort p
-00006130: 6172 616d 6574 6572 2028 6d61 6b69 6e67  arameter (making
-00006140: 2050 7265 6369 7369 6f6e 2065 7175 6976   Precision equiv
-00006150: 616c 656e 7420 746f 2050 7265 632e 2029  alent to Prec. )
-00006160: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-00006170: 2028 6973 696e 7374 616e 6365 2873 6f72   (isinstance(sor
-00006180: 742c 2073 7472 2920 616e 6420 2873 6f72  t, str) and (sor
-00006190: 7420 3d3d 2022 5454 2220 6f72 2073 6f72  t == "TT" or sor
-000061a0: 7420 3d3d 2022 5454 2028 5365 6329 2229  t == "TT (Sec)")
-000061b0: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-000061c0: 6f72 745f 6173 6365 6e64 696e 6720 3d20  ort_ascending = 
-000061d0: 6e6f 7420 736f 7274 2e67 7265 6174 6572  not sort.greater
-000061e0: 5f69 735f 6265 7474 6572 0a20 2020 2020  _is_better.     
-000061f0: 2020 2020 2020 2073 6f72 7420 3d20 6964         sort = id
-00006200: 5f6f 725f 6469 7370 6c61 795f 6e61 6d65  _or_display_name
-00006210: 2873 6f72 742c 2069 6e70 7574 5f6d 6c5f  (sort, input_ml_
-00006220: 7573 6563 6173 652c 2074 6172 6765 745f  usecase, target_
-00006230: 6d6c 5f75 7365 6361 7365 290a 2020 2020  ml_usecase).    
-00006240: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00006250: 2020 2020 2020 736f 7274 5f61 7363 656e        sort_ascen
-00006260: 6469 6e67 203d 2054 7275 650a 2020 2020  ding = True.    
-00006270: 2020 2020 2020 2020 736f 7274 203d 2022          sort = "
-00006280: 5454 2028 5365 6329 220a 0a20 2020 2020  TT (Sec)"..     
-00006290: 2020 2022 2222 0a20 2020 2020 2020 204d     """.        M
-000062a0: 4f4e 4954 4f52 2055 5044 4154 4520 5354  ONITOR UPDATE ST
-000062b0: 4152 5453 0a20 2020 2020 2020 2022 2222  ARTS.        """
-000062c0: 0a0a 2020 2020 2020 2020 6469 7370 6c61  ..        displa
-000062d0: 792e 7570 6461 7465 5f6d 6f6e 6974 6f72  y.update_monitor
-000062e0: 2831 2c20 224c 6f61 6469 6e67 2045 7374  (1, "Loading Est
-000062f0: 696d 6174 6f72 2229 0a0a 2020 2020 2020  imator")..      
-00006300: 2020 2222 220a 2020 2020 2020 2020 4d4f    """.        MO
-00006310: 4e49 544f 5220 5550 4441 5445 2045 4e44  NITOR UPDATE END
-00006320: 530a 2020 2020 2020 2020 2222 220a 0a20  S.        """.. 
-00006330: 2020 2020 2020 2069 6620 696e 636c 7564         if includ
-00006340: 653a 0a20 2020 2020 2020 2020 2020 206d  e:.            m
-00006350: 6f64 656c 5f6c 6962 7261 7279 203d 2069  odel_library = i
-00006360: 6e63 6c75 6465 0a20 2020 2020 2020 2065  nclude.        e
-00006370: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00006380: 2069 6620 7475 7262 6f3a 0a20 2020 2020   if turbo:.     
-00006390: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-000063a0: 5f6c 6962 7261 7279 203d 205b 6b20 666f  _library = [k fo
-000063b0: 7220 6b2c 2076 2069 6e20 7365 6c66 2e5f  r k, v in self._
-000063c0: 616c 6c5f 6d6f 6465 6c73 2e69 7465 6d73  all_models.items
-000063d0: 2829 2069 6620 762e 6973 5f74 7572 626f  () if v.is_turbo
-000063e0: 5d0a 2020 2020 2020 2020 2020 2020 656c  ].            el
-000063f0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00006400: 2020 2020 6d6f 6465 6c5f 6c69 6272 6172      model_librar
-00006410: 7920 3d20 6c69 7374 2873 656c 662e 5f61  y = list(self._a
-00006420: 6c6c 5f6d 6f64 656c 732e 6b65 7973 2829  ll_models.keys()
-00006430: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00006440: 2065 7863 6c75 6465 3a0a 2020 2020 2020   exclude:.      
-00006450: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-00006460: 6c69 6272 6172 7920 3d20 5b78 2066 6f72  library = [x for
-00006470: 2078 2069 6e20 6d6f 6465 6c5f 6c69 6272   x in model_libr
-00006480: 6172 7920 6966 2078 206e 6f74 2069 6e20  ary if x not in 
-00006490: 6578 636c 7564 655d 0a0a 2020 2020 2020  exclude]..      
-000064a0: 2020 6966 2073 656c 662e 5f6d 6c5f 7573    if self._ml_us
-000064b0: 6563 6173 6520 3d3d 204d 4c55 7365 6361  ecase == MLUseca
-000064c0: 7365 2e54 494d 455f 5345 5249 4553 3a0a  se.TIME_SERIES:.
-000064d0: 2020 2020 2020 2020 2020 2020 6966 2022              if "
-000064e0: 656e 7365 6d62 6c65 5f66 6f72 6563 6173  ensemble_forecas
-000064f0: 7465 7222 2069 6e20 6d6f 6465 6c5f 6c69  ter" in model_li
-00006500: 6272 6172 793a 0a20 2020 2020 2020 2020  brary:.         
-00006510: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-00006520: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
-00006530: 2020 2020 2020 2020 2020 2255 6e73 7570            "Unsup
-00006540: 706f 7274 6564 2065 7374 696d 6174 6f72  ported estimator
-00006550: 2060 656e 7365 6d62 6c65 5f66 6f72 6563   `ensemble_forec
-00006560: 6173 7465 7260 2066 6f72 206d 6574 686f  aster` for metho
-00006570: 6420 6063 6f6d 7061 7265 5f6d 6f64 656c  d `compare_model
-00006580: 7328 2960 2c20 7265 6d6f 7669 6e67 2066  s()`, removing f
-00006590: 726f 6d20 6d6f 6465 6c5f 6c69 6272 6172  rom model_librar
-000065a0: 7922 0a20 2020 2020 2020 2020 2020 2020  y".             
-000065b0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-000065c0: 2020 2020 206d 6f64 656c 5f6c 6962 7261       model_libra
-000065d0: 7279 2e72 656d 6f76 6528 2265 6e73 656d  ry.remove("ensem
-000065e0: 626c 655f 666f 7265 6361 7374 6572 2229  ble_forecaster")
-000065f0: 0a0a 2020 2020 2020 2020 6469 7370 6c61  ..        displa
-00006600: 792e 6d6f 7665 5f70 726f 6772 6573 7328  y.move_progress(
-00006610: 290a 0a20 2020 2020 2020 2023 2063 7265  )..        # cre
-00006620: 6174 6520 5552 4920 2862 6566 6f72 6520  ate URI (before 
-00006630: 6c6f 6f70 290a 2020 2020 2020 2020 696d  loop).        im
-00006640: 706f 7274 2073 6563 7265 7473 0a0a 2020  port secrets..  
-00006650: 2020 2020 2020 5552 4920 3d20 7365 6372        URI = secr
-00006660: 6574 732e 746f 6b65 6e5f 6865 7828 6e62  ets.token_hex(nb
-00006670: 7974 6573 3d34 290a 0a20 2020 2020 2020  ytes=4)..       
-00006680: 206d 6173 7465 725f 6469 7370 6c61 7920   master_display 
-00006690: 3d20 4e6f 6e65 0a20 2020 2020 2020 206d  = None.        m
-000066a0: 6173 7465 725f 6469 7370 6c61 795f 203d  aster_display_ =
-000066b0: 204e 6f6e 650a 0a20 2020 2020 2020 2074   None..        t
-000066c0: 6f74 616c 5f72 756e 7469 6d65 5f73 7461  otal_runtime_sta
-000066d0: 7274 203d 2074 696d 652e 7469 6d65 2829  rt = time.time()
-000066e0: 0a20 2020 2020 2020 2074 6f74 616c 5f72  .        total_r
-000066f0: 756e 7469 6d65 203d 2030 0a20 2020 2020  untime = 0.     
-00006700: 2020 206f 7665 725f 7469 6d65 5f62 7564     over_time_bud
-00006710: 6765 7420 3d20 4661 6c73 650a 2020 2020  get = False.    
-00006720: 2020 2020 6966 2062 7564 6765 745f 7469      if budget_ti
-00006730: 6d65 2061 6e64 2062 7564 6765 745f 7469  me and budget_ti
-00006740: 6d65 203e 2030 3a0a 2020 2020 2020 2020  me > 0:.        
-00006750: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
-00006760: 696e 666f 2866 2254 696d 6520 6275 6467  info(f"Time budg
-00006770: 6574 2069 7320 7b62 7564 6765 745f 7469  et is {budget_ti
-00006780: 6d65 7d20 6d69 6e75 7465 7322 290a 0a20  me} minutes").. 
-00006790: 2020 2020 2020 2066 6f72 2069 2c20 6d6f         for i, mo
-000067a0: 6465 6c20 696e 2065 6e75 6d65 7261 7465  del in enumerate
-000067b0: 286d 6f64 656c 5f6c 6962 7261 7279 293a  (model_library):
-000067c0: 0a0a 2020 2020 2020 2020 2020 2020 6d6f  ..            mo
-000067d0: 6465 6c5f 6964 203d 2028 0a20 2020 2020  del_id = (.     
-000067e0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-000067f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006800: 2069 6620 280a 2020 2020 2020 2020 2020   if (.          
-00006810: 2020 2020 2020 2020 2020 6973 696e 7374            isinst
-00006820: 616e 6365 286d 6f64 656c 2c20 7374 7229  ance(model, str)
-00006830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006840: 2020 2020 2061 6e64 2061 6c6c 2869 7369       and all(isi
-00006850: 6e73 7461 6e63 6528 6d2c 2073 7472 2920  nstance(m, str) 
-00006860: 666f 7220 6d20 696e 206d 6f64 656c 5f6c  for m in model_l
-00006870: 6962 7261 7279 290a 2020 2020 2020 2020  ibrary).        
-00006880: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00006890: 2020 2020 2020 2020 2020 656c 7365 2073            else s
-000068a0: 7472 2869 290a 2020 2020 2020 2020 2020  tr(i).          
-000068b0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-000068c0: 6d6f 6465 6c5f 6e61 6d65 203d 2073 656c  model_name = sel
-000068d0: 662e 5f67 6574 5f6d 6f64 656c 5f6e 616d  f._get_model_nam
-000068e0: 6528 6d6f 6465 6c29 0a0a 2020 2020 2020  e(model)..      
-000068f0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00006900: 6e63 6528 6d6f 6465 6c2c 2073 7472 293a  nce(model, str):
-00006910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006920: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
-00006930: 6f28 6622 496e 6974 6961 6c69 7a69 6e67  o(f"Initializing
-00006940: 207b 6d6f 6465 6c5f 6e61 6d65 7d22 290a   {model_name}").
-00006950: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00006960: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00006970: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
-00006980: 666f 2866 2249 6e69 7469 616c 697a 696e  fo(f"Initializin
-00006990: 6720 6375 7374 6f6d 206d 6f64 656c 207b  g custom model {
-000069a0: 6d6f 6465 6c5f 6e61 6d65 7d22 290a 0a20  model_name}").. 
-000069b0: 2020 2020 2020 2020 2020 2023 2072 756e             # run
-000069c0: 5f74 696d 650a 2020 2020 2020 2020 2020  _time.          
-000069d0: 2020 7275 6e74 696d 655f 7374 6172 7420    runtime_start 
-000069e0: 3d20 7469 6d65 2e74 696d 6528 290a 2020  = time.time().  
-000069f0: 2020 2020 2020 2020 2020 746f 7461 6c5f            total_
-00006a00: 7275 6e74 696d 6520 2b3d 2028 7275 6e74  runtime += (runt
-00006a10: 696d 655f 7374 6172 7420 2d20 746f 7461  ime_start - tota
-00006a20: 6c5f 7275 6e74 696d 655f 7374 6172 7429  l_runtime_start)
-00006a30: 202f 2036 300a 2020 2020 2020 2020 2020   / 60.          
-00006a40: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
-00006a50: 666f 2866 2254 6f74 616c 2072 756e 7469  fo(f"Total runti
-00006a60: 6d65 2069 7320 7b74 6f74 616c 5f72 756e  me is {total_run
-00006a70: 7469 6d65 7d20 6d69 6e75 7465 7322 290a  time} minutes").
-00006a80: 2020 2020 2020 2020 2020 2020 6f76 6572              over
-00006a90: 5f74 696d 655f 6275 6467 6574 203d 2028  _time_budget = (
-00006aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006ab0: 2062 7564 6765 745f 7469 6d65 2061 6e64   budget_time and
-00006ac0: 2062 7564 6765 745f 7469 6d65 203e 2030   budget_time > 0
-00006ad0: 2061 6e64 2074 6f74 616c 5f72 756e 7469   and total_runti
-00006ae0: 6d65 203e 2062 7564 6765 745f 7469 6d65  me > budget_time
-00006af0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00006b00: 2020 2020 2020 2020 2020 2069 6620 6f76             if ov
-00006b10: 6572 5f74 696d 655f 6275 6467 6574 3a0a  er_time_budget:.
-00006b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006b30: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
-00006b40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00006b50: 2020 2020 2020 6622 546f 7461 6c20 7275        f"Total ru
-00006b60: 6e74 696d 6520 7b74 6f74 616c 5f72 756e  ntime {total_run
-00006b70: 7469 6d65 7d20 6973 206f 7665 7220 7469  time} is over ti
-00006b80: 6d65 2062 7564 6765 7420 6279 207b 746f  me budget by {to
-00006b90: 7461 6c5f 7275 6e74 696d 6520 2d20 6275  tal_runtime - bu
-00006ba0: 6467 6574 5f74 696d 657d 2c20 6272 6561  dget_time}, brea
-00006bb0: 6b69 6e67 206c 6f6f 7022 0a20 2020 2020  king loop".     
-00006bc0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00006bd0: 2020 2020 2020 2020 2020 2020 2062 7265               bre
-00006be0: 616b 0a20 2020 2020 2020 2020 2020 2074  ak.            t
-00006bf0: 6f74 616c 5f72 756e 7469 6d65 5f73 7461  otal_runtime_sta
-00006c00: 7274 203d 2072 756e 7469 6d65 5f73 7461  rt = runtime_sta
-00006c10: 7274 0a0a 2020 2020 2020 2020 2020 2020  rt..            
-00006c20: 2222 220a 2020 2020 2020 2020 2020 2020  """.            
-00006c30: 4d4f 4e49 544f 5220 5550 4441 5445 2053  MONITOR UPDATE S
-00006c40: 5441 5254 530a 2020 2020 2020 2020 2020  TARTS.          
-00006c50: 2020 2222 220a 0a20 2020 2020 2020 2020    """..         
-00006c60: 2020 2064 6973 706c 6179 2e75 7064 6174     display.updat
-00006c70: 655f 6d6f 6e69 746f 7228 322c 206d 6f64  e_monitor(2, mod
-00006c80: 656c 5f6e 616d 6529 0a0a 2020 2020 2020  el_name)..      
-00006c90: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00006ca0: 2020 2020 2020 4d4f 4e49 544f 5220 5550        MONITOR UP
-00006cb0: 4441 5445 2045 4e44 530a 2020 2020 2020  DATE ENDS.      
-00006cc0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00006cd0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
-00006ce0: 6572 2e69 6e66 6f28 0a20 2020 2020 2020  er.info(.       
-00006cf0: 2020 2020 2020 2020 2022 5375 6250 726f           "SubPro
-00006d00: 6365 7373 2063 7265 6174 655f 6d6f 6465  cess create_mode
-00006d10: 6c28 2920 6361 6c6c 6564 203d 3d3d 3d3d  l() called =====
+000051c0: 2066 2245 7374 696d 6174 6f72 207b 697d   f"Estimator {i}
+000051d0: 2064 6f65 7320 6e6f 7420 6861 7665 2074   does not have t
+000051e0: 6865 2072 6571 7569 7265 6420 6669 7428  he required fit(
+000051f0: 2920 6d65 7468 6f64 2e22 0a20 2020 2020  ) method.".     
+00005200: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00005210: 0a0a 2020 2020 2020 2020 2320 696e 636c  ..        # incl
+00005220: 7564 6520 616e 6420 6578 636c 7564 6520  ude and exclude 
+00005230: 746f 6765 7468 6572 2063 6865 636b 0a20  together check. 
+00005240: 2020 2020 2020 2069 6620 696e 636c 7564         if includ
+00005250: 6520 6973 206e 6f74 204e 6f6e 6520 616e  e is not None an
+00005260: 6420 6578 636c 7564 6520 6973 206e 6f74  d exclude is not
+00005270: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00005280: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00005290: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+000052a0: 2020 2020 2243 616e 6e6f 7420 7573 6520      "Cannot use 
+000052b0: 6578 636c 7564 6520 7061 7261 6d65 7465  exclude paramete
+000052c0: 7220 7768 656e 2069 6e63 6c75 6465 2069  r when include i
+000052d0: 7320 7573 6564 2074 6f20 636f 6d70 6172  s used to compar
+000052e0: 6520 6d6f 6465 6c73 2e22 0a20 2020 2020  e models.".     
+000052f0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00005300: 2020 2320 6368 6563 6b69 6e67 2066 6f6c    # checking fol
+00005310: 6420 7061 7261 6d65 7465 720a 2020 2020  d parameter.    
+00005320: 2020 2020 6966 2066 6f6c 6420 6973 206e      if fold is n
+00005330: 6f74 204e 6f6e 6520 616e 6420 6e6f 7420  ot None and not 
+00005340: 280a 2020 2020 2020 2020 2020 2020 7479  (.            ty
+00005350: 7065 2866 6f6c 6429 2069 7320 696e 7420  pe(fold) is int 
+00005360: 6f72 2069 735f 736b 6c65 6172 6e5f 6376  or is_sklearn_cv
+00005370: 5f67 656e 6572 6174 6f72 2866 6f6c 6429  _generator(fold)
+00005380: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
+00005390: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+000053a0: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
+000053b0: 2020 2020 2020 2020 2022 666f 6c64 2070           "fold p
+000053c0: 6172 616d 6574 6572 206d 7573 7420 6265  arameter must be
+000053d0: 2065 6974 6865 7220 4e6f 6e65 2c20 616e   either None, an
+000053e0: 2069 6e74 6567 6572 206f 7220 6120 7363   integer or a sc
+000053f0: 696b 6974 2d6c 6561 726e 2063 6f6d 7061  ikit-learn compa
+00005400: 7469 626c 6520 4356 2067 656e 6572 6174  tible CV generat
+00005410: 6f72 206f 626a 6563 742e 220a 2020 2020  or object.".    
+00005420: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00005430: 2020 2023 2063 6865 636b 696e 6720 726f     # checking ro
+00005440: 756e 6420 7061 7261 6d65 7465 720a 2020  und parameter.  
+00005450: 2020 2020 2020 6966 2074 7970 6528 726f        if type(ro
+00005460: 756e 6429 2069 7320 6e6f 7420 696e 743a  und) is not int:
+00005470: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00005480: 7365 2054 7970 6545 7272 6f72 2822 526f  se TypeError("Ro
+00005490: 756e 6420 7061 7261 6d65 7465 7220 6f6e  und parameter on
+000054a0: 6c79 2061 6363 6570 7473 2069 6e74 6567  ly accepts integ
+000054b0: 6572 2076 616c 7565 2e22 290a 0a20 2020  er value.")..   
+000054c0: 2020 2020 2023 2063 6865 636b 696e 6720       # checking 
+000054d0: 6275 6467 6574 5f74 696d 6520 7061 7261  budget_time para
+000054e0: 6d65 7465 720a 2020 2020 2020 2020 6966  meter.        if
+000054f0: 2028 0a20 2020 2020 2020 2020 2020 2062   (.            b
+00005500: 7564 6765 745f 7469 6d65 0a20 2020 2020  udget_time.     
+00005510: 2020 2020 2020 2061 6e64 2074 7970 6528         and type(
+00005520: 6275 6467 6574 5f74 696d 6529 2069 7320  budget_time) is 
+00005530: 6e6f 7420 696e 740a 2020 2020 2020 2020  not int.        
+00005540: 2020 2020 616e 6420 7479 7065 2862 7564      and type(bud
+00005550: 6765 745f 7469 6d65 2920 6973 206e 6f74  get_time) is not
+00005560: 2066 6c6f 6174 0a20 2020 2020 2020 2029   float.        )
+00005570: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00005580: 6973 6520 5479 7065 4572 726f 7228 0a20  ise TypeError(. 
+00005590: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000055a0: 6275 6467 6574 5f74 696d 6520 7061 7261  budget_time para
+000055b0: 6d65 7465 7220 6f6e 6c79 2061 6363 6570  meter only accep
+000055c0: 7473 2069 6e74 6567 6572 206f 7220 666c  ts integer or fl
+000055d0: 6f61 7420 7661 6c75 6573 2e22 0a20 2020  oat values.".   
+000055e0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+000055f0: 2020 2020 2320 6368 6563 6b69 6e67 2073      # checking s
+00005600: 6f72 7420 7061 7261 6d65 7465 720a 2020  ort parameter.  
+00005610: 2020 2020 2020 6966 206e 6f74 2028 6973        if not (is
+00005620: 696e 7374 616e 6365 2873 6f72 742c 2073  instance(sort, s
+00005630: 7472 2920 616e 6420 2873 6f72 7420 3d3d  tr) and (sort ==
+00005640: 2022 5454 2220 6f72 2073 6f72 7420 3d3d   "TT" or sort ==
+00005650: 2022 5454 2028 5365 6329 2229 293a 0a20   "TT (Sec)")):. 
+00005660: 2020 2020 2020 2020 2020 2073 6f72 7420             sort 
+00005670: 3d20 7365 6c66 2e5f 6765 745f 6d65 7472  = self._get_metr
+00005680: 6963 5f62 795f 6e61 6d65 5f6f 725f 6964  ic_by_name_or_id
+00005690: 2873 6f72 7429 0a20 2020 2020 2020 2020  (sort).         
+000056a0: 2020 2069 6620 736f 7274 2069 7320 4e6f     if sort is No
+000056b0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+000056c0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+000056d0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+000056e0: 2020 2020 2020 2020 2020 2253 6f72 7420            "Sort 
+000056f0: 6d65 7468 6f64 206e 6f74 2073 7570 706f  method not suppo
+00005700: 7274 6564 2e20 5365 6520 646f 6373 7472  rted. See docstr
+00005710: 696e 6720 666f 7220 6c69 7374 206f 6620  ing for list of 
+00005720: 6176 6169 6c61 626c 6520 7061 7261 6d65  available parame
+00005730: 7465 7273 2e22 0a20 2020 2020 2020 2020  ters.".         
+00005740: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00005750: 2020 2320 6368 6563 6b69 6e67 2065 7272    # checking err
+00005760: 6f72 7320 7061 7261 6d65 7465 720a 2020  ors parameter.  
+00005770: 2020 2020 2020 706f 7373 6962 6c65 5f65        possible_e
+00005780: 7272 6f72 7320 3d20 5b22 6967 6e6f 7265  rrors = ["ignore
+00005790: 222c 2022 7261 6973 6522 5d0a 2020 2020  ", "raise"].    
+000057a0: 2020 2020 6966 2065 7272 6f72 7320 6e6f      if errors no
+000057b0: 7420 696e 2070 6f73 7369 626c 655f 6572  t in possible_er
+000057c0: 726f 7273 3a0a 2020 2020 2020 2020 2020  rors:.          
+000057d0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+000057e0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+000057f0: 2020 2020 6622 6572 726f 7273 2070 6172      f"errors par
+00005800: 616d 6574 6572 206d 7573 7420 6265 206f  ameter must be o
+00005810: 6e65 206f 663a 207b 272c 2027 2e6a 6f69  ne of: {', '.joi
+00005820: 6e28 706f 7373 6962 6c65 5f65 7272 6f72  n(possible_error
+00005830: 7329 7d2e 220a 2020 2020 2020 2020 2020  s)}.".          
+00005840: 2020 290a 0a20 2020 2020 2020 2023 2063    )..        # c
+00005850: 6865 636b 696e 6720 6f70 7469 6d69 7a65  hecking optimize
+00005860: 2070 6172 616d 6574 6572 2066 6f72 206d   parameter for m
+00005870: 756c 7469 636c 6173 730a 2020 2020 2020  ulticlass.      
+00005880: 2020 6966 2073 656c 662e 6973 5f6d 756c    if self.is_mul
+00005890: 7469 636c 6173 733a 0a20 2020 2020 2020  ticlass:.       
+000058a0: 2020 2020 2069 6620 6e6f 7420 736f 7274       if not sort
+000058b0: 2e69 735f 6d75 6c74 6963 6c61 7373 3a0a  .is_multiclass:.
+000058c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000058d0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+000058e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000058f0: 2020 2020 2066 227b 736f 7274 7d20 6d65       f"{sort} me
+00005900: 7472 6963 206e 6f74 2073 7570 706f 7274  tric not support
+00005910: 6564 2066 6f72 206d 756c 7469 636c 6173  ed for multiclas
+00005920: 7320 7072 6f62 6c65 6d73 2e20 5365 6520  s problems. See 
+00005930: 646f 6373 7472 696e 6720 666f 7220 6c69  docstring for li
+00005940: 7374 206f 6620 6f74 6865 7220 6f70 7469  st of other opti
+00005950: 6d69 7a61 7469 6f6e 2070 6172 616d 6574  mization paramet
+00005960: 6572 732e 220a 2020 2020 2020 2020 2020  ers.".          
+00005970: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00005980: 2022 2222 0a0a 2020 2020 2020 2020 4552   """..        ER
+00005990: 524f 5220 4841 4e44 4c49 4e47 2045 4e44  ROR HANDLING END
+000059a0: 5320 4845 5245 0a0a 2020 2020 2020 2020  S HERE..        
+000059b0: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
+000059c0: 7365 6c66 2e5f 6d6c 5f75 7365 6361 7365  self._ml_usecase
+000059d0: 2021 3d20 4d4c 5573 6563 6173 652e 5449   != MLUsecase.TI
+000059e0: 4d45 5f53 4552 4945 533a 0a20 2020 2020  ME_SERIES:.     
+000059f0: 2020 2020 2020 2066 6f6c 6420 3d20 7365         fold = se
+00005a00: 6c66 2e5f 6765 745f 6376 5f73 706c 6974  lf._get_cv_split
+00005a10: 7465 7228 666f 6c64 290a 0a20 2020 2020  ter(fold)..     
+00005a20: 2020 2067 726f 7570 7320 3d20 7365 6c66     groups = self
+00005a30: 2e5f 6765 745f 6772 6f75 7073 2867 726f  ._get_groups(gro
+00005a40: 7570 7329 0a0a 2020 2020 2020 2020 7064  ups)..        pd
+00005a50: 2e73 6574 5f6f 7074 696f 6e28 2264 6973  .set_option("dis
+00005a60: 706c 6179 2e6d 6178 5f63 6f6c 756d 6e73  play.max_columns
+00005a70: 222c 2035 3030 290a 0a20 2020 2020 2020  ", 500)..       
+00005a80: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
+00005a90: 6f28 2250 7265 7061 7269 6e67 2064 6973  o("Preparing dis
+00005aa0: 706c 6179 206d 6f6e 6974 6f72 2229 0a0a  play monitor")..
+00005ab0: 2020 2020 2020 2020 6c65 6e5f 6d6f 6420          len_mod 
+00005ac0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00005ad0: 6c65 6e28 7b6b 3a20 7620 666f 7220 6b2c  len({k: v for k,
+00005ae0: 2076 2069 6e20 7365 6c66 2e5f 616c 6c5f   v in self._all_
+00005af0: 6d6f 6465 6c73 2e69 7465 6d73 2829 2069  models.items() i
+00005b00: 6620 762e 6973 5f74 7572 626f 7d29 0a20  f v.is_turbo}). 
+00005b10: 2020 2020 2020 2020 2020 2069 6620 7475             if tu
+00005b20: 7262 6f0a 2020 2020 2020 2020 2020 2020  rbo.            
+00005b30: 656c 7365 206c 656e 2873 656c 662e 5f61  else len(self._a
+00005b40: 6c6c 5f6d 6f64 656c 7329 0a20 2020 2020  ll_models).     
+00005b50: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
+00005b60: 2069 6e63 6c75 6465 3a0a 2020 2020 2020   include:.      
+00005b70: 2020 2020 2020 6c65 6e5f 6d6f 6420 3d20        len_mod = 
+00005b80: 6c65 6e28 696e 636c 7564 6529 0a20 2020  len(include).   
+00005b90: 2020 2020 2065 6c69 6620 6578 636c 7564       elif exclud
+00005ba0: 653a 0a20 2020 2020 2020 2020 2020 206c  e:.            l
+00005bb0: 656e 5f6d 6f64 202d 3d20 6c65 6e28 6578  en_mod -= len(ex
+00005bc0: 636c 7564 6529 0a0a 2020 2020 2020 2020  clude)..        
+00005bd0: 7072 6f67 7265 7373 5f61 7267 7320 3d20  progress_args = 
+00005be0: 7b22 6d61 7822 3a20 2834 202a 206c 656e  {"max": (4 * len
+00005bf0: 5f6d 6f64 2920 2b20 3420 2b20 6d69 6e28  _mod) + 4 + min(
+00005c00: 6c65 6e5f 6d6f 642c 2061 6273 286e 5f73  len_mod, abs(n_s
+00005c10: 656c 6563 7429 297d 0a20 2020 2020 2020  elect))}.       
+00005c20: 206d 6173 7465 725f 6469 7370 6c61 795f   master_display_
+00005c30: 636f 6c75 6d6e 7320 3d20 280a 2020 2020  columns = (.    
+00005c40: 2020 2020 2020 2020 5b22 4d6f 6465 6c22          ["Model"
+00005c50: 5d0a 2020 2020 2020 2020 2020 2020 2b20  ].            + 
+00005c60: 5b76 2e64 6973 706c 6179 5f6e 616d 6520  [v.display_name 
+00005c70: 666f 7220 6b2c 2076 2069 6e20 7365 6c66  for k, v in self
+00005c80: 2e5f 616c 6c5f 6d65 7472 6963 732e 6974  ._all_metrics.it
+00005c90: 656d 7328 295d 0a20 2020 2020 2020 2020  ems()].         
+00005ca0: 2020 202b 205b 2254 5420 2853 6563 2922     + ["TT (Sec)"
+00005cb0: 5d0a 2020 2020 2020 2020 290a 2020 2020  ].        ).    
+00005cc0: 2020 2020 6d61 7374 6572 5f64 6973 706c      master_displ
+00005cd0: 6179 203d 2070 642e 4461 7461 4672 616d  ay = pd.DataFram
+00005ce0: 6528 636f 6c75 6d6e 733d 6d61 7374 6572  e(columns=master
+00005cf0: 5f64 6973 706c 6179 5f63 6f6c 756d 6e73  _display_columns
+00005d00: 290a 2020 2020 2020 2020 7469 6d65 7374  ).        timest
+00005d10: 616d 7053 7472 203d 2064 6174 6574 696d  ampStr = datetim
+00005d20: 652e 6461 7465 7469 6d65 2e6e 6f77 2829  e.datetime.now()
+00005d30: 2e73 7472 6674 696d 6528 2225 483a 254d  .strftime("%H:%M
+00005d40: 3a25 5322 290a 2020 2020 2020 2020 6d6f  :%S").        mo
+00005d50: 6e69 746f 725f 726f 7773 203d 205b 0a20  nitor_rows = [. 
+00005d60: 2020 2020 2020 2020 2020 205b 2249 6e69             ["Ini
+00005d70: 7469 6174 6564 222c 2022 2e20 2e20 2e20  tiated", ". . . 
+00005d80: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
+00005d90: 2e20 2e20 2e20 2e20 2e20 2e20 2e22 2c20  . . . . . . .", 
+00005da0: 7469 6d65 7374 616d 7053 7472 5d2c 0a20  timestampStr],. 
+00005db0: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+00005dc0: 2020 2020 2020 2020 2020 2020 2022 5374               "St
+00005dd0: 6174 7573 222c 0a20 2020 2020 2020 2020  atus",.         
+00005de0: 2020 2020 2020 2022 2e20 2e20 2e20 2e20         ". . . . 
+00005df0: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
+00005e00: 2e20 2e20 2e20 2e20 2e20 2e22 2c0a 2020  . . . . . .",.  
+00005e10: 2020 2020 2020 2020 2020 2020 2020 224c                "L
+00005e20: 6f61 6469 6e67 2044 6570 656e 6465 6e63  oading Dependenc
+00005e30: 6965 7322 2c0a 2020 2020 2020 2020 2020  ies",.          
+00005e40: 2020 5d2c 0a20 2020 2020 2020 2020 2020    ],.           
+00005e50: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+00005e60: 2020 2022 4573 7469 6d61 746f 7222 2c0a     "Estimator",.
+00005e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005e80: 222e 202e 202e 202e 202e 202e 202e 202e  ". . . . . . . .
+00005e90: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
+00005ea0: 202e 202e 222c 0a20 2020 2020 2020 2020   . .",.         
+00005eb0: 2020 2020 2020 2022 436f 6d70 696c 696e         "Compilin
+00005ec0: 6720 4c69 6272 6172 7922 2c0a 2020 2020  g Library",.    
+00005ed0: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
+00005ee0: 2020 205d 0a20 2020 2020 2020 2064 6973     ].        dis
+00005ef0: 706c 6179 203d 2028 0a20 2020 2020 2020  play = (.       
+00005f00: 2020 2020 2044 756d 6d79 4469 7370 6c61       DummyDispla
+00005f10: 7928 290a 2020 2020 2020 2020 2020 2020  y().            
+00005f20: 6966 2073 656c 662e 5f72 656d 6f74 650a  if self._remote.
+00005f30: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00005f40: 2043 6f6d 6d6f 6e44 6973 706c 6179 280a   CommonDisplay(.
+00005f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005f60: 7665 7262 6f73 653d 7665 7262 6f73 652c  verbose=verbose,
+00005f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005f80: 2068 746d 6c5f 7061 7261 6d3d 7365 6c66   html_param=self
+00005f90: 2e68 746d 6c5f 7061 7261 6d2c 0a20 2020  .html_param,.   
+00005fa0: 2020 2020 2020 2020 2020 2020 2070 726f               pro
+00005fb0: 6772 6573 735f 6172 6773 3d70 726f 6772  gress_args=progr
+00005fc0: 6573 735f 6172 6773 2c0a 2020 2020 2020  ess_args,.      
+00005fd0: 2020 2020 2020 2020 2020 6d6f 6e69 746f            monito
+00005fe0: 725f 726f 7773 3d6d 6f6e 6974 6f72 5f72  r_rows=monitor_r
+00005ff0: 6f77 732c 0a20 2020 2020 2020 2020 2020  ows,.           
+00006000: 2029 0a20 2020 2020 2020 2029 0a20 2020   ).        ).   
+00006010: 2020 2020 2069 6620 6469 7370 6c61 792e       if display.
+00006020: 6361 6e5f 7570 6461 7465 5f74 6578 743a  can_update_text:
+00006030: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
+00006040: 706c 6179 2e64 6973 706c 6179 286d 6173  play.display(mas
+00006050: 7465 725f 6469 7370 6c61 792c 2066 696e  ter_display, fin
+00006060: 616c 5f64 6973 706c 6179 3d46 616c 7365  al_display=False
+00006070: 290a 0a20 2020 2020 2020 2069 6e70 7574  )..        input
+00006080: 5f6d 6c5f 7573 6563 6173 6520 3d20 7365  _ml_usecase = se
+00006090: 6c66 2e5f 6d6c 5f75 7365 6361 7365 0a20  lf._ml_usecase. 
+000060a0: 2020 2020 2020 2074 6172 6765 745f 6d6c         target_ml
+000060b0: 5f75 7365 6361 7365 203d 204d 4c55 7365  _usecase = MLUse
+000060c0: 6361 7365 2e54 494d 455f 5345 5249 4553  case.TIME_SERIES
+000060d0: 0a0a 2020 2020 2020 2020 6e70 2e72 616e  ..        np.ran
+000060e0: 646f 6d2e 7365 6564 2873 656c 662e 7365  dom.seed(self.se
+000060f0: 6564 290a 0a20 2020 2020 2020 2064 6973  ed)..        dis
+00006100: 706c 6179 2e6d 6f76 655f 7072 6f67 7265  play.move_progre
+00006110: 7373 2829 0a0a 2020 2020 2020 2020 2320  ss()..        # 
+00006120: 6465 6669 6e69 6e67 2073 6f72 7420 7061  defining sort pa
+00006130: 7261 6d65 7465 7220 286d 616b 696e 6720  rameter (making 
+00006140: 5072 6563 6973 696f 6e20 6571 7569 7661  Precision equiva
+00006150: 6c65 6e74 2074 6f20 5072 6563 2e20 290a  lent to Prec. ).
+00006160: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00006170: 2869 7369 6e73 7461 6e63 6528 736f 7274  (isinstance(sort
+00006180: 2c20 7374 7229 2061 6e64 2028 736f 7274  , str) and (sort
+00006190: 203d 3d20 2254 5422 206f 7220 736f 7274   == "TT" or sort
+000061a0: 203d 3d20 2254 5420 2853 6563 2922 2929   == "TT (Sec)"))
+000061b0: 3a0a 2020 2020 2020 2020 2020 2020 736f  :.            so
+000061c0: 7274 5f61 7363 656e 6469 6e67 203d 206e  rt_ascending = n
+000061d0: 6f74 2073 6f72 742e 6772 6561 7465 725f  ot sort.greater_
+000061e0: 6973 5f62 6574 7465 720a 2020 2020 2020  is_better.      
+000061f0: 2020 2020 2020 736f 7274 203d 2069 645f        sort = id_
+00006200: 6f72 5f64 6973 706c 6179 5f6e 616d 6528  or_display_name(
+00006210: 736f 7274 2c20 696e 7075 745f 6d6c 5f75  sort, input_ml_u
+00006220: 7365 6361 7365 2c20 7461 7267 6574 5f6d  secase, target_m
+00006230: 6c5f 7573 6563 6173 6529 0a20 2020 2020  l_usecase).     
+00006240: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00006250: 2020 2020 2073 6f72 745f 6173 6365 6e64       sort_ascend
+00006260: 696e 6720 3d20 5472 7565 0a20 2020 2020  ing = True.     
+00006270: 2020 2020 2020 2073 6f72 7420 3d20 2254         sort = "T
+00006280: 5420 2853 6563 2922 0a0a 2020 2020 2020  T (Sec)"..      
+00006290: 2020 2222 220a 2020 2020 2020 2020 4d4f    """.        MO
+000062a0: 4e49 544f 5220 5550 4441 5445 2053 5441  NITOR UPDATE STA
+000062b0: 5254 530a 2020 2020 2020 2020 2222 220a  RTS.        """.
+000062c0: 0a20 2020 2020 2020 2064 6973 706c 6179  .        display
+000062d0: 2e75 7064 6174 655f 6d6f 6e69 746f 7228  .update_monitor(
+000062e0: 312c 2022 4c6f 6164 696e 6720 4573 7469  1, "Loading Esti
+000062f0: 6d61 746f 7222 290a 0a20 2020 2020 2020  mator")..       
+00006300: 2022 2222 0a20 2020 2020 2020 204d 4f4e   """.        MON
+00006310: 4954 4f52 2055 5044 4154 4520 454e 4453  ITOR UPDATE ENDS
+00006320: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+00006330: 2020 2020 2020 6966 2069 6e63 6c75 6465        if include
+00006340: 3a0a 2020 2020 2020 2020 2020 2020 6d6f  :.            mo
+00006350: 6465 6c5f 6c69 6272 6172 7920 3d20 696e  del_library = in
+00006360: 636c 7564 650a 2020 2020 2020 2020 656c  clude.        el
+00006370: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00006380: 6966 2074 7572 626f 3a0a 2020 2020 2020  if turbo:.      
+00006390: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
+000063a0: 6c69 6272 6172 7920 3d20 5b6b 2066 6f72  library = [k for
+000063b0: 206b 2c20 7620 696e 2073 656c 662e 5f61   k, v in self._a
+000063c0: 6c6c 5f6d 6f64 656c 732e 6974 656d 7328  ll_models.items(
+000063d0: 2920 6966 2076 2e69 735f 7475 7262 6f5d  ) if v.is_turbo]
+000063e0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+000063f0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00006400: 2020 206d 6f64 656c 5f6c 6962 7261 7279     model_library
+00006410: 203d 206c 6973 7428 7365 6c66 2e5f 616c   = list(self._al
+00006420: 6c5f 6d6f 6465 6c73 2e6b 6579 7328 2929  l_models.keys())
+00006430: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00006440: 6578 636c 7564 653a 0a20 2020 2020 2020  exclude:.       
+00006450: 2020 2020 2020 2020 206d 6f64 656c 5f6c           model_l
+00006460: 6962 7261 7279 203d 205b 7820 666f 7220  ibrary = [x for 
+00006470: 7820 696e 206d 6f64 656c 5f6c 6962 7261  x in model_libra
+00006480: 7279 2069 6620 7820 6e6f 7420 696e 2065  ry if x not in e
+00006490: 7863 6c75 6465 5d0a 0a20 2020 2020 2020  xclude]..       
+000064a0: 2069 6620 7365 6c66 2e5f 6d6c 5f75 7365   if self._ml_use
+000064b0: 6361 7365 203d 3d20 4d4c 5573 6563 6173  case == MLUsecas
+000064c0: 652e 5449 4d45 5f53 4552 4945 533a 0a20  e.TIME_SERIES:. 
+000064d0: 2020 2020 2020 2020 2020 2069 6620 2265             if "e
+000064e0: 6e73 656d 626c 655f 666f 7265 6361 7374  nsemble_forecast
+000064f0: 6572 2220 696e 206d 6f64 656c 5f6c 6962  er" in model_lib
+00006500: 7261 7279 3a0a 2020 2020 2020 2020 2020  rary:.          
+00006510: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
+00006520: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
+00006530: 2020 2020 2020 2020 2022 556e 7375 7070           "Unsupp
+00006540: 6f72 7465 6420 6573 7469 6d61 746f 7220  orted estimator 
+00006550: 6065 6e73 656d 626c 655f 666f 7265 6361  `ensemble_foreca
+00006560: 7374 6572 6020 666f 7220 6d65 7468 6f64  ster` for method
+00006570: 2060 636f 6d70 6172 655f 6d6f 6465 6c73   `compare_models
+00006580: 2829 602c 2072 656d 6f76 696e 6720 6672  ()`, removing fr
+00006590: 6f6d 206d 6f64 656c 5f6c 6962 7261 7279  om model_library
+000065a0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+000065b0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+000065c0: 2020 2020 6d6f 6465 6c5f 6c69 6272 6172      model_librar
+000065d0: 792e 7265 6d6f 7665 2822 656e 7365 6d62  y.remove("ensemb
+000065e0: 6c65 5f66 6f72 6563 6173 7465 7222 290a  le_forecaster").
+000065f0: 0a20 2020 2020 2020 2064 6973 706c 6179  .        display
+00006600: 2e6d 6f76 655f 7072 6f67 7265 7373 2829  .move_progress()
+00006610: 0a0a 2020 2020 2020 2020 2320 6372 6561  ..        # crea
+00006620: 7465 2055 5249 2028 6265 666f 7265 206c  te URI (before l
+00006630: 6f6f 7029 0a20 2020 2020 2020 2069 6d70  oop).        imp
+00006640: 6f72 7420 7365 6372 6574 730a 0a20 2020  ort secrets..   
+00006650: 2020 2020 2055 5249 203d 2073 6563 7265       URI = secre
+00006660: 7473 2e74 6f6b 656e 5f68 6578 286e 6279  ts.token_hex(nby
+00006670: 7465 733d 3429 0a0a 2020 2020 2020 2020  tes=4)..        
+00006680: 6d61 7374 6572 5f64 6973 706c 6179 203d  master_display =
+00006690: 204e 6f6e 650a 2020 2020 2020 2020 6d61   None.        ma
+000066a0: 7374 6572 5f64 6973 706c 6179 5f20 3d20  ster_display_ = 
+000066b0: 4e6f 6e65 0a0a 2020 2020 2020 2020 746f  None..        to
+000066c0: 7461 6c5f 7275 6e74 696d 655f 7374 6172  tal_runtime_star
+000066d0: 7420 3d20 7469 6d65 2e74 696d 6528 290a  t = time.time().
+000066e0: 2020 2020 2020 2020 746f 7461 6c5f 7275          total_ru
+000066f0: 6e74 696d 6520 3d20 300a 2020 2020 2020  ntime = 0.      
+00006700: 2020 6f76 6572 5f74 696d 655f 6275 6467    over_time_budg
+00006710: 6574 203d 2046 616c 7365 0a20 2020 2020  et = False.     
+00006720: 2020 2069 6620 6275 6467 6574 5f74 696d     if budget_tim
+00006730: 6520 616e 6420 6275 6467 6574 5f74 696d  e and budget_tim
+00006740: 6520 3e20 303a 0a20 2020 2020 2020 2020  e > 0:.         
+00006750: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
+00006760: 6e66 6f28 6622 5469 6d65 2062 7564 6765  nfo(f"Time budge
+00006770: 7420 6973 207b 6275 6467 6574 5f74 696d  t is {budget_tim
+00006780: 657d 206d 696e 7574 6573 2229 0a0a 2020  e} minutes")..  
+00006790: 2020 2020 2020 666f 7220 692c 206d 6f64        for i, mod
+000067a0: 656c 2069 6e20 656e 756d 6572 6174 6528  el in enumerate(
+000067b0: 6d6f 6465 6c5f 6c69 6272 6172 7929 3a0a  model_library):.
+000067c0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+000067d0: 6c5f 6964 203d 2028 0a20 2020 2020 2020  l_id = (.       
+000067e0: 2020 2020 2020 2020 206d 6f64 656c 0a20           model. 
+000067f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00006800: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
+00006810: 2020 2020 2020 2020 6973 696e 7374 616e          isinstan
+00006820: 6365 286d 6f64 656c 2c20 7374 7229 0a20  ce(model, str). 
+00006830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006840: 2020 2061 6e64 2061 6c6c 2869 7369 6e73     and all(isins
+00006850: 7461 6e63 6528 6d2c 2073 7472 2920 666f  tance(m, str) fo
+00006860: 7220 6d20 696e 206d 6f64 656c 5f6c 6962  r m in model_lib
+00006870: 7261 7279 290a 2020 2020 2020 2020 2020  rary).          
+00006880: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00006890: 2020 2020 2020 2020 656c 7365 2073 7472          else str
+000068a0: 2869 290a 2020 2020 2020 2020 2020 2020  (i).            
+000068b0: 290a 2020 2020 2020 2020 2020 2020 6d6f  ).            mo
+000068c0: 6465 6c5f 6e61 6d65 203d 2073 656c 662e  del_name = self.
+000068d0: 5f67 6574 5f6d 6f64 656c 5f6e 616d 6528  _get_model_name(
+000068e0: 6d6f 6465 6c29 0a0a 2020 2020 2020 2020  model)..        
+000068f0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00006900: 6528 6d6f 6465 6c2c 2073 7472 293a 0a20  e(model, str):. 
+00006910: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00006920: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
+00006930: 6622 496e 6974 6961 6c69 7a69 6e67 207b  f"Initializing {
+00006940: 6d6f 6465 6c5f 6e61 6d65 7d22 290a 2020  model_name}").  
+00006950: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00006960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006970: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
+00006980: 2866 2249 6e69 7469 616c 697a 696e 6720  (f"Initializing 
+00006990: 6375 7374 6f6d 206d 6f64 656c 207b 6d6f  custom model {mo
+000069a0: 6465 6c5f 6e61 6d65 7d22 290a 0a20 2020  del_name}")..   
+000069b0: 2020 2020 2020 2020 2023 2072 756e 5f74           # run_t
+000069c0: 696d 650a 2020 2020 2020 2020 2020 2020  ime.            
+000069d0: 7275 6e74 696d 655f 7374 6172 7420 3d20  runtime_start = 
+000069e0: 7469 6d65 2e74 696d 6528 290a 2020 2020  time.time().    
+000069f0: 2020 2020 2020 2020 746f 7461 6c5f 7275          total_ru
+00006a00: 6e74 696d 6520 2b3d 2028 7275 6e74 696d  ntime += (runtim
+00006a10: 655f 7374 6172 7420 2d20 746f 7461 6c5f  e_start - total_
+00006a20: 7275 6e74 696d 655f 7374 6172 7429 202f  runtime_start) /
+00006a30: 2036 300a 2020 2020 2020 2020 2020 2020   60.            
+00006a40: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
+00006a50: 2866 2254 6f74 616c 2072 756e 7469 6d65  (f"Total runtime
+00006a60: 2069 7320 7b74 6f74 616c 5f72 756e 7469   is {total_runti
+00006a70: 6d65 7d20 6d69 6e75 7465 7322 290a 2020  me} minutes").  
+00006a80: 2020 2020 2020 2020 2020 6f76 6572 5f74            over_t
+00006a90: 696d 655f 6275 6467 6574 203d 2028 0a20  ime_budget = (. 
+00006aa0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00006ab0: 7564 6765 745f 7469 6d65 2061 6e64 2062  udget_time and b
+00006ac0: 7564 6765 745f 7469 6d65 203e 2030 2061  udget_time > 0 a
+00006ad0: 6e64 2074 6f74 616c 5f72 756e 7469 6d65  nd total_runtime
+00006ae0: 203e 2062 7564 6765 745f 7469 6d65 0a20   > budget_time. 
+00006af0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00006b00: 2020 2020 2020 2020 2069 6620 6f76 6572           if over
+00006b10: 5f74 696d 655f 6275 6467 6574 3a0a 2020  _time_budget:.  
+00006b20: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00006b30: 6c66 2e6c 6f67 6765 722e 696e 666f 280a  lf.logger.info(.
+00006b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006b50: 2020 2020 6622 546f 7461 6c20 7275 6e74      f"Total runt
+00006b60: 696d 6520 7b74 6f74 616c 5f72 756e 7469  ime {total_runti
+00006b70: 6d65 7d20 6973 206f 7665 7220 7469 6d65  me} is over time
+00006b80: 2062 7564 6765 7420 6279 207b 746f 7461   budget by {tota
+00006b90: 6c5f 7275 6e74 696d 6520 2d20 6275 6467  l_runtime - budg
+00006ba0: 6574 5f74 696d 657d 2c20 6272 6561 6b69  et_time}, breaki
+00006bb0: 6e67 206c 6f6f 7022 0a20 2020 2020 2020  ng loop".       
+00006bc0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00006bd0: 2020 2020 2020 2020 2020 2062 7265 616b             break
+00006be0: 0a20 2020 2020 2020 2020 2020 2074 6f74  .            tot
+00006bf0: 616c 5f72 756e 7469 6d65 5f73 7461 7274  al_runtime_start
+00006c00: 203d 2072 756e 7469 6d65 5f73 7461 7274   = runtime_start
+00006c10: 0a0a 2020 2020 2020 2020 2020 2020 2222  ..            ""
+00006c20: 220a 2020 2020 2020 2020 2020 2020 4d4f  ".            MO
+00006c30: 4e49 544f 5220 5550 4441 5445 2053 5441  NITOR UPDATE STA
+00006c40: 5254 530a 2020 2020 2020 2020 2020 2020  RTS.            
+00006c50: 2222 220a 0a20 2020 2020 2020 2020 2020  """..           
+00006c60: 2064 6973 706c 6179 2e75 7064 6174 655f   display.update_
+00006c70: 6d6f 6e69 746f 7228 322c 206d 6f64 656c  monitor(2, model
+00006c80: 5f6e 616d 6529 0a0a 2020 2020 2020 2020  _name)..        
+00006c90: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00006ca0: 2020 2020 4d4f 4e49 544f 5220 5550 4441      MONITOR UPDA
+00006cb0: 5445 2045 4e44 530a 2020 2020 2020 2020  TE ENDS.        
+00006cc0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+00006cd0: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
+00006ce0: 2e69 6e66 6f28 0a20 2020 2020 2020 2020  .info(.         
+00006cf0: 2020 2020 2020 2022 5375 6250 726f 6365         "SubProce
+00006d00: 7373 2063 7265 6174 655f 6d6f 6465 6c28  ss create_model(
+00006d10: 2920 6361 6c6c 6564 203d 3d3d 3d3d 3d3d  ) called =======
 00006d20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00006d30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d22 0a20  =============". 
-00006d40: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00006d50: 2020 2020 2020 2020 2063 7265 6174 655f           create_
-00006d60: 6d6f 6465 6c5f 6172 6773 203d 2064 6963  model_args = dic
-00006d70: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00006d80: 2020 2065 7374 696d 6174 6f72 3d6d 6f64     estimator=mod
-00006d90: 656c 2c0a 2020 2020 2020 2020 2020 2020  el,.            
-00006da0: 2020 2020 7379 7374 656d 3d46 616c 7365      system=False
-00006db0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00006dc0: 2020 7665 7262 6f73 653d 4661 6c73 652c    verbose=False,
-00006dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006de0: 2064 6973 706c 6179 3d64 6973 706c 6179   display=display
-00006df0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00006e00: 2020 666f 6c64 3d66 6f6c 642c 0a20 2020    fold=fold,.   
-00006e10: 2020 2020 2020 2020 2020 2020 2072 6f75               rou
-00006e20: 6e64 3d72 6f75 6e64 2c0a 2020 2020 2020  nd=round,.      
-00006e30: 2020 2020 2020 2020 2020 6372 6f73 735f            cross_
-00006e40: 7661 6c69 6461 7469 6f6e 3d63 726f 7373  validation=cross
-00006e50: 5f76 616c 6964 6174 696f 6e2c 0a20 2020  _validation,.   
-00006e60: 2020 2020 2020 2020 2020 2020 2066 6974               fit
-00006e70: 5f6b 7761 7267 733d 6669 745f 6b77 6172  _kwargs=fit_kwar
-00006e80: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
-00006e90: 2020 2020 6772 6f75 7073 3d67 726f 7570      groups=group
-00006ea0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00006eb0: 2020 2070 726f 6261 6269 6c69 7479 5f74     probability_t
-00006ec0: 6872 6573 686f 6c64 3d70 726f 6261 6269  hreshold=probabi
-00006ed0: 6c69 7479 5f74 6872 6573 686f 6c64 2c0a  lity_threshold,.
-00006ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006ef0: 7265 6669 743d 4661 6c73 652c 0a20 2020  refit=False,.   
-00006f00: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00006f10: 2020 2020 2020 2072 6573 756c 7473 5f63         results_c
-00006f20: 6f6c 756d 6e73 5f74 6f5f 6967 6e6f 7265  olumns_to_ignore
-00006f30: 203d 205b 224f 626a 6563 7422 2c20 2272   = ["Object", "r
-00006f40: 756e 7469 6d65 222c 2022 6375 746f 6666  untime", "cutoff
-00006f50: 225d 0a20 2020 2020 2020 2020 2020 2069  "].            i
-00006f60: 6620 6572 726f 7273 203d 3d20 2272 6169  f errors == "rai
-00006f70: 7365 223a 0a20 2020 2020 2020 2020 2020  se":.           
-00006f80: 2020 2020 206d 6f64 656c 2c20 6d6f 6465       model, mode
-00006f90: 6c5f 6669 745f 7469 6d65 203d 2073 656c  l_fit_time = sel
-00006fa0: 662e 5f63 7265 6174 655f 6d6f 6465 6c28  f._create_model(
-00006fb0: 2a2a 6372 6561 7465 5f6d 6f64 656c 5f61  **create_model_a
-00006fc0: 7267 7329 0a20 2020 2020 2020 2020 2020  rgs).           
-00006fd0: 2020 2020 206d 6f64 656c 5f72 6573 756c       model_resul
-00006fe0: 7473 203d 2073 656c 662e 7075 6c6c 2870  ts = self.pull(p
-00006ff0: 6f70 3d54 7275 6529 0a20 2020 2020 2020  op=True).       
-00007000: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00007010: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+00006d30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d22 0a20 2020  ===========".   
+00006d40: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00006d50: 2020 2020 2020 2063 7265 6174 655f 6d6f         create_mo
+00006d60: 6465 6c5f 6172 6773 203d 2064 6963 7428  del_args = dict(
+00006d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006d80: 2065 7374 696d 6174 6f72 3d6d 6f64 656c   estimator=model
+00006d90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00006da0: 2020 7379 7374 656d 3d46 616c 7365 2c0a    system=False,.
+00006db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006dc0: 7665 7262 6f73 653d 4661 6c73 652c 0a20  verbose=False,. 
+00006dd0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00006de0: 6973 706c 6179 3d64 6973 706c 6179 2c0a  isplay=display,.
+00006df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006e00: 666f 6c64 3d66 6f6c 642c 0a20 2020 2020  fold=fold,.     
+00006e10: 2020 2020 2020 2020 2020 2072 6f75 6e64             round
+00006e20: 3d72 6f75 6e64 2c0a 2020 2020 2020 2020  =round,.        
+00006e30: 2020 2020 2020 2020 6372 6f73 735f 7661          cross_va
+00006e40: 6c69 6461 7469 6f6e 3d63 726f 7373 5f76  lidation=cross_v
+00006e50: 616c 6964 6174 696f 6e2c 0a20 2020 2020  alidation,.     
+00006e60: 2020 2020 2020 2020 2020 2066 6974 5f6b             fit_k
+00006e70: 7761 7267 733d 6669 745f 6b77 6172 6773  wargs=fit_kwargs
+00006e80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00006e90: 2020 6772 6f75 7073 3d67 726f 7570 732c    groups=groups,
+00006ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006eb0: 2070 726f 6261 6269 6c69 7479 5f74 6872   probability_thr
+00006ec0: 6573 686f 6c64 3d70 726f 6261 6269 6c69  eshold=probabili
+00006ed0: 7479 5f74 6872 6573 686f 6c64 2c0a 2020  ty_threshold,.  
+00006ee0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00006ef0: 6669 743d 4661 6c73 652c 0a20 2020 2020  fit=False,.     
+00006f00: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00006f10: 2020 2020 2072 6573 756c 7473 5f63 6f6c       results_col
+00006f20: 756d 6e73 5f74 6f5f 6967 6e6f 7265 203d  umns_to_ignore =
+00006f30: 205b 224f 626a 6563 7422 2c20 2272 756e   ["Object", "run
+00006f40: 7469 6d65 222c 2022 6375 746f 6666 225d  time", "cutoff"]
+00006f50: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00006f60: 6572 726f 7273 203d 3d20 2272 6169 7365  errors == "raise
+00006f70: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
+00006f80: 2020 206d 6f64 656c 2c20 6d6f 6465 6c5f     model, model_
+00006f90: 6669 745f 7469 6d65 203d 2073 656c 662e  fit_time = self.
+00006fa0: 5f63 7265 6174 655f 6d6f 6465 6c28 2a2a  _create_model(**
+00006fb0: 6372 6561 7465 5f6d 6f64 656c 5f61 7267  create_model_arg
+00006fc0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+00006fd0: 2020 206d 6f64 656c 5f72 6573 756c 7473     model_results
+00006fe0: 203d 2073 656c 662e 7075 6c6c 2870 6f70   = self.pull(pop
+00006ff0: 3d54 7275 6529 0a20 2020 2020 2020 2020  =True).         
+00007000: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00007010: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
 00007020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007030: 2020 2020 6d6f 6465 6c2c 206d 6f64 656c      model, model
-00007040: 5f66 6974 5f74 696d 6520 3d20 7365 6c66  _fit_time = self
-00007050: 2e5f 6372 6561 7465 5f6d 6f64 656c 282a  ._create_model(*
-00007060: 2a63 7265 6174 655f 6d6f 6465 6c5f 6172  *create_model_ar
-00007070: 6773 290a 2020 2020 2020 2020 2020 2020  gs).            
-00007080: 2020 2020 2020 2020 6d6f 6465 6c5f 7265          model_re
-00007090: 7375 6c74 7320 3d20 7365 6c66 2e70 756c  sults = self.pul
-000070a0: 6c28 706f 703d 5472 7565 290a 2020 2020  l(pop=True).    
-000070b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000070c0: 6173 7365 7274 2028 0a20 2020 2020 2020  assert (.       
-000070d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000070e0: 206e 702e 7375 6d28 0a20 2020 2020 2020   np.sum(.       
+00007030: 2020 6d6f 6465 6c2c 206d 6f64 656c 5f66    model, model_f
+00007040: 6974 5f74 696d 6520 3d20 7365 6c66 2e5f  it_time = self._
+00007050: 6372 6561 7465 5f6d 6f64 656c 282a 2a63  create_model(**c
+00007060: 7265 6174 655f 6d6f 6465 6c5f 6172 6773  reate_model_args
+00007070: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00007080: 2020 2020 2020 6d6f 6465 6c5f 7265 7375        model_resu
+00007090: 6c74 7320 3d20 7365 6c66 2e70 756c 6c28  lts = self.pull(
+000070a0: 706f 703d 5472 7565 290a 2020 2020 2020  pop=True).      
+000070b0: 2020 2020 2020 2020 2020 2020 2020 6173                as
+000070c0: 7365 7274 2028 0a20 2020 2020 2020 2020  sert (.         
+000070d0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+000070e0: 702e 7375 6d28 0a20 2020 2020 2020 2020  p.sum(.         
 000070f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007100: 2020 2020 206d 6f64 656c 5f72 6573 756c       model_resul
-00007110: 7473 2e64 726f 7028 0a20 2020 2020 2020  ts.drop(.       
+00007100: 2020 206d 6f64 656c 5f72 6573 756c 7473     model_results
+00007110: 2e64 726f 7028 0a20 2020 2020 2020 2020  .drop(.         
 00007120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007130: 2020 2020 2020 2020 2072 6573 756c 7473           results
-00007140: 5f63 6f6c 756d 6e73 5f74 6f5f 6967 6e6f  _columns_to_igno
-00007150: 7265 2c20 6178 6973 3d31 2c20 6572 726f  re, axis=1, erro
-00007160: 7273 3d22 6967 6e6f 7265 220a 2020 2020  rs="ignore".    
+00007130: 2020 2020 2020 2072 6573 756c 7473 5f63         results_c
+00007140: 6f6c 756d 6e73 5f74 6f5f 6967 6e6f 7265  olumns_to_ignore
+00007150: 2c20 6178 6973 3d31 2c20 6572 726f 7273  , axis=1, errors
+00007160: 3d22 6967 6e6f 7265 220a 2020 2020 2020  ="ignore".      
 00007170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007180: 2020 2020 2020 2020 292e 696c 6f63 5b30          ).iloc[0
-00007190: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-000071a0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00007180: 2020 2020 2020 292e 696c 6f63 5b30 5d0a        ).iloc[0].
+00007190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000071a0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
 000071b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000071c0: 2020 2020 213d 2030 2e30 0a20 2020 2020      != 0.0.     
-000071d0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000071e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000071f0: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
-00007200: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
-00007210: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
-00007220: 6572 2e77 6172 6e69 6e67 280a 2020 2020  er.warning(.    
+000071c0: 2020 213d 2030 2e30 0a20 2020 2020 2020    != 0.0.       
+000071d0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+000071e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000071f0: 7863 6570 7420 4578 6365 7074 696f 6e3a  xcept Exception:
+00007200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007210: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
+00007220: 2e77 6172 6e69 6e67 280a 2020 2020 2020  .warning(.      
 00007230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007240: 2020 2020 6622 6372 6561 7465 5f6d 6f64      f"create_mod
-00007250: 656c 2829 2066 6f72 207b 6d6f 6465 6c7d  el() for {model}
-00007260: 2072 6169 7365 6420 616e 2065 7863 6570   raised an excep
-00007270: 7469 6f6e 206f 7220 7265 7475 726e 6564  tion or returned
-00007280: 2061 6c6c 2030 2e30 2c20 7472 7969 6e67   all 0.0, trying
-00007290: 2077 6974 686f 7574 2066 6974 5f6b 7761   without fit_kwa
-000072a0: 7267 733a 220a 2020 2020 2020 2020 2020  rgs:".          
-000072b0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000072c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000072d0: 7365 6c66 2e6c 6f67 6765 722e 7761 726e  self.logger.warn
-000072e0: 696e 6728 7472 6163 6562 6163 6b2e 666f  ing(traceback.fo
-000072f0: 726d 6174 5f65 7863 2829 290a 2020 2020  rmat_exc()).    
-00007300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007310: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-00007320: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-00007330: 656c 2c20 6d6f 6465 6c5f 6669 745f 7469  el, model_fit_ti
-00007340: 6d65 203d 2073 656c 662e 5f63 7265 6174  me = self._creat
-00007350: 655f 6d6f 6465 6c28 2a2a 6372 6561 7465  e_model(**create
-00007360: 5f6d 6f64 656c 5f61 7267 7329 0a20 2020  _model_args).   
+00007240: 2020 6622 6372 6561 7465 5f6d 6f64 656c    f"create_model
+00007250: 2829 2066 6f72 207b 6d6f 6465 6c7d 2072  () for {model} r
+00007260: 6169 7365 6420 616e 2065 7863 6570 7469  aised an excepti
+00007270: 6f6e 206f 7220 7265 7475 726e 6564 2061  on or returned a
+00007280: 6c6c 2030 2e30 2c20 7472 7969 6e67 2077  ll 0.0, trying w
+00007290: 6974 686f 7574 2066 6974 5f6b 7761 7267  ithout fit_kwarg
+000072a0: 733a 220a 2020 2020 2020 2020 2020 2020  s:".            
+000072b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000072c0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000072d0: 6c66 2e6c 6f67 6765 722e 7761 726e 696e  lf.logger.warnin
+000072e0: 6728 7472 6163 6562 6163 6b2e 666f 726d  g(traceback.form
+000072f0: 6174 5f65 7863 2829 290a 2020 2020 2020  at_exc()).      
+00007300: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+00007310: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00007320: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+00007330: 2c20 6d6f 6465 6c5f 6669 745f 7469 6d65  , model_fit_time
+00007340: 203d 2073 656c 662e 5f63 7265 6174 655f   = self._create_
+00007350: 6d6f 6465 6c28 2a2a 6372 6561 7465 5f6d  model(**create_m
+00007360: 6f64 656c 5f61 7267 7329 0a20 2020 2020  odel_args).     
 00007370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007380: 2020 2020 206d 6f64 656c 5f72 6573 756c       model_resul
-00007390: 7473 203d 2073 656c 662e 7075 6c6c 2870  ts = self.pull(p
-000073a0: 6f70 3d54 7275 6529 0a20 2020 2020 2020  op=True).       
-000073b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000073c0: 2061 7373 6572 7420 280a 2020 2020 2020   assert (.      
+00007380: 2020 206d 6f64 656c 5f72 6573 756c 7473     model_results
+00007390: 203d 2073 656c 662e 7075 6c6c 2870 6f70   = self.pull(pop
+000073a0: 3d54 7275 6529 0a20 2020 2020 2020 2020  =True).         
+000073b0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000073c0: 7373 6572 7420 280a 2020 2020 2020 2020  ssert (.        
 000073d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000073e0: 2020 2020 2020 6e70 2e73 756d 280a 2020        np.sum(.  
+000073e0: 2020 2020 6e70 2e73 756d 280a 2020 2020      np.sum(.    
 000073f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007400: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-00007410: 6465 6c5f 7265 7375 6c74 732e 6472 6f70  del_results.drop
-00007420: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00007400: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+00007410: 6c5f 7265 7375 6c74 732e 6472 6f70 280a  l_results.drop(.
+00007420: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00007430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007440: 2020 2020 2020 7265 7375 6c74 735f 636f        results_co
-00007450: 6c75 6d6e 735f 746f 5f69 676e 6f72 652c  lumns_to_ignore,
-00007460: 2061 7869 733d 312c 2065 7272 6f72 733d   axis=1, errors=
-00007470: 2269 676e 6f72 6522 0a20 2020 2020 2020  "ignore".       
+00007440: 2020 2020 7265 7375 6c74 735f 636f 6c75      results_colu
+00007450: 6d6e 735f 746f 5f69 676e 6f72 652c 2061  mns_to_ignore, a
+00007460: 7869 733d 312c 2065 7272 6f72 733d 2269  xis=1, errors="i
+00007470: 676e 6f72 6522 0a20 2020 2020 2020 2020  gnore".         
 00007480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007490: 2020 2020 2020 2020 2029 2e69 6c6f 635b           ).iloc[
-000074a0: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
-000074b0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000074c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000074d0: 2020 2020 2020 2020 2020 2020 2021 3d20               != 
-000074e0: 302e 300a 2020 2020 2020 2020 2020 2020  0.0.            
-000074f0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00007490: 2020 2020 2020 2029 2e69 6c6f 635b 305d         ).iloc[0]
+000074a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000074b0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+000074c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000074d0: 2020 2020 2020 2020 2020 2021 3d20 302e             != 0.
+000074e0: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
+000074f0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
 00007500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007510: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
-00007520: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-00007530: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00007540: 2e6c 6f67 6765 722e 6572 726f 7228 0a20  .logger.error(. 
+00007510: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
+00007520: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00007530: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+00007540: 6f67 6765 722e 6572 726f 7228 0a20 2020  ogger.error(.   
 00007550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007560: 2020 2020 2020 2020 2020 2066 2263 7265             f"cre
-00007570: 6174 655f 6d6f 6465 6c28 2920 666f 7220  ate_model() for 
-00007580: 7b6d 6f64 656c 7d20 7261 6973 6564 2061  {model} raised a
-00007590: 6e20 6578 6365 7074 696f 6e20 6f72 2072  n exception or r
-000075a0: 6574 7572 6e65 6420 616c 6c20 302e 303a  eturned all 0.0:
-000075b0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-000075c0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00007560: 2020 2020 2020 2020 2066 2263 7265 6174           f"creat
+00007570: 655f 6d6f 6465 6c28 2920 666f 7220 7b6d  e_model() for {m
+00007580: 6f64 656c 7d20 7261 6973 6564 2061 6e20  odel} raised an 
+00007590: 6578 6365 7074 696f 6e20 6f72 2072 6574  exception or ret
+000075a0: 7572 6e65 6420 616c 6c20 302e 303a 220a  urned all 0.0:".
+000075b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000075c0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
 000075d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000075e0: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
-000075f0: 6572 726f 7228 7472 6163 6562 6163 6b2e  error(traceback.
-00007600: 666f 726d 6174 5f65 7863 2829 290a 2020  format_exc()).  
+000075e0: 2020 7365 6c66 2e6c 6f67 6765 722e 6572    self.logger.er
+000075f0: 726f 7228 7472 6163 6562 6163 6b2e 666f  ror(traceback.fo
+00007600: 726d 6174 5f65 7863 2829 290a 2020 2020  rmat_exc()).    
 00007610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007620: 2020 2020 2020 636f 6e74 696e 7565 0a20        continue. 
-00007630: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00007640: 6c6f 6767 6572 2e69 6e66 6f28 0a20 2020  logger.info(.   
-00007650: 2020 2020 2020 2020 2020 2020 2022 5375               "Su
-00007660: 6250 726f 6365 7373 2063 7265 6174 655f  bProcess create_
-00007670: 6d6f 6465 6c28 2920 656e 6420 3d3d 3d3d  model() end ====
+00007620: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
+00007630: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
+00007640: 6767 6572 2e69 6e66 6f28 0a20 2020 2020  gger.info(.     
+00007650: 2020 2020 2020 2020 2020 2022 5375 6250             "SubP
+00007660: 726f 6365 7373 2063 7265 6174 655f 6d6f  rocess create_mo
+00007670: 6465 6c28 2920 656e 6420 3d3d 3d3d 3d3d  del() end ======
 00007680: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00007690: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 220a  ==============".
-000076a0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-000076b0: 2020 2020 2020 2020 2020 2069 6620 6d6f             if mo
-000076c0: 6465 6c20 6973 204e 6f6e 653a 0a20 2020  del is None:.   
-000076d0: 2020 2020 2020 2020 2020 2020 206f 7665               ove
-000076e0: 725f 7469 6d65 5f62 7564 6765 7420 3d20  r_time_budget = 
-000076f0: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
-00007700: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
-00007710: 2e69 6e66 6f28 0a20 2020 2020 2020 2020  .info(.         
-00007720: 2020 2020 2020 2020 2020 2022 5469 6d65             "Time
-00007730: 2062 7564 6765 6420 6578 6365 6564 6564   budged exceeded
-00007740: 2069 6e20 6372 6561 7465 5f6d 6f64 656c   in create_model
-00007750: 2829 2c20 6272 6561 6b69 6e67 206c 6f6f  (), breaking loo
-00007760: 7022 0a20 2020 2020 2020 2020 2020 2020  p".             
-00007770: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00007780: 2020 2020 2062 7265 616b 0a0a 2020 2020       break..    
-00007790: 2020 2020 2020 2020 7275 6e74 696d 655f          runtime_
-000077a0: 656e 6420 3d20 7469 6d65 2e74 696d 6528  end = time.time(
-000077b0: 290a 2020 2020 2020 2020 2020 2020 7275  ).            ru
-000077c0: 6e74 696d 6520 3d20 6e70 2e61 7272 6179  ntime = np.array
-000077d0: 2872 756e 7469 6d65 5f65 6e64 202d 2072  (runtime_end - r
-000077e0: 756e 7469 6d65 5f73 7461 7274 292e 726f  untime_start).ro
-000077f0: 756e 6428 3229 0a0a 2020 2020 2020 2020  und(2)..        
-00007800: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
-00007810: 696e 666f 2822 4372 6561 7469 6e67 206d  info("Creating m
-00007820: 6574 7269 6373 2064 6174 6166 7261 6d65  etrics dataframe
-00007830: 2229 0a20 2020 2020 2020 2020 2020 2069  ").            i
-00007840: 6620 6372 6f73 735f 7661 6c69 6461 7469  f cross_validati
-00007850: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-00007860: 2020 2020 2320 6375 746f 6666 206f 6e6c      # cutoff onl
-00007870: 7920 7072 6573 656e 7420 696e 2074 696d  y present in tim
-00007880: 6520 7365 7269 6573 2061 6e64 2077 6865  e series and whe
-00007890: 6e20 6376 203d 2054 7275 650a 2020 2020  n cv = True.    
-000078a0: 2020 2020 2020 2020 2020 2020 6966 2022              if "
-000078b0: 6375 746f 6666 2220 696e 206d 6f64 656c  cutoff" in model
-000078c0: 5f72 6573 756c 7473 2e63 6f6c 756d 6e73  _results.columns
-000078d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000078e0: 2020 2020 2020 6d6f 6465 6c5f 7265 7375        model_resu
-000078f0: 6c74 732e 6472 6f70 2822 6375 746f 6666  lts.drop("cutoff
-00007900: 222c 2061 7869 733d 312c 2065 7272 6f72  ", axis=1, error
-00007910: 733d 2269 676e 6f72 6522 290a 2020 2020  s="ignore").    
-00007920: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-00007930: 6172 655f 6d6f 6465 6c73 5f20 3d20 7064  are_models_ = pd
-00007940: 2e44 6174 6146 7261 6d65 280a 2020 2020  .DataFrame(.    
-00007950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007960: 6d6f 6465 6c5f 7265 7375 6c74 732e 6c6f  model_results.lo
-00007970: 635b 0a20 2020 2020 2020 2020 2020 2020  c[.             
-00007980: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00007990: 5f67 6574 5f72 6574 7572 6e5f 7472 6169  _get_return_trai
-000079a0: 6e5f 7363 6f72 655f 696e 6469 6365 735f  n_score_indices_
-000079b0: 666f 725f 6c6f 6767 696e 6728 0a20 2020  for_logging(.   
+00007690: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 220a 2020  ============".  
+000076a0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+000076b0: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
+000076c0: 6c20 6973 204e 6f6e 653a 0a20 2020 2020  l is None:.     
+000076d0: 2020 2020 2020 2020 2020 206f 7665 725f             over_
+000076e0: 7469 6d65 5f62 7564 6765 7420 3d20 5472  time_budget = Tr
+000076f0: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
+00007700: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
+00007710: 6e66 6f28 0a20 2020 2020 2020 2020 2020  nfo(.           
+00007720: 2020 2020 2020 2020 2022 5469 6d65 2062           "Time b
+00007730: 7564 6765 6420 6578 6365 6564 6564 2069  udged exceeded i
+00007740: 6e20 6372 6561 7465 5f6d 6f64 656c 2829  n create_model()
+00007750: 2c20 6272 6561 6b69 6e67 206c 6f6f 7022  , breaking loop"
+00007760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007770: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+00007780: 2020 2062 7265 616b 0a0a 2020 2020 2020     break..      
+00007790: 2020 2020 2020 7275 6e74 696d 655f 656e        runtime_en
+000077a0: 6420 3d20 7469 6d65 2e74 696d 6528 290a  d = time.time().
+000077b0: 2020 2020 2020 2020 2020 2020 7275 6e74              runt
+000077c0: 696d 6520 3d20 6e70 2e61 7272 6179 2872  ime = np.array(r
+000077d0: 756e 7469 6d65 5f65 6e64 202d 2072 756e  untime_end - run
+000077e0: 7469 6d65 5f73 7461 7274 292e 726f 756e  time_start).roun
+000077f0: 6428 3229 0a0a 2020 2020 2020 2020 2020  d(2)..          
+00007800: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
+00007810: 666f 2822 4372 6561 7469 6e67 206d 6574  fo("Creating met
+00007820: 7269 6373 2064 6174 6166 7261 6d65 2229  rics dataframe")
+00007830: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00007840: 6372 6f73 735f 7661 6c69 6461 7469 6f6e  cross_validation
+00007850: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00007860: 2020 2320 6375 746f 6666 206f 6e6c 7920    # cutoff only 
+00007870: 7072 6573 656e 7420 696e 2074 696d 6520  present in time 
+00007880: 7365 7269 6573 2061 6e64 2077 6865 6e20  series and when 
+00007890: 6376 203d 2054 7275 650a 2020 2020 2020  cv = True.      
+000078a0: 2020 2020 2020 2020 2020 6966 2022 6375            if "cu
+000078b0: 746f 6666 2220 696e 206d 6f64 656c 5f72  toff" in model_r
+000078c0: 6573 756c 7473 2e63 6f6c 756d 6e73 3a0a  esults.columns:.
+000078d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000078e0: 2020 2020 6d6f 6465 6c5f 7265 7375 6c74      model_result
+000078f0: 732e 6472 6f70 2822 6375 746f 6666 222c  s.drop("cutoff",
+00007900: 2061 7869 733d 312c 2065 7272 6f72 733d   axis=1, errors=
+00007910: 2269 676e 6f72 6522 290a 2020 2020 2020  "ignore").      
+00007920: 2020 2020 2020 2020 2020 636f 6d70 6172            compar
+00007930: 655f 6d6f 6465 6c73 5f20 3d20 7064 2e44  e_models_ = pd.D
+00007940: 6174 6146 7261 6d65 280a 2020 2020 2020  ataFrame(.      
+00007950: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+00007960: 6465 6c5f 7265 7375 6c74 732e 6c6f 635b  del_results.loc[
+00007970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007980: 2020 2020 2020 2020 2073 656c 662e 5f67           self._g
+00007990: 6574 5f72 6574 7572 6e5f 7472 6169 6e5f  et_return_train_
+000079a0: 7363 6f72 655f 696e 6469 6365 735f 666f  score_indices_fo
+000079b0: 725f 6c6f 6767 696e 6728 0a20 2020 2020  r_logging(.     
 000079c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000079d0: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
-000079e0: 7472 6169 6e5f 7363 6f72 653d 4661 6c73  train_score=Fals
-000079f0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00007a00: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00007a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007a20: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00007a30: 2020 292e 542e 7265 7365 745f 696e 6465    ).T.reset_inde
-00007a40: 7828 6472 6f70 3d54 7275 6529 0a20 2020  x(drop=True).   
-00007a50: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00007a60: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00007a70: 6f6d 7061 7265 5f6d 6f64 656c 735f 203d  ompare_models_ =
-00007a80: 2070 642e 4461 7461 4672 616d 6528 6d6f   pd.DataFrame(mo
-00007a90: 6465 6c5f 7265 7375 6c74 732e 696c 6f63  del_results.iloc
-00007aa0: 5b30 5d29 2e54 0a20 2020 2020 2020 2020  [0]).T.         
-00007ab0: 2020 2063 6f6d 7061 7265 5f6d 6f64 656c     compare_model
-00007ac0: 735f 2e69 6e73 6572 7428 0a20 2020 2020  s_.insert(.     
-00007ad0: 2020 2020 2020 2020 2020 206c 656e 2863             len(c
-00007ae0: 6f6d 7061 7265 5f6d 6f64 656c 735f 2e63  ompare_models_.c
-00007af0: 6f6c 756d 6e73 292c 2022 5454 2028 5365  olumns), "TT (Se
-00007b00: 6329 222c 206d 6f64 656c 5f66 6974 5f74  c)", model_fit_t
-00007b10: 696d 650a 2020 2020 2020 2020 2020 2020  ime.            
-00007b20: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
-00007b30: 6d70 6172 655f 6d6f 6465 6c73 5f2e 696e  mpare_models_.in
-00007b40: 7365 7274 2830 2c20 224d 6f64 656c 222c  sert(0, "Model",
-00007b50: 206d 6f64 656c 5f6e 616d 6529 0a20 2020   model_name).   
-00007b60: 2020 2020 2020 2020 2063 6f6d 7061 7265           compare
-00007b70: 5f6d 6f64 656c 735f 2e69 6e73 6572 7428  _models_.insert(
-00007b80: 302c 2022 4f62 6a65 6374 222c 205b 6d6f  0, "Object", [mo
-00007b90: 6465 6c5d 290a 2020 2020 2020 2020 2020  del]).          
-00007ba0: 2020 636f 6d70 6172 655f 6d6f 6465 6c73    compare_models
-00007bb0: 5f2e 696e 7365 7274 2830 2c20 2272 756e  _.insert(0, "run
-00007bc0: 7469 6d65 222c 2072 756e 7469 6d65 290a  time", runtime).
-00007bd0: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-00007be0: 6172 655f 6d6f 6465 6c73 5f2e 696e 6465  are_models_.inde
-00007bf0: 7820 3d20 5b6d 6f64 656c 5f69 645d 0a20  x = [model_id]. 
-00007c00: 2020 2020 2020 2020 2020 2069 6620 6d61             if ma
-00007c10: 7374 6572 5f64 6973 706c 6179 2069 7320  ster_display is 
-00007c20: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00007c30: 2020 2020 2020 6d61 7374 6572 5f64 6973        master_dis
-00007c40: 706c 6179 203d 2063 6f6d 7061 7265 5f6d  play = compare_m
-00007c50: 6f64 656c 735f 0a20 2020 2020 2020 2020  odels_.         
-00007c60: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00007c70: 2020 2020 2020 2020 206d 6173 7465 725f           master_
-00007c80: 6469 7370 6c61 7920 3d20 7064 2e63 6f6e  display = pd.con
-00007c90: 6361 7428 0a20 2020 2020 2020 2020 2020  cat(.           
-00007ca0: 2020 2020 2020 2020 205b 6d61 7374 6572           [master
-00007cb0: 5f64 6973 706c 6179 2c20 636f 6d70 6172  _display, compar
-00007cc0: 655f 6d6f 6465 6c73 5f5d 2c20 6967 6e6f  e_models_], igno
-00007cd0: 7265 5f69 6e64 6578 3d46 616c 7365 0a20  re_index=False. 
-00007ce0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00007cf0: 0a20 2020 2020 2020 2020 2020 206d 6173  .            mas
-00007d00: 7465 725f 6469 7370 6c61 7920 3d20 6d61  ter_display = ma
-00007d10: 7374 6572 5f64 6973 706c 6179 2e72 6f75  ster_display.rou
-00007d20: 6e64 2872 6f75 6e64 290a 2020 2020 2020  nd(round).      
-00007d30: 2020 2020 2020 6966 2073 656c 662e 5f6d        if self._m
-00007d40: 6c5f 7573 6563 6173 6520 213d 204d 4c55  l_usecase != MLU
-00007d50: 7365 6361 7365 2e54 494d 455f 5345 5249  secase.TIME_SERI
-00007d60: 4553 3a0a 2020 2020 2020 2020 2020 2020  ES:.            
-00007d70: 2020 2020 6d61 7374 6572 5f64 6973 706c      master_displ
-00007d80: 6179 203d 206d 6173 7465 725f 6469 7370  ay = master_disp
-00007d90: 6c61 792e 736f 7274 5f76 616c 7565 7328  lay.sort_values(
-00007da0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007db0: 2020 2020 2062 793d 736f 7274 2c20 6173       by=sort, as
-00007dc0: 6365 6e64 696e 673d 736f 7274 5f61 7363  cending=sort_asc
-00007dd0: 656e 6469 6e67 0a20 2020 2020 2020 2020  ending.         
-00007de0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00007df0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00007e00: 2020 2020 2020 2020 2020 206d 6173 7465             maste
-00007e10: 725f 6469 7370 6c61 7920 3d20 6d61 7374  r_display = mast
-00007e20: 6572 5f64 6973 706c 6179 2e73 6f72 745f  er_display.sort_
-00007e30: 7661 6c75 6573 280a 2020 2020 2020 2020  values(.        
-00007e40: 2020 2020 2020 2020 2020 2020 6279 3d73              by=s
-00007e50: 6f72 742e 7570 7065 7228 292c 2061 7363  ort.upper(), asc
-00007e60: 656e 6469 6e67 3d73 6f72 745f 6173 6365  ending=sort_asce
-00007e70: 6e64 696e 670a 2020 2020 2020 2020 2020  nding.          
-00007e80: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00007e90: 2020 2020 206d 6173 7465 725f 6469 7370       master_disp
-00007ea0: 6c61 795f 203d 206d 6173 7465 725f 6469  lay_ = master_di
-00007eb0: 7370 6c61 792e 6472 6f70 280a 2020 2020  splay.drop(.    
-00007ec0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00007ed0: 6c74 735f 636f 6c75 6d6e 735f 746f 5f69  lts_columns_to_i
-00007ee0: 676e 6f72 652c 2061 7869 733d 312c 2065  gnore, axis=1, e
-00007ef0: 7272 6f72 733d 2269 676e 6f72 6522 0a20  rrors="ignore". 
-00007f00: 2020 2020 2020 2020 2020 2029 2e73 7479             ).sty
-00007f10: 6c65 2e66 6f72 6d61 7428 7072 6563 6973  le.format(precis
-00007f20: 696f 6e3d 726f 756e 6429 0a20 2020 2020  ion=round).     
-00007f30: 2020 2020 2020 206d 6173 7465 725f 6469         master_di
-00007f40: 7370 6c61 795f 203d 206d 6173 7465 725f  splay_ = master_
-00007f50: 6469 7370 6c61 795f 2e73 6574 5f70 726f  display_.set_pro
-00007f60: 7065 7274 6965 7328 2a2a 7b22 7465 7874  perties(**{"text
-00007f70: 2d61 6c69 676e 223a 2022 6c65 6674 227d  -align": "left"}
-00007f80: 290a 2020 2020 2020 2020 2020 2020 6d61  ).            ma
-00007f90: 7374 6572 5f64 6973 706c 6179 5f20 3d20  ster_display_ = 
-00007fa0: 6d61 7374 6572 5f64 6973 706c 6179 5f2e  master_display_.
-00007fb0: 7365 745f 7461 626c 655f 7374 796c 6573  set_table_styles
-00007fc0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00007fd0: 2020 5b64 6963 7428 7365 6c65 6374 6f72    [dict(selector
-00007fe0: 3d22 7468 222c 2070 726f 7073 3d5b 2822  ="th", props=[("
-00007ff0: 7465 7874 2d61 6c69 676e 222c 2022 6c65  text-align", "le
-00008000: 6674 2229 5d29 5d0a 2020 2020 2020 2020  ft")])].        
-00008010: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-00008020: 2020 2069 6620 6469 7370 6c61 792e 6361     if display.ca
-00008030: 6e5f 7570 6461 7465 5f74 6578 743a 0a20  n_update_text:. 
-00008040: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00008050: 6973 706c 6179 2e64 6973 706c 6179 286d  isplay.display(m
-00008060: 6173 7465 725f 6469 7370 6c61 795f 2c20  aster_display_, 
-00008070: 6669 6e61 6c5f 6469 7370 6c61 793d 4661  final_display=Fa
-00008080: 6c73 6529 0a0a 2020 2020 2020 2020 6469  lse)..        di
-00008090: 7370 6c61 792e 6d6f 7665 5f70 726f 6772  splay.move_progr
-000080a0: 6573 7328 290a 0a20 2020 2020 2020 2063  ess()..        c
-000080b0: 6f6d 7061 7265 5f6d 6f64 656c 735f 203d  ompare_models_ =
-000080c0: 2073 656c 662e 5f68 6967 686c 6967 6874   self._highlight
-000080d0: 5f6d 6f64 656c 7328 6d61 7374 6572 5f64  _models(master_d
-000080e0: 6973 706c 6179 5f29 0a0a 2020 2020 2020  isplay_)..      
-000080f0: 2020 6469 7370 6c61 792e 7570 6461 7465    display.update
-00008100: 5f6d 6f6e 6974 6f72 2831 2c20 2243 6f6d  _monitor(1, "Com
-00008110: 7069 6c69 6e67 2046 696e 616c 204d 6f64  piling Final Mod
-00008120: 656c 7322 290a 0a20 2020 2020 2020 2064  els")..        d
-00008130: 6973 706c 6179 2e6d 6f76 655f 7072 6f67  isplay.move_prog
-00008140: 7265 7373 2829 0a0a 2020 2020 2020 2020  ress()..        
-00008150: 736f 7274 6564 5f6d 6f64 656c 7320 3d20  sorted_models = 
-00008160: 5b5d 0a0a 2020 2020 2020 2020 6966 206d  []..        if m
-00008170: 6173 7465 725f 6469 7370 6c61 7920 6973  aster_display is
-00008180: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00008190: 2020 2020 2020 2063 6c61 6d70 6564 5f6e         clamped_n
-000081a0: 5f73 656c 6563 7420 3d20 6d69 6e28 6c65  _select = min(le
-000081b0: 6e28 6d61 7374 6572 5f64 6973 706c 6179  n(master_display
-000081c0: 292c 2061 6273 286e 5f73 656c 6563 7429  ), abs(n_select)
-000081d0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-000081e0: 206e 5f73 656c 6563 7420 3c20 303a 0a20   n_select < 0:. 
-000081f0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00008200: 5f73 656c 6563 745f 7261 6e67 6520 3d20  _select_range = 
-00008210: 7261 6e67 6528 0a20 2020 2020 2020 2020  range(.         
-00008220: 2020 2020 2020 2020 2020 206c 656e 286d             len(m
-00008230: 6173 7465 725f 6469 7370 6c61 7929 202d  aster_display) -
-00008240: 2063 6c61 6d70 6564 5f6e 5f73 656c 6563   clamped_n_selec
-00008250: 742c 206c 656e 286d 6173 7465 725f 6469  t, len(master_di
-00008260: 7370 6c61 7929 0a20 2020 2020 2020 2020  splay).         
-00008270: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00008280: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00008290: 2020 2020 2020 2020 2020 206e 5f73 656c             n_sel
-000082a0: 6563 745f 7261 6e67 6520 3d20 7261 6e67  ect_range = rang
-000082b0: 6528 302c 2063 6c61 6d70 6564 5f6e 5f73  e(0, clamped_n_s
-000082c0: 656c 6563 7429 0a0a 2020 2020 2020 2020  elect)..        
-000082d0: 2020 2020 6966 2073 656c 662e 6c6f 6767      if self.logg
-000082e0: 696e 675f 7061 7261 6d3a 0a20 2020 2020  ing_param:.     
-000082f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00008300: 6c6f 6767 696e 675f 7061 7261 6d2e 6c6f  logging_param.lo
-00008310: 675f 6d6f 6465 6c5f 636f 6d70 6172 6973  g_model_comparis
-00008320: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-00008330: 2020 2020 2020 2020 6d61 7374 6572 5f64          master_d
-00008340: 6973 706c 6179 2c20 2263 6f6d 7061 7265  isplay, "compare
-00008350: 5f6d 6f64 656c 7322 0a20 2020 2020 2020  _models".       
-00008360: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00008370: 2020 2020 2020 2020 666f 7220 696e 6465          for inde
-00008380: 782c 2072 6f77 2069 6e20 656e 756d 6572  x, row in enumer
-00008390: 6174 6528 6d61 7374 6572 5f64 6973 706c  ate(master_displ
-000083a0: 6179 2e69 7465 7272 6f77 7328 2929 3a0a  ay.iterrows()):.
-000083b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000083c0: 5f2c 2072 6f77 203d 2072 6f77 0a20 2020  _, row = row.   
-000083d0: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-000083e0: 656c 203d 2072 6f77 5b22 4f62 6a65 6374  el = row["Object
-000083f0: 225d 0a0a 2020 2020 2020 2020 2020 2020  "]..            
-00008400: 2020 2020 7265 7375 6c74 7320 3d20 726f      results = ro
-00008410: 772e 746f 5f66 7261 6d65 2829 2e54 2e64  w.to_frame().T.d
-00008420: 726f 7028 0a20 2020 2020 2020 2020 2020  rop(.           
-00008430: 2020 2020 2020 2020 205b 224f 626a 6563           ["Objec
-00008440: 7422 2c20 224d 6f64 656c 222c 2022 7275  t", "Model", "ru
-00008450: 6e74 696d 6522 2c20 2254 5420 2853 6563  ntime", "TT (Sec
-00008460: 2922 5d2c 2065 7272 6f72 733d 2269 676e  )"], errors="ign
-00008470: 6f72 6522 2c20 6178 6973 3d31 0a20 2020  ore", axis=1.   
-00008480: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
-00008490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000084a0: 6176 6773 5f64 6963 745f 6c6f 6720 3d20  avgs_dict_log = 
-000084b0: 7b6b 3a20 7620 666f 7220 6b2c 2076 2069  {k: v for k, v i
-000084c0: 6e20 7265 7375 6c74 732e 696c 6f63 5b30  n results.iloc[0
-000084d0: 5d2e 6974 656d 7328 297d 0a0a 2020 2020  ].items()}..    
-000084e0: 2020 2020 2020 2020 2020 2020 6675 6c6c              full
-000084f0: 5f6c 6f67 6769 6e67 203d 2046 616c 7365  _logging = False
-00008500: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008510: 2020 6966 2069 6e64 6578 2069 6e20 6e5f    if index in n_
-00008520: 7365 6c65 6374 5f72 616e 6765 3a0a 2020  select_range:.  
+000079d0: 2020 2020 2020 2072 6574 7572 6e5f 7472         return_tr
+000079e0: 6169 6e5f 7363 6f72 653d 4661 6c73 650a  ain_score=False.
+000079f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007a00: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00007a10: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
+00007a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007a30: 292e 542e 7265 7365 745f 696e 6465 7828  ).T.reset_index(
+00007a40: 6472 6f70 3d54 7275 6529 0a20 2020 2020  drop=True).     
+00007a50: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00007a60: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
+00007a70: 7061 7265 5f6d 6f64 656c 735f 203d 2070  pare_models_ = p
+00007a80: 642e 4461 7461 4672 616d 6528 6d6f 6465  d.DataFrame(mode
+00007a90: 6c5f 7265 7375 6c74 732e 696c 6f63 5b30  l_results.iloc[0
+00007aa0: 5d29 2e54 0a20 2020 2020 2020 2020 2020  ]).T.           
+00007ab0: 2063 6f6d 7061 7265 5f6d 6f64 656c 735f   compare_models_
+00007ac0: 2e69 6e73 6572 7428 0a20 2020 2020 2020  .insert(.       
+00007ad0: 2020 2020 2020 2020 206c 656e 2863 6f6d           len(com
+00007ae0: 7061 7265 5f6d 6f64 656c 735f 2e63 6f6c  pare_models_.col
+00007af0: 756d 6e73 292c 2022 5454 2028 5365 6329  umns), "TT (Sec)
+00007b00: 222c 206d 6f64 656c 5f66 6974 5f74 696d  ", model_fit_tim
+00007b10: 650a 2020 2020 2020 2020 2020 2020 290a  e.            ).
+00007b20: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+00007b30: 6172 655f 6d6f 6465 6c73 5f2e 696e 7365  are_models_.inse
+00007b40: 7274 2830 2c20 224d 6f64 656c 222c 206d  rt(0, "Model", m
+00007b50: 6f64 656c 5f6e 616d 6529 0a20 2020 2020  odel_name).     
+00007b60: 2020 2020 2020 2063 6f6d 7061 7265 5f6d         compare_m
+00007b70: 6f64 656c 735f 2e69 6e73 6572 7428 302c  odels_.insert(0,
+00007b80: 2022 4f62 6a65 6374 222c 205b 6d6f 6465   "Object", [mode
+00007b90: 6c5d 290a 2020 2020 2020 2020 2020 2020  l]).            
+00007ba0: 636f 6d70 6172 655f 6d6f 6465 6c73 5f2e  compare_models_.
+00007bb0: 696e 7365 7274 2830 2c20 2272 756e 7469  insert(0, "runti
+00007bc0: 6d65 222c 2072 756e 7469 6d65 290a 2020  me", runtime).  
+00007bd0: 2020 2020 2020 2020 2020 636f 6d70 6172            compar
+00007be0: 655f 6d6f 6465 6c73 5f2e 696e 6465 7820  e_models_.index 
+00007bf0: 3d20 5b6d 6f64 656c 5f69 645d 0a20 2020  = [model_id].   
+00007c00: 2020 2020 2020 2020 2069 6620 6d61 7374           if mast
+00007c10: 6572 5f64 6973 706c 6179 2069 7320 4e6f  er_display is No
+00007c20: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00007c30: 2020 2020 6d61 7374 6572 5f64 6973 706c      master_displ
+00007c40: 6179 203d 2063 6f6d 7061 7265 5f6d 6f64  ay = compare_mod
+00007c50: 656c 735f 0a20 2020 2020 2020 2020 2020  els_.           
+00007c60: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00007c70: 2020 2020 2020 206d 6173 7465 725f 6469         master_di
+00007c80: 7370 6c61 7920 3d20 7064 2e63 6f6e 6361  splay = pd.conca
+00007c90: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+00007ca0: 2020 2020 2020 205b 6d61 7374 6572 5f64         [master_d
+00007cb0: 6973 706c 6179 2c20 636f 6d70 6172 655f  isplay, compare_
+00007cc0: 6d6f 6465 6c73 5f5d 2c20 6967 6e6f 7265  models_], ignore
+00007cd0: 5f69 6e64 6578 3d46 616c 7365 0a20 2020  _index=False.   
+00007ce0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00007cf0: 2020 2020 2020 2020 2020 206d 6173 7465             maste
+00007d00: 725f 6469 7370 6c61 7920 3d20 6d61 7374  r_display = mast
+00007d10: 6572 5f64 6973 706c 6179 2e72 6f75 6e64  er_display.round
+00007d20: 2872 6f75 6e64 290a 2020 2020 2020 2020  (round).        
+00007d30: 2020 2020 6966 2073 656c 662e 5f6d 6c5f      if self._ml_
+00007d40: 7573 6563 6173 6520 213d 204d 4c55 7365  usecase != MLUse
+00007d50: 6361 7365 2e54 494d 455f 5345 5249 4553  case.TIME_SERIES
+00007d60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00007d70: 2020 6d61 7374 6572 5f64 6973 706c 6179    master_display
+00007d80: 203d 206d 6173 7465 725f 6469 7370 6c61   = master_displa
+00007d90: 792e 736f 7274 5f76 616c 7565 7328 0a20  y.sort_values(. 
+00007da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007db0: 2020 2062 793d 736f 7274 2c20 6173 6365     by=sort, asce
+00007dc0: 6e64 696e 673d 736f 7274 5f61 7363 656e  nding=sort_ascen
+00007dd0: 6469 6e67 0a20 2020 2020 2020 2020 2020  ding.           
+00007de0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00007df0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00007e00: 2020 2020 2020 2020 206d 6173 7465 725f           master_
+00007e10: 6469 7370 6c61 7920 3d20 6d61 7374 6572  display = master
+00007e20: 5f64 6973 706c 6179 2e73 6f72 745f 7661  _display.sort_va
+00007e30: 6c75 6573 280a 2020 2020 2020 2020 2020  lues(.          
+00007e40: 2020 2020 2020 2020 2020 6279 3d73 6f72            by=sor
+00007e50: 742e 7570 7065 7228 292c 2061 7363 656e  t.upper(), ascen
+00007e60: 6469 6e67 3d73 6f72 745f 6173 6365 6e64  ding=sort_ascend
+00007e70: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+00007e80: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00007e90: 2020 206d 6173 7465 725f 6469 7370 6c61     master_displa
+00007ea0: 795f 203d 206d 6173 7465 725f 6469 7370  y_ = master_disp
+00007eb0: 6c61 792e 6472 6f70 280a 2020 2020 2020  lay.drop(.      
+00007ec0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00007ed0: 735f 636f 6c75 6d6e 735f 746f 5f69 676e  s_columns_to_ign
+00007ee0: 6f72 652c 2061 7869 733d 312c 2065 7272  ore, axis=1, err
+00007ef0: 6f72 733d 2269 676e 6f72 6522 0a20 2020  ors="ignore".   
+00007f00: 2020 2020 2020 2020 2029 2e73 7479 6c65           ).style
+00007f10: 2e66 6f72 6d61 7428 7072 6563 6973 696f  .format(precisio
+00007f20: 6e3d 726f 756e 6429 0a20 2020 2020 2020  n=round).       
+00007f30: 2020 2020 206d 6173 7465 725f 6469 7370       master_disp
+00007f40: 6c61 795f 203d 206d 6173 7465 725f 6469  lay_ = master_di
+00007f50: 7370 6c61 795f 2e73 6574 5f70 726f 7065  splay_.set_prope
+00007f60: 7274 6965 7328 2a2a 7b22 7465 7874 2d61  rties(**{"text-a
+00007f70: 6c69 676e 223a 2022 6c65 6674 227d 290a  lign": "left"}).
+00007f80: 2020 2020 2020 2020 2020 2020 6d61 7374              mast
+00007f90: 6572 5f64 6973 706c 6179 5f20 3d20 6d61  er_display_ = ma
+00007fa0: 7374 6572 5f64 6973 706c 6179 5f2e 7365  ster_display_.se
+00007fb0: 745f 7461 626c 655f 7374 796c 6573 280a  t_table_styles(.
+00007fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007fd0: 5b64 6963 7428 7365 6c65 6374 6f72 3d22  [dict(selector="
+00007fe0: 7468 222c 2070 726f 7073 3d5b 2822 7465  th", props=[("te
+00007ff0: 7874 2d61 6c69 676e 222c 2022 6c65 6674  xt-align", "left
+00008000: 2229 5d29 5d0a 2020 2020 2020 2020 2020  ")])].          
+00008010: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+00008020: 2069 6620 6469 7370 6c61 792e 6361 6e5f   if display.can_
+00008030: 7570 6461 7465 5f74 6578 743a 0a20 2020  update_text:.   
+00008040: 2020 2020 2020 2020 2020 2020 2064 6973               dis
+00008050: 706c 6179 2e64 6973 706c 6179 286d 6173  play.display(mas
+00008060: 7465 725f 6469 7370 6c61 795f 2c20 6669  ter_display_, fi
+00008070: 6e61 6c5f 6469 7370 6c61 793d 4661 6c73  nal_display=Fals
+00008080: 6529 0a0a 2020 2020 2020 2020 6469 7370  e)..        disp
+00008090: 6c61 792e 6d6f 7665 5f70 726f 6772 6573  lay.move_progres
+000080a0: 7328 290a 0a20 2020 2020 2020 2063 6f6d  s()..        com
+000080b0: 7061 7265 5f6d 6f64 656c 735f 203d 2073  pare_models_ = s
+000080c0: 656c 662e 5f68 6967 686c 6967 6874 5f6d  elf._highlight_m
+000080d0: 6f64 656c 7328 6d61 7374 6572 5f64 6973  odels(master_dis
+000080e0: 706c 6179 5f29 0a0a 2020 2020 2020 2020  play_)..        
+000080f0: 6469 7370 6c61 792e 7570 6461 7465 5f6d  display.update_m
+00008100: 6f6e 6974 6f72 2831 2c20 2243 6f6d 7069  onitor(1, "Compi
+00008110: 6c69 6e67 2046 696e 616c 204d 6f64 656c  ling Final Model
+00008120: 7322 290a 0a20 2020 2020 2020 2064 6973  s")..        dis
+00008130: 706c 6179 2e6d 6f76 655f 7072 6f67 7265  play.move_progre
+00008140: 7373 2829 0a0a 2020 2020 2020 2020 736f  ss()..        so
+00008150: 7274 6564 5f6d 6f64 656c 7320 3d20 5b5d  rted_models = []
+00008160: 0a0a 2020 2020 2020 2020 6966 206d 6173  ..        if mas
+00008170: 7465 725f 6469 7370 6c61 7920 6973 206e  ter_display is n
+00008180: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00008190: 2020 2020 2063 6c61 6d70 6564 5f6e 5f73       clamped_n_s
+000081a0: 656c 6563 7420 3d20 6d69 6e28 6c65 6e28  elect = min(len(
+000081b0: 6d61 7374 6572 5f64 6973 706c 6179 292c  master_display),
+000081c0: 2061 6273 286e 5f73 656c 6563 7429 290a   abs(n_select)).
+000081d0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+000081e0: 5f73 656c 6563 7420 3c20 303a 0a20 2020  _select < 0:.   
+000081f0: 2020 2020 2020 2020 2020 2020 206e 5f73               n_s
+00008200: 656c 6563 745f 7261 6e67 6520 3d20 7261  elect_range = ra
+00008210: 6e67 6528 0a20 2020 2020 2020 2020 2020  nge(.           
+00008220: 2020 2020 2020 2020 206c 656e 286d 6173           len(mas
+00008230: 7465 725f 6469 7370 6c61 7929 202d 2063  ter_display) - c
+00008240: 6c61 6d70 6564 5f6e 5f73 656c 6563 742c  lamped_n_select,
+00008250: 206c 656e 286d 6173 7465 725f 6469 7370   len(master_disp
+00008260: 6c61 7929 0a20 2020 2020 2020 2020 2020  lay).           
+00008270: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00008280: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00008290: 2020 2020 2020 2020 206e 5f73 656c 6563           n_selec
+000082a0: 745f 7261 6e67 6520 3d20 7261 6e67 6528  t_range = range(
+000082b0: 302c 2063 6c61 6d70 6564 5f6e 5f73 656c  0, clamped_n_sel
+000082c0: 6563 7429 0a0a 2020 2020 2020 2020 2020  ect)..          
+000082d0: 2020 6966 2073 656c 662e 6c6f 6767 696e    if self.loggin
+000082e0: 675f 7061 7261 6d3a 0a20 2020 2020 2020  g_param:.       
+000082f0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
+00008300: 6767 696e 675f 7061 7261 6d2e 6c6f 675f  gging_param.log_
+00008310: 6d6f 6465 6c5f 636f 6d70 6172 6973 6f6e  model_comparison
+00008320: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00008330: 2020 2020 2020 6d61 7374 6572 5f64 6973        master_dis
+00008340: 706c 6179 2c20 2263 6f6d 7061 7265 5f6d  play, "compare_m
+00008350: 6f64 656c 7322 0a20 2020 2020 2020 2020  odels".         
+00008360: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00008370: 2020 2020 2020 666f 7220 696e 6465 782c        for index,
+00008380: 2072 6f77 2069 6e20 656e 756d 6572 6174   row in enumerat
+00008390: 6528 6d61 7374 6572 5f64 6973 706c 6179  e(master_display
+000083a0: 2e69 7465 7272 6f77 7328 2929 3a0a 2020  .iterrows()):.  
+000083b0: 2020 2020 2020 2020 2020 2020 2020 5f2c                _,
+000083c0: 2072 6f77 203d 2072 6f77 0a20 2020 2020   row = row.     
+000083d0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+000083e0: 203d 2072 6f77 5b22 4f62 6a65 6374 225d   = row["Object"]
+000083f0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008400: 2020 7265 7375 6c74 7320 3d20 726f 772e    results = row.
+00008410: 746f 5f66 7261 6d65 2829 2e54 2e64 726f  to_frame().T.dro
+00008420: 7028 0a20 2020 2020 2020 2020 2020 2020  p(.             
+00008430: 2020 2020 2020 205b 224f 626a 6563 7422         ["Object"
+00008440: 2c20 224d 6f64 656c 222c 2022 7275 6e74  , "Model", "runt
+00008450: 696d 6522 2c20 2254 5420 2853 6563 2922  ime", "TT (Sec)"
+00008460: 5d2c 2065 7272 6f72 733d 2269 676e 6f72  ], errors="ignor
+00008470: 6522 2c20 6178 6973 3d31 0a20 2020 2020  e", axis=1.     
+00008480: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00008490: 2020 2020 2020 2020 2020 2020 2020 6176                av
+000084a0: 6773 5f64 6963 745f 6c6f 6720 3d20 7b6b  gs_dict_log = {k
+000084b0: 3a20 7620 666f 7220 6b2c 2076 2069 6e20  : v for k, v in 
+000084c0: 7265 7375 6c74 732e 696c 6f63 5b30 5d2e  results.iloc[0].
+000084d0: 6974 656d 7328 297d 0a0a 2020 2020 2020  items()}..      
+000084e0: 2020 2020 2020 2020 2020 6675 6c6c 5f6c            full_l
+000084f0: 6f67 6769 6e67 203d 2046 616c 7365 0a0a  ogging = False..
+00008500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008510: 6966 2069 6e64 6578 2069 6e20 6e5f 7365  if index in n_se
+00008520: 6c65 6374 5f72 616e 6765 3a0a 2020 2020  lect_range:.    
 00008530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008540: 2020 6469 7370 6c61 792e 7570 6461 7465    display.update
-00008550: 5f6d 6f6e 6974 6f72 2832 2c20 7365 6c66  _monitor(2, self
-00008560: 2e5f 6765 745f 6d6f 6465 6c5f 6e61 6d65  ._get_model_name
-00008570: 286d 6f64 656c 2929 0a20 2020 2020 2020  (model)).       
-00008580: 2020 2020 2020 2020 2020 2020 2063 7265               cre
-00008590: 6174 655f 6d6f 6465 6c5f 6172 6773 203d  ate_model_args =
-000085a0: 2064 6963 7428 0a20 2020 2020 2020 2020   dict(.         
-000085b0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000085c0: 7374 696d 6174 6f72 3d6d 6f64 656c 2c0a  stimator=model,.
+00008540: 6469 7370 6c61 792e 7570 6461 7465 5f6d  display.update_m
+00008550: 6f6e 6974 6f72 2832 2c20 7365 6c66 2e5f  onitor(2, self._
+00008560: 6765 745f 6d6f 6465 6c5f 6e61 6d65 286d  get_model_name(m
+00008570: 6f64 656c 2929 0a20 2020 2020 2020 2020  odel)).         
+00008580: 2020 2020 2020 2020 2020 2063 7265 6174             creat
+00008590: 655f 6d6f 6465 6c5f 6172 6773 203d 2064  e_model_args = d
+000085a0: 6963 7428 0a20 2020 2020 2020 2020 2020  ict(.           
+000085b0: 2020 2020 2020 2020 2020 2020 2065 7374               est
+000085c0: 696d 6174 6f72 3d6d 6f64 656c 2c0a 2020  imator=model,.  
 000085d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000085e0: 2020 2020 2020 2020 7379 7374 656d 3d46          system=F
-000085f0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-00008600: 2020 2020 2020 2020 2020 2020 2020 7665                ve
-00008610: 7262 6f73 653d 4661 6c73 652c 0a20 2020  rbose=False,.   
+000085e0: 2020 2020 2020 7379 7374 656d 3d46 616c        system=Fal
+000085f0: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
+00008600: 2020 2020 2020 2020 2020 2020 7665 7262              verb
+00008610: 6f73 653d 4661 6c73 652c 0a20 2020 2020  ose=False,.     
 00008620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008630: 2020 2020 2066 6f6c 643d 666f 6c64 2c0a       fold=fold,.
+00008630: 2020 2066 6f6c 643d 666f 6c64 2c0a 2020     fold=fold,.  
 00008640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008650: 2020 2020 2020 2020 726f 756e 643d 726f          round=ro
-00008660: 756e 642c 0a20 2020 2020 2020 2020 2020  und,.           
-00008670: 2020 2020 2020 2020 2020 2020 2063 726f               cro
-00008680: 7373 5f76 616c 6964 6174 696f 6e3d 4661  ss_validation=Fa
-00008690: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-000086a0: 2020 2020 2020 2020 2020 2020 2070 7265               pre
-000086b0: 6469 6374 3d46 616c 7365 2c0a 2020 2020  dict=False,.    
+00008650: 2020 2020 2020 726f 756e 643d 726f 756e        round=roun
+00008660: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
+00008670: 2020 2020 2020 2020 2020 2063 726f 7373             cross
+00008680: 5f76 616c 6964 6174 696f 6e3d 4661 6c73  _validation=Fals
+00008690: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+000086a0: 2020 2020 2020 2020 2020 2070 7265 6469             predi
+000086b0: 6374 3d46 616c 7365 2c0a 2020 2020 2020  ct=False,.      
 000086c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000086d0: 2020 2020 6669 745f 6b77 6172 6773 3d66      fit_kwargs=f
-000086e0: 6974 5f6b 7761 7267 732c 0a20 2020 2020  it_kwargs,.     
+000086d0: 2020 6669 745f 6b77 6172 6773 3d66 6974    fit_kwargs=fit
+000086e0: 5f6b 7761 7267 732c 0a20 2020 2020 2020  _kwargs,.       
 000086f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008700: 2020 2067 726f 7570 733d 6772 6f75 7073     groups=groups
-00008710: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00008720: 2020 2020 2020 2020 2020 7072 6f62 6162            probab
-00008730: 696c 6974 795f 7468 7265 7368 6f6c 643d  ility_threshold=
-00008740: 7072 6f62 6162 696c 6974 795f 7468 7265  probability_thre
-00008750: 7368 6f6c 642c 0a20 2020 2020 2020 2020  shold,.         
-00008760: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00008770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008780: 2069 6620 6572 726f 7273 203d 3d20 2272   if errors == "r
-00008790: 6169 7365 223a 0a20 2020 2020 2020 2020  aise":.         
-000087a0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-000087b0: 6f64 656c 2c20 6d6f 6465 6c5f 6669 745f  odel, model_fit_
-000087c0: 7469 6d65 203d 2073 656c 662e 5f63 7265  time = self._cre
-000087d0: 6174 655f 6d6f 6465 6c28 2a2a 6372 6561  ate_model(**crea
-000087e0: 7465 5f6d 6f64 656c 5f61 7267 7329 0a20  te_model_args). 
+00008700: 2067 726f 7570 733d 6772 6f75 7073 2c0a   groups=groups,.
+00008710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008720: 2020 2020 2020 2020 7072 6f62 6162 696c          probabil
+00008730: 6974 795f 7468 7265 7368 6f6c 643d 7072  ity_threshold=pr
+00008740: 6f62 6162 696c 6974 795f 7468 7265 7368  obability_thresh
+00008750: 6f6c 642c 0a20 2020 2020 2020 2020 2020  old,.           
+00008760: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00008770: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00008780: 6620 6572 726f 7273 203d 3d20 2272 6169  f errors == "rai
+00008790: 7365 223a 0a20 2020 2020 2020 2020 2020  se":.           
+000087a0: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+000087b0: 656c 2c20 6d6f 6465 6c5f 6669 745f 7469  el, model_fit_ti
+000087c0: 6d65 203d 2073 656c 662e 5f63 7265 6174  me = self._creat
+000087d0: 655f 6d6f 6465 6c28 2a2a 6372 6561 7465  e_model(**create
+000087e0: 5f6d 6f64 656c 5f61 7267 7329 0a20 2020  _model_args).   
 000087f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008800: 2020 2020 2020 2073 6f72 7465 645f 6d6f         sorted_mo
-00008810: 6465 6c73 2e61 7070 656e 6428 6d6f 6465  dels.append(mode
-00008820: 6c29 0a20 2020 2020 2020 2020 2020 2020  l).             
-00008830: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00008800: 2020 2020 2073 6f72 7465 645f 6d6f 6465       sorted_mode
+00008810: 6c73 2e61 7070 656e 6428 6d6f 6465 6c29  ls.append(model)
+00008820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008830: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
 00008840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008850: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+00008850: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
 00008860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008870: 2020 2020 2020 6d6f 6465 6c2c 206d 6f64        model, mod
-00008880: 656c 5f66 6974 5f74 696d 6520 3d20 7365  el_fit_time = se
-00008890: 6c66 2e5f 6372 6561 7465 5f6d 6f64 656c  lf._create_model
-000088a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00008870: 2020 2020 6d6f 6465 6c2c 206d 6f64 656c      model, model
+00008880: 5f66 6974 5f74 696d 6520 3d20 7365 6c66  _fit_time = self
+00008890: 2e5f 6372 6561 7465 5f6d 6f64 656c 280a  ._create_model(.
+000088a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000088b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000088c0: 2020 2a2a 6372 6561 7465 5f6d 6f64 656c    **create_model
-000088d0: 5f61 7267 730a 2020 2020 2020 2020 2020  _args.          
+000088c0: 2a2a 6372 6561 7465 5f6d 6f64 656c 5f61  **create_model_a
+000088d0: 7267 730a 2020 2020 2020 2020 2020 2020  rgs.            
 000088e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000088f0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00008900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008910: 736f 7274 6564 5f6d 6f64 656c 732e 6170  sorted_models.ap
-00008920: 7065 6e64 286d 6f64 656c 290a 2020 2020  pend(model).    
+000088f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00008900: 2020 2020 2020 2020 2020 2020 2020 736f                so
+00008910: 7274 6564 5f6d 6f64 656c 732e 6170 7065  rted_models.appe
+00008920: 6e64 286d 6f64 656c 290a 2020 2020 2020  nd(model).      
 00008930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008940: 2020 2020 2020 2020 6173 7365 7274 2028          assert (
-00008950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008970: 206e 702e 7375 6d28 0a20 2020 2020 2020   np.sum(.       
+00008940: 2020 2020 2020 6173 7365 7274 2028 0a20        assert (. 
+00008950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008960: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00008970: 702e 7375 6d28 0a20 2020 2020 2020 2020  p.sum(.         
 00008980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008990: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-000089a0: 656c 5f72 6573 756c 7473 2e64 726f 7028  el_results.drop(
-000089b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008990: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+000089a0: 5f72 6573 756c 7473 2e64 726f 7028 0a20  _results.drop(. 
+000089b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000089c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000089d0: 2020 2020 2020 2020 2072 6573 756c 7473           results
-000089e0: 5f63 6f6c 756d 6e73 5f74 6f5f 6967 6e6f  _columns_to_igno
-000089f0: 7265 2c0a 2020 2020 2020 2020 2020 2020  re,.            
+000089d0: 2020 2020 2020 2072 6573 756c 7473 5f63         results_c
+000089e0: 6f6c 756d 6e73 5f74 6f5f 6967 6e6f 7265  olumns_to_ignore
+000089f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 00008a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008a10: 2020 2020 2020 2020 2020 2020 6178 6973              axis
-00008a20: 3d31 2c0a 2020 2020 2020 2020 2020 2020  =1,.            
+00008a10: 2020 2020 2020 2020 2020 6178 6973 3d31            axis=1
+00008a20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 00008a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008a40: 2020 2020 2020 2020 2020 2020 6572 726f              erro
-00008a50: 7273 3d22 6967 6e6f 7265 222c 0a20 2020  rs="ignore",.   
+00008a40: 2020 2020 2020 2020 2020 6572 726f 7273            errors
+00008a50: 3d22 6967 6e6f 7265 222c 0a20 2020 2020  ="ignore",.     
 00008a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008a80: 2029 2e69 6c6f 635b 305d 0a20 2020 2020   ).iloc[0].     
+00008a70: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00008a80: 2e69 6c6f 635b 305d 0a20 2020 2020 2020  .iloc[0].       
 00008a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008aa0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00008aa0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
 00008ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008ac0: 2020 2020 2020 2020 2020 2020 2021 3d20               != 
-00008ad0: 302e 300a 2020 2020 2020 2020 2020 2020  0.0.            
-00008ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008af0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00008b00: 2020 2020 2020 2020 2020 6578 6365 7074            except
-00008b10: 2045 7863 6570 7469 6f6e 3a0a 2020 2020   Exception:.    
+00008ac0: 2020 2020 2020 2020 2020 2021 3d20 302e             != 0.
+00008ad0: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
+00008ae0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00008af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008b00: 2020 2020 2020 2020 6578 6365 7074 2045          except E
+00008b10: 7863 6570 7469 6f6e 3a0a 2020 2020 2020  xception:.      
 00008b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008b30: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-00008b40: 6765 722e 6572 726f 7228 0a20 2020 2020  ger.error(.     
+00008b30: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
+00008b40: 722e 6572 726f 7228 0a20 2020 2020 2020  r.error(.       
 00008b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008b60: 2020 2020 2020 2020 2020 2066 2263 7265             f"cre
-00008b70: 6174 655f 6d6f 6465 6c28 2920 666f 7220  ate_model() for 
-00008b80: 7b6d 6f64 656c 7d20 7261 6973 6564 2061  {model} raised a
-00008b90: 6e20 6578 6365 7074 696f 6e20 6f72 2072  n exception or r
-00008ba0: 6574 7572 6e65 6420 616c 6c20 302e 303a  eturned all 0.0:
-00008bb0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00008bc0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00008b60: 2020 2020 2020 2020 2066 2263 7265 6174           f"creat
+00008b70: 655f 6d6f 6465 6c28 2920 666f 7220 7b6d  e_model() for {m
+00008b80: 6f64 656c 7d20 7261 6973 6564 2061 6e20  odel} raised an 
+00008b90: 6578 6365 7074 696f 6e20 6f72 2072 6574  exception or ret
+00008ba0: 7572 6e65 6420 616c 6c20 302e 303a 220a  urned all 0.0:".
+00008bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008bc0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
 00008bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008be0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00008bf0: 2e6c 6f67 6765 722e 6572 726f 7228 7472  .logger.error(tr
-00008c00: 6163 6562 6163 6b2e 666f 726d 6174 5f65  aceback.format_e
-00008c10: 7863 2829 290a 2020 2020 2020 2020 2020  xc()).          
+00008be0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+00008bf0: 6f67 6765 722e 6572 726f 7228 7472 6163  ogger.error(trac
+00008c00: 6562 6163 6b2e 666f 726d 6174 5f65 7863  eback.format_exc
+00008c10: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
 00008c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008c30: 2020 6d6f 6465 6c20 3d20 4e6f 6e65 0a20    model = None. 
+00008c30: 6d6f 6465 6c20 3d20 4e6f 6e65 0a20 2020  model = None.   
 00008c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008c50: 2020 2020 2020 2020 2020 2064 6973 706c             displ
-00008c60: 6179 2e6d 6f76 655f 7072 6f67 7265 7373  ay.move_progress
-00008c70: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-00008c80: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00008c90: 6f6e 7469 6e75 650a 2020 2020 2020 2020  ontinue.        
-00008ca0: 2020 2020 2020 2020 2020 2020 6469 7370              disp
-00008cb0: 6c61 792e 6d6f 7665 5f70 726f 6772 6573  lay.move_progres
-00008cc0: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
-00008cd0: 2020 2020 2020 2020 6675 6c6c 5f6c 6f67          full_log
-00008ce0: 6769 6e67 203d 2054 7275 650a 0a20 2020  ging = True..   
-00008cf0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00008d00: 7365 6c66 2e6c 6f67 6769 6e67 5f70 6172  self.logging_par
-00008d10: 616d 2061 6e64 2063 726f 7373 5f76 616c  am and cross_val
-00008d20: 6964 6174 696f 6e20 616e 6420 6d6f 6465  idation and mode
-00008d30: 6c20 6973 206e 6f74 204e 6f6e 653a 0a0a  l is not None:..
+00008c50: 2020 2020 2020 2020 2064 6973 706c 6179           display
+00008c60: 2e6d 6f76 655f 7072 6f67 7265 7373 2829  .move_progress()
+00008c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008c80: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+00008c90: 7469 6e75 650a 2020 2020 2020 2020 2020  tinue.          
+00008ca0: 2020 2020 2020 2020 2020 6469 7370 6c61            displa
+00008cb0: 792e 6d6f 7665 5f70 726f 6772 6573 7328  y.move_progress(
+00008cc0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00008cd0: 2020 2020 2020 6675 6c6c 5f6c 6f67 6769        full_loggi
+00008ce0: 6e67 203d 2054 7275 650a 0a20 2020 2020  ng = True..     
+00008cf0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00008d00: 6c66 2e6c 6f67 6769 6e67 5f70 6172 616d  lf.logging_param
+00008d10: 2061 6e64 2063 726f 7373 5f76 616c 6964   and cross_valid
+00008d20: 6174 696f 6e20 616e 6420 6d6f 6465 6c20  ation and model 
+00008d30: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
 00008d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008d50: 2020 2020 7365 6c66 2e5f 6c6f 675f 6d6f      self._log_mo
-00008d60: 6465 6c28 0a20 2020 2020 2020 2020 2020  del(.           
-00008d70: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-00008d80: 656c 3d6d 6f64 656c 2c0a 2020 2020 2020  el=model,.      
-00008d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008da0: 2020 6d6f 6465 6c5f 7265 7375 6c74 733d    model_results=
-00008db0: 7265 7375 6c74 732c 0a20 2020 2020 2020  results,.       
-00008dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008dd0: 2073 636f 7265 5f64 6963 743d 6176 6773   score_dict=avgs
-00008de0: 5f64 6963 745f 6c6f 672c 0a20 2020 2020  _dict_log,.     
+00008d50: 2073 656c 662e 5f6c 6f67 5f6d 6f64 656c   self._log_model
+00008d60: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00008d70: 2020 2020 2020 2020 2020 6d6f 6465 6c3d            model=
+00008d80: 6d6f 6465 6c2c 0a20 2020 2020 2020 2020  model,.         
+00008d90: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00008da0: 6f64 656c 5f72 6573 756c 7473 3d72 6573  odel_results=res
+00008db0: 756c 7473 2c0a 2020 2020 2020 2020 2020  ults,.          
+00008dc0: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+00008dd0: 6f72 655f 6469 6374 3d61 7667 735f 6469  ore_dict=avgs_di
+00008de0: 6374 5f6c 6f67 2c0a 2020 2020 2020 2020  ct_log,.        
 00008df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008e00: 2020 2073 6f75 7263 653d 2263 6f6d 7061     source="compa
-00008e10: 7265 5f6d 6f64 656c 7322 2c0a 2020 2020  re_models",.    
+00008e00: 736f 7572 6365 3d22 636f 6d70 6172 655f  source="compare_
+00008e10: 6d6f 6465 6c73 222c 0a20 2020 2020 2020  models",.       
 00008e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008e30: 2020 2020 7275 6e74 696d 653d 726f 775b      runtime=row[
-00008e40: 2272 756e 7469 6d65 225d 2c0a 2020 2020  "runtime"],.    
+00008e30: 2072 756e 7469 6d65 3d72 6f77 5b22 7275   runtime=row["ru
+00008e40: 6e74 696d 6522 5d2c 0a20 2020 2020 2020  ntime"],.       
 00008e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008e60: 2020 2020 6d6f 6465 6c5f 6669 745f 7469      model_fit_ti
-00008e70: 6d65 3d72 6f77 5b22 5454 2028 5365 6329  me=row["TT (Sec)
-00008e80: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
-00008e90: 2020 2020 2020 2020 2020 2020 7069 7065              pipe
-00008ea0: 6c69 6e65 3d73 656c 662e 7069 7065 6c69  line=self.pipeli
-00008eb0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00008ec0: 2020 2020 2020 2020 2020 2020 6c6f 675f              log_
-00008ed0: 706c 6f74 733d 7365 6c66 2e6c 6f67 5f70  plots=self.log_p
-00008ee0: 6c6f 7473 5f70 6172 616d 2069 6620 6675  lots_param if fu
-00008ef0: 6c6c 5f6c 6f67 6769 6e67 2065 6c73 6520  ll_logging else 
-00008f00: 5b5d 2c0a 2020 2020 2020 2020 2020 2020  [],.            
-00008f10: 2020 2020 2020 2020 2020 2020 6c6f 675f              log_
-00008f20: 686f 6c64 6f75 743d 6675 6c6c 5f6c 6f67  holdout=full_log
-00008f30: 6769 6e67 2c0a 2020 2020 2020 2020 2020  ging,.          
-00008f40: 2020 2020 2020 2020 2020 2020 2020 5552                UR
-00008f50: 493d 5552 492c 0a20 2020 2020 2020 2020  I=URI,.         
-00008f60: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00008f70: 6973 706c 6179 3d64 6973 706c 6179 2c0a  isplay=display,.
+00008e60: 206d 6f64 656c 5f66 6974 5f74 696d 653d   model_fit_time=
+00008e70: 726f 775b 2254 5420 2853 6563 2922 5d2c  row["TT (Sec)"],
+00008e80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008e90: 2020 2020 2020 2020 2070 6970 656c 696e           pipelin
+00008ea0: 653d 7365 6c66 2e70 6970 656c 696e 652c  e=self.pipeline,
+00008eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008ec0: 2020 2020 2020 2020 206c 6f67 5f70 6c6f           log_plo
+00008ed0: 7473 3d73 656c 662e 6c6f 675f 706c 6f74  ts=self.log_plot
+00008ee0: 735f 7061 7261 6d20 6966 2066 756c 6c5f  s_param if full_
+00008ef0: 6c6f 6767 696e 6720 656c 7365 205b 5d2c  logging else [],
+00008f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008f10: 2020 2020 2020 2020 206c 6f67 5f68 6f6c           log_hol
+00008f20: 646f 7574 3d66 756c 6c5f 6c6f 6767 696e  dout=full_loggin
+00008f30: 672c 0a20 2020 2020 2020 2020 2020 2020  g,.             
+00008f40: 2020 2020 2020 2020 2020 2055 5249 3d55             URI=U
+00008f50: 5249 2c0a 2020 2020 2020 2020 2020 2020  RI,.            
+00008f60: 2020 2020 2020 2020 2020 2020 6469 7370              disp
+00008f70: 6c61 793d 6469 7370 6c61 792c 0a20 2020  lay=display,.   
 00008f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008f90: 2020 2020 2020 2020 6578 7065 7269 6d65          experime
-00008fa0: 6e74 5f63 7573 746f 6d5f 7461 6773 3d65  nt_custom_tags=e
-00008fb0: 7870 6572 696d 656e 745f 6375 7374 6f6d  xperiment_custom
-00008fc0: 5f74 6167 732c 0a20 2020 2020 2020 2020  _tags,.         
-00008fd0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00008fe0: 2020 2020 2020 6966 206c 656e 2873 6f72        if len(sor
-00008ff0: 7465 645f 6d6f 6465 6c73 2920 3d3d 2031  ted_models) == 1
-00009000: 3a0a 2020 2020 2020 2020 2020 2020 736f  :.            so
-00009010: 7274 6564 5f6d 6f64 656c 7320 3d20 736f  rted_models = so
-00009020: 7274 6564 5f6d 6f64 656c 735b 305d 0a0a  rted_models[0]..
-00009030: 2020 2020 2020 2020 6469 7370 6c61 792e          display.
-00009040: 6469 7370 6c61 7928 636f 6d70 6172 655f  display(compare_
-00009050: 6d6f 6465 6c73 5f2c 2066 696e 616c 5f64  models_, final_d
-00009060: 6973 706c 6179 3d54 7275 6529 0a0a 2020  isplay=True)..  
-00009070: 2020 2020 2020 7064 2e72 6573 6574 5f6f        pd.reset_o
-00009080: 7074 696f 6e28 2264 6973 706c 6179 2e6d  ption("display.m
-00009090: 6178 5f63 6f6c 756d 6e73 2229 0a0a 2020  ax_columns")..  
-000090a0: 2020 2020 2020 2320 7374 6f72 6520 696e        # store in
-000090b0: 2064 6973 706c 6179 2063 6f6e 7461 696e   display contain
-000090c0: 6572 0a20 2020 2020 2020 2073 656c 662e  er.        self.
-000090d0: 5f64 6973 706c 6179 5f63 6f6e 7461 696e  _display_contain
-000090e0: 6572 2e61 7070 656e 6428 636f 6d70 6172  er.append(compar
-000090f0: 655f 6d6f 6465 6c73 5f2e 6461 7461 290a  e_models_.data).
-00009100: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
-00009110: 6767 6572 2e69 6e66 6f28 0a20 2020 2020  gger.info(.     
-00009120: 2020 2020 2020 2066 225f 6d61 7374 6572         f"_master
-00009130: 5f6d 6f64 656c 5f63 6f6e 7461 696e 6572  _model_container
-00009140: 3a20 7b6c 656e 2873 656c 662e 5f6d 6173  : {len(self._mas
-00009150: 7465 725f 6d6f 6465 6c5f 636f 6e74 6169  ter_model_contai
-00009160: 6e65 7229 7d22 0a20 2020 2020 2020 2029  ner)}".        )
-00009170: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
-00009180: 6767 6572 2e69 6e66 6f28 6622 5f64 6973  gger.info(f"_dis
-00009190: 706c 6179 5f63 6f6e 7461 696e 6572 3a20  play_container: 
-000091a0: 7b6c 656e 2873 656c 662e 5f64 6973 706c  {len(self._displ
-000091b0: 6179 5f63 6f6e 7461 696e 6572 297d 2229  ay_container)}")
-000091c0: 0a0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
-000091d0: 6f67 6765 722e 696e 666f 2873 7472 2873  ogger.info(str(s
-000091e0: 6f72 7465 645f 6d6f 6465 6c73 2929 0a20  orted_models)). 
-000091f0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
-00009200: 6572 2e69 6e66 6f28 0a20 2020 2020 2020  er.info(.       
-00009210: 2020 2020 2022 636f 6d70 6172 655f 6d6f       "compare_mo
-00009220: 6465 6c73 2829 2073 7563 6365 7373 6675  dels() successfu
-00009230: 6c6c 7920 636f 6d70 6c65 7465 642e 2e2e  lly completed...
+00008f90: 2020 2020 2065 7870 6572 696d 656e 745f       experiment_
+00008fa0: 6375 7374 6f6d 5f74 6167 733d 6578 7065  custom_tags=expe
+00008fb0: 7269 6d65 6e74 5f63 7573 746f 6d5f 7461  riment_custom_ta
+00008fc0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+00008fd0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00008fe0: 2020 2069 6620 6c65 6e28 736f 7274 6564     if len(sorted
+00008ff0: 5f6d 6f64 656c 7329 203d 3d20 313a 0a20  _models) == 1:. 
+00009000: 2020 2020 2020 2020 2020 2073 6f72 7465             sorte
+00009010: 645f 6d6f 6465 6c73 203d 2073 6f72 7465  d_models = sorte
+00009020: 645f 6d6f 6465 6c73 5b30 5d0a 0a20 2020  d_models[0]..   
+00009030: 2020 2020 2064 6973 706c 6179 2e64 6973       display.dis
+00009040: 706c 6179 2863 6f6d 7061 7265 5f6d 6f64  play(compare_mod
+00009050: 656c 735f 2c20 6669 6e61 6c5f 6469 7370  els_, final_disp
+00009060: 6c61 793d 5472 7565 290a 0a20 2020 2020  lay=True)..     
+00009070: 2020 2070 642e 7265 7365 745f 6f70 7469     pd.reset_opti
+00009080: 6f6e 2822 6469 7370 6c61 792e 6d61 785f  on("display.max_
+00009090: 636f 6c75 6d6e 7322 290a 0a20 2020 2020  columns")..     
+000090a0: 2020 2023 2073 746f 7265 2069 6e20 6469     # store in di
+000090b0: 7370 6c61 7920 636f 6e74 6169 6e65 720a  splay container.
+000090c0: 2020 2020 2020 2020 7365 6c66 2e5f 6469          self._di
+000090d0: 7370 6c61 795f 636f 6e74 6169 6e65 722e  splay_container.
+000090e0: 6170 7065 6e64 2863 6f6d 7061 7265 5f6d  append(compare_m
+000090f0: 6f64 656c 735f 2e64 6174 6129 0a0a 2020  odels_.data)..  
+00009100: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
+00009110: 722e 696e 666f 280a 2020 2020 2020 2020  r.info(.        
+00009120: 2020 2020 6622 5f6d 6173 7465 725f 6d6f      f"_master_mo
+00009130: 6465 6c5f 636f 6e74 6169 6e65 723a 207b  del_container: {
+00009140: 6c65 6e28 7365 6c66 2e5f 6d61 7374 6572  len(self._master
+00009150: 5f6d 6f64 656c 5f63 6f6e 7461 696e 6572  _model_container
+00009160: 297d 220a 2020 2020 2020 2020 290a 2020  )}".        ).  
+00009170: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
+00009180: 722e 696e 666f 2866 225f 6469 7370 6c61  r.info(f"_displa
+00009190: 795f 636f 6e74 6169 6e65 723a 207b 6c65  y_container: {le
+000091a0: 6e28 7365 6c66 2e5f 6469 7370 6c61 795f  n(self._display_
+000091b0: 636f 6e74 6169 6e65 7229 7d22 290a 0a20  container)}").. 
+000091c0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+000091d0: 6572 2e69 6e66 6f28 7374 7228 736f 7274  er.info(str(sort
+000091e0: 6564 5f6d 6f64 656c 7329 290a 2020 2020  ed_models)).    
+000091f0: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
+00009200: 696e 666f 280a 2020 2020 2020 2020 2020  info(.          
+00009210: 2020 2263 6f6d 7061 7265 5f6d 6f64 656c    "compare_model
+00009220: 7328 2920 7375 6363 6573 7366 756c 6c79  s() successfully
+00009230: 2063 6f6d 706c 6574 6564 2e2e 2e2e 2e2e   completed......
 00009240: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
 00009250: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00009260: 2e2e 2e22 0a20 2020 2020 2020 2029 0a0a  ...".        )..
-00009270: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00009280: 6f72 7465 645f 6d6f 6465 6c73 0a0a 2020  orted_models..  
-00009290: 2020 6465 6620 5f63 7265 6174 655f 6d6f    def _create_mo
-000092a0: 6465 6c5f 7769 7468 6f75 745f 6376 280a  del_without_cv(.
-000092b0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000092c0: 2020 2020 2020 6d6f 6465 6c2c 0a20 2020        model,.   
-000092d0: 2020 2020 2064 6174 615f 582c 0a20 2020       data_X,.   
-000092e0: 2020 2020 2064 6174 615f 792c 0a20 2020       data_y,.   
-000092f0: 2020 2020 2066 6974 5f6b 7761 7267 732c       fit_kwargs,
-00009300: 0a20 2020 2020 2020 2072 6f75 6e64 2c0a  .        round,.
-00009310: 2020 2020 2020 2020 7072 6564 6963 742c          predict,
-00009320: 0a20 2020 2020 2020 2073 7973 7465 6d2c  .        system,
-00009330: 0a20 2020 2020 2020 2064 6973 706c 6179  .        display
-00009340: 3a20 436f 6d6d 6f6e 4469 7370 6c61 792c  : CommonDisplay,
-00009350: 0a20 2020 2020 2020 206d 6f64 656c 5f6f  .        model_o
-00009360: 6e6c 793a 2062 6f6f 6c20 3d20 5472 7565  nly: bool = True
-00009370: 2c0a 2020 2020 2020 2020 7265 7475 726e  ,.        return
-00009380: 5f74 7261 696e 5f73 636f 7265 3a20 626f  _train_score: bo
-00009390: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-000093a0: 293a 0a20 2020 2020 2020 2077 6974 6820  ):.        with 
-000093b0: 6573 7469 6d61 746f 725f 7069 7065 6c69  estimator_pipeli
-000093c0: 6e65 2873 656c 662e 7069 7065 6c69 6e65  ne(self.pipeline
-000093d0: 2c20 6d6f 6465 6c29 2061 7320 7069 7065  , model) as pipe
-000093e0: 6c69 6e65 5f77 6974 685f 6d6f 6465 6c3a  line_with_model:
-000093f0: 0a20 2020 2020 2020 2020 2020 2066 6974  .            fit
-00009400: 5f6b 7761 7267 7320 3d20 6765 745f 7069  _kwargs = get_pi
-00009410: 7065 6c69 6e65 5f66 6974 5f6b 7761 7267  peline_fit_kwarg
-00009420: 7328 7069 7065 6c69 6e65 5f77 6974 685f  s(pipeline_with_
-00009430: 6d6f 6465 6c2c 2066 6974 5f6b 7761 7267  model, fit_kwarg
-00009440: 7329 0a20 2020 2020 2020 2020 2020 2073  s).            s
-00009450: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
-00009460: 2243 726f 7373 2076 616c 6964 6174 696f  "Cross validatio
-00009470: 6e20 7365 7420 746f 2046 616c 7365 2229  n set to False")
-00009480: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00009490: 6c66 2e6c 6f67 6765 722e 696e 666f 2822  lf.logger.info("
-000094a0: 4669 7474 696e 6720 4d6f 6465 6c22 290a  Fitting Model").
-000094b0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-000094c0: 6c5f 6669 745f 7374 6172 7420 3d20 7469  l_fit_start = ti
-000094d0: 6d65 2e74 696d 6528 290a 2020 2020 2020  me.time().      
-000094e0: 2020 2020 2020 7769 7468 2072 6564 6972        with redir
-000094f0: 6563 745f 6f75 7470 7574 2873 656c 662e  ect_output(self.
-00009500: 6c6f 6767 6572 293a 0a20 2020 2020 2020  logger):.       
-00009510: 2020 2020 2020 2020 2070 6970 656c 696e           pipelin
-00009520: 655f 7769 7468 5f6d 6f64 656c 2e66 6974  e_with_model.fit
-00009530: 2864 6174 615f 582c 2064 6174 615f 792c  (data_X, data_y,
-00009540: 202a 2a66 6974 5f6b 7761 7267 7329 0a20   **fit_kwargs). 
-00009550: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-00009560: 5f66 6974 5f65 6e64 203d 2074 696d 652e  _fit_end = time.
-00009570: 7469 6d65 2829 0a0a 2020 2020 2020 2020  time()..        
-00009580: 2020 2020 6d6f 6465 6c5f 6669 745f 7469      model_fit_ti
-00009590: 6d65 203d 206e 702e 6172 7261 7928 6d6f  me = np.array(mo
-000095a0: 6465 6c5f 6669 745f 656e 6420 2d20 6d6f  del_fit_end - mo
-000095b0: 6465 6c5f 6669 745f 7374 6172 7429 2e72  del_fit_start).r
-000095c0: 6f75 6e64 2832 290a 0a20 2020 2020 2020  ound(2)..       
-000095d0: 2020 2020 2064 6973 706c 6179 2e6d 6f76       display.mov
-000095e0: 655f 7072 6f67 7265 7373 2829 0a0a 2020  e_progress()..  
-000095f0: 2020 2020 2020 2020 2020 6966 2070 7265            if pre
-00009600: 6469 6374 3a0a 2020 2020 2020 2020 2020  dict:.          
-00009610: 2020 2020 2020 6966 2072 6574 7572 6e5f        if return_
-00009620: 7472 6169 6e5f 7363 6f72 653a 0a20 2020  train_score:.   
-00009630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009640: 2023 2063 616c 6c20 636c 6173 7320 6578   # call class ex
-00009650: 706c 6963 6974 6c79 2074 6f20 6765 7420  plicitly to get 
-00009660: 6163 6365 7373 2074 6f20 7072 6570 726f  access to prepro
-00009670: 6365 7373 2061 7267 0a20 2020 2020 2020  cess arg.       
-00009680: 2020 2020 2020 2020 2020 2020 2023 2069               # i
-00009690: 6e20 7375 6263 6c61 7373 6573 0a20 2020  n subclasses.   
-000096a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000096b0: 205f 5375 7065 7276 6973 6564 4578 7065   _SupervisedExpe
-000096c0: 7269 6d65 6e74 2e70 7265 6469 6374 5f6d  riment.predict_m
-000096d0: 6f64 656c 280a 2020 2020 2020 2020 2020  odel(.          
-000096e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000096f0: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
-00009700: 2020 2020 2020 2020 2020 2020 7069 7065              pipe
-00009710: 6c69 6e65 5f77 6974 685f 6d6f 6465 6c2c  line_with_model,
-00009720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009730: 2020 2020 2020 2020 2064 6174 613d 7064           data=pd
-00009740: 2e63 6f6e 6361 7428 5b64 6174 615f 582c  .concat([data_X,
-00009750: 2064 6174 615f 795d 2c20 6178 6973 3d31   data_y], axis=1
-00009760: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00009770: 2020 2020 2020 2020 2020 2076 6572 626f             verbo
-00009780: 7365 3d46 616c 7365 2c0a 2020 2020 2020  se=False,.      
-00009790: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00009260: 220a 2020 2020 2020 2020 290a 0a20 2020  ".        )..   
+00009270: 2020 2020 2072 6574 7572 6e20 736f 7274       return sort
+00009280: 6564 5f6d 6f64 656c 730a 0a20 2020 2064  ed_models..    d
+00009290: 6566 205f 6372 6561 7465 5f6d 6f64 656c  ef _create_model
+000092a0: 5f77 6974 686f 7574 5f63 7628 0a20 2020  _without_cv(.   
+000092b0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+000092c0: 2020 206d 6f64 656c 2c0a 2020 2020 2020     model,.      
+000092d0: 2020 6461 7461 5f58 2c0a 2020 2020 2020    data_X,.      
+000092e0: 2020 6461 7461 5f79 2c0a 2020 2020 2020    data_y,.      
+000092f0: 2020 6669 745f 6b77 6172 6773 2c0a 2020    fit_kwargs,.  
+00009300: 2020 2020 2020 726f 756e 642c 0a20 2020        round,.   
+00009310: 2020 2020 2070 7265 6469 6374 2c0a 2020       predict,.  
+00009320: 2020 2020 2020 7379 7374 656d 2c0a 2020        system,.  
+00009330: 2020 2020 2020 6469 7370 6c61 793a 2043        display: C
+00009340: 6f6d 6d6f 6e44 6973 706c 6179 2c0a 2020  ommonDisplay,.  
+00009350: 2020 2020 2020 6d6f 6465 6c5f 6f6e 6c79        model_only
+00009360: 3a20 626f 6f6c 203d 2054 7275 652c 0a20  : bool = True,. 
+00009370: 2020 2020 2020 2072 6574 7572 6e5f 7472         return_tr
+00009380: 6169 6e5f 7363 6f72 653a 2062 6f6f 6c20  ain_score: bool 
+00009390: 3d20 4661 6c73 652c 0a20 2020 2029 3a0a  = False,.    ):.
+000093a0: 2020 2020 2020 2020 7769 7468 2065 7374          with est
+000093b0: 696d 6174 6f72 5f70 6970 656c 696e 6528  imator_pipeline(
+000093c0: 7365 6c66 2e70 6970 656c 696e 652c 206d  self.pipeline, m
+000093d0: 6f64 656c 2920 6173 2070 6970 656c 696e  odel) as pipelin
+000093e0: 655f 7769 7468 5f6d 6f64 656c 3a0a 2020  e_with_model:.  
+000093f0: 2020 2020 2020 2020 2020 6669 745f 6b77            fit_kw
+00009400: 6172 6773 203d 2067 6574 5f70 6970 656c  args = get_pipel
+00009410: 696e 655f 6669 745f 6b77 6172 6773 2870  ine_fit_kwargs(p
+00009420: 6970 656c 696e 655f 7769 7468 5f6d 6f64  ipeline_with_mod
+00009430: 656c 2c20 6669 745f 6b77 6172 6773 290a  el, fit_kwargs).
+00009440: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00009450: 2e6c 6f67 6765 722e 696e 666f 2822 4372  .logger.info("Cr
+00009460: 6f73 7320 7661 6c69 6461 7469 6f6e 2073  oss validation s
+00009470: 6574 2074 6f20 4661 6c73 6522 290a 0a20  et to False").. 
+00009480: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00009490: 6c6f 6767 6572 2e69 6e66 6f28 2246 6974  logger.info("Fit
+000094a0: 7469 6e67 204d 6f64 656c 2229 0a20 2020  ting Model").   
+000094b0: 2020 2020 2020 2020 206d 6f64 656c 5f66           model_f
+000094c0: 6974 5f73 7461 7274 203d 2074 696d 652e  it_start = time.
+000094d0: 7469 6d65 2829 0a20 2020 2020 2020 2020  time().         
+000094e0: 2020 2077 6974 6820 7265 6469 7265 6374     with redirect
+000094f0: 5f6f 7574 7075 7428 7365 6c66 2e6c 6f67  _output(self.log
+00009500: 6765 7229 3a0a 2020 2020 2020 2020 2020  ger):.          
+00009510: 2020 2020 2020 7069 7065 6c69 6e65 5f77        pipeline_w
+00009520: 6974 685f 6d6f 6465 6c2e 6669 7428 6461  ith_model.fit(da
+00009530: 7461 5f58 2c20 6461 7461 5f79 2c20 2a2a  ta_X, data_y, **
+00009540: 6669 745f 6b77 6172 6773 290a 2020 2020  fit_kwargs).    
+00009550: 2020 2020 2020 2020 6d6f 6465 6c5f 6669          model_fi
+00009560: 745f 656e 6420 3d20 7469 6d65 2e74 696d  t_end = time.tim
+00009570: 6528 290a 0a20 2020 2020 2020 2020 2020  e()..           
+00009580: 206d 6f64 656c 5f66 6974 5f74 696d 6520   model_fit_time 
+00009590: 3d20 6e70 2e61 7272 6179 286d 6f64 656c  = np.array(model
+000095a0: 5f66 6974 5f65 6e64 202d 206d 6f64 656c  _fit_end - model
+000095b0: 5f66 6974 5f73 7461 7274 292e 726f 756e  _fit_start).roun
+000095c0: 6428 3229 0a0a 2020 2020 2020 2020 2020  d(2)..          
+000095d0: 2020 6469 7370 6c61 792e 6d6f 7665 5f70    display.move_p
+000095e0: 726f 6772 6573 7328 290a 0a20 2020 2020  rogress()..     
+000095f0: 2020 2020 2020 2069 6620 7072 6564 6963         if predic
+00009600: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+00009610: 2020 2069 6620 7265 7475 726e 5f74 7261     if return_tra
+00009620: 696e 5f73 636f 7265 3a0a 2020 2020 2020  in_score:.      
+00009630: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00009640: 6361 6c6c 2063 6c61 7373 2065 7870 6c69  call class expli
+00009650: 6369 746c 7920 746f 2067 6574 2061 6363  citly to get acc
+00009660: 6573 7320 746f 2070 7265 7072 6f63 6573  ess to preproces
+00009670: 7320 6172 670a 2020 2020 2020 2020 2020  s arg.          
+00009680: 2020 2020 2020 2020 2020 2320 696e 2073            # in s
+00009690: 7562 636c 6173 7365 730a 2020 2020 2020  ubclasses.      
+000096a0: 2020 2020 2020 2020 2020 2020 2020 5f53                _S
+000096b0: 7570 6572 7669 7365 6445 7870 6572 696d  upervisedExperim
+000096c0: 656e 742e 7072 6564 6963 745f 6d6f 6465  ent.predict_mode
+000096d0: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
+000096e0: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+000096f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009700: 2020 2020 2020 2020 2070 6970 656c 696e           pipelin
+00009710: 655f 7769 7468 5f6d 6f64 656c 2c0a 2020  e_with_model,.  
+00009720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009730: 2020 2020 2020 6461 7461 3d70 642e 636f        data=pd.co
+00009740: 6e63 6174 285b 6461 7461 5f58 2c20 6461  ncat([data_X, da
+00009750: 7461 5f79 5d2c 2061 7869 733d 3129 2c0a  ta_y], axis=1),.
+00009760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009770: 2020 2020 2020 2020 7665 7262 6f73 653d          verbose=
+00009780: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+00009790: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
 000097a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000097b0: 2020 2020 7472 6169 6e5f 7265 7375 6c74      train_result
-000097c0: 7320 3d20 7365 6c66 2e70 756c 6c28 706f  s = self.pull(po
-000097d0: 703d 5472 7565 292e 6472 6f70 2822 4d6f  p=True).drop("Mo
-000097e0: 6465 6c22 2c20 6178 6973 3d31 290a 2020  del", axis=1).  
-000097f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009800: 2020 7472 6169 6e5f 7265 7375 6c74 732e    train_results.
-00009810: 696e 6465 7820 3d20 5b22 5472 6169 6e22  index = ["Train"
-00009820: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00009830: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00009840: 2020 2020 2020 2020 2020 2020 7472 6169              trai
-00009850: 6e5f 7265 7375 6c74 7320 3d20 4e6f 6e65  n_results = None
-00009860: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00009870: 2020 7365 6c66 2e70 7265 6469 6374 5f6d    self.predict_m
-00009880: 6f64 656c 2870 6970 656c 696e 655f 7769  odel(pipeline_wi
-00009890: 7468 5f6d 6f64 656c 2c20 7665 7262 6f73  th_model, verbos
-000098a0: 653d 4661 6c73 6529 0a20 2020 2020 2020  e=False).       
-000098b0: 2020 2020 2020 2020 206d 6f64 656c 5f72           model_r
-000098c0: 6573 756c 7473 203d 2073 656c 662e 7075  esults = self.pu
-000098d0: 6c6c 2870 6f70 3d54 7275 6529 2e64 726f  ll(pop=True).dro
-000098e0: 7028 224d 6f64 656c 222c 2061 7869 733d  p("Model", axis=
-000098f0: 3129 0a20 2020 2020 2020 2020 2020 2020  1).             
-00009900: 2020 206d 6f64 656c 5f72 6573 756c 7473     model_results
-00009910: 2e69 6e64 6578 203d 205b 2254 6573 7422  .index = ["Test"
-00009920: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00009930: 2020 6966 2074 7261 696e 5f72 6573 756c    if train_resul
-00009940: 7473 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ts is not None:.
+000097b0: 2074 7261 696e 5f72 6573 756c 7473 203d   train_results =
+000097c0: 2073 656c 662e 7075 6c6c 2870 6f70 3d54   self.pull(pop=T
+000097d0: 7275 6529 2e64 726f 7028 224d 6f64 656c  rue).drop("Model
+000097e0: 222c 2061 7869 733d 3129 0a20 2020 2020  ", axis=1).     
+000097f0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00009800: 7261 696e 5f72 6573 756c 7473 2e69 6e64  rain_results.ind
+00009810: 6578 203d 205b 2254 7261 696e 225d 0a20  ex = ["Train"]. 
+00009820: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00009830: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00009840: 2020 2020 2020 2020 2074 7261 696e 5f72           train_r
+00009850: 6573 756c 7473 203d 204e 6f6e 650a 0a20  esults = None.. 
+00009860: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00009870: 656c 662e 7072 6564 6963 745f 6d6f 6465  elf.predict_mode
+00009880: 6c28 7069 7065 6c69 6e65 5f77 6974 685f  l(pipeline_with_
+00009890: 6d6f 6465 6c2c 2076 6572 626f 7365 3d46  model, verbose=F
+000098a0: 616c 7365 290a 2020 2020 2020 2020 2020  alse).          
+000098b0: 2020 2020 2020 6d6f 6465 6c5f 7265 7375        model_resu
+000098c0: 6c74 7320 3d20 7365 6c66 2e70 756c 6c28  lts = self.pull(
+000098d0: 706f 703d 5472 7565 292e 6472 6f70 2822  pop=True).drop("
+000098e0: 4d6f 6465 6c22 2c20 6178 6973 3d31 290a  Model", axis=1).
+000098f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009900: 6d6f 6465 6c5f 7265 7375 6c74 732e 696e  model_results.in
+00009910: 6465 7820 3d20 5b22 5465 7374 225d 0a20  dex = ["Test"]. 
+00009920: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00009930: 6620 7472 6169 6e5f 7265 7375 6c74 7320  f train_results 
+00009940: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
 00009950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009960: 2020 2020 6d6f 6465 6c5f 7265 7375 6c74      model_result
-00009970: 7320 3d20 7064 2e63 6f6e 6361 7428 5b6d  s = pd.concat([m
-00009980: 6f64 656c 5f72 6573 756c 7473 2c20 7472  odel_results, tr
-00009990: 6169 6e5f 7265 7375 6c74 735d 290a 0a20  ain_results]).. 
-000099a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000099b0: 656c 662e 5f64 6973 706c 6179 5f63 6f6e  elf._display_con
-000099c0: 7461 696e 6572 2e61 7070 656e 6428 6d6f  tainer.append(mo
-000099d0: 6465 6c5f 7265 7375 6c74 7329 0a0a 2020  del_results)..  
-000099e0: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-000099f0: 6465 6c5f 7265 7375 6c74 7320 3d20 6d6f  del_results = mo
-00009a00: 6465 6c5f 7265 7375 6c74 732e 7374 796c  del_results.styl
-00009a10: 652e 666f 726d 6174 2870 7265 6369 7369  e.format(precisi
-00009a20: 6f6e 3d72 6f75 6e64 290a 0a20 2020 2020  on=round)..     
-00009a30: 2020 2020 2020 2020 2020 2069 6620 7379             if sy
-00009a40: 7374 656d 3a0a 2020 2020 2020 2020 2020  stem:.          
-00009a50: 2020 2020 2020 2020 2020 6469 7370 6c61            displa
-00009a60: 792e 6469 7370 6c61 7928 6d6f 6465 6c5f  y.display(model_
-00009a70: 7265 7375 6c74 7329 0a0a 2020 2020 2020  results)..      
-00009a80: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-00009a90: 6f67 6765 722e 696e 666f 2866 225f 6469  ogger.info(f"_di
-00009aa0: 7370 6c61 795f 636f 6e74 6169 6e65 723a  splay_container:
-00009ab0: 207b 6c65 6e28 7365 6c66 2e5f 6469 7370   {len(self._disp
-00009ac0: 6c61 795f 636f 6e74 6169 6e65 7229 7d22  lay_container)}"
-00009ad0: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
-00009ae0: 6620 6e6f 7420 6d6f 6465 6c5f 6f6e 6c79  f not model_only
-00009af0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00009b00: 2020 7265 7475 726e 2070 6970 656c 696e    return pipelin
-00009b10: 655f 7769 7468 5f6d 6f64 656c 2c20 6d6f  e_with_model, mo
-00009b20: 6465 6c5f 6669 745f 7469 6d65 0a0a 2020  del_fit_time..  
-00009b30: 2020 2020 2020 7265 7475 726e 206d 6f64        return mod
-00009b40: 656c 2c20 6d6f 6465 6c5f 6669 745f 7469  el, model_fit_ti
-00009b50: 6d65 0a0a 2020 2020 6465 6620 5f63 7265  me..    def _cre
-00009b60: 6174 655f 6d6f 6465 6c5f 7769 7468 5f63  ate_model_with_c
-00009b70: 7628 0a20 2020 2020 2020 2073 656c 662c  v(.        self,
-00009b80: 0a20 2020 2020 2020 206d 6f64 656c 2c0a  .        model,.
-00009b90: 2020 2020 2020 2020 6461 7461 5f58 2c0a          data_X,.
-00009ba0: 2020 2020 2020 2020 6461 7461 5f79 2c0a          data_y,.
-00009bb0: 2020 2020 2020 2020 6669 745f 6b77 6172          fit_kwar
-00009bc0: 6773 2c0a 2020 2020 2020 2020 726f 756e  gs,.        roun
-00009bd0: 642c 0a20 2020 2020 2020 2063 762c 0a20  d,.        cv,. 
-00009be0: 2020 2020 2020 2067 726f 7570 732c 0a20         groups,. 
-00009bf0: 2020 2020 2020 206d 6574 7269 6373 2c0a         metrics,.
-00009c00: 2020 2020 2020 2020 7265 6669 742c 0a20          refit,. 
-00009c10: 2020 2020 2020 2073 7973 7465 6d2c 0a20         system,. 
-00009c20: 2020 2020 2020 2064 6973 706c 6179 2c0a         display,.
-00009c30: 2020 2020 2020 2020 7265 7475 726e 5f74          return_t
-00009c40: 7261 696e 5f73 636f 7265 3a20 626f 6f6c  rain_score: bool
-00009c50: 203d 2046 616c 7365 2c0a 2020 2020 293a   = False,.    ):
-00009c60: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00009c70: 2020 2020 204d 4f4e 4954 4f52 2055 5044       MONITOR UPD
-00009c80: 4154 4520 5354 4152 5453 0a20 2020 2020  ATE STARTS.     
-00009c90: 2020 2022 2222 0a20 2020 2020 2020 2064     """.        d
-00009ca0: 6973 706c 6179 2e75 7064 6174 655f 6d6f  isplay.update_mo
-00009cb0: 6e69 746f 7228 0a20 2020 2020 2020 2020  nitor(.         
-00009cc0: 2020 2031 2c0a 2020 2020 2020 2020 2020     1,.          
-00009cd0: 2020 6622 4669 7474 696e 6720 7b73 656c    f"Fitting {sel
-00009ce0: 662e 5f67 6574 5f63 765f 6e5f 666f 6c64  f._get_cv_n_fold
-00009cf0: 7328 6376 2c20 6461 7461 5f58 2c20 793d  s(cv, data_X, y=
-00009d00: 6461 7461 5f79 2c20 6772 6f75 7073 3d67  data_y, groups=g
-00009d10: 726f 7570 7329 7d20 466f 6c64 7322 2c0a  roups)} Folds",.
-00009d20: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00009d30: 2020 2222 220a 2020 2020 2020 2020 4d4f    """.        MO
-00009d40: 4e49 544f 5220 5550 4441 5445 2045 4e44  NITOR UPDATE END
-00009d50: 530a 2020 2020 2020 2020 2222 220a 0a20  S.        """.. 
-00009d60: 2020 2020 2020 2066 726f 6d20 736b 6c65         from skle
-00009d70: 6172 6e2e 6d6f 6465 6c5f 7365 6c65 6374  arn.model_select
-00009d80: 696f 6e20 696d 706f 7274 2063 726f 7373  ion import cross
-00009d90: 5f76 616c 6964 6174 650a 0a20 2020 2020  _validate..     
-00009da0: 2020 206d 6574 7269 6373 5f64 6963 7420     metrics_dict 
-00009db0: 3d20 6469 6374 285b 286b 2c20 762e 7363  = dict([(k, v.sc
-00009dc0: 6f72 6572 2920 666f 7220 6b2c 2076 2069  orer) for k, v i
-00009dd0: 6e20 6d65 7472 6963 732e 6974 656d 7328  n metrics.items(
-00009de0: 295d 290a 0a20 2020 2020 2020 2073 656c  )])..        sel
-00009df0: 662e 6c6f 6767 6572 2e69 6e66 6f28 2253  f.logger.info("S
-00009e00: 7461 7274 696e 6720 6372 6f73 7320 7661  tarting cross va
-00009e10: 6c69 6461 7469 6f6e 2229 0a0a 2020 2020  lidation")..    
-00009e20: 2020 2020 6e5f 6a6f 6273 203d 2073 656c      n_jobs = sel
-00009e30: 662e 6770 755f 6e5f 6a6f 6273 5f70 6172  f.gpu_n_jobs_par
-00009e40: 616d 0a20 2020 2020 2020 2066 726f 6d20  am.        from 
-00009e50: 736b 6c65 6172 6e2e 6761 7573 7369 616e  sklearn.gaussian
-00009e60: 5f70 726f 6365 7373 2069 6d70 6f72 7420  _process import 
-00009e70: 280a 2020 2020 2020 2020 2020 2020 4761  (.            Ga
-00009e80: 7573 7369 616e 5072 6f63 6573 7343 6c61  ussianProcessCla
-00009e90: 7373 6966 6965 722c 0a20 2020 2020 2020  ssifier,.       
-00009ea0: 2020 2020 2047 6175 7373 6961 6e50 726f       GaussianPro
-00009eb0: 6365 7373 5265 6772 6573 736f 722c 0a20  cessRegressor,. 
-00009ec0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00009ed0: 2020 2320 7370 6563 6961 6c20 6361 7365    # special case
-00009ee0: 2074 6f20 7072 6576 656e 7420 7275 6e6e   to prevent runn
-00009ef0: 696e 6720 6f75 7420 6f66 206d 656d 6f72  ing out of memor
-00009f00: 790a 2020 2020 2020 2020 6966 2069 7369  y.        if isi
-00009f10: 6e73 7461 6e63 6528 6d6f 6465 6c2c 2028  nstance(model, (
-00009f20: 4761 7573 7369 616e 5072 6f63 6573 7343  GaussianProcessC
-00009f30: 6c61 7373 6966 6965 722c 2047 6175 7373  lassifier, Gauss
-00009f40: 6961 6e50 726f 6365 7373 5265 6772 6573  ianProcessRegres
-00009f50: 736f 7229 293a 0a20 2020 2020 2020 2020  sor)):.         
-00009f60: 2020 206e 5f6a 6f62 7320 3d20 310a 0a20     n_jobs = 1.. 
-00009f70: 2020 2020 2020 2077 6974 6820 6573 7469         with esti
-00009f80: 6d61 746f 725f 7069 7065 6c69 6e65 2873  mator_pipeline(s
-00009f90: 656c 662e 7069 7065 6c69 6e65 2c20 6d6f  elf.pipeline, mo
-00009fa0: 6465 6c29 2061 7320 7069 7065 6c69 6e65  del) as pipeline
-00009fb0: 5f77 6974 685f 6d6f 6465 6c3a 0a20 2020  _with_model:.   
-00009fc0: 2020 2020 2020 2020 2066 6974 5f6b 7761           fit_kwa
-00009fd0: 7267 7320 3d20 6765 745f 7069 7065 6c69  rgs = get_pipeli
-00009fe0: 6e65 5f66 6974 5f6b 7761 7267 7328 7069  ne_fit_kwargs(pi
-00009ff0: 7065 6c69 6e65 5f77 6974 685f 6d6f 6465  peline_with_mode
-0000a000: 6c2c 2066 6974 5f6b 7761 7267 7329 0a20  l, fit_kwargs). 
-0000a010: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000a020: 6c6f 6767 6572 2e69 6e66 6f28 6622 4372  logger.info(f"Cr
-0000a030: 6f73 7320 7661 6c69 6461 7469 6e67 2077  oss validating w
-0000a040: 6974 6820 7b63 767d 2c20 6e5f 6a6f 6273  ith {cv}, n_jobs
-0000a050: 3d7b 6e5f 6a6f 6273 7d22 290a 0a20 2020  ={n_jobs}")..   
-0000a060: 2020 2020 2020 2020 206d 6f64 656c 5f66           model_f
-0000a070: 6974 5f73 7461 7274 203d 2074 696d 652e  it_start = time.
-0000a080: 7469 6d65 2829 0a20 2020 2020 2020 2020  time().         
-0000a090: 2020 2077 6974 6820 7265 6469 7265 6374     with redirect
-0000a0a0: 5f6f 7574 7075 7428 7365 6c66 2e6c 6f67  _output(self.log
-0000a0b0: 6765 7229 3a0a 2020 2020 2020 2020 2020  ger):.          
-0000a0c0: 2020 2020 2020 7363 6f72 6573 203d 2063        scores = c
-0000a0d0: 726f 7373 5f76 616c 6964 6174 6528 0a20  ross_validate(. 
+00009960: 206d 6f64 656c 5f72 6573 756c 7473 203d   model_results =
+00009970: 2070 642e 636f 6e63 6174 285b 6d6f 6465   pd.concat([mode
+00009980: 6c5f 7265 7375 6c74 732c 2074 7261 696e  l_results, train
+00009990: 5f72 6573 756c 7473 5d29 0a0a 2020 2020  _results])..    
+000099a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000099b0: 2e5f 6469 7370 6c61 795f 636f 6e74 6169  ._display_contai
+000099c0: 6e65 722e 6170 7065 6e64 286d 6f64 656c  ner.append(model
+000099d0: 5f72 6573 756c 7473 290a 0a20 2020 2020  _results)..     
+000099e0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+000099f0: 5f72 6573 756c 7473 203d 206d 6f64 656c  _results = model
+00009a00: 5f72 6573 756c 7473 2e73 7479 6c65 2e66  _results.style.f
+00009a10: 6f72 6d61 7428 7072 6563 6973 696f 6e3d  ormat(precision=
+00009a20: 726f 756e 6429 0a0a 2020 2020 2020 2020  round)..        
+00009a30: 2020 2020 2020 2020 6966 2073 7973 7465          if syste
+00009a40: 6d3a 0a20 2020 2020 2020 2020 2020 2020  m:.             
+00009a50: 2020 2020 2020 2064 6973 706c 6179 2e64         display.d
+00009a60: 6973 706c 6179 286d 6f64 656c 5f72 6573  isplay(model_res
+00009a70: 756c 7473 290a 0a20 2020 2020 2020 2020  ults)..         
+00009a80: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+00009a90: 6572 2e69 6e66 6f28 6622 5f64 6973 706c  er.info(f"_displ
+00009aa0: 6179 5f63 6f6e 7461 696e 6572 3a20 7b6c  ay_container: {l
+00009ab0: 656e 2873 656c 662e 5f64 6973 706c 6179  en(self._display
+00009ac0: 5f63 6f6e 7461 696e 6572 297d 2229 0a0a  _container)}")..
+00009ad0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00009ae0: 6f74 206d 6f64 656c 5f6f 6e6c 793a 0a20  ot model_only:. 
+00009af0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00009b00: 6574 7572 6e20 7069 7065 6c69 6e65 5f77  eturn pipeline_w
+00009b10: 6974 685f 6d6f 6465 6c2c 206d 6f64 656c  ith_model, model
+00009b20: 5f66 6974 5f74 696d 650a 0a20 2020 2020  _fit_time..     
+00009b30: 2020 2072 6574 7572 6e20 6d6f 6465 6c2c     return model,
+00009b40: 206d 6f64 656c 5f66 6974 5f74 696d 650a   model_fit_time.
+00009b50: 0a20 2020 2064 6566 205f 6372 6561 7465  .    def _create
+00009b60: 5f6d 6f64 656c 5f77 6974 685f 6376 280a  _model_with_cv(.
+00009b70: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00009b80: 2020 2020 2020 6d6f 6465 6c2c 0a20 2020        model,.   
+00009b90: 2020 2020 2064 6174 615f 582c 0a20 2020       data_X,.   
+00009ba0: 2020 2020 2064 6174 615f 792c 0a20 2020       data_y,.   
+00009bb0: 2020 2020 2066 6974 5f6b 7761 7267 732c       fit_kwargs,
+00009bc0: 0a20 2020 2020 2020 2072 6f75 6e64 2c0a  .        round,.
+00009bd0: 2020 2020 2020 2020 6376 2c0a 2020 2020          cv,.    
+00009be0: 2020 2020 6772 6f75 7073 2c0a 2020 2020      groups,.    
+00009bf0: 2020 2020 6d65 7472 6963 732c 0a20 2020      metrics,.   
+00009c00: 2020 2020 2072 6566 6974 2c0a 2020 2020       refit,.    
+00009c10: 2020 2020 7379 7374 656d 2c0a 2020 2020      system,.    
+00009c20: 2020 2020 6469 7370 6c61 792c 0a20 2020      display,.   
+00009c30: 2020 2020 2072 6574 7572 6e5f 7472 6169       return_trai
+00009c40: 6e5f 7363 6f72 653a 2062 6f6f 6c20 3d20  n_score: bool = 
+00009c50: 4661 6c73 652c 0a20 2020 2029 3a0a 2020  False,.    ):.  
+00009c60: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00009c70: 2020 4d4f 4e49 544f 5220 5550 4441 5445    MONITOR UPDATE
+00009c80: 2053 5441 5254 530a 2020 2020 2020 2020   STARTS.        
+00009c90: 2222 220a 2020 2020 2020 2020 6469 7370  """.        disp
+00009ca0: 6c61 792e 7570 6461 7465 5f6d 6f6e 6974  lay.update_monit
+00009cb0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00009cc0: 312c 0a20 2020 2020 2020 2020 2020 2066  1,.            f
+00009cd0: 2246 6974 7469 6e67 207b 7365 6c66 2e5f  "Fitting {self._
+00009ce0: 6765 745f 6376 5f6e 5f66 6f6c 6473 2863  get_cv_n_folds(c
+00009cf0: 762c 2064 6174 615f 582c 2079 3d64 6174  v, data_X, y=dat
+00009d00: 615f 792c 2067 726f 7570 733d 6772 6f75  a_y, groups=grou
+00009d10: 7073 297d 2046 6f6c 6473 222c 0a20 2020  ps)} Folds",.   
+00009d20: 2020 2020 2029 0a20 2020 2020 2020 2022       ).        "
+00009d30: 2222 0a20 2020 2020 2020 204d 4f4e 4954  "".        MONIT
+00009d40: 4f52 2055 5044 4154 4520 454e 4453 0a20  OR UPDATE ENDS. 
+00009d50: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00009d60: 2020 2020 6672 6f6d 2073 6b6c 6561 726e      from sklearn
+00009d70: 2e6d 6f64 656c 5f73 656c 6563 7469 6f6e  .model_selection
+00009d80: 2069 6d70 6f72 7420 6372 6f73 735f 7661   import cross_va
+00009d90: 6c69 6461 7465 0a0a 2020 2020 2020 2020  lidate..        
+00009da0: 6d65 7472 6963 735f 6469 6374 203d 2064  metrics_dict = d
+00009db0: 6963 7428 5b28 6b2c 2076 2e73 636f 7265  ict([(k, v.score
+00009dc0: 7229 2066 6f72 206b 2c20 7620 696e 206d  r) for k, v in m
+00009dd0: 6574 7269 6373 2e69 7465 6d73 2829 5d29  etrics.items()])
+00009de0: 0a0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+00009df0: 6f67 6765 722e 696e 666f 2822 5374 6172  ogger.info("Star
+00009e00: 7469 6e67 2063 726f 7373 2076 616c 6964  ting cross valid
+00009e10: 6174 696f 6e22 290a 0a20 2020 2020 2020  ation")..       
+00009e20: 206e 5f6a 6f62 7320 3d20 7365 6c66 2e67   n_jobs = self.g
+00009e30: 7075 5f6e 5f6a 6f62 735f 7061 7261 6d0a  pu_n_jobs_param.
+00009e40: 2020 2020 2020 2020 6672 6f6d 2073 6b6c          from skl
+00009e50: 6561 726e 2e67 6175 7373 6961 6e5f 7072  earn.gaussian_pr
+00009e60: 6f63 6573 7320 696d 706f 7274 2028 0a20  ocess import (. 
+00009e70: 2020 2020 2020 2020 2020 2047 6175 7373             Gauss
+00009e80: 6961 6e50 726f 6365 7373 436c 6173 7369  ianProcessClassi
+00009e90: 6669 6572 2c0a 2020 2020 2020 2020 2020  fier,.          
+00009ea0: 2020 4761 7573 7369 616e 5072 6f63 6573    GaussianProces
+00009eb0: 7352 6567 7265 7373 6f72 2c0a 2020 2020  sRegressor,.    
+00009ec0: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
+00009ed0: 2073 7065 6369 616c 2063 6173 6520 746f   special case to
+00009ee0: 2070 7265 7665 6e74 2072 756e 6e69 6e67   prevent running
+00009ef0: 206f 7574 206f 6620 6d65 6d6f 7279 0a20   out of memory. 
+00009f00: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00009f10: 616e 6365 286d 6f64 656c 2c20 2847 6175  ance(model, (Gau
+00009f20: 7373 6961 6e50 726f 6365 7373 436c 6173  ssianProcessClas
+00009f30: 7369 6669 6572 2c20 4761 7573 7369 616e  sifier, Gaussian
+00009f40: 5072 6f63 6573 7352 6567 7265 7373 6f72  ProcessRegressor
+00009f50: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+00009f60: 6e5f 6a6f 6273 203d 2031 0a0a 2020 2020  n_jobs = 1..    
+00009f70: 2020 2020 7769 7468 2065 7374 696d 6174      with estimat
+00009f80: 6f72 5f70 6970 656c 696e 6528 7365 6c66  or_pipeline(self
+00009f90: 2e70 6970 656c 696e 652c 206d 6f64 656c  .pipeline, model
+00009fa0: 2920 6173 2070 6970 656c 696e 655f 7769  ) as pipeline_wi
+00009fb0: 7468 5f6d 6f64 656c 3a0a 2020 2020 2020  th_model:.      
+00009fc0: 2020 2020 2020 6669 745f 6b77 6172 6773        fit_kwargs
+00009fd0: 203d 2067 6574 5f70 6970 656c 696e 655f   = get_pipeline_
+00009fe0: 6669 745f 6b77 6172 6773 2870 6970 656c  fit_kwargs(pipel
+00009ff0: 696e 655f 7769 7468 5f6d 6f64 656c 2c20  ine_with_model, 
+0000a000: 6669 745f 6b77 6172 6773 290a 2020 2020  fit_kwargs).    
+0000a010: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+0000a020: 6765 722e 696e 666f 2866 2243 726f 7373  ger.info(f"Cross
+0000a030: 2076 616c 6964 6174 696e 6720 7769 7468   validating with
+0000a040: 207b 6376 7d2c 206e 5f6a 6f62 733d 7b6e   {cv}, n_jobs={n
+0000a050: 5f6a 6f62 737d 2229 0a0a 2020 2020 2020  _jobs}")..      
+0000a060: 2020 2020 2020 6d6f 6465 6c5f 6669 745f        model_fit_
+0000a070: 7374 6172 7420 3d20 7469 6d65 2e74 696d  start = time.tim
+0000a080: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+0000a090: 7769 7468 2072 6564 6972 6563 745f 6f75  with redirect_ou
+0000a0a0: 7470 7574 2873 656c 662e 6c6f 6767 6572  tput(self.logger
+0000a0b0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0000a0c0: 2020 2073 636f 7265 7320 3d20 6372 6f73     scores = cros
+0000a0d0: 735f 7661 6c69 6461 7465 280a 2020 2020  s_validate(.    
 0000a0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a0f0: 2020 2070 6970 656c 696e 655f 7769 7468     pipeline_with
-0000a100: 5f6d 6f64 656c 2c0a 2020 2020 2020 2020  _model,.        
-0000a110: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0000a120: 5f58 2c0a 2020 2020 2020 2020 2020 2020  _X,.            
-0000a130: 2020 2020 2020 2020 6461 7461 5f79 2c0a          data_y,.
+0000a0f0: 7069 7065 6c69 6e65 5f77 6974 685f 6d6f  pipeline_with_mo
+0000a100: 6465 6c2c 0a20 2020 2020 2020 2020 2020  del,.           
+0000a110: 2020 2020 2020 2020 2064 6174 615f 582c           data_X,
+0000a120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a130: 2020 2020 2064 6174 615f 792c 0a20 2020       data_y,.   
 0000a140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a150: 2020 2020 6376 3d63 762c 0a20 2020 2020      cv=cv,.     
-0000a160: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-0000a170: 726f 7570 733d 6772 6f75 7073 2c0a 2020  roups=groups,.  
-0000a180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a190: 2020 7363 6f72 696e 673d 6d65 7472 6963    scoring=metric
-0000a1a0: 735f 6469 6374 2c0a 2020 2020 2020 2020  s_dict,.        
-0000a1b0: 2020 2020 2020 2020 2020 2020 6669 745f              fit_
-0000a1c0: 7061 7261 6d73 3d66 6974 5f6b 7761 7267  params=fit_kwarg
-0000a1d0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0000a1e0: 2020 2020 2020 206e 5f6a 6f62 733d 6e5f         n_jobs=n_
-0000a1f0: 6a6f 6273 2c0a 2020 2020 2020 2020 2020  jobs,.          
-0000a200: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000a210: 5f74 7261 696e 5f73 636f 7265 3d72 6574  _train_score=ret
-0000a220: 7572 6e5f 7472 6169 6e5f 7363 6f72 652c  urn_train_score,
-0000a230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a240: 2020 2020 2065 7272 6f72 5f73 636f 7265       error_score
-0000a250: 3d30 2c0a 2020 2020 2020 2020 2020 2020  =0,.            
-0000a260: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0000a270: 2020 6d6f 6465 6c5f 6669 745f 656e 6420    model_fit_end 
-0000a280: 3d20 7469 6d65 2e74 696d 6528 290a 2020  = time.time().  
-0000a290: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-0000a2a0: 6669 745f 7469 6d65 203d 206e 702e 6172  fit_time = np.ar
-0000a2b0: 7261 7928 6d6f 6465 6c5f 6669 745f 656e  ray(model_fit_en
-0000a2c0: 6420 2d20 6d6f 6465 6c5f 6669 745f 7374  d - model_fit_st
-0000a2d0: 6172 7429 2e72 6f75 6e64 2832 290a 0a20  art).round(2).. 
-0000a2e0: 2020 2020 2020 2020 2020 2073 636f 7265             score
-0000a2f0: 5f64 6963 7420 3d20 7b7d 0a20 2020 2020  _dict = {}.     
-0000a300: 2020 2020 2020 2066 6f72 206b 2c20 7620         for k, v 
-0000a310: 696e 206d 6574 7269 6373 2e69 7465 6d73  in metrics.items
-0000a320: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-0000a330: 2020 2020 7363 6f72 655f 6469 6374 5b76      score_dict[v
-0000a340: 2e64 6973 706c 6179 5f6e 616d 655d 203d  .display_name] =
-0000a350: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
-0000a360: 2020 2020 6966 2072 6574 7572 6e5f 7472      if return_tr
-0000a370: 6169 6e5f 7363 6f72 653a 0a20 2020 2020  ain_score:.     
-0000a380: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0000a390: 7261 696e 5f73 636f 7265 203d 2073 636f  rain_score = sco
-0000a3a0: 7265 735b 6622 7472 6169 6e5f 7b6b 7d22  res[f"train_{k}"
-0000a3b0: 5d20 2a20 280a 2020 2020 2020 2020 2020  ] * (.          
-0000a3c0: 2020 2020 2020 2020 2020 2020 2020 3120                1 
-0000a3d0: 6966 2076 2e67 7265 6174 6572 5f69 735f  if v.greater_is_
-0000a3e0: 6265 7474 6572 2065 6c73 6520 2d31 0a20  better else -1. 
+0000a150: 2063 763d 6376 2c0a 2020 2020 2020 2020   cv=cv,.        
+0000a160: 2020 2020 2020 2020 2020 2020 6772 6f75              grou
+0000a170: 7073 3d67 726f 7570 732c 0a20 2020 2020  ps=groups,.     
+0000a180: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000a190: 636f 7269 6e67 3d6d 6574 7269 6373 5f64  coring=metrics_d
+0000a1a0: 6963 742c 0a20 2020 2020 2020 2020 2020  ict,.           
+0000a1b0: 2020 2020 2020 2020 2066 6974 5f70 6172           fit_par
+0000a1c0: 616d 733d 6669 745f 6b77 6172 6773 2c0a  ams=fit_kwargs,.
+0000a1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a1e0: 2020 2020 6e5f 6a6f 6273 3d6e 5f6a 6f62      n_jobs=n_job
+0000a1f0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0000a200: 2020 2020 2020 2072 6574 7572 6e5f 7472         return_tr
+0000a210: 6169 6e5f 7363 6f72 653d 7265 7475 726e  ain_score=return
+0000a220: 5f74 7261 696e 5f73 636f 7265 2c0a 2020  _train_score,.  
+0000a230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a240: 2020 6572 726f 725f 7363 6f72 653d 302c    error_score=0,
+0000a250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a260: 2029 0a20 2020 2020 2020 2020 2020 206d   ).            m
+0000a270: 6f64 656c 5f66 6974 5f65 6e64 203d 2074  odel_fit_end = t
+0000a280: 696d 652e 7469 6d65 2829 0a20 2020 2020  ime.time().     
+0000a290: 2020 2020 2020 206d 6f64 656c 5f66 6974         model_fit
+0000a2a0: 5f74 696d 6520 3d20 6e70 2e61 7272 6179  _time = np.array
+0000a2b0: 286d 6f64 656c 5f66 6974 5f65 6e64 202d  (model_fit_end -
+0000a2c0: 206d 6f64 656c 5f66 6974 5f73 7461 7274   model_fit_start
+0000a2d0: 292e 726f 756e 6428 3229 0a0a 2020 2020  ).round(2)..    
+0000a2e0: 2020 2020 2020 2020 7363 6f72 655f 6469          score_di
+0000a2f0: 6374 203d 207b 7d0a 2020 2020 2020 2020  ct = {}.        
+0000a300: 2020 2020 666f 7220 6b2c 2076 2069 6e20      for k, v in 
+0000a310: 6d65 7472 6963 732e 6974 656d 7328 293a  metrics.items():
+0000a320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a330: 2073 636f 7265 5f64 6963 745b 762e 6469   score_dict[v.di
+0000a340: 7370 6c61 795f 6e61 6d65 5d20 3d20 5b5d  splay_name] = []
+0000a350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a360: 2069 6620 7265 7475 726e 5f74 7261 696e   if return_train
+0000a370: 5f73 636f 7265 3a0a 2020 2020 2020 2020  _score:.        
+0000a380: 2020 2020 2020 2020 2020 2020 7472 6169              trai
+0000a390: 6e5f 7363 6f72 6520 3d20 7363 6f72 6573  n_score = scores
+0000a3a0: 5b66 2274 7261 696e 5f7b 6b7d 225d 202a  [f"train_{k}"] *
+0000a3b0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+0000a3c0: 2020 2020 2020 2020 2020 2031 2069 6620             1 if 
+0000a3d0: 762e 6772 6561 7465 725f 6973 5f62 6574  v.greater_is_bet
+0000a3e0: 7465 7220 656c 7365 202d 310a 2020 2020  ter else -1.    
 0000a3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a400: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0000a410: 2020 2020 2020 2020 2074 7261 696e 5f73           train_s
-0000a420: 636f 7265 203d 2074 7261 696e 5f73 636f  core = train_sco
-0000a430: 7265 2e74 6f6c 6973 7428 290a 2020 2020  re.tolist().    
-0000a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a450: 7363 6f72 655f 6469 6374 5b76 2e64 6973  score_dict[v.dis
-0000a460: 706c 6179 5f6e 616d 655d 203d 2074 7261  play_name] = tra
-0000a470: 696e 5f73 636f 7265 0a20 2020 2020 2020  in_score.       
-0000a480: 2020 2020 2020 2020 2074 6573 745f 7363           test_sc
-0000a490: 6f72 6520 3d20 7363 6f72 6573 5b66 2274  ore = scores[f"t
-0000a4a0: 6573 745f 7b6b 7d22 5d20 2a20 2831 2069  est_{k}"] * (1 i
-0000a4b0: 6620 762e 6772 6561 7465 725f 6973 5f62  f v.greater_is_b
-0000a4c0: 6574 7465 7220 656c 7365 202d 3129 0a20  etter else -1). 
-0000a4d0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0000a4e0: 6573 745f 7363 6f72 6520 3d20 7465 7374  est_score = test
-0000a4f0: 5f73 636f 7265 2e74 6f6c 6973 7428 290a  _score.tolist().
-0000a500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a510: 7363 6f72 655f 6469 6374 5b76 2e64 6973  score_dict[v.dis
-0000a520: 706c 6179 5f6e 616d 655d 202b 3d20 7465  play_name] += te
-0000a530: 7374 5f73 636f 7265 0a0a 2020 2020 2020  st_score..      
-0000a540: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
-0000a550: 722e 696e 666f 2822 4361 6c63 756c 6174  r.info("Calculat
-0000a560: 696e 6720 6d65 616e 2061 6e64 2073 7464  ing mean and std
-0000a570: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
-0000a580: 6176 6773 5f64 6963 7420 3d20 7b7d 0a20  avgs_dict = {}. 
-0000a590: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
-0000a5a0: 2c20 7620 696e 206d 6574 7269 6373 2e69  , v in metrics.i
-0000a5b0: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
-0000a5c0: 2020 2020 2020 2020 6176 6773 5f64 6963          avgs_dic
-0000a5d0: 745b 762e 6469 7370 6c61 795f 6e61 6d65  t[v.display_name
-0000a5e0: 5d20 3d20 5b5d 0a20 2020 2020 2020 2020  ] = [].         
-0000a5f0: 2020 2020 2020 2069 6620 7265 7475 726e         if return
-0000a600: 5f74 7261 696e 5f73 636f 7265 3a0a 2020  _train_score:.  
-0000a610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a620: 2020 7472 6169 6e5f 7363 6f72 6520 3d20    train_score = 
-0000a630: 7363 6f72 6573 5b66 2274 7261 696e 5f7b  scores[f"train_{
-0000a640: 6b7d 225d 202a 2028 0a20 2020 2020 2020  k}"] * (.       
-0000a650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a660: 2031 2069 6620 762e 6772 6561 7465 725f   1 if v.greater_
-0000a670: 6973 5f62 6574 7465 7220 656c 7365 202d  is_better else -
-0000a680: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-0000a690: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000a6a0: 2020 2020 2020 2020 2020 2020 7472 6169              trai
-0000a6b0: 6e5f 7363 6f72 6520 3d20 7472 6169 6e5f  n_score = train_
-0000a6c0: 7363 6f72 652e 746f 6c69 7374 2829 0a20  score.tolist(). 
+0000a400: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000a410: 2020 2020 2020 7472 6169 6e5f 7363 6f72        train_scor
+0000a420: 6520 3d20 7472 6169 6e5f 7363 6f72 652e  e = train_score.
+0000a430: 746f 6c69 7374 2829 0a20 2020 2020 2020  tolist().       
+0000a440: 2020 2020 2020 2020 2020 2020 2073 636f               sco
+0000a450: 7265 5f64 6963 745b 762e 6469 7370 6c61  re_dict[v.displa
+0000a460: 795f 6e61 6d65 5d20 3d20 7472 6169 6e5f  y_name] = train_
+0000a470: 7363 6f72 650a 2020 2020 2020 2020 2020  score.          
+0000a480: 2020 2020 2020 7465 7374 5f73 636f 7265        test_score
+0000a490: 203d 2073 636f 7265 735b 6622 7465 7374   = scores[f"test
+0000a4a0: 5f7b 6b7d 225d 202a 2028 3120 6966 2076  _{k}"] * (1 if v
+0000a4b0: 2e67 7265 6174 6572 5f69 735f 6265 7474  .greater_is_bett
+0000a4c0: 6572 2065 6c73 6520 2d31 290a 2020 2020  er else -1).    
+0000a4d0: 2020 2020 2020 2020 2020 2020 7465 7374              test
+0000a4e0: 5f73 636f 7265 203d 2074 6573 745f 7363  _score = test_sc
+0000a4f0: 6f72 652e 746f 6c69 7374 2829 0a20 2020  ore.tolist().   
+0000a500: 2020 2020 2020 2020 2020 2020 2073 636f               sco
+0000a510: 7265 5f64 6963 745b 762e 6469 7370 6c61  re_dict[v.displa
+0000a520: 795f 6e61 6d65 5d20 2b3d 2074 6573 745f  y_name] += test_
+0000a530: 7363 6f72 650a 0a20 2020 2020 2020 2020  score..         
+0000a540: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
+0000a550: 6e66 6f28 2243 616c 6375 6c61 7469 6e67  nfo("Calculating
+0000a560: 206d 6561 6e20 616e 6420 7374 6422 290a   mean and std").
+0000a570: 0a20 2020 2020 2020 2020 2020 2061 7667  .            avg
+0000a580: 735f 6469 6374 203d 207b 7d0a 2020 2020  s_dict = {}.    
+0000a590: 2020 2020 2020 2020 666f 7220 6b2c 2076          for k, v
+0000a5a0: 2069 6e20 6d65 7472 6963 732e 6974 656d   in metrics.item
+0000a5b0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+0000a5c0: 2020 2020 2061 7667 735f 6469 6374 5b76       avgs_dict[v
+0000a5d0: 2e64 6973 706c 6179 5f6e 616d 655d 203d  .display_name] =
+0000a5e0: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
+0000a5f0: 2020 2020 6966 2072 6574 7572 6e5f 7472      if return_tr
+0000a600: 6169 6e5f 7363 6f72 653a 0a20 2020 2020  ain_score:.     
+0000a610: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0000a620: 7261 696e 5f73 636f 7265 203d 2073 636f  rain_score = sco
+0000a630: 7265 735b 6622 7472 6169 6e5f 7b6b 7d22  res[f"train_{k}"
+0000a640: 5d20 2a20 280a 2020 2020 2020 2020 2020  ] * (.          
+0000a650: 2020 2020 2020 2020 2020 2020 2020 3120                1 
+0000a660: 6966 2076 2e67 7265 6174 6572 5f69 735f  if v.greater_is_
+0000a670: 6265 7474 6572 2065 6c73 6520 2d31 0a20  better else -1. 
+0000a680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a690: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0000a6a0: 2020 2020 2020 2020 2074 7261 696e 5f73           train_s
+0000a6b0: 636f 7265 203d 2074 7261 696e 5f73 636f  core = train_sco
+0000a6c0: 7265 2e74 6f6c 6973 7428 290a 2020 2020  re.tolist().    
 0000a6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a6e0: 2020 2061 7667 735f 6469 6374 5b76 2e64     avgs_dict[v.d
-0000a6f0: 6973 706c 6179 5f6e 616d 655d 203d 205b  isplay_name] = [
-0000a700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a710: 2020 2020 2020 2020 206e 702e 6d65 616e           np.mean
-0000a720: 2874 7261 696e 5f73 636f 7265 292c 0a20  (train_score),. 
+0000a6e0: 6176 6773 5f64 6963 745b 762e 6469 7370  avgs_dict[v.disp
+0000a6f0: 6c61 795f 6e61 6d65 5d20 3d20 5b0a 2020  lay_name] = [.  
+0000a700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a710: 2020 2020 2020 6e70 2e6d 6561 6e28 7472        np.mean(tr
+0000a720: 6169 6e5f 7363 6f72 6529 2c0a 2020 2020  ain_score),.    
 0000a730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a740: 2020 2020 2020 206e 702e 7374 6428 7472         np.std(tr
-0000a750: 6169 6e5f 7363 6f72 6529 2c0a 2020 2020  ain_score),.    
-0000a760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a770: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0000a780: 2020 7465 7374 5f73 636f 7265 203d 2073    test_score = s
-0000a790: 636f 7265 735b 6622 7465 7374 5f7b 6b7d  cores[f"test_{k}
-0000a7a0: 225d 202a 2028 3120 6966 2076 2e67 7265  "] * (1 if v.gre
-0000a7b0: 6174 6572 5f69 735f 6265 7474 6572 2065  ater_is_better e
-0000a7c0: 6c73 6520 2d31 290a 2020 2020 2020 2020  lse -1).        
-0000a7d0: 2020 2020 2020 2020 7465 7374 5f73 636f          test_sco
-0000a7e0: 7265 203d 2074 6573 745f 7363 6f72 652e  re = test_score.
-0000a7f0: 746f 6c69 7374 2829 0a20 2020 2020 2020  tolist().       
-0000a800: 2020 2020 2020 2020 2061 7667 735f 6469           avgs_di
-0000a810: 6374 5b76 2e64 6973 706c 6179 5f6e 616d  ct[v.display_nam
-0000a820: 655d 202b 3d20 5b6e 702e 6d65 616e 2874  e] += [np.mean(t
-0000a830: 6573 745f 7363 6f72 6529 2c20 6e70 2e73  est_score), np.s
-0000a840: 7464 2874 6573 745f 7363 6f72 6529 5d0a  td(test_score)].
-0000a850: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
-0000a860: 706c 6179 2e6d 6f76 655f 7072 6f67 7265  play.move_progre
-0000a870: 7373 2829 0a0a 2020 2020 2020 2020 2020  ss()..          
-0000a880: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
-0000a890: 666f 2822 4372 6561 7469 6e67 206d 6574  fo("Creating met
-0000a8a0: 7269 6373 2064 6174 6166 7261 6d65 2229  rics dataframe")
-0000a8b0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0000a8c0: 2068 6173 6174 7472 2863 762c 2022 6e5f   hasattr(cv, "n_
-0000a8d0: 7370 6c69 7473 2229 3a0a 2020 2020 2020  splits"):.      
-0000a8e0: 2020 2020 2020 2020 2020 666f 6c64 203d            fold =
-0000a8f0: 2063 762e 6e5f 7370 6c69 7473 0a20 2020   cv.n_splits.   
-0000a900: 2020 2020 2020 2020 2065 6c69 6620 6861           elif ha
-0000a910: 7361 7474 7228 6376 2c20 2267 6574 5f6e  sattr(cv, "get_n
-0000a920: 5f73 706c 6974 7322 293a 0a20 2020 2020  _splits"):.     
-0000a930: 2020 2020 2020 2020 2020 2066 6f6c 6420             fold 
-0000a940: 3d20 6376 2e67 6574 5f6e 5f73 706c 6974  = cv.get_n_split
-0000a950: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
-0000a960: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000a970: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0000a980: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-0000a990: 2020 2020 2020 2020 2020 2020 2254 6865              "The
-0000a9a0: 2063 726f 7373 2076 616c 6964 6174 696f   cross validatio
-0000a9b0: 6e20 636c 6173 7320 7368 6f75 6c64 2069  n class should i
-0000a9c0: 6d70 6c65 6d65 6e74 2061 206e 5f73 706c  mplement a n_spl
-0000a9d0: 6974 7320 220a 2020 2020 2020 2020 2020  its ".          
-0000a9e0: 2020 2020 2020 2020 2020 6622 6174 7472            f"attr
-0000a9f0: 6962 7574 6520 6f72 2061 2067 6574 5f6e  ibute or a get_n
-0000aa00: 5f73 706c 6974 7320 6d65 7468 6f64 2e20  _splits method. 
-0000aa10: 7b63 762e 5f5f 636c 6173 735f 5f2e 5f5f  {cv.__class__.__
-0000aa20: 6e61 6d65 5f5f 7d20 220a 2020 2020 2020  name__} ".      
-0000aa30: 2020 2020 2020 2020 2020 2020 2020 2268                "h
-0000aa40: 6173 206e 6569 7468 6572 2e22 0a20 2020  as neither.".   
-0000aa50: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
-0000aa60: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-0000aa70: 6574 7572 6e5f 7472 6169 6e5f 7363 6f72  eturn_train_scor
-0000aa80: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0000aa90: 2020 206d 6f64 656c 5f72 6573 756c 7473     model_results
-0000aaa0: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-0000aab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000aac0: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-0000aad0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000aae0: 5370 6c69 7422 3a20 5b22 4356 2d54 7261  Split": ["CV-Tra
-0000aaf0: 696e 225d 202a 2066 6f6c 640a 2020 2020  in"] * fold.    
+0000a740: 2020 2020 6e70 2e73 7464 2874 7261 696e      np.std(train
+0000a750: 5f73 636f 7265 292c 0a20 2020 2020 2020  _score),.       
+0000a760: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+0000a770: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0000a780: 6573 745f 7363 6f72 6520 3d20 7363 6f72  est_score = scor
+0000a790: 6573 5b66 2274 6573 745f 7b6b 7d22 5d20  es[f"test_{k}"] 
+0000a7a0: 2a20 2831 2069 6620 762e 6772 6561 7465  * (1 if v.greate
+0000a7b0: 725f 6973 5f62 6574 7465 7220 656c 7365  r_is_better else
+0000a7c0: 202d 3129 0a20 2020 2020 2020 2020 2020   -1).           
+0000a7d0: 2020 2020 2074 6573 745f 7363 6f72 6520       test_score 
+0000a7e0: 3d20 7465 7374 5f73 636f 7265 2e74 6f6c  = test_score.tol
+0000a7f0: 6973 7428 290a 2020 2020 2020 2020 2020  ist().          
+0000a800: 2020 2020 2020 6176 6773 5f64 6963 745b        avgs_dict[
+0000a810: 762e 6469 7370 6c61 795f 6e61 6d65 5d20  v.display_name] 
+0000a820: 2b3d 205b 6e70 2e6d 6561 6e28 7465 7374  += [np.mean(test
+0000a830: 5f73 636f 7265 292c 206e 702e 7374 6428  _score), np.std(
+0000a840: 7465 7374 5f73 636f 7265 295d 0a0a 2020  test_score)]..  
+0000a850: 2020 2020 2020 2020 2020 6469 7370 6c61            displa
+0000a860: 792e 6d6f 7665 5f70 726f 6772 6573 7328  y.move_progress(
+0000a870: 290a 0a20 2020 2020 2020 2020 2020 2073  )..            s
+0000a880: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
+0000a890: 2243 7265 6174 696e 6720 6d65 7472 6963  "Creating metric
+0000a8a0: 7320 6461 7461 6672 616d 6522 290a 0a20  s dataframe").. 
+0000a8b0: 2020 2020 2020 2020 2020 2069 6620 6861             if ha
+0000a8c0: 7361 7474 7228 6376 2c20 226e 5f73 706c  sattr(cv, "n_spl
+0000a8d0: 6974 7322 293a 0a20 2020 2020 2020 2020  its"):.         
+0000a8e0: 2020 2020 2020 2066 6f6c 6420 3d20 6376         fold = cv
+0000a8f0: 2e6e 5f73 706c 6974 730a 2020 2020 2020  .n_splits.      
+0000a900: 2020 2020 2020 656c 6966 2068 6173 6174        elif hasat
+0000a910: 7472 2863 762c 2022 6765 745f 6e5f 7370  tr(cv, "get_n_sp
+0000a920: 6c69 7473 2229 3a0a 2020 2020 2020 2020  lits"):.        
+0000a930: 2020 2020 2020 2020 666f 6c64 203d 2063          fold = c
+0000a940: 762e 6765 745f 6e5f 7370 6c69 7473 2829  v.get_n_splits()
+0000a950: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0000a960: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0000a970: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0000a980: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+0000a990: 2020 2020 2020 2020 2022 5468 6520 6372           "The cr
+0000a9a0: 6f73 7320 7661 6c69 6461 7469 6f6e 2063  oss validation c
+0000a9b0: 6c61 7373 2073 686f 756c 6420 696d 706c  lass should impl
+0000a9c0: 656d 656e 7420 6120 6e5f 7370 6c69 7473  ement a n_splits
+0000a9d0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0000a9e0: 2020 2020 2020 2066 2261 7474 7269 6275         f"attribu
+0000a9f0: 7465 206f 7220 6120 6765 745f 6e5f 7370  te or a get_n_sp
+0000aa00: 6c69 7473 206d 6574 686f 642e 207b 6376  lits method. {cv
+0000aa10: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
+0000aa20: 655f 5f7d 2022 0a20 2020 2020 2020 2020  e__} ".         
+0000aa30: 2020 2020 2020 2020 2020 2022 6861 7320             "has 
+0000aa40: 6e65 6974 6865 722e 220a 2020 2020 2020  neither.".      
+0000aa50: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0000aa60: 2020 2020 2020 2020 2069 6620 7265 7475           if retu
+0000aa70: 726e 5f74 7261 696e 5f73 636f 7265 3a0a  rn_train_score:.
+0000aa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aa90: 6d6f 6465 6c5f 7265 7375 6c74 7320 3d20  model_results = 
+0000aaa0: 7064 2e44 6174 6146 7261 6d65 280a 2020  pd.DataFrame(.  
+0000aab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aac0: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+0000aad0: 2020 2020 2020 2020 2020 2020 2253 706c              "Spl
+0000aae0: 6974 223a 205b 2243 562d 5472 6169 6e22  it": ["CV-Train"
+0000aaf0: 5d20 2a20 666f 6c64 0a20 2020 2020 2020  ] * fold.       
 0000ab00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ab10: 2020 2020 2b20 5b22 4356 2d56 616c 225d      + ["CV-Val"]
-0000ab20: 202a 2066 6f6c 640a 2020 2020 2020 2020   * fold.        
-0000ab30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ab40: 2b20 5b22 4356 2d54 7261 696e 225d 202a  + ["CV-Train"] *
-0000ab50: 2032 0a20 2020 2020 2020 2020 2020 2020   2.             
-0000ab60: 2020 2020 2020 2020 2020 202b 205b 2243             + ["C
-0000ab70: 562d 5661 6c22 5d20 2a20 322c 0a20 2020  V-Val"] * 2,.   
+0000ab10: 202b 205b 2243 562d 5661 6c22 5d20 2a20   + ["CV-Val"] * 
+0000ab20: 666f 6c64 0a20 2020 2020 2020 2020 2020  fold.           
+0000ab30: 2020 2020 2020 2020 2020 2020 202b 205b               + [
+0000ab40: 2243 562d 5472 6169 6e22 5d20 2a20 320a  "CV-Train"] * 2.
+0000ab50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ab60: 2020 2020 2020 2020 2b20 5b22 4356 2d56          + ["CV-V
+0000ab70: 616c 225d 202a 2032 2c0a 2020 2020 2020  al"] * 2,.      
 0000ab80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ab90: 2020 2020 2022 466f 6c64 223a 206e 702e       "Fold": np.
-0000aba0: 6172 616e 6765 2866 6f6c 6429 2e74 6f6c  arange(fold).tol
-0000abb0: 6973 7428 290a 2020 2020 2020 2020 2020  ist().          
-0000abc0: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
-0000abd0: 6e70 2e61 7261 6e67 6528 666f 6c64 292e  np.arange(fold).
-0000abe0: 746f 6c69 7374 2829 0a20 2020 2020 2020  tolist().       
-0000abf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ac00: 202b 205b 224d 6561 6e22 2c20 2253 7464   + ["Mean", "Std
-0000ac10: 225d 202a 2032 2c0a 2020 2020 2020 2020  "] * 2,.        
-0000ac20: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-0000ac30: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0000ac40: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0000ac50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000ac60: 2020 6d6f 6465 6c5f 7265 7375 6c74 7320    model_results 
-0000ac70: 3d20 7064 2e44 6174 6146 7261 6d65 280a  = pd.DataFrame(.
+0000ab90: 2020 2246 6f6c 6422 3a20 6e70 2e61 7261    "Fold": np.ara
+0000aba0: 6e67 6528 666f 6c64 292e 746f 6c69 7374  nge(fold).tolist
+0000abb0: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+0000abc0: 2020 2020 2020 2020 2020 202b 206e 702e             + np.
+0000abd0: 6172 616e 6765 2866 6f6c 6429 2e74 6f6c  arange(fold).tol
+0000abe0: 6973 7428 290a 2020 2020 2020 2020 2020  ist().          
+0000abf0: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
+0000ac00: 5b22 4d65 616e 222c 2022 5374 6422 5d20  ["Mean", "Std"] 
+0000ac10: 2a20 322c 0a20 2020 2020 2020 2020 2020  * 2,.           
+0000ac20: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+0000ac30: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000ac40: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0000ac50: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0000ac60: 6f64 656c 5f72 6573 756c 7473 203d 2070  odel_results = p
+0000ac70: 642e 4461 7461 4672 616d 6528 0a20 2020  d.DataFrame(.   
 0000ac80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ac90: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
-0000aca0: 2020 2020 2020 2020 2020 2020 2020 2246                "F
-0000acb0: 6f6c 6422 3a20 6e70 2e61 7261 6e67 6528  old": np.arange(
-0000acc0: 666f 6c64 292e 746f 6c69 7374 2829 202b  fold).tolist() +
-0000acd0: 205b 224d 6561 6e22 2c20 2253 7464 225d   ["Mean", "Std"]
-0000ace0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000acf0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-0000ad00: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0000ad10: 2020 2020 2020 206d 6f64 656c 5f73 636f         model_sco
-0000ad20: 7265 7320 3d20 7064 2e63 6f6e 6361 7428  res = pd.concat(
-0000ad30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ad40: 205b 7064 2e44 6174 6146 7261 6d65 2873   [pd.DataFrame(s
-0000ad50: 636f 7265 5f64 6963 7429 2c20 7064 2e44  core_dict), pd.D
-0000ad60: 6174 6146 7261 6d65 2861 7667 735f 6469  ataFrame(avgs_di
-0000ad70: 6374 295d 0a20 2020 2020 2020 2020 2020  ct)].           
-0000ad80: 2029 2e72 6573 6574 5f69 6e64 6578 2864   ).reset_index(d
-0000ad90: 726f 703d 5472 7565 290a 0a20 2020 2020  rop=True)..     
-0000ada0: 2020 2020 2020 206d 6f64 656c 5f72 6573         model_res
-0000adb0: 756c 7473 203d 2070 642e 636f 6e63 6174  ults = pd.concat
-0000adc0: 285b 6d6f 6465 6c5f 7265 7375 6c74 732c  ([model_results,
-0000add0: 206d 6f64 656c 5f73 636f 7265 735d 2c20   model_scores], 
-0000ade0: 6178 6973 3d31 290a 2020 2020 2020 2020  axis=1).        
-0000adf0: 2020 2020 6d6f 6465 6c5f 7265 7375 6c74      model_result
-0000ae00: 732e 7365 745f 696e 6465 7828 0a20 2020  s.set_index(.   
-0000ae10: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000ae20: 662e 5f67 6574 5f72 6574 7572 6e5f 7472  f._get_return_tr
-0000ae30: 6169 6e5f 7363 6f72 655f 636f 6c75 6d6e  ain_score_column
-0000ae40: 735f 666f 725f 6469 7370 6c61 7928 7265  s_for_display(re
-0000ae50: 7475 726e 5f74 7261 696e 5f73 636f 7265  turn_train_score
-0000ae60: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0000ae70: 2020 2069 6e70 6c61 6365 3d54 7275 652c     inplace=True,
-0000ae80: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-0000ae90: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-0000aea0: 6566 6974 3a0a 2020 2020 2020 2020 2020  efit:.          
-0000aeb0: 2020 2020 2020 2320 7265 6669 7474 696e        # refittin
-0000aec0: 6720 7468 6520 6d6f 6465 6c20 6f6e 2063  g the model on c
-0000aed0: 6f6d 706c 6574 6520 585f 7472 6169 6e2c  omplete X_train,
-0000aee0: 2079 5f74 7261 696e 0a20 2020 2020 2020   y_train.       
-0000aef0: 2020 2020 2020 2020 2064 6973 706c 6179           display
-0000af00: 2e75 7064 6174 655f 6d6f 6e69 746f 7228  .update_monitor(
-0000af10: 312c 2022 4669 6e61 6c69 7a69 6e67 204d  1, "Finalizing M
-0000af20: 6f64 656c 2229 0a20 2020 2020 2020 2020  odel").         
-0000af30: 2020 2020 2020 206d 6f64 656c 5f66 6974         model_fit
-0000af40: 5f73 7461 7274 203d 2074 696d 652e 7469  _start = time.ti
-0000af50: 6d65 2829 0a20 2020 2020 2020 2020 2020  me().           
-0000af60: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
-0000af70: 2e69 6e66 6f28 2246 696e 616c 697a 696e  .info("Finalizin
-0000af80: 6720 6d6f 6465 6c22 290a 2020 2020 2020  g model").      
-0000af90: 2020 2020 2020 2020 2020 7769 7468 2072            with r
-0000afa0: 6564 6972 6563 745f 6f75 7470 7574 2873  edirect_output(s
-0000afb0: 656c 662e 6c6f 6767 6572 293a 0a20 2020  elf.logger):.   
-0000afc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000afd0: 2070 6970 656c 696e 655f 7769 7468 5f6d   pipeline_with_m
-0000afe0: 6f64 656c 2e66 6974 2864 6174 615f 582c  odel.fit(data_X,
-0000aff0: 2064 6174 615f 792c 202a 2a66 6974 5f6b   data_y, **fit_k
-0000b000: 7761 7267 7329 0a20 2020 2020 2020 2020  wargs).         
-0000b010: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-0000b020: 5f66 6974 5f65 6e64 203d 2074 696d 652e  _fit_end = time.
-0000b030: 7469 6d65 2829 0a0a 2020 2020 2020 2020  time()..        
-0000b040: 2020 2020 2020 2020 2320 6361 6c63 756c          # calcul
-0000b050: 6174 696e 6720 6d65 7472 6963 7320 6f6e  ating metrics on
-0000b060: 2070 7265 6469 6374 696f 6e73 206f 6620   predictions of 
-0000b070: 636f 6d70 6c65 7465 2074 7261 696e 2064  complete train d
-0000b080: 6174 6173 6574 0a20 2020 2020 2020 2020  ataset.         
-0000b090: 2020 2020 2020 2069 6620 7265 7475 726e         if return
-0000b0a0: 5f74 7261 696e 5f73 636f 7265 3a0a 2020  _train_score:.  
-0000b0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b0c0: 2020 2320 6361 6c6c 2063 6c61 7373 2065    # call class e
-0000b0d0: 7870 6c69 6369 746c 7920 746f 2067 6574  xplicitly to get
-0000b0e0: 2061 6363 6573 7320 746f 2070 7265 7072   access to prepr
-0000b0f0: 6f63 6573 7320 6172 670a 2020 2020 2020  ocess arg.      
-0000b100: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0000b110: 696e 2073 7562 636c 6173 7365 730a 2020  in subclasses.  
-0000b120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b130: 2020 5f53 7570 6572 7669 7365 6445 7870    _SupervisedExp
-0000b140: 6572 696d 656e 742e 7072 6564 6963 745f  eriment.predict_
-0000b150: 6d6f 6465 6c28 0a20 2020 2020 2020 2020  model(.         
-0000b160: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000b170: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-0000b180: 2020 2020 2020 2020 2020 2020 2070 6970               pip
-0000b190: 656c 696e 655f 7769 7468 5f6d 6f64 656c  eline_with_model
-0000b1a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000b1b0: 2020 2020 2020 2020 2020 6461 7461 3d70            data=p
-0000b1c0: 642e 636f 6e63 6174 285b 6461 7461 5f58  d.concat([data_X
-0000b1d0: 2c20 6461 7461 5f79 5d2c 2061 7869 733d  , data_y], axis=
-0000b1e0: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
-0000b1f0: 2020 2020 2020 2020 2020 2020 7665 7262              verb
-0000b200: 6f73 653d 4661 6c73 652c 0a20 2020 2020  ose=False,.     
-0000b210: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0000b220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b230: 2020 2020 206d 6574 7269 6373 203d 2073       metrics = s
-0000b240: 656c 662e 7075 6c6c 2870 6f70 3d54 7275  elf.pull(pop=Tru
-0000b250: 6529 2e64 726f 7028 224d 6f64 656c 222c  e).drop("Model",
-0000b260: 2061 7869 733d 3129 0a20 2020 2020 2020   axis=1).       
-0000b270: 2020 2020 2020 2020 2020 2020 2064 665f               df_
-0000b280: 7363 6f72 6520 3d20 7064 2e44 6174 6146  score = pd.DataF
-0000b290: 7261 6d65 287b 2253 706c 6974 223a 205b  rame({"Split": [
-0000b2a0: 2254 7261 696e 225d 2c20 2246 6f6c 6422  "Train"], "Fold"
-0000b2b0: 3a20 5b4e 6f6e 655d 7d29 0a20 2020 2020  : [None]}).     
-0000b2c0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0000b2d0: 665f 7363 6f72 6520 3d20 7064 2e63 6f6e  f_score = pd.con
-0000b2e0: 6361 7428 5b64 665f 7363 6f72 652c 206d  cat([df_score, m
-0000b2f0: 6574 7269 6373 5d2c 2061 7869 733d 3129  etrics], axis=1)
-0000b300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b310: 2020 2020 2064 665f 7363 6f72 652e 7365       df_score.se
-0000b320: 745f 696e 6465 7828 5b22 5370 6c69 7422  t_index(["Split"
-0000b330: 2c20 2246 6f6c 6422 5d2c 2069 6e70 6c61  , "Fold"], inpla
-0000b340: 6365 3d54 7275 6529 0a0a 2020 2020 2020  ce=True)..      
-0000b350: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0000b360: 636f 6e63 6174 656e 6174 696e 6720 7472  concatenating tr
-0000b370: 6169 6e20 7265 7375 6c74 7320 746f 2063  ain results to c
-0000b380: 726f 7373 2d76 616c 6964 6174 696f 6e20  ross-validation 
-0000b390: 736f 6372 6520 6461 7461 6672 616d 650a  socre dataframe.
+0000ac90: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0000aca0: 2020 2020 2020 2020 2020 2022 466f 6c64             "Fold
+0000acb0: 223a 206e 702e 6172 616e 6765 2866 6f6c  ": np.arange(fol
+0000acc0: 6429 2e74 6f6c 6973 7428 2920 2b20 5b22  d).tolist() + ["
+0000acd0: 4d65 616e 222c 2022 5374 6422 5d2c 0a20  Mean", "Std"],. 
+0000ace0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000acf0: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+0000ad00: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0000ad10: 2020 2020 6d6f 6465 6c5f 7363 6f72 6573      model_scores
+0000ad20: 203d 2070 642e 636f 6e63 6174 280a 2020   = pd.concat(.  
+0000ad30: 2020 2020 2020 2020 2020 2020 2020 5b70                [p
+0000ad40: 642e 4461 7461 4672 616d 6528 7363 6f72  d.DataFrame(scor
+0000ad50: 655f 6469 6374 292c 2070 642e 4461 7461  e_dict), pd.Data
+0000ad60: 4672 616d 6528 6176 6773 5f64 6963 7429  Frame(avgs_dict)
+0000ad70: 5d0a 2020 2020 2020 2020 2020 2020 292e  ].            ).
+0000ad80: 7265 7365 745f 696e 6465 7828 6472 6f70  reset_index(drop
+0000ad90: 3d54 7275 6529 0a0a 2020 2020 2020 2020  =True)..        
+0000ada0: 2020 2020 6d6f 6465 6c5f 7265 7375 6c74      model_result
+0000adb0: 7320 3d20 7064 2e63 6f6e 6361 7428 5b6d  s = pd.concat([m
+0000adc0: 6f64 656c 5f72 6573 756c 7473 2c20 6d6f  odel_results, mo
+0000add0: 6465 6c5f 7363 6f72 6573 5d2c 2061 7869  del_scores], axi
+0000ade0: 733d 3129 0a20 2020 2020 2020 2020 2020  s=1).           
+0000adf0: 206d 6f64 656c 5f72 6573 756c 7473 2e73   model_results.s
+0000ae00: 6574 5f69 6e64 6578 280a 2020 2020 2020  et_index(.      
+0000ae10: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0000ae20: 6765 745f 7265 7475 726e 5f74 7261 696e  get_return_train
+0000ae30: 5f73 636f 7265 5f63 6f6c 756d 6e73 5f66  _score_columns_f
+0000ae40: 6f72 5f64 6973 706c 6179 2872 6574 7572  or_display(retur
+0000ae50: 6e5f 7472 6169 6e5f 7363 6f72 6529 2c0a  n_train_score),.
+0000ae60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ae70: 696e 706c 6163 653d 5472 7565 2c0a 2020  inplace=True,.  
+0000ae80: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0000ae90: 2020 2020 2020 2020 2069 6620 7265 6669           if refi
+0000aea0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+0000aeb0: 2020 2023 2072 6566 6974 7469 6e67 2074     # refitting t
+0000aec0: 6865 206d 6f64 656c 206f 6e20 636f 6d70  he model on comp
+0000aed0: 6c65 7465 2058 5f74 7261 696e 2c20 795f  lete X_train, y_
+0000aee0: 7472 6169 6e0a 2020 2020 2020 2020 2020  train.          
+0000aef0: 2020 2020 2020 6469 7370 6c61 792e 7570        display.up
+0000af00: 6461 7465 5f6d 6f6e 6974 6f72 2831 2c20  date_monitor(1, 
+0000af10: 2246 696e 616c 697a 696e 6720 4d6f 6465  "Finalizing Mode
+0000af20: 6c22 290a 2020 2020 2020 2020 2020 2020  l").            
+0000af30: 2020 2020 6d6f 6465 6c5f 6669 745f 7374      model_fit_st
+0000af40: 6172 7420 3d20 7469 6d65 2e74 696d 6528  art = time.time(
+0000af50: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000af60: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
+0000af70: 666f 2822 4669 6e61 6c69 7a69 6e67 206d  fo("Finalizing m
+0000af80: 6f64 656c 2229 0a20 2020 2020 2020 2020  odel").         
+0000af90: 2020 2020 2020 2077 6974 6820 7265 6469         with redi
+0000afa0: 7265 6374 5f6f 7574 7075 7428 7365 6c66  rect_output(self
+0000afb0: 2e6c 6f67 6765 7229 3a0a 2020 2020 2020  .logger):.      
+0000afc0: 2020 2020 2020 2020 2020 2020 2020 7069                pi
+0000afd0: 7065 6c69 6e65 5f77 6974 685f 6d6f 6465  peline_with_mode
+0000afe0: 6c2e 6669 7428 6461 7461 5f58 2c20 6461  l.fit(data_X, da
+0000aff0: 7461 5f79 2c20 2a2a 6669 745f 6b77 6172  ta_y, **fit_kwar
+0000b000: 6773 290a 2020 2020 2020 2020 2020 2020  gs).            
+0000b010: 2020 2020 2020 2020 6d6f 6465 6c5f 6669          model_fi
+0000b020: 745f 656e 6420 3d20 7469 6d65 2e74 696d  t_end = time.tim
+0000b030: 6528 290a 0a20 2020 2020 2020 2020 2020  e()..           
+0000b040: 2020 2020 2023 2063 616c 6375 6c61 7469       # calculati
+0000b050: 6e67 206d 6574 7269 6373 206f 6e20 7072  ng metrics on pr
+0000b060: 6564 6963 7469 6f6e 7320 6f66 2063 6f6d  edictions of com
+0000b070: 706c 6574 6520 7472 6169 6e20 6461 7461  plete train data
+0000b080: 7365 740a 2020 2020 2020 2020 2020 2020  set.            
+0000b090: 2020 2020 6966 2072 6574 7572 6e5f 7472      if return_tr
+0000b0a0: 6169 6e5f 7363 6f72 653a 0a20 2020 2020  ain_score:.     
+0000b0b0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000b0c0: 2063 616c 6c20 636c 6173 7320 6578 706c   call class expl
+0000b0d0: 6963 6974 6c79 2074 6f20 6765 7420 6163  icitly to get ac
+0000b0e0: 6365 7373 2074 6f20 7072 6570 726f 6365  cess to preproce
+0000b0f0: 7373 2061 7267 0a20 2020 2020 2020 2020  ss arg.         
+0000b100: 2020 2020 2020 2020 2020 2023 2069 6e20             # in 
+0000b110: 7375 6263 6c61 7373 6573 0a20 2020 2020  subclasses.     
+0000b120: 2020 2020 2020 2020 2020 2020 2020 205f                 _
+0000b130: 5375 7065 7276 6973 6564 4578 7065 7269  SupervisedExperi
+0000b140: 6d65 6e74 2e70 7265 6469 6374 5f6d 6f64  ment.predict_mod
+0000b150: 656c 280a 2020 2020 2020 2020 2020 2020  el(.            
+0000b160: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000b170: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000b180: 2020 2020 2020 2020 2020 7069 7065 6c69            pipeli
+0000b190: 6e65 5f77 6974 685f 6d6f 6465 6c2c 0a20  ne_with_model,. 
+0000b1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b1b0: 2020 2020 2020 2064 6174 613d 7064 2e63         data=pd.c
+0000b1c0: 6f6e 6361 7428 5b64 6174 615f 582c 2064  oncat([data_X, d
+0000b1d0: 6174 615f 795d 2c20 6178 6973 3d31 292c  ata_y], axis=1),
+0000b1e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b1f0: 2020 2020 2020 2020 2076 6572 626f 7365           verbose
+0000b200: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+0000b210: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000b220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b230: 2020 6d65 7472 6963 7320 3d20 7365 6c66    metrics = self
+0000b240: 2e70 756c 6c28 706f 703d 5472 7565 292e  .pull(pop=True).
+0000b250: 6472 6f70 2822 4d6f 6465 6c22 2c20 6178  drop("Model", ax
+0000b260: 6973 3d31 290a 2020 2020 2020 2020 2020  is=1).          
+0000b270: 2020 2020 2020 2020 2020 6466 5f73 636f            df_sco
+0000b280: 7265 203d 2070 642e 4461 7461 4672 616d  re = pd.DataFram
+0000b290: 6528 7b22 5370 6c69 7422 3a20 5b22 5472  e({"Split": ["Tr
+0000b2a0: 6169 6e22 5d2c 2022 466f 6c64 223a 205b  ain"], "Fold": [
+0000b2b0: 4e6f 6e65 5d7d 290a 2020 2020 2020 2020  None]}).        
+0000b2c0: 2020 2020 2020 2020 2020 2020 6466 5f73              df_s
+0000b2d0: 636f 7265 203d 2070 642e 636f 6e63 6174  core = pd.concat
+0000b2e0: 285b 6466 5f73 636f 7265 2c20 6d65 7472  ([df_score, metr
+0000b2f0: 6963 735d 2c20 6178 6973 3d31 290a 2020  ics], axis=1).  
+0000b300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b310: 2020 6466 5f73 636f 7265 2e73 6574 5f69    df_score.set_i
+0000b320: 6e64 6578 285b 2253 706c 6974 222c 2022  ndex(["Split", "
+0000b330: 466f 6c64 225d 2c20 696e 706c 6163 653d  Fold"], inplace=
+0000b340: 5472 7565 290a 0a20 2020 2020 2020 2020  True)..         
+0000b350: 2020 2020 2020 2020 2020 2023 2063 6f6e             # con
+0000b360: 6361 7465 6e61 7469 6e67 2074 7261 696e  catenating train
+0000b370: 2072 6573 756c 7473 2074 6f20 6372 6f73   results to cros
+0000b380: 732d 7661 6c69 6461 7469 6f6e 2073 6f63  s-validation soc
+0000b390: 7265 2064 6174 6166 7261 6d65 0a20 2020  re dataframe.   
 0000b3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b3b0: 2020 2020 6d6f 6465 6c5f 7265 7375 6c74      model_result
-0000b3c0: 7320 3d20 7064 2e63 6f6e 6361 7428 5b6d  s = pd.concat([m
-0000b3d0: 6f64 656c 5f72 6573 756c 7473 2c20 6466  odel_results, df
-0000b3e0: 5f73 636f 7265 5d29 0a0a 2020 2020 2020  _score])..      
-0000b3f0: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-0000b400: 6669 745f 7469 6d65 203d 206e 702e 6172  fit_time = np.ar
-0000b410: 7261 7928 6d6f 6465 6c5f 6669 745f 656e  ray(model_fit_en
-0000b420: 6420 2d20 6d6f 6465 6c5f 6669 745f 7374  d - model_fit_st
-0000b430: 6172 7429 2e72 6f75 6e64 2832 290a 2020  art).round(2).  
-0000b440: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0000b450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b460: 6d6f 6465 6c5f 6669 745f 7469 6d65 202f  model_fit_time /
-0000b470: 3d20 7365 6c66 2e5f 6765 745f 6376 5f6e  = self._get_cv_n
-0000b480: 5f66 6f6c 6473 280a 2020 2020 2020 2020  _folds(.        
-0000b490: 2020 2020 2020 2020 2020 2020 6376 2c20              cv, 
-0000b4a0: 6461 7461 5f58 2c20 793d 6461 7461 5f79  data_X, y=data_y
-0000b4b0: 2c20 6772 6f75 7073 3d67 726f 7570 730a  , groups=groups.
-0000b4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b4d0: 290a 0a20 2020 2020 2020 206d 6f64 656c  )..        model
-0000b4e0: 5f72 6573 756c 7473 203d 206d 6f64 656c  _results = model
-0000b4f0: 5f72 6573 756c 7473 2e72 6f75 6e64 2872  _results.round(r
-0000b500: 6f75 6e64 290a 0a20 2020 2020 2020 2072  ound)..        r
-0000b510: 6574 7572 6e20 6d6f 6465 6c2c 206d 6f64  eturn model, mod
-0000b520: 656c 5f66 6974 5f74 696d 652c 206d 6f64  el_fit_time, mod
-0000b530: 656c 5f72 6573 756c 7473 2c20 6176 6773  el_results, avgs
-0000b540: 5f64 6963 740a 0a20 2020 2064 6566 205f  _dict..    def _
-0000b550: 6765 745f 7265 7475 726e 5f74 7261 696e  get_return_train
-0000b560: 5f73 636f 7265 5f63 6f6c 756d 6e73 5f66  _score_columns_f
-0000b570: 6f72 5f64 6973 706c 6179 280a 2020 2020  or_display(.    
-0000b580: 2020 2020 7365 6c66 2c20 7265 7475 726e      self, return
-0000b590: 5f74 7261 696e 5f73 636f 7265 3a20 626f  _train_score: bo
-0000b5a0: 6f6c 0a20 2020 2029 202d 3e20 4c69 7374  ol.    ) -> List
-0000b5b0: 5b73 7472 5d3a 0a20 2020 2020 2020 2069  [str]:.        i
-0000b5c0: 6620 7265 7475 726e 5f74 7261 696e 5f73  f return_train_s
-0000b5d0: 636f 7265 3a0a 2020 2020 2020 2020 2020  core:.          
-0000b5e0: 2020 636f 6c75 6d6e 7320 3d20 5b22 5370    columns = ["Sp
-0000b5f0: 6c69 7422 2c20 2246 6f6c 6422 5d0a 2020  lit", "Fold"].  
-0000b600: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000b610: 2020 2020 2020 2020 636f 6c75 6d6e 7320          columns 
-0000b620: 3d20 5b22 466f 6c64 225d 0a20 2020 2020  = ["Fold"].     
-0000b630: 2020 2072 6574 7572 6e20 636f 6c75 6d6e     return column
-0000b640: 730a 0a20 2020 2064 6566 205f 6765 745f  s..    def _get_
-0000b650: 7265 7475 726e 5f74 7261 696e 5f73 636f  return_train_sco
-0000b660: 7265 5f69 6e64 6963 6573 5f66 6f72 5f6c  re_indices_for_l
-0000b670: 6f67 6769 6e67 2873 656c 662c 2072 6574  ogging(self, ret
-0000b680: 7572 6e5f 7472 6169 6e5f 7363 6f72 653a  urn_train_score:
-0000b690: 2062 6f6f 6c29 3a0a 2020 2020 2020 2020   bool):.        
-0000b6a0: 6966 2072 6574 7572 6e5f 7472 6169 6e5f  if return_train_
-0000b6b0: 7363 6f72 653a 0a20 2020 2020 2020 2020  score:.         
-0000b6c0: 2020 2069 6e64 6963 6573 203d 2028 2243     indices = ("C
-0000b6d0: 562d 5661 6c22 2c20 224d 6561 6e22 290a  V-Val", "Mean").
-0000b6e0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000b6f0: 2020 2020 2020 2020 2020 696e 6469 6365            indice
-0000b700: 7320 3d20 224d 6561 6e22 0a20 2020 2020  s = "Mean".     
-0000b710: 2020 2072 6574 7572 6e20 696e 6469 6365     return indice
-0000b720: 730a 0a20 2020 2064 6566 205f 6869 6768  s..    def _high
-0000b730: 6c69 6768 745f 616e 645f 726f 756e 645f  light_and_round_
-0000b740: 6d6f 6465 6c5f 7265 7375 6c74 7328 0a20  model_results(. 
-0000b750: 2020 2020 2020 2073 656c 662c 206d 6f64         self, mod
-0000b760: 656c 5f72 6573 756c 7473 3a20 7064 2e44  el_results: pd.D
-0000b770: 6174 6146 7261 6d65 2c20 7265 7475 726e  ataFrame, return
-0000b780: 5f74 7261 696e 5f73 636f 7265 3a20 626f  _train_score: bo
-0000b790: 6f6c 2c20 726f 756e 643a 2069 6e74 0a20  ol, round: int. 
-0000b7a0: 2020 2029 202d 3e20 7061 6e64 6173 2e69     ) -> pandas.i
-0000b7b0: 6f2e 666f 726d 6174 732e 7374 796c 652e  o.formats.style.
-0000b7c0: 5374 796c 6572 3a0a 2020 2020 2020 2020  Styler:.        
-0000b7d0: 2320 7965 6c6c 6f77 2074 6865 206d 6561  # yellow the mea
-0000b7e0: 6e0a 2020 2020 2020 2020 6966 2072 6574  n.        if ret
-0000b7f0: 7572 6e5f 7472 6169 6e5f 7363 6f72 653a  urn_train_score:
-0000b800: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-0000b810: 6963 6573 203d 205b 2822 4356 2d56 616c  ices = [("CV-Val
-0000b820: 222c 2022 4d65 616e 2229 2c20 2822 4356  ", "Mean"), ("CV
-0000b830: 2d54 7261 696e 222c 2022 4d65 616e 2229  -Train", "Mean")
-0000b840: 5d0a 2020 2020 2020 2020 656c 7365 3a0a  ].        else:.
-0000b850: 2020 2020 2020 2020 2020 2020 696e 6469              indi
-0000b860: 6365 7320 3d20 5b22 4d65 616e 225d 0a20  ces = ["Mean"]. 
-0000b870: 2020 2020 2020 206d 6f64 656c 5f72 6573         model_res
-0000b880: 756c 7473 203d 2063 6f6c 6f72 5f64 6628  ults = color_df(
-0000b890: 6d6f 6465 6c5f 7265 7375 6c74 732c 2022  model_results, "
-0000b8a0: 7965 6c6c 6f77 222c 2069 6e64 6963 6573  yellow", indices
-0000b8b0: 2c20 6178 6973 3d31 290a 2020 2020 2020  , axis=1).      
-0000b8c0: 2020 6d6f 6465 6c5f 7265 7375 6c74 7320    model_results 
-0000b8d0: 3d20 6d6f 6465 6c5f 7265 7375 6c74 732e  = model_results.
-0000b8e0: 666f 726d 6174 2870 7265 6369 7369 6f6e  format(precision
-0000b8f0: 3d72 6f75 6e64 290a 2020 2020 2020 2020  =round).        
-0000b900: 7265 7475 726e 206d 6f64 656c 5f72 6573  return model_res
-0000b910: 756c 7473 0a0a 2020 2020 4061 6273 7472  ults..    @abstr
-0000b920: 6163 746d 6574 686f 640a 2020 2020 6465  actmethod.    de
-0000b930: 6620 5f63 7265 6174 655f 6d6f 6465 6c5f  f _create_model_
-0000b940: 6765 745f 7472 6169 6e5f 585f 7928 7365  get_train_X_y(se
-0000b950: 6c66 2c20 585f 7472 6169 6e2c 2079 5f74  lf, X_train, y_t
-0000b960: 7261 696e 293a 0a20 2020 2020 2020 2022  rain):.        "
-0000b970: 2222 5265 7475 726e 2061 7070 726f 7072  ""Return appropr
-0000b980: 6961 7465 2074 7261 696e 696e 6720 5820  iate training X 
-0000b990: 616e 6420 7920 7661 6c75 6573 2064 6570  and y values dep
-0000b9a0: 656e 6469 6e67 206f 6e20 7768 6574 6865  ending on whethe
-0000b9b0: 720a 2020 2020 2020 2020 585f 7472 6169  r.        X_trai
-0000b9c0: 6e20 616e 6420 795f 7472 6169 6e20 6172  n and y_train ar
-0000b9d0: 6520 7061 7373 6564 206f 7220 6e6f 742e  e passed or not.
-0000b9e0: 2222 220a 2020 2020 2020 2020 7061 7373  """.        pass
-0000b9f0: 0a0a 2020 2020 6465 6620 5f63 7265 6174  ..    def _creat
-0000ba00: 655f 6d6f 6465 6c28 0a20 2020 2020 2020  e_model(.       
-0000ba10: 2073 656c 662c 0a20 2020 2020 2020 2065   self,.        e
-0000ba20: 7374 696d 6174 6f72 2c0a 2020 2020 2020  stimator,.      
-0000ba30: 2020 666f 6c64 3a20 4f70 7469 6f6e 616c    fold: Optional
-0000ba40: 5b55 6e69 6f6e 5b69 6e74 2c20 416e 795d  [Union[int, Any]
-0000ba50: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-0000ba60: 2020 726f 756e 643a 2069 6e74 203d 2034    round: int = 4
-0000ba70: 2c0a 2020 2020 2020 2020 6372 6f73 735f  ,.        cross_
-0000ba80: 7661 6c69 6461 7469 6f6e 3a20 626f 6f6c  validation: bool
-0000ba90: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
-0000baa0: 2070 7265 6469 6374 3a20 626f 6f6c 203d   predict: bool =
-0000bab0: 2054 7275 652c 0a20 2020 2020 2020 2066   True,.        f
-0000bac0: 6974 5f6b 7761 7267 733a 204f 7074 696f  it_kwargs: Optio
-0000bad0: 6e61 6c5b 6469 6374 5d20 3d20 4e6f 6e65  nal[dict] = None
-0000bae0: 2c0a 2020 2020 2020 2020 6772 6f75 7073  ,.        groups
-0000baf0: 3a20 4f70 7469 6f6e 616c 5b55 6e69 6f6e  : Optional[Union
-0000bb00: 5b73 7472 2c20 416e 795d 5d20 3d20 4e6f  [str, Any]] = No
-0000bb10: 6e65 2c0a 2020 2020 2020 2020 7265 6669  ne,.        refi
-0000bb20: 743a 2062 6f6f 6c20 3d20 5472 7565 2c0a  t: bool = True,.
-0000bb30: 2020 2020 2020 2020 7072 6f62 6162 696c          probabil
-0000bb40: 6974 795f 7468 7265 7368 6f6c 643a 204f  ity_threshold: O
-0000bb50: 7074 696f 6e61 6c5b 666c 6f61 745d 203d  ptional[float] =
-0000bb60: 204e 6f6e 652c 0a20 2020 2020 2020 2065   None,.        e
-0000bb70: 7870 6572 696d 656e 745f 6375 7374 6f6d  xperiment_custom
-0000bb80: 5f74 6167 733a 204f 7074 696f 6e61 6c5b  _tags: Optional[
-0000bb90: 4469 6374 5b73 7472 2c20 416e 795d 5d20  Dict[str, Any]] 
-0000bba0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0000bbb0: 7665 7262 6f73 653a 2062 6f6f 6c20 3d20  verbose: bool = 
-0000bbc0: 5472 7565 2c0a 2020 2020 2020 2020 7379  True,.        sy
-0000bbd0: 7374 656d 3a20 626f 6f6c 203d 2054 7275  stem: bool = Tru
-0000bbe0: 652c 0a20 2020 2020 2020 2061 6464 5f74  e,.        add_t
-0000bbf0: 6f5f 6d6f 6465 6c5f 6c69 7374 3a20 626f  o_model_list: bo
-0000bc00: 6f6c 203d 2054 7275 652c 0a20 2020 2020  ol = True,.     
-0000bc10: 2020 2058 5f74 7261 696e 5f64 6174 613a     X_train_data:
-0000bc20: 204f 7074 696f 6e61 6c5b 7064 2e44 6174   Optional[pd.Dat
-0000bc30: 6146 7261 6d65 5d20 3d20 4e6f 6e65 2c20  aFrame] = None, 
-0000bc40: 2023 2061 6464 6564 2069 6e20 7079 6361   # added in pyca
-0000bc50: 7265 743d 3d32 2e32 2e30 0a20 2020 2020  ret==2.2.0.     
-0000bc60: 2020 2079 5f74 7261 696e 5f64 6174 613a     y_train_data:
-0000bc70: 204f 7074 696f 6e61 6c5b 7064 2e44 6174   Optional[pd.Dat
-0000bc80: 6146 7261 6d65 5d20 3d20 4e6f 6e65 2c20  aFrame] = None, 
-0000bc90: 2023 2061 6464 6564 2069 6e20 7079 6361   # added in pyca
-0000bca0: 7265 743d 3d32 2e32 2e30 0a20 2020 2020  ret==2.2.0.     
-0000bcb0: 2020 206d 6574 7269 6373 3d4e 6f6e 652c     metrics=None,
-0000bcc0: 0a20 2020 2020 2020 2064 6973 706c 6179  .        display
-0000bcd0: 3a20 4f70 7469 6f6e 616c 5b43 6f6d 6d6f  : Optional[Commo
-0000bce0: 6e44 6973 706c 6179 5d20 3d20 4e6f 6e65  nDisplay] = None
-0000bcf0: 2c20 2023 2061 6464 6564 2069 6e20 7079  ,  # added in py
-0000bd00: 6361 7265 743d 3d32 2e32 2e30 0a20 2020  caret==2.2.0.   
-0000bd10: 2020 2020 206d 6f64 656c 5f6f 6e6c 793a       model_only:
-0000bd20: 2062 6f6f 6c20 3d20 5472 7565 2c0a 2020   bool = True,.  
-0000bd30: 2020 2020 2020 7265 7475 726e 5f74 7261        return_tra
-0000bd40: 696e 5f73 636f 7265 3a20 626f 6f6c 203d  in_score: bool =
-0000bd50: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
-0000bd60: 2a2a 6b77 6172 6773 2c0a 2020 2020 2920  **kwargs,.    ) 
-0000bd70: 2d3e 2041 6e79 3a0a 0a20 2020 2020 2020  -> Any:..       
-0000bd80: 2022 2222 0a20 2020 2020 2020 2049 6e74   """.        Int
-0000bd90: 6572 6e61 6c20 7665 7273 696f 6e20 6f66  ernal version of
-0000bda0: 2060 6063 7265 6174 655f 6d6f 6465 6c60   ``create_model`
-0000bdb0: 6020 7769 7468 2070 7269 7661 7465 2061  ` with private a
-0000bdc0: 7267 756d 656e 7473 2e0a 2020 2020 2020  rguments..      
-0000bdd0: 2020 2222 220a 2020 2020 2020 2020 7365    """.        se
-0000bde0: 6c66 2e5f 6368 6563 6b5f 7365 7475 705f  lf._check_setup_
-0000bdf0: 7261 6e28 290a 0a20 2020 2020 2020 2066  ran()..        f
-0000be00: 756e 6374 696f 6e5f 7061 7261 6d73 5f73  unction_params_s
-0000be10: 7472 203d 2022 2c20 222e 6a6f 696e 280a  tr = ", ".join(.
-0000be20: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-0000be30: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0000be40: 7b6b 7d3d 7b76 7d22 0a20 2020 2020 2020  {k}={v}".       
-0000be50: 2020 2020 2020 2020 2066 6f72 206b 2c20           for k, 
-0000be60: 7620 696e 206c 6f63 616c 7328 292e 6974  v in locals().it
-0000be70: 656d 7328 290a 2020 2020 2020 2020 2020  ems().          
-0000be80: 2020 2020 2020 6966 206b 206e 6f74 2069        if k not i
-0000be90: 6e20 2822 585f 7472 6169 6e5f 6461 7461  n ("X_train_data
-0000bea0: 222c 2022 795f 7472 6169 6e5f 6461 7461  ", "y_train_data
-0000beb0: 2229 0a20 2020 2020 2020 2020 2020 205d  ").            ]
-0000bec0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0000bed0: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
-0000bee0: 696e 666f 2822 496e 6974 6961 6c69 7a69  info("Initializi
-0000bef0: 6e67 2063 7265 6174 655f 6d6f 6465 6c28  ng create_model(
-0000bf00: 2922 290a 2020 2020 2020 2020 7365 6c66  )").        self
-0000bf10: 2e6c 6f67 6765 722e 696e 666f 2866 2263  .logger.info(f"c
-0000bf20: 7265 6174 655f 6d6f 6465 6c28 7b66 756e  reate_model({fun
-0000bf30: 6374 696f 6e5f 7061 7261 6d73 5f73 7472  ction_params_str
-0000bf40: 7d29 2229 0a0a 2020 2020 2020 2020 7365  })")..        se
-0000bf50: 6c66 2e6c 6f67 6765 722e 696e 666f 2822  lf.logger.info("
-0000bf60: 4368 6563 6b69 6e67 2065 7863 6570 7469  Checking excepti
-0000bf70: 6f6e 7322 290a 0a20 2020 2020 2020 2023  ons")..        #
-0000bf80: 2072 756e 5f74 696d 650a 2020 2020 2020   run_time.      
-0000bf90: 2020 7275 6e74 696d 655f 7374 6172 7420    runtime_start 
-0000bfa0: 3d20 7469 6d65 2e74 696d 6528 290a 0a20  = time.time().. 
-0000bfb0: 2020 2020 2020 2061 7661 696c 6162 6c65         available
-0000bfc0: 5f65 7374 696d 6174 6f72 7320 3d20 7365  _estimators = se
-0000bfd0: 7428 7365 6c66 2e5f 616c 6c5f 6d6f 6465  t(self._all_mode
-0000bfe0: 6c73 5f69 6e74 6572 6e61 6c2e 6b65 7973  ls_internal.keys
-0000bff0: 2829 290a 0a20 2020 2020 2020 2069 6620  ())..        if 
-0000c000: 6e6f 7420 6669 745f 6b77 6172 6773 3a0a  not fit_kwargs:.
-0000c010: 2020 2020 2020 2020 2020 2020 6669 745f              fit_
-0000c020: 6b77 6172 6773 203d 207b 7d0a 0a20 2020  kwargs = {}..   
-0000c030: 2020 2020 2023 206f 6e6c 7920 7261 6973       # only rais
-0000c040: 6520 6578 6365 7074 696f 6e20 6f66 2065  e exception of e
-0000c050: 7374 696d 6174 6f72 2069 7320 6f66 2074  stimator is of t
-0000c060: 7970 6520 7374 7269 6e67 2e0a 2020 2020  ype string..    
-0000c070: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0000c080: 6528 6573 7469 6d61 746f 722c 2073 7472  e(estimator, str
-0000c090: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-0000c0a0: 6620 6573 7469 6d61 746f 7220 6e6f 7420  f estimator not 
-0000c0b0: 696e 2061 7661 696c 6162 6c65 5f65 7374  in available_est
-0000c0c0: 696d 6174 6f72 733a 0a20 2020 2020 2020  imators:.       
-0000c0d0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0000c0e0: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-0000c0f0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000c100: 2245 7374 696d 6174 6f72 207b 6573 7469  "Estimator {esti
-0000c110: 6d61 746f 727d 206e 6f74 2061 7661 696c  mator} not avail
-0000c120: 6162 6c65 2e20 506c 6561 7365 2073 6565  able. Please see
-0000c130: 2064 6f63 7374 7269 6e67 2066 6f72 206c   docstring for l
-0000c140: 6973 7420 6f66 2061 7661 696c 6162 6c65  ist of available
-0000c150: 2065 7374 696d 6174 6f72 732e 220a 2020   estimators.".  
-0000c160: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0000c170: 2020 2020 2020 2020 656c 6966 206e 6f74          elif not
-0000c180: 2068 6173 6174 7472 2865 7374 696d 6174   hasattr(estimat
-0000c190: 6f72 2c20 2266 6974 2229 3a0a 2020 2020  or, "fit"):.    
-0000c1a0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0000c1b0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-0000c1c0: 2020 2020 2020 2020 2020 6622 4573 7469            f"Esti
-0000c1d0: 6d61 746f 7220 7b65 7374 696d 6174 6f72  mator {estimator
-0000c1e0: 7d20 646f 6573 206e 6f74 2068 6176 6520  } does not have 
-0000c1f0: 7468 6520 7265 7175 6972 6564 2066 6974  the required fit
-0000c200: 2829 206d 6574 686f 642e 220a 2020 2020  () method.".    
-0000c210: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0000c220: 2020 2023 2063 6865 636b 696e 6720 666f     # checking fo
-0000c230: 6c64 2070 6172 616d 6574 6572 0a20 2020  ld parameter.   
-0000c240: 2020 2020 2069 6620 666f 6c64 2069 7320       if fold is 
-0000c250: 6e6f 7420 4e6f 6e65 2061 6e64 206e 6f74  not None and not
-0000c260: 2028 0a20 2020 2020 2020 2020 2020 2074   (.            t
-0000c270: 7970 6528 666f 6c64 2920 6973 2069 6e74  ype(fold) is int
-0000c280: 206f 7220 6973 5f73 6b6c 6561 726e 5f63   or is_sklearn_c
-0000c290: 765f 6765 6e65 7261 746f 7228 666f 6c64  v_generator(fold
-0000c2a0: 290a 2020 2020 2020 2020 293a 0a20 2020  ).        ):.   
-0000c2b0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-0000c2c0: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
-0000c2d0: 2020 2020 2020 2020 2020 2266 6f6c 6420            "fold 
-0000c2e0: 7061 7261 6d65 7465 7220 6d75 7374 2062  parameter must b
-0000c2f0: 6520 6569 7468 6572 204e 6f6e 652c 2061  e either None, a
-0000c300: 6e20 696e 7465 6765 7220 6f72 2061 2073  n integer or a s
-0000c310: 6369 6b69 742d 6c65 6172 6e20 636f 6d70  cikit-learn comp
-0000c320: 6174 6962 6c65 2043 5620 6765 6e65 7261  atible CV genera
-0000c330: 746f 7220 6f62 6a65 6374 2e22 0a20 2020  tor object.".   
-0000c340: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0000c350: 2020 2020 2320 6368 6563 6b69 6e67 2072      # checking r
-0000c360: 6f75 6e64 2070 6172 616d 6574 6572 0a20  ound parameter. 
-0000c370: 2020 2020 2020 2069 6620 7479 7065 2872         if type(r
-0000c380: 6f75 6e64 2920 6973 206e 6f74 2069 6e74  ound) is not int
-0000c390: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0000c3a0: 6973 6520 5479 7065 4572 726f 7228 2252  ise TypeError("R
-0000c3b0: 6f75 6e64 2070 6172 616d 6574 6572 206f  ound parameter o
-0000c3c0: 6e6c 7920 6163 6365 7074 7320 696e 7465  nly accepts inte
-0000c3d0: 6765 7220 7661 6c75 652e 2229 0a0a 2020  ger value.")..  
-0000c3e0: 2020 2020 2020 2320 6368 6563 6b69 6e67        # checking
-0000c3f0: 2076 6572 626f 7365 2070 6172 616d 6574   verbose paramet
-0000c400: 6572 0a20 2020 2020 2020 2069 6620 7479  er.        if ty
-0000c410: 7065 2876 6572 626f 7365 2920 6973 206e  pe(verbose) is n
-0000c420: 6f74 2062 6f6f 6c3a 0a20 2020 2020 2020  ot bool:.       
-0000c430: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-0000c440: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0000c450: 2020 2020 2020 2256 6572 626f 7365 2070        "Verbose p
-0000c460: 6172 616d 6574 6572 2063 616e 206f 6e6c  arameter can onl
-0000c470: 7920 7461 6b65 2061 7267 756d 656e 7420  y take argument 
-0000c480: 6173 2054 7275 6520 6f72 2046 616c 7365  as True or False
-0000c490: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
-0000c4a0: 0a0a 2020 2020 2020 2020 2320 6368 6563  ..        # chec
-0000c4b0: 6b69 6e67 2073 7973 7465 6d20 7061 7261  king system para
-0000c4c0: 6d65 7465 720a 2020 2020 2020 2020 6966  meter.        if
-0000c4d0: 2074 7970 6528 7379 7374 656d 2920 6973   type(system) is
-0000c4e0: 206e 6f74 2062 6f6f 6c3a 0a20 2020 2020   not bool:.     
-0000c4f0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-0000c500: 6545 7272 6f72 2822 5379 7374 656d 2070  eError("System p
-0000c510: 6172 616d 6574 6572 2063 616e 206f 6e6c  arameter can onl
-0000c520: 7920 7461 6b65 2061 7267 756d 656e 7420  y take argument 
-0000c530: 6173 2054 7275 6520 6f72 2046 616c 7365  as True or False
-0000c540: 2e22 290a 0a20 2020 2020 2020 2023 2063  .")..        # c
-0000c550: 6865 636b 696e 6720 6372 6f73 735f 7661  hecking cross_va
-0000c560: 6c69 6461 7469 6f6e 2070 6172 616d 6574  lidation paramet
-0000c570: 6572 0a20 2020 2020 2020 2069 6620 7479  er.        if ty
-0000c580: 7065 2863 726f 7373 5f76 616c 6964 6174  pe(cross_validat
-0000c590: 696f 6e29 2069 7320 6e6f 7420 626f 6f6c  ion) is not bool
-0000c5a0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0000c5b0: 6973 6520 5479 7065 4572 726f 7228 0a20  ise TypeError(. 
-0000c5c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000c5d0: 6372 6f73 735f 7661 6c69 6461 7469 6f6e  cross_validation
-0000c5e0: 2070 6172 616d 6574 6572 2063 616e 206f   parameter can o
-0000c5f0: 6e6c 7920 7461 6b65 2061 7267 756d 656e  nly take argumen
-0000c600: 7420 6173 2054 7275 6520 6f72 2046 616c  t as True or Fal
-0000c610: 7365 2e22 0a20 2020 2020 2020 2020 2020  se.".           
-0000c620: 2029 0a0a 2020 2020 2020 2020 2320 6368   )..        # ch
-0000c630: 6563 6b69 6e67 2072 6574 7572 6e5f 7472  ecking return_tr
-0000c640: 6169 6e5f 7363 6f72 6520 7061 7261 6d65  ain_score parame
-0000c650: 7465 720a 2020 2020 2020 2020 6966 2074  ter.        if t
-0000c660: 7970 6528 7265 7475 726e 5f74 7261 696e  ype(return_train
-0000c670: 5f73 636f 7265 2920 6973 206e 6f74 2062  _score) is not b
-0000c680: 6f6f 6c3a 0a20 2020 2020 2020 2020 2020  ool:.           
-0000c690: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-0000c6a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000c6b0: 2020 2272 6574 7572 6e5f 7472 6169 6e5f    "return_train_
-0000c6c0: 7363 6f72 6520 6361 6e20 6f6e 6c79 2074  score can only t
-0000c6d0: 616b 6520 6172 6775 6d65 6e74 2061 7320  ake argument as 
-0000c6e0: 5472 7565 206f 7220 4661 6c73 6522 0a20  True or False". 
-0000c6f0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0000c700: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-0000c710: 2020 2045 5252 4f52 2048 414e 444c 494e     ERROR HANDLIN
-0000c720: 4720 454e 4453 2048 4552 450a 0a20 2020  G ENDS HERE..   
-0000c730: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-0000c740: 2020 6966 206e 6f74 2064 6973 706c 6179    if not display
-0000c750: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
-0000c760: 6f67 7265 7373 5f61 7267 7320 3d20 7b22  ogress_args = {"
-0000c770: 6d61 7822 3a20 347d 0a20 2020 2020 2020  max": 4}.       
-0000c780: 2020 2020 2074 696d 6573 7461 6d70 5374       timestampSt
-0000c790: 7220 3d20 6461 7465 7469 6d65 2e64 6174  r = datetime.dat
-0000c7a0: 6574 696d 652e 6e6f 7728 292e 7374 7266  etime.now().strf
-0000c7b0: 7469 6d65 2822 2548 3a25 4d3a 2553 2229  time("%H:%M:%S")
-0000c7c0: 0a20 2020 2020 2020 2020 2020 206d 6f6e  .            mon
-0000c7d0: 6974 6f72 5f72 6f77 7320 3d20 5b0a 2020  itor_rows = [.  
-0000c7e0: 2020 2020 2020 2020 2020 2020 2020 5b22                ["
-0000c7f0: 496e 6974 6961 7465 6422 2c20 222e 202e  Initiated", ". .
+0000b3b0: 206d 6f64 656c 5f72 6573 756c 7473 203d   model_results =
+0000b3c0: 2070 642e 636f 6e63 6174 285b 6d6f 6465   pd.concat([mode
+0000b3d0: 6c5f 7265 7375 6c74 732c 2064 665f 7363  l_results, df_sc
+0000b3e0: 6f72 655d 290a 0a20 2020 2020 2020 2020  ore])..         
+0000b3f0: 2020 2020 2020 206d 6f64 656c 5f66 6974         model_fit
+0000b400: 5f74 696d 6520 3d20 6e70 2e61 7272 6179  _time = np.array
+0000b410: 286d 6f64 656c 5f66 6974 5f65 6e64 202d  (model_fit_end -
+0000b420: 206d 6f64 656c 5f66 6974 5f73 7461 7274   model_fit_start
+0000b430: 292e 726f 756e 6428 3229 0a20 2020 2020  ).round(2).     
+0000b440: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000b450: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+0000b460: 656c 5f66 6974 5f74 696d 6520 2f3d 2073  el_fit_time /= s
+0000b470: 656c 662e 5f67 6574 5f63 765f 6e5f 666f  elf._get_cv_n_fo
+0000b480: 6c64 7328 0a20 2020 2020 2020 2020 2020  lds(.           
+0000b490: 2020 2020 2020 2020 2063 762c 2064 6174           cv, dat
+0000b4a0: 615f 582c 2079 3d64 6174 615f 792c 2067  a_X, y=data_y, g
+0000b4b0: 726f 7570 733d 6772 6f75 7073 0a20 2020  roups=groups.   
+0000b4c0: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+0000b4d0: 2020 2020 2020 2020 6d6f 6465 6c5f 7265          model_re
+0000b4e0: 7375 6c74 7320 3d20 6d6f 6465 6c5f 7265  sults = model_re
+0000b4f0: 7375 6c74 732e 726f 756e 6428 726f 756e  sults.round(roun
+0000b500: 6429 0a0a 2020 2020 2020 2020 7265 7475  d)..        retu
+0000b510: 726e 206d 6f64 656c 2c20 6d6f 6465 6c5f  rn model, model_
+0000b520: 6669 745f 7469 6d65 2c20 6d6f 6465 6c5f  fit_time, model_
+0000b530: 7265 7375 6c74 732c 2061 7667 735f 6469  results, avgs_di
+0000b540: 6374 0a0a 2020 2020 6465 6620 5f67 6574  ct..    def _get
+0000b550: 5f72 6574 7572 6e5f 7472 6169 6e5f 7363  _return_train_sc
+0000b560: 6f72 655f 636f 6c75 6d6e 735f 666f 725f  ore_columns_for_
+0000b570: 6469 7370 6c61 7928 0a20 2020 2020 2020  display(.       
+0000b580: 2073 656c 662c 2072 6574 7572 6e5f 7472   self, return_tr
+0000b590: 6169 6e5f 7363 6f72 653a 2062 6f6f 6c0a  ain_score: bool.
+0000b5a0: 2020 2020 2920 2d3e 204c 6973 745b 7374      ) -> List[st
+0000b5b0: 725d 3a0a 2020 2020 2020 2020 6966 2072  r]:.        if r
+0000b5c0: 6574 7572 6e5f 7472 6169 6e5f 7363 6f72  eturn_train_scor
+0000b5d0: 653a 0a20 2020 2020 2020 2020 2020 2063  e:.            c
+0000b5e0: 6f6c 756d 6e73 203d 205b 2253 706c 6974  olumns = ["Split
+0000b5f0: 222c 2022 466f 6c64 225d 0a20 2020 2020  ", "Fold"].     
+0000b600: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000b610: 2020 2020 2063 6f6c 756d 6e73 203d 205b       columns = [
+0000b620: 2246 6f6c 6422 5d0a 2020 2020 2020 2020  "Fold"].        
+0000b630: 7265 7475 726e 2063 6f6c 756d 6e73 0a0a  return columns..
+0000b640: 2020 2020 6465 6620 5f67 6574 5f72 6574      def _get_ret
+0000b650: 7572 6e5f 7472 6169 6e5f 7363 6f72 655f  urn_train_score_
+0000b660: 696e 6469 6365 735f 666f 725f 6c6f 6767  indices_for_logg
+0000b670: 696e 6728 7365 6c66 2c20 7265 7475 726e  ing(self, return
+0000b680: 5f74 7261 696e 5f73 636f 7265 3a20 626f  _train_score: bo
+0000b690: 6f6c 293a 0a20 2020 2020 2020 2069 6620  ol):.        if 
+0000b6a0: 7265 7475 726e 5f74 7261 696e 5f73 636f  return_train_sco
+0000b6b0: 7265 3a0a 2020 2020 2020 2020 2020 2020  re:.            
+0000b6c0: 696e 6469 6365 7320 3d20 2822 4356 2d56  indices = ("CV-V
+0000b6d0: 616c 222c 2022 4d65 616e 2229 0a20 2020  al", "Mean").   
+0000b6e0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0000b6f0: 2020 2020 2020 2069 6e64 6963 6573 203d         indices =
+0000b700: 2022 4d65 616e 220a 2020 2020 2020 2020   "Mean".        
+0000b710: 7265 7475 726e 2069 6e64 6963 6573 0a0a  return indices..
+0000b720: 2020 2020 6465 6620 5f68 6967 686c 6967      def _highlig
+0000b730: 6874 5f61 6e64 5f72 6f75 6e64 5f6d 6f64  ht_and_round_mod
+0000b740: 656c 5f72 6573 756c 7473 280a 2020 2020  el_results(.    
+0000b750: 2020 2020 7365 6c66 2c20 6d6f 6465 6c5f      self, model_
+0000b760: 7265 7375 6c74 733a 2070 642e 4461 7461  results: pd.Data
+0000b770: 4672 616d 652c 2072 6574 7572 6e5f 7472  Frame, return_tr
+0000b780: 6169 6e5f 7363 6f72 653a 2062 6f6f 6c2c  ain_score: bool,
+0000b790: 2072 6f75 6e64 3a20 696e 740a 2020 2020   round: int.    
+0000b7a0: 2920 2d3e 2070 616e 6461 732e 696f 2e66  ) -> pandas.io.f
+0000b7b0: 6f72 6d61 7473 2e73 7479 6c65 2e53 7479  ormats.style.Sty
+0000b7c0: 6c65 723a 0a20 2020 2020 2020 2023 2079  ler:.        # y
+0000b7d0: 656c 6c6f 7720 7468 6520 6d65 616e 0a20  ellow the mean. 
+0000b7e0: 2020 2020 2020 2069 6620 7265 7475 726e         if return
+0000b7f0: 5f74 7261 696e 5f73 636f 7265 3a0a 2020  _train_score:.  
+0000b800: 2020 2020 2020 2020 2020 696e 6469 6365            indice
+0000b810: 7320 3d20 5b28 2243 562d 5661 6c22 2c20  s = [("CV-Val", 
+0000b820: 224d 6561 6e22 292c 2028 2243 562d 5472  "Mean"), ("CV-Tr
+0000b830: 6169 6e22 2c20 224d 6561 6e22 295d 0a20  ain", "Mean")]. 
+0000b840: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000b850: 2020 2020 2020 2020 2069 6e64 6963 6573           indices
+0000b860: 203d 205b 224d 6561 6e22 5d0a 2020 2020   = ["Mean"].    
+0000b870: 2020 2020 6d6f 6465 6c5f 7265 7375 6c74      model_result
+0000b880: 7320 3d20 636f 6c6f 725f 6466 286d 6f64  s = color_df(mod
+0000b890: 656c 5f72 6573 756c 7473 2c20 2279 656c  el_results, "yel
+0000b8a0: 6c6f 7722 2c20 696e 6469 6365 732c 2061  low", indices, a
+0000b8b0: 7869 733d 3129 0a20 2020 2020 2020 206d  xis=1).        m
+0000b8c0: 6f64 656c 5f72 6573 756c 7473 203d 206d  odel_results = m
+0000b8d0: 6f64 656c 5f72 6573 756c 7473 2e66 6f72  odel_results.for
+0000b8e0: 6d61 7428 7072 6563 6973 696f 6e3d 726f  mat(precision=ro
+0000b8f0: 756e 6429 0a20 2020 2020 2020 2072 6574  und).        ret
+0000b900: 7572 6e20 6d6f 6465 6c5f 7265 7375 6c74  urn model_result
+0000b910: 730a 0a20 2020 2040 6162 7374 7261 6374  s..    @abstract
+0000b920: 6d65 7468 6f64 0a20 2020 2064 6566 205f  method.    def _
+0000b930: 6372 6561 7465 5f6d 6f64 656c 5f67 6574  create_model_get
+0000b940: 5f74 7261 696e 5f58 5f79 2873 656c 662c  _train_X_y(self,
+0000b950: 2058 5f74 7261 696e 2c20 795f 7472 6169   X_train, y_trai
+0000b960: 6e29 3a0a 2020 2020 2020 2020 2222 2252  n):.        """R
+0000b970: 6574 7572 6e20 6170 7072 6f70 7269 6174  eturn appropriat
+0000b980: 6520 7472 6169 6e69 6e67 2058 2061 6e64  e training X and
+0000b990: 2079 2076 616c 7565 7320 6465 7065 6e64   y values depend
+0000b9a0: 696e 6720 6f6e 2077 6865 7468 6572 0a20  ing on whether. 
+0000b9b0: 2020 2020 2020 2058 5f74 7261 696e 2061         X_train a
+0000b9c0: 6e64 2079 5f74 7261 696e 2061 7265 2070  nd y_train are p
+0000b9d0: 6173 7365 6420 6f72 206e 6f74 2e22 2222  assed or not."""
+0000b9e0: 0a20 2020 2020 2020 2070 6173 730a 0a20  .        pass.. 
+0000b9f0: 2020 2064 6566 205f 6372 6561 7465 5f6d     def _create_m
+0000ba00: 6f64 656c 280a 2020 2020 2020 2020 7365  odel(.        se
+0000ba10: 6c66 2c0a 2020 2020 2020 2020 6573 7469  lf,.        esti
+0000ba20: 6d61 746f 722c 0a20 2020 2020 2020 2066  mator,.        f
+0000ba30: 6f6c 643a 204f 7074 696f 6e61 6c5b 556e  old: Optional[Un
+0000ba40: 696f 6e5b 696e 742c 2041 6e79 5d5d 203d  ion[int, Any]] =
+0000ba50: 204e 6f6e 652c 0a20 2020 2020 2020 2072   None,.        r
+0000ba60: 6f75 6e64 3a20 696e 7420 3d20 342c 0a20  ound: int = 4,. 
+0000ba70: 2020 2020 2020 2063 726f 7373 5f76 616c         cross_val
+0000ba80: 6964 6174 696f 6e3a 2062 6f6f 6c20 3d20  idation: bool = 
+0000ba90: 5472 7565 2c0a 2020 2020 2020 2020 7072  True,.        pr
+0000baa0: 6564 6963 743a 2062 6f6f 6c20 3d20 5472  edict: bool = Tr
+0000bab0: 7565 2c0a 2020 2020 2020 2020 6669 745f  ue,.        fit_
+0000bac0: 6b77 6172 6773 3a20 4f70 7469 6f6e 616c  kwargs: Optional
+0000bad0: 5b64 6963 745d 203d 204e 6f6e 652c 0a20  [dict] = None,. 
+0000bae0: 2020 2020 2020 2067 726f 7570 733a 204f         groups: O
+0000baf0: 7074 696f 6e61 6c5b 556e 696f 6e5b 7374  ptional[Union[st
+0000bb00: 722c 2041 6e79 5d5d 203d 204e 6f6e 652c  r, Any]] = None,
+0000bb10: 0a20 2020 2020 2020 2072 6566 6974 3a20  .        refit: 
+0000bb20: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
+0000bb30: 2020 2020 2070 726f 6261 6269 6c69 7479       probability
+0000bb40: 5f74 6872 6573 686f 6c64 3a20 4f70 7469  _threshold: Opti
+0000bb50: 6f6e 616c 5b66 6c6f 6174 5d20 3d20 4e6f  onal[float] = No
+0000bb60: 6e65 2c0a 2020 2020 2020 2020 6578 7065  ne,.        expe
+0000bb70: 7269 6d65 6e74 5f63 7573 746f 6d5f 7461  riment_custom_ta
+0000bb80: 6773 3a20 4f70 7469 6f6e 616c 5b44 6963  gs: Optional[Dic
+0000bb90: 745b 7374 722c 2041 6e79 5d5d 203d 204e  t[str, Any]] = N
+0000bba0: 6f6e 652c 0a20 2020 2020 2020 2076 6572  one,.        ver
+0000bbb0: 626f 7365 3a20 626f 6f6c 203d 2054 7275  bose: bool = Tru
+0000bbc0: 652c 0a20 2020 2020 2020 2073 7973 7465  e,.        syste
+0000bbd0: 6d3a 2062 6f6f 6c20 3d20 5472 7565 2c0a  m: bool = True,.
+0000bbe0: 2020 2020 2020 2020 6164 645f 746f 5f6d          add_to_m
+0000bbf0: 6f64 656c 5f6c 6973 743a 2062 6f6f 6c20  odel_list: bool 
+0000bc00: 3d20 5472 7565 2c0a 2020 2020 2020 2020  = True,.        
+0000bc10: 585f 7472 6169 6e5f 6461 7461 3a20 4f70  X_train_data: Op
+0000bc20: 7469 6f6e 616c 5b70 642e 4461 7461 4672  tional[pd.DataFr
+0000bc30: 616d 655d 203d 204e 6f6e 652c 2020 2320  ame] = None,  # 
+0000bc40: 6164 6465 6420 696e 2070 7963 6172 6574  added in pycaret
+0000bc50: 3d3d 322e 322e 300a 2020 2020 2020 2020  ==2.2.0.        
+0000bc60: 795f 7472 6169 6e5f 6461 7461 3a20 4f70  y_train_data: Op
+0000bc70: 7469 6f6e 616c 5b70 642e 4461 7461 4672  tional[pd.DataFr
+0000bc80: 616d 655d 203d 204e 6f6e 652c 2020 2320  ame] = None,  # 
+0000bc90: 6164 6465 6420 696e 2070 7963 6172 6574  added in pycaret
+0000bca0: 3d3d 322e 322e 300a 2020 2020 2020 2020  ==2.2.0.        
+0000bcb0: 6d65 7472 6963 733d 4e6f 6e65 2c0a 2020  metrics=None,.  
+0000bcc0: 2020 2020 2020 6469 7370 6c61 793a 204f        display: O
+0000bcd0: 7074 696f 6e61 6c5b 436f 6d6d 6f6e 4469  ptional[CommonDi
+0000bce0: 7370 6c61 795d 203d 204e 6f6e 652c 2020  splay] = None,  
+0000bcf0: 2320 6164 6465 6420 696e 2070 7963 6172  # added in pycar
+0000bd00: 6574 3d3d 322e 322e 300a 2020 2020 2020  et==2.2.0.      
+0000bd10: 2020 6d6f 6465 6c5f 6f6e 6c79 3a20 626f    model_only: bo
+0000bd20: 6f6c 203d 2054 7275 652c 0a20 2020 2020  ol = True,.     
+0000bd30: 2020 2072 6574 7572 6e5f 7472 6169 6e5f     return_train_
+0000bd40: 7363 6f72 653a 2062 6f6f 6c20 3d20 4661  score: bool = Fa
+0000bd50: 6c73 652c 0a20 2020 2020 2020 202a 2a6b  lse,.        **k
+0000bd60: 7761 7267 732c 0a20 2020 2029 202d 3e20  wargs,.    ) -> 
+0000bd70: 416e 793a 0a20 2020 2020 2020 2022 2222  Any:.        """
+0000bd80: 0a20 2020 2020 2020 2049 6e74 6572 6e61  .        Interna
+0000bd90: 6c20 7665 7273 696f 6e20 6f66 2060 6063  l version of ``c
+0000bda0: 7265 6174 655f 6d6f 6465 6c60 6020 7769  reate_model`` wi
+0000bdb0: 7468 2070 7269 7661 7465 2061 7267 756d  th private argum
+0000bdc0: 656e 7473 2e0a 2020 2020 2020 2020 2222  ents..        ""
+0000bdd0: 220a 2020 2020 2020 2020 7365 6c66 2e5f  ".        self._
+0000bde0: 6368 6563 6b5f 7365 7475 705f 7261 6e28  check_setup_ran(
+0000bdf0: 290a 0a20 2020 2020 2020 2066 756e 6374  )..        funct
+0000be00: 696f 6e5f 7061 7261 6d73 5f73 7472 203d  ion_params_str =
+0000be10: 2022 2c20 222e 6a6f 696e 280a 2020 2020   ", ".join(.    
+0000be20: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
+0000be30: 2020 2020 2020 2020 2020 6622 7b6b 7d3d            f"{k}=
+0000be40: 7b76 7d22 0a20 2020 2020 2020 2020 2020  {v}".           
+0000be50: 2020 2020 2066 6f72 206b 2c20 7620 696e       for k, v in
+0000be60: 206c 6f63 616c 7328 292e 6974 656d 7328   locals().items(
+0000be70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000be80: 2020 6966 206b 206e 6f74 2069 6e20 2822    if k not in ("
+0000be90: 585f 7472 6169 6e5f 6461 7461 222c 2022  X_train_data", "
+0000bea0: 795f 7472 6169 6e5f 6461 7461 2229 0a20  y_train_data"). 
+0000beb0: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
+0000bec0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0000bed0: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
+0000bee0: 2822 496e 6974 6961 6c69 7a69 6e67 2063  ("Initializing c
+0000bef0: 7265 6174 655f 6d6f 6465 6c28 2922 290a  reate_model()").
+0000bf00: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+0000bf10: 6765 722e 696e 666f 2866 2263 7265 6174  ger.info(f"creat
+0000bf20: 655f 6d6f 6465 6c28 7b66 756e 6374 696f  e_model({functio
+0000bf30: 6e5f 7061 7261 6d73 5f73 7472 7d29 2229  n_params_str})")
+0000bf40: 0a0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+0000bf50: 6f67 6765 722e 696e 666f 2822 4368 6563  ogger.info("Chec
+0000bf60: 6b69 6e67 2065 7863 6570 7469 6f6e 7322  king exceptions"
+0000bf70: 290a 0a20 2020 2020 2020 2023 2072 756e  )..        # run
+0000bf80: 5f74 696d 650a 2020 2020 2020 2020 7275  _time.        ru
+0000bf90: 6e74 696d 655f 7374 6172 7420 3d20 7469  ntime_start = ti
+0000bfa0: 6d65 2e74 696d 6528 290a 0a20 2020 2020  me.time()..     
+0000bfb0: 2020 2061 7661 696c 6162 6c65 5f65 7374     available_est
+0000bfc0: 696d 6174 6f72 7320 3d20 7365 7428 7365  imators = set(se
+0000bfd0: 6c66 2e5f 616c 6c5f 6d6f 6465 6c73 5f69  lf._all_models_i
+0000bfe0: 6e74 6572 6e61 6c2e 6b65 7973 2829 290a  nternal.keys()).
+0000bff0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+0000c000: 6669 745f 6b77 6172 6773 3a0a 2020 2020  fit_kwargs:.    
+0000c010: 2020 2020 2020 2020 6669 745f 6b77 6172          fit_kwar
+0000c020: 6773 203d 207b 7d0a 0a20 2020 2020 2020  gs = {}..       
+0000c030: 2023 206f 6e6c 7920 7261 6973 6520 6578   # only raise ex
+0000c040: 6365 7074 696f 6e20 6f66 2065 7374 696d  ception of estim
+0000c050: 6174 6f72 2069 7320 6f66 2074 7970 6520  ator is of type 
+0000c060: 7374 7269 6e67 2e0a 2020 2020 2020 2020  string..        
+0000c070: 6966 2069 7369 6e73 7461 6e63 6528 6573  if isinstance(es
+0000c080: 7469 6d61 746f 722c 2073 7472 293a 0a20  timator, str):. 
+0000c090: 2020 2020 2020 2020 2020 2069 6620 6573             if es
+0000c0a0: 7469 6d61 746f 7220 6e6f 7420 696e 2061  timator not in a
+0000c0b0: 7661 696c 6162 6c65 5f65 7374 696d 6174  vailable_estimat
+0000c0c0: 6f72 733a 0a20 2020 2020 2020 2020 2020  ors:.           
+0000c0d0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0000c0e0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+0000c0f0: 2020 2020 2020 2020 2020 2066 2245 7374             f"Est
+0000c100: 696d 6174 6f72 207b 6573 7469 6d61 746f  imator {estimato
+0000c110: 727d 206e 6f74 2061 7661 696c 6162 6c65  r} not available
+0000c120: 2e20 506c 6561 7365 2073 6565 2064 6f63  . Please see doc
+0000c130: 7374 7269 6e67 2066 6f72 206c 6973 7420  string for list 
+0000c140: 6f66 2061 7661 696c 6162 6c65 2065 7374  of available est
+0000c150: 696d 6174 6f72 732e 220a 2020 2020 2020  imators.".      
+0000c160: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000c170: 2020 2020 656c 6966 206e 6f74 2068 6173      elif not has
+0000c180: 6174 7472 2865 7374 696d 6174 6f72 2c20  attr(estimator, 
+0000c190: 2266 6974 2229 3a0a 2020 2020 2020 2020  "fit"):.        
+0000c1a0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0000c1b0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0000c1c0: 2020 2020 2020 6622 4573 7469 6d61 746f        f"Estimato
+0000c1d0: 7220 7b65 7374 696d 6174 6f72 7d20 646f  r {estimator} do
+0000c1e0: 6573 206e 6f74 2068 6176 6520 7468 6520  es not have the 
+0000c1f0: 7265 7175 6972 6564 2066 6974 2829 206d  required fit() m
+0000c200: 6574 686f 642e 220a 2020 2020 2020 2020  ethod.".        
+0000c210: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
+0000c220: 2063 6865 636b 696e 6720 666f 6c64 2070   checking fold p
+0000c230: 6172 616d 6574 6572 0a20 2020 2020 2020  arameter.       
+0000c240: 2069 6620 666f 6c64 2069 7320 6e6f 7420   if fold is not 
+0000c250: 4e6f 6e65 2061 6e64 206e 6f74 2028 0a20  None and not (. 
+0000c260: 2020 2020 2020 2020 2020 2074 7970 6528             type(
+0000c270: 666f 6c64 2920 6973 2069 6e74 206f 7220  fold) is int or 
+0000c280: 6973 5f73 6b6c 6561 726e 5f63 765f 6765  is_sklearn_cv_ge
+0000c290: 6e65 7261 746f 7228 666f 6c64 290a 2020  nerator(fold).  
+0000c2a0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+0000c2b0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+0000c2c0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0000c2d0: 2020 2020 2020 2266 6f6c 6420 7061 7261        "fold para
+0000c2e0: 6d65 7465 7220 6d75 7374 2062 6520 6569  meter must be ei
+0000c2f0: 7468 6572 204e 6f6e 652c 2061 6e20 696e  ther None, an in
+0000c300: 7465 6765 7220 6f72 2061 2073 6369 6b69  teger or a sciki
+0000c310: 742d 6c65 6172 6e20 636f 6d70 6174 6962  t-learn compatib
+0000c320: 6c65 2043 5620 6765 6e65 7261 746f 7220  le CV generator 
+0000c330: 6f62 6a65 6374 2e22 0a20 2020 2020 2020  object.".       
+0000c340: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0000c350: 2320 6368 6563 6b69 6e67 2072 6f75 6e64  # checking round
+0000c360: 2070 6172 616d 6574 6572 0a20 2020 2020   parameter.     
+0000c370: 2020 2069 6620 7479 7065 2872 6f75 6e64     if type(round
+0000c380: 2920 6973 206e 6f74 2069 6e74 3a0a 2020  ) is not int:.  
+0000c390: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000c3a0: 5479 7065 4572 726f 7228 2252 6f75 6e64  TypeError("Round
+0000c3b0: 2070 6172 616d 6574 6572 206f 6e6c 7920   parameter only 
+0000c3c0: 6163 6365 7074 7320 696e 7465 6765 7220  accepts integer 
+0000c3d0: 7661 6c75 652e 2229 0a0a 2020 2020 2020  value.")..      
+0000c3e0: 2020 2320 6368 6563 6b69 6e67 2076 6572    # checking ver
+0000c3f0: 626f 7365 2070 6172 616d 6574 6572 0a20  bose parameter. 
+0000c400: 2020 2020 2020 2069 6620 7479 7065 2876         if type(v
+0000c410: 6572 626f 7365 2920 6973 206e 6f74 2062  erbose) is not b
+0000c420: 6f6f 6c3a 0a20 2020 2020 2020 2020 2020  ool:.           
+0000c430: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+0000c440: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000c450: 2020 2256 6572 626f 7365 2070 6172 616d    "Verbose param
+0000c460: 6574 6572 2063 616e 206f 6e6c 7920 7461  eter can only ta
+0000c470: 6b65 2061 7267 756d 656e 7420 6173 2054  ke argument as T
+0000c480: 7275 6520 6f72 2046 616c 7365 2e22 0a20  rue or False.". 
+0000c490: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0000c4a0: 2020 2020 2020 2320 6368 6563 6b69 6e67        # checking
+0000c4b0: 2073 7973 7465 6d20 7061 7261 6d65 7465   system paramete
+0000c4c0: 720a 2020 2020 2020 2020 6966 2074 7970  r.        if typ
+0000c4d0: 6528 7379 7374 656d 2920 6973 206e 6f74  e(system) is not
+0000c4e0: 2062 6f6f 6c3a 0a20 2020 2020 2020 2020   bool:.         
+0000c4f0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+0000c500: 6f72 2822 5379 7374 656d 2070 6172 616d  or("System param
+0000c510: 6574 6572 2063 616e 206f 6e6c 7920 7461  eter can only ta
+0000c520: 6b65 2061 7267 756d 656e 7420 6173 2054  ke argument as T
+0000c530: 7275 6520 6f72 2046 616c 7365 2e22 290a  rue or False.").
+0000c540: 0a20 2020 2020 2020 2023 2063 6865 636b  .        # check
+0000c550: 696e 6720 6372 6f73 735f 7661 6c69 6461  ing cross_valida
+0000c560: 7469 6f6e 2070 6172 616d 6574 6572 0a20  tion parameter. 
+0000c570: 2020 2020 2020 2069 6620 7479 7065 2863         if type(c
+0000c580: 726f 7373 5f76 616c 6964 6174 696f 6e29  ross_validation)
+0000c590: 2069 7320 6e6f 7420 626f 6f6c 3a0a 2020   is not bool:.  
+0000c5a0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000c5b0: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
+0000c5c0: 2020 2020 2020 2020 2020 2022 6372 6f73             "cros
+0000c5d0: 735f 7661 6c69 6461 7469 6f6e 2070 6172  s_validation par
+0000c5e0: 616d 6574 6572 2063 616e 206f 6e6c 7920  ameter can only 
+0000c5f0: 7461 6b65 2061 7267 756d 656e 7420 6173  take argument as
+0000c600: 2054 7275 6520 6f72 2046 616c 7365 2e22   True or False."
+0000c610: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0000c620: 2020 2020 2020 2020 2320 6368 6563 6b69          # checki
+0000c630: 6e67 2072 6574 7572 6e5f 7472 6169 6e5f  ng return_train_
+0000c640: 7363 6f72 6520 7061 7261 6d65 7465 720a  score parameter.
+0000c650: 2020 2020 2020 2020 6966 2074 7970 6528          if type(
+0000c660: 7265 7475 726e 5f74 7261 696e 5f73 636f  return_train_sco
+0000c670: 7265 2920 6973 206e 6f74 2062 6f6f 6c3a  re) is not bool:
+0000c680: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000c690: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
+0000c6a0: 2020 2020 2020 2020 2020 2020 2020 2272                "r
+0000c6b0: 6574 7572 6e5f 7472 6169 6e5f 7363 6f72  eturn_train_scor
+0000c6c0: 6520 6361 6e20 6f6e 6c79 2074 616b 6520  e can only take 
+0000c6d0: 6172 6775 6d65 6e74 2061 7320 5472 7565  argument as True
+0000c6e0: 206f 7220 4661 6c73 6522 0a20 2020 2020   or False".     
+0000c6f0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0000c700: 2020 2222 220a 0a20 2020 2020 2020 2045    """..        E
+0000c710: 5252 4f52 2048 414e 444c 494e 4720 454e  RROR HANDLING EN
+0000c720: 4453 2048 4552 450a 0a20 2020 2020 2020  DS HERE..       
+0000c730: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
+0000c740: 206e 6f74 2064 6973 706c 6179 3a0a 2020   not display:.  
+0000c750: 2020 2020 2020 2020 2020 7072 6f67 7265            progre
+0000c760: 7373 5f61 7267 7320 3d20 7b22 6d61 7822  ss_args = {"max"
+0000c770: 3a20 347d 0a20 2020 2020 2020 2020 2020  : 4}.           
+0000c780: 2074 696d 6573 7461 6d70 5374 7220 3d20   timestampStr = 
+0000c790: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+0000c7a0: 652e 6e6f 7728 292e 7374 7266 7469 6d65  e.now().strftime
+0000c7b0: 2822 2548 3a25 4d3a 2553 2229 0a20 2020  ("%H:%M:%S").   
+0000c7c0: 2020 2020 2020 2020 206d 6f6e 6974 6f72           monitor
+0000c7d0: 5f72 6f77 7320 3d20 5b0a 2020 2020 2020  _rows = [.      
+0000c7e0: 2020 2020 2020 2020 2020 5b22 496e 6974            ["Init
+0000c7f0: 6961 7465 6422 2c20 222e 202e 202e 202e  iated", ". . . .
 0000c800: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
-0000c810: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
-0000c820: 222c 2074 696d 6573 7461 6d70 5374 725d  ", timestampStr]
-0000c830: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000c840: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-0000c850: 2020 2020 2020 2020 2253 7461 7475 7322          "Status"
-0000c860: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000c870: 2020 2020 2020 222e 202e 202e 202e 202e        ". . . . .
+0000c810: 202e 202e 202e 202e 202e 202e 222c 2074   . . . . . .", t
+0000c820: 696d 6573 7461 6d70 5374 725d 2c0a 2020  imestampStr],.  
+0000c830: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+0000c840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c850: 2020 2020 2253 7461 7475 7322 2c0a 2020      "Status",.  
+0000c860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c870: 2020 222e 202e 202e 202e 202e 202e 202e    ". . . . . . .
 0000c880: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
-0000c890: 202e 202e 202e 202e 202e 222c 0a20 2020   . . . . .",.   
-0000c8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c8b0: 2022 4c6f 6164 696e 6720 4465 7065 6e64   "Loading Depend
-0000c8c0: 656e 6369 6573 222c 0a20 2020 2020 2020  encies",.       
-0000c8d0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-0000c8e0: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-0000c8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c900: 2020 2245 7374 696d 6174 6f72 222c 0a20    "Estimator",. 
-0000c910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c920: 2020 2022 2e20 2e20 2e20 2e20 2e20 2e20     ". . . . . . 
+0000c890: 202e 202e 202e 222c 0a20 2020 2020 2020   . . .",.       
+0000c8a0: 2020 2020 2020 2020 2020 2020 2022 4c6f               "Lo
+0000c8b0: 6164 696e 6720 4465 7065 6e64 656e 6369  ading Dependenci
+0000c8c0: 6573 222c 0a20 2020 2020 2020 2020 2020  es",.           
+0000c8d0: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+0000c8e0: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
+0000c8f0: 2020 2020 2020 2020 2020 2020 2020 2245                "E
+0000c900: 7374 696d 6174 6f72 222c 0a20 2020 2020  stimator",.     
+0000c910: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000c920: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
 0000c930: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
-0000c940: 2e20 2e20 2e20 2e22 2c0a 2020 2020 2020  . . . .",.      
-0000c950: 2020 2020 2020 2020 2020 2020 2020 2243                "C
-0000c960: 6f6d 7069 6c69 6e67 204c 6962 7261 7279  ompiling Library
-0000c970: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0000c980: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
-0000c990: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-0000c9a0: 6469 7370 6c61 7920 3d20 436f 6d6d 6f6e  display = Common
-0000c9b0: 4469 7370 6c61 7928 0a20 2020 2020 2020  Display(.       
-0000c9c0: 2020 2020 2020 2020 2076 6572 626f 7365           verbose
-0000c9d0: 3d76 6572 626f 7365 2c0a 2020 2020 2020  =verbose,.      
-0000c9e0: 2020 2020 2020 2020 2020 6874 6d6c 5f70            html_p
-0000c9f0: 6172 616d 3d73 656c 662e 6874 6d6c 5f70  aram=self.html_p
-0000ca00: 6172 616d 2c0a 2020 2020 2020 2020 2020  aram,.          
-0000ca10: 2020 2020 2020 7072 6f67 7265 7373 5f61        progress_a
-0000ca20: 7267 733d 7072 6f67 7265 7373 5f61 7267  rgs=progress_arg
-0000ca30: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0000ca40: 2020 206d 6f6e 6974 6f72 5f72 6f77 733d     monitor_rows=
-0000ca50: 6d6f 6e69 746f 725f 726f 7773 2c0a 2020  monitor_rows,.  
-0000ca60: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0000ca70: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
-0000ca80: 2e69 6e66 6f28 2249 6d70 6f72 7469 6e67  .info("Importing
-0000ca90: 206c 6962 7261 7269 6573 2229 0a0a 2020   libraries")..  
-0000caa0: 2020 2020 2020 2320 6765 6e65 7261 6c20        # general 
-0000cab0: 6465 7065 6e64 656e 6369 6573 0a0a 2020  dependencies..  
-0000cac0: 2020 2020 2020 6e70 2e72 616e 646f 6d2e        np.random.
-0000cad0: 7365 6564 2873 656c 662e 7365 6564 290a  seed(self.seed).
-0000cae0: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
-0000caf0: 6767 6572 2e69 6e66 6f28 2243 6f70 7969  gger.info("Copyi
-0000cb00: 6e67 2074 7261 696e 696e 6720 6461 7461  ng training data
-0000cb10: 7365 7422 290a 0a20 2020 2020 2020 2023  set")..        #
-0000cb20: 2053 746f 7269 6e67 2058 5f74 7261 696e   Storing X_train
-0000cb30: 2061 6e64 2079 5f74 7261 696e 2069 6e20   and y_train in 
-0000cb40: 6461 7461 5f58 2061 6e64 2064 6174 615f  data_X and data_
-0000cb50: 7920 7061 7261 6d65 7465 720a 2020 2020  y parameter.    
-0000cb60: 2020 2020 6461 7461 5f58 2c20 6461 7461      data_X, data
-0000cb70: 5f79 203d 2073 656c 662e 5f63 7265 6174  _y = self._creat
-0000cb80: 655f 6d6f 6465 6c5f 6765 745f 7472 6169  e_model_get_trai
-0000cb90: 6e5f 585f 7928 0a20 2020 2020 2020 2020  n_X_y(.         
-0000cba0: 2020 2058 5f74 7261 696e 3d58 5f74 7261     X_train=X_tra
-0000cbb0: 696e 5f64 6174 612c 2079 5f74 7261 696e  in_data, y_train
-0000cbc0: 3d79 5f74 7261 696e 5f64 6174 610a 2020  =y_train_data.  
-0000cbd0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0000cbe0: 2067 726f 7570 7320 3d20 7365 6c66 2e5f   groups = self._
-0000cbf0: 6765 745f 6772 6f75 7073 2867 726f 7570  get_groups(group
-0000cc00: 732c 2064 6174 613d 6461 7461 5f58 290a  s, data=data_X).
-0000cc10: 0a20 2020 2020 2020 2069 6620 6d65 7472  .        if metr
-0000cc20: 6963 7320 6973 204e 6f6e 653a 0a20 2020  ics is None:.   
-0000cc30: 2020 2020 2020 2020 206d 6574 7269 6373           metrics
-0000cc40: 203d 2073 656c 662e 5f61 6c6c 5f6d 6574   = self._all_met
-0000cc50: 7269 6373 0a0a 2020 2020 2020 2020 6469  rics..        di
-0000cc60: 7370 6c61 792e 6d6f 7665 5f70 726f 6772  splay.move_progr
-0000cc70: 6573 7328 290a 0a20 2020 2020 2020 2073  ess()..        s
-0000cc80: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
-0000cc90: 2244 6566 696e 696e 6720 666f 6c64 7322  "Defining folds"
-0000cca0: 290a 0a20 2020 2020 2020 2023 2063 726f  )..        # cro
-0000ccb0: 7373 2076 616c 6964 6174 696f 6e20 7365  ss validation se
-0000ccc0: 7475 7020 7374 6172 7473 2068 6572 650a  tup starts here.
-0000ccd0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0000cce0: 5f6d 6c5f 7573 6563 6173 6520 3d3d 204d  _ml_usecase == M
-0000ccf0: 4c55 7365 6361 7365 2e54 494d 455f 5345  LUsecase.TIME_SE
-0000cd00: 5249 4553 3a0a 2020 2020 2020 2020 2020  RIES:.          
-0000cd10: 2020 6376 203d 2073 656c 662e 6765 745f    cv = self.get_
-0000cd20: 666f 6c64 5f67 656e 6572 6174 6f72 2866  fold_generator(f
-0000cd30: 6f6c 643d 666f 6c64 290a 0a20 2020 2020  old=fold)..     
-0000cd40: 2020 2020 2020 2023 2041 6464 2066 6f72         # Add for
-0000cd50: 6563 6173 7420 686f 7269 7a6f 6e0a 2020  ecast horizon.  
-0000cd60: 2020 2020 2020 2020 2020 6669 745f 6b77            fit_kw
-0000cd70: 6172 6773 203d 2073 656c 662e 7570 6461  args = self.upda
-0000cd80: 7465 5f66 6974 5f6b 7761 7267 735f 7769  te_fit_kwargs_wi
-0000cd90: 7468 5f66 685f 6672 6f6d 5f63 7628 0a20  th_fh_from_cv(. 
-0000cda0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000cdb0: 6974 5f6b 7761 7267 733d 6669 745f 6b77  it_kwargs=fit_kw
-0000cdc0: 6172 6773 2c20 6376 3d63 760a 2020 2020  args, cv=cv.    
-0000cdd0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0000cde0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000cdf0: 2020 2020 2063 7620 3d20 7365 6c66 2e5f       cv = self._
-0000ce00: 6765 745f 6376 5f73 706c 6974 7465 7228  get_cv_splitter(
-0000ce10: 666f 6c64 290a 0a20 2020 2020 2020 2073  fold)..        s
-0000ce20: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
-0000ce30: 2244 6563 6c61 7269 6e67 206d 6574 7269  "Declaring metri
-0000ce40: 6320 7661 7269 6162 6c65 7322 290a 0a20  c variables").. 
-0000ce50: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000ce60: 2020 204d 4f4e 4954 4f52 2055 5044 4154     MONITOR UPDAT
-0000ce70: 4520 5354 4152 5453 0a20 2020 2020 2020  E STARTS.       
-0000ce80: 2022 2222 0a20 2020 2020 2020 2064 6973   """.        dis
-0000ce90: 706c 6179 2e75 7064 6174 655f 6d6f 6e69  play.update_moni
-0000cea0: 746f 7228 312c 2022 5365 6c65 6374 696e  tor(1, "Selectin
-0000ceb0: 6720 4573 7469 6d61 746f 7222 290a 2020  g Estimator").  
-0000cec0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000ced0: 2020 4d4f 4e49 544f 5220 5550 4441 5445    MONITOR UPDATE
-0000cee0: 2045 4e44 530a 2020 2020 2020 2020 2222   ENDS.        ""
-0000cef0: 220a 0a20 2020 2020 2020 2073 656c 662e  "..        self.
-0000cf00: 6c6f 6767 6572 2e69 6e66 6f28 2249 6d70  logger.info("Imp
-0000cf10: 6f72 7469 6e67 2075 6e74 7261 696e 6564  orting untrained
-0000cf20: 206d 6f64 656c 2229 0a0a 2020 2020 2020   model")..      
-0000cf30: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0000cf40: 6573 7469 6d61 746f 722c 2073 7472 2920  estimator, str) 
-0000cf50: 616e 6420 6573 7469 6d61 746f 7220 696e  and estimator in
-0000cf60: 2061 7661 696c 6162 6c65 5f65 7374 696d   available_estim
-0000cf70: 6174 6f72 733a 0a20 2020 2020 2020 2020  ators:.         
-0000cf80: 2020 206d 6f64 656c 5f64 6566 696e 6974     model_definit
-0000cf90: 696f 6e20 3d20 7365 6c66 2e5f 616c 6c5f  ion = self._all_
-0000cfa0: 6d6f 6465 6c73 5f69 6e74 6572 6e61 6c5b  models_internal[
-0000cfb0: 6573 7469 6d61 746f 725d 0a20 2020 2020  estimator].     
-0000cfc0: 2020 2020 2020 206d 6f64 656c 5f61 7267         model_arg
-0000cfd0: 7320 3d20 6d6f 6465 6c5f 6465 6669 6e69  s = model_defini
-0000cfe0: 7469 6f6e 2e61 7267 730a 2020 2020 2020  tion.args.      
-0000cff0: 2020 2020 2020 6d6f 6465 6c5f 6172 6773        model_args
-0000d000: 203d 207b 2a2a 6d6f 6465 6c5f 6172 6773   = {**model_args
-0000d010: 2c20 2a2a 6b77 6172 6773 7d0a 2020 2020  , **kwargs}.    
-0000d020: 2020 2020 2020 2020 6d6f 6465 6c20 3d20          model = 
-0000d030: 6d6f 6465 6c5f 6465 6669 6e69 7469 6f6e  model_definition
-0000d040: 2e63 6c61 7373 5f64 6566 282a 2a6d 6f64  .class_def(**mod
-0000d050: 656c 5f61 7267 7329 0a20 2020 2020 2020  el_args).       
-0000d060: 2020 2020 2066 756c 6c5f 6e61 6d65 203d       full_name =
-0000d070: 206d 6f64 656c 5f64 6566 696e 6974 696f   model_definitio
-0000d080: 6e2e 6e61 6d65 0a20 2020 2020 2020 2065  n.name.        e
-0000d090: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000d0a0: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
-0000d0b0: 6f28 2244 6563 6c61 7269 6e67 2063 7573  o("Declaring cus
-0000d0c0: 746f 6d20 6d6f 6465 6c22 290a 0a20 2020  tom model")..   
-0000d0d0: 2020 2020 2020 2020 206d 6f64 656c 203d           model =
-0000d0e0: 2063 6c6f 6e65 2865 7374 696d 6174 6f72   clone(estimator
-0000d0f0: 290a 2020 2020 2020 2020 2020 2020 6d6f  ).            mo
-0000d100: 6465 6c2e 7365 745f 7061 7261 6d73 282a  del.set_params(*
-0000d110: 2a6b 7761 7267 7329 0a0a 2020 2020 2020  *kwargs)..      
-0000d120: 2020 2020 2020 6675 6c6c 5f6e 616d 6520        full_name 
-0000d130: 3d20 7365 6c66 2e5f 6765 745f 6d6f 6465  = self._get_mode
-0000d140: 6c5f 6e61 6d65 286d 6f64 656c 290a 0a20  l_name(model).. 
-0000d150: 2020 2020 2020 2023 2077 6f72 6b61 726f         # workaro
-0000d160: 756e 6420 666f 7220 616e 2069 7373 7565  und for an issue
-0000d170: 2077 6974 6820 7365 745f 7061 7261 6d73   with set_params
-0000d180: 2069 6e20 6375 4d4c 0a20 2020 2020 2020   in cuML.       
-0000d190: 206d 6f64 656c 203d 2063 6c6f 6e65 286d   model = clone(m
-0000d1a0: 6f64 656c 290a 0a20 2020 2020 2020 2064  odel)..        d
-0000d1b0: 6973 706c 6179 2e75 7064 6174 655f 6d6f  isplay.update_mo
-0000d1c0: 6e69 746f 7228 322c 2066 756c 6c5f 6e61  nitor(2, full_na
-0000d1d0: 6d65 290a 0a20 2020 2020 2020 2069 6620  me)..        if 
-0000d1e0: 7072 6f62 6162 696c 6974 795f 7468 7265  probability_thre
-0000d1f0: 7368 6f6c 6420 6973 206e 6f74 204e 6f6e  shold is not Non
-0000d200: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
-0000d210: 6620 7365 6c66 2e5f 6d6c 5f75 7365 6361  f self._ml_useca
-0000d220: 7365 2021 3d20 4d4c 5573 6563 6173 652e  se != MLUsecase.
-0000d230: 434c 4153 5349 4649 4341 5449 4f4e 206f  CLASSIFICATION o
-0000d240: 7220 7365 6c66 2e69 735f 6d75 6c74 6963  r self.is_multic
-0000d250: 6c61 7373 3a0a 2020 2020 2020 2020 2020  lass:.          
-0000d260: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0000d270: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-0000d280: 2020 2020 2020 2020 2020 2020 2243 616e              "Can
-0000d290: 6e6f 7420 7573 6520 7072 6f62 6162 696c  not use probabil
-0000d2a0: 6974 795f 7468 7265 7368 6f6c 6420 7769  ity_threshold wi
-0000d2b0: 7468 206e 6f6e 2d62 696e 6172 7920 220a  th non-binary ".
+0000c940: 2e20 2e22 2c0a 2020 2020 2020 2020 2020  . .",.          
+0000c950: 2020 2020 2020 2020 2020 2243 6f6d 7069            "Compi
+0000c960: 6c69 6e67 204c 6962 7261 7279 222c 0a20  ling Library",. 
+0000c970: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+0000c980: 2c0a 2020 2020 2020 2020 2020 2020 5d0a  ,.            ].
+0000c990: 2020 2020 2020 2020 2020 2020 6469 7370              disp
+0000c9a0: 6c61 7920 3d20 436f 6d6d 6f6e 4469 7370  lay = CommonDisp
+0000c9b0: 6c61 7928 0a20 2020 2020 2020 2020 2020  lay(.           
+0000c9c0: 2020 2020 2076 6572 626f 7365 3d76 6572       verbose=ver
+0000c9d0: 626f 7365 2c0a 2020 2020 2020 2020 2020  bose,.          
+0000c9e0: 2020 2020 2020 6874 6d6c 5f70 6172 616d        html_param
+0000c9f0: 3d73 656c 662e 6874 6d6c 5f70 6172 616d  =self.html_param
+0000ca00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000ca10: 2020 7072 6f67 7265 7373 5f61 7267 733d    progress_args=
+0000ca20: 7072 6f67 7265 7373 5f61 7267 732c 0a20  progress_args,. 
+0000ca30: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0000ca40: 6f6e 6974 6f72 5f72 6f77 733d 6d6f 6e69  onitor_rows=moni
+0000ca50: 746f 725f 726f 7773 2c0a 2020 2020 2020  tor_rows,.      
+0000ca60: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0000ca70: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
+0000ca80: 6f28 2249 6d70 6f72 7469 6e67 206c 6962  o("Importing lib
+0000ca90: 7261 7269 6573 2229 0a0a 2020 2020 2020  raries")..      
+0000caa0: 2020 2320 6765 6e65 7261 6c20 6465 7065    # general depe
+0000cab0: 6e64 656e 6369 6573 0a0a 2020 2020 2020  ndencies..      
+0000cac0: 2020 6e70 2e72 616e 646f 6d2e 7365 6564    np.random.seed
+0000cad0: 2873 656c 662e 7365 6564 290a 0a20 2020  (self.seed)..   
+0000cae0: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
+0000caf0: 2e69 6e66 6f28 2243 6f70 7969 6e67 2074  .info("Copying t
+0000cb00: 7261 696e 696e 6720 6461 7461 7365 7422  raining dataset"
+0000cb10: 290a 0a20 2020 2020 2020 2023 2053 746f  )..        # Sto
+0000cb20: 7269 6e67 2058 5f74 7261 696e 2061 6e64  ring X_train and
+0000cb30: 2079 5f74 7261 696e 2069 6e20 6461 7461   y_train in data
+0000cb40: 5f58 2061 6e64 2064 6174 615f 7920 7061  _X and data_y pa
+0000cb50: 7261 6d65 7465 720a 2020 2020 2020 2020  rameter.        
+0000cb60: 6461 7461 5f58 2c20 6461 7461 5f79 203d  data_X, data_y =
+0000cb70: 2073 656c 662e 5f63 7265 6174 655f 6d6f   self._create_mo
+0000cb80: 6465 6c5f 6765 745f 7472 6169 6e5f 585f  del_get_train_X_
+0000cb90: 7928 0a20 2020 2020 2020 2020 2020 2058  y(.            X
+0000cba0: 5f74 7261 696e 3d58 5f74 7261 696e 5f64  _train=X_train_d
+0000cbb0: 6174 612c 2079 5f74 7261 696e 3d79 5f74  ata, y_train=y_t
+0000cbc0: 7261 696e 5f64 6174 610a 2020 2020 2020  rain_data.      
+0000cbd0: 2020 290a 0a20 2020 2020 2020 2067 726f    )..        gro
+0000cbe0: 7570 7320 3d20 7365 6c66 2e5f 6765 745f  ups = self._get_
+0000cbf0: 6772 6f75 7073 2867 726f 7570 732c 2064  groups(groups, d
+0000cc00: 6174 613d 6461 7461 5f58 290a 0a20 2020  ata=data_X)..   
+0000cc10: 2020 2020 2069 6620 6d65 7472 6963 7320       if metrics 
+0000cc20: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0000cc30: 2020 2020 206d 6574 7269 6373 203d 2073       metrics = s
+0000cc40: 656c 662e 5f61 6c6c 5f6d 6574 7269 6373  elf._all_metrics
+0000cc50: 0a0a 2020 2020 2020 2020 6469 7370 6c61  ..        displa
+0000cc60: 792e 6d6f 7665 5f70 726f 6772 6573 7328  y.move_progress(
+0000cc70: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+0000cc80: 6c6f 6767 6572 2e69 6e66 6f28 2244 6566  logger.info("Def
+0000cc90: 696e 696e 6720 666f 6c64 7322 290a 0a20  ining folds").. 
+0000cca0: 2020 2020 2020 2023 2063 726f 7373 2076         # cross v
+0000ccb0: 616c 6964 6174 696f 6e20 7365 7475 7020  alidation setup 
+0000ccc0: 7374 6172 7473 2068 6572 650a 2020 2020  starts here.    
+0000ccd0: 2020 2020 6966 2073 656c 662e 5f6d 6c5f      if self._ml_
+0000cce0: 7573 6563 6173 6520 3d3d 204d 4c55 7365  usecase == MLUse
+0000ccf0: 6361 7365 2e54 494d 455f 5345 5249 4553  case.TIME_SERIES
+0000cd00: 3a0a 2020 2020 2020 2020 2020 2020 6376  :.            cv
+0000cd10: 203d 2073 656c 662e 6765 745f 666f 6c64   = self.get_fold
+0000cd20: 5f67 656e 6572 6174 6f72 2866 6f6c 643d  _generator(fold=
+0000cd30: 666f 6c64 290a 0a20 2020 2020 2020 2020  fold)..         
+0000cd40: 2020 2023 2041 6464 2066 6f72 6563 6173     # Add forecas
+0000cd50: 7420 686f 7269 7a6f 6e0a 2020 2020 2020  t horizon.      
+0000cd60: 2020 2020 2020 6669 745f 6b77 6172 6773        fit_kwargs
+0000cd70: 203d 2073 656c 662e 7570 6461 7465 5f66   = self.update_f
+0000cd80: 6974 5f6b 7761 7267 735f 7769 7468 5f66  it_kwargs_with_f
+0000cd90: 685f 6672 6f6d 5f63 7628 0a20 2020 2020  h_from_cv(.     
+0000cda0: 2020 2020 2020 2020 2020 2066 6974 5f6b             fit_k
+0000cdb0: 7761 7267 733d 6669 745f 6b77 6172 6773  wargs=fit_kwargs
+0000cdc0: 2c20 6376 3d63 760a 2020 2020 2020 2020  , cv=cv.        
+0000cdd0: 2020 2020 290a 0a20 2020 2020 2020 2065      )..        e
+0000cde0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0000cdf0: 2063 7620 3d20 7365 6c66 2e5f 6765 745f   cv = self._get_
+0000ce00: 6376 5f73 706c 6974 7465 7228 666f 6c64  cv_splitter(fold
+0000ce10: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+0000ce20: 6c6f 6767 6572 2e69 6e66 6f28 2244 6563  logger.info("Dec
+0000ce30: 6c61 7269 6e67 206d 6574 7269 6320 7661  laring metric va
+0000ce40: 7269 6162 6c65 7322 290a 0a20 2020 2020  riables")..     
+0000ce50: 2020 2022 2222 0a20 2020 2020 2020 204d     """.        M
+0000ce60: 4f4e 4954 4f52 2055 5044 4154 4520 5354  ONITOR UPDATE ST
+0000ce70: 4152 5453 0a20 2020 2020 2020 2022 2222  ARTS.        """
+0000ce80: 0a20 2020 2020 2020 2064 6973 706c 6179  .        display
+0000ce90: 2e75 7064 6174 655f 6d6f 6e69 746f 7228  .update_monitor(
+0000cea0: 312c 2022 5365 6c65 6374 696e 6720 4573  1, "Selecting Es
+0000ceb0: 7469 6d61 746f 7222 290a 2020 2020 2020  timator").      
+0000cec0: 2020 2222 220a 2020 2020 2020 2020 4d4f    """.        MO
+0000ced0: 4e49 544f 5220 5550 4441 5445 2045 4e44  NITOR UPDATE END
+0000cee0: 530a 2020 2020 2020 2020 2222 220a 0a20  S.        """.. 
+0000cef0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+0000cf00: 6572 2e69 6e66 6f28 2249 6d70 6f72 7469  er.info("Importi
+0000cf10: 6e67 2075 6e74 7261 696e 6564 206d 6f64  ng untrained mod
+0000cf20: 656c 2229 0a0a 2020 2020 2020 2020 6966  el")..        if
+0000cf30: 2069 7369 6e73 7461 6e63 6528 6573 7469   isinstance(esti
+0000cf40: 6d61 746f 722c 2073 7472 2920 616e 6420  mator, str) and 
+0000cf50: 6573 7469 6d61 746f 7220 696e 2061 7661  estimator in ava
+0000cf60: 696c 6162 6c65 5f65 7374 696d 6174 6f72  ilable_estimator
+0000cf70: 733a 0a20 2020 2020 2020 2020 2020 206d  s:.            m
+0000cf80: 6f64 656c 5f64 6566 696e 6974 696f 6e20  odel_definition 
+0000cf90: 3d20 7365 6c66 2e5f 616c 6c5f 6d6f 6465  = self._all_mode
+0000cfa0: 6c73 5f69 6e74 6572 6e61 6c5b 6573 7469  ls_internal[esti
+0000cfb0: 6d61 746f 725d 0a20 2020 2020 2020 2020  mator].         
+0000cfc0: 2020 206d 6f64 656c 5f61 7267 7320 3d20     model_args = 
+0000cfd0: 6d6f 6465 6c5f 6465 6669 6e69 7469 6f6e  model_definition
+0000cfe0: 2e61 7267 730a 2020 2020 2020 2020 2020  .args.          
+0000cff0: 2020 6d6f 6465 6c5f 6172 6773 203d 207b    model_args = {
+0000d000: 2a2a 6d6f 6465 6c5f 6172 6773 2c20 2a2a  **model_args, **
+0000d010: 6b77 6172 6773 7d0a 2020 2020 2020 2020  kwargs}.        
+0000d020: 2020 2020 6d6f 6465 6c20 3d20 6d6f 6465      model = mode
+0000d030: 6c5f 6465 6669 6e69 7469 6f6e 2e63 6c61  l_definition.cla
+0000d040: 7373 5f64 6566 282a 2a6d 6f64 656c 5f61  ss_def(**model_a
+0000d050: 7267 7329 0a20 2020 2020 2020 2020 2020  rgs).           
+0000d060: 2066 756c 6c5f 6e61 6d65 203d 206d 6f64   full_name = mod
+0000d070: 656c 5f64 6566 696e 6974 696f 6e2e 6e61  el_definition.na
+0000d080: 6d65 0a20 2020 2020 2020 2065 6c73 653a  me.        else:
+0000d090: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000d0a0: 662e 6c6f 6767 6572 2e69 6e66 6f28 2244  f.logger.info("D
+0000d0b0: 6563 6c61 7269 6e67 2063 7573 746f 6d20  eclaring custom 
+0000d0c0: 6d6f 6465 6c22 290a 0a20 2020 2020 2020  model")..       
+0000d0d0: 2020 2020 206d 6f64 656c 203d 2063 6c6f       model = clo
+0000d0e0: 6e65 2865 7374 696d 6174 6f72 290a 2020  ne(estimator).  
+0000d0f0: 2020 2020 2020 2020 2020 6d6f 6465 6c2e            model.
+0000d100: 7365 745f 7061 7261 6d73 282a 2a6b 7761  set_params(**kwa
+0000d110: 7267 7329 0a0a 2020 2020 2020 2020 2020  rgs)..          
+0000d120: 2020 6675 6c6c 5f6e 616d 6520 3d20 7365    full_name = se
+0000d130: 6c66 2e5f 6765 745f 6d6f 6465 6c5f 6e61  lf._get_model_na
+0000d140: 6d65 286d 6f64 656c 290a 0a20 2020 2020  me(model)..     
+0000d150: 2020 2023 2077 6f72 6b61 726f 756e 6420     # workaround 
+0000d160: 666f 7220 616e 2069 7373 7565 2077 6974  for an issue wit
+0000d170: 6820 7365 745f 7061 7261 6d73 2069 6e20  h set_params in 
+0000d180: 6375 4d4c 0a20 2020 2020 2020 206d 6f64  cuML.        mod
+0000d190: 656c 203d 2063 6c6f 6e65 286d 6f64 656c  el = clone(model
+0000d1a0: 290a 0a20 2020 2020 2020 2064 6973 706c  )..        displ
+0000d1b0: 6179 2e75 7064 6174 655f 6d6f 6e69 746f  ay.update_monito
+0000d1c0: 7228 322c 2066 756c 6c5f 6e61 6d65 290a  r(2, full_name).
+0000d1d0: 0a20 2020 2020 2020 2069 6620 7072 6f62  .        if prob
+0000d1e0: 6162 696c 6974 795f 7468 7265 7368 6f6c  ability_threshol
+0000d1f0: 6420 6973 206e 6f74 204e 6f6e 653a 0a20  d is not None:. 
+0000d200: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0000d210: 6c66 2e5f 6d6c 5f75 7365 6361 7365 2021  lf._ml_usecase !
+0000d220: 3d20 4d4c 5573 6563 6173 652e 434c 4153  = MLUsecase.CLAS
+0000d230: 5349 4649 4341 5449 4f4e 206f 7220 7365  SIFICATION or se
+0000d240: 6c66 2e69 735f 6d75 6c74 6963 6c61 7373  lf.is_multiclass
+0000d250: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000d260: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0000d270: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0000d280: 2020 2020 2020 2020 2243 616e 6e6f 7420          "Cannot 
+0000d290: 7573 6520 7072 6f62 6162 696c 6974 795f  use probability_
+0000d2a0: 7468 7265 7368 6f6c 6420 7769 7468 206e  threshold with n
+0000d2b0: 6f6e 2d62 696e 6172 7920 220a 2020 2020  on-binary ".    
 0000d2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d2d0: 2020 2020 2263 6c61 7373 6966 6963 6174      "classificat
-0000d2e0: 696f 6e20 7573 6563 6173 6573 2e22 0a20  ion usecases.". 
-0000d2f0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0000d300: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000d310: 6e6f 7420 6973 696e 7374 616e 6365 286d  not isinstance(m
-0000d320: 6f64 656c 2c20 4375 7374 6f6d 5072 6f62  odel, CustomProb
-0000d330: 6162 696c 6974 7954 6872 6573 686f 6c64  abilityThreshold
-0000d340: 436c 6173 7369 6669 6572 293a 0a20 2020  Classifier):.   
-0000d350: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-0000d360: 656c 203d 2043 7573 746f 6d50 726f 6261  el = CustomProba
-0000d370: 6269 6c69 7479 5468 7265 7368 6f6c 6443  bilityThresholdC
-0000d380: 6c61 7373 6966 6965 7228 0a20 2020 2020  lassifier(.     
-0000d390: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0000d3a0: 6c61 7373 6966 6965 723d 6d6f 6465 6c2c  lassifier=model,
-0000d3b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d3c0: 2020 2020 2070 726f 6261 6269 6c69 7479       probability
-0000d3d0: 5f74 6872 6573 686f 6c64 3d70 726f 6261  _threshold=proba
-0000d3e0: 6269 6c69 7479 5f74 6872 6573 686f 6c64  bility_threshold
-0000d3f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000d400: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0000d410: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000d420: 2020 2020 2020 6d6f 6465 6c2e 7365 745f        model.set_
-0000d430: 7061 7261 6d73 2870 726f 6261 6269 6c69  params(probabili
-0000d440: 7479 5f74 6872 6573 686f 6c64 3d70 726f  ty_threshold=pro
-0000d450: 6261 6269 6c69 7479 5f74 6872 6573 686f  bability_thresho
-0000d460: 6c64 290a 2020 2020 2020 2020 7365 6c66  ld).        self
-0000d470: 2e6c 6f67 6765 722e 696e 666f 2866 227b  .logger.info(f"{
-0000d480: 6675 6c6c 5f6e 616d 657d 2049 6d70 6f72  full_name} Impor
-0000d490: 7465 6420 7375 6363 6573 7366 756c 6c79  ted successfully
-0000d4a0: 2229 0a0a 2020 2020 2020 2020 6469 7370  ")..        disp
-0000d4b0: 6c61 792e 6d6f 7665 5f70 726f 6772 6573  lay.move_progres
-0000d4c0: 7328 290a 0a20 2020 2020 2020 2022 2222  s()..        """
-0000d4d0: 0a20 2020 2020 2020 204d 4f4e 4954 4f52  .        MONITOR
-0000d4e0: 2055 5044 4154 4520 5354 4152 5453 0a20   UPDATE STARTS. 
-0000d4f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000d500: 2020 2069 6620 6e6f 7420 6372 6f73 735f     if not cross_
-0000d510: 7661 6c69 6461 7469 6f6e 3a0a 2020 2020  validation:.    
-0000d520: 2020 2020 2020 2020 6469 7370 6c61 792e          display.
-0000d530: 7570 6461 7465 5f6d 6f6e 6974 6f72 2831  update_monitor(1
-0000d540: 2c20 6622 4669 7474 696e 6720 7b73 7472  , f"Fitting {str
-0000d550: 2866 756c 6c5f 6e61 6d65 297d 2229 0a20  (full_name)}"). 
-0000d560: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000d570: 2020 2020 2020 2020 2064 6973 706c 6179           display
-0000d580: 2e75 7064 6174 655f 6d6f 6e69 746f 7228  .update_monitor(
-0000d590: 312c 2022 496e 6974 6961 6c69 7a69 6e67  1, "Initializing
-0000d5a0: 2043 5622 290a 0a20 2020 2020 2020 2022   CV")..        "
-0000d5b0: 2222 0a20 2020 2020 2020 204d 4f4e 4954  "".        MONIT
-0000d5c0: 4f52 2055 5044 4154 4520 454e 4453 0a20  OR UPDATE ENDS. 
-0000d5d0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-0000d5e0: 2020 2020 6966 206e 6f74 2063 726f 7373      if not cross
-0000d5f0: 5f76 616c 6964 6174 696f 6e3a 0a20 2020  _validation:.   
-0000d600: 2020 2020 2020 2020 206d 6f64 656c 2c20           model, 
-0000d610: 6d6f 6465 6c5f 6669 745f 7469 6d65 203d  model_fit_time =
-0000d620: 2073 656c 662e 5f63 7265 6174 655f 6d6f   self._create_mo
-0000d630: 6465 6c5f 7769 7468 6f75 745f 6376 280a  del_without_cv(.
-0000d640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d650: 6d6f 6465 6c2c 0a20 2020 2020 2020 2020  model,.         
-0000d660: 2020 2020 2020 2064 6174 615f 582c 0a20         data_X,. 
-0000d670: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0000d680: 6174 615f 792c 0a20 2020 2020 2020 2020  ata_y,.         
-0000d690: 2020 2020 2020 2066 6974 5f6b 7761 7267         fit_kwarg
-0000d6a0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0000d6b0: 2020 2072 6f75 6e64 2c0a 2020 2020 2020     round,.      
-0000d6c0: 2020 2020 2020 2020 2020 7072 6564 6963            predic
-0000d6d0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-0000d6e0: 2020 2073 7973 7465 6d2c 0a20 2020 2020     system,.     
-0000d6f0: 2020 2020 2020 2020 2020 2064 6973 706c             displ
-0000d700: 6179 2c0a 2020 2020 2020 2020 2020 2020  ay,.            
-0000d710: 2020 2020 6d6f 6465 6c5f 6f6e 6c79 3d6d      model_only=m
-0000d720: 6f64 656c 5f6f 6e6c 792c 0a20 2020 2020  odel_only,.     
-0000d730: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000d740: 6e5f 7472 6169 6e5f 7363 6f72 653d 7265  n_train_score=re
-0000d750: 7475 726e 5f74 7261 696e 5f73 636f 7265  turn_train_score
-0000d760: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0000d770: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
-0000d780: 706c 6179 2e6d 6f76 655f 7072 6f67 7265  play.move_progre
-0000d790: 7373 2829 0a0a 2020 2020 2020 2020 2020  ss()..          
-0000d7a0: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
-0000d7b0: 666f 2873 7472 286d 6f64 656c 2929 0a20  fo(str(model)). 
-0000d7c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000d7d0: 6c6f 6767 6572 2e69 6e66 6f28 0a20 2020  logger.info(.   
-0000d7e0: 2020 2020 2020 2020 2020 2020 2022 6372               "cr
-0000d7f0: 6561 7465 5f6d 6f64 656c 2829 2073 7563  eate_model() suc
-0000d800: 6365 7373 6675 6c6c 7920 636f 6d70 6c65  cessfully comple
-0000d810: 7465 642e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ted.............
+0000d2d0: 2263 6c61 7373 6966 6963 6174 696f 6e20  "classification 
+0000d2e0: 7573 6563 6173 6573 2e22 0a20 2020 2020  usecases.".     
+0000d2f0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000d300: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0000d310: 6973 696e 7374 616e 6365 286d 6f64 656c  isinstance(model
+0000d320: 2c20 4375 7374 6f6d 5072 6f62 6162 696c  , CustomProbabil
+0000d330: 6974 7954 6872 6573 686f 6c64 436c 6173  ityThresholdClas
+0000d340: 7369 6669 6572 293a 0a20 2020 2020 2020  sifier):.       
+0000d350: 2020 2020 2020 2020 206d 6f64 656c 203d           model =
+0000d360: 2043 7573 746f 6d50 726f 6261 6269 6c69   CustomProbabili
+0000d370: 7479 5468 7265 7368 6f6c 6443 6c61 7373  tyThresholdClass
+0000d380: 6966 6965 7228 0a20 2020 2020 2020 2020  ifier(.         
+0000d390: 2020 2020 2020 2020 2020 2063 6c61 7373             class
+0000d3a0: 6966 6965 723d 6d6f 6465 6c2c 0a20 2020  ifier=model,.   
+0000d3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d3c0: 2070 726f 6261 6269 6c69 7479 5f74 6872   probability_thr
+0000d3d0: 6573 686f 6c64 3d70 726f 6261 6269 6c69  eshold=probabili
+0000d3e0: 7479 5f74 6872 6573 686f 6c64 2c0a 2020  ty_threshold,.  
+0000d3f0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0000d400: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0000d410: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000d420: 2020 6d6f 6465 6c2e 7365 745f 7061 7261    model.set_para
+0000d430: 6d73 2870 726f 6261 6269 6c69 7479 5f74  ms(probability_t
+0000d440: 6872 6573 686f 6c64 3d70 726f 6261 6269  hreshold=probabi
+0000d450: 6c69 7479 5f74 6872 6573 686f 6c64 290a  lity_threshold).
+0000d460: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+0000d470: 6765 722e 696e 666f 2866 227b 6675 6c6c  ger.info(f"{full
+0000d480: 5f6e 616d 657d 2049 6d70 6f72 7465 6420  _name} Imported 
+0000d490: 7375 6363 6573 7366 756c 6c79 2229 0a0a  successfully")..
+0000d4a0: 2020 2020 2020 2020 6469 7370 6c61 792e          display.
+0000d4b0: 6d6f 7665 5f70 726f 6772 6573 7328 290a  move_progress().
+0000d4c0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000d4d0: 2020 2020 204d 4f4e 4954 4f52 2055 5044       MONITOR UPD
+0000d4e0: 4154 4520 5354 4152 5453 0a20 2020 2020  ATE STARTS.     
+0000d4f0: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+0000d500: 6620 6e6f 7420 6372 6f73 735f 7661 6c69  f not cross_vali
+0000d510: 6461 7469 6f6e 3a0a 2020 2020 2020 2020  dation:.        
+0000d520: 2020 2020 6469 7370 6c61 792e 7570 6461      display.upda
+0000d530: 7465 5f6d 6f6e 6974 6f72 2831 2c20 6622  te_monitor(1, f"
+0000d540: 4669 7474 696e 6720 7b73 7472 2866 756c  Fitting {str(ful
+0000d550: 6c5f 6e61 6d65 297d 2229 0a20 2020 2020  l_name)}").     
+0000d560: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000d570: 2020 2020 2064 6973 706c 6179 2e75 7064       display.upd
+0000d580: 6174 655f 6d6f 6e69 746f 7228 312c 2022  ate_monitor(1, "
+0000d590: 496e 6974 6961 6c69 7a69 6e67 2043 5622  Initializing CV"
+0000d5a0: 290a 0a20 2020 2020 2020 2022 2222 0a20  )..        """. 
+0000d5b0: 2020 2020 2020 204d 4f4e 4954 4f52 2055         MONITOR U
+0000d5c0: 5044 4154 4520 454e 4453 0a20 2020 2020  PDATE ENDS.     
+0000d5d0: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+0000d5e0: 6966 206e 6f74 2063 726f 7373 5f76 616c  if not cross_val
+0000d5f0: 6964 6174 696f 6e3a 0a20 2020 2020 2020  idation:.       
+0000d600: 2020 2020 206d 6f64 656c 2c20 6d6f 6465       model, mode
+0000d610: 6c5f 6669 745f 7469 6d65 203d 2073 656c  l_fit_time = sel
+0000d620: 662e 5f63 7265 6174 655f 6d6f 6465 6c5f  f._create_model_
+0000d630: 7769 7468 6f75 745f 6376 280a 2020 2020  without_cv(.    
+0000d640: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+0000d650: 6c2c 0a20 2020 2020 2020 2020 2020 2020  l,.             
+0000d660: 2020 2064 6174 615f 582c 0a20 2020 2020     data_X,.     
+0000d670: 2020 2020 2020 2020 2020 2064 6174 615f             data_
+0000d680: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+0000d690: 2020 2066 6974 5f6b 7761 7267 732c 0a20     fit_kwargs,. 
+0000d6a0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000d6b0: 6f75 6e64 2c0a 2020 2020 2020 2020 2020  ound,.          
+0000d6c0: 2020 2020 2020 7072 6564 6963 742c 0a20        predict,. 
+0000d6d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000d6e0: 7973 7465 6d2c 0a20 2020 2020 2020 2020  ystem,.         
+0000d6f0: 2020 2020 2020 2064 6973 706c 6179 2c0a         display,.
+0000d700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d710: 6d6f 6465 6c5f 6f6e 6c79 3d6d 6f64 656c  model_only=model
+0000d720: 5f6f 6e6c 792c 0a20 2020 2020 2020 2020  _only,.         
+0000d730: 2020 2020 2020 2072 6574 7572 6e5f 7472         return_tr
+0000d740: 6169 6e5f 7363 6f72 653d 7265 7475 726e  ain_score=return
+0000d750: 5f74 7261 696e 5f73 636f 7265 2c0a 2020  _train_score,.  
+0000d760: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0000d770: 2020 2020 2020 2020 2064 6973 706c 6179           display
+0000d780: 2e6d 6f76 655f 7072 6f67 7265 7373 2829  .move_progress()
+0000d790: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+0000d7a0: 6c66 2e6c 6f67 6765 722e 696e 666f 2873  lf.logger.info(s
+0000d7b0: 7472 286d 6f64 656c 2929 0a20 2020 2020  tr(model)).     
+0000d7c0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+0000d7d0: 6572 2e69 6e66 6f28 0a20 2020 2020 2020  er.info(.       
+0000d7e0: 2020 2020 2020 2020 2022 6372 6561 7465           "create
+0000d7f0: 5f6d 6f64 656c 2829 2073 7563 6365 7373  _model() success
+0000d800: 6675 6c6c 7920 636f 6d70 6c65 7465 642e  fully completed.
+0000d810: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
 0000d820: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000d830: 2e2e 2e2e 2e2e 2e2e 2e22 0a20 2020 2020  .........".     
-0000d840: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0000d850: 2020 2020 2020 6763 2e63 6f6c 6c65 6374        gc.collect
-0000d860: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
-0000d870: 6966 206e 6f74 2073 7973 7465 6d3a 0a20  if not system:. 
-0000d880: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000d890: 6574 7572 6e20 6d6f 6465 6c2c 206d 6f64  eturn model, mod
-0000d8a0: 656c 5f66 6974 5f74 696d 650a 2020 2020  el_fit_time.    
-0000d8b0: 2020 2020 2020 2020 7265 7475 726e 206d          return m
-0000d8c0: 6f64 656c 0a0a 2020 2020 2020 2020 6d6f  odel..        mo
-0000d8d0: 6465 6c2c 206d 6f64 656c 5f66 6974 5f74  del, model_fit_t
-0000d8e0: 696d 652c 206d 6f64 656c 5f72 6573 756c  ime, model_resul
-0000d8f0: 7473 2c20 5f20 3d20 7365 6c66 2e5f 6372  ts, _ = self._cr
-0000d900: 6561 7465 5f6d 6f64 656c 5f77 6974 685f  eate_model_with_
-0000d910: 6376 280a 2020 2020 2020 2020 2020 2020  cv(.            
-0000d920: 6d6f 6465 6c2c 0a20 2020 2020 2020 2020  model,.         
-0000d930: 2020 2064 6174 615f 582c 0a20 2020 2020     data_X,.     
-0000d940: 2020 2020 2020 2064 6174 615f 792c 0a20         data_y,. 
-0000d950: 2020 2020 2020 2020 2020 2066 6974 5f6b             fit_k
-0000d960: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
-0000d970: 2020 2072 6f75 6e64 2c0a 2020 2020 2020     round,.      
-0000d980: 2020 2020 2020 6376 2c0a 2020 2020 2020        cv,.      
-0000d990: 2020 2020 2020 6772 6f75 7073 2c0a 2020        groups,.  
-0000d9a0: 2020 2020 2020 2020 2020 6d65 7472 6963            metric
-0000d9b0: 732c 0a20 2020 2020 2020 2020 2020 2072  s,.            r
-0000d9c0: 6566 6974 2c0a 2020 2020 2020 2020 2020  efit,.          
-0000d9d0: 2020 7379 7374 656d 2c0a 2020 2020 2020    system,.      
-0000d9e0: 2020 2020 2020 6469 7370 6c61 792c 0a20        display,. 
-0000d9f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000da00: 6e5f 7472 6169 6e5f 7363 6f72 653d 7265  n_train_score=re
-0000da10: 7475 726e 5f74 7261 696e 5f73 636f 7265  turn_train_score
-0000da20: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-0000da30: 2020 2020 2023 2065 6e64 2072 756e 7469       # end runti
-0000da40: 6d65 0a20 2020 2020 2020 2072 756e 7469  me.        runti
-0000da50: 6d65 5f65 6e64 203d 2074 696d 652e 7469  me_end = time.ti
-0000da60: 6d65 2829 0a20 2020 2020 2020 2072 756e  me().        run
-0000da70: 7469 6d65 203d 206e 702e 6172 7261 7928  time = np.array(
-0000da80: 7275 6e74 696d 655f 656e 6420 2d20 7275  runtime_end - ru
-0000da90: 6e74 696d 655f 7374 6172 7429 2e72 6f75  ntime_start).rou
-0000daa0: 6e64 2832 290a 0a20 2020 2020 2020 2023  nd(2)..        #
-0000dab0: 2064 6173 6862 6f61 7264 206c 6f67 6769   dashboard loggi
-0000dac0: 6e67 0a20 2020 2020 2020 2069 6620 7365  ng.        if se
-0000dad0: 6c66 2e6c 6f67 6769 6e67 5f70 6172 616d  lf.logging_param
-0000dae0: 2061 6e64 2073 7973 7465 6d20 616e 6420   and system and 
-0000daf0: 7265 6669 743a 0a20 2020 2020 2020 2020  refit:.         
-0000db00: 2020 2069 6e64 6963 6573 203d 2073 656c     indices = sel
-0000db10: 662e 5f67 6574 5f72 6574 7572 6e5f 7472  f._get_return_tr
-0000db20: 6169 6e5f 7363 6f72 655f 696e 6469 6365  ain_score_indice
-0000db30: 735f 666f 725f 6c6f 6767 696e 6728 0a20  s_for_logging(. 
-0000db40: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000db50: 6574 7572 6e5f 7472 6169 6e5f 7363 6f72  eturn_train_scor
-0000db60: 650a 2020 2020 2020 2020 2020 2020 290a  e.            ).
-0000db70: 2020 2020 2020 2020 2020 2020 6176 6773              avgs
-0000db80: 5f64 6963 745f 6c6f 6720 3d20 7b6b 3a20  _dict_log = {k: 
-0000db90: 7620 666f 7220 6b2c 2076 2069 6e20 6d6f  v for k, v in mo
-0000dba0: 6465 6c5f 7265 7375 6c74 732e 6c6f 635b  del_results.loc[
-0000dbb0: 696e 6469 6365 735d 2e69 7465 6d73 2829  indices].items()
-0000dbc0: 7d0a 0a20 2020 2020 2020 2020 2020 2073  }..            s
-0000dbd0: 656c 662e 5f6c 6f67 5f6d 6f64 656c 280a  elf._log_model(.
-0000dbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dbf0: 6d6f 6465 6c3d 6d6f 6465 6c2c 0a20 2020  model=model,.   
-0000dc00: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-0000dc10: 656c 5f72 6573 756c 7473 3d6d 6f64 656c  el_results=model
-0000dc20: 5f72 6573 756c 7473 2c0a 2020 2020 2020  _results,.      
-0000dc30: 2020 2020 2020 2020 2020 7363 6f72 655f            score_
-0000dc40: 6469 6374 3d61 7667 735f 6469 6374 5f6c  dict=avgs_dict_l
-0000dc50: 6f67 2c0a 2020 2020 2020 2020 2020 2020  og,.            
-0000dc60: 2020 2020 736f 7572 6365 3d22 6372 6561      source="crea
-0000dc70: 7465 5f6d 6f64 656c 222c 0a20 2020 2020  te_model",.     
-0000dc80: 2020 2020 2020 2020 2020 2072 756e 7469             runti
-0000dc90: 6d65 3d72 756e 7469 6d65 2c0a 2020 2020  me=runtime,.    
-0000dca0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-0000dcb0: 6c5f 6669 745f 7469 6d65 3d6d 6f64 656c  l_fit_time=model
-0000dcc0: 5f66 6974 5f74 696d 652c 0a20 2020 2020  _fit_time,.     
-0000dcd0: 2020 2020 2020 2020 2020 2070 6970 656c             pipel
-0000dce0: 696e 653d 7365 6c66 2e70 6970 656c 696e  ine=self.pipelin
-0000dcf0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0000dd00: 2020 206c 6f67 5f70 6c6f 7473 3d73 656c     log_plots=sel
-0000dd10: 662e 6c6f 675f 706c 6f74 735f 7061 7261  f.log_plots_para
-0000dd20: 6d2c 0a20 2020 2020 2020 2020 2020 2020  m,.             
-0000dd30: 2020 2065 7870 6572 696d 656e 745f 6375     experiment_cu
-0000dd40: 7374 6f6d 5f74 6167 733d 6578 7065 7269  stom_tags=experi
-0000dd50: 6d65 6e74 5f63 7573 746f 6d5f 7461 6773  ment_custom_tags
-0000dd60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000dd70: 2020 6469 7370 6c61 793d 6469 7370 6c61    display=displa
-0000dd80: 792c 0a20 2020 2020 2020 2020 2020 2029  y,.            )
-0000dd90: 0a0a 2020 2020 2020 2020 6469 7370 6c61  ..        displa
-0000dda0: 792e 6d6f 7665 5f70 726f 6772 6573 7328  y.move_progress(
-0000ddb0: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-0000ddc0: 6c6f 6767 6572 2e69 6e66 6f28 2255 706c  logger.info("Upl
-0000ddd0: 6f61 6469 6e67 2072 6573 756c 7473 2069  oading results i
-0000dde0: 6e74 6f20 636f 6e74 6169 6e65 7222 290a  nto container").
-0000ddf0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-0000de00: 7365 6c66 2e5f 6d6c 5f75 7365 6361 7365  self._ml_usecase
-0000de10: 203d 3d20 4d4c 5573 6563 6173 652e 5449   == MLUsecase.TI
-0000de20: 4d45 5f53 4552 4945 533a 0a20 2020 2020  ME_SERIES:.     
-0000de30: 2020 2020 2020 206d 6f64 656c 5f72 6573         model_res
-0000de40: 756c 7473 2e64 726f 7028 2263 7574 6f66  ults.drop("cutof
-0000de50: 6622 2c20 6178 6973 3d31 2c20 696e 706c  f", axis=1, inpl
-0000de60: 6163 653d 5472 7565 2c20 6572 726f 7273  ace=True, errors
-0000de70: 3d22 6967 6e6f 7265 2229 0a0a 2020 2020  ="ignore")..    
-0000de80: 2020 2020 7365 6c66 2e5f 6469 7370 6c61      self._displa
-0000de90: 795f 636f 6e74 6169 6e65 722e 6170 7065  y_container.appe
-0000dea0: 6e64 286d 6f64 656c 5f72 6573 756c 7473  nd(model_results
-0000deb0: 290a 0a20 2020 2020 2020 2023 2073 746f  )..        # sto
-0000dec0: 7269 6e67 2072 6573 756c 7473 2069 6e20  ring results in 
-0000ded0: 5f6d 6173 7465 725f 6d6f 6465 6c5f 636f  _master_model_co
-0000dee0: 6e74 6169 6e65 720a 2020 2020 2020 2020  ntainer.        
-0000def0: 6966 2061 6464 5f74 6f5f 6d6f 6465 6c5f  if add_to_model_
-0000df00: 6c69 7374 3a0a 2020 2020 2020 2020 2020  list:.          
-0000df10: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
-0000df20: 666f 2822 5570 6c6f 6164 696e 6720 6d6f  fo("Uploading mo
-0000df30: 6465 6c20 696e 746f 2063 6f6e 7461 696e  del into contain
-0000df40: 6572 206e 6f77 2229 0a20 2020 2020 2020  er now").       
-0000df50: 2020 2020 2073 656c 662e 5f6d 6173 7465       self._maste
-0000df60: 725f 6d6f 6465 6c5f 636f 6e74 6169 6e65  r_model_containe
-0000df70: 722e 6170 7065 6e64 280a 2020 2020 2020  r.append(.      
-0000df80: 2020 2020 2020 2020 2020 7b22 6d6f 6465            {"mode
-0000df90: 6c22 3a20 6d6f 6465 6c2c 2022 7363 6f72  l": model, "scor
-0000dfa0: 6573 223a 206d 6f64 656c 5f72 6573 756c  es": model_resul
-0000dfb0: 7473 2c20 2263 7622 3a20 6376 7d0a 2020  ts, "cv": cv}.  
-0000dfc0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0000dfd0: 2020 2020 2023 2079 656c 6c6f 7720 7468       # yellow th
-0000dfe0: 6520 6d65 616e 0a20 2020 2020 2020 206d  e mean.        m
-0000dff0: 6f64 656c 5f72 6573 756c 7473 203d 2073  odel_results = s
-0000e000: 656c 662e 5f68 6967 686c 6967 6874 5f61  elf._highlight_a
-0000e010: 6e64 5f72 6f75 6e64 5f6d 6f64 656c 5f72  nd_round_model_r
-0000e020: 6573 756c 7473 280a 2020 2020 2020 2020  esults(.        
-0000e030: 2020 2020 6d6f 6465 6c5f 7265 7375 6c74      model_result
-0000e040: 732c 2072 6574 7572 6e5f 7472 6169 6e5f  s, return_train_
-0000e050: 7363 6f72 652c 2072 6f75 6e64 0a20 2020  score, round.   
-0000e060: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
-0000e070: 6620 7379 7374 656d 3a0a 2020 2020 2020  f system:.      
-0000e080: 2020 2020 2020 6469 7370 6c61 792e 6469        display.di
-0000e090: 7370 6c61 7928 6d6f 6465 6c5f 7265 7375  splay(model_resu
-0000e0a0: 6c74 7329 0a0a 2020 2020 2020 2020 7365  lts)..        se
-0000e0b0: 6c66 2e6c 6f67 6765 722e 696e 666f 280a  lf.logger.info(.
-0000e0c0: 2020 2020 2020 2020 2020 2020 6622 5f6d              f"_m
-0000e0d0: 6173 7465 725f 6d6f 6465 6c5f 636f 6e74  aster_model_cont
-0000e0e0: 6169 6e65 723a 207b 6c65 6e28 7365 6c66  ainer: {len(self
-0000e0f0: 2e5f 6d61 7374 6572 5f6d 6f64 656c 5f63  ._master_model_c
-0000e100: 6f6e 7461 696e 6572 297d 220a 2020 2020  ontainer)}".    
-0000e110: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-0000e120: 6c66 2e6c 6f67 6765 722e 696e 666f 2866  lf.logger.info(f
-0000e130: 225f 6469 7370 6c61 795f 636f 6e74 6169  "_display_contai
-0000e140: 6e65 723a 207b 6c65 6e28 7365 6c66 2e5f  ner: {len(self._
-0000e150: 6469 7370 6c61 795f 636f 6e74 6169 6e65  display_containe
-0000e160: 7229 7d22 290a 0a20 2020 2020 2020 2073  r)}")..        s
-0000e170: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
-0000e180: 7374 7228 6d6f 6465 6c29 290a 2020 2020  str(model)).    
-0000e190: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
-0000e1a0: 696e 666f 280a 2020 2020 2020 2020 2020  info(.          
-0000e1b0: 2020 2263 7265 6174 655f 6d6f 6465 6c28    "create_model(
-0000e1c0: 2920 7375 6363 6573 7366 756c 6c79 2063  ) successfully c
-0000e1d0: 6f6d 706c 6574 6564 2e2e 2e2e 2e2e 2e2e  ompleted........
+0000d830: 2e2e 2e2e 2e22 0a20 2020 2020 2020 2020  .....".         
+0000d840: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
+0000d850: 2020 6763 2e63 6f6c 6c65 6374 2829 0a0a    gc.collect()..
+0000d860: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0000d870: 6f74 2073 7973 7465 6d3a 0a20 2020 2020  ot system:.     
+0000d880: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000d890: 6e20 6d6f 6465 6c2c 206d 6f64 656c 5f66  n model, model_f
+0000d8a0: 6974 5f74 696d 650a 2020 2020 2020 2020  it_time.        
+0000d8b0: 2020 2020 7265 7475 726e 206d 6f64 656c      return model
+0000d8c0: 0a0a 2020 2020 2020 2020 6d6f 6465 6c2c  ..        model,
+0000d8d0: 206d 6f64 656c 5f66 6974 5f74 696d 652c   model_fit_time,
+0000d8e0: 206d 6f64 656c 5f72 6573 756c 7473 2c20   model_results, 
+0000d8f0: 5f20 3d20 7365 6c66 2e5f 6372 6561 7465  _ = self._create
+0000d900: 5f6d 6f64 656c 5f77 6974 685f 6376 280a  _model_with_cv(.
+0000d910: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+0000d920: 6c2c 0a20 2020 2020 2020 2020 2020 2064  l,.            d
+0000d930: 6174 615f 582c 0a20 2020 2020 2020 2020  ata_X,.         
+0000d940: 2020 2064 6174 615f 792c 0a20 2020 2020     data_y,.     
+0000d950: 2020 2020 2020 2066 6974 5f6b 7761 7267         fit_kwarg
+0000d960: 732c 0a20 2020 2020 2020 2020 2020 2072  s,.            r
+0000d970: 6f75 6e64 2c0a 2020 2020 2020 2020 2020  ound,.          
+0000d980: 2020 6376 2c0a 2020 2020 2020 2020 2020    cv,.          
+0000d990: 2020 6772 6f75 7073 2c0a 2020 2020 2020    groups,.      
+0000d9a0: 2020 2020 2020 6d65 7472 6963 732c 0a20        metrics,. 
+0000d9b0: 2020 2020 2020 2020 2020 2072 6566 6974             refit
+0000d9c0: 2c0a 2020 2020 2020 2020 2020 2020 7379  ,.            sy
+0000d9d0: 7374 656d 2c0a 2020 2020 2020 2020 2020  stem,.          
+0000d9e0: 2020 6469 7370 6c61 792c 0a20 2020 2020    display,.     
+0000d9f0: 2020 2020 2020 2072 6574 7572 6e5f 7472         return_tr
+0000da00: 6169 6e5f 7363 6f72 653d 7265 7475 726e  ain_score=return
+0000da10: 5f74 7261 696e 5f73 636f 7265 2c0a 2020  _train_score,.  
+0000da20: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0000da30: 2023 2065 6e64 2072 756e 7469 6d65 0a20   # end runtime. 
+0000da40: 2020 2020 2020 2072 756e 7469 6d65 5f65         runtime_e
+0000da50: 6e64 203d 2074 696d 652e 7469 6d65 2829  nd = time.time()
+0000da60: 0a20 2020 2020 2020 2072 756e 7469 6d65  .        runtime
+0000da70: 203d 206e 702e 6172 7261 7928 7275 6e74   = np.array(runt
+0000da80: 696d 655f 656e 6420 2d20 7275 6e74 696d  ime_end - runtim
+0000da90: 655f 7374 6172 7429 2e72 6f75 6e64 2832  e_start).round(2
+0000daa0: 290a 0a20 2020 2020 2020 2023 2064 6173  )..        # das
+0000dab0: 6862 6f61 7264 206c 6f67 6769 6e67 0a20  hboard logging. 
+0000dac0: 2020 2020 2020 2069 6620 7365 6c66 2e6c         if self.l
+0000dad0: 6f67 6769 6e67 5f70 6172 616d 2061 6e64  ogging_param and
+0000dae0: 2073 7973 7465 6d20 616e 6420 7265 6669   system and refi
+0000daf0: 743a 0a20 2020 2020 2020 2020 2020 2069  t:.            i
+0000db00: 6e64 6963 6573 203d 2073 656c 662e 5f67  ndices = self._g
+0000db10: 6574 5f72 6574 7572 6e5f 7472 6169 6e5f  et_return_train_
+0000db20: 7363 6f72 655f 696e 6469 6365 735f 666f  score_indices_fo
+0000db30: 725f 6c6f 6767 696e 6728 0a20 2020 2020  r_logging(.     
+0000db40: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000db50: 6e5f 7472 6169 6e5f 7363 6f72 650a 2020  n_train_score.  
+0000db60: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000db70: 2020 2020 2020 2020 6176 6773 5f64 6963          avgs_dic
+0000db80: 745f 6c6f 6720 3d20 7b6b 3a20 7620 666f  t_log = {k: v fo
+0000db90: 7220 6b2c 2076 2069 6e20 6d6f 6465 6c5f  r k, v in model_
+0000dba0: 7265 7375 6c74 732e 6c6f 635b 696e 6469  results.loc[indi
+0000dbb0: 6365 735d 2e69 7465 6d73 2829 7d0a 0a20  ces].items()}.. 
+0000dbc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000dbd0: 5f6c 6f67 5f6d 6f64 656c 280a 2020 2020  _log_model(.    
+0000dbe0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+0000dbf0: 6c3d 6d6f 6465 6c2c 0a20 2020 2020 2020  l=model,.       
+0000dc00: 2020 2020 2020 2020 206d 6f64 656c 5f72           model_r
+0000dc10: 6573 756c 7473 3d6d 6f64 656c 5f72 6573  esults=model_res
+0000dc20: 756c 7473 2c0a 2020 2020 2020 2020 2020  ults,.          
+0000dc30: 2020 2020 2020 7363 6f72 655f 6469 6374        score_dict
+0000dc40: 3d61 7667 735f 6469 6374 5f6c 6f67 2c0a  =avgs_dict_log,.
+0000dc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dc60: 736f 7572 6365 3d22 6372 6561 7465 5f6d  source="create_m
+0000dc70: 6f64 656c 222c 0a20 2020 2020 2020 2020  odel",.         
+0000dc80: 2020 2020 2020 2072 756e 7469 6d65 3d72         runtime=r
+0000dc90: 756e 7469 6d65 2c0a 2020 2020 2020 2020  untime,.        
+0000dca0: 2020 2020 2020 2020 6d6f 6465 6c5f 6669          model_fi
+0000dcb0: 745f 7469 6d65 3d6d 6f64 656c 5f66 6974  t_time=model_fit
+0000dcc0: 5f74 696d 652c 0a20 2020 2020 2020 2020  _time,.         
+0000dcd0: 2020 2020 2020 2070 6970 656c 696e 653d         pipeline=
+0000dce0: 7365 6c66 2e70 6970 656c 696e 652c 0a20  self.pipeline,. 
+0000dcf0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0000dd00: 6f67 5f70 6c6f 7473 3d73 656c 662e 6c6f  og_plots=self.lo
+0000dd10: 675f 706c 6f74 735f 7061 7261 6d2c 0a20  g_plots_param,. 
+0000dd20: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0000dd30: 7870 6572 696d 656e 745f 6375 7374 6f6d  xperiment_custom
+0000dd40: 5f74 6167 733d 6578 7065 7269 6d65 6e74  _tags=experiment
+0000dd50: 5f63 7573 746f 6d5f 7461 6773 2c0a 2020  _custom_tags,.  
+0000dd60: 2020 2020 2020 2020 2020 2020 2020 6469                di
+0000dd70: 7370 6c61 793d 6469 7370 6c61 792c 0a20  splay=display,. 
+0000dd80: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0000dd90: 2020 2020 2020 6469 7370 6c61 792e 6d6f        display.mo
+0000dda0: 7665 5f70 726f 6772 6573 7328 290a 0a20  ve_progress().. 
+0000ddb0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+0000ddc0: 6572 2e69 6e66 6f28 2255 706c 6f61 6469  er.info("Uploadi
+0000ddd0: 6e67 2072 6573 756c 7473 2069 6e74 6f20  ng results into 
+0000dde0: 636f 6e74 6169 6e65 7222 290a 0a20 2020  container")..   
+0000ddf0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+0000de00: 2e5f 6d6c 5f75 7365 6361 7365 203d 3d20  ._ml_usecase == 
+0000de10: 4d4c 5573 6563 6173 652e 5449 4d45 5f53  MLUsecase.TIME_S
+0000de20: 4552 4945 533a 0a20 2020 2020 2020 2020  ERIES:.         
+0000de30: 2020 206d 6f64 656c 5f72 6573 756c 7473     model_results
+0000de40: 2e64 726f 7028 2263 7574 6f66 6622 2c20  .drop("cutoff", 
+0000de50: 6178 6973 3d31 2c20 696e 706c 6163 653d  axis=1, inplace=
+0000de60: 5472 7565 2c20 6572 726f 7273 3d22 6967  True, errors="ig
+0000de70: 6e6f 7265 2229 0a0a 2020 2020 2020 2020  nore")..        
+0000de80: 7365 6c66 2e5f 6469 7370 6c61 795f 636f  self._display_co
+0000de90: 6e74 6169 6e65 722e 6170 7065 6e64 286d  ntainer.append(m
+0000dea0: 6f64 656c 5f72 6573 756c 7473 290a 0a20  odel_results).. 
+0000deb0: 2020 2020 2020 2023 2073 746f 7269 6e67         # storing
+0000dec0: 2072 6573 756c 7473 2069 6e20 5f6d 6173   results in _mas
+0000ded0: 7465 725f 6d6f 6465 6c5f 636f 6e74 6169  ter_model_contai
+0000dee0: 6e65 720a 2020 2020 2020 2020 6966 2061  ner.        if a
+0000def0: 6464 5f74 6f5f 6d6f 6465 6c5f 6c69 7374  dd_to_model_list
+0000df00: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0000df10: 6c66 2e6c 6f67 6765 722e 696e 666f 2822  lf.logger.info("
+0000df20: 5570 6c6f 6164 696e 6720 6d6f 6465 6c20  Uploading model 
+0000df30: 696e 746f 2063 6f6e 7461 696e 6572 206e  into container n
+0000df40: 6f77 2229 0a20 2020 2020 2020 2020 2020  ow").           
+0000df50: 2073 656c 662e 5f6d 6173 7465 725f 6d6f   self._master_mo
+0000df60: 6465 6c5f 636f 6e74 6169 6e65 722e 6170  del_container.ap
+0000df70: 7065 6e64 280a 2020 2020 2020 2020 2020  pend(.          
+0000df80: 2020 2020 2020 7b22 6d6f 6465 6c22 3a20        {"model": 
+0000df90: 6d6f 6465 6c2c 2022 7363 6f72 6573 223a  model, "scores":
+0000dfa0: 206d 6f64 656c 5f72 6573 756c 7473 2c20   model_results, 
+0000dfb0: 2263 7622 3a20 6376 7d0a 2020 2020 2020  "cv": cv}.      
+0000dfc0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0000dfd0: 2023 2079 656c 6c6f 7720 7468 6520 6d65   # yellow the me
+0000dfe0: 616e 0a20 2020 2020 2020 206d 6f64 656c  an.        model
+0000dff0: 5f72 6573 756c 7473 203d 2073 656c 662e  _results = self.
+0000e000: 5f68 6967 686c 6967 6874 5f61 6e64 5f72  _highlight_and_r
+0000e010: 6f75 6e64 5f6d 6f64 656c 5f72 6573 756c  ound_model_resul
+0000e020: 7473 280a 2020 2020 2020 2020 2020 2020  ts(.            
+0000e030: 6d6f 6465 6c5f 7265 7375 6c74 732c 2072  model_results, r
+0000e040: 6574 7572 6e5f 7472 6169 6e5f 7363 6f72  eturn_train_scor
+0000e050: 652c 2072 6f75 6e64 0a20 2020 2020 2020  e, round.       
+0000e060: 2029 0a20 2020 2020 2020 2069 6620 7379   ).        if sy
+0000e070: 7374 656d 3a0a 2020 2020 2020 2020 2020  stem:.          
+0000e080: 2020 6469 7370 6c61 792e 6469 7370 6c61    display.displa
+0000e090: 7928 6d6f 6465 6c5f 7265 7375 6c74 7329  y(model_results)
+0000e0a0: 0a0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+0000e0b0: 6f67 6765 722e 696e 666f 280a 2020 2020  ogger.info(.    
+0000e0c0: 2020 2020 2020 2020 6622 5f6d 6173 7465          f"_maste
+0000e0d0: 725f 6d6f 6465 6c5f 636f 6e74 6169 6e65  r_model_containe
+0000e0e0: 723a 207b 6c65 6e28 7365 6c66 2e5f 6d61  r: {len(self._ma
+0000e0f0: 7374 6572 5f6d 6f64 656c 5f63 6f6e 7461  ster_model_conta
+0000e100: 696e 6572 297d 220a 2020 2020 2020 2020  iner)}".        
+0000e110: 290a 2020 2020 2020 2020 7365 6c66 2e6c  ).        self.l
+0000e120: 6f67 6765 722e 696e 666f 2866 225f 6469  ogger.info(f"_di
+0000e130: 7370 6c61 795f 636f 6e74 6169 6e65 723a  splay_container:
+0000e140: 207b 6c65 6e28 7365 6c66 2e5f 6469 7370   {len(self._disp
+0000e150: 6c61 795f 636f 6e74 6169 6e65 7229 7d22  lay_container)}"
+0000e160: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+0000e170: 6c6f 6767 6572 2e69 6e66 6f28 7374 7228  logger.info(str(
+0000e180: 6d6f 6465 6c29 290a 2020 2020 2020 2020  model)).        
+0000e190: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
+0000e1a0: 280a 2020 2020 2020 2020 2020 2020 2263  (.            "c
+0000e1b0: 7265 6174 655f 6d6f 6465 6c28 2920 7375  reate_model() su
+0000e1c0: 6363 6573 7366 756c 6c79 2063 6f6d 706c  ccessfully compl
+0000e1d0: 6574 6564 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  eted............
 0000e1e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000e1f0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 220a  ..............".
-0000e200: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000e210: 2020 6763 2e63 6f6c 6c65 6374 2829 0a0a    gc.collect()..
-0000e220: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-0000e230: 7973 7465 6d3a 0a20 2020 2020 2020 2020  ystem:.         
-0000e240: 2020 2072 6574 7572 6e20 6d6f 6465 6c2c     return model,
-0000e250: 206d 6f64 656c 5f66 6974 5f74 696d 650a   model_fit_time.
-0000e260: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000e270: 6d6f 6465 6c0a 0a20 2020 2064 6566 2063  model..    def c
-0000e280: 7265 6174 655f 6d6f 6465 6c28 0a20 2020  reate_model(.   
-0000e290: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0000e2a0: 2020 2065 7374 696d 6174 6f72 2c0a 2020     estimator,.  
-0000e2b0: 2020 2020 2020 666f 6c64 3a20 4f70 7469        fold: Opti
-0000e2c0: 6f6e 616c 5b55 6e69 6f6e 5b69 6e74 2c20  onal[Union[int, 
-0000e2d0: 416e 795d 5d20 3d20 4e6f 6e65 2c0a 2020  Any]] = None,.  
-0000e2e0: 2020 2020 2020 726f 756e 643a 2069 6e74        round: int
-0000e2f0: 203d 2034 2c0a 2020 2020 2020 2020 6372   = 4,.        cr
-0000e300: 6f73 735f 7661 6c69 6461 7469 6f6e 3a20  oss_validation: 
-0000e310: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
-0000e320: 2020 2020 2070 7265 6469 6374 3a20 626f       predict: bo
-0000e330: 6f6c 203d 2054 7275 652c 0a20 2020 2020  ol = True,.     
-0000e340: 2020 2066 6974 5f6b 7761 7267 733a 204f     fit_kwargs: O
-0000e350: 7074 696f 6e61 6c5b 6469 6374 5d20 3d20  ptional[dict] = 
-0000e360: 4e6f 6e65 2c0a 2020 2020 2020 2020 6772  None,.        gr
-0000e370: 6f75 7073 3a20 4f70 7469 6f6e 616c 5b55  oups: Optional[U
-0000e380: 6e69 6f6e 5b73 7472 2c20 416e 795d 5d20  nion[str, Any]] 
-0000e390: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0000e3a0: 7265 6669 743a 2062 6f6f 6c20 3d20 5472  refit: bool = Tr
-0000e3b0: 7565 2c0a 2020 2020 2020 2020 7072 6f62  ue,.        prob
-0000e3c0: 6162 696c 6974 795f 7468 7265 7368 6f6c  ability_threshol
-0000e3d0: 643a 204f 7074 696f 6e61 6c5b 666c 6f61  d: Optional[floa
-0000e3e0: 745d 203d 204e 6f6e 652c 0a20 2020 2020  t] = None,.     
-0000e3f0: 2020 2065 7870 6572 696d 656e 745f 6375     experiment_cu
-0000e400: 7374 6f6d 5f74 6167 733a 204f 7074 696f  stom_tags: Optio
-0000e410: 6e61 6c5b 4469 6374 5b73 7472 2c20 416e  nal[Dict[str, An
-0000e420: 795d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  y]] = None,.    
-0000e430: 2020 2020 7665 7262 6f73 653a 2062 6f6f      verbose: boo
-0000e440: 6c20 3d20 5472 7565 2c0a 2020 2020 2020  l = True,.      
-0000e450: 2020 7265 7475 726e 5f74 7261 696e 5f73    return_train_s
-0000e460: 636f 7265 3a20 626f 6f6c 203d 2046 616c  core: bool = Fal
-0000e470: 7365 2c0a 2020 2020 2020 2020 2a2a 6b77  se,.        **kw
-0000e480: 6172 6773 2c0a 2020 2020 2920 2d3e 2041  args,.    ) -> A
-0000e490: 6e79 3a0a 0a20 2020 2020 2020 2022 2222  ny:..        """
-0000e4a0: 0a20 2020 2020 2020 2054 6869 7320 6675  .        This fu
-0000e4b0: 6e63 7469 6f6e 2063 7265 6174 6573 2061  nction creates a
-0000e4c0: 206d 6f64 656c 2061 6e64 2073 636f 7265   model and score
-0000e4d0: 7320 6974 2075 7369 6e67 2043 726f 7373  s it using Cross
-0000e4e0: 2056 616c 6964 6174 696f 6e2e 0a20 2020   Validation..   
-0000e4f0: 2020 2020 2054 6865 206f 7574 7075 7420       The output 
-0000e500: 7072 696e 7473 2061 2073 636f 7265 2067  prints a score g
-0000e510: 7269 6420 7468 6174 2073 686f 7773 2041  rid that shows A
-0000e520: 6363 7572 6163 792c 2041 5543 2c20 5265  ccuracy, AUC, Re
-0000e530: 6361 6c6c 2c20 5072 6563 6973 696f 6e2c  call, Precision,
-0000e540: 0a20 2020 2020 2020 2046 312c 204b 6170  .        F1, Kap
-0000e550: 7061 2061 6e64 204d 4343 2062 7920 666f  pa and MCC by fo
-0000e560: 6c64 2028 6465 6661 756c 7420 3d20 3130  ld (default = 10
-0000e570: 2046 6f6c 6429 2e0a 0a20 2020 2020 2020   Fold)...       
-0000e580: 2054 6869 7320 6675 6e63 7469 6f6e 2072   This function r
-0000e590: 6574 7572 6e73 2061 2074 7261 696e 6564  eturns a trained
-0000e5a0: 206d 6f64 656c 206f 626a 6563 742e 0a0a   model object...
-0000e5b0: 2020 2020 2020 2020 7365 7475 7028 2920          setup() 
-0000e5c0: 6675 6e63 7469 6f6e 206d 7573 7420 6265  function must be
-0000e5d0: 2063 616c 6c65 6420 6265 666f 7265 2075   called before u
-0000e5e0: 7369 6e67 2063 7265 6174 655f 6d6f 6465  sing create_mode
-0000e5f0: 6c28 290a 0a20 2020 2020 2020 2045 7861  l()..        Exa
-0000e600: 6d70 6c65 0a20 2020 2020 2020 202d 2d2d  mple.        ---
-0000e610: 2d2d 2d2d 0a20 2020 2020 2020 203e 3e3e  ----.        >>>
-0000e620: 2066 726f 6d20 7079 6361 7265 742e 6461   from pycaret.da
-0000e630: 7461 7365 7473 2069 6d70 6f72 7420 6765  tasets import ge
-0000e640: 745f 6461 7461 0a20 2020 2020 2020 203e  t_data.        >
-0000e650: 3e3e 206a 7569 6365 203d 2067 6574 5f64  >> juice = get_d
-0000e660: 6174 6128 276a 7569 6365 2729 0a20 2020  ata('juice').   
-0000e670: 2020 2020 203e 3e3e 2065 7870 6572 696d       >>> experim
-0000e680: 656e 745f 6e61 6d65 203d 2073 6574 7570  ent_name = setup
-0000e690: 2864 6174 6120 3d20 6a75 6963 652c 2020  (data = juice,  
-0000e6a0: 7461 7267 6574 203d 2027 5075 7263 6861  target = 'Purcha
-0000e6b0: 7365 2729 0a20 2020 2020 2020 203e 3e3e  se').        >>>
-0000e6c0: 206c 7220 3d20 6372 6561 7465 5f6d 6f64   lr = create_mod
-0000e6d0: 656c 2827 6c72 2729 0a0a 2020 2020 2020  el('lr')..      
-0000e6e0: 2020 5468 6973 2077 696c 6c20 6372 6561    This will crea
-0000e6f0: 7465 2061 2074 7261 696e 6564 204c 6f67  te a trained Log
-0000e700: 6973 7469 6320 5265 6772 6573 7369 6f6e  istic Regression
-0000e710: 206d 6f64 656c 2e0a 0a20 2020 2020 2020   model...       
-0000e720: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-0000e730: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-0000e740: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
-0000e750: 203a 2073 7472 202f 206f 626a 6563 742c   : str / object,
-0000e760: 2064 6566 6175 6c74 203d 204e 6f6e 650a   default = None.
-0000e770: 2020 2020 2020 2020 2020 2020 456e 7465              Ente
-0000e780: 7220 4944 206f 6620 7468 6520 6573 7469  r ID of the esti
-0000e790: 6d61 746f 7273 2061 7661 696c 6162 6c65  mators available
-0000e7a0: 2069 6e20 6d6f 6465 6c20 6c69 6272 6172   in model librar
-0000e7b0: 7920 6f72 2070 6173 7320 616e 2075 6e74  y or pass an unt
-0000e7c0: 7261 696e 6564 206d 6f64 656c 0a20 2020  rained model.   
-0000e7d0: 2020 2020 2020 2020 206f 626a 6563 7420           object 
-0000e7e0: 636f 6e73 6973 7465 6e74 2077 6974 6820  consistent with 
-0000e7f0: 6669 7420 2f20 7072 6564 6963 7420 4150  fit / predict AP
-0000e800: 4920 746f 2074 7261 696e 2061 6e64 2065  I to train and e
-0000e810: 7661 6c75 6174 6520 6d6f 6465 6c2e 2041  valuate model. A
-0000e820: 6c6c 0a20 2020 2020 2020 2020 2020 2065  ll.            e
-0000e830: 7374 696d 6174 6f72 7320 7375 7070 6f72  stimators suppor
-0000e840: 7420 6269 6e61 7279 206f 7220 6d75 6c74  t binary or mult
-0000e850: 6963 6c61 7373 2070 726f 626c 656d 2e20  iclass problem. 
-0000e860: 4c69 7374 206f 6620 6573 7469 6d61 746f  List of estimato
-0000e870: 7273 2069 6e20 6d6f 6465 6c0a 2020 2020  rs in model.    
-0000e880: 2020 2020 2020 2020 6c69 6272 6172 7920          library 
-0000e890: 2849 4420 2d20 4e61 6d65 293a 0a0a 2020  (ID - Name):..  
-0000e8a0: 2020 2020 2020 2020 2020 2a20 276c 7227            * 'lr'
-0000e8b0: 202d 204c 6f67 6973 7469 6320 5265 6772   - Logistic Regr
-0000e8c0: 6573 7369 6f6e 0a20 2020 2020 2020 2020  ession.         
-0000e8d0: 2020 202a 2027 6b6e 6e27 202d 204b 204e     * 'knn' - K N
-0000e8e0: 6561 7265 7374 204e 6569 6768 626f 7572  earest Neighbour
-0000e8f0: 0a20 2020 2020 2020 2020 2020 202a 2027  .            * '
-0000e900: 6e62 2720 2d20 4e61 6976 6520 4261 7965  nb' - Naive Baye
-0000e910: 730a 2020 2020 2020 2020 2020 2020 2a20  s.            * 
-0000e920: 2764 7427 202d 2044 6563 6973 696f 6e20  'dt' - Decision 
-0000e930: 5472 6565 2043 6c61 7373 6966 6965 720a  Tree Classifier.
-0000e940: 2020 2020 2020 2020 2020 2020 2a20 2773              * 's
-0000e950: 766d 2720 2d20 5356 4d20 2d20 4c69 6e65  vm' - SVM - Line
-0000e960: 6172 204b 6572 6e65 6c0a 2020 2020 2020  ar Kernel.      
-0000e970: 2020 2020 2020 2a20 2772 6266 7376 6d27        * 'rbfsvm'
-0000e980: 202d 2053 564d 202d 2052 6164 6961 6c20   - SVM - Radial 
-0000e990: 4b65 726e 656c 0a20 2020 2020 2020 2020  Kernel.         
-0000e9a0: 2020 202a 2027 6770 6327 202d 2047 6175     * 'gpc' - Gau
-0000e9b0: 7373 6961 6e20 5072 6f63 6573 7320 436c  ssian Process Cl
-0000e9c0: 6173 7369 6669 6572 0a20 2020 2020 2020  assifier.       
-0000e9d0: 2020 2020 202a 2027 6d6c 7027 202d 204d       * 'mlp' - M
-0000e9e0: 756c 7469 204c 6576 656c 2050 6572 6365  ulti Level Perce
-0000e9f0: 7074 726f 6e0a 2020 2020 2020 2020 2020  ptron.          
-0000ea00: 2020 2a20 2772 6964 6765 2720 2d20 5269    * 'ridge' - Ri
-0000ea10: 6467 6520 436c 6173 7369 6669 6572 0a20  dge Classifier. 
-0000ea20: 2020 2020 2020 2020 2020 202a 2027 7266             * 'rf
-0000ea30: 2720 2d20 5261 6e64 6f6d 2046 6f72 6573  ' - Random Fores
-0000ea40: 7420 436c 6173 7369 6669 6572 0a20 2020  t Classifier.   
-0000ea50: 2020 2020 2020 2020 202a 2027 7164 6127           * 'qda'
-0000ea60: 202d 2051 7561 6472 6174 6963 2044 6973   - Quadratic Dis
-0000ea70: 6372 696d 696e 616e 7420 416e 616c 7973  criminant Analys
-0000ea80: 6973 0a20 2020 2020 2020 2020 2020 202a  is.            *
-0000ea90: 2027 6164 6127 202d 2041 6461 2042 6f6f   'ada' - Ada Boo
-0000eaa0: 7374 2043 6c61 7373 6966 6965 720a 2020  st Classifier.  
-0000eab0: 2020 2020 2020 2020 2020 2a20 2767 6263            * 'gbc
-0000eac0: 2720 2d20 4772 6164 6965 6e74 2042 6f6f  ' - Gradient Boo
-0000ead0: 7374 696e 6720 436c 6173 7369 6669 6572  sting Classifier
-0000eae0: 0a20 2020 2020 2020 2020 2020 202a 2027  .            * '
-0000eaf0: 6c64 6127 202d 204c 696e 6561 7220 4469  lda' - Linear Di
-0000eb00: 7363 7269 6d69 6e61 6e74 2041 6e61 6c79  scriminant Analy
-0000eb10: 7369 730a 2020 2020 2020 2020 2020 2020  sis.            
-0000eb20: 2a20 2765 7427 202d 2045 7874 7261 2054  * 'et' - Extra T
-0000eb30: 7265 6573 2043 6c61 7373 6966 6965 720a  rees Classifier.
-0000eb40: 2020 2020 2020 2020 2020 2020 2a20 2778              * 'x
-0000eb50: 6762 6f6f 7374 2720 2d20 4578 7472 656d  gboost' - Extrem
-0000eb60: 6520 4772 6164 6965 6e74 2042 6f6f 7374  e Gradient Boost
-0000eb70: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
-0000eb80: 2a20 276c 6967 6874 6762 6d27 202d 204c  * 'lightgbm' - L
-0000eb90: 6967 6874 2047 7261 6469 656e 7420 426f  ight Gradient Bo
-0000eba0: 6f73 7469 6e67 0a20 2020 2020 2020 2020  osting.         
-0000ebb0: 2020 202a 2027 6361 7462 6f6f 7374 2720     * 'catboost' 
-0000ebc0: 2d20 4361 7442 6f6f 7374 2043 6c61 7373  - CatBoost Class
-0000ebd0: 6966 6965 720a 0a20 2020 2020 2020 2066  ifier..        f
-0000ebe0: 6f6c 643a 2069 6e74 6567 6572 206f 7220  old: integer or 
-0000ebf0: 7363 696b 6974 2d6c 6561 726e 2063 6f6d  scikit-learn com
-0000ec00: 7061 7469 626c 6520 4356 2067 656e 6572  patible CV gener
-0000ec10: 6174 6f72 2c20 6465 6661 756c 7420 3d20  ator, default = 
-0000ec20: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-0000ec30: 2043 6f6e 7472 6f6c 7320 6372 6f73 732d   Controls cross-
-0000ec40: 7661 6c69 6461 7469 6f6e 2e20 4966 204e  validation. If N
-0000ec50: 6f6e 652c 2077 696c 6c20 7573 6520 7468  one, will use th
-0000ec60: 6520 4356 2067 656e 6572 6174 6f72 2064  e CV generator d
-0000ec70: 6566 696e 6564 2069 6e20 7365 7475 7028  efined in setup(
-0000ec80: 292e 0a20 2020 2020 2020 2020 2020 2049  )..            I
-0000ec90: 6620 696e 7465 6765 722c 2077 696c 6c20  f integer, will 
-0000eca0: 7573 6520 4b46 6f6c 6420 4356 2077 6974  use KFold CV wit
-0000ecb0: 6820 7468 6174 206d 616e 7920 666f 6c64  h that many fold
-0000ecc0: 732e 0a20 2020 2020 2020 2020 2020 2057  s..            W
-0000ecd0: 6865 6e20 6372 6f73 735f 7661 6c69 6461  hen cross_valida
-0000ece0: 7469 6f6e 2069 7320 4661 6c73 652c 2074  tion is False, t
-0000ecf0: 6869 7320 7061 7261 6d65 7465 7220 6973  his parameter is
-0000ed00: 2069 676e 6f72 6564 2e0a 0a20 2020 2020   ignored...     
-0000ed10: 2020 2072 6f75 6e64 3a20 696e 7465 6765     round: intege
-0000ed20: 722c 2064 6566 6175 6c74 203d 2034 0a20  r, default = 4. 
-0000ed30: 2020 2020 2020 2020 2020 204e 756d 6265             Numbe
-0000ed40: 7220 6f66 2064 6563 696d 616c 2070 6c61  r of decimal pla
-0000ed50: 6365 7320 7468 6520 6d65 7472 6963 7320  ces the metrics 
-0000ed60: 696e 2074 6865 2073 636f 7265 2067 7269  in the score gri
-0000ed70: 6420 7769 6c6c 2062 6520 726f 756e 6465  d will be rounde
-0000ed80: 6420 746f 2e0a 0a20 2020 2020 2020 2063  d to...        c
-0000ed90: 726f 7373 5f76 616c 6964 6174 696f 6e3a  ross_validation:
-0000eda0: 2062 6f6f 6c2c 2064 6566 6175 6c74 203d   bool, default =
-0000edb0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
-0000edc0: 2020 5768 656e 2063 726f 7373 5f76 616c    When cross_val
-0000edd0: 6964 6174 696f 6e20 7365 7420 746f 2046  idation set to F
-0000ede0: 616c 7365 2066 6f6c 6420 7061 7261 6d65  alse fold parame
-0000edf0: 7465 7220 6973 2069 676e 6f72 6564 2061  ter is ignored a
-0000ee00: 6e64 206d 6f64 656c 2069 7320 7472 6169  nd model is trai
-0000ee10: 6e65 640a 2020 2020 2020 2020 2020 2020  ned.            
-0000ee20: 6f6e 2065 6e74 6972 6520 7472 6169 6e69  on entire traini
-0000ee30: 6e67 2064 6174 6173 6574 2e0a 0a20 2020  ng dataset...   
-0000ee40: 2020 2020 2070 7265 6469 6374 3a20 626f       predict: bo
-0000ee50: 6f6c 2c20 6465 6661 756c 7420 3d20 5472  ol, default = Tr
-0000ee60: 7565 0a20 2020 2020 2020 2020 2020 2057  ue.            W
-0000ee70: 6865 7468 6572 2074 6f20 7072 6564 6963  hether to predic
-0000ee80: 7420 6d6f 6465 6c20 6f6e 2068 6f6c 646f  t model on holdo
-0000ee90: 7574 2069 6620 6372 6f73 735f 7661 6c69  ut if cross_vali
-0000eea0: 6461 7469 6f6e 203d 3d20 4661 6c73 652e  dation == False.
-0000eeb0: 0a0a 2020 2020 2020 2020 6669 745f 6b77  ..        fit_kw
-0000eec0: 6172 6773 3a20 6469 6374 2c20 6465 6661  args: dict, defa
-0000eed0: 756c 7420 3d20 7b7d 2028 656d 7074 7920  ult = {} (empty 
-0000eee0: 6469 6374 290a 2020 2020 2020 2020 2020  dict).          
-0000eef0: 2020 4469 6374 696f 6e61 7279 206f 6620    Dictionary of 
-0000ef00: 6172 6775 6d65 6e74 7320 7061 7373 6564  arguments passed
-0000ef10: 2074 6f20 7468 6520 6669 7420 6d65 7468   to the fit meth
-0000ef20: 6f64 206f 6620 7468 6520 6d6f 6465 6c2e  od of the model.
-0000ef30: 0a0a 2020 2020 2020 2020 6772 6f75 7073  ..        groups
-0000ef40: 3a20 7374 7220 6f72 2061 7272 6179 2d6c  : str or array-l
-0000ef50: 696b 652c 2077 6974 6820 7368 6170 6520  ike, with shape 
-0000ef60: 286e 5f73 616d 706c 6573 2c29 2c20 6465  (n_samples,), de
-0000ef70: 6661 756c 7420 3d20 4e6f 6e65 0a20 2020  fault = None.   
-0000ef80: 2020 2020 2020 2020 204f 7074 696f 6e61           Optiona
-0000ef90: 6c20 4772 6f75 7020 6c61 6265 6c73 2066  l Group labels f
-0000efa0: 6f72 2074 6865 2073 616d 706c 6573 2075  or the samples u
-0000efb0: 7365 6420 7768 696c 6520 7370 6c69 7474  sed while splitt
-0000efc0: 696e 6720 7468 6520 6461 7461 7365 7420  ing the dataset 
-0000efd0: 696e 746f 2074 7261 696e 2f74 6573 7420  into train/test 
-0000efe0: 7365 742e 0a20 2020 2020 2020 2020 2020  set..           
-0000eff0: 2049 6620 7374 7269 6e67 2069 7320 7061   If string is pa
-0000f000: 7373 6564 2c20 7769 6c6c 2075 7365 2074  ssed, will use t
-0000f010: 6865 2064 6174 6120 636f 6c75 6d6e 2077  he data column w
-0000f020: 6974 6820 7468 6174 206e 616d 6520 6173  ith that name as
-0000f030: 2074 6865 2067 726f 7570 732e 0a20 2020   the groups..   
-0000f040: 2020 2020 2020 2020 204f 6e6c 7920 7573           Only us
-0000f050: 6564 2069 6620 6120 6772 6f75 7020 6261  ed if a group ba
-0000f060: 7365 6420 6372 6f73 732d 7661 6c69 6461  sed cross-valida
-0000f070: 7469 6f6e 2067 656e 6572 6174 6f72 2069  tion generator i
-0000f080: 7320 7573 6564 2028 6567 2e20 4772 6f75  s used (eg. Grou
-0000f090: 704b 466f 6c64 292e 0a20 2020 2020 2020  pKFold)..       
-0000f0a0: 2020 2020 2049 6620 4e6f 6e65 2c20 7769       If None, wi
-0000f0b0: 6c6c 2075 7365 2074 6865 2076 616c 7565  ll use the value
-0000f0c0: 2073 6574 2069 6e20 666f 6c64 5f67 726f   set in fold_gro
-0000f0d0: 7570 7320 7061 7261 6d65 7465 7220 696e  ups parameter in
-0000f0e0: 2073 6574 7570 2829 2e0a 0a20 2020 2020   setup()...     
-0000f0f0: 2020 2072 6566 6974 3a20 626f 6f6c 2c20     refit: bool, 
-0000f100: 6465 6661 756c 7420 3d20 5472 7565 0a20  default = True. 
-0000f110: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
-0000f120: 6572 2074 6f20 7265 6669 7420 7468 6520  er to refit the 
-0000f130: 6d6f 6465 6c20 6f6e 2074 6865 2065 6e74  model on the ent
-0000f140: 6972 6520 6461 7461 7365 7420 6166 7465  ire dataset afte
-0000f150: 7220 4356 2e20 4967 6e6f 7265 6420 6966  r CV. Ignored if
-0000f160: 2063 726f 7373 5f76 616c 6964 6174 696f   cross_validatio
-0000f170: 6e20 3d3d 2046 616c 7365 2e0a 0a20 2020  n == False...   
-0000f180: 2020 2020 2076 6572 626f 7365 3a20 626f       verbose: bo
-0000f190: 6f6c 2c20 6465 6661 756c 7420 3d20 5472  ol, default = Tr
-0000f1a0: 7565 0a20 2020 2020 2020 2020 2020 2053  ue.            S
-0000f1b0: 636f 7265 2067 7269 6420 6973 206e 6f74  core grid is not
-0000f1c0: 2070 7269 6e74 6564 2077 6865 6e20 7665   printed when ve
-0000f1d0: 7262 6f73 6520 6973 2073 6574 2074 6f20  rbose is set to 
-0000f1e0: 4661 6c73 652e 0a0a 2020 2020 2020 2020  False...        
-0000f1f0: 7379 7374 656d 3a20 626f 6f6c 2c20 6465  system: bool, de
-0000f200: 6661 756c 7420 3d20 5472 7565 0a20 2020  fault = True.   
-0000f210: 2020 2020 2020 2020 204d 7573 7420 7265           Must re
-0000f220: 6d61 696e 2054 7275 6520 616c 6c20 7469  main True all ti
-0000f230: 6d65 732e 204f 6e6c 7920 746f 2062 6520  mes. Only to be 
-0000f240: 6368 616e 6765 6420 6279 2069 6e74 6572  changed by inter
-0000f250: 6e61 6c20 6675 6e63 7469 6f6e 732e 0a20  nal functions.. 
-0000f260: 2020 2020 2020 2020 2020 2049 6620 4661             If Fa
-0000f270: 6c73 652c 206d 6574 686f 6420 7769 6c6c  lse, method will
-0000f280: 2072 6574 7572 6e20 6120 7475 706c 6520   return a tuple 
-0000f290: 6f66 206d 6f64 656c 2061 6e64 2074 6865  of model and the
-0000f2a0: 206d 6f64 656c 2066 6974 2074 696d 652e   model fit time.
-0000f2b0: 0a0a 2020 2020 2020 2020 6164 645f 746f  ..        add_to
-0000f2c0: 5f6d 6f64 656c 5f6c 6973 743a 2062 6f6f  _model_list: boo
-0000f2d0: 6c2c 2064 6566 6175 6c74 203d 2054 7275  l, default = Tru
-0000f2e0: 650a 2020 2020 2020 2020 2020 2020 5768  e.            Wh
-0000f2f0: 6574 6865 7220 746f 2073 6176 6520 6d6f  ether to save mo
-0000f300: 6465 6c20 616e 6420 7265 7375 6c74 7320  del and results 
-0000f310: 696e 205f 6d61 7374 6572 5f6d 6f64 656c  in _master_model
-0000f320: 5f63 6f6e 7461 696e 6572 2e0a 0a20 2020  _container...   
-0000f330: 2020 2020 2058 5f74 7261 696e 5f64 6174       X_train_dat
-0000f340: 613a 2070 616e 6461 732e 4461 7461 4672  a: pandas.DataFr
-0000f350: 616d 652c 2064 6566 6175 6c74 203d 204e  ame, default = N
-0000f360: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-0000f370: 4966 206e 6f74 204e 6f6e 652c 2077 696c  If not None, wil
-0000f380: 6c20 7573 6520 7468 6973 2064 6174 6166  l use this dataf
-0000f390: 7261 6d65 2061 7320 7472 6169 6e69 6e67  rame as training
-0000f3a0: 2066 6561 7475 7265 732e 0a20 2020 2020   features..     
-0000f3b0: 2020 2020 2020 2049 6e74 656e 6465 6420         Intended 
-0000f3c0: 746f 2062 6520 6f6e 6c79 2063 6861 6e67  to be only chang
-0000f3d0: 6564 2062 7920 696e 7465 726e 616c 2066  ed by internal f
-0000f3e0: 756e 6374 696f 6e73 2e0a 0a20 2020 2020  unctions...     
-0000f3f0: 2020 2079 5f74 7261 696e 5f64 6174 613a     y_train_data:
-0000f400: 2070 616e 6461 732e 4461 7461 4672 616d   pandas.DataFram
-0000f410: 652c 2064 6566 6175 6c74 203d 204e 6f6e  e, default = Non
-0000f420: 650a 2020 2020 2020 2020 2020 2020 4966  e.            If
-0000f430: 206e 6f74 204e 6f6e 652c 2077 696c 6c20   not None, will 
-0000f440: 7573 6520 7468 6973 2064 6174 6166 7261  use this datafra
-0000f450: 6d65 2061 7320 7472 6169 6e69 6e67 2074  me as training t
-0000f460: 6172 6765 742e 0a20 2020 2020 2020 2020  arget..         
-0000f470: 2020 2049 6e74 656e 6465 6420 746f 2062     Intended to b
-0000f480: 6520 6f6e 6c79 2063 6861 6e67 6564 2062  e only changed b
-0000f490: 7920 696e 7465 726e 616c 2066 756e 6374  y internal funct
-0000f4a0: 696f 6e73 2e0a 0a20 2020 2020 2020 2072  ions...        r
-0000f4b0: 6574 7572 6e5f 7472 6169 6e5f 7363 6f72  eturn_train_scor
-0000f4c0: 653a 2062 6f6f 6c2c 2064 6566 6175 6c74  e: bool, default
-0000f4d0: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
-0000f4e0: 2020 2020 2049 6620 4661 6c73 652c 2072       If False, r
-0000f4f0: 6574 7572 6e73 2074 6865 2043 5620 5661  eturns the CV Va
-0000f500: 6c69 6461 7469 6f6e 2073 636f 7265 7320  lidation scores 
-0000f510: 6f6e 6c79 2e0a 2020 2020 2020 2020 2020  only..          
-0000f520: 2020 4966 2054 7275 652c 2072 6574 7572    If True, retur
-0000f530: 6e73 2074 6865 2043 5620 7472 6169 6e69  ns the CV traini
-0000f540: 6e67 2073 636f 7265 7320 616c 6f6e 6720  ng scores along 
-0000f550: 7769 7468 2074 6865 2043 5620 7661 6c69  with the CV vali
-0000f560: 6461 7469 6f6e 2073 636f 7265 732e 0a20  dation scores.. 
-0000f570: 2020 2020 2020 2020 2020 2054 6869 7320             This 
-0000f580: 6973 2075 7365 6675 6c20 7768 656e 2074  is useful when t
-0000f590: 6865 2075 7365 7220 7761 6e74 7320 746f  he user wants to
-0000f5a0: 2064 6f20 6269 6173 2d76 6172 6961 6e63   do bias-varianc
-0000f5b0: 6520 7472 6164 656f 6666 2e20 4120 6869  e tradeoff. A hi
-0000f5c0: 6768 2043 560a 2020 2020 2020 2020 2020  gh CV.          
-0000f5d0: 2020 7472 6169 6e69 6e67 2073 636f 7265    training score
-0000f5e0: 2077 6974 6820 6120 6c6f 7720 636f 7272   with a low corr
-0000f5f0: 6573 706f 6e64 696e 6720 4356 2076 616c  esponding CV val
-0000f600: 6964 6174 696f 6e20 7363 6f72 6520 696e  idation score in
-0000f610: 6469 6361 7465 7320 6f76 6572 6669 7474  dicates overfitt
-0000f620: 696e 672e 0a0a 2020 2020 2020 2020 2a2a  ing...        **
-0000f630: 6b77 6172 6773 3a0a 2020 2020 2020 2020  kwargs:.        
-0000f640: 2020 2020 4164 6469 7469 6f6e 616c 206b      Additional k
-0000f650: 6579 776f 7264 2061 7267 756d 656e 7473  eyword arguments
-0000f660: 2074 6f20 7061 7373 2074 6f20 7468 6520   to pass to the 
-0000f670: 6573 7469 6d61 746f 722e 0a0a 2020 2020  estimator...    
-0000f680: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-0000f690: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-0000f6a0: 2020 2020 7363 6f72 655f 6772 6964 0a20      score_grid. 
-0000f6b0: 2020 2020 2020 2020 2020 2041 2074 6162             A tab
-0000f6c0: 6c65 2063 6f6e 7461 696e 696e 6720 7468  le containing th
-0000f6d0: 6520 7363 6f72 6573 206f 6620 7468 6520  e scores of the 
-0000f6e0: 6d6f 6465 6c20 6163 726f 7373 2074 6865  model across the
-0000f6f0: 206b 666f 6c64 732e 0a20 2020 2020 2020   kfolds..       
-0000f700: 2020 2020 2053 636f 7269 6e67 206d 6574       Scoring met
-0000f710: 7269 6373 2075 7365 6420 6172 6520 4163  rics used are Ac
-0000f720: 6375 7261 6379 2c20 4155 432c 2052 6563  curacy, AUC, Rec
-0000f730: 616c 6c2c 2050 7265 6369 7369 6f6e 2c20  all, Precision, 
-0000f740: 4631 2c0a 2020 2020 2020 2020 2020 2020  F1,.            
-0000f750: 4b61 7070 6120 616e 6420 4d43 432e 204d  Kappa and MCC. M
-0000f760: 6561 6e20 616e 6420 7374 616e 6461 7264  ean and standard
-0000f770: 2064 6576 6961 7469 6f6e 206f 6620 7468   deviation of th
-0000f780: 6520 7363 6f72 6573 2061 6372 6f73 730a  e scores across.
-0000f790: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-0000f7a0: 666f 6c64 7320 6172 6520 6869 6768 6c69  folds are highli
-0000f7b0: 6768 7465 6420 696e 2079 656c 6c6f 772e  ghted in yellow.
-0000f7c0: 0a0a 2020 2020 2020 2020 6d6f 6465 6c0a  ..        model.
-0000f7d0: 2020 2020 2020 2020 2020 2020 7472 6169              trai
-0000f7e0: 6e65 6420 6d6f 6465 6c20 6f62 6a65 6374  ned model object
-0000f7f0: 0a0a 2020 2020 2020 2020 5761 726e 696e  ..        Warnin
-0000f800: 6773 0a20 2020 2020 2020 202d 2d2d 2d2d  gs.        -----
-0000f810: 2d2d 2d0a 2020 2020 2020 2020 2d20 2773  ---.        - 's
-0000f820: 766d 2720 616e 6420 2772 6964 6765 2720  vm' and 'ridge' 
-0000f830: 646f 6573 6e27 7420 7375 7070 6f72 7420  doesn't support 
-0000f840: 7072 6564 6963 745f 7072 6f62 6120 6d65  predict_proba me
-0000f850: 7468 6f64 2e20 4173 2073 7563 682c 2041  thod. As such, A
-0000f860: 5543 2077 696c 6c20 6265 0a20 2020 2020  UC will be.     
-0000f870: 2020 2072 6574 7572 6e65 6420 6173 207a     returned as z
-0000f880: 6572 6f20 2830 2e30 290a 0a20 2020 2020  ero (0.0)..     
-0000f890: 2020 202d 2049 6620 7461 7267 6574 2076     - If target v
-0000f8a0: 6172 6961 626c 6520 6973 206d 756c 7469  ariable is multi
-0000f8b0: 636c 6173 7320 286d 6f72 6520 7468 616e  class (more than
-0000f8c0: 2032 2063 6c61 7373 6573 292c 2041 5543   2 classes), AUC
-0000f8d0: 2077 696c 6c20 6265 2072 6574 7572 6e65   will be returne
-0000f8e0: 640a 2020 2020 2020 2020 6173 207a 6572  d.        as zer
-0000f8f0: 6f20 2830 2e30 290a 0a20 2020 2020 2020  o (0.0)..       
-0000f900: 202d 2027 7262 6673 766d 2720 616e 6420   - 'rbfsvm' and 
-0000f910: 2767 7063 2720 7573 6573 206e 6f6e 2d6c  'gpc' uses non-l
-0000f920: 696e 6561 7220 6b65 726e 656c 2061 6e64  inear kernel and
-0000f930: 2068 656e 6365 2074 6865 2066 6974 2074   hence the fit t
-0000f940: 696d 6520 636f 6d70 6c65 7869 7479 2069  ime complexity i
-0000f950: 730a 2020 2020 2020 2020 6d6f 7265 2074  s.        more t
-0000f960: 6861 6e20 7175 6164 7261 7469 632e 2054  han quadratic. T
-0000f970: 6865 7365 2065 7374 696d 6174 6f72 7320  hese estimators 
-0000f980: 6172 6520 6861 7264 2074 6f20 7363 616c  are hard to scal
-0000f990: 6520 6f6e 2064 6174 6173 6574 7320 7769  e on datasets wi
-0000f9a0: 7468 206d 6f72 650a 2020 2020 2020 2020  th more.        
-0000f9b0: 7468 616e 2031 302c 3030 3020 7361 6d70  than 10,000 samp
-0000f9c0: 6c65 732e 0a0a 2020 2020 2020 2020 2d20  les...        - 
-0000f9d0: 4966 2063 726f 7373 5f76 616c 6964 6174  If cross_validat
-0000f9e0: 696f 6e20 7061 7261 6d65 7465 7220 6973  ion parameter is
-0000f9f0: 2073 6574 2074 6f20 4661 6c73 652c 206d   set to False, m
-0000fa00: 6f64 656c 2077 696c 6c20 6e6f 7420 6265  odel will not be
-0000fa10: 206c 6f67 6765 6420 7769 7468 204d 4c46   logged with MLF
-0000fa20: 6c6f 772e 0a0a 2020 2020 2020 2020 2222  low...        ""
-0000fa30: 220a 0a20 2020 2020 2020 2023 2054 4f44  "..        # TOD
-0000fa40: 4f20 696d 7072 6f76 6520 6572 726f 7220  O improve error 
-0000fa50: 6d65 7373 6167 650a 2020 2020 2020 2020  message.        
-0000fa60: 6173 7365 7274 206e 6f74 2061 6e79 280a  assert not any(.
-0000fa70: 2020 2020 2020 2020 2020 2020 780a 2020              x.  
-0000fa80: 2020 2020 2020 2020 2020 696e 2028 0a20            in (. 
-0000fa90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000faa0: 7379 7374 656d 222c 0a20 2020 2020 2020  system",.       
-0000fab0: 2020 2020 2020 2020 2022 6164 645f 746f           "add_to
-0000fac0: 5f6d 6f64 656c 5f6c 6973 7422 2c0a 2020  _model_list",.  
-0000fad0: 2020 2020 2020 2020 2020 2020 2020 2258                "X
-0000fae0: 5f74 7261 696e 5f64 6174 6122 2c0a 2020  _train_data",.  
-0000faf0: 2020 2020 2020 2020 2020 2020 2020 2279                "y
-0000fb00: 5f74 7261 696e 5f64 6174 6122 2c0a 2020  _train_data",.  
-0000fb10: 2020 2020 2020 2020 2020 2020 2020 226d                "m
-0000fb20: 6574 7269 6373 222c 0a20 2020 2020 2020  etrics",.       
-0000fb30: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0000fb40: 2020 2066 6f72 2078 2069 6e20 6b77 6172     for x in kwar
-0000fb50: 6773 0a20 2020 2020 2020 2029 0a20 2020  gs.        ).   
-0000fb60: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000fb70: 2e5f 6372 6561 7465 5f6d 6f64 656c 280a  ._create_model(.
-0000fb80: 2020 2020 2020 2020 2020 2020 6573 7469              esti
-0000fb90: 6d61 746f 723d 6573 7469 6d61 746f 722c  mator=estimator,
-0000fba0: 0a20 2020 2020 2020 2020 2020 2066 6f6c  .            fol
-0000fbb0: 643d 666f 6c64 2c0a 2020 2020 2020 2020  d=fold,.        
-0000fbc0: 2020 2020 726f 756e 643d 726f 756e 642c      round=round,
-0000fbd0: 0a20 2020 2020 2020 2020 2020 2063 726f  .            cro
-0000fbe0: 7373 5f76 616c 6964 6174 696f 6e3d 6372  ss_validation=cr
-0000fbf0: 6f73 735f 7661 6c69 6461 7469 6f6e 2c0a  oss_validation,.
-0000fc00: 2020 2020 2020 2020 2020 2020 7072 6564              pred
-0000fc10: 6963 743d 7072 6564 6963 742c 0a20 2020  ict=predict,.   
-0000fc20: 2020 2020 2020 2020 2066 6974 5f6b 7761           fit_kwa
-0000fc30: 7267 733d 6669 745f 6b77 6172 6773 2c0a  rgs=fit_kwargs,.
-0000fc40: 2020 2020 2020 2020 2020 2020 6772 6f75              grou
-0000fc50: 7073 3d67 726f 7570 732c 0a20 2020 2020  ps=groups,.     
-0000fc60: 2020 2020 2020 2072 6566 6974 3d72 6566         refit=ref
-0000fc70: 6974 2c0a 2020 2020 2020 2020 2020 2020  it,.            
-0000fc80: 7072 6f62 6162 696c 6974 795f 7468 7265  probability_thre
-0000fc90: 7368 6f6c 643d 7072 6f62 6162 696c 6974  shold=probabilit
-0000fca0: 795f 7468 7265 7368 6f6c 642c 0a20 2020  y_threshold,.   
-0000fcb0: 2020 2020 2020 2020 2065 7870 6572 696d           experim
-0000fcc0: 656e 745f 6375 7374 6f6d 5f74 6167 733d  ent_custom_tags=
-0000fcd0: 6578 7065 7269 6d65 6e74 5f63 7573 746f  experiment_custo
-0000fce0: 6d5f 7461 6773 2c0a 2020 2020 2020 2020  m_tags,.        
-0000fcf0: 2020 2020 7665 7262 6f73 653d 7665 7262      verbose=verb
-0000fd00: 6f73 652c 0a20 2020 2020 2020 2020 2020  ose,.           
-0000fd10: 2072 6574 7572 6e5f 7472 6169 6e5f 7363   return_train_sc
-0000fd20: 6f72 653d 7265 7475 726e 5f74 7261 696e  ore=return_train
-0000fd30: 5f73 636f 7265 2c0a 2020 2020 2020 2020  _score,.        
-0000fd40: 2020 2020 2a2a 6b77 6172 6773 2c0a 2020      **kwargs,.  
-0000fd50: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-0000fd60: 2074 756e 655f 6d6f 6465 6c28 0a20 2020   tune_model(.   
-0000fd70: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0000fd80: 2020 2065 7374 696d 6174 6f72 2c0a 2020     estimator,.  
-0000fd90: 2020 2020 2020 666f 6c64 3a20 4f70 7469        fold: Opti
-0000fda0: 6f6e 616c 5b55 6e69 6f6e 5b69 6e74 2c20  onal[Union[int, 
-0000fdb0: 416e 795d 5d20 3d20 4e6f 6e65 2c0a 2020  Any]] = None,.  
-0000fdc0: 2020 2020 2020 726f 756e 643a 2069 6e74        round: int
-0000fdd0: 203d 2034 2c0a 2020 2020 2020 2020 6e5f   = 4,.        n_
-0000fde0: 6974 6572 3a20 696e 7420 3d20 3130 2c0a  iter: int = 10,.
-0000fdf0: 2020 2020 2020 2020 6375 7374 6f6d 5f67          custom_g
-0000fe00: 7269 643a 204f 7074 696f 6e61 6c5b 556e  rid: Optional[Un
-0000fe10: 696f 6e5b 4469 6374 5b73 7472 2c20 6c69  ion[Dict[str, li
-0000fe20: 7374 5d2c 2041 6e79 5d5d 203d 204e 6f6e  st], Any]] = Non
-0000fe30: 652c 0a20 2020 2020 2020 206f 7074 696d  e,.        optim
-0000fe40: 697a 653a 2073 7472 203d 2022 4163 6375  ize: str = "Accu
-0000fe50: 7261 6379 222c 0a20 2020 2020 2020 2063  racy",.        c
-0000fe60: 7573 746f 6d5f 7363 6f72 6572 3d4e 6f6e  ustom_scorer=Non
-0000fe70: 652c 2020 2320 6164 6465 6420 696e 2070  e,  # added in p
-0000fe80: 7963 6172 6574 3d3d 322e 3120 2d20 6465  ycaret==2.1 - de
-0000fe90: 7072 6563 6961 7465 640a 2020 2020 2020  preciated.      
-0000fea0: 2020 7365 6172 6368 5f6c 6962 7261 7279    search_library
-0000feb0: 3a20 7374 7220 3d20 2273 6369 6b69 742d  : str = "scikit-
-0000fec0: 6c65 6172 6e22 2c0a 2020 2020 2020 2020  learn",.        
-0000fed0: 7365 6172 6368 5f61 6c67 6f72 6974 686d  search_algorithm
-0000fee0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-0000fef0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0000ff00: 6561 726c 795f 7374 6f70 7069 6e67 3a20  early_stopping: 
-0000ff10: 416e 7920 3d20 4661 6c73 652c 0a20 2020  Any = False,.   
-0000ff20: 2020 2020 2065 6172 6c79 5f73 746f 7070       early_stopp
-0000ff30: 696e 675f 6d61 785f 6974 6572 733a 2069  ing_max_iters: i
-0000ff40: 6e74 203d 2031 302c 0a20 2020 2020 2020  nt = 10,.       
-0000ff50: 2063 686f 6f73 655f 6265 7474 6572 3a20   choose_better: 
-0000ff60: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
-0000ff70: 2020 2020 2020 6669 745f 6b77 6172 6773        fit_kwargs
-0000ff80: 3a20 4f70 7469 6f6e 616c 5b64 6963 745d  : Optional[dict]
-0000ff90: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0000ffa0: 2067 726f 7570 733a 204f 7074 696f 6e61   groups: Optiona
-0000ffb0: 6c5b 556e 696f 6e5b 7374 722c 2041 6e79  l[Union[str, Any
-0000ffc0: 5d5d 203d 204e 6f6e 652c 0a20 2020 2020  ]] = None,.     
-0000ffd0: 2020 2072 6574 7572 6e5f 7475 6e65 723a     return_tuner:
-0000ffe0: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
-0000fff0: 2020 2020 2020 2076 6572 626f 7365 3a20         verbose: 
-00010000: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
-00010010: 2020 2020 2074 756e 6572 5f76 6572 626f       tuner_verbo
-00010020: 7365 3a20 556e 696f 6e5b 696e 742c 2062  se: Union[int, b
-00010030: 6f6f 6c5d 203d 2054 7275 652c 0a20 2020  ool] = True,.   
-00010040: 2020 2020 2072 6574 7572 6e5f 7472 6169       return_trai
-00010050: 6e5f 7363 6f72 653a 2062 6f6f 6c20 3d20  n_score: bool = 
-00010060: 4661 6c73 652c 0a20 2020 2020 2020 202a  False,.        *
-00010070: 2a6b 7761 7267 732c 0a20 2020 2029 202d  *kwargs,.    ) -
-00010080: 3e20 416e 793a 0a0a 2020 2020 2020 2020  > Any:..        
-00010090: 2222 220a 2020 2020 2020 2020 5468 6973  """.        This
-000100a0: 2066 756e 6374 696f 6e20 7475 6e65 7320   function tunes 
-000100b0: 7468 6520 6879 7065 7270 6172 616d 6574  the hyperparamet
-000100c0: 6572 7320 6f66 2061 206d 6f64 656c 2061  ers of a model a
-000100d0: 6e64 2073 636f 7265 7320 6974 2075 7369  nd scores it usi
-000100e0: 6e67 2043 726f 7373 2056 616c 6964 6174  ng Cross Validat
-000100f0: 696f 6e2e 0a20 2020 2020 2020 2054 6865  ion..        The
-00010100: 206f 7574 7075 7420 7072 696e 7473 2061   output prints a
-00010110: 2073 636f 7265 2067 7269 6420 7468 6174   score grid that
-00010120: 2073 686f 7773 2041 6363 7572 6163 792c   shows Accuracy,
-00010130: 2041 5543 2c20 5265 6361 6c6c 0a20 2020   AUC, Recall.   
-00010140: 2020 2020 2050 7265 6369 7369 6f6e 2c20       Precision, 
-00010150: 4631 2c20 4b61 7070 6120 616e 6420 4d43  F1, Kappa and MC
-00010160: 4320 6279 2066 6f6c 6420 2862 7920 6465  C by fold (by de
-00010170: 6661 756c 7420 3d20 3130 2046 6f6c 6473  fault = 10 Folds
-00010180: 292e 0a0a 2020 2020 2020 2020 5468 6973  )...        This
-00010190: 2066 756e 6374 696f 6e20 7265 7475 726e   function return
-000101a0: 7320 6120 7472 6169 6e65 6420 6d6f 6465  s a trained mode
-000101b0: 6c20 6f62 6a65 6374 2e0a 0a20 2020 2020  l object...     
-000101c0: 2020 2045 7861 6d70 6c65 0a20 2020 2020     Example.     
-000101d0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-000101e0: 2020 203e 3e3e 2066 726f 6d20 7079 6361     >>> from pyca
-000101f0: 7265 742e 6461 7461 7365 7473 2069 6d70  ret.datasets imp
-00010200: 6f72 7420 6765 745f 6461 7461 0a20 2020  ort get_data.   
-00010210: 2020 2020 203e 3e3e 206a 7569 6365 203d       >>> juice =
-00010220: 2067 6574 5f64 6174 6128 276a 7569 6365   get_data('juice
-00010230: 2729 0a20 2020 2020 2020 203e 3e3e 2065  ').        >>> e
-00010240: 7870 6572 696d 656e 745f 6e61 6d65 203d  xperiment_name =
-00010250: 2073 6574 7570 2864 6174 6120 3d20 6a75   setup(data = ju
-00010260: 6963 652c 2020 7461 7267 6574 203d 2027  ice,  target = '
-00010270: 5075 7263 6861 7365 2729 0a20 2020 2020  Purchase').     
-00010280: 2020 203e 3e3e 2078 6762 6f6f 7374 203d     >>> xgboost =
-00010290: 2063 7265 6174 655f 6d6f 6465 6c28 2778   create_model('x
-000102a0: 6762 6f6f 7374 2729 0a20 2020 2020 2020  gboost').       
-000102b0: 203e 3e3e 2074 756e 6564 5f78 6762 6f6f   >>> tuned_xgboo
-000102c0: 7374 203d 2074 756e 655f 6d6f 6465 6c28  st = tune_model(
-000102d0: 7867 626f 6f73 7429 0a0a 2020 2020 2020  xgboost)..      
-000102e0: 2020 5468 6973 2077 696c 6c20 7475 6e65    This will tune
-000102f0: 2074 6865 2068 7970 6572 7061 7261 6d65   the hyperparame
-00010300: 7465 7273 206f 6620 4578 7472 656d 6520  ters of Extreme 
-00010310: 4772 6164 6965 6e74 2042 6f6f 7374 696e  Gradient Boostin
-00010320: 6720 436c 6173 7369 6669 6572 2e0a 0a0a  g Classifier....
-00010330: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00010340: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00010350: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6573  -----.        es
-00010360: 7469 6d61 746f 7220 3a20 6f62 6a65 6374  timator : object
-00010370: 2c20 6465 6661 756c 7420 3d20 4e6f 6e65  , default = None
-00010380: 0a0a 2020 2020 2020 2020 666f 6c64 3a20  ..        fold: 
-00010390: 696e 7465 6765 7220 6f72 2073 6369 6b69  integer or sciki
-000103a0: 742d 6c65 6172 6e20 636f 6d70 6174 6962  t-learn compatib
-000103b0: 6c65 2043 5620 6765 6e65 7261 746f 722c  le CV generator,
-000103c0: 2064 6566 6175 6c74 203d 204e 6f6e 650a   default = None.
-000103d0: 2020 2020 2020 2020 2020 2020 436f 6e74              Cont
-000103e0: 726f 6c73 2063 726f 7373 2d76 616c 6964  rols cross-valid
-000103f0: 6174 696f 6e2e 2049 6620 4e6f 6e65 2c20  ation. If None, 
-00010400: 7769 6c6c 2075 7365 2074 6865 2043 5620  will use the CV 
-00010410: 6765 6e65 7261 746f 7220 6465 6669 6e65  generator define
-00010420: 6420 696e 2073 6574 7570 2829 2e0a 2020  d in setup()..  
-00010430: 2020 2020 2020 2020 2020 4966 2069 6e74            If int
-00010440: 6567 6572 2c20 7769 6c6c 2075 7365 204b  eger, will use K
-00010450: 466f 6c64 2043 5620 7769 7468 2074 6861  Fold CV with tha
-00010460: 7420 6d61 6e79 2066 6f6c 6473 2e0a 2020  t many folds..  
-00010470: 2020 2020 2020 2020 2020 5768 656e 2063            When c
-00010480: 726f 7373 5f76 616c 6964 6174 696f 6e20  ross_validation 
-00010490: 6973 2046 616c 7365 2c20 7468 6973 2070  is False, this p
-000104a0: 6172 616d 6574 6572 2069 7320 6967 6e6f  arameter is igno
-000104b0: 7265 642e 0a0a 2020 2020 2020 2020 726f  red...        ro
-000104c0: 756e 643a 2069 6e74 6567 6572 2c20 6465  und: integer, de
-000104d0: 6661 756c 7420 3d20 340a 2020 2020 2020  fault = 4.      
-000104e0: 2020 2020 2020 4e75 6d62 6572 206f 6620        Number of 
-000104f0: 6465 6369 6d61 6c20 706c 6163 6573 2074  decimal places t
-00010500: 6865 206d 6574 7269 6373 2069 6e20 7468  he metrics in th
-00010510: 6520 7363 6f72 6520 6772 6964 2077 696c  e score grid wil
-00010520: 6c20 6265 2072 6f75 6e64 6564 2074 6f2e  l be rounded to.
-00010530: 0a0a 2020 2020 2020 2020 6e5f 6974 6572  ..        n_iter
-00010540: 3a20 696e 7465 6765 722c 2064 6566 6175  : integer, defau
-00010550: 6c74 203d 2031 300a 2020 2020 2020 2020  lt = 10.        
-00010560: 2020 2020 4e75 6d62 6572 206f 6620 6974      Number of it
-00010570: 6572 6174 696f 6e73 2077 6974 6869 6e20  erations within 
-00010580: 7468 6520 5261 6e64 6f6d 2047 7269 6420  the Random Grid 
-00010590: 5365 6172 6368 2e20 466f 7220 6576 6572  Search. For ever
-000105a0: 7920 6974 6572 6174 696f 6e2c 0a20 2020  y iteration,.   
-000105b0: 2020 2020 2020 2020 2074 6865 206d 6f64           the mod
-000105c0: 656c 2072 616e 646f 6d6c 7920 7365 6c65  el randomly sele
-000105d0: 6374 7320 6f6e 6520 7661 6c75 6520 6672  cts one value fr
-000105e0: 6f6d 2074 6865 2070 7265 2d64 6566 696e  om the pre-defin
-000105f0: 6564 2067 7269 6420 6f66 0a20 2020 2020  ed grid of.     
-00010600: 2020 2020 2020 2068 7970 6572 7061 7261         hyperpara
-00010610: 6d65 7465 7273 2e0a 0a20 2020 2020 2020  meters...       
-00010620: 2063 7573 746f 6d5f 6772 6964 3a20 6469   custom_grid: di
-00010630: 6374 696f 6e61 7279 2c20 6465 6661 756c  ctionary, defaul
-00010640: 7420 3d20 4e6f 6e65 0a20 2020 2020 2020  t = None.       
-00010650: 2020 2020 2054 6f20 7573 6520 6375 7374       To use cust
-00010660: 6f6d 2068 7970 6572 7061 7261 6d65 7465  om hyperparamete
-00010670: 7273 2066 6f72 2074 756e 696e 6720 7061  rs for tuning pa
-00010680: 7373 2061 2064 6963 7469 6f6e 6172 7920  ss a dictionary 
-00010690: 7769 7468 2070 6172 616d 6574 6572 206e  with parameter n
-000106a0: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
-000106b0: 616e 6420 7661 6c75 6573 2074 6f20 6265  and values to be
-000106c0: 2069 7465 7261 7465 642e 2057 6865 6e20   iterated. When 
-000106d0: 7365 7420 746f 204e 6f6e 6520 6974 2075  set to None it u
-000106e0: 7365 7320 7072 652d 6465 6669 6e65 6420  ses pre-defined 
-000106f0: 7475 6e69 6e67 2067 7269 642e 0a20 2020  tuning grid..   
-00010700: 2020 2020 2020 2020 2043 7573 746f 6d20           Custom 
-00010710: 6772 6964 7320 6d75 7374 2062 6520 696e  grids must be in
-00010720: 2061 2066 6f72 6d61 7420 7375 7070 6f72   a format suppor
-00010730: 7465 6420 6279 2074 6865 2063 686f 7365  ted by the chose
-00010740: 6e20 7365 6172 6368 206c 6962 7261 7279  n search library
-00010750: 2e0a 0a20 2020 2020 2020 206f 7074 696d  ...        optim
-00010760: 697a 653a 2073 7472 2c20 6465 6661 756c  ize: str, defaul
-00010770: 7420 3d20 2741 6363 7572 6163 7927 0a20  t = 'Accuracy'. 
-00010780: 2020 2020 2020 2020 2020 204d 6561 7375             Measu
-00010790: 7265 2075 7365 6420 746f 2073 656c 6563  re used to selec
-000107a0: 7420 7468 6520 6265 7374 206d 6f64 656c  t the best model
-000107b0: 2074 6872 6f75 6768 2068 7970 6572 7061   through hyperpa
-000107c0: 7261 6d65 7465 7220 7475 6e69 6e67 2e0a  rameter tuning..
-000107d0: 2020 2020 2020 2020 2020 2020 4361 6e20              Can 
-000107e0: 6265 2065 6974 6865 7220 6120 7374 7269  be either a stri
-000107f0: 6e67 2072 6570 7265 7365 6e74 696e 6720  ng representing 
-00010800: 6120 6d65 7472 6963 206f 7220 6120 6375  a metric or a cu
-00010810: 7374 6f6d 2073 636f 7265 7220 6f62 6a65  stom scorer obje
-00010820: 6374 0a20 2020 2020 2020 2020 2020 2063  ct.            c
-00010830: 7265 6174 6564 2075 7369 6e67 2073 6b6c  reated using skl
-00010840: 6561 726e 2e6d 616b 655f 7363 6f72 6572  earn.make_scorer
-00010850: 2e0a 0a20 2020 2020 2020 2063 7573 746f  ...        custo
-00010860: 6d5f 7363 6f72 6572 3a20 6f62 6a65 6374  m_scorer: object
-00010870: 2c20 6465 6661 756c 7420 3d20 4e6f 6e65  , default = None
-00010880: 0a20 2020 2020 2020 2020 2020 2057 696c  .            Wil
-00010890: 6c20 6265 2065 7665 6e74 7561 6c6c 7920  l be eventually 
-000108a0: 6465 7072 6563 6961 7465 642e 0a20 2020  depreciated..   
-000108b0: 2020 2020 2020 2020 2063 7573 746f 6d5f           custom_
-000108c0: 7363 6f72 6572 2063 616e 2062 6520 7061  scorer can be pa
-000108d0: 7373 6564 2074 6f20 7475 6e65 2068 7970  ssed to tune hyp
-000108e0: 6572 7061 7261 6d65 7465 7273 206f 6620  erparameters of 
-000108f0: 7468 6520 6d6f 6465 6c2e 2049 7420 6d75  the model. It mu
-00010900: 7374 2062 650a 2020 2020 2020 2020 2020  st be.          
-00010910: 2020 6372 6561 7465 6420 7573 696e 6720    created using 
-00010920: 736b 6c65 6172 6e2e 6d61 6b65 5f73 636f  sklearn.make_sco
-00010930: 7265 722e 0a0a 2020 2020 2020 2020 7365  rer...        se
-00010940: 6172 6368 5f6c 6962 7261 7279 3a20 7374  arch_library: st
-00010950: 722c 2064 6566 6175 6c74 203d 2027 7363  r, default = 'sc
-00010960: 696b 6974 2d6c 6561 726e 270a 2020 2020  ikit-learn'.    
-00010970: 2020 2020 2020 2020 5468 6520 7365 6172          The sear
-00010980: 6368 206c 6962 7261 7279 2075 7365 6420  ch library used 
-00010990: 746f 2074 756e 6520 6879 7065 7270 6172  to tune hyperpar
-000109a0: 616d 6574 6572 732e 0a20 2020 2020 2020  ameters..       
-000109b0: 2020 2020 2050 6f73 7369 626c 6520 7661       Possible va
-000109c0: 6c75 6573 3a0a 0a20 2020 2020 2020 2020  lues:..         
-000109d0: 2020 202d 2027 7363 696b 6974 2d6c 6561     - 'scikit-lea
-000109e0: 726e 2720 2d20 6465 6661 756c 742c 2072  rn' - default, r
-000109f0: 6571 7569 7265 7320 6e6f 2066 7572 7468  equires no furth
-00010a00: 6572 2069 6e73 7461 6c6c 6174 696f 6e0a  er installation.
-00010a10: 2020 2020 2020 2020 2020 2020 2d20 2773              - 's
-00010a20: 6369 6b69 742d 6f70 7469 6d69 7a65 2720  cikit-optimize' 
-00010a30: 2d20 7363 696b 6974 2d6f 7074 696d 697a  - scikit-optimiz
-00010a40: 652e 2060 6070 6970 2069 6e73 7461 6c6c  e. ``pip install
-00010a50: 2073 6369 6b69 742d 6f70 7469 6d69 7a65   scikit-optimize
-00010a60: 6060 2068 7474 7073 3a2f 2f73 6369 6b69  `` https://sciki
-00010a70: 742d 6f70 7469 6d69 7a65 2e67 6974 6875  t-optimize.githu
-00010a80: 622e 696f 2f73 7461 626c 652f 0a20 2020  b.io/stable/.   
-00010a90: 2020 2020 2020 2020 202d 2027 7475 6e65           - 'tune
-00010aa0: 2d73 6b6c 6561 726e 2720 2d20 5261 7920  -sklearn' - Ray 
-00010ab0: 5475 6e65 2073 6369 6b69 7420 4150 492e  Tune scikit API.
-00010ac0: 2044 6f65 7320 6e6f 7420 7375 7070 6f72   Does not suppor
-00010ad0: 7420 4750 5520 6d6f 6465 6c73 2e0a 2020  t GPU models..  
-00010ae0: 2020 2020 2020 2020 2020 6060 7069 7020            ``pip 
-00010af0: 696e 7374 616c 6c20 7475 6e65 2d73 6b6c  install tune-skl
-00010b00: 6561 726e 2072 6179 5b74 756e 655d 6060  earn ray[tune]``
-00010b10: 2068 7474 7073 3a2f 2f67 6974 6875 622e   https://github.
-00010b20: 636f 6d2f 7261 792d 7072 6f6a 6563 742f  com/ray-project/
-00010b30: 7475 6e65 2d73 6b6c 6561 726e 0a20 2020  tune-sklearn.   
-00010b40: 2020 2020 2020 2020 202d 2027 6f70 7475           - 'optu
-00010b50: 6e61 2720 2d20 4f70 7475 6e61 2e20 6060  na' - Optuna. ``
-00010b60: 7069 7020 696e 7374 616c 6c20 6f70 7475  pip install optu
-00010b70: 6e61 6060 2068 7474 7073 3a2f 2f6f 7074  na`` https://opt
-00010b80: 756e 612e 6f72 672f 0a0a 2020 2020 2020  una.org/..      
-00010b90: 2020 7365 6172 6368 5f61 6c67 6f72 6974    search_algorit
-00010ba0: 686d 3a20 7374 722c 2064 6566 6175 6c74  hm: str, default
-00010bb0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00010bc0: 2020 2020 5468 6520 7365 6172 6368 2061      The search a
-00010bd0: 6c67 6f72 6974 686d 2064 6570 656e 6473  lgorithm depends
-00010be0: 206f 6e20 7468 6520 6060 7365 6172 6368   on the ``search
-00010bf0: 5f6c 6962 7261 7279 6060 2070 6172 616d  _library`` param
-00010c00: 6574 6572 2e0a 2020 2020 2020 2020 2020  eter..          
-00010c10: 2020 536f 6d65 2073 6561 7263 6820 616c    Some search al
-00010c20: 676f 7269 7468 6d73 2072 6571 7569 7265  gorithms require
-00010c30: 2061 6464 6974 696f 6e61 6c20 6c69 6272   additional libr
-00010c40: 6172 6965 7320 746f 2062 6520 696e 7374  aries to be inst
-00010c50: 616c 6c65 642e 0a20 2020 2020 2020 2020  alled..         
-00010c60: 2020 2049 6620 4e6f 6e65 2c20 7769 6c6c     If None, will
-00010c70: 2075 7365 2073 6561 7263 6820 6c69 6272   use search libr
-00010c80: 6172 792d 7370 6563 6966 6963 2064 6566  ary-specific def
-00010c90: 6175 6c74 2061 6c67 6f72 6974 686d 2e0a  ault algorithm..
-00010ca0: 0a20 2020 2020 2020 2020 2020 202d 2027  .            - '
-00010cb0: 7363 696b 6974 2d6c 6561 726e 2720 706f  scikit-learn' po
-00010cc0: 7373 6962 6c65 2076 616c 7565 733a 0a20  ssible values:. 
-00010cd0: 2020 2020 2020 2020 2020 2020 2020 202d                 -
-00010ce0: 2027 7261 6e64 6f6d 2720 3a20 7261 6e64   'random' : rand
-00010cf0: 6f6d 2067 7269 6420 7365 6172 6368 2028  om grid search (
-00010d00: 6465 6661 756c 7429 0a20 2020 2020 2020  default).       
-00010d10: 2020 2020 2020 2020 202d 2027 6772 6964           - 'grid
-00010d20: 2720 3a20 6772 6964 2073 6561 7263 680a  ' : grid search.
-00010d30: 0a20 2020 2020 2020 2020 2020 202d 2027  .            - '
-00010d40: 7363 696b 6974 2d6f 7074 696d 697a 6527  scikit-optimize'
-00010d50: 2070 6f73 7369 626c 6520 7661 6c75 6573   possible values
-00010d60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00010d70: 2020 2d20 2762 6179 6573 6961 6e27 203a    - 'bayesian' :
-00010d80: 2042 6179 6573 6961 6e20 7365 6172 6368   Bayesian search
-00010d90: 2028 6465 6661 756c 7429 0a0a 2020 2020   (default)..    
-00010da0: 2020 2020 2020 2020 2d20 2774 756e 652d          - 'tune-
-00010db0: 736b 6c65 6172 6e27 2070 6f73 7369 626c  sklearn' possibl
-00010dc0: 6520 7661 6c75 6573 3a0a 2020 2020 2020  e values:.      
-00010dd0: 2020 2020 2020 2020 2020 2d20 2772 616e            - 'ran
-00010de0: 646f 6d27 203a 2072 616e 646f 6d20 6772  dom' : random gr
-00010df0: 6964 2073 6561 7263 6820 2864 6566 6175  id search (defau
-00010e00: 6c74 290a 2020 2020 2020 2020 2020 2020  lt).            
-00010e10: 2020 2020 2d20 2767 7269 6427 203a 2067      - 'grid' : g
-00010e20: 7269 6420 7365 6172 6368 0a20 2020 2020  rid search.     
-00010e30: 2020 2020 2020 2020 2020 202d 2027 6261             - 'ba
-00010e40: 7965 7369 616e 2720 3a20 6060 7069 7020  yesian' : ``pip 
-00010e50: 696e 7374 616c 6c20 7363 696b 6974 2d6f  install scikit-o
-00010e60: 7074 696d 697a 6560 600a 2020 2020 2020  ptimize``.      
-00010e70: 2020 2020 2020 2020 2020 2d20 2768 7970            - 'hyp
-00010e80: 6572 6f70 7427 203a 2060 6070 6970 2069  eropt' : ``pip i
-00010e90: 6e73 7461 6c6c 2068 7970 6572 6f70 7460  nstall hyperopt`
-00010ea0: 600a 2020 2020 2020 2020 2020 2020 2020  `.              
-00010eb0: 2020 2d20 276f 7074 756e 6127 203a 2060    - 'optuna' : `
-00010ec0: 6070 6970 2069 6e73 7461 6c6c 206f 7074  `pip install opt
-00010ed0: 756e 6160 600a 2020 2020 2020 2020 2020  una``.          
-00010ee0: 2020 2020 2020 2d20 2762 6f68 6227 203a        - 'bohb' :
-00010ef0: 2060 6070 6970 2069 6e73 7461 6c6c 2068   ``pip install h
-00010f00: 7062 616e 6473 7465 7220 436f 6e66 6967  pbandster Config
-00010f10: 5370 6163 6560 600a 0a20 2020 2020 2020  Space``..       
-00010f20: 2020 2020 202d 2027 6f70 7475 6e61 2720       - 'optuna' 
-00010f30: 706f 7373 6962 6c65 2076 616c 7565 733a  possible values:
-00010f40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010f50: 202d 2027 7261 6e64 6f6d 2720 3a20 7261   - 'random' : ra
-00010f60: 6e64 6f6d 697a 6564 2073 6561 7263 680a  ndomized search.
-00010f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010f80: 2d20 2774 7065 2720 3a20 5472 6565 2d73  - 'tpe' : Tree-s
-00010f90: 7472 7563 7475 7265 6420 5061 727a 656e  tructured Parzen
-00010fa0: 2045 7374 696d 6174 6f72 2073 6561 7263   Estimator searc
-00010fb0: 6820 2864 6566 6175 6c74 290a 0a20 2020  h (default)..   
-00010fc0: 2020 2020 2065 6172 6c79 5f73 746f 7070       early_stopp
-00010fd0: 696e 673a 2062 6f6f 6c20 6f72 2073 7472  ing: bool or str
-00010fe0: 206f 7220 6f62 6a65 6374 2c20 6465 6661   or object, defa
-00010ff0: 756c 7420 3d20 4661 6c73 650a 2020 2020  ult = False.    
-00011000: 2020 2020 2020 2020 5573 6520 6561 726c          Use earl
-00011010: 7920 7374 6f70 7069 6e67 2074 6f20 7374  y stopping to st
-00011020: 6f70 2066 6974 7469 6e67 2074 6f20 6120  op fitting to a 
-00011030: 6879 7065 7270 6172 616d 6574 6572 2063  hyperparameter c
-00011040: 6f6e 6669 6775 7261 7469 6f6e 0a20 2020  onfiguration.   
-00011050: 2020 2020 2020 2020 2069 6620 6974 2070           if it p
-00011060: 6572 666f 726d 7320 706f 6f72 6c79 2e20  erforms poorly. 
-00011070: 4967 6e6f 7265 6420 6966 2073 6561 7263  Ignored if searc
-00011080: 685f 6c69 6272 6172 7920 6973 2060 6073  h_library is ``s
-00011090: 6369 6b69 742d 6c65 6172 6e60 602c 206f  cikit-learn``, o
-000110a0: 720a 2020 2020 2020 2020 2020 2020 6966  r.            if
-000110b0: 2074 6865 2065 7374 696d 6174 6f72 2064   the estimator d
-000110c0: 6f65 736e 2774 2068 6176 6520 7061 7274  oesn't have part
-000110d0: 6961 6c5f 6669 7420 6174 7472 6962 7574  ial_fit attribut
-000110e0: 652e 0a20 2020 2020 2020 2020 2020 2049  e..            I
-000110f0: 6620 4661 6c73 6520 6f72 204e 6f6e 652c  f False or None,
-00011100: 2065 6172 6c79 2073 746f 7070 696e 6720   early stopping 
-00011110: 7769 6c6c 206e 6f74 2062 6520 7573 6564  will not be used
-00011120: 2e0a 2020 2020 2020 2020 2020 2020 4361  ..            Ca
-00011130: 6e20 6265 2065 6974 6865 7220 616e 206f  n be either an o
-00011140: 626a 6563 7420 6163 6365 7074 6564 2062  bject accepted b
-00011150: 7920 7468 6520 7365 6172 6368 206c 6962  y the search lib
-00011160: 7261 7279 206f 7220 6f6e 6520 6f66 2074  rary or one of t
-00011170: 6865 0a20 2020 2020 2020 2020 2020 2066  he.            f
-00011180: 6f6c 6c6f 7769 6e67 3a0a 0a20 2020 2020  ollowing:..     
-00011190: 2020 2020 2020 202d 2027 6173 6861 2720         - 'asha' 
-000111a0: 666f 7220 4173 796e 6368 726f 6e6f 7573  for Asynchronous
-000111b0: 2053 7563 6365 7373 6976 6520 4861 6c76   Successive Halv
-000111c0: 696e 6720 416c 676f 7269 7468 6d0a 2020  ing Algorithm.  
-000111d0: 2020 2020 2020 2020 2020 2d20 2768 7970            - 'hyp
-000111e0: 6572 6261 6e64 2720 666f 7220 4879 7065  erband' for Hype
-000111f0: 7262 616e 640a 2020 2020 2020 2020 2020  rband.          
-00011200: 2020 2d20 276d 6564 6961 6e27 2066 6f72    - 'median' for
-00011210: 206d 6564 6961 6e20 7374 6f70 7069 6e67   median stopping
-00011220: 2072 756c 650a 2020 2020 2020 2020 2020   rule.          
-00011230: 2020 2d20 4966 2046 616c 7365 206f 7220    - If False or 
-00011240: 4e6f 6e65 2c20 6561 726c 7920 7374 6f70  None, early stop
-00011250: 7069 6e67 2077 696c 6c20 6e6f 7420 6265  ping will not be
-00011260: 2075 7365 642e 0a0a 2020 2020 2020 2020   used...        
-00011270: 2020 2020 4d6f 7265 2069 6e66 6f20 666f      More info fo
-00011280: 7220 4f70 7475 6e61 202d 2068 7474 7073  r Optuna - https
-00011290: 3a2f 2f6f 7074 756e 612e 7265 6164 7468  ://optuna.readth
-000112a0: 6564 6f63 732e 696f 2f65 6e2f 7374 6162  edocs.io/en/stab
-000112b0: 6c65 2f72 6566 6572 656e 6365 2f70 7275  le/reference/pru
-000112c0: 6e65 7273 2e68 746d 6c0a 2020 2020 2020  ners.html.      
-000112d0: 2020 2020 2020 4d6f 7265 2069 6e66 6f20        More info 
-000112e0: 666f 7220 5261 7920 5475 6e65 2028 7475  for Ray Tune (tu
-000112f0: 6e65 2d73 6b6c 6561 726e 2920 2d20 6874  ne-sklearn) - ht
-00011300: 7470 733a 2f2f 646f 6373 2e72 6179 2e69  tps://docs.ray.i
-00011310: 6f2f 656e 2f6d 6173 7465 722f 7475 6e65  o/en/master/tune
-00011320: 2f61 7069 5f64 6f63 732f 7363 6865 6475  /api_docs/schedu
-00011330: 6c65 7273 2e68 746d 6c0a 0a20 2020 2020  lers.html..     
-00011340: 2020 2065 6172 6c79 5f73 746f 7070 696e     early_stoppin
-00011350: 675f 6d61 785f 6974 6572 733a 2069 6e74  g_max_iters: int
-00011360: 2c20 6465 6661 756c 7420 3d20 3130 0a20  , default = 10. 
-00011370: 2020 2020 2020 2020 2020 204d 6178 696d             Maxim
-00011380: 756d 206e 756d 6265 7220 6f66 2065 706f  um number of epo
-00011390: 6368 7320 746f 2072 756e 2066 6f72 2065  chs to run for e
-000113a0: 6163 6820 7361 6d70 6c65 6420 636f 6e66  ach sampled conf
-000113b0: 6967 7572 6174 696f 6e2e 0a20 2020 2020  iguration..     
-000113c0: 2020 2020 2020 2049 676e 6f72 6564 2069         Ignored i
-000113d0: 6620 6561 726c 795f 7374 6f70 7069 6e67  f early_stopping
-000113e0: 2069 7320 4661 6c73 6520 6f72 204e 6f6e   is False or Non
-000113f0: 652e 0a0a 2020 2020 2020 2020 6368 6f6f  e...        choo
-00011400: 7365 5f62 6574 7465 723a 2062 6f6f 6c2c  se_better: bool,
-00011410: 2064 6566 6175 6c74 203d 2046 616c 7365   default = False
-00011420: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
-00011430: 6e20 7365 7420 746f 2073 6574 2074 6f20  n set to set to 
-00011440: 5472 7565 2c20 6261 7365 2065 7374 696d  True, base estim
-00011450: 6174 6f72 2069 7320 7265 7475 726e 6564  ator is returned
-00011460: 2077 6865 6e20 7468 6520 7065 7266 6f72   when the perfor
-00011470: 6d61 6e63 6520 646f 6573 6e27 740a 2020  mance doesn't.  
-00011480: 2020 2020 2020 2020 2020 696d 7072 6f76            improv
-00011490: 6520 6279 2074 756e 655f 6d6f 6465 6c2e  e by tune_model.
-000114a0: 2054 6869 7320 6775 6172 616e 7465 6573   This guarantees
-000114b0: 2074 6865 2072 6574 7572 6e65 6420 6f62   the returned ob
-000114c0: 6a65 6374 2077 6f75 6c64 2070 6572 666f  ject would perfo
-000114d0: 726d 2061 7420 6c65 6173 740a 2020 2020  rm at least.    
-000114e0: 2020 2020 2020 2020 6571 7569 7661 6c65          equivale
-000114f0: 6e74 2074 6f20 6261 7365 2065 7374 696d  nt to base estim
-00011500: 6174 6f72 2063 7265 6174 6564 2075 7369  ator created usi
-00011510: 6e67 2063 7265 6174 655f 6d6f 6465 6c20  ng create_model 
-00011520: 6f72 206d 6f64 656c 2072 6574 7572 6e65  or model returne
-00011530: 6420 6279 0a20 2020 2020 2020 2020 2020  d by.           
-00011540: 2063 6f6d 7061 7265 5f6d 6f64 656c 732e   compare_models.
-00011550: 0a0a 2020 2020 2020 2020 6669 745f 6b77  ..        fit_kw
-00011560: 6172 6773 3a20 6469 6374 2c20 6465 6661  args: dict, defa
-00011570: 756c 7420 3d20 7b7d 2028 656d 7074 7920  ult = {} (empty 
-00011580: 6469 6374 290a 2020 2020 2020 2020 2020  dict).          
-00011590: 2020 4469 6374 696f 6e61 7279 206f 6620    Dictionary of 
-000115a0: 6172 6775 6d65 6e74 7320 7061 7373 6564  arguments passed
-000115b0: 2074 6f20 7468 6520 6669 7420 6d65 7468   to the fit meth
-000115c0: 6f64 206f 6620 7468 6520 7475 6e65 722e  od of the tuner.
-000115d0: 0a0a 2020 2020 2020 2020 6772 6f75 7073  ..        groups
-000115e0: 3a20 7374 7220 6f72 2061 7272 6179 2d6c  : str or array-l
-000115f0: 696b 652c 2077 6974 6820 7368 6170 6520  ike, with shape 
-00011600: 286e 5f73 616d 706c 6573 2c29 2c20 6465  (n_samples,), de
-00011610: 6661 756c 7420 3d20 4e6f 6e65 0a20 2020  fault = None.   
-00011620: 2020 2020 2020 2020 204f 7074 696f 6e61           Optiona
-00011630: 6c20 4772 6f75 7020 6c61 6265 6c73 2066  l Group labels f
-00011640: 6f72 2074 6865 2073 616d 706c 6573 2075  or the samples u
-00011650: 7365 6420 7768 696c 6520 7370 6c69 7474  sed while splitt
-00011660: 696e 6720 7468 6520 6461 7461 7365 7420  ing the dataset 
-00011670: 696e 746f 2074 7261 696e 2f74 6573 7420  into train/test 
-00011680: 7365 742e 0a20 2020 2020 2020 2020 2020  set..           
-00011690: 2049 6620 7374 7269 6e67 2069 7320 7061   If string is pa
-000116a0: 7373 6564 2c20 7769 6c6c 2075 7365 2074  ssed, will use t
-000116b0: 6865 2064 6174 6120 636f 6c75 6d6e 2077  he data column w
-000116c0: 6974 6820 7468 6174 206e 616d 6520 6173  ith that name as
-000116d0: 2074 6865 2067 726f 7570 732e 0a20 2020   the groups..   
-000116e0: 2020 2020 2020 2020 204f 6e6c 7920 7573           Only us
-000116f0: 6564 2069 6620 6120 6772 6f75 7020 6261  ed if a group ba
-00011700: 7365 6420 6372 6f73 732d 7661 6c69 6461  sed cross-valida
-00011710: 7469 6f6e 2067 656e 6572 6174 6f72 2069  tion generator i
-00011720: 7320 7573 6564 2028 6567 2e20 4772 6f75  s used (eg. Grou
-00011730: 704b 466f 6c64 292e 0a20 2020 2020 2020  pKFold)..       
-00011740: 2020 2020 2049 6620 4e6f 6e65 2c20 7769       If None, wi
-00011750: 6c6c 2075 7365 2074 6865 2076 616c 7565  ll use the value
-00011760: 2073 6574 2069 6e20 666f 6c64 5f67 726f   set in fold_gro
-00011770: 7570 7320 7061 7261 6d65 7465 7220 696e  ups parameter in
-00011780: 2073 6574 7570 2829 2e0a 0a20 2020 2020   setup()...     
-00011790: 2020 2072 6574 7572 6e5f 7475 6e65 723a     return_tuner:
-000117a0: 2062 6f6f 6c2c 2064 6566 6175 6c74 203d   bool, default =
-000117b0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-000117c0: 2020 2049 6620 5472 7565 2c20 7769 6c6c     If True, will
-000117d0: 2072 6574 7572 6e20 6120 7475 706c 6520   return a tuple 
-000117e0: 6f66 2028 6d6f 6465 6c2c 2074 756e 6572  of (model, tuner
-000117f0: 5f6f 626a 6563 7429 2e20 4f74 6865 7277  _object). Otherw
-00011800: 6973 652c 0a20 2020 2020 2020 2020 2020  ise,.           
-00011810: 2077 696c 6c20 7265 7475 726e 206a 7573   will return jus
-00011820: 7420 7468 6520 6265 7374 206d 6f64 656c  t the best model
-00011830: 2e0a 0a20 2020 2020 2020 2076 6572 626f  ...        verbo
-00011840: 7365 3a20 626f 6f6c 2c20 6465 6661 756c  se: bool, defaul
-00011850: 7420 3d20 5472 7565 0a20 2020 2020 2020  t = True.       
-00011860: 2020 2020 2053 636f 7265 2067 7269 6420       Score grid 
-00011870: 6973 206e 6f74 2070 7269 6e74 6564 2077  is not printed w
-00011880: 6865 6e20 7665 7262 6f73 6520 6973 2073  hen verbose is s
-00011890: 6574 2074 6f20 4661 6c73 652e 0a0a 2020  et to False...  
-000118a0: 2020 2020 2020 7475 6e65 725f 7665 7262        tuner_verb
-000118b0: 6f73 653a 2062 6f6f 6c20 6f72 2069 6e2c  ose: bool or in,
-000118c0: 2064 6566 6175 6c74 203d 2054 7275 650a   default = True.
-000118d0: 2020 2020 2020 2020 2020 2020 4966 2054              If T
-000118e0: 7275 6520 6f72 2061 626f 7665 2030 2c20  rue or above 0, 
-000118f0: 7769 6c6c 2070 7269 6e74 206d 6573 7361  will print messa
-00011900: 6765 7320 6672 6f6d 2074 6865 2074 756e  ges from the tun
-00011910: 6572 2e20 4869 6768 6572 2076 616c 7565  er. Higher value
-00011920: 730a 2020 2020 2020 2020 2020 2020 7072  s.            pr
-00011930: 696e 7420 6d6f 7265 206d 6573 7361 6765  int more message
-00011940: 732e 2049 676e 6f72 6564 2069 6620 7665  s. Ignored if ve
-00011950: 7262 6f73 6520 7061 7261 6d65 7465 7220  rbose parameter 
-00011960: 6973 2046 616c 7365 2e0a 0a20 2020 2020  is False...     
-00011970: 2020 2072 6574 7572 6e5f 7472 6169 6e5f     return_train_
-00011980: 7363 6f72 653a 2062 6f6f 6c2c 2064 6566  score: bool, def
-00011990: 6175 6c74 203d 2046 616c 7365 0a20 2020  ault = False.   
-000119a0: 2020 2020 2020 2020 2049 6620 4661 6c73           If Fals
-000119b0: 652c 2072 6574 7572 6e73 2074 6865 2043  e, returns the C
-000119c0: 5620 5661 6c69 6461 7469 6f6e 2073 636f  V Validation sco
-000119d0: 7265 7320 6f6e 6c79 2e0a 2020 2020 2020  res only..      
-000119e0: 2020 2020 2020 4966 2054 7275 652c 2072        If True, r
-000119f0: 6574 7572 6e73 2074 6865 2043 5620 7472  eturns the CV tr
-00011a00: 6169 6e69 6e67 2073 636f 7265 7320 616c  aining scores al
-00011a10: 6f6e 6720 7769 7468 2074 6865 2043 5620  ong with the CV 
-00011a20: 7661 6c69 6461 7469 6f6e 2073 636f 7265  validation score
-00011a30: 732e 0a20 2020 2020 2020 2020 2020 2054  s..            T
-00011a40: 6869 7320 6973 2075 7365 6675 6c20 7768  his is useful wh
-00011a50: 656e 2074 6865 2075 7365 7220 7761 6e74  en the user want
-00011a60: 7320 746f 2064 6f20 6269 6173 2d76 6172  s to do bias-var
-00011a70: 6961 6e63 6520 7472 6164 656f 6666 2e20  iance tradeoff. 
-00011a80: 4120 6869 6768 2043 560a 2020 2020 2020  A high CV.      
-00011a90: 2020 2020 2020 7472 6169 6e69 6e67 2073        training s
-00011aa0: 636f 7265 2077 6974 6820 6120 6c6f 7720  core with a low 
-00011ab0: 636f 7272 6573 706f 6e64 696e 6720 4356  corresponding CV
-00011ac0: 2076 616c 6964 6174 696f 6e20 7363 6f72   validation scor
-00011ad0: 6520 696e 6469 6361 7465 7320 6f76 6572  e indicates over
-00011ae0: 6669 7474 696e 672e 0a0a 2020 2020 2020  fitting...      
-00011af0: 2020 2a2a 6b77 6172 6773 3a0a 2020 2020    **kwargs:.    
-00011b00: 2020 2020 2020 2020 4164 6469 7469 6f6e          Addition
-00011b10: 616c 206b 6579 776f 7264 2061 7267 756d  al keyword argum
-00011b20: 656e 7473 2074 6f20 7061 7373 2074 6f20  ents to pass to 
-00011b30: 7468 6520 6f70 7469 6d69 7a65 722e 0a0a  the optimizer...
-00011b40: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
-00011b50: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-00011b60: 2020 2020 2020 2020 7363 6f72 655f 6772          score_gr
-00011b70: 6964 0a20 2020 2020 2020 2020 2020 2041  id.            A
-00011b80: 2074 6162 6c65 2063 6f6e 7461 696e 696e   table containin
-00011b90: 6720 7468 6520 7363 6f72 6573 206f 6620  g the scores of 
-00011ba0: 7468 6520 6d6f 6465 6c20 6163 726f 7373  the model across
-00011bb0: 2074 6865 206b 666f 6c64 732e 0a20 2020   the kfolds..   
-00011bc0: 2020 2020 2020 2020 2053 636f 7269 6e67           Scoring
-00011bd0: 206d 6574 7269 6373 2075 7365 6420 6172   metrics used ar
-00011be0: 6520 4163 6375 7261 6379 2c20 4155 432c  e Accuracy, AUC,
-00011bf0: 2052 6563 616c 6c2c 2050 7265 6369 7369   Recall, Precisi
-00011c00: 6f6e 2c20 4631 2c0a 2020 2020 2020 2020  on, F1,.        
-00011c10: 2020 2020 4b61 7070 6120 616e 6420 4d43      Kappa and MC
-00011c20: 432e 204d 6561 6e20 616e 6420 7374 616e  C. Mean and stan
-00011c30: 6461 7264 2064 6576 6961 7469 6f6e 206f  dard deviation o
-00011c40: 6620 7468 6520 7363 6f72 6573 2061 6372  f the scores acr
-00011c50: 6f73 730a 2020 2020 2020 2020 2020 2020  oss.            
-00011c60: 7468 6520 666f 6c64 7320 6172 6520 616c  the folds are al
-00011c70: 736f 2072 6574 7572 6e65 642e 0a0a 2020  so returned...  
-00011c80: 2020 2020 2020 6d6f 6465 6c0a 2020 2020        model.    
-00011c90: 2020 2020 2020 2020 5472 6169 6e65 6420          Trained 
-00011ca0: 616e 6420 7475 6e65 6420 6d6f 6465 6c20  and tuned model 
-00011cb0: 6f62 6a65 6374 2e0a 0a20 2020 2020 2020  object...       
-00011cc0: 2074 756e 6572 5f6f 626a 6563 740a 2020   tuner_object.  
-00011cd0: 2020 2020 2020 2020 2020 4f6e 6c79 2069            Only i
-00011ce0: 6620 7265 7475 726e 5f74 756e 6572 2070  f return_tuner p
-00011cf0: 6172 616d 6574 6572 2069 7320 5472 7565  arameter is True
-00011d00: 2e20 5468 6520 6f62 6a65 6374 2075 7365  . The object use
-00011d10: 6420 666f 7220 7475 6e69 6e67 2e0a 0a20  d for tuning... 
-00011d20: 2020 2020 2020 204e 6f74 6573 0a20 2020         Notes.   
-00011d30: 2020 2020 202d 2d2d 2d2d 0a0a 2020 2020       -----..    
-00011d40: 2020 2020 2d20 4966 2061 2053 7461 636b      - If a Stack
-00011d50: 696e 6743 6c61 7373 6966 6965 7220 6973  ingClassifier is
-00011d60: 2070 6173 7365 642c 2074 6865 2068 7970   passed, the hyp
-00011d70: 6572 7061 7261 6d65 7465 7273 206f 6620  erparameters of 
-00011d80: 7468 6520 6d65 7461 206d 6f64 656c 2028  the meta model (
-00011d90: 6669 6e61 6c5f 6573 7469 6d61 746f 7229  final_estimator)
-00011da0: 0a20 2020 2020 2020 2077 696c 6c20 6265  .        will be
-00011db0: 2074 756e 6564 2e0a 0a20 2020 2020 2020   tuned...       
-00011dc0: 202d 2049 6620 6120 566f 7469 6e67 436c   - If a VotingCl
-00011dd0: 6173 7369 6669 6572 2069 7320 7061 7373  assifier is pass
-00011de0: 6564 2c20 7468 6520 7765 6967 6874 7320  ed, the weights 
-00011df0: 7769 6c6c 2062 6520 7475 6e65 642e 0a0a  will be tuned...
-00011e00: 2020 2020 2020 2020 5761 726e 696e 6773          Warnings
-00011e10: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00011e20: 2d0a 0a20 2020 2020 2020 202d 2055 7369  -..        - Usi
-00011e30: 6e67 2027 4772 6964 2720 7365 6172 6368  ng 'Grid' search
-00011e40: 2061 6c67 6f72 6974 686d 2077 6974 6820   algorithm with 
-00011e50: 6465 6661 756c 7420 7061 7261 6d65 7465  default paramete
-00011e60: 7220 6772 6964 7320 6d61 7920 7265 7375  r grids may resu
-00011e70: 6c74 2069 6e20 7665 7279 0a20 2020 2020  lt in very.     
-00011e80: 2020 206c 6f6e 6720 636f 6d70 7574 6174     long computat
-00011e90: 696f 6e2e 0a0a 0a20 2020 2020 2020 2022  ion....        "
-00011ea0: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
-00011eb0: 5f63 6865 636b 5f73 6574 7570 5f72 616e  _check_setup_ran
-00011ec0: 2829 0a0a 2020 2020 2020 2020 6675 6e63  ()..        func
-00011ed0: 7469 6f6e 5f70 6172 616d 735f 7374 7220  tion_params_str 
-00011ee0: 3d20 222c 2022 2e6a 6f69 6e28 5b66 227b  = ", ".join([f"{
-00011ef0: 6b7d 3d7b 767d 2220 666f 7220 6b2c 2076  k}={v}" for k, v
-00011f00: 2069 6e20 6c6f 6361 6c73 2829 2e69 7465   in locals().ite
-00011f10: 6d73 2829 5d29 0a0a 2020 2020 2020 2020  ms()])..        
-00011f20: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
-00011f30: 2822 496e 6974 6961 6c69 7a69 6e67 2074  ("Initializing t
-00011f40: 756e 655f 6d6f 6465 6c28 2922 290a 2020  une_model()").  
-00011f50: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
-00011f60: 722e 696e 666f 2866 2274 756e 655f 6d6f  r.info(f"tune_mo
-00011f70: 6465 6c28 7b66 756e 6374 696f 6e5f 7061  del({function_pa
-00011f80: 7261 6d73 5f73 7472 7d29 2229 0a0a 2020  rams_str})")..  
-00011f90: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
-00011fa0: 722e 696e 666f 2822 4368 6563 6b69 6e67  r.info("Checking
-00011fb0: 2065 7863 6570 7469 6f6e 7322 290a 0a20   exceptions").. 
-00011fc0: 2020 2020 2020 2023 2072 756e 5f74 696d         # run_tim
-00011fd0: 650a 2020 2020 2020 2020 7275 6e74 696d  e.        runtim
-00011fe0: 655f 7374 6172 7420 3d20 7469 6d65 2e74  e_start = time.t
-00011ff0: 696d 6528 290a 0a20 2020 2020 2020 2069  ime()..        i
-00012000: 6620 6e6f 7420 6669 745f 6b77 6172 6773  f not fit_kwargs
-00012010: 3a0a 2020 2020 2020 2020 2020 2020 6669  :.            fi
-00012020: 745f 6b77 6172 6773 203d 207b 7d0a 0a20  t_kwargs = {}.. 
-00012030: 2020 2020 2020 2023 2063 6865 636b 696e         # checkin
-00012040: 6720 6573 7469 6d61 746f 7220 6966 2073  g estimator if s
-00012050: 7472 696e 670a 2020 2020 2020 2020 6966  tring.        if
-00012060: 2074 7970 6528 6573 7469 6d61 746f 7229   type(estimator)
-00012070: 2069 7320 7374 723a 0a20 2020 2020 2020   is str:.       
-00012080: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00012090: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-000120a0: 2020 2020 2020 2254 6865 2062 6568 6176        "The behav
-000120b0: 696f 7220 6f66 2074 756e 655f 6d6f 6465  ior of tune_mode
-000120c0: 6c20 696e 2076 6572 7369 6f6e 2031 2e30  l in version 1.0
-000120d0: 2e31 2069 7320 6368 616e 6765 642e 2050  .1 is changed. P
-000120e0: 6c65 6173 6520 7061 7373 2074 7261 696e  lease pass train
-000120f0: 6564 206d 6f64 656c 206f 626a 6563 742e  ed model object.
-00012100: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-00012110: 0a20 2020 2020 2020 2023 2043 6865 636b  .        # Check
-00012120: 2066 6f72 2065 7374 696d 6174 6f72 0a20   for estimator. 
-00012130: 2020 2020 2020 2069 6620 6e6f 7420 6861         if not ha
-00012140: 7361 7474 7228 6573 7469 6d61 746f 722c  sattr(estimator,
-00012150: 2022 6669 7422 293a 0a20 2020 2020 2020   "fit"):.       
-00012160: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00012170: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00012180: 2020 2020 2020 2066 2245 7374 696d 6174         f"Estimat
-00012190: 6f72 207b 6573 7469 6d61 746f 727d 2064  or {estimator} d
-000121a0: 6f65 7320 6e6f 7420 6861 7665 2074 6865  oes not have the
-000121b0: 2072 6571 7569 7265 6420 6669 7428 2920   required fit() 
-000121c0: 6d65 7468 6f64 2e22 0a20 2020 2020 2020  method.".       
-000121d0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-000121e0: 2320 6368 6563 6b69 6e67 2066 6f6c 6420  # checking fold 
-000121f0: 7061 7261 6d65 7465 720a 2020 2020 2020  parameter.      
-00012200: 2020 6966 2066 6f6c 6420 6973 206e 6f74    if fold is not
-00012210: 204e 6f6e 6520 616e 6420 6e6f 7420 280a   None and not (.
-00012220: 2020 2020 2020 2020 2020 2020 7479 7065              type
-00012230: 2866 6f6c 6429 2069 7320 696e 7420 6f72  (fold) is int or
-00012240: 2069 735f 736b 6c65 6172 6e5f 6376 5f67   is_sklearn_cv_g
-00012250: 656e 6572 6174 6f72 2866 6f6c 6429 0a20  enerator(fold). 
-00012260: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-00012270: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00012280: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00012290: 2020 2020 2020 2022 666f 6c64 2070 6172         "fold par
-000122a0: 616d 6574 6572 206d 7573 7420 6265 2065  ameter must be e
-000122b0: 6974 6865 7220 4e6f 6e65 2c20 616e 2069  ither None, an i
-000122c0: 6e74 6567 6572 206f 7220 6120 7363 696b  nteger or a scik
-000122d0: 6974 2d6c 6561 726e 2063 6f6d 7061 7469  it-learn compati
-000122e0: 626c 6520 4356 2067 656e 6572 6174 6f72  ble CV generator
-000122f0: 206f 626a 6563 742e 220a 2020 2020 2020   object.".      
-00012300: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00012310: 2023 2063 6865 636b 696e 6720 726f 756e   # checking roun
-00012320: 6420 7061 7261 6d65 7465 720a 2020 2020  d parameter.    
-00012330: 2020 2020 6966 2074 7970 6528 726f 756e      if type(roun
-00012340: 6429 2069 7320 6e6f 7420 696e 743a 0a20  d) is not int:. 
-00012350: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00012360: 2054 7970 6545 7272 6f72 2822 526f 756e   TypeError("Roun
-00012370: 6420 7061 7261 6d65 7465 7220 6f6e 6c79  d parameter only
-00012380: 2061 6363 6570 7473 2069 6e74 6567 6572   accepts integer
-00012390: 2076 616c 7565 2e22 290a 0a20 2020 2020   value.")..     
-000123a0: 2020 2023 2063 6865 636b 696e 6720 6e5f     # checking n_
-000123b0: 6974 6572 2070 6172 616d 6574 6572 0a20  iter parameter. 
-000123c0: 2020 2020 2020 2069 6620 7479 7065 286e         if type(n
-000123d0: 5f69 7465 7229 2069 7320 6e6f 7420 696e  _iter) is not in
-000123e0: 743a 0a20 2020 2020 2020 2020 2020 2072  t:.            r
-000123f0: 6169 7365 2054 7970 6545 7272 6f72 2822  aise TypeError("
-00012400: 6e5f 6974 6572 2070 6172 616d 6574 6572  n_iter parameter
-00012410: 206f 6e6c 7920 6163 6365 7074 7320 696e   only accepts in
-00012420: 7465 6765 7220 7661 6c75 652e 2229 0a0a  teger value.")..
-00012430: 2020 2020 2020 2020 2320 6368 6563 6b69          # checki
-00012440: 6e67 2065 6172 6c79 5f73 746f 7070 696e  ng early_stoppin
-00012450: 6720 7061 7261 6d65 7465 720a 2020 2020  g parameter.    
-00012460: 2020 2020 706f 7373 6962 6c65 5f65 6172      possible_ear
-00012470: 6c79 5f73 746f 7070 696e 6720 3d20 5b22  ly_stopping = ["
-00012480: 6173 6861 222c 2022 4879 7065 7262 616e  asha", "Hyperban
-00012490: 6422 2c20 224d 6564 6961 6e22 5d0a 2020  d", "Median"].  
-000124a0: 2020 2020 2020 6966 2028 0a20 2020 2020        if (.     
-000124b0: 2020 2020 2020 2069 7369 6e73 7461 6e63         isinstanc
-000124c0: 6528 6561 726c 795f 7374 6f70 7069 6e67  e(early_stopping
-000124d0: 2c20 7374 7229 0a20 2020 2020 2020 2020  , str).         
-000124e0: 2020 2061 6e64 2065 6172 6c79 5f73 746f     and early_sto
-000124f0: 7070 696e 6720 6e6f 7420 696e 2070 6f73  pping not in pos
-00012500: 7369 626c 655f 6561 726c 795f 7374 6f70  sible_early_stop
-00012510: 7069 6e67 0a20 2020 2020 2020 2029 3a0a  ping.        ):.
-00012520: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00012530: 6520 5479 7065 4572 726f 7228 0a20 2020  e TypeError(.   
-00012540: 2020 2020 2020 2020 2020 2020 2066 2265               f"e
-00012550: 6172 6c79 5f73 746f 7070 696e 6720 7061  arly_stopping pa
-00012560: 7261 6d65 7465 7220 6d75 7374 2062 6520  rameter must be 
-00012570: 6f6e 6520 6f66 207b 272c 2027 2e6a 6f69  one of {', '.joi
-00012580: 6e28 706f 7373 6962 6c65 5f65 6172 6c79  n(possible_early
-00012590: 5f73 746f 7070 696e 6729 7d22 0a20 2020  _stopping)}".   
-000125a0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-000125b0: 2020 2020 2320 6368 6563 6b69 6e67 2065      # checking e
-000125c0: 6172 6c79 5f73 746f 7070 696e 675f 6d61  arly_stopping_ma
-000125d0: 785f 6974 6572 7320 7061 7261 6d65 7465  x_iters paramete
-000125e0: 720a 2020 2020 2020 2020 6966 2074 7970  r.        if typ
-000125f0: 6528 6561 726c 795f 7374 6f70 7069 6e67  e(early_stopping
-00012600: 5f6d 6178 5f69 7465 7273 2920 6973 206e  _max_iters) is n
-00012610: 6f74 2069 6e74 3a0a 2020 2020 2020 2020  ot int:.        
-00012620: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-00012630: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00012640: 2020 2020 2022 6561 726c 795f 7374 6f70       "early_stop
-00012650: 7069 6e67 5f6d 6178 5f69 7465 7273 2070  ping_max_iters p
-00012660: 6172 616d 6574 6572 206f 6e6c 7920 6163  arameter only ac
-00012670: 6365 7074 7320 696e 7465 6765 7220 7661  cepts integer va
-00012680: 6c75 652e 220a 2020 2020 2020 2020 2020  lue.".          
-00012690: 2020 290a 0a20 2020 2020 2020 2023 2063    )..        # c
-000126a0: 6865 636b 696e 6720 7265 7475 726e 5f74  hecking return_t
-000126b0: 7261 696e 5f73 636f 7265 2070 6172 616d  rain_score param
-000126c0: 6574 6572 0a20 2020 2020 2020 2069 6620  eter.        if 
-000126d0: 7479 7065 2872 6574 7572 6e5f 7472 6169  type(return_trai
-000126e0: 6e5f 7363 6f72 6529 2069 7320 6e6f 7420  n_score) is not 
-000126f0: 626f 6f6c 3a0a 2020 2020 2020 2020 2020  bool:.          
-00012700: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-00012710: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00012720: 2020 2022 7265 7475 726e 5f74 7261 696e     "return_train
-00012730: 5f73 636f 7265 2063 616e 206f 6e6c 7920  _score can only 
-00012740: 7461 6b65 2061 7267 756d 656e 7420 6173  take argument as
-00012750: 2054 7275 6520 6f72 2046 616c 7365 220a   True or False".
-00012760: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00012770: 2020 2020 2020 2023 2063 6865 636b 696e         # checkin
-00012780: 6720 7365 6172 6368 5f6c 6962 7261 7279  g search_library
-00012790: 2070 6172 616d 6574 6572 0a20 2020 2020   parameter.     
-000127a0: 2020 2070 6f73 7369 626c 655f 7365 6172     possible_sear
-000127b0: 6368 5f6c 6962 7261 7269 6573 203d 205b  ch_libraries = [
-000127c0: 0a20 2020 2020 2020 2020 2020 2022 7363  .            "sc
-000127d0: 696b 6974 2d6c 6561 726e 222c 0a20 2020  ikit-learn",.   
-000127e0: 2020 2020 2020 2020 2022 7363 696b 6974           "scikit
-000127f0: 2d6f 7074 696d 697a 6522 2c0a 2020 2020  -optimize",.    
-00012800: 2020 2020 2020 2020 2274 756e 652d 736b          "tune-sk
-00012810: 6c65 6172 6e22 2c0a 2020 2020 2020 2020  learn",.        
-00012820: 2020 2020 226f 7074 756e 6122 2c0a 2020      "optuna",.  
-00012830: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-00012840: 7365 6172 6368 5f6c 6962 7261 7279 203d  search_library =
-00012850: 2073 6561 7263 685f 6c69 6272 6172 792e   search_library.
-00012860: 6c6f 7765 7228 290a 2020 2020 2020 2020  lower().        
-00012870: 6966 2073 6561 7263 685f 6c69 6272 6172  if search_librar
-00012880: 7920 6e6f 7420 696e 2070 6f73 7369 626c  y not in possibl
-00012890: 655f 7365 6172 6368 5f6c 6962 7261 7269  e_search_librari
-000128a0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-000128b0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-000128c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000128d0: 2020 6622 7365 6172 6368 5f6c 6962 7261    f"search_libra
-000128e0: 7279 2070 6172 616d 6574 6572 206d 7573  ry parameter mus
-000128f0: 7420 6265 206f 6e65 206f 6620 7b27 2c20  t be one of {', 
-00012900: 272e 6a6f 696e 2870 6f73 7369 626c 655f  '.join(possible_
-00012910: 7365 6172 6368 5f6c 6962 7261 7269 6573  search_libraries
-00012920: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
-00012930: 290a 0a20 2020 2020 2020 2069 6620 7365  )..        if se
-00012940: 6172 6368 5f6c 6962 7261 7279 203d 3d20  arch_library == 
-00012950: 2273 6369 6b69 742d 6f70 7469 6d69 7a65  "scikit-optimize
-00012960: 223a 0a20 2020 2020 2020 2020 2020 205f  ":.            _
-00012970: 6368 6563 6b5f 736f 6674 5f64 6570 656e  check_soft_depen
-00012980: 6465 6e63 6965 7328 0a20 2020 2020 2020  dencies(.       
-00012990: 2020 2020 2020 2020 2022 736b 6f70 7422           "skopt"
-000129a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000129b0: 2020 6578 7472 613d 2274 756e 6572 7322    extra="tuners"
-000129c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000129d0: 2020 7365 7665 7269 7479 3d22 6572 726f    severity="erro
-000129e0: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
-000129f0: 2020 2020 696e 7374 616c 6c5f 6e61 6d65      install_name
-00012a00: 3d22 7363 696b 6974 2d6f 7074 696d 697a  ="scikit-optimiz
-00012a10: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-00012a20: 290a 2020 2020 2020 2020 2020 2020 696d  ).            im
-00012a30: 706f 7274 2073 6b6f 7074 0a0a 2020 2020  port skopt..    
-00012a40: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-00012a50: 6561 7263 685f 616c 676f 7269 7468 6d3a  earch_algorithm:
-00012a60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012a70: 2073 6561 7263 685f 616c 676f 7269 7468   search_algorith
-00012a80: 6d20 3d20 2262 6179 6573 6961 6e22 0a0a  m = "bayesian"..
-00012a90: 2020 2020 2020 2020 2020 2020 706f 7373              poss
-00012aa0: 6962 6c65 5f73 6561 7263 685f 616c 676f  ible_search_algo
-00012ab0: 7269 7468 6d73 203d 205b 2262 6179 6573  rithms = ["bayes
-00012ac0: 6961 6e22 5d0a 2020 2020 2020 2020 2020  ian"].          
-00012ad0: 2020 6966 2073 6561 7263 685f 616c 676f    if search_algo
-00012ae0: 7269 7468 6d20 6e6f 7420 696e 2070 6f73  rithm not in pos
-00012af0: 7369 626c 655f 7365 6172 6368 5f61 6c67  sible_search_alg
-00012b00: 6f72 6974 686d 733a 0a20 2020 2020 2020  orithms:.       
-00012b10: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00012b20: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-00012b30: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00012b40: 2246 6f72 2027 7363 696b 6974 2d6f 7074  "For 'scikit-opt
-00012b50: 696d 697a 6527 2073 6561 7263 685f 616c  imize' search_al
-00012b60: 676f 7269 7468 6d20 7061 7261 6d65 7465  gorithm paramete
-00012b70: 7220 6d75 7374 2062 6520 6f6e 6520 6f66  r must be one of
-00012b80: 207b 272c 2027 2e6a 6f69 6e28 706f 7373   {', '.join(poss
-00012b90: 6962 6c65 5f73 6561 7263 685f 616c 676f  ible_search_algo
-00012ba0: 7269 7468 6d73 297d 220a 2020 2020 2020  rithms)}".      
-00012bb0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00012bc0: 2020 2020 2065 6c69 6620 7365 6172 6368       elif search
-00012bd0: 5f6c 6962 7261 7279 203d 3d20 2274 756e  _library == "tun
-00012be0: 652d 736b 6c65 6172 6e22 3a0a 2020 2020  e-sklearn":.    
-00012bf0: 2020 2020 2020 2020 5f63 6865 636b 5f73          _check_s
-00012c00: 6f66 745f 6465 7065 6e64 656e 6369 6573  oft_dependencies
-00012c10: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00012c20: 2020 2274 756e 655f 736b 6c65 6172 6e22    "tune_sklearn"
-00012c30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00012c40: 2020 6578 7472 613d 2274 756e 6572 7322    extra="tuners"
-00012c50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00012c60: 2020 7365 7665 7269 7479 3d22 6572 726f    severity="erro
-00012c70: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
-00012c80: 2020 2020 696e 7374 616c 6c5f 6e61 6d65      install_name
-00012c90: 3d22 7475 6e65 2d73 6b6c 6561 726e 2072  ="tune-sklearn r
-00012ca0: 6179 5b74 756e 655d 222c 0a20 2020 2020  ay[tune]",.     
-00012cb0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00012cc0: 2020 2020 2020 6966 206e 6f74 2073 6561        if not sea
-00012cd0: 7263 685f 616c 676f 7269 7468 6d3a 0a20  rch_algorithm:. 
-00012ce0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00012cf0: 6561 7263 685f 616c 676f 7269 7468 6d20  earch_algorithm 
-00012d00: 3d20 2272 616e 646f 6d22 0a0a 2020 2020  = "random"..    
-00012d10: 2020 2020 2020 2020 706f 7373 6962 6c65          possible
-00012d20: 5f73 6561 7263 685f 616c 676f 7269 7468  _search_algorith
-00012d30: 6d73 203d 205b 0a20 2020 2020 2020 2020  ms = [.         
-00012d40: 2020 2020 2020 2022 7261 6e64 6f6d 222c         "random",
-00012d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012d60: 2022 6772 6964 222c 0a20 2020 2020 2020   "grid",.       
-00012d70: 2020 2020 2020 2020 2022 6261 7965 7369           "bayesi
-00012d80: 616e 222c 0a20 2020 2020 2020 2020 2020  an",.           
-00012d90: 2020 2020 2022 6879 7065 726f 7074 222c       "hyperopt",
-00012da0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012db0: 2022 6f70 7475 6e61 222c 0a20 2020 2020   "optuna",.     
-00012dc0: 2020 2020 2020 2020 2020 2022 626f 6862             "bohb
-00012dd0: 222c 0a20 2020 2020 2020 2020 2020 205d  ",.            ]
-00012de0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00012df0: 7365 6172 6368 5f61 6c67 6f72 6974 686d  search_algorithm
-00012e00: 206e 6f74 2069 6e20 706f 7373 6962 6c65   not in possible
-00012e10: 5f73 6561 7263 685f 616c 676f 7269 7468  _search_algorith
-00012e20: 6d73 3a0a 2020 2020 2020 2020 2020 2020  ms:.            
-00012e30: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00012e40: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00012e50: 2020 2020 2020 2020 2020 6622 466f 7220            f"For 
-00012e60: 2774 756e 652d 736b 6c65 6172 6e27 2073  'tune-sklearn' s
-00012e70: 6561 7263 685f 616c 676f 7269 7468 6d20  earch_algorithm 
-00012e80: 7061 7261 6d65 7465 7220 6d75 7374 2062  parameter must b
-00012e90: 6520 6f6e 6520 6f66 207b 272c 2027 2e6a  e one of {', '.j
-00012ea0: 6f69 6e28 706f 7373 6962 6c65 5f73 6561  oin(possible_sea
-00012eb0: 7263 685f 616c 676f 7269 7468 6d73 297d  rch_algorithms)}
-00012ec0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00012ed0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-00012ee0: 2069 6620 7365 6172 6368 5f61 6c67 6f72   if search_algor
-00012ef0: 6974 686d 203d 3d20 2262 6f68 6222 3a0a  ithm == "bohb":.
-00012f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012f10: 5f63 6865 636b 5f73 6f66 745f 6465 7065  _check_soft_depe
-00012f20: 6e64 656e 6369 6573 2822 436f 6e66 6967  ndencies("Config
-00012f30: 5370 6163 6522 2c20 6578 7472 613d 4e6f  Space", extra=No
-00012f40: 6e65 2c20 7365 7665 7269 7479 3d22 6572  ne, severity="er
-00012f50: 726f 7222 290a 2020 2020 2020 2020 2020  ror").          
-00012f60: 2020 2020 2020 5f63 6865 636b 5f73 6f66        _check_sof
-00012f70: 745f 6465 7065 6e64 656e 6369 6573 2822  t_dependencies("
-00012f80: 6870 6261 6e64 7374 6572 222c 2065 7874  hpbandster", ext
-00012f90: 7261 3d4e 6f6e 652c 2073 6576 6572 6974  ra=None, severit
-00012fa0: 793d 2265 7272 6f72 2229 0a20 2020 2020  y="error").     
-00012fb0: 2020 2020 2020 2020 2020 205f 6368 6563             _chec
-00012fc0: 6b5f 736f 6674 5f64 6570 656e 6465 6e63  k_soft_dependenc
-00012fd0: 6965 7328 0a20 2020 2020 2020 2020 2020  ies(.           
-00012fe0: 2020 2020 2020 2020 2022 7261 7922 2c20           "ray", 
-00012ff0: 6578 7472 613d 2274 756e 6572 7322 2c20  extra="tuners", 
-00013000: 7365 7665 7269 7479 3d22 6572 726f 7222  severity="error"
-00013010: 2c20 696e 7374 616c 6c5f 6e61 6d65 3d22  , install_name="
-00013020: 7261 795b 7475 6e65 5d22 0a20 2020 2020  ray[tune]".     
-00013030: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00013040: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-00013050: 6561 7263 685f 616c 676f 7269 7468 6d20  earch_algorithm 
-00013060: 3d3d 2022 6879 7065 726f 7074 223a 0a20  == "hyperopt":. 
-00013070: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-00013080: 6368 6563 6b5f 736f 6674 5f64 6570 656e  check_soft_depen
-00013090: 6465 6e63 6965 7328 2268 7970 6572 6f70  dencies("hyperop
-000130a0: 7422 2c20 6578 7472 613d 2274 756e 6572  t", extra="tuner
-000130b0: 7322 2c20 7365 7665 7269 7479 3d22 6572  s", severity="er
-000130c0: 726f 7222 290a 2020 2020 2020 2020 2020  ror").          
-000130d0: 2020 2020 2020 5f63 6865 636b 5f73 6f66        _check_sof
-000130e0: 745f 6465 7065 6e64 656e 6369 6573 280a  t_dependencies(.
-000130f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013100: 2020 2020 2272 6179 222c 2065 7874 7261      "ray", extra
-00013110: 3d22 7475 6e65 7273 222c 2073 6576 6572  ="tuners", sever
-00013120: 6974 793d 2265 7272 6f72 222c 2069 6e73  ity="error", ins
-00013130: 7461 6c6c 5f6e 616d 653d 2272 6179 5b74  tall_name="ray[t
-00013140: 756e 655d 220a 2020 2020 2020 2020 2020  une]".          
-00013150: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00013160: 2020 2020 2065 6c69 6620 7365 6172 6368       elif search
-00013170: 5f61 6c67 6f72 6974 686d 203d 3d20 2262  _algorithm == "b
-00013180: 6179 6573 6961 6e22 3a0a 2020 2020 2020  ayesian":.      
-00013190: 2020 2020 2020 2020 2020 5f63 6865 636b            _check
-000131a0: 5f73 6f66 745f 6465 7065 6e64 656e 6369  _soft_dependenci
-000131b0: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
-000131c0: 2020 2020 2020 2020 2273 6b6f 7074 222c          "skopt",
-000131d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000131e0: 2020 2020 2065 7874 7261 3d22 7475 6e65       extra="tune
-000131f0: 7273 222c 0a20 2020 2020 2020 2020 2020  rs",.           
-00013200: 2020 2020 2020 2020 2073 6576 6572 6974           severit
-00013210: 793d 2265 7272 6f72 222c 0a20 2020 2020  y="error",.     
-00013220: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00013230: 6e73 7461 6c6c 5f6e 616d 653d 2273 6369  nstall_name="sci
-00013240: 6b69 742d 6f70 7469 6d69 7a65 222c 0a20  kit-optimize",. 
-00013250: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00013260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013270: 2069 6d70 6f72 7420 736b 6f70 740a 0a20   import skopt.. 
-00013280: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00013290: 7365 6172 6368 5f61 6c67 6f72 6974 686d  search_algorithm
-000132a0: 203d 3d20 226f 7074 756e 6122 3a0a 2020   == "optuna":.  
-000132b0: 2020 2020 2020 2020 2020 2020 2020 5f63                _c
-000132c0: 6865 636b 5f73 6f66 745f 6465 7065 6e64  heck_soft_depend
-000132d0: 656e 6369 6573 2822 6f70 7475 6e61 222c  encies("optuna",
-000132e0: 2065 7874 7261 3d22 7475 6e65 7273 222c   extra="tuners",
-000132f0: 2073 6576 6572 6974 793d 2265 7272 6f72   severity="error
-00013300: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-00013310: 2020 2069 6d70 6f72 7420 6f70 7475 6e61     import optuna
-00013320: 0a0a 2020 2020 2020 2020 656c 6966 2073  ..        elif s
-00013330: 6561 7263 685f 6c69 6272 6172 7920 3d3d  earch_library ==
-00013340: 2022 6f70 7475 6e61 223a 0a20 2020 2020   "optuna":.     
-00013350: 2020 2020 2020 205f 6368 6563 6b5f 736f         _check_so
-00013360: 6674 5f64 6570 656e 6465 6e63 6965 7328  ft_dependencies(
-00013370: 226f 7074 756e 6122 2c20 6578 7472 613d  "optuna", extra=
-00013380: 2274 756e 6572 7322 2c20 7365 7665 7269  "tuners", severi
-00013390: 7479 3d22 6572 726f 7222 290a 2020 2020  ty="error").    
-000133a0: 2020 2020 2020 2020 696d 706f 7274 206f          import o
-000133b0: 7074 756e 610a 0a20 2020 2020 2020 2020  ptuna..         
-000133c0: 2020 2069 6620 6e6f 7420 7365 6172 6368     if not search
-000133d0: 5f61 6c67 6f72 6974 686d 3a0a 2020 2020  _algorithm:.    
-000133e0: 2020 2020 2020 2020 2020 2020 7365 6172              sear
-000133f0: 6368 5f61 6c67 6f72 6974 686d 203d 2022  ch_algorithm = "
-00013400: 7470 6522 0a0a 2020 2020 2020 2020 2020  tpe"..          
-00013410: 2020 706f 7373 6962 6c65 5f73 6561 7263    possible_searc
-00013420: 685f 616c 676f 7269 7468 6d73 203d 205b  h_algorithms = [
-00013430: 2272 616e 646f 6d22 2c20 2274 7065 225d  "random", "tpe"]
-00013440: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00013450: 7365 6172 6368 5f61 6c67 6f72 6974 686d  search_algorithm
-00013460: 206e 6f74 2069 6e20 706f 7373 6962 6c65   not in possible
-00013470: 5f73 6561 7263 685f 616c 676f 7269 7468  _search_algorith
-00013480: 6d73 3a0a 2020 2020 2020 2020 2020 2020  ms:.            
-00013490: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-000134a0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-000134b0: 2020 2020 2020 2020 2020 6622 466f 7220            f"For 
-000134c0: 276f 7074 756e 6127 2073 6561 7263 685f  'optuna' search_
-000134d0: 616c 676f 7269 7468 6d20 7061 7261 6d65  algorithm parame
-000134e0: 7465 7220 6d75 7374 2062 6520 6f6e 6520  ter must be one 
-000134f0: 6f66 207b 272c 2027 2e6a 6f69 6e28 706f  of {', '.join(po
-00013500: 7373 6962 6c65 5f73 6561 7263 685f 616c  ssible_search_al
-00013510: 676f 7269 7468 6d73 297d 220a 2020 2020  gorithms)}".    
-00013520: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00013530: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00013540: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-00013550: 6561 7263 685f 616c 676f 7269 7468 6d3a  earch_algorithm:
-00013560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013570: 2073 6561 7263 685f 616c 676f 7269 7468   search_algorith
-00013580: 6d20 3d20 2272 616e 646f 6d22 0a0a 2020  m = "random"..  
-00013590: 2020 2020 2020 2020 2020 706f 7373 6962            possib
-000135a0: 6c65 5f73 6561 7263 685f 616c 676f 7269  le_search_algori
-000135b0: 7468 6d73 203d 205b 2272 616e 646f 6d22  thms = ["random"
-000135c0: 2c20 2267 7269 6422 5d0a 2020 2020 2020  , "grid"].      
-000135d0: 2020 2020 2020 6966 2073 6561 7263 685f        if search_
-000135e0: 616c 676f 7269 7468 6d20 6e6f 7420 696e  algorithm not in
-000135f0: 2070 6f73 7369 626c 655f 7365 6172 6368   possible_search
-00013600: 5f61 6c67 6f72 6974 686d 733a 0a20 2020  _algorithms:.   
-00013610: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00013620: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-00013630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013640: 2020 2066 2246 6f72 2027 7363 696b 6974     f"For 'scikit
-00013650: 2d6c 6561 726e 2720 7365 6172 6368 5f61  -learn' search_a
-00013660: 6c67 6f72 6974 686d 2070 6172 616d 6574  lgorithm paramet
-00013670: 6572 206d 7573 7420 6265 206f 6e65 206f  er must be one o
-00013680: 6620 7b27 2c20 272e 6a6f 696e 2870 6f73  f {', '.join(pos
-00013690: 7369 626c 655f 7365 6172 6368 5f61 6c67  sible_search_alg
-000136a0: 6f72 6974 686d 7329 7d22 0a20 2020 2020  orithms)}".     
-000136b0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-000136c0: 2020 2020 2020 6966 2063 7573 746f 6d5f        if custom_
-000136d0: 7363 6f72 6572 2069 7320 6e6f 7420 4e6f  scorer is not No
-000136e0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-000136f0: 6f70 7469 6d69 7a65 203d 2063 7573 746f  optimize = custo
-00013700: 6d5f 7363 6f72 6572 0a20 2020 2020 2020  m_scorer.       
-00013710: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-00013720: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
-00013730: 2020 2020 2263 7573 746f 6d5f 7363 6f72      "custom_scor
-00013740: 6572 2070 6172 616d 6574 6572 2077 696c  er parameter wil
-00013750: 6c20 6265 2064 6570 7265 6369 6174 6564  l be depreciated
-00013760: 2c20 7573 6520 6f70 7469 6d69 7a65 2069  , use optimize i
-00013770: 6e73 7465 6164 222c 0a20 2020 2020 2020  nstead",.       
-00013780: 2020 2020 2020 2020 2044 6570 7265 6361           Depreca
-00013790: 7469 6f6e 5761 726e 696e 672c 0a20 2020  tionWarning,.   
-000137a0: 2020 2020 2020 2020 2020 2020 2073 7461               sta
-000137b0: 636b 6c65 7665 6c3d 322c 0a20 2020 2020  cklevel=2,.     
-000137c0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-000137d0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-000137e0: 6f70 7469 6d69 7a65 2c20 7374 7229 3a0a  optimize, str):.
-000137f0: 2020 2020 2020 2020 2020 2020 2320 6368              # ch
-00013800: 6563 6b69 6e67 206f 7074 696d 697a 6520  ecking optimize 
-00013810: 7061 7261 6d65 7465 720a 2020 2020 2020  parameter.      
-00013820: 2020 2020 2020 6f70 7469 6d69 7a65 203d        optimize =
-00013830: 2073 656c 662e 5f67 6574 5f6d 6574 7269   self._get_metri
-00013840: 635f 6279 5f6e 616d 655f 6f72 5f69 6428  c_by_name_or_id(
-00013850: 6f70 7469 6d69 7a65 290a 2020 2020 2020  optimize).      
-00013860: 2020 2020 2020 6966 206f 7074 696d 697a        if optimiz
-00013870: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-00013880: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00013890: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-000138a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000138b0: 2022 4f70 7469 6d69 7a65 206d 6574 686f   "Optimize metho
-000138c0: 6420 6e6f 7420 7375 7070 6f72 7465 642e  d not supported.
-000138d0: 2053 6565 2064 6f63 7374 7269 6e67 2066   See docstring f
-000138e0: 6f72 206c 6973 7420 6f66 2061 7661 696c  or list of avail
-000138f0: 6162 6c65 2070 6172 616d 6574 6572 732e  able parameters.
-00013900: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00013910: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-00013920: 2023 2063 6865 636b 696e 6720 6f70 7469   # checking opti
-00013930: 6d69 7a65 2070 6172 616d 6574 6572 2066  mize parameter f
-00013940: 6f72 206d 756c 7469 636c 6173 730a 2020  or multiclass.  
-00013950: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00013960: 662e 6973 5f6d 756c 7469 636c 6173 733a  f.is_multiclass:
-00013970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013980: 2069 6620 6e6f 7420 6f70 7469 6d69 7a65   if not optimize
-00013990: 2e69 735f 6d75 6c74 6963 6c61 7373 3a0a  .is_multiclass:.
-000139a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000139b0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-000139c0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-000139d0: 2020 2020 2020 2020 2020 2020 2022 4f70               "Op
-000139e0: 7469 6d69 7a61 7469 6f6e 206d 6574 7269  timization metri
-000139f0: 6320 6e6f 7420 7375 7070 6f72 7465 6420  c not supported 
-00013a00: 666f 7220 6d75 6c74 6963 6c61 7373 2070  for multiclass p
-00013a10: 726f 626c 656d 732e 2053 6565 2064 6f63  roblems. See doc
-00013a20: 7374 7269 6e67 2066 6f72 206c 6973 7420  string for list 
-00013a30: 6f66 206f 7468 6572 206f 7074 696d 697a  of other optimiz
-00013a40: 6174 696f 6e20 7061 7261 6d65 7465 7273  ation parameters
-00013a50: 2e22 0a20 2020 2020 2020 2020 2020 2020  .".             
-00013a60: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00013a70: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00013a80: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
-00013a90: 6e66 6f28 6622 6f70 7469 6d69 7a65 2073  nfo(f"optimize s
-00013aa0: 6574 2074 6f20 7573 6572 2064 6566 696e  et to user defin
-00013ab0: 6564 2066 756e 6374 696f 6e20 7b6f 7074  ed function {opt
-00013ac0: 696d 697a 657d 2229 0a0a 2020 2020 2020  imize}")..      
-00013ad0: 2020 2320 6368 6563 6b69 6e67 2076 6572    # checking ver
-00013ae0: 626f 7365 2070 6172 616d 6574 6572 0a20  bose parameter. 
-00013af0: 2020 2020 2020 2069 6620 7479 7065 2876         if type(v
-00013b00: 6572 626f 7365 2920 6973 206e 6f74 2062  erbose) is not b
-00013b10: 6f6f 6c3a 0a20 2020 2020 2020 2020 2020  ool:.           
-00013b20: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-00013b30: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00013b40: 2020 2276 6572 626f 7365 2070 6172 616d    "verbose param
-00013b50: 6574 6572 2063 616e 206f 6e6c 7920 7461  eter can only ta
-00013b60: 6b65 2061 7267 756d 656e 7420 6173 2054  ke argument as T
-00013b70: 7275 6520 6f72 2046 616c 7365 2e22 0a20  rue or False.". 
-00013b80: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00013b90: 2020 2020 2020 2320 6368 6563 6b69 6e67        # checking
-00013ba0: 2076 6572 626f 7365 2070 6172 616d 6574   verbose paramet
-00013bb0: 6572 0a20 2020 2020 2020 2069 6620 7479  er.        if ty
-00013bc0: 7065 2872 6574 7572 6e5f 7475 6e65 7229  pe(return_tuner)
-00013bd0: 2069 7320 6e6f 7420 626f 6f6c 3a0a 2020   is not bool:.  
-00013be0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00013bf0: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
-00013c00: 2020 2020 2020 2020 2020 2022 7265 7475             "retu
-00013c10: 726e 5f74 756e 6572 2070 6172 616d 6574  rn_tuner paramet
-00013c20: 6572 2063 616e 206f 6e6c 7920 7461 6b65  er can only take
-00013c30: 2061 7267 756d 656e 7420 6173 2054 7275   argument as Tru
-00013c40: 6520 6f72 2046 616c 7365 2e22 0a20 2020  e or False.".   
-00013c50: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00013c60: 2020 2020 6966 206e 6f74 2076 6572 626f      if not verbo
-00013c70: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00013c80: 7475 6e65 725f 7665 7262 6f73 6520 3d20  tuner_verbose = 
-00013c90: 300a 0a20 2020 2020 2020 2069 6620 7479  0..        if ty
-00013ca0: 7065 2874 756e 6572 5f76 6572 626f 7365  pe(tuner_verbose
-00013cb0: 2920 6e6f 7420 696e 2028 626f 6f6c 2c20  ) not in (bool, 
-00013cc0: 696e 7429 3a0a 2020 2020 2020 2020 2020  int):.          
-00013cd0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-00013ce0: 7228 2274 756e 6572 5f76 6572 626f 7365  r("tuner_verbose
-00013cf0: 2070 6172 616d 6574 6572 206d 7573 7420   parameter must 
-00013d00: 6265 2061 2062 6f6f 6c20 6f72 2061 6e20  be a bool or an 
-00013d10: 696e 742e 2229 0a0a 2020 2020 2020 2020  int.")..        
-00013d20: 7475 6e65 725f 7665 7262 6f73 6520 3d20  tuner_verbose = 
-00013d30: 696e 7428 7475 6e65 725f 7665 7262 6f73  int(tuner_verbos
-00013d40: 6529 0a0a 2020 2020 2020 2020 6966 2074  e)..        if t
-00013d50: 756e 6572 5f76 6572 626f 7365 203c 2030  uner_verbose < 0
-00013d60: 3a0a 2020 2020 2020 2020 2020 2020 7475  :.            tu
-00013d70: 6e65 725f 7665 7262 6f73 6520 3d20 300a  ner_verbose = 0.
-00013d80: 2020 2020 2020 2020 656c 6966 2074 756e          elif tun
-00013d90: 6572 5f76 6572 626f 7365 203e 2032 3a0a  er_verbose > 2:.
-00013da0: 2020 2020 2020 2020 2020 2020 7475 6e65              tune
-00013db0: 725f 7665 7262 6f73 6520 3d20 320a 0a20  r_verbose = 2.. 
-00013dc0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-00013dd0: 2020 2020 4552 524f 5220 4841 4e44 4c49      ERROR HANDLI
-00013de0: 4e47 2045 4e44 5320 4845 5245 0a0a 2020  NG ENDS HERE..  
-00013df0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00013e00: 2020 2066 6f6c 6420 3d20 7365 6c66 2e5f     fold = self._
-00013e10: 6765 745f 6376 5f73 706c 6974 7465 7228  get_cv_splitter(
-00013e20: 666f 6c64 290a 0a20 2020 2020 2020 2067  fold)..        g
-00013e30: 726f 7570 7320 3d20 7365 6c66 2e5f 6765  roups = self._ge
-00013e40: 745f 6772 6f75 7073 2867 726f 7570 7329  t_groups(groups)
-00013e50: 0a0a 2020 2020 2020 2020 7072 6f67 7265  ..        progre
-00013e60: 7373 5f61 7267 7320 3d20 7b22 6d61 7822  ss_args = {"max"
-00013e70: 3a20 3320 2b20 347d 0a20 2020 2020 2020  : 3 + 4}.       
-00013e80: 2074 696d 6573 7461 6d70 5374 7220 3d20   timestampStr = 
-00013e90: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-00013ea0: 652e 6e6f 7728 292e 7374 7266 7469 6d65  e.now().strftime
-00013eb0: 2822 2548 3a25 4d3a 2553 2229 0a20 2020  ("%H:%M:%S").   
-00013ec0: 2020 2020 206d 6f6e 6974 6f72 5f72 6f77       monitor_row
-00013ed0: 7320 3d20 5b0a 2020 2020 2020 2020 2020  s = [.          
-00013ee0: 2020 5b22 496e 6974 6961 7465 6422 2c20    ["Initiated", 
-00013ef0: 222e 202e 202e 202e 202e 202e 202e 202e  ". . . . . . . .
-00013f00: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
-00013f10: 202e 202e 222c 2074 696d 6573 7461 6d70   . .", timestamp
-00013f20: 5374 725d 2c0a 2020 2020 2020 2020 2020  Str],.          
-00013f30: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-00013f40: 2020 2020 2253 7461 7475 7322 2c0a 2020      "Status",.  
-00013f50: 2020 2020 2020 2020 2020 2020 2020 222e                ".
+0000e1f0: 2e2e 2e2e 2e2e 2e2e 2e2e 220a 2020 2020  ..........".    
+0000e200: 2020 2020 290a 2020 2020 2020 2020 6763      ).        gc
+0000e210: 2e63 6f6c 6c65 6374 2829 0a0a 2020 2020  .collect()..    
+0000e220: 2020 2020 6966 206e 6f74 2073 7973 7465      if not syste
+0000e230: 6d3a 0a20 2020 2020 2020 2020 2020 2072  m:.            r
+0000e240: 6574 7572 6e20 6d6f 6465 6c2c 206d 6f64  eturn model, mod
+0000e250: 656c 5f66 6974 5f74 696d 650a 0a20 2020  el_fit_time..   
+0000e260: 2020 2020 2072 6574 7572 6e20 6d6f 6465       return mode
+0000e270: 6c0a 0a20 2020 2064 6566 2063 7265 6174  l..    def creat
+0000e280: 655f 6d6f 6465 6c28 0a20 2020 2020 2020  e_model(.       
+0000e290: 2073 656c 662c 0a20 2020 2020 2020 2065   self,.        e
+0000e2a0: 7374 696d 6174 6f72 2c0a 2020 2020 2020  stimator,.      
+0000e2b0: 2020 666f 6c64 3a20 4f70 7469 6f6e 616c    fold: Optional
+0000e2c0: 5b55 6e69 6f6e 5b69 6e74 2c20 416e 795d  [Union[int, Any]
+0000e2d0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+0000e2e0: 2020 726f 756e 643a 2069 6e74 203d 2034    round: int = 4
+0000e2f0: 2c0a 2020 2020 2020 2020 6372 6f73 735f  ,.        cross_
+0000e300: 7661 6c69 6461 7469 6f6e 3a20 626f 6f6c  validation: bool
+0000e310: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
+0000e320: 2070 7265 6469 6374 3a20 626f 6f6c 203d   predict: bool =
+0000e330: 2054 7275 652c 0a20 2020 2020 2020 2066   True,.        f
+0000e340: 6974 5f6b 7761 7267 733a 204f 7074 696f  it_kwargs: Optio
+0000e350: 6e61 6c5b 6469 6374 5d20 3d20 4e6f 6e65  nal[dict] = None
+0000e360: 2c0a 2020 2020 2020 2020 6772 6f75 7073  ,.        groups
+0000e370: 3a20 4f70 7469 6f6e 616c 5b55 6e69 6f6e  : Optional[Union
+0000e380: 5b73 7472 2c20 416e 795d 5d20 3d20 4e6f  [str, Any]] = No
+0000e390: 6e65 2c0a 2020 2020 2020 2020 7265 6669  ne,.        refi
+0000e3a0: 743a 2062 6f6f 6c20 3d20 5472 7565 2c0a  t: bool = True,.
+0000e3b0: 2020 2020 2020 2020 7072 6f62 6162 696c          probabil
+0000e3c0: 6974 795f 7468 7265 7368 6f6c 643a 204f  ity_threshold: O
+0000e3d0: 7074 696f 6e61 6c5b 666c 6f61 745d 203d  ptional[float] =
+0000e3e0: 204e 6f6e 652c 0a20 2020 2020 2020 2065   None,.        e
+0000e3f0: 7870 6572 696d 656e 745f 6375 7374 6f6d  xperiment_custom
+0000e400: 5f74 6167 733a 204f 7074 696f 6e61 6c5b  _tags: Optional[
+0000e410: 4469 6374 5b73 7472 2c20 416e 795d 5d20  Dict[str, Any]] 
+0000e420: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0000e430: 7665 7262 6f73 653a 2062 6f6f 6c20 3d20  verbose: bool = 
+0000e440: 5472 7565 2c0a 2020 2020 2020 2020 7265  True,.        re
+0000e450: 7475 726e 5f74 7261 696e 5f73 636f 7265  turn_train_score
+0000e460: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+0000e470: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
+0000e480: 2c0a 2020 2020 2920 2d3e 2041 6e79 3a0a  ,.    ) -> Any:.
+0000e490: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000e4a0: 2020 2020 5468 6973 2066 756e 6374 696f      This functio
+0000e4b0: 6e20 6372 6561 7465 7320 6120 6d6f 6465  n creates a mode
+0000e4c0: 6c20 616e 6420 7363 6f72 6573 2069 7420  l and scores it 
+0000e4d0: 7573 696e 6720 4372 6f73 7320 5661 6c69  using Cross Vali
+0000e4e0: 6461 7469 6f6e 2e0a 2020 2020 2020 2020  dation..        
+0000e4f0: 5468 6520 6f75 7470 7574 2070 7269 6e74  The output print
+0000e500: 7320 6120 7363 6f72 6520 6772 6964 2074  s a score grid t
+0000e510: 6861 7420 7368 6f77 7320 4163 6375 7261  hat shows Accura
+0000e520: 6379 2c20 4155 432c 2052 6563 616c 6c2c  cy, AUC, Recall,
+0000e530: 2050 7265 6369 7369 6f6e 2c0a 2020 2020   Precision,.    
+0000e540: 2020 2020 4631 2c20 4b61 7070 6120 616e      F1, Kappa an
+0000e550: 6420 4d43 4320 6279 2066 6f6c 6420 2864  d MCC by fold (d
+0000e560: 6566 6175 6c74 203d 2031 3020 466f 6c64  efault = 10 Fold
+0000e570: 292e 0a0a 2020 2020 2020 2020 5468 6973  )...        This
+0000e580: 2066 756e 6374 696f 6e20 7265 7475 726e   function return
+0000e590: 7320 6120 7472 6169 6e65 6420 6d6f 6465  s a trained mode
+0000e5a0: 6c20 6f62 6a65 6374 2e0a 0a20 2020 2020  l object...     
+0000e5b0: 2020 2073 6574 7570 2829 2066 756e 6374     setup() funct
+0000e5c0: 696f 6e20 6d75 7374 2062 6520 6361 6c6c  ion must be call
+0000e5d0: 6564 2062 6566 6f72 6520 7573 696e 6720  ed before using 
+0000e5e0: 6372 6561 7465 5f6d 6f64 656c 2829 0a0a  create_model()..
+0000e5f0: 2020 2020 2020 2020 4578 616d 706c 650a          Example.
+0000e600: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+0000e610: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+0000e620: 2070 7963 6172 6574 2e64 6174 6173 6574   pycaret.dataset
+0000e630: 7320 696d 706f 7274 2067 6574 5f64 6174  s import get_dat
+0000e640: 610a 2020 2020 2020 2020 3e3e 3e20 6a75  a.        >>> ju
+0000e650: 6963 6520 3d20 6765 745f 6461 7461 2827  ice = get_data('
+0000e660: 6a75 6963 6527 290a 2020 2020 2020 2020  juice').        
+0000e670: 3e3e 3e20 6578 7065 7269 6d65 6e74 5f6e  >>> experiment_n
+0000e680: 616d 6520 3d20 7365 7475 7028 6461 7461  ame = setup(data
+0000e690: 203d 206a 7569 6365 2c20 2074 6172 6765   = juice,  targe
+0000e6a0: 7420 3d20 2750 7572 6368 6173 6527 290a  t = 'Purchase').
+0000e6b0: 2020 2020 2020 2020 3e3e 3e20 6c72 203d          >>> lr =
+0000e6c0: 2063 7265 6174 655f 6d6f 6465 6c28 276c   create_model('l
+0000e6d0: 7227 290a 0a20 2020 2020 2020 2054 6869  r')..        Thi
+0000e6e0: 7320 7769 6c6c 2063 7265 6174 6520 6120  s will create a 
+0000e6f0: 7472 6169 6e65 6420 4c6f 6769 7374 6963  trained Logistic
+0000e700: 2052 6567 7265 7373 696f 6e20 6d6f 6465   Regression mode
+0000e710: 6c2e 0a0a 2020 2020 2020 2020 5061 7261  l...        Para
+0000e720: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+0000e730: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0000e740: 2020 6573 7469 6d61 746f 7220 3a20 7374    estimator : st
+0000e750: 7220 2f20 6f62 6a65 6374 2c20 6465 6661  r / object, defa
+0000e760: 756c 7420 3d20 4e6f 6e65 0a20 2020 2020  ult = None.     
+0000e770: 2020 2020 2020 2045 6e74 6572 2049 4420         Enter ID 
+0000e780: 6f66 2074 6865 2065 7374 696d 6174 6f72  of the estimator
+0000e790: 7320 6176 6169 6c61 626c 6520 696e 206d  s available in m
+0000e7a0: 6f64 656c 206c 6962 7261 7279 206f 7220  odel library or 
+0000e7b0: 7061 7373 2061 6e20 756e 7472 6169 6e65  pass an untraine
+0000e7c0: 6420 6d6f 6465 6c0a 2020 2020 2020 2020  d model.        
+0000e7d0: 2020 2020 6f62 6a65 6374 2063 6f6e 7369      object consi
+0000e7e0: 7374 656e 7420 7769 7468 2066 6974 202f  stent with fit /
+0000e7f0: 2070 7265 6469 6374 2041 5049 2074 6f20   predict API to 
+0000e800: 7472 6169 6e20 616e 6420 6576 616c 7561  train and evalua
+0000e810: 7465 206d 6f64 656c 2e20 416c 6c0a 2020  te model. All.  
+0000e820: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
+0000e830: 746f 7273 2073 7570 706f 7274 2062 696e  tors support bin
+0000e840: 6172 7920 6f72 206d 756c 7469 636c 6173  ary or multiclas
+0000e850: 7320 7072 6f62 6c65 6d2e 204c 6973 7420  s problem. List 
+0000e860: 6f66 2065 7374 696d 6174 6f72 7320 696e  of estimators in
+0000e870: 206d 6f64 656c 0a20 2020 2020 2020 2020   model.         
+0000e880: 2020 206c 6962 7261 7279 2028 4944 202d     library (ID -
+0000e890: 204e 616d 6529 3a0a 0a20 2020 2020 2020   Name):..       
+0000e8a0: 2020 2020 202a 2027 6c72 2720 2d20 4c6f       * 'lr' - Lo
+0000e8b0: 6769 7374 6963 2052 6567 7265 7373 696f  gistic Regressio
+0000e8c0: 6e0a 2020 2020 2020 2020 2020 2020 2a20  n.            * 
+0000e8d0: 276b 6e6e 2720 2d20 4b20 4e65 6172 6573  'knn' - K Neares
+0000e8e0: 7420 4e65 6967 6862 6f75 720a 2020 2020  t Neighbour.    
+0000e8f0: 2020 2020 2020 2020 2a20 276e 6227 202d          * 'nb' -
+0000e900: 204e 6169 7665 2042 6179 6573 0a20 2020   Naive Bayes.   
+0000e910: 2020 2020 2020 2020 202a 2027 6474 2720           * 'dt' 
+0000e920: 2d20 4465 6369 7369 6f6e 2054 7265 6520  - Decision Tree 
+0000e930: 436c 6173 7369 6669 6572 0a20 2020 2020  Classifier.     
+0000e940: 2020 2020 2020 202a 2027 7376 6d27 202d         * 'svm' -
+0000e950: 2053 564d 202d 204c 696e 6561 7220 4b65   SVM - Linear Ke
+0000e960: 726e 656c 0a20 2020 2020 2020 2020 2020  rnel.           
+0000e970: 202a 2027 7262 6673 766d 2720 2d20 5356   * 'rbfsvm' - SV
+0000e980: 4d20 2d20 5261 6469 616c 204b 6572 6e65  M - Radial Kerne
+0000e990: 6c0a 2020 2020 2020 2020 2020 2020 2a20  l.            * 
+0000e9a0: 2767 7063 2720 2d20 4761 7573 7369 616e  'gpc' - Gaussian
+0000e9b0: 2050 726f 6365 7373 2043 6c61 7373 6966   Process Classif
+0000e9c0: 6965 720a 2020 2020 2020 2020 2020 2020  ier.            
+0000e9d0: 2a20 276d 6c70 2720 2d20 4d75 6c74 6920  * 'mlp' - Multi 
+0000e9e0: 4c65 7665 6c20 5065 7263 6570 7472 6f6e  Level Perceptron
+0000e9f0: 0a20 2020 2020 2020 2020 2020 202a 2027  .            * '
+0000ea00: 7269 6467 6527 202d 2052 6964 6765 2043  ridge' - Ridge C
+0000ea10: 6c61 7373 6966 6965 720a 2020 2020 2020  lassifier.      
+0000ea20: 2020 2020 2020 2a20 2772 6627 202d 2052        * 'rf' - R
+0000ea30: 616e 646f 6d20 466f 7265 7374 2043 6c61  andom Forest Cla
+0000ea40: 7373 6966 6965 720a 2020 2020 2020 2020  ssifier.        
+0000ea50: 2020 2020 2a20 2771 6461 2720 2d20 5175      * 'qda' - Qu
+0000ea60: 6164 7261 7469 6320 4469 7363 7269 6d69  adratic Discrimi
+0000ea70: 6e61 6e74 2041 6e61 6c79 7369 730a 2020  nant Analysis.  
+0000ea80: 2020 2020 2020 2020 2020 2a20 2761 6461            * 'ada
+0000ea90: 2720 2d20 4164 6120 426f 6f73 7420 436c  ' - Ada Boost Cl
+0000eaa0: 6173 7369 6669 6572 0a20 2020 2020 2020  assifier.       
+0000eab0: 2020 2020 202a 2027 6762 6327 202d 2047       * 'gbc' - G
+0000eac0: 7261 6469 656e 7420 426f 6f73 7469 6e67  radient Boosting
+0000ead0: 2043 6c61 7373 6966 6965 720a 2020 2020   Classifier.    
+0000eae0: 2020 2020 2020 2020 2a20 276c 6461 2720          * 'lda' 
+0000eaf0: 2d20 4c69 6e65 6172 2044 6973 6372 696d  - Linear Discrim
+0000eb00: 696e 616e 7420 416e 616c 7973 6973 0a20  inant Analysis. 
+0000eb10: 2020 2020 2020 2020 2020 202a 2027 6574             * 'et
+0000eb20: 2720 2d20 4578 7472 6120 5472 6565 7320  ' - Extra Trees 
+0000eb30: 436c 6173 7369 6669 6572 0a20 2020 2020  Classifier.     
+0000eb40: 2020 2020 2020 202a 2027 7867 626f 6f73         * 'xgboos
+0000eb50: 7427 202d 2045 7874 7265 6d65 2047 7261  t' - Extreme Gra
+0000eb60: 6469 656e 7420 426f 6f73 7469 6e67 0a20  dient Boosting. 
+0000eb70: 2020 2020 2020 2020 2020 202a 2027 6c69             * 'li
+0000eb80: 6768 7467 626d 2720 2d20 4c69 6768 7420  ghtgbm' - Light 
+0000eb90: 4772 6164 6965 6e74 2042 6f6f 7374 696e  Gradient Boostin
+0000eba0: 670a 2020 2020 2020 2020 2020 2020 2a20  g.            * 
+0000ebb0: 2763 6174 626f 6f73 7427 202d 2043 6174  'catboost' - Cat
+0000ebc0: 426f 6f73 7420 436c 6173 7369 6669 6572  Boost Classifier
+0000ebd0: 0a0a 2020 2020 2020 2020 666f 6c64 3a20  ..        fold: 
+0000ebe0: 696e 7465 6765 7220 6f72 2073 6369 6b69  integer or sciki
+0000ebf0: 742d 6c65 6172 6e20 636f 6d70 6174 6962  t-learn compatib
+0000ec00: 6c65 2043 5620 6765 6e65 7261 746f 722c  le CV generator,
+0000ec10: 2064 6566 6175 6c74 203d 204e 6f6e 650a   default = None.
+0000ec20: 2020 2020 2020 2020 2020 2020 436f 6e74              Cont
+0000ec30: 726f 6c73 2063 726f 7373 2d76 616c 6964  rols cross-valid
+0000ec40: 6174 696f 6e2e 2049 6620 4e6f 6e65 2c20  ation. If None, 
+0000ec50: 7769 6c6c 2075 7365 2074 6865 2043 5620  will use the CV 
+0000ec60: 6765 6e65 7261 746f 7220 6465 6669 6e65  generator define
+0000ec70: 6420 696e 2073 6574 7570 2829 2e0a 2020  d in setup()..  
+0000ec80: 2020 2020 2020 2020 2020 4966 2069 6e74            If int
+0000ec90: 6567 6572 2c20 7769 6c6c 2075 7365 204b  eger, will use K
+0000eca0: 466f 6c64 2043 5620 7769 7468 2074 6861  Fold CV with tha
+0000ecb0: 7420 6d61 6e79 2066 6f6c 6473 2e0a 2020  t many folds..  
+0000ecc0: 2020 2020 2020 2020 2020 5768 656e 2063            When c
+0000ecd0: 726f 7373 5f76 616c 6964 6174 696f 6e20  ross_validation 
+0000ece0: 6973 2046 616c 7365 2c20 7468 6973 2070  is False, this p
+0000ecf0: 6172 616d 6574 6572 2069 7320 6967 6e6f  arameter is igno
+0000ed00: 7265 642e 0a0a 2020 2020 2020 2020 726f  red...        ro
+0000ed10: 756e 643a 2069 6e74 6567 6572 2c20 6465  und: integer, de
+0000ed20: 6661 756c 7420 3d20 340a 2020 2020 2020  fault = 4.      
+0000ed30: 2020 2020 2020 4e75 6d62 6572 206f 6620        Number of 
+0000ed40: 6465 6369 6d61 6c20 706c 6163 6573 2074  decimal places t
+0000ed50: 6865 206d 6574 7269 6373 2069 6e20 7468  he metrics in th
+0000ed60: 6520 7363 6f72 6520 6772 6964 2077 696c  e score grid wil
+0000ed70: 6c20 6265 2072 6f75 6e64 6564 2074 6f2e  l be rounded to.
+0000ed80: 0a0a 2020 2020 2020 2020 6372 6f73 735f  ..        cross_
+0000ed90: 7661 6c69 6461 7469 6f6e 3a20 626f 6f6c  validation: bool
+0000eda0: 2c20 6465 6661 756c 7420 3d20 5472 7565  , default = True
+0000edb0: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
+0000edc0: 6e20 6372 6f73 735f 7661 6c69 6461 7469  n cross_validati
+0000edd0: 6f6e 2073 6574 2074 6f20 4661 6c73 6520  on set to False 
+0000ede0: 666f 6c64 2070 6172 616d 6574 6572 2069  fold parameter i
+0000edf0: 7320 6967 6e6f 7265 6420 616e 6420 6d6f  s ignored and mo
+0000ee00: 6465 6c20 6973 2074 7261 696e 6564 0a20  del is trained. 
+0000ee10: 2020 2020 2020 2020 2020 206f 6e20 656e             on en
+0000ee20: 7469 7265 2074 7261 696e 696e 6720 6461  tire training da
+0000ee30: 7461 7365 742e 0a0a 2020 2020 2020 2020  taset...        
+0000ee40: 7072 6564 6963 743a 2062 6f6f 6c2c 2064  predict: bool, d
+0000ee50: 6566 6175 6c74 203d 2054 7275 650a 2020  efault = True.  
+0000ee60: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
+0000ee70: 7220 746f 2070 7265 6469 6374 206d 6f64  r to predict mod
+0000ee80: 656c 206f 6e20 686f 6c64 6f75 7420 6966  el on holdout if
+0000ee90: 2063 726f 7373 5f76 616c 6964 6174 696f   cross_validatio
+0000eea0: 6e20 3d3d 2046 616c 7365 2e0a 0a20 2020  n == False...   
+0000eeb0: 2020 2020 2066 6974 5f6b 7761 7267 733a       fit_kwargs:
+0000eec0: 2064 6963 742c 2064 6566 6175 6c74 203d   dict, default =
+0000eed0: 207b 7d20 2865 6d70 7479 2064 6963 7429   {} (empty dict)
+0000eee0: 0a20 2020 2020 2020 2020 2020 2044 6963  .            Dic
+0000eef0: 7469 6f6e 6172 7920 6f66 2061 7267 756d  tionary of argum
+0000ef00: 656e 7473 2070 6173 7365 6420 746f 2074  ents passed to t
+0000ef10: 6865 2066 6974 206d 6574 686f 6420 6f66  he fit method of
+0000ef20: 2074 6865 206d 6f64 656c 2e0a 0a20 2020   the model...   
+0000ef30: 2020 2020 2067 726f 7570 733a 2073 7472       groups: str
+0000ef40: 206f 7220 6172 7261 792d 6c69 6b65 2c20   or array-like, 
+0000ef50: 7769 7468 2073 6861 7065 2028 6e5f 7361  with shape (n_sa
+0000ef60: 6d70 6c65 732c 292c 2064 6566 6175 6c74  mples,), default
+0000ef70: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+0000ef80: 2020 2020 4f70 7469 6f6e 616c 2047 726f      Optional Gro
+0000ef90: 7570 206c 6162 656c 7320 666f 7220 7468  up labels for th
+0000efa0: 6520 7361 6d70 6c65 7320 7573 6564 2077  e samples used w
+0000efb0: 6869 6c65 2073 706c 6974 7469 6e67 2074  hile splitting t
+0000efc0: 6865 2064 6174 6173 6574 2069 6e74 6f20  he dataset into 
+0000efd0: 7472 6169 6e2f 7465 7374 2073 6574 2e0a  train/test set..
+0000efe0: 2020 2020 2020 2020 2020 2020 4966 2073              If s
+0000eff0: 7472 696e 6720 6973 2070 6173 7365 642c  tring is passed,
+0000f000: 2077 696c 6c20 7573 6520 7468 6520 6461   will use the da
+0000f010: 7461 2063 6f6c 756d 6e20 7769 7468 2074  ta column with t
+0000f020: 6861 7420 6e61 6d65 2061 7320 7468 6520  hat name as the 
+0000f030: 6772 6f75 7073 2e0a 2020 2020 2020 2020  groups..        
+0000f040: 2020 2020 4f6e 6c79 2075 7365 6420 6966      Only used if
+0000f050: 2061 2067 726f 7570 2062 6173 6564 2063   a group based c
+0000f060: 726f 7373 2d76 616c 6964 6174 696f 6e20  ross-validation 
+0000f070: 6765 6e65 7261 746f 7220 6973 2075 7365  generator is use
+0000f080: 6420 2865 672e 2047 726f 7570 4b46 6f6c  d (eg. GroupKFol
+0000f090: 6429 2e0a 2020 2020 2020 2020 2020 2020  d)..            
+0000f0a0: 4966 204e 6f6e 652c 2077 696c 6c20 7573  If None, will us
+0000f0b0: 6520 7468 6520 7661 6c75 6520 7365 7420  e the value set 
+0000f0c0: 696e 2066 6f6c 645f 6772 6f75 7073 2070  in fold_groups p
+0000f0d0: 6172 616d 6574 6572 2069 6e20 7365 7475  arameter in setu
+0000f0e0: 7028 292e 0a0a 2020 2020 2020 2020 7265  p()...        re
+0000f0f0: 6669 743a 2062 6f6f 6c2c 2064 6566 6175  fit: bool, defau
+0000f100: 6c74 203d 2054 7275 650a 2020 2020 2020  lt = True.      
+0000f110: 2020 2020 2020 5768 6574 6865 7220 746f        Whether to
+0000f120: 2072 6566 6974 2074 6865 206d 6f64 656c   refit the model
+0000f130: 206f 6e20 7468 6520 656e 7469 7265 2064   on the entire d
+0000f140: 6174 6173 6574 2061 6674 6572 2043 562e  ataset after CV.
+0000f150: 2049 676e 6f72 6564 2069 6620 6372 6f73   Ignored if cros
+0000f160: 735f 7661 6c69 6461 7469 6f6e 203d 3d20  s_validation == 
+0000f170: 4661 6c73 652e 0a0a 2020 2020 2020 2020  False...        
+0000f180: 7665 7262 6f73 653a 2062 6f6f 6c2c 2064  verbose: bool, d
+0000f190: 6566 6175 6c74 203d 2054 7275 650a 2020  efault = True.  
+0000f1a0: 2020 2020 2020 2020 2020 5363 6f72 6520            Score 
+0000f1b0: 6772 6964 2069 7320 6e6f 7420 7072 696e  grid is not prin
+0000f1c0: 7465 6420 7768 656e 2076 6572 626f 7365  ted when verbose
+0000f1d0: 2069 7320 7365 7420 746f 2046 616c 7365   is set to False
+0000f1e0: 2e0a 0a20 2020 2020 2020 2073 7973 7465  ...        syste
+0000f1f0: 6d3a 2062 6f6f 6c2c 2064 6566 6175 6c74  m: bool, default
+0000f200: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
+0000f210: 2020 2020 4d75 7374 2072 656d 6169 6e20      Must remain 
+0000f220: 5472 7565 2061 6c6c 2074 696d 6573 2e20  True all times. 
+0000f230: 4f6e 6c79 2074 6f20 6265 2063 6861 6e67  Only to be chang
+0000f240: 6564 2062 7920 696e 7465 726e 616c 2066  ed by internal f
+0000f250: 756e 6374 696f 6e73 2e0a 2020 2020 2020  unctions..      
+0000f260: 2020 2020 2020 4966 2046 616c 7365 2c20        If False, 
+0000f270: 6d65 7468 6f64 2077 696c 6c20 7265 7475  method will retu
+0000f280: 726e 2061 2074 7570 6c65 206f 6620 6d6f  rn a tuple of mo
+0000f290: 6465 6c20 616e 6420 7468 6520 6d6f 6465  del and the mode
+0000f2a0: 6c20 6669 7420 7469 6d65 2e0a 0a20 2020  l fit time...   
+0000f2b0: 2020 2020 2061 6464 5f74 6f5f 6d6f 6465       add_to_mode
+0000f2c0: 6c5f 6c69 7374 3a20 626f 6f6c 2c20 6465  l_list: bool, de
+0000f2d0: 6661 756c 7420 3d20 5472 7565 0a20 2020  fault = True.   
+0000f2e0: 2020 2020 2020 2020 2057 6865 7468 6572           Whether
+0000f2f0: 2074 6f20 7361 7665 206d 6f64 656c 2061   to save model a
+0000f300: 6e64 2072 6573 756c 7473 2069 6e20 5f6d  nd results in _m
+0000f310: 6173 7465 725f 6d6f 6465 6c5f 636f 6e74  aster_model_cont
+0000f320: 6169 6e65 722e 0a0a 2020 2020 2020 2020  ainer...        
+0000f330: 585f 7472 6169 6e5f 6461 7461 3a20 7061  X_train_data: pa
+0000f340: 6e64 6173 2e44 6174 6146 7261 6d65 2c20  ndas.DataFrame, 
+0000f350: 6465 6661 756c 7420 3d20 4e6f 6e65 0a20  default = None. 
+0000f360: 2020 2020 2020 2020 2020 2049 6620 6e6f             If no
+0000f370: 7420 4e6f 6e65 2c20 7769 6c6c 2075 7365  t None, will use
+0000f380: 2074 6869 7320 6461 7461 6672 616d 6520   this dataframe 
+0000f390: 6173 2074 7261 696e 696e 6720 6665 6174  as training feat
+0000f3a0: 7572 6573 2e0a 2020 2020 2020 2020 2020  ures..          
+0000f3b0: 2020 496e 7465 6e64 6564 2074 6f20 6265    Intended to be
+0000f3c0: 206f 6e6c 7920 6368 616e 6765 6420 6279   only changed by
+0000f3d0: 2069 6e74 6572 6e61 6c20 6675 6e63 7469   internal functi
+0000f3e0: 6f6e 732e 0a0a 2020 2020 2020 2020 795f  ons...        y_
+0000f3f0: 7472 6169 6e5f 6461 7461 3a20 7061 6e64  train_data: pand
+0000f400: 6173 2e44 6174 6146 7261 6d65 2c20 6465  as.DataFrame, de
+0000f410: 6661 756c 7420 3d20 4e6f 6e65 0a20 2020  fault = None.   
+0000f420: 2020 2020 2020 2020 2049 6620 6e6f 7420           If not 
+0000f430: 4e6f 6e65 2c20 7769 6c6c 2075 7365 2074  None, will use t
+0000f440: 6869 7320 6461 7461 6672 616d 6520 6173  his dataframe as
+0000f450: 2074 7261 696e 696e 6720 7461 7267 6574   training target
+0000f460: 2e0a 2020 2020 2020 2020 2020 2020 496e  ..            In
+0000f470: 7465 6e64 6564 2074 6f20 6265 206f 6e6c  tended to be onl
+0000f480: 7920 6368 616e 6765 6420 6279 2069 6e74  y changed by int
+0000f490: 6572 6e61 6c20 6675 6e63 7469 6f6e 732e  ernal functions.
+0000f4a0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000f4b0: 5f74 7261 696e 5f73 636f 7265 3a20 626f  _train_score: bo
+0000f4c0: 6f6c 2c20 6465 6661 756c 7420 3d20 4661  ol, default = Fa
+0000f4d0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+0000f4e0: 4966 2046 616c 7365 2c20 7265 7475 726e  If False, return
+0000f4f0: 7320 7468 6520 4356 2056 616c 6964 6174  s the CV Validat
+0000f500: 696f 6e20 7363 6f72 6573 206f 6e6c 792e  ion scores only.
+0000f510: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+0000f520: 5472 7565 2c20 7265 7475 726e 7320 7468  True, returns th
+0000f530: 6520 4356 2074 7261 696e 696e 6720 7363  e CV training sc
+0000f540: 6f72 6573 2061 6c6f 6e67 2077 6974 6820  ores along with 
+0000f550: 7468 6520 4356 2076 616c 6964 6174 696f  the CV validatio
+0000f560: 6e20 7363 6f72 6573 2e0a 2020 2020 2020  n scores..      
+0000f570: 2020 2020 2020 5468 6973 2069 7320 7573        This is us
+0000f580: 6566 756c 2077 6865 6e20 7468 6520 7573  eful when the us
+0000f590: 6572 2077 616e 7473 2074 6f20 646f 2062  er wants to do b
+0000f5a0: 6961 732d 7661 7269 616e 6365 2074 7261  ias-variance tra
+0000f5b0: 6465 6f66 662e 2041 2068 6967 6820 4356  deoff. A high CV
+0000f5c0: 0a20 2020 2020 2020 2020 2020 2074 7261  .            tra
+0000f5d0: 696e 696e 6720 7363 6f72 6520 7769 7468  ining score with
+0000f5e0: 2061 206c 6f77 2063 6f72 7265 7370 6f6e   a low correspon
+0000f5f0: 6469 6e67 2043 5620 7661 6c69 6461 7469  ding CV validati
+0000f600: 6f6e 2073 636f 7265 2069 6e64 6963 6174  on score indicat
+0000f610: 6573 206f 7665 7266 6974 7469 6e67 2e0a  es overfitting..
+0000f620: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
+0000f630: 733a 0a20 2020 2020 2020 2020 2020 2041  s:.            A
+0000f640: 6464 6974 696f 6e61 6c20 6b65 7977 6f72  dditional keywor
+0000f650: 6420 6172 6775 6d65 6e74 7320 746f 2070  d arguments to p
+0000f660: 6173 7320 746f 2074 6865 2065 7374 696d  ass to the estim
+0000f670: 6174 6f72 2e0a 0a20 2020 2020 2020 2052  ator...        R
+0000f680: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+0000f690: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2073  ------.        s
+0000f6a0: 636f 7265 5f67 7269 640a 2020 2020 2020  core_grid.      
+0000f6b0: 2020 2020 2020 4120 7461 626c 6520 636f        A table co
+0000f6c0: 6e74 6169 6e69 6e67 2074 6865 2073 636f  ntaining the sco
+0000f6d0: 7265 7320 6f66 2074 6865 206d 6f64 656c  res of the model
+0000f6e0: 2061 6372 6f73 7320 7468 6520 6b66 6f6c   across the kfol
+0000f6f0: 6473 2e0a 2020 2020 2020 2020 2020 2020  ds..            
+0000f700: 5363 6f72 696e 6720 6d65 7472 6963 7320  Scoring metrics 
+0000f710: 7573 6564 2061 7265 2041 6363 7572 6163  used are Accurac
+0000f720: 792c 2041 5543 2c20 5265 6361 6c6c 2c20  y, AUC, Recall, 
+0000f730: 5072 6563 6973 696f 6e2c 2046 312c 0a20  Precision, F1,. 
+0000f740: 2020 2020 2020 2020 2020 204b 6170 7061             Kappa
+0000f750: 2061 6e64 204d 4343 2e20 4d65 616e 2061   and MCC. Mean a
+0000f760: 6e64 2073 7461 6e64 6172 6420 6465 7669  nd standard devi
+0000f770: 6174 696f 6e20 6f66 2074 6865 2073 636f  ation of the sco
+0000f780: 7265 7320 6163 726f 7373 0a20 2020 2020  res across.     
+0000f790: 2020 2020 2020 2074 6865 2066 6f6c 6473         the folds
+0000f7a0: 2061 7265 2068 6967 686c 6967 6874 6564   are highlighted
+0000f7b0: 2069 6e20 7965 6c6c 6f77 2e0a 0a20 2020   in yellow...   
+0000f7c0: 2020 2020 206d 6f64 656c 0a20 2020 2020       model.     
+0000f7d0: 2020 2020 2020 2074 7261 696e 6564 206d         trained m
+0000f7e0: 6f64 656c 206f 626a 6563 740a 0a20 2020  odel object..   
+0000f7f0: 2020 2020 2057 6172 6e69 6e67 730a 2020       Warnings.  
+0000f800: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+0000f810: 2020 2020 2020 202d 2027 7376 6d27 2061         - 'svm' a
+0000f820: 6e64 2027 7269 6467 6527 2064 6f65 736e  nd 'ridge' doesn
+0000f830: 2774 2073 7570 706f 7274 2070 7265 6469  't support predi
+0000f840: 6374 5f70 726f 6261 206d 6574 686f 642e  ct_proba method.
+0000f850: 2041 7320 7375 6368 2c20 4155 4320 7769   As such, AUC wi
+0000f860: 6c6c 2062 650a 2020 2020 2020 2020 7265  ll be.        re
+0000f870: 7475 726e 6564 2061 7320 7a65 726f 2028  turned as zero (
+0000f880: 302e 3029 0a0a 2020 2020 2020 2020 2d20  0.0)..        - 
+0000f890: 4966 2074 6172 6765 7420 7661 7269 6162  If target variab
+0000f8a0: 6c65 2069 7320 6d75 6c74 6963 6c61 7373  le is multiclass
+0000f8b0: 2028 6d6f 7265 2074 6861 6e20 3220 636c   (more than 2 cl
+0000f8c0: 6173 7365 7329 2c20 4155 4320 7769 6c6c  asses), AUC will
+0000f8d0: 2062 6520 7265 7475 726e 6564 0a20 2020   be returned.   
+0000f8e0: 2020 2020 2061 7320 7a65 726f 2028 302e       as zero (0.
+0000f8f0: 3029 0a0a 2020 2020 2020 2020 2d20 2772  0)..        - 'r
+0000f900: 6266 7376 6d27 2061 6e64 2027 6770 6327  bfsvm' and 'gpc'
+0000f910: 2075 7365 7320 6e6f 6e2d 6c69 6e65 6172   uses non-linear
+0000f920: 206b 6572 6e65 6c20 616e 6420 6865 6e63   kernel and henc
+0000f930: 6520 7468 6520 6669 7420 7469 6d65 2063  e the fit time c
+0000f940: 6f6d 706c 6578 6974 7920 6973 0a20 2020  omplexity is.   
+0000f950: 2020 2020 206d 6f72 6520 7468 616e 2071       more than q
+0000f960: 7561 6472 6174 6963 2e20 5468 6573 6520  uadratic. These 
+0000f970: 6573 7469 6d61 746f 7273 2061 7265 2068  estimators are h
+0000f980: 6172 6420 746f 2073 6361 6c65 206f 6e20  ard to scale on 
+0000f990: 6461 7461 7365 7473 2077 6974 6820 6d6f  datasets with mo
+0000f9a0: 7265 0a20 2020 2020 2020 2074 6861 6e20  re.        than 
+0000f9b0: 3130 2c30 3030 2073 616d 706c 6573 2e0a  10,000 samples..
+0000f9c0: 0a20 2020 2020 2020 202d 2049 6620 6372  .        - If cr
+0000f9d0: 6f73 735f 7661 6c69 6461 7469 6f6e 2070  oss_validation p
+0000f9e0: 6172 616d 6574 6572 2069 7320 7365 7420  arameter is set 
+0000f9f0: 746f 2046 616c 7365 2c20 6d6f 6465 6c20  to False, model 
+0000fa00: 7769 6c6c 206e 6f74 2062 6520 6c6f 6767  will not be logg
+0000fa10: 6564 2077 6974 6820 4d4c 466c 6f77 2e0a  ed with MLFlow..
+0000fa20: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+0000fa30: 2020 2020 2020 2320 544f 444f 2069 6d70        # TODO imp
+0000fa40: 726f 7665 2065 7272 6f72 206d 6573 7361  rove error messa
+0000fa50: 6765 0a20 2020 2020 2020 2061 7373 6572  ge.        asser
+0000fa60: 7420 6e6f 7420 616e 7928 0a20 2020 2020  t not any(.     
+0000fa70: 2020 2020 2020 2078 0a20 2020 2020 2020         x.       
+0000fa80: 2020 2020 2069 6e20 280a 2020 2020 2020       in (.      
+0000fa90: 2020 2020 2020 2020 2020 2273 7973 7465            "syste
+0000faa0: 6d22 2c0a 2020 2020 2020 2020 2020 2020  m",.            
+0000fab0: 2020 2020 2261 6464 5f74 6f5f 6d6f 6465      "add_to_mode
+0000fac0: 6c5f 6c69 7374 222c 0a20 2020 2020 2020  l_list",.       
+0000fad0: 2020 2020 2020 2020 2022 585f 7472 6169           "X_trai
+0000fae0: 6e5f 6461 7461 222c 0a20 2020 2020 2020  n_data",.       
+0000faf0: 2020 2020 2020 2020 2022 795f 7472 6169           "y_trai
+0000fb00: 6e5f 6461 7461 222c 0a20 2020 2020 2020  n_data",.       
+0000fb10: 2020 2020 2020 2020 2022 6d65 7472 6963           "metric
+0000fb20: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
+0000fb30: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
+0000fb40: 7220 7820 696e 206b 7761 7267 730a 2020  r x in kwargs.  
+0000fb50: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000fb60: 7265 7475 726e 2073 656c 662e 5f63 7265  return self._cre
+0000fb70: 6174 655f 6d6f 6465 6c28 0a20 2020 2020  ate_model(.     
+0000fb80: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
+0000fb90: 3d65 7374 696d 6174 6f72 2c0a 2020 2020  =estimator,.    
+0000fba0: 2020 2020 2020 2020 666f 6c64 3d66 6f6c          fold=fol
+0000fbb0: 642c 0a20 2020 2020 2020 2020 2020 2072  d,.            r
+0000fbc0: 6f75 6e64 3d72 6f75 6e64 2c0a 2020 2020  ound=round,.    
+0000fbd0: 2020 2020 2020 2020 6372 6f73 735f 7661          cross_va
+0000fbe0: 6c69 6461 7469 6f6e 3d63 726f 7373 5f76  lidation=cross_v
+0000fbf0: 616c 6964 6174 696f 6e2c 0a20 2020 2020  alidation,.     
+0000fc00: 2020 2020 2020 2070 7265 6469 6374 3d70         predict=p
+0000fc10: 7265 6469 6374 2c0a 2020 2020 2020 2020  redict,.        
+0000fc20: 2020 2020 6669 745f 6b77 6172 6773 3d66      fit_kwargs=f
+0000fc30: 6974 5f6b 7761 7267 732c 0a20 2020 2020  it_kwargs,.     
+0000fc40: 2020 2020 2020 2067 726f 7570 733d 6772         groups=gr
+0000fc50: 6f75 7073 2c0a 2020 2020 2020 2020 2020  oups,.          
+0000fc60: 2020 7265 6669 743d 7265 6669 742c 0a20    refit=refit,. 
+0000fc70: 2020 2020 2020 2020 2020 2070 726f 6261             proba
+0000fc80: 6269 6c69 7479 5f74 6872 6573 686f 6c64  bility_threshold
+0000fc90: 3d70 726f 6261 6269 6c69 7479 5f74 6872  =probability_thr
+0000fca0: 6573 686f 6c64 2c0a 2020 2020 2020 2020  eshold,.        
+0000fcb0: 2020 2020 6578 7065 7269 6d65 6e74 5f63      experiment_c
+0000fcc0: 7573 746f 6d5f 7461 6773 3d65 7870 6572  ustom_tags=exper
+0000fcd0: 696d 656e 745f 6375 7374 6f6d 5f74 6167  iment_custom_tag
+0000fce0: 732c 0a20 2020 2020 2020 2020 2020 2076  s,.            v
+0000fcf0: 6572 626f 7365 3d76 6572 626f 7365 2c0a  erbose=verbose,.
+0000fd00: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000fd10: 726e 5f74 7261 696e 5f73 636f 7265 3d72  rn_train_score=r
+0000fd20: 6574 7572 6e5f 7472 6169 6e5f 7363 6f72  eturn_train_scor
+0000fd30: 652c 0a20 2020 2020 2020 2020 2020 202a  e,.            *
+0000fd40: 2a6b 7761 7267 732c 0a20 2020 2020 2020  *kwargs,.       
+0000fd50: 2029 0a0a 2020 2020 6465 6620 7475 6e65   )..    def tune
+0000fd60: 5f6d 6f64 656c 280a 2020 2020 2020 2020  _model(.        
+0000fd70: 7365 6c66 2c0a 2020 2020 2020 2020 6573  self,.        es
+0000fd80: 7469 6d61 746f 722c 0a20 2020 2020 2020  timator,.       
+0000fd90: 2066 6f6c 643a 204f 7074 696f 6e61 6c5b   fold: Optional[
+0000fda0: 556e 696f 6e5b 696e 742c 2041 6e79 5d5d  Union[int, Any]]
+0000fdb0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000fdc0: 2072 6f75 6e64 3a20 696e 7420 3d20 342c   round: int = 4,
+0000fdd0: 0a20 2020 2020 2020 206e 5f69 7465 723a  .        n_iter:
+0000fde0: 2069 6e74 203d 2031 302c 0a20 2020 2020   int = 10,.     
+0000fdf0: 2020 2063 7573 746f 6d5f 6772 6964 3a20     custom_grid: 
+0000fe00: 4f70 7469 6f6e 616c 5b55 6e69 6f6e 5b44  Optional[Union[D
+0000fe10: 6963 745b 7374 722c 206c 6973 745d 2c20  ict[str, list], 
+0000fe20: 416e 795d 5d20 3d20 4e6f 6e65 2c0a 2020  Any]] = None,.  
+0000fe30: 2020 2020 2020 6f70 7469 6d69 7a65 3a20        optimize: 
+0000fe40: 7374 7220 3d20 2241 6363 7572 6163 7922  str = "Accuracy"
+0000fe50: 2c0a 2020 2020 2020 2020 6375 7374 6f6d  ,.        custom
+0000fe60: 5f73 636f 7265 723d 4e6f 6e65 2c20 2023  _scorer=None,  #
+0000fe70: 2061 6464 6564 2069 6e20 7079 6361 7265   added in pycare
+0000fe80: 743d 3d32 2e31 202d 2064 6570 7265 6369  t==2.1 - depreci
+0000fe90: 6174 6564 0a20 2020 2020 2020 2073 6561  ated.        sea
+0000fea0: 7263 685f 6c69 6272 6172 793a 2073 7472  rch_library: str
+0000feb0: 203d 2022 7363 696b 6974 2d6c 6561 726e   = "scikit-learn
+0000fec0: 222c 0a20 2020 2020 2020 2073 6561 7263  ",.        searc
+0000fed0: 685f 616c 676f 7269 7468 6d3a 204f 7074  h_algorithm: Opt
+0000fee0: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
+0000fef0: 652c 0a20 2020 2020 2020 2065 6172 6c79  e,.        early
+0000ff00: 5f73 746f 7070 696e 673a 2041 6e79 203d  _stopping: Any =
+0000ff10: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+0000ff20: 6561 726c 795f 7374 6f70 7069 6e67 5f6d  early_stopping_m
+0000ff30: 6178 5f69 7465 7273 3a20 696e 7420 3d20  ax_iters: int = 
+0000ff40: 3130 2c0a 2020 2020 2020 2020 6368 6f6f  10,.        choo
+0000ff50: 7365 5f62 6574 7465 723a 2062 6f6f 6c20  se_better: bool 
+0000ff60: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
+0000ff70: 2066 6974 5f6b 7761 7267 733a 204f 7074   fit_kwargs: Opt
+0000ff80: 696f 6e61 6c5b 6469 6374 5d20 3d20 4e6f  ional[dict] = No
+0000ff90: 6e65 2c0a 2020 2020 2020 2020 6772 6f75  ne,.        grou
+0000ffa0: 7073 3a20 4f70 7469 6f6e 616c 5b55 6e69  ps: Optional[Uni
+0000ffb0: 6f6e 5b73 7472 2c20 416e 795d 5d20 3d20  on[str, Any]] = 
+0000ffc0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7265  None,.        re
+0000ffd0: 7475 726e 5f74 756e 6572 3a20 626f 6f6c  turn_tuner: bool
+0000ffe0: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+0000fff0: 2020 7665 7262 6f73 653a 2062 6f6f 6c20    verbose: bool 
+00010000: 3d20 5472 7565 2c0a 2020 2020 2020 2020  = True,.        
+00010010: 7475 6e65 725f 7665 7262 6f73 653a 2055  tuner_verbose: U
+00010020: 6e69 6f6e 5b69 6e74 2c20 626f 6f6c 5d20  nion[int, bool] 
+00010030: 3d20 5472 7565 2c0a 2020 2020 2020 2020  = True,.        
+00010040: 7265 7475 726e 5f74 7261 696e 5f73 636f  return_train_sco
+00010050: 7265 3a20 626f 6f6c 203d 2046 616c 7365  re: bool = False
+00010060: 2c0a 2020 2020 2020 2020 2a2a 6b77 6172  ,.        **kwar
+00010070: 6773 2c0a 2020 2020 2920 2d3e 2041 6e79  gs,.    ) -> Any
+00010080: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00010090: 2020 2020 2020 5468 6973 2066 756e 6374        This funct
+000100a0: 696f 6e20 7475 6e65 7320 7468 6520 6879  ion tunes the hy
+000100b0: 7065 7270 6172 616d 6574 6572 7320 6f66  perparameters of
+000100c0: 2061 206d 6f64 656c 2061 6e64 2073 636f   a model and sco
+000100d0: 7265 7320 6974 2075 7369 6e67 2043 726f  res it using Cro
+000100e0: 7373 2056 616c 6964 6174 696f 6e2e 0a20  ss Validation.. 
+000100f0: 2020 2020 2020 2054 6865 206f 7574 7075         The outpu
+00010100: 7420 7072 696e 7473 2061 2073 636f 7265  t prints a score
+00010110: 2067 7269 6420 7468 6174 2073 686f 7773   grid that shows
+00010120: 2041 6363 7572 6163 792c 2041 5543 2c20   Accuracy, AUC, 
+00010130: 5265 6361 6c6c 0a20 2020 2020 2020 2050  Recall.        P
+00010140: 7265 6369 7369 6f6e 2c20 4631 2c20 4b61  recision, F1, Ka
+00010150: 7070 6120 616e 6420 4d43 4320 6279 2066  ppa and MCC by f
+00010160: 6f6c 6420 2862 7920 6465 6661 756c 7420  old (by default 
+00010170: 3d20 3130 2046 6f6c 6473 292e 0a0a 2020  = 10 Folds)...  
+00010180: 2020 2020 2020 5468 6973 2066 756e 6374        This funct
+00010190: 696f 6e20 7265 7475 726e 7320 6120 7472  ion returns a tr
+000101a0: 6169 6e65 6420 6d6f 6465 6c20 6f62 6a65  ained model obje
+000101b0: 6374 2e0a 0a20 2020 2020 2020 2045 7861  ct...        Exa
+000101c0: 6d70 6c65 0a20 2020 2020 2020 202d 2d2d  mple.        ---
+000101d0: 2d2d 2d2d 0a20 2020 2020 2020 203e 3e3e  ----.        >>>
+000101e0: 2066 726f 6d20 7079 6361 7265 742e 6461   from pycaret.da
+000101f0: 7461 7365 7473 2069 6d70 6f72 7420 6765  tasets import ge
+00010200: 745f 6461 7461 0a20 2020 2020 2020 203e  t_data.        >
+00010210: 3e3e 206a 7569 6365 203d 2067 6574 5f64  >> juice = get_d
+00010220: 6174 6128 276a 7569 6365 2729 0a20 2020  ata('juice').   
+00010230: 2020 2020 203e 3e3e 2065 7870 6572 696d       >>> experim
+00010240: 656e 745f 6e61 6d65 203d 2073 6574 7570  ent_name = setup
+00010250: 2864 6174 6120 3d20 6a75 6963 652c 2020  (data = juice,  
+00010260: 7461 7267 6574 203d 2027 5075 7263 6861  target = 'Purcha
+00010270: 7365 2729 0a20 2020 2020 2020 203e 3e3e  se').        >>>
+00010280: 2078 6762 6f6f 7374 203d 2063 7265 6174   xgboost = creat
+00010290: 655f 6d6f 6465 6c28 2778 6762 6f6f 7374  e_model('xgboost
+000102a0: 2729 0a20 2020 2020 2020 203e 3e3e 2074  ').        >>> t
+000102b0: 756e 6564 5f78 6762 6f6f 7374 203d 2074  uned_xgboost = t
+000102c0: 756e 655f 6d6f 6465 6c28 7867 626f 6f73  une_model(xgboos
+000102d0: 7429 0a0a 2020 2020 2020 2020 5468 6973  t)..        This
+000102e0: 2077 696c 6c20 7475 6e65 2074 6865 2068   will tune the h
+000102f0: 7970 6572 7061 7261 6d65 7465 7273 206f  yperparameters o
+00010300: 6620 4578 7472 656d 6520 4772 6164 6965  f Extreme Gradie
+00010310: 6e74 2042 6f6f 7374 696e 6720 436c 6173  nt Boosting Clas
+00010320: 7369 6669 6572 2e0a 0a0a 2020 2020 2020  sifier....      
+00010330: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00010340: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00010350: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
+00010360: 7220 3a20 6f62 6a65 6374 2c20 6465 6661  r : object, defa
+00010370: 756c 7420 3d20 4e6f 6e65 0a0a 2020 2020  ult = None..    
+00010380: 2020 2020 666f 6c64 3a20 696e 7465 6765      fold: intege
+00010390: 7220 6f72 2073 6369 6b69 742d 6c65 6172  r or scikit-lear
+000103a0: 6e20 636f 6d70 6174 6962 6c65 2043 5620  n compatible CV 
+000103b0: 6765 6e65 7261 746f 722c 2064 6566 6175  generator, defau
+000103c0: 6c74 203d 204e 6f6e 650a 2020 2020 2020  lt = None.      
+000103d0: 2020 2020 2020 436f 6e74 726f 6c73 2063        Controls c
+000103e0: 726f 7373 2d76 616c 6964 6174 696f 6e2e  ross-validation.
+000103f0: 2049 6620 4e6f 6e65 2c20 7769 6c6c 2075   If None, will u
+00010400: 7365 2074 6865 2043 5620 6765 6e65 7261  se the CV genera
+00010410: 746f 7220 6465 6669 6e65 6420 696e 2073  tor defined in s
+00010420: 6574 7570 2829 2e0a 2020 2020 2020 2020  etup()..        
+00010430: 2020 2020 4966 2069 6e74 6567 6572 2c20      If integer, 
+00010440: 7769 6c6c 2075 7365 204b 466f 6c64 2043  will use KFold C
+00010450: 5620 7769 7468 2074 6861 7420 6d61 6e79  V with that many
+00010460: 2066 6f6c 6473 2e0a 2020 2020 2020 2020   folds..        
+00010470: 2020 2020 5768 656e 2063 726f 7373 5f76      When cross_v
+00010480: 616c 6964 6174 696f 6e20 6973 2046 616c  alidation is Fal
+00010490: 7365 2c20 7468 6973 2070 6172 616d 6574  se, this paramet
+000104a0: 6572 2069 7320 6967 6e6f 7265 642e 0a0a  er is ignored...
+000104b0: 2020 2020 2020 2020 726f 756e 643a 2069          round: i
+000104c0: 6e74 6567 6572 2c20 6465 6661 756c 7420  nteger, default 
+000104d0: 3d20 340a 2020 2020 2020 2020 2020 2020  = 4.            
+000104e0: 4e75 6d62 6572 206f 6620 6465 6369 6d61  Number of decima
+000104f0: 6c20 706c 6163 6573 2074 6865 206d 6574  l places the met
+00010500: 7269 6373 2069 6e20 7468 6520 7363 6f72  rics in the scor
+00010510: 6520 6772 6964 2077 696c 6c20 6265 2072  e grid will be r
+00010520: 6f75 6e64 6564 2074 6f2e 0a0a 2020 2020  ounded to...    
+00010530: 2020 2020 6e5f 6974 6572 3a20 696e 7465      n_iter: inte
+00010540: 6765 722c 2064 6566 6175 6c74 203d 2031  ger, default = 1
+00010550: 300a 2020 2020 2020 2020 2020 2020 4e75  0.            Nu
+00010560: 6d62 6572 206f 6620 6974 6572 6174 696f  mber of iteratio
+00010570: 6e73 2077 6974 6869 6e20 7468 6520 5261  ns within the Ra
+00010580: 6e64 6f6d 2047 7269 6420 5365 6172 6368  ndom Grid Search
+00010590: 2e20 466f 7220 6576 6572 7920 6974 6572  . For every iter
+000105a0: 6174 696f 6e2c 0a20 2020 2020 2020 2020  ation,.         
+000105b0: 2020 2074 6865 206d 6f64 656c 2072 616e     the model ran
+000105c0: 646f 6d6c 7920 7365 6c65 6374 7320 6f6e  domly selects on
+000105d0: 6520 7661 6c75 6520 6672 6f6d 2074 6865  e value from the
+000105e0: 2070 7265 2d64 6566 696e 6564 2067 7269   pre-defined gri
+000105f0: 6420 6f66 0a20 2020 2020 2020 2020 2020  d of.           
+00010600: 2068 7970 6572 7061 7261 6d65 7465 7273   hyperparameters
+00010610: 2e0a 0a20 2020 2020 2020 2063 7573 746f  ...        custo
+00010620: 6d5f 6772 6964 3a20 6469 6374 696f 6e61  m_grid: dictiona
+00010630: 7279 2c20 6465 6661 756c 7420 3d20 4e6f  ry, default = No
+00010640: 6e65 0a20 2020 2020 2020 2020 2020 2054  ne.            T
+00010650: 6f20 7573 6520 6375 7374 6f6d 2068 7970  o use custom hyp
+00010660: 6572 7061 7261 6d65 7465 7273 2066 6f72  erparameters for
+00010670: 2074 756e 696e 6720 7061 7373 2061 2064   tuning pass a d
+00010680: 6963 7469 6f6e 6172 7920 7769 7468 2070  ictionary with p
+00010690: 6172 616d 6574 6572 206e 616d 650a 2020  arameter name.  
+000106a0: 2020 2020 2020 2020 2020 616e 6420 7661            and va
+000106b0: 6c75 6573 2074 6f20 6265 2069 7465 7261  lues to be itera
+000106c0: 7465 642e 2057 6865 6e20 7365 7420 746f  ted. When set to
+000106d0: 204e 6f6e 6520 6974 2075 7365 7320 7072   None it uses pr
+000106e0: 652d 6465 6669 6e65 6420 7475 6e69 6e67  e-defined tuning
+000106f0: 2067 7269 642e 0a20 2020 2020 2020 2020   grid..         
+00010700: 2020 2043 7573 746f 6d20 6772 6964 7320     Custom grids 
+00010710: 6d75 7374 2062 6520 696e 2061 2066 6f72  must be in a for
+00010720: 6d61 7420 7375 7070 6f72 7465 6420 6279  mat supported by
+00010730: 2074 6865 2063 686f 7365 6e20 7365 6172   the chosen sear
+00010740: 6368 206c 6962 7261 7279 2e0a 0a20 2020  ch library...   
+00010750: 2020 2020 206f 7074 696d 697a 653a 2073       optimize: s
+00010760: 7472 2c20 6465 6661 756c 7420 3d20 2741  tr, default = 'A
+00010770: 6363 7572 6163 7927 0a20 2020 2020 2020  ccuracy'.       
+00010780: 2020 2020 204d 6561 7375 7265 2075 7365       Measure use
+00010790: 6420 746f 2073 656c 6563 7420 7468 6520  d to select the 
+000107a0: 6265 7374 206d 6f64 656c 2074 6872 6f75  best model throu
+000107b0: 6768 2068 7970 6572 7061 7261 6d65 7465  gh hyperparamete
+000107c0: 7220 7475 6e69 6e67 2e0a 2020 2020 2020  r tuning..      
+000107d0: 2020 2020 2020 4361 6e20 6265 2065 6974        Can be eit
+000107e0: 6865 7220 6120 7374 7269 6e67 2072 6570  her a string rep
+000107f0: 7265 7365 6e74 696e 6720 6120 6d65 7472  resenting a metr
+00010800: 6963 206f 7220 6120 6375 7374 6f6d 2073  ic or a custom s
+00010810: 636f 7265 7220 6f62 6a65 6374 0a20 2020  corer object.   
+00010820: 2020 2020 2020 2020 2063 7265 6174 6564           created
+00010830: 2075 7369 6e67 2073 6b6c 6561 726e 2e6d   using sklearn.m
+00010840: 616b 655f 7363 6f72 6572 2e0a 0a20 2020  ake_scorer...   
+00010850: 2020 2020 2063 7573 746f 6d5f 7363 6f72       custom_scor
+00010860: 6572 3a20 6f62 6a65 6374 2c20 6465 6661  er: object, defa
+00010870: 756c 7420 3d20 4e6f 6e65 0a20 2020 2020  ult = None.     
+00010880: 2020 2020 2020 2057 696c 6c20 6265 2065         Will be e
+00010890: 7665 6e74 7561 6c6c 7920 6465 7072 6563  ventually deprec
+000108a0: 6961 7465 642e 0a20 2020 2020 2020 2020  iated..         
+000108b0: 2020 2063 7573 746f 6d5f 7363 6f72 6572     custom_scorer
+000108c0: 2063 616e 2062 6520 7061 7373 6564 2074   can be passed t
+000108d0: 6f20 7475 6e65 2068 7970 6572 7061 7261  o tune hyperpara
+000108e0: 6d65 7465 7273 206f 6620 7468 6520 6d6f  meters of the mo
+000108f0: 6465 6c2e 2049 7420 6d75 7374 2062 650a  del. It must be.
+00010900: 2020 2020 2020 2020 2020 2020 6372 6561              crea
+00010910: 7465 6420 7573 696e 6720 736b 6c65 6172  ted using sklear
+00010920: 6e2e 6d61 6b65 5f73 636f 7265 722e 0a0a  n.make_scorer...
+00010930: 2020 2020 2020 2020 7365 6172 6368 5f6c          search_l
+00010940: 6962 7261 7279 3a20 7374 722c 2064 6566  ibrary: str, def
+00010950: 6175 6c74 203d 2027 7363 696b 6974 2d6c  ault = 'scikit-l
+00010960: 6561 726e 270a 2020 2020 2020 2020 2020  earn'.          
+00010970: 2020 5468 6520 7365 6172 6368 206c 6962    The search lib
+00010980: 7261 7279 2075 7365 6420 746f 2074 756e  rary used to tun
+00010990: 6520 6879 7065 7270 6172 616d 6574 6572  e hyperparameter
+000109a0: 732e 0a20 2020 2020 2020 2020 2020 2050  s..            P
+000109b0: 6f73 7369 626c 6520 7661 6c75 6573 3a0a  ossible values:.
+000109c0: 0a20 2020 2020 2020 2020 2020 202d 2027  .            - '
+000109d0: 7363 696b 6974 2d6c 6561 726e 2720 2d20  scikit-learn' - 
+000109e0: 6465 6661 756c 742c 2072 6571 7569 7265  default, require
+000109f0: 7320 6e6f 2066 7572 7468 6572 2069 6e73  s no further ins
+00010a00: 7461 6c6c 6174 696f 6e0a 2020 2020 2020  tallation.      
+00010a10: 2020 2020 2020 2d20 2773 6369 6b69 742d        - 'scikit-
+00010a20: 6f70 7469 6d69 7a65 2720 2d20 7363 696b  optimize' - scik
+00010a30: 6974 2d6f 7074 696d 697a 652e 2060 6070  it-optimize. ``p
+00010a40: 6970 2069 6e73 7461 6c6c 2073 6369 6b69  ip install sciki
+00010a50: 742d 6f70 7469 6d69 7a65 6060 2068 7474  t-optimize`` htt
+00010a60: 7073 3a2f 2f73 6369 6b69 742d 6f70 7469  ps://scikit-opti
+00010a70: 6d69 7a65 2e67 6974 6875 622e 696f 2f73  mize.github.io/s
+00010a80: 7461 626c 652f 0a20 2020 2020 2020 2020  table/.         
+00010a90: 2020 202d 2027 7475 6e65 2d73 6b6c 6561     - 'tune-sklea
+00010aa0: 726e 2720 2d20 5261 7920 5475 6e65 2073  rn' - Ray Tune s
+00010ab0: 6369 6b69 7420 4150 492e 2044 6f65 7320  cikit API. Does 
+00010ac0: 6e6f 7420 7375 7070 6f72 7420 4750 5520  not support GPU 
+00010ad0: 6d6f 6465 6c73 2e0a 2020 2020 2020 2020  models..        
+00010ae0: 2020 2020 6060 7069 7020 696e 7374 616c      ``pip instal
+00010af0: 6c20 7475 6e65 2d73 6b6c 6561 726e 2072  l tune-sklearn r
+00010b00: 6179 5b74 756e 655d 6060 2068 7474 7073  ay[tune]`` https
+00010b10: 3a2f 2f67 6974 6875 622e 636f 6d2f 7261  ://github.com/ra
+00010b20: 792d 7072 6f6a 6563 742f 7475 6e65 2d73  y-project/tune-s
+00010b30: 6b6c 6561 726e 0a20 2020 2020 2020 2020  klearn.         
+00010b40: 2020 202d 2027 6f70 7475 6e61 2720 2d20     - 'optuna' - 
+00010b50: 4f70 7475 6e61 2e20 6060 7069 7020 696e  Optuna. ``pip in
+00010b60: 7374 616c 6c20 6f70 7475 6e61 6060 2068  stall optuna`` h
+00010b70: 7474 7073 3a2f 2f6f 7074 756e 612e 6f72  ttps://optuna.or
+00010b80: 672f 0a0a 2020 2020 2020 2020 7365 6172  g/..        sear
+00010b90: 6368 5f61 6c67 6f72 6974 686d 3a20 7374  ch_algorithm: st
+00010ba0: 722c 2064 6566 6175 6c74 203d 204e 6f6e  r, default = Non
+00010bb0: 650a 2020 2020 2020 2020 2020 2020 5468  e.            Th
+00010bc0: 6520 7365 6172 6368 2061 6c67 6f72 6974  e search algorit
+00010bd0: 686d 2064 6570 656e 6473 206f 6e20 7468  hm depends on th
+00010be0: 6520 6060 7365 6172 6368 5f6c 6962 7261  e ``search_libra
+00010bf0: 7279 6060 2070 6172 616d 6574 6572 2e0a  ry`` parameter..
+00010c00: 2020 2020 2020 2020 2020 2020 536f 6d65              Some
+00010c10: 2073 6561 7263 6820 616c 676f 7269 7468   search algorith
+00010c20: 6d73 2072 6571 7569 7265 2061 6464 6974  ms require addit
+00010c30: 696f 6e61 6c20 6c69 6272 6172 6965 7320  ional libraries 
+00010c40: 746f 2062 6520 696e 7374 616c 6c65 642e  to be installed.
+00010c50: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00010c60: 4e6f 6e65 2c20 7769 6c6c 2075 7365 2073  None, will use s
+00010c70: 6561 7263 6820 6c69 6272 6172 792d 7370  earch library-sp
+00010c80: 6563 6966 6963 2064 6566 6175 6c74 2061  ecific default a
+00010c90: 6c67 6f72 6974 686d 2e0a 0a20 2020 2020  lgorithm...     
+00010ca0: 2020 2020 2020 202d 2027 7363 696b 6974         - 'scikit
+00010cb0: 2d6c 6561 726e 2720 706f 7373 6962 6c65  -learn' possible
+00010cc0: 2076 616c 7565 733a 0a20 2020 2020 2020   values:.       
+00010cd0: 2020 2020 2020 2020 202d 2027 7261 6e64           - 'rand
+00010ce0: 6f6d 2720 3a20 7261 6e64 6f6d 2067 7269  om' : random gri
+00010cf0: 6420 7365 6172 6368 2028 6465 6661 756c  d search (defaul
+00010d00: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
+00010d10: 2020 202d 2027 6772 6964 2720 3a20 6772     - 'grid' : gr
+00010d20: 6964 2073 6561 7263 680a 0a20 2020 2020  id search..     
+00010d30: 2020 2020 2020 202d 2027 7363 696b 6974         - 'scikit
+00010d40: 2d6f 7074 696d 697a 6527 2070 6f73 7369  -optimize' possi
+00010d50: 626c 6520 7661 6c75 6573 3a0a 2020 2020  ble values:.    
+00010d60: 2020 2020 2020 2020 2020 2020 2d20 2762              - 'b
+00010d70: 6179 6573 6961 6e27 203a 2042 6179 6573  ayesian' : Bayes
+00010d80: 6961 6e20 7365 6172 6368 2028 6465 6661  ian search (defa
+00010d90: 756c 7429 0a0a 2020 2020 2020 2020 2020  ult)..          
+00010da0: 2020 2d20 2774 756e 652d 736b 6c65 6172    - 'tune-sklear
+00010db0: 6e27 2070 6f73 7369 626c 6520 7661 6c75  n' possible valu
+00010dc0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+00010dd0: 2020 2020 2d20 2772 616e 646f 6d27 203a      - 'random' :
+00010de0: 2072 616e 646f 6d20 6772 6964 2073 6561   random grid sea
+00010df0: 7263 6820 2864 6566 6175 6c74 290a 2020  rch (default).  
+00010e00: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
+00010e10: 2767 7269 6427 203a 2067 7269 6420 7365  'grid' : grid se
+00010e20: 6172 6368 0a20 2020 2020 2020 2020 2020  arch.           
+00010e30: 2020 2020 202d 2027 6261 7965 7369 616e       - 'bayesian
+00010e40: 2720 3a20 6060 7069 7020 696e 7374 616c  ' : ``pip instal
+00010e50: 6c20 7363 696b 6974 2d6f 7074 696d 697a  l scikit-optimiz
+00010e60: 6560 600a 2020 2020 2020 2020 2020 2020  e``.            
+00010e70: 2020 2020 2d20 2768 7970 6572 6f70 7427      - 'hyperopt'
+00010e80: 203a 2060 6070 6970 2069 6e73 7461 6c6c   : ``pip install
+00010e90: 2068 7970 6572 6f70 7460 600a 2020 2020   hyperopt``.    
+00010ea0: 2020 2020 2020 2020 2020 2020 2d20 276f              - 'o
+00010eb0: 7074 756e 6127 203a 2060 6070 6970 2069  ptuna' : ``pip i
+00010ec0: 6e73 7461 6c6c 206f 7074 756e 6160 600a  nstall optuna``.
+00010ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ee0: 2d20 2762 6f68 6227 203a 2060 6070 6970  - 'bohb' : ``pip
+00010ef0: 2069 6e73 7461 6c6c 2068 7062 616e 6473   install hpbands
+00010f00: 7465 7220 436f 6e66 6967 5370 6163 6560  ter ConfigSpace`
+00010f10: 600a 0a20 2020 2020 2020 2020 2020 202d  `..            -
+00010f20: 2027 6f70 7475 6e61 2720 706f 7373 6962   'optuna' possib
+00010f30: 6c65 2076 616c 7565 733a 0a20 2020 2020  le values:.     
+00010f40: 2020 2020 2020 2020 2020 202d 2027 7261             - 'ra
+00010f50: 6e64 6f6d 2720 3a20 7261 6e64 6f6d 697a  ndom' : randomiz
+00010f60: 6564 2073 6561 7263 680a 2020 2020 2020  ed search.      
+00010f70: 2020 2020 2020 2020 2020 2d20 2774 7065            - 'tpe
+00010f80: 2720 3a20 5472 6565 2d73 7472 7563 7475  ' : Tree-structu
+00010f90: 7265 6420 5061 727a 656e 2045 7374 696d  red Parzen Estim
+00010fa0: 6174 6f72 2073 6561 7263 6820 2864 6566  ator search (def
+00010fb0: 6175 6c74 290a 0a20 2020 2020 2020 2065  ault)..        e
+00010fc0: 6172 6c79 5f73 746f 7070 696e 673a 2062  arly_stopping: b
+00010fd0: 6f6f 6c20 6f72 2073 7472 206f 7220 6f62  ool or str or ob
+00010fe0: 6a65 6374 2c20 6465 6661 756c 7420 3d20  ject, default = 
+00010ff0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+00011000: 2020 5573 6520 6561 726c 7920 7374 6f70    Use early stop
+00011010: 7069 6e67 2074 6f20 7374 6f70 2066 6974  ping to stop fit
+00011020: 7469 6e67 2074 6f20 6120 6879 7065 7270  ting to a hyperp
+00011030: 6172 616d 6574 6572 2063 6f6e 6669 6775  arameter configu
+00011040: 7261 7469 6f6e 0a20 2020 2020 2020 2020  ration.         
+00011050: 2020 2069 6620 6974 2070 6572 666f 726d     if it perform
+00011060: 7320 706f 6f72 6c79 2e20 4967 6e6f 7265  s poorly. Ignore
+00011070: 6420 6966 2073 6561 7263 685f 6c69 6272  d if search_libr
+00011080: 6172 7920 6973 2060 6073 6369 6b69 742d  ary is ``scikit-
+00011090: 6c65 6172 6e60 602c 206f 720a 2020 2020  learn``, or.    
+000110a0: 2020 2020 2020 2020 6966 2074 6865 2065          if the e
+000110b0: 7374 696d 6174 6f72 2064 6f65 736e 2774  stimator doesn't
+000110c0: 2068 6176 6520 7061 7274 6961 6c5f 6669   have partial_fi
+000110d0: 7420 6174 7472 6962 7574 652e 0a20 2020  t attribute..   
+000110e0: 2020 2020 2020 2020 2049 6620 4661 6c73           If Fals
+000110f0: 6520 6f72 204e 6f6e 652c 2065 6172 6c79  e or None, early
+00011100: 2073 746f 7070 696e 6720 7769 6c6c 206e   stopping will n
+00011110: 6f74 2062 6520 7573 6564 2e0a 2020 2020  ot be used..    
+00011120: 2020 2020 2020 2020 4361 6e20 6265 2065          Can be e
+00011130: 6974 6865 7220 616e 206f 626a 6563 7420  ither an object 
+00011140: 6163 6365 7074 6564 2062 7920 7468 6520  accepted by the 
+00011150: 7365 6172 6368 206c 6962 7261 7279 206f  search library o
+00011160: 7220 6f6e 6520 6f66 2074 6865 0a20 2020  r one of the.   
+00011170: 2020 2020 2020 2020 2066 6f6c 6c6f 7769           followi
+00011180: 6e67 3a0a 0a20 2020 2020 2020 2020 2020  ng:..           
+00011190: 202d 2027 6173 6861 2720 666f 7220 4173   - 'asha' for As
+000111a0: 796e 6368 726f 6e6f 7573 2053 7563 6365  ynchronous Succe
+000111b0: 7373 6976 6520 4861 6c76 696e 6720 416c  ssive Halving Al
+000111c0: 676f 7269 7468 6d0a 2020 2020 2020 2020  gorithm.        
+000111d0: 2020 2020 2d20 2768 7970 6572 6261 6e64      - 'hyperband
+000111e0: 2720 666f 7220 4879 7065 7262 616e 640a  ' for Hyperband.
+000111f0: 2020 2020 2020 2020 2020 2020 2d20 276d              - 'm
+00011200: 6564 6961 6e27 2066 6f72 206d 6564 6961  edian' for media
+00011210: 6e20 7374 6f70 7069 6e67 2072 756c 650a  n stopping rule.
+00011220: 2020 2020 2020 2020 2020 2020 2d20 4966              - If
+00011230: 2046 616c 7365 206f 7220 4e6f 6e65 2c20   False or None, 
+00011240: 6561 726c 7920 7374 6f70 7069 6e67 2077  early stopping w
+00011250: 696c 6c20 6e6f 7420 6265 2075 7365 642e  ill not be used.
+00011260: 0a0a 2020 2020 2020 2020 2020 2020 4d6f  ..            Mo
+00011270: 7265 2069 6e66 6f20 666f 7220 4f70 7475  re info for Optu
+00011280: 6e61 202d 2068 7474 7073 3a2f 2f6f 7074  na - https://opt
+00011290: 756e 612e 7265 6164 7468 6564 6f63 732e  una.readthedocs.
+000112a0: 696f 2f65 6e2f 7374 6162 6c65 2f72 6566  io/en/stable/ref
+000112b0: 6572 656e 6365 2f70 7275 6e65 7273 2e68  erence/pruners.h
+000112c0: 746d 6c0a 2020 2020 2020 2020 2020 2020  tml.            
+000112d0: 4d6f 7265 2069 6e66 6f20 666f 7220 5261  More info for Ra
+000112e0: 7920 5475 6e65 2028 7475 6e65 2d73 6b6c  y Tune (tune-skl
+000112f0: 6561 726e 2920 2d20 6874 7470 733a 2f2f  earn) - https://
+00011300: 646f 6373 2e72 6179 2e69 6f2f 656e 2f6d  docs.ray.io/en/m
+00011310: 6173 7465 722f 7475 6e65 2f61 7069 5f64  aster/tune/api_d
+00011320: 6f63 732f 7363 6865 6475 6c65 7273 2e68  ocs/schedulers.h
+00011330: 746d 6c0a 0a20 2020 2020 2020 2065 6172  tml..        ear
+00011340: 6c79 5f73 746f 7070 696e 675f 6d61 785f  ly_stopping_max_
+00011350: 6974 6572 733a 2069 6e74 2c20 6465 6661  iters: int, defa
+00011360: 756c 7420 3d20 3130 0a20 2020 2020 2020  ult = 10.       
+00011370: 2020 2020 204d 6178 696d 756d 206e 756d       Maximum num
+00011380: 6265 7220 6f66 2065 706f 6368 7320 746f  ber of epochs to
+00011390: 2072 756e 2066 6f72 2065 6163 6820 7361   run for each sa
+000113a0: 6d70 6c65 6420 636f 6e66 6967 7572 6174  mpled configurat
+000113b0: 696f 6e2e 0a20 2020 2020 2020 2020 2020  ion..           
+000113c0: 2049 676e 6f72 6564 2069 6620 6561 726c   Ignored if earl
+000113d0: 795f 7374 6f70 7069 6e67 2069 7320 4661  y_stopping is Fa
+000113e0: 6c73 6520 6f72 204e 6f6e 652e 0a0a 2020  lse or None...  
+000113f0: 2020 2020 2020 6368 6f6f 7365 5f62 6574        choose_bet
+00011400: 7465 723a 2062 6f6f 6c2c 2064 6566 6175  ter: bool, defau
+00011410: 6c74 203d 2046 616c 7365 0a20 2020 2020  lt = False.     
+00011420: 2020 2020 2020 2057 6865 6e20 7365 7420         When set 
+00011430: 746f 2073 6574 2074 6f20 5472 7565 2c20  to set to True, 
+00011440: 6261 7365 2065 7374 696d 6174 6f72 2069  base estimator i
+00011450: 7320 7265 7475 726e 6564 2077 6865 6e20  s returned when 
+00011460: 7468 6520 7065 7266 6f72 6d61 6e63 6520  the performance 
+00011470: 646f 6573 6e27 740a 2020 2020 2020 2020  doesn't.        
+00011480: 2020 2020 696d 7072 6f76 6520 6279 2074      improve by t
+00011490: 756e 655f 6d6f 6465 6c2e 2054 6869 7320  une_model. This 
+000114a0: 6775 6172 616e 7465 6573 2074 6865 2072  guarantees the r
+000114b0: 6574 7572 6e65 6420 6f62 6a65 6374 2077  eturned object w
+000114c0: 6f75 6c64 2070 6572 666f 726d 2061 7420  ould perform at 
+000114d0: 6c65 6173 740a 2020 2020 2020 2020 2020  least.          
+000114e0: 2020 6571 7569 7661 6c65 6e74 2074 6f20    equivalent to 
+000114f0: 6261 7365 2065 7374 696d 6174 6f72 2063  base estimator c
+00011500: 7265 6174 6564 2075 7369 6e67 2063 7265  reated using cre
+00011510: 6174 655f 6d6f 6465 6c20 6f72 206d 6f64  ate_model or mod
+00011520: 656c 2072 6574 7572 6e65 6420 6279 0a20  el returned by. 
+00011530: 2020 2020 2020 2020 2020 2063 6f6d 7061             compa
+00011540: 7265 5f6d 6f64 656c 732e 0a0a 2020 2020  re_models...    
+00011550: 2020 2020 6669 745f 6b77 6172 6773 3a20      fit_kwargs: 
+00011560: 6469 6374 2c20 6465 6661 756c 7420 3d20  dict, default = 
+00011570: 7b7d 2028 656d 7074 7920 6469 6374 290a  {} (empty dict).
+00011580: 2020 2020 2020 2020 2020 2020 4469 6374              Dict
+00011590: 696f 6e61 7279 206f 6620 6172 6775 6d65  ionary of argume
+000115a0: 6e74 7320 7061 7373 6564 2074 6f20 7468  nts passed to th
+000115b0: 6520 6669 7420 6d65 7468 6f64 206f 6620  e fit method of 
+000115c0: 7468 6520 7475 6e65 722e 0a0a 2020 2020  the tuner...    
+000115d0: 2020 2020 6772 6f75 7073 3a20 7374 7220      groups: str 
+000115e0: 6f72 2061 7272 6179 2d6c 696b 652c 2077  or array-like, w
+000115f0: 6974 6820 7368 6170 6520 286e 5f73 616d  ith shape (n_sam
+00011600: 706c 6573 2c29 2c20 6465 6661 756c 7420  ples,), default 
+00011610: 3d20 4e6f 6e65 0a20 2020 2020 2020 2020  = None.         
+00011620: 2020 204f 7074 696f 6e61 6c20 4772 6f75     Optional Grou
+00011630: 7020 6c61 6265 6c73 2066 6f72 2074 6865  p labels for the
+00011640: 2073 616d 706c 6573 2075 7365 6420 7768   samples used wh
+00011650: 696c 6520 7370 6c69 7474 696e 6720 7468  ile splitting th
+00011660: 6520 6461 7461 7365 7420 696e 746f 2074  e dataset into t
+00011670: 7261 696e 2f74 6573 7420 7365 742e 0a20  rain/test set.. 
+00011680: 2020 2020 2020 2020 2020 2049 6620 7374             If st
+00011690: 7269 6e67 2069 7320 7061 7373 6564 2c20  ring is passed, 
+000116a0: 7769 6c6c 2075 7365 2074 6865 2064 6174  will use the dat
+000116b0: 6120 636f 6c75 6d6e 2077 6974 6820 7468  a column with th
+000116c0: 6174 206e 616d 6520 6173 2074 6865 2067  at name as the g
+000116d0: 726f 7570 732e 0a20 2020 2020 2020 2020  roups..         
+000116e0: 2020 204f 6e6c 7920 7573 6564 2069 6620     Only used if 
+000116f0: 6120 6772 6f75 7020 6261 7365 6420 6372  a group based cr
+00011700: 6f73 732d 7661 6c69 6461 7469 6f6e 2067  oss-validation g
+00011710: 656e 6572 6174 6f72 2069 7320 7573 6564  enerator is used
+00011720: 2028 6567 2e20 4772 6f75 704b 466f 6c64   (eg. GroupKFold
+00011730: 292e 0a20 2020 2020 2020 2020 2020 2049  )..            I
+00011740: 6620 4e6f 6e65 2c20 7769 6c6c 2075 7365  f None, will use
+00011750: 2074 6865 2076 616c 7565 2073 6574 2069   the value set i
+00011760: 6e20 666f 6c64 5f67 726f 7570 7320 7061  n fold_groups pa
+00011770: 7261 6d65 7465 7220 696e 2073 6574 7570  rameter in setup
+00011780: 2829 2e0a 0a20 2020 2020 2020 2072 6574  ()...        ret
+00011790: 7572 6e5f 7475 6e65 723a 2062 6f6f 6c2c  urn_tuner: bool,
+000117a0: 2064 6566 6175 6c74 203d 2046 616c 7365   default = False
+000117b0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+000117c0: 5472 7565 2c20 7769 6c6c 2072 6574 7572  True, will retur
+000117d0: 6e20 6120 7475 706c 6520 6f66 2028 6d6f  n a tuple of (mo
+000117e0: 6465 6c2c 2074 756e 6572 5f6f 626a 6563  del, tuner_objec
+000117f0: 7429 2e20 4f74 6865 7277 6973 652c 0a20  t). Otherwise,. 
+00011800: 2020 2020 2020 2020 2020 2077 696c 6c20             will 
+00011810: 7265 7475 726e 206a 7573 7420 7468 6520  return just the 
+00011820: 6265 7374 206d 6f64 656c 2e0a 0a20 2020  best model...   
+00011830: 2020 2020 2076 6572 626f 7365 3a20 626f       verbose: bo
+00011840: 6f6c 2c20 6465 6661 756c 7420 3d20 5472  ol, default = Tr
+00011850: 7565 0a20 2020 2020 2020 2020 2020 2053  ue.            S
+00011860: 636f 7265 2067 7269 6420 6973 206e 6f74  core grid is not
+00011870: 2070 7269 6e74 6564 2077 6865 6e20 7665   printed when ve
+00011880: 7262 6f73 6520 6973 2073 6574 2074 6f20  rbose is set to 
+00011890: 4661 6c73 652e 0a0a 2020 2020 2020 2020  False...        
+000118a0: 7475 6e65 725f 7665 7262 6f73 653a 2062  tuner_verbose: b
+000118b0: 6f6f 6c20 6f72 2069 6e2c 2064 6566 6175  ool or in, defau
+000118c0: 6c74 203d 2054 7275 650a 2020 2020 2020  lt = True.      
+000118d0: 2020 2020 2020 4966 2054 7275 6520 6f72        If True or
+000118e0: 2061 626f 7665 2030 2c20 7769 6c6c 2070   above 0, will p
+000118f0: 7269 6e74 206d 6573 7361 6765 7320 6672  rint messages fr
+00011900: 6f6d 2074 6865 2074 756e 6572 2e20 4869  om the tuner. Hi
+00011910: 6768 6572 2076 616c 7565 730a 2020 2020  gher values.    
+00011920: 2020 2020 2020 2020 7072 696e 7420 6d6f          print mo
+00011930: 7265 206d 6573 7361 6765 732e 2049 676e  re messages. Ign
+00011940: 6f72 6564 2069 6620 7665 7262 6f73 6520  ored if verbose 
+00011950: 7061 7261 6d65 7465 7220 6973 2046 616c  parameter is Fal
+00011960: 7365 2e0a 0a20 2020 2020 2020 2072 6574  se...        ret
+00011970: 7572 6e5f 7472 6169 6e5f 7363 6f72 653a  urn_train_score:
+00011980: 2062 6f6f 6c2c 2064 6566 6175 6c74 203d   bool, default =
+00011990: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+000119a0: 2020 2049 6620 4661 6c73 652c 2072 6574     If False, ret
+000119b0: 7572 6e73 2074 6865 2043 5620 5661 6c69  urns the CV Vali
+000119c0: 6461 7469 6f6e 2073 636f 7265 7320 6f6e  dation scores on
+000119d0: 6c79 2e0a 2020 2020 2020 2020 2020 2020  ly..            
+000119e0: 4966 2054 7275 652c 2072 6574 7572 6e73  If True, returns
+000119f0: 2074 6865 2043 5620 7472 6169 6e69 6e67   the CV training
+00011a00: 2073 636f 7265 7320 616c 6f6e 6720 7769   scores along wi
+00011a10: 7468 2074 6865 2043 5620 7661 6c69 6461  th the CV valida
+00011a20: 7469 6f6e 2073 636f 7265 732e 0a20 2020  tion scores..   
+00011a30: 2020 2020 2020 2020 2054 6869 7320 6973           This is
+00011a40: 2075 7365 6675 6c20 7768 656e 2074 6865   useful when the
+00011a50: 2075 7365 7220 7761 6e74 7320 746f 2064   user wants to d
+00011a60: 6f20 6269 6173 2d76 6172 6961 6e63 6520  o bias-variance 
+00011a70: 7472 6164 656f 6666 2e20 4120 6869 6768  tradeoff. A high
+00011a80: 2043 560a 2020 2020 2020 2020 2020 2020   CV.            
+00011a90: 7472 6169 6e69 6e67 2073 636f 7265 2077  training score w
+00011aa0: 6974 6820 6120 6c6f 7720 636f 7272 6573  ith a low corres
+00011ab0: 706f 6e64 696e 6720 4356 2076 616c 6964  ponding CV valid
+00011ac0: 6174 696f 6e20 7363 6f72 6520 696e 6469  ation score indi
+00011ad0: 6361 7465 7320 6f76 6572 6669 7474 696e  cates overfittin
+00011ae0: 672e 0a0a 2020 2020 2020 2020 2a2a 6b77  g...        **kw
+00011af0: 6172 6773 3a0a 2020 2020 2020 2020 2020  args:.          
+00011b00: 2020 4164 6469 7469 6f6e 616c 206b 6579    Additional key
+00011b10: 776f 7264 2061 7267 756d 656e 7473 2074  word arguments t
+00011b20: 6f20 7061 7373 2074 6f20 7468 6520 6f70  o pass to the op
+00011b30: 7469 6d69 7a65 722e 0a0a 2020 2020 2020  timizer...      
+00011b40: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
+00011b50: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+00011b60: 2020 7363 6f72 655f 6772 6964 0a20 2020    score_grid.   
+00011b70: 2020 2020 2020 2020 2041 2074 6162 6c65           A table
+00011b80: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+00011b90: 7363 6f72 6573 206f 6620 7468 6520 6d6f  scores of the mo
+00011ba0: 6465 6c20 6163 726f 7373 2074 6865 206b  del across the k
+00011bb0: 666f 6c64 732e 0a20 2020 2020 2020 2020  folds..         
+00011bc0: 2020 2053 636f 7269 6e67 206d 6574 7269     Scoring metri
+00011bd0: 6373 2075 7365 6420 6172 6520 4163 6375  cs used are Accu
+00011be0: 7261 6379 2c20 4155 432c 2052 6563 616c  racy, AUC, Recal
+00011bf0: 6c2c 2050 7265 6369 7369 6f6e 2c20 4631  l, Precision, F1
+00011c00: 2c0a 2020 2020 2020 2020 2020 2020 4b61  ,.            Ka
+00011c10: 7070 6120 616e 6420 4d43 432e 204d 6561  ppa and MCC. Mea
+00011c20: 6e20 616e 6420 7374 616e 6461 7264 2064  n and standard d
+00011c30: 6576 6961 7469 6f6e 206f 6620 7468 6520  eviation of the 
+00011c40: 7363 6f72 6573 2061 6372 6f73 730a 2020  scores across.  
+00011c50: 2020 2020 2020 2020 2020 7468 6520 666f            the fo
+00011c60: 6c64 7320 6172 6520 616c 736f 2072 6574  lds are also ret
+00011c70: 7572 6e65 642e 0a0a 2020 2020 2020 2020  urned...        
+00011c80: 6d6f 6465 6c0a 2020 2020 2020 2020 2020  model.          
+00011c90: 2020 5472 6169 6e65 6420 616e 6420 7475    Trained and tu
+00011ca0: 6e65 6420 6d6f 6465 6c20 6f62 6a65 6374  ned model object
+00011cb0: 2e0a 0a20 2020 2020 2020 2074 756e 6572  ...        tuner
+00011cc0: 5f6f 626a 6563 740a 2020 2020 2020 2020  _object.        
+00011cd0: 2020 2020 4f6e 6c79 2069 6620 7265 7475      Only if retu
+00011ce0: 726e 5f74 756e 6572 2070 6172 616d 6574  rn_tuner paramet
+00011cf0: 6572 2069 7320 5472 7565 2e20 5468 6520  er is True. The 
+00011d00: 6f62 6a65 6374 2075 7365 6420 666f 7220  object used for 
+00011d10: 7475 6e69 6e67 2e0a 0a20 2020 2020 2020  tuning...       
+00011d20: 204e 6f74 6573 0a20 2020 2020 2020 202d   Notes.        -
+00011d30: 2d2d 2d2d 0a0a 2020 2020 2020 2020 2d20  ----..        - 
+00011d40: 4966 2061 2053 7461 636b 696e 6743 6c61  If a StackingCla
+00011d50: 7373 6966 6965 7220 6973 2070 6173 7365  ssifier is passe
+00011d60: 642c 2074 6865 2068 7970 6572 7061 7261  d, the hyperpara
+00011d70: 6d65 7465 7273 206f 6620 7468 6520 6d65  meters of the me
+00011d80: 7461 206d 6f64 656c 2028 6669 6e61 6c5f  ta model (final_
+00011d90: 6573 7469 6d61 746f 7229 0a20 2020 2020  estimator).     
+00011da0: 2020 2077 696c 6c20 6265 2074 756e 6564     will be tuned
+00011db0: 2e0a 0a20 2020 2020 2020 202d 2049 6620  ...        - If 
+00011dc0: 6120 566f 7469 6e67 436c 6173 7369 6669  a VotingClassifi
+00011dd0: 6572 2069 7320 7061 7373 6564 2c20 7468  er is passed, th
+00011de0: 6520 7765 6967 6874 7320 7769 6c6c 2062  e weights will b
+00011df0: 6520 7475 6e65 642e 0a0a 2020 2020 2020  e tuned...      
+00011e00: 2020 5761 726e 696e 6773 0a20 2020 2020    Warnings.     
+00011e10: 2020 202d 2d2d 2d2d 2d2d 2d0a 0a20 2020     --------..   
+00011e20: 2020 2020 202d 2055 7369 6e67 2027 4772       - Using 'Gr
+00011e30: 6964 2720 7365 6172 6368 2061 6c67 6f72  id' search algor
+00011e40: 6974 686d 2077 6974 6820 6465 6661 756c  ithm with defaul
+00011e50: 7420 7061 7261 6d65 7465 7220 6772 6964  t parameter grid
+00011e60: 7320 6d61 7920 7265 7375 6c74 2069 6e20  s may result in 
+00011e70: 7665 7279 0a20 2020 2020 2020 206c 6f6e  very.        lon
+00011e80: 6720 636f 6d70 7574 6174 696f 6e2e 0a0a  g computation...
+00011e90: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00011ea0: 2020 2020 2073 656c 662e 5f63 6865 636b       self._check
+00011eb0: 5f73 6574 7570 5f72 616e 2829 0a0a 2020  _setup_ran()..  
+00011ec0: 2020 2020 2020 6675 6e63 7469 6f6e 5f70        function_p
+00011ed0: 6172 616d 735f 7374 7220 3d20 222c 2022  arams_str = ", "
+00011ee0: 2e6a 6f69 6e28 5b66 227b 6b7d 3d7b 767d  .join([f"{k}={v}
+00011ef0: 2220 666f 7220 6b2c 2076 2069 6e20 6c6f  " for k, v in lo
+00011f00: 6361 6c73 2829 2e69 7465 6d73 2829 5d29  cals().items()])
+00011f10: 0a0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+00011f20: 6f67 6765 722e 696e 666f 2822 496e 6974  ogger.info("Init
+00011f30: 6961 6c69 7a69 6e67 2074 756e 655f 6d6f  ializing tune_mo
+00011f40: 6465 6c28 2922 290a 2020 2020 2020 2020  del()").        
+00011f50: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
+00011f60: 2866 2274 756e 655f 6d6f 6465 6c28 7b66  (f"tune_model({f
+00011f70: 756e 6374 696f 6e5f 7061 7261 6d73 5f73  unction_params_s
+00011f80: 7472 7d29 2229 0a0a 2020 2020 2020 2020  tr})")..        
+00011f90: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
+00011fa0: 2822 4368 6563 6b69 6e67 2065 7863 6570  ("Checking excep
+00011fb0: 7469 6f6e 7322 290a 0a20 2020 2020 2020  tions")..       
+00011fc0: 2023 2072 756e 5f74 696d 650a 2020 2020   # run_time.    
+00011fd0: 2020 2020 7275 6e74 696d 655f 7374 6172      runtime_star
+00011fe0: 7420 3d20 7469 6d65 2e74 696d 6528 290a  t = time.time().
+00011ff0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00012000: 6669 745f 6b77 6172 6773 3a0a 2020 2020  fit_kwargs:.    
+00012010: 2020 2020 2020 2020 6669 745f 6b77 6172          fit_kwar
+00012020: 6773 203d 207b 7d0a 0a20 2020 2020 2020  gs = {}..       
+00012030: 2023 2063 6865 636b 696e 6720 6573 7469   # checking esti
+00012040: 6d61 746f 7220 6966 2073 7472 696e 670a  mator if string.
+00012050: 2020 2020 2020 2020 6966 2074 7970 6528          if type(
+00012060: 6573 7469 6d61 746f 7229 2069 7320 7374  estimator) is st
+00012070: 723a 0a20 2020 2020 2020 2020 2020 2072  r:.            r
+00012080: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
+00012090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000120a0: 2254 6865 2062 6568 6176 696f 7220 6f66  "The behavior of
+000120b0: 2074 756e 655f 6d6f 6465 6c20 696e 2076   tune_model in v
+000120c0: 6572 7369 6f6e 2031 2e30 2e31 2069 7320  ersion 1.0.1 is 
+000120d0: 6368 616e 6765 642e 2050 6c65 6173 6520  changed. Please 
+000120e0: 7061 7373 2074 7261 696e 6564 206d 6f64  pass trained mod
+000120f0: 656c 206f 626a 6563 742e 220a 2020 2020  el object.".    
+00012100: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00012110: 2020 2023 2043 6865 636b 2066 6f72 2065     # Check for e
+00012120: 7374 696d 6174 6f72 0a20 2020 2020 2020  stimator.       
+00012130: 2069 6620 6e6f 7420 6861 7361 7474 7228   if not hasattr(
+00012140: 6573 7469 6d61 746f 722c 2022 6669 7422  estimator, "fit"
+00012150: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00012160: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00012170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012180: 2066 2245 7374 696d 6174 6f72 207b 6573   f"Estimator {es
+00012190: 7469 6d61 746f 727d 2064 6f65 7320 6e6f  timator} does no
+000121a0: 7420 6861 7665 2074 6865 2072 6571 7569  t have the requi
+000121b0: 7265 6420 6669 7428 2920 6d65 7468 6f64  red fit() method
+000121c0: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
+000121d0: 0a0a 2020 2020 2020 2020 2320 6368 6563  ..        # chec
+000121e0: 6b69 6e67 2066 6f6c 6420 7061 7261 6d65  king fold parame
+000121f0: 7465 720a 2020 2020 2020 2020 6966 2066  ter.        if f
+00012200: 6f6c 6420 6973 206e 6f74 204e 6f6e 6520  old is not None 
+00012210: 616e 6420 6e6f 7420 280a 2020 2020 2020  and not (.      
+00012220: 2020 2020 2020 7479 7065 2866 6f6c 6429        type(fold)
+00012230: 2069 7320 696e 7420 6f72 2069 735f 736b   is int or is_sk
+00012240: 6c65 6172 6e5f 6376 5f67 656e 6572 6174  learn_cv_generat
+00012250: 6f72 2866 6f6c 6429 0a20 2020 2020 2020  or(fold).       
+00012260: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+00012270: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+00012280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012290: 2022 666f 6c64 2070 6172 616d 6574 6572   "fold parameter
+000122a0: 206d 7573 7420 6265 2065 6974 6865 7220   must be either 
+000122b0: 4e6f 6e65 2c20 616e 2069 6e74 6567 6572  None, an integer
+000122c0: 206f 7220 6120 7363 696b 6974 2d6c 6561   or a scikit-lea
+000122d0: 726e 2063 6f6d 7061 7469 626c 6520 4356  rn compatible CV
+000122e0: 2067 656e 6572 6174 6f72 206f 626a 6563   generator objec
+000122f0: 742e 220a 2020 2020 2020 2020 2020 2020  t.".            
+00012300: 290a 0a20 2020 2020 2020 2023 2063 6865  )..        # che
+00012310: 636b 696e 6720 726f 756e 6420 7061 7261  cking round para
+00012320: 6d65 7465 720a 2020 2020 2020 2020 6966  meter.        if
+00012330: 2074 7970 6528 726f 756e 6429 2069 7320   type(round) is 
+00012340: 6e6f 7420 696e 743a 0a20 2020 2020 2020  not int:.       
+00012350: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00012360: 7272 6f72 2822 526f 756e 6420 7061 7261  rror("Round para
+00012370: 6d65 7465 7220 6f6e 6c79 2061 6363 6570  meter only accep
+00012380: 7473 2069 6e74 6567 6572 2076 616c 7565  ts integer value
+00012390: 2e22 290a 0a20 2020 2020 2020 2023 2063  .")..        # c
+000123a0: 6865 636b 696e 6720 6e5f 6974 6572 2070  hecking n_iter p
+000123b0: 6172 616d 6574 6572 0a20 2020 2020 2020  arameter.       
+000123c0: 2069 6620 7479 7065 286e 5f69 7465 7229   if type(n_iter)
+000123d0: 2069 7320 6e6f 7420 696e 743a 0a20 2020   is not int:.   
+000123e0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+000123f0: 7970 6545 7272 6f72 2822 6e5f 6974 6572  ypeError("n_iter
+00012400: 2070 6172 616d 6574 6572 206f 6e6c 7920   parameter only 
+00012410: 6163 6365 7074 7320 696e 7465 6765 7220  accepts integer 
+00012420: 7661 6c75 652e 2229 0a0a 2020 2020 2020  value.")..      
+00012430: 2020 2320 6368 6563 6b69 6e67 2065 6172    # checking ear
+00012440: 6c79 5f73 746f 7070 696e 6720 7061 7261  ly_stopping para
+00012450: 6d65 7465 720a 2020 2020 2020 2020 706f  meter.        po
+00012460: 7373 6962 6c65 5f65 6172 6c79 5f73 746f  ssible_early_sto
+00012470: 7070 696e 6720 3d20 5b22 6173 6861 222c  pping = ["asha",
+00012480: 2022 4879 7065 7262 616e 6422 2c20 224d   "Hyperband", "M
+00012490: 6564 6961 6e22 5d0a 2020 2020 2020 2020  edian"].        
+000124a0: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
+000124b0: 2069 7369 6e73 7461 6e63 6528 6561 726c   isinstance(earl
+000124c0: 795f 7374 6f70 7069 6e67 2c20 7374 7229  y_stopping, str)
+000124d0: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+000124e0: 2065 6172 6c79 5f73 746f 7070 696e 6720   early_stopping 
+000124f0: 6e6f 7420 696e 2070 6f73 7369 626c 655f  not in possible_
+00012500: 6561 726c 795f 7374 6f70 7069 6e67 0a20  early_stopping. 
+00012510: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+00012520: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+00012530: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00012540: 2020 2020 2020 2066 2265 6172 6c79 5f73         f"early_s
+00012550: 746f 7070 696e 6720 7061 7261 6d65 7465  topping paramete
+00012560: 7220 6d75 7374 2062 6520 6f6e 6520 6f66  r must be one of
+00012570: 207b 272c 2027 2e6a 6f69 6e28 706f 7373   {', '.join(poss
+00012580: 6962 6c65 5f65 6172 6c79 5f73 746f 7070  ible_early_stopp
+00012590: 696e 6729 7d22 0a20 2020 2020 2020 2020  ing)}".         
+000125a0: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
+000125b0: 6368 6563 6b69 6e67 2065 6172 6c79 5f73  checking early_s
+000125c0: 746f 7070 696e 675f 6d61 785f 6974 6572  topping_max_iter
+000125d0: 7320 7061 7261 6d65 7465 720a 2020 2020  s parameter.    
+000125e0: 2020 2020 6966 2074 7970 6528 6561 726c      if type(earl
+000125f0: 795f 7374 6f70 7069 6e67 5f6d 6178 5f69  y_stopping_max_i
+00012600: 7465 7273 2920 6973 206e 6f74 2069 6e74  ters) is not int
+00012610: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00012620: 6973 6520 5479 7065 4572 726f 7228 0a20  ise TypeError(. 
+00012630: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00012640: 6561 726c 795f 7374 6f70 7069 6e67 5f6d  early_stopping_m
+00012650: 6178 5f69 7465 7273 2070 6172 616d 6574  ax_iters paramet
+00012660: 6572 206f 6e6c 7920 6163 6365 7074 7320  er only accepts 
+00012670: 696e 7465 6765 7220 7661 6c75 652e 220a  integer value.".
+00012680: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00012690: 2020 2020 2020 2023 2063 6865 636b 696e         # checkin
+000126a0: 6720 7265 7475 726e 5f74 7261 696e 5f73  g return_train_s
+000126b0: 636f 7265 2070 6172 616d 6574 6572 0a20  core parameter. 
+000126c0: 2020 2020 2020 2069 6620 7479 7065 2872         if type(r
+000126d0: 6574 7572 6e5f 7472 6169 6e5f 7363 6f72  eturn_train_scor
+000126e0: 6529 2069 7320 6e6f 7420 626f 6f6c 3a0a  e) is not bool:.
+000126f0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00012700: 6520 5479 7065 4572 726f 7228 0a20 2020  e TypeError(.   
+00012710: 2020 2020 2020 2020 2020 2020 2022 7265               "re
+00012720: 7475 726e 5f74 7261 696e 5f73 636f 7265  turn_train_score
+00012730: 2063 616e 206f 6e6c 7920 7461 6b65 2061   can only take a
+00012740: 7267 756d 656e 7420 6173 2054 7275 6520  rgument as True 
+00012750: 6f72 2046 616c 7365 220a 2020 2020 2020  or False".      
+00012760: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00012770: 2023 2063 6865 636b 696e 6720 7365 6172   # checking sear
+00012780: 6368 5f6c 6962 7261 7279 2070 6172 616d  ch_library param
+00012790: 6574 6572 0a20 2020 2020 2020 2070 6f73  eter.        pos
+000127a0: 7369 626c 655f 7365 6172 6368 5f6c 6962  sible_search_lib
+000127b0: 7261 7269 6573 203d 205b 0a20 2020 2020  raries = [.     
+000127c0: 2020 2020 2020 2022 7363 696b 6974 2d6c         "scikit-l
+000127d0: 6561 726e 222c 0a20 2020 2020 2020 2020  earn",.         
+000127e0: 2020 2022 7363 696b 6974 2d6f 7074 696d     "scikit-optim
+000127f0: 697a 6522 2c0a 2020 2020 2020 2020 2020  ize",.          
+00012800: 2020 2274 756e 652d 736b 6c65 6172 6e22    "tune-sklearn"
+00012810: 2c0a 2020 2020 2020 2020 2020 2020 226f  ,.            "o
+00012820: 7074 756e 6122 2c0a 2020 2020 2020 2020  ptuna",.        
+00012830: 5d0a 2020 2020 2020 2020 7365 6172 6368  ].        search
+00012840: 5f6c 6962 7261 7279 203d 2073 6561 7263  _library = searc
+00012850: 685f 6c69 6272 6172 792e 6c6f 7765 7228  h_library.lower(
+00012860: 290a 2020 2020 2020 2020 6966 2073 6561  ).        if sea
+00012870: 7263 685f 6c69 6272 6172 7920 6e6f 7420  rch_library not 
+00012880: 696e 2070 6f73 7369 626c 655f 7365 6172  in possible_sear
+00012890: 6368 5f6c 6962 7261 7269 6573 3a0a 2020  ch_libraries:.  
+000128a0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000128b0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+000128c0: 2020 2020 2020 2020 2020 2020 6622 7365              f"se
+000128d0: 6172 6368 5f6c 6962 7261 7279 2070 6172  arch_library par
+000128e0: 616d 6574 6572 206d 7573 7420 6265 206f  ameter must be o
+000128f0: 6e65 206f 6620 7b27 2c20 272e 6a6f 696e  ne of {', '.join
+00012900: 2870 6f73 7369 626c 655f 7365 6172 6368  (possible_search
+00012910: 5f6c 6962 7261 7269 6573 297d 220a 2020  _libraries)}".  
+00012920: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00012930: 2020 2020 2069 6620 7365 6172 6368 5f6c       if search_l
+00012940: 6962 7261 7279 203d 3d20 2273 6369 6b69  ibrary == "sciki
+00012950: 742d 6f70 7469 6d69 7a65 223a 0a20 2020  t-optimize":.   
+00012960: 2020 2020 2020 2020 205f 6368 6563 6b5f           _check_
+00012970: 736f 6674 5f64 6570 656e 6465 6e63 6965  soft_dependencie
+00012980: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+00012990: 2020 2022 736b 6f70 7422 2c0a 2020 2020     "skopt",.    
+000129a0: 2020 2020 2020 2020 2020 2020 6578 7472              extr
+000129b0: 613d 2274 756e 6572 7322 2c0a 2020 2020  a="tuners",.    
+000129c0: 2020 2020 2020 2020 2020 2020 7365 7665              seve
+000129d0: 7269 7479 3d22 6572 726f 7222 2c0a 2020  rity="error",.  
+000129e0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+000129f0: 7374 616c 6c5f 6e61 6d65 3d22 7363 696b  stall_name="scik
+00012a00: 6974 2d6f 7074 696d 697a 6522 2c0a 2020  it-optimize",.  
+00012a10: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00012a20: 2020 2020 2020 2020 696d 706f 7274 2073          import s
+00012a30: 6b6f 7074 0a0a 2020 2020 2020 2020 2020  kopt..          
+00012a40: 2020 6966 206e 6f74 2073 6561 7263 685f    if not search_
+00012a50: 616c 676f 7269 7468 6d3a 0a20 2020 2020  algorithm:.     
+00012a60: 2020 2020 2020 2020 2020 2073 6561 7263             searc
+00012a70: 685f 616c 676f 7269 7468 6d20 3d20 2262  h_algorithm = "b
+00012a80: 6179 6573 6961 6e22 0a0a 2020 2020 2020  ayesian"..      
+00012a90: 2020 2020 2020 706f 7373 6962 6c65 5f73        possible_s
+00012aa0: 6561 7263 685f 616c 676f 7269 7468 6d73  earch_algorithms
+00012ab0: 203d 205b 2262 6179 6573 6961 6e22 5d0a   = ["bayesian"].
+00012ac0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00012ad0: 6561 7263 685f 616c 676f 7269 7468 6d20  earch_algorithm 
+00012ae0: 6e6f 7420 696e 2070 6f73 7369 626c 655f  not in possible_
+00012af0: 7365 6172 6368 5f61 6c67 6f72 6974 686d  search_algorithm
+00012b00: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00012b10: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00012b20: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+00012b30: 2020 2020 2020 2020 2066 2246 6f72 2027           f"For '
+00012b40: 7363 696b 6974 2d6f 7074 696d 697a 6527  scikit-optimize'
+00012b50: 2073 6561 7263 685f 616c 676f 7269 7468   search_algorith
+00012b60: 6d20 7061 7261 6d65 7465 7220 6d75 7374  m parameter must
+00012b70: 2062 6520 6f6e 6520 6f66 207b 272c 2027   be one of {', '
+00012b80: 2e6a 6f69 6e28 706f 7373 6962 6c65 5f73  .join(possible_s
+00012b90: 6561 7263 685f 616c 676f 7269 7468 6d73  earch_algorithms
+00012ba0: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
+00012bb0: 2020 2020 290a 0a20 2020 2020 2020 2065      )..        e
+00012bc0: 6c69 6620 7365 6172 6368 5f6c 6962 7261  lif search_libra
+00012bd0: 7279 203d 3d20 2274 756e 652d 736b 6c65  ry == "tune-skle
+00012be0: 6172 6e22 3a0a 2020 2020 2020 2020 2020  arn":.          
+00012bf0: 2020 5f63 6865 636b 5f73 6f66 745f 6465    _check_soft_de
+00012c00: 7065 6e64 656e 6369 6573 280a 2020 2020  pendencies(.    
+00012c10: 2020 2020 2020 2020 2020 2020 2274 756e              "tun
+00012c20: 655f 736b 6c65 6172 6e22 2c0a 2020 2020  e_sklearn",.    
+00012c30: 2020 2020 2020 2020 2020 2020 6578 7472              extr
+00012c40: 613d 2274 756e 6572 7322 2c0a 2020 2020  a="tuners",.    
+00012c50: 2020 2020 2020 2020 2020 2020 7365 7665              seve
+00012c60: 7269 7479 3d22 6572 726f 7222 2c0a 2020  rity="error",.  
+00012c70: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00012c80: 7374 616c 6c5f 6e61 6d65 3d22 7475 6e65  stall_name="tune
+00012c90: 2d73 6b6c 6561 726e 2072 6179 5b74 756e  -sklearn ray[tun
+00012ca0: 655d 222c 0a20 2020 2020 2020 2020 2020  e]",.           
+00012cb0: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
+00012cc0: 6966 206e 6f74 2073 6561 7263 685f 616c  if not search_al
+00012cd0: 676f 7269 7468 6d3a 0a20 2020 2020 2020  gorithm:.       
+00012ce0: 2020 2020 2020 2020 2073 6561 7263 685f           search_
+00012cf0: 616c 676f 7269 7468 6d20 3d20 2272 616e  algorithm = "ran
+00012d00: 646f 6d22 0a0a 2020 2020 2020 2020 2020  dom"..          
+00012d10: 2020 706f 7373 6962 6c65 5f73 6561 7263    possible_searc
+00012d20: 685f 616c 676f 7269 7468 6d73 203d 205b  h_algorithms = [
+00012d30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012d40: 2022 7261 6e64 6f6d 222c 0a20 2020 2020   "random",.     
+00012d50: 2020 2020 2020 2020 2020 2022 6772 6964             "grid
+00012d60: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00012d70: 2020 2022 6261 7965 7369 616e 222c 0a20     "bayesian",. 
+00012d80: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00012d90: 6879 7065 726f 7074 222c 0a20 2020 2020  hyperopt",.     
+00012da0: 2020 2020 2020 2020 2020 2022 6f70 7475             "optu
+00012db0: 6e61 222c 0a20 2020 2020 2020 2020 2020  na",.           
+00012dc0: 2020 2020 2022 626f 6862 222c 0a20 2020       "bohb",.   
+00012dd0: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+00012de0: 2020 2020 2020 2069 6620 7365 6172 6368         if search
+00012df0: 5f61 6c67 6f72 6974 686d 206e 6f74 2069  _algorithm not i
+00012e00: 6e20 706f 7373 6962 6c65 5f73 6561 7263  n possible_searc
+00012e10: 685f 616c 676f 7269 7468 6d73 3a0a 2020  h_algorithms:.  
+00012e20: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00012e30: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+00012e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012e50: 2020 2020 6622 466f 7220 2774 756e 652d      f"For 'tune-
+00012e60: 736b 6c65 6172 6e27 2073 6561 7263 685f  sklearn' search_
+00012e70: 616c 676f 7269 7468 6d20 7061 7261 6d65  algorithm parame
+00012e80: 7465 7220 6d75 7374 2062 6520 6f6e 6520  ter must be one 
+00012e90: 6f66 207b 272c 2027 2e6a 6f69 6e28 706f  of {', '.join(po
+00012ea0: 7373 6962 6c65 5f73 6561 7263 685f 616c  ssible_search_al
+00012eb0: 676f 7269 7468 6d73 297d 220a 2020 2020  gorithms)}".    
+00012ec0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00012ed0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00012ee0: 6172 6368 5f61 6c67 6f72 6974 686d 203d  arch_algorithm =
+00012ef0: 3d20 2262 6f68 6222 3a0a 2020 2020 2020  = "bohb":.      
+00012f00: 2020 2020 2020 2020 2020 5f63 6865 636b            _check
+00012f10: 5f73 6f66 745f 6465 7065 6e64 656e 6369  _soft_dependenci
+00012f20: 6573 2822 436f 6e66 6967 5370 6163 6522  es("ConfigSpace"
+00012f30: 2c20 6578 7472 613d 4e6f 6e65 2c20 7365  , extra=None, se
+00012f40: 7665 7269 7479 3d22 6572 726f 7222 290a  verity="error").
+00012f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012f60: 5f63 6865 636b 5f73 6f66 745f 6465 7065  _check_soft_depe
+00012f70: 6e64 656e 6369 6573 2822 6870 6261 6e64  ndencies("hpband
+00012f80: 7374 6572 222c 2065 7874 7261 3d4e 6f6e  ster", extra=Non
+00012f90: 652c 2073 6576 6572 6974 793d 2265 7272  e, severity="err
+00012fa0: 6f72 2229 0a20 2020 2020 2020 2020 2020  or").           
+00012fb0: 2020 2020 205f 6368 6563 6b5f 736f 6674       _check_soft
+00012fc0: 5f64 6570 656e 6465 6e63 6965 7328 0a20  _dependencies(. 
+00012fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012fe0: 2020 2022 7261 7922 2c20 6578 7472 613d     "ray", extra=
+00012ff0: 2274 756e 6572 7322 2c20 7365 7665 7269  "tuners", severi
+00013000: 7479 3d22 6572 726f 7222 2c20 696e 7374  ty="error", inst
+00013010: 616c 6c5f 6e61 6d65 3d22 7261 795b 7475  all_name="ray[tu
+00013020: 6e65 5d22 0a20 2020 2020 2020 2020 2020  ne]".           
+00013030: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00013040: 2020 2020 656c 6966 2073 6561 7263 685f      elif search_
+00013050: 616c 676f 7269 7468 6d20 3d3d 2022 6879  algorithm == "hy
+00013060: 7065 726f 7074 223a 0a20 2020 2020 2020  peropt":.       
+00013070: 2020 2020 2020 2020 205f 6368 6563 6b5f           _check_
+00013080: 736f 6674 5f64 6570 656e 6465 6e63 6965  soft_dependencie
+00013090: 7328 2268 7970 6572 6f70 7422 2c20 6578  s("hyperopt", ex
+000130a0: 7472 613d 2274 756e 6572 7322 2c20 7365  tra="tuners", se
+000130b0: 7665 7269 7479 3d22 6572 726f 7222 290a  verity="error").
+000130c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000130d0: 5f63 6865 636b 5f73 6f66 745f 6465 7065  _check_soft_depe
+000130e0: 6e64 656e 6369 6573 280a 2020 2020 2020  ndencies(.      
+000130f0: 2020 2020 2020 2020 2020 2020 2020 2272                "r
+00013100: 6179 222c 2065 7874 7261 3d22 7475 6e65  ay", extra="tune
+00013110: 7273 222c 2073 6576 6572 6974 793d 2265  rs", severity="e
+00013120: 7272 6f72 222c 2069 6e73 7461 6c6c 5f6e  rror", install_n
+00013130: 616d 653d 2272 6179 5b74 756e 655d 220a  ame="ray[tune]".
+00013140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013150: 290a 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00013160: 6c69 6620 7365 6172 6368 5f61 6c67 6f72  lif search_algor
+00013170: 6974 686d 203d 3d20 2262 6179 6573 6961  ithm == "bayesia
+00013180: 6e22 3a0a 2020 2020 2020 2020 2020 2020  n":.            
+00013190: 2020 2020 5f63 6865 636b 5f73 6f66 745f      _check_soft_
+000131a0: 6465 7065 6e64 656e 6369 6573 280a 2020  dependencies(.  
+000131b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000131c0: 2020 2273 6b6f 7074 222c 0a20 2020 2020    "skopt",.     
+000131d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000131e0: 7874 7261 3d22 7475 6e65 7273 222c 0a20  xtra="tuners",. 
+000131f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013200: 2020 2073 6576 6572 6974 793d 2265 7272     severity="err
+00013210: 6f72 222c 0a20 2020 2020 2020 2020 2020  or",.           
+00013220: 2020 2020 2020 2020 2069 6e73 7461 6c6c           install
+00013230: 5f6e 616d 653d 2273 6369 6b69 742d 6f70  _name="scikit-op
+00013240: 7469 6d69 7a65 222c 0a20 2020 2020 2020  timize",.       
+00013250: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00013260: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
+00013270: 7420 736b 6f70 740a 0a20 2020 2020 2020  t skopt..       
+00013280: 2020 2020 2065 6c69 6620 7365 6172 6368       elif search
+00013290: 5f61 6c67 6f72 6974 686d 203d 3d20 226f  _algorithm == "o
+000132a0: 7074 756e 6122 3a0a 2020 2020 2020 2020  ptuna":.        
+000132b0: 2020 2020 2020 2020 5f63 6865 636b 5f73          _check_s
+000132c0: 6f66 745f 6465 7065 6e64 656e 6369 6573  oft_dependencies
+000132d0: 2822 6f70 7475 6e61 222c 2065 7874 7261  ("optuna", extra
+000132e0: 3d22 7475 6e65 7273 222c 2073 6576 6572  ="tuners", sever
+000132f0: 6974 793d 2265 7272 6f72 2229 0a20 2020  ity="error").   
+00013300: 2020 2020 2020 2020 2020 2020 2069 6d70               imp
+00013310: 6f72 7420 6f70 7475 6e61 0a0a 2020 2020  ort optuna..    
+00013320: 2020 2020 656c 6966 2073 6561 7263 685f      elif search_
+00013330: 6c69 6272 6172 7920 3d3d 2022 6f70 7475  library == "optu
+00013340: 6e61 223a 0a20 2020 2020 2020 2020 2020  na":.           
+00013350: 205f 6368 6563 6b5f 736f 6674 5f64 6570   _check_soft_dep
+00013360: 656e 6465 6e63 6965 7328 226f 7074 756e  endencies("optun
+00013370: 6122 2c20 6578 7472 613d 2274 756e 6572  a", extra="tuner
+00013380: 7322 2c20 7365 7665 7269 7479 3d22 6572  s", severity="er
+00013390: 726f 7222 290a 2020 2020 2020 2020 2020  ror").          
+000133a0: 2020 696d 706f 7274 206f 7074 756e 610a    import optuna.
+000133b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000133c0: 6e6f 7420 7365 6172 6368 5f61 6c67 6f72  not search_algor
+000133d0: 6974 686d 3a0a 2020 2020 2020 2020 2020  ithm:.          
+000133e0: 2020 2020 2020 7365 6172 6368 5f61 6c67        search_alg
+000133f0: 6f72 6974 686d 203d 2022 7470 6522 0a0a  orithm = "tpe"..
+00013400: 2020 2020 2020 2020 2020 2020 706f 7373              poss
+00013410: 6962 6c65 5f73 6561 7263 685f 616c 676f  ible_search_algo
+00013420: 7269 7468 6d73 203d 205b 2272 616e 646f  rithms = ["rando
+00013430: 6d22 2c20 2274 7065 225d 0a20 2020 2020  m", "tpe"].     
+00013440: 2020 2020 2020 2069 6620 7365 6172 6368         if search
+00013450: 5f61 6c67 6f72 6974 686d 206e 6f74 2069  _algorithm not i
+00013460: 6e20 706f 7373 6962 6c65 5f73 6561 7263  n possible_searc
+00013470: 685f 616c 676f 7269 7468 6d73 3a0a 2020  h_algorithms:.  
+00013480: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00013490: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+000134a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000134b0: 2020 2020 6622 466f 7220 276f 7074 756e      f"For 'optun
+000134c0: 6127 2073 6561 7263 685f 616c 676f 7269  a' search_algori
+000134d0: 7468 6d20 7061 7261 6d65 7465 7220 6d75  thm parameter mu
+000134e0: 7374 2062 6520 6f6e 6520 6f66 207b 272c  st be one of {',
+000134f0: 2027 2e6a 6f69 6e28 706f 7373 6962 6c65   '.join(possible
+00013500: 5f73 6561 7263 685f 616c 676f 7269 7468  _search_algorith
+00013510: 6d73 297d 220a 2020 2020 2020 2020 2020  ms)}".          
+00013520: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00013530: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00013540: 2020 6966 206e 6f74 2073 6561 7263 685f    if not search_
+00013550: 616c 676f 7269 7468 6d3a 0a20 2020 2020  algorithm:.     
+00013560: 2020 2020 2020 2020 2020 2073 6561 7263             searc
+00013570: 685f 616c 676f 7269 7468 6d20 3d20 2272  h_algorithm = "r
+00013580: 616e 646f 6d22 0a0a 2020 2020 2020 2020  andom"..        
+00013590: 2020 2020 706f 7373 6962 6c65 5f73 6561      possible_sea
+000135a0: 7263 685f 616c 676f 7269 7468 6d73 203d  rch_algorithms =
+000135b0: 205b 2272 616e 646f 6d22 2c20 2267 7269   ["random", "gri
+000135c0: 6422 5d0a 2020 2020 2020 2020 2020 2020  d"].            
+000135d0: 6966 2073 6561 7263 685f 616c 676f 7269  if search_algori
+000135e0: 7468 6d20 6e6f 7420 696e 2070 6f73 7369  thm not in possi
+000135f0: 626c 655f 7365 6172 6368 5f61 6c67 6f72  ble_search_algor
+00013600: 6974 686d 733a 0a20 2020 2020 2020 2020  ithms:.         
+00013610: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00013620: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+00013630: 2020 2020 2020 2020 2020 2020 2066 2246               f"F
+00013640: 6f72 2027 7363 696b 6974 2d6c 6561 726e  or 'scikit-learn
+00013650: 2720 7365 6172 6368 5f61 6c67 6f72 6974  ' search_algorit
+00013660: 686d 2070 6172 616d 6574 6572 206d 7573  hm parameter mus
+00013670: 7420 6265 206f 6e65 206f 6620 7b27 2c20  t be one of {', 
+00013680: 272e 6a6f 696e 2870 6f73 7369 626c 655f  '.join(possible_
+00013690: 7365 6172 6368 5f61 6c67 6f72 6974 686d  search_algorithm
+000136a0: 7329 7d22 0a20 2020 2020 2020 2020 2020  s)}".           
+000136b0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+000136c0: 6966 2063 7573 746f 6d5f 7363 6f72 6572  if custom_scorer
+000136d0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+000136e0: 2020 2020 2020 2020 2020 6f70 7469 6d69            optimi
+000136f0: 7a65 203d 2063 7573 746f 6d5f 7363 6f72  ze = custom_scor
+00013700: 6572 0a20 2020 2020 2020 2020 2020 2077  er.            w
+00013710: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
+00013720: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00013730: 7573 746f 6d5f 7363 6f72 6572 2070 6172  ustom_scorer par
+00013740: 616d 6574 6572 2077 696c 6c20 6265 2064  ameter will be d
+00013750: 6570 7265 6369 6174 6564 2c20 7573 6520  epreciated, use 
+00013760: 6f70 7469 6d69 7a65 2069 6e73 7465 6164  optimize instead
+00013770: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00013780: 2020 2044 6570 7265 6361 7469 6f6e 5761     DeprecationWa
+00013790: 726e 696e 672c 0a20 2020 2020 2020 2020  rning,.         
+000137a0: 2020 2020 2020 2073 7461 636b 6c65 7665         stackleve
+000137b0: 6c3d 322c 0a20 2020 2020 2020 2020 2020  l=2,.           
+000137c0: 2029 0a0a 2020 2020 2020 2020 6966 2069   )..        if i
+000137d0: 7369 6e73 7461 6e63 6528 6f70 7469 6d69  sinstance(optimi
+000137e0: 7a65 2c20 7374 7229 3a0a 2020 2020 2020  ze, str):.      
+000137f0: 2020 2020 2020 2320 6368 6563 6b69 6e67        # checking
+00013800: 206f 7074 696d 697a 6520 7061 7261 6d65   optimize parame
+00013810: 7465 720a 2020 2020 2020 2020 2020 2020  ter.            
+00013820: 6f70 7469 6d69 7a65 203d 2073 656c 662e  optimize = self.
+00013830: 5f67 6574 5f6d 6574 7269 635f 6279 5f6e  _get_metric_by_n
+00013840: 616d 655f 6f72 5f69 6428 6f70 7469 6d69  ame_or_id(optimi
+00013850: 7a65 290a 2020 2020 2020 2020 2020 2020  ze).            
+00013860: 6966 206f 7074 696d 697a 6520 6973 204e  if optimize is N
+00013870: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00013880: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00013890: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+000138a0: 2020 2020 2020 2020 2020 2022 4f70 7469             "Opti
+000138b0: 6d69 7a65 206d 6574 686f 6420 6e6f 7420  mize method not 
+000138c0: 7375 7070 6f72 7465 642e 2053 6565 2064  supported. See d
+000138d0: 6f63 7374 7269 6e67 2066 6f72 206c 6973  ocstring for lis
+000138e0: 7420 6f66 2061 7661 696c 6162 6c65 2070  t of available p
+000138f0: 6172 616d 6574 6572 732e 220a 2020 2020  arameters.".    
+00013900: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00013910: 2020 2020 2020 2020 2020 2023 2063 6865             # che
+00013920: 636b 696e 6720 6f70 7469 6d69 7a65 2070  cking optimize p
+00013930: 6172 616d 6574 6572 2066 6f72 206d 756c  arameter for mul
+00013940: 7469 636c 6173 730a 2020 2020 2020 2020  ticlass.        
+00013950: 2020 2020 6966 2073 656c 662e 6973 5f6d      if self.is_m
+00013960: 756c 7469 636c 6173 733a 0a20 2020 2020  ulticlass:.     
+00013970: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00013980: 7420 6f70 7469 6d69 7a65 2e69 735f 6d75  t optimize.is_mu
+00013990: 6c74 6963 6c61 7373 3a0a 2020 2020 2020  lticlass:.      
+000139a0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+000139b0: 6973 6520 5479 7065 4572 726f 7228 0a20  ise TypeError(. 
+000139c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000139d0: 2020 2020 2020 2022 4f70 7469 6d69 7a61         "Optimiza
+000139e0: 7469 6f6e 206d 6574 7269 6320 6e6f 7420  tion metric not 
+000139f0: 7375 7070 6f72 7465 6420 666f 7220 6d75  supported for mu
+00013a00: 6c74 6963 6c61 7373 2070 726f 626c 656d  lticlass problem
+00013a10: 732e 2053 6565 2064 6f63 7374 7269 6e67  s. See docstring
+00013a20: 2066 6f72 206c 6973 7420 6f66 206f 7468   for list of oth
+00013a30: 6572 206f 7074 696d 697a 6174 696f 6e20  er optimization 
+00013a40: 7061 7261 6d65 7465 7273 2e22 0a20 2020  parameters.".   
+00013a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013a60: 2029 0a20 2020 2020 2020 2065 6c73 653a   ).        else:
+00013a70: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00013a80: 662e 6c6f 6767 6572 2e69 6e66 6f28 6622  f.logger.info(f"
+00013a90: 6f70 7469 6d69 7a65 2073 6574 2074 6f20  optimize set to 
+00013aa0: 7573 6572 2064 6566 696e 6564 2066 756e  user defined fun
+00013ab0: 6374 696f 6e20 7b6f 7074 696d 697a 657d  ction {optimize}
+00013ac0: 2229 0a0a 2020 2020 2020 2020 2320 6368  ")..        # ch
+00013ad0: 6563 6b69 6e67 2076 6572 626f 7365 2070  ecking verbose p
+00013ae0: 6172 616d 6574 6572 0a20 2020 2020 2020  arameter.       
+00013af0: 2069 6620 7479 7065 2876 6572 626f 7365   if type(verbose
+00013b00: 2920 6973 206e 6f74 2062 6f6f 6c3a 0a20  ) is not bool:. 
+00013b10: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00013b20: 2054 7970 6545 7272 6f72 280a 2020 2020   TypeError(.    
+00013b30: 2020 2020 2020 2020 2020 2020 2276 6572              "ver
+00013b40: 626f 7365 2070 6172 616d 6574 6572 2063  bose parameter c
+00013b50: 616e 206f 6e6c 7920 7461 6b65 2061 7267  an only take arg
+00013b60: 756d 656e 7420 6173 2054 7275 6520 6f72  ument as True or
+00013b70: 2046 616c 7365 2e22 0a20 2020 2020 2020   False.".       
+00013b80: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00013b90: 2320 6368 6563 6b69 6e67 2076 6572 626f  # checking verbo
+00013ba0: 7365 2070 6172 616d 6574 6572 0a20 2020  se parameter.   
+00013bb0: 2020 2020 2069 6620 7479 7065 2872 6574       if type(ret
+00013bc0: 7572 6e5f 7475 6e65 7229 2069 7320 6e6f  urn_tuner) is no
+00013bd0: 7420 626f 6f6c 3a0a 2020 2020 2020 2020  t bool:.        
+00013be0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+00013bf0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+00013c00: 2020 2020 2022 7265 7475 726e 5f74 756e       "return_tun
+00013c10: 6572 2070 6172 616d 6574 6572 2063 616e  er parameter can
+00013c20: 206f 6e6c 7920 7461 6b65 2061 7267 756d   only take argum
+00013c30: 656e 7420 6173 2054 7275 6520 6f72 2046  ent as True or F
+00013c40: 616c 7365 2e22 0a20 2020 2020 2020 2020  alse.".         
+00013c50: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
+00013c60: 206e 6f74 2076 6572 626f 7365 3a0a 2020   not verbose:.  
+00013c70: 2020 2020 2020 2020 2020 7475 6e65 725f            tuner_
+00013c80: 7665 7262 6f73 6520 3d20 300a 0a20 2020  verbose = 0..   
+00013c90: 2020 2020 2069 6620 7479 7065 2874 756e       if type(tun
+00013ca0: 6572 5f76 6572 626f 7365 2920 6e6f 7420  er_verbose) not 
+00013cb0: 696e 2028 626f 6f6c 2c20 696e 7429 3a0a  in (bool, int):.
+00013cc0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00013cd0: 6520 5479 7065 4572 726f 7228 2274 756e  e TypeError("tun
+00013ce0: 6572 5f76 6572 626f 7365 2070 6172 616d  er_verbose param
+00013cf0: 6574 6572 206d 7573 7420 6265 2061 2062  eter must be a b
+00013d00: 6f6f 6c20 6f72 2061 6e20 696e 742e 2229  ool or an int.")
+00013d10: 0a0a 2020 2020 2020 2020 7475 6e65 725f  ..        tuner_
+00013d20: 7665 7262 6f73 6520 3d20 696e 7428 7475  verbose = int(tu
+00013d30: 6e65 725f 7665 7262 6f73 6529 0a0a 2020  ner_verbose)..  
+00013d40: 2020 2020 2020 6966 2074 756e 6572 5f76        if tuner_v
+00013d50: 6572 626f 7365 203c 2030 3a0a 2020 2020  erbose < 0:.    
+00013d60: 2020 2020 2020 2020 7475 6e65 725f 7665          tuner_ve
+00013d70: 7262 6f73 6520 3d20 300a 2020 2020 2020  rbose = 0.      
+00013d80: 2020 656c 6966 2074 756e 6572 5f76 6572    elif tuner_ver
+00013d90: 626f 7365 203e 2032 3a0a 2020 2020 2020  bose > 2:.      
+00013da0: 2020 2020 2020 7475 6e65 725f 7665 7262        tuner_verb
+00013db0: 6f73 6520 3d20 320a 0a20 2020 2020 2020  ose = 2..       
+00013dc0: 2022 2222 0a0a 2020 2020 2020 2020 4552   """..        ER
+00013dd0: 524f 5220 4841 4e44 4c49 4e47 2045 4e44  ROR HANDLING END
+00013de0: 5320 4845 5245 0a0a 2020 2020 2020 2020  S HERE..        
+00013df0: 2222 220a 0a20 2020 2020 2020 2066 6f6c  """..        fol
+00013e00: 6420 3d20 7365 6c66 2e5f 6765 745f 6376  d = self._get_cv
+00013e10: 5f73 706c 6974 7465 7228 666f 6c64 290a  _splitter(fold).
+00013e20: 0a20 2020 2020 2020 2067 726f 7570 7320  .        groups 
+00013e30: 3d20 7365 6c66 2e5f 6765 745f 6772 6f75  = self._get_grou
+00013e40: 7073 2867 726f 7570 7329 0a0a 2020 2020  ps(groups)..    
+00013e50: 2020 2020 7072 6f67 7265 7373 5f61 7267      progress_arg
+00013e60: 7320 3d20 7b22 6d61 7822 3a20 3320 2b20  s = {"max": 3 + 
+00013e70: 347d 0a20 2020 2020 2020 2074 696d 6573  4}.        times
+00013e80: 7461 6d70 5374 7220 3d20 6461 7465 7469  tampStr = dateti
+00013e90: 6d65 2e64 6174 6574 696d 652e 6e6f 7728  me.datetime.now(
+00013ea0: 292e 7374 7266 7469 6d65 2822 2548 3a25  ).strftime("%H:%
+00013eb0: 4d3a 2553 2229 0a20 2020 2020 2020 206d  M:%S").        m
+00013ec0: 6f6e 6974 6f72 5f72 6f77 7320 3d20 5b0a  onitor_rows = [.
+00013ed0: 2020 2020 2020 2020 2020 2020 5b22 496e              ["In
+00013ee0: 6974 6961 7465 6422 2c20 222e 202e 202e  itiated", ". . .
+00013ef0: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
+00013f00: 202e 202e 202e 202e 202e 202e 202e 222c   . . . . . . .",
+00013f10: 2074 696d 6573 7461 6d70 5374 725d 2c0a   timestampStr],.
+00013f20: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+00013f30: 2020 2020 2020 2020 2020 2020 2020 2253                "S
+00013f40: 7461 7475 7322 2c0a 2020 2020 2020 2020  tatus",.        
+00013f50: 2020 2020 2020 2020 222e 202e 202e 202e          ". . . .
 00013f60: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
-00013f70: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
-00013f80: 202e 222c 0a20 2020 2020 2020 2020 2020   .",.           
-00013f90: 2020 2020 2022 4c6f 6164 696e 6720 4465       "Loading De
-00013fa0: 7065 6e64 656e 6369 6573 222c 0a20 2020  pendencies",.   
-00013fb0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-00013fc0: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-00013fd0: 2020 2020 2020 2020 2020 2245 7374 696d            "Estim
-00013fe0: 6174 6f72 222c 0a20 2020 2020 2020 2020  ator",.         
-00013ff0: 2020 2020 2020 2022 2e20 2e20 2e20 2e20         ". . . . 
+00013f70: 202e 202e 202e 202e 202e 202e 222c 0a20   . . . . . .",. 
+00013f80: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00013f90: 4c6f 6164 696e 6720 4465 7065 6e64 656e  Loading Dependen
+00013fa0: 6369 6573 222c 0a20 2020 2020 2020 2020  cies",.         
+00013fb0: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
+00013fc0: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
+00013fd0: 2020 2020 2245 7374 696d 6174 6f72 222c      "Estimator",
+00013fe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013ff0: 2022 2e20 2e20 2e20 2e20 2e20 2e20 2e20   ". . . . . . . 
 00014000: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
-00014010: 2e20 2e20 2e20 2e20 2e20 2e22 2c0a 2020  . . . . . .",.  
-00014020: 2020 2020 2020 2020 2020 2020 2020 2243                "C
-00014030: 6f6d 7069 6c69 6e67 204c 6962 7261 7279  ompiling Library
-00014040: 222c 0a20 2020 2020 2020 2020 2020 205d  ",.            ]
-00014050: 2c0a 2020 2020 2020 2020 5d0a 2020 2020  ,.        ].    
-00014060: 2020 2020 6469 7370 6c61 7920 3d20 436f      display = Co
-00014070: 6d6d 6f6e 4469 7370 6c61 7928 0a20 2020  mmonDisplay(.   
-00014080: 2020 2020 2020 2020 2076 6572 626f 7365           verbose
-00014090: 3d76 6572 626f 7365 2c0a 2020 2020 2020  =verbose,.      
-000140a0: 2020 2020 2020 6874 6d6c 5f70 6172 616d        html_param
-000140b0: 3d73 656c 662e 6874 6d6c 5f70 6172 616d  =self.html_param
-000140c0: 2c0a 2020 2020 2020 2020 2020 2020 7072  ,.            pr
-000140d0: 6f67 7265 7373 5f61 7267 733d 7072 6f67  ogress_args=prog
-000140e0: 7265 7373 5f61 7267 732c 0a20 2020 2020  ress_args,.     
-000140f0: 2020 2020 2020 206d 6f6e 6974 6f72 5f72         monitor_r
-00014100: 6f77 733d 6d6f 6e69 746f 725f 726f 7773  ows=monitor_rows
-00014110: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00014120: 2020 2020 2069 6d70 6f72 7420 6c6f 6767       import logg
-00014130: 696e 670a 0a20 2020 2020 2020 206e 702e  ing..        np.
-00014140: 7261 6e64 6f6d 2e73 6565 6428 7365 6c66  random.seed(self
-00014150: 2e73 6565 6429 0a0a 2020 2020 2020 2020  .seed)..        
-00014160: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
-00014170: 2822 436f 7079 696e 6720 7472 6169 6e69  ("Copying traini
-00014180: 6e67 2064 6174 6173 6574 2229 0a20 2020  ng dataset").   
-00014190: 2020 2020 2023 2053 746f 7269 6e67 2058       # Storing X
-000141a0: 5f74 7261 696e 2061 6e64 2079 5f74 7261  _train and y_tra
-000141b0: 696e 2069 6e20 6461 7461 5f58 2061 6e64  in in data_X and
-000141c0: 2064 6174 615f 7920 7061 7261 6d65 7465   data_y paramete
-000141d0: 720a 2020 2020 2020 2020 6461 7461 5f58  r.        data_X
-000141e0: 203d 2073 656c 662e 585f 7472 6169 6e0a   = self.X_train.
-000141f0: 2020 2020 2020 2020 6461 7461 5f79 203d          data_y =
-00014200: 2073 656c 662e 795f 7472 6169 6e0a 0a20   self.y_train.. 
-00014210: 2020 2020 2020 2064 6973 706c 6179 2e6d         display.m
-00014220: 6f76 655f 7072 6f67 7265 7373 2829 0a0a  ove_progress()..
-00014230: 2020 2020 2020 2020 2320 7365 7474 696e          # settin
-00014240: 6720 6f70 7469 6d69 7a65 2070 6172 616d  g optimize param
-00014250: 6574 6572 0a0a 2020 2020 2020 2020 636f  eter..        co
-00014260: 6d70 6172 655f 6469 6d65 6e73 696f 6e20  mpare_dimension 
-00014270: 3d20 6f70 7469 6d69 7a65 2e64 6973 706c  = optimize.displ
-00014280: 6179 5f6e 616d 650a 2020 2020 2020 2020  ay_name.        
-00014290: 6f70 7469 6d69 7a65 203d 206f 7074 696d  optimize = optim
-000142a0: 697a 652e 7363 6f72 6572 0a0a 2020 2020  ize.scorer..    
-000142b0: 2020 2020 2320 636f 6e76 6572 7420 7472      # convert tr
-000142c0: 6169 6e65 6420 6573 7469 6d61 746f 7220  ained estimator 
-000142d0: 696e 746f 2073 7472 696e 6720 6e61 6d65  into string name
-000142e0: 2066 6f72 2067 7269 6473 0a0a 2020 2020   for grids..    
-000142f0: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
-00014300: 696e 666f 2822 4368 6563 6b69 6e67 2062  info("Checking b
-00014310: 6173 6520 6d6f 6465 6c22 290a 0a20 2020  ase model")..   
-00014320: 2020 2020 2069 735f 7374 6163 6b65 645f       is_stacked_
-00014330: 6d6f 6465 6c20 3d20 4661 6c73 650a 0a20  model = False.. 
-00014340: 2020 2020 2020 2069 6620 6861 7361 7474         if hasatt
-00014350: 7228 6573 7469 6d61 746f 722c 2022 6669  r(estimator, "fi
-00014360: 6e61 6c5f 6573 7469 6d61 746f 7222 293a  nal_estimator"):
-00014370: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00014380: 662e 6c6f 6767 6572 2e69 6e66 6f28 224d  f.logger.info("M
-00014390: 6f64 656c 2069 7320 7374 6163 6b65 642c  odel is stacked,
-000143a0: 2075 7369 6e67 2074 6865 2064 6566 696e   using the defin
-000143b0: 6974 696f 6e20 6f66 2074 6865 206d 6574  ition of the met
-000143c0: 612d 6d6f 6465 6c22 290a 2020 2020 2020  a-model").      
-000143d0: 2020 2020 2020 6973 5f73 7461 636b 6564        is_stacked
-000143e0: 5f6d 6f64 656c 203d 2054 7275 650a 2020  _model = True.  
-000143f0: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-00014400: 746f 725f 6964 203d 2073 656c 662e 5f67  tor_id = self._g
-00014410: 6574 5f6d 6f64 656c 5f69 6428 6573 7469  et_model_id(esti
-00014420: 6d61 746f 722e 6669 6e61 6c5f 6573 7469  mator.final_esti
-00014430: 6d61 746f 7229 0a20 2020 2020 2020 2065  mator).        e
-00014440: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00014450: 2065 7374 696d 6174 6f72 5f69 6420 3d20   estimator_id = 
-00014460: 7365 6c66 2e5f 6765 745f 6d6f 6465 6c5f  self._get_model_
-00014470: 6964 2865 7374 696d 6174 6f72 290a 2020  id(estimator).  
-00014480: 2020 2020 2020 6966 2065 7374 696d 6174        if estimat
-00014490: 6f72 5f69 6420 6973 204e 6f6e 653a 0a20  or_id is None:. 
-000144a0: 2020 2020 2020 2020 2020 2069 6620 6375             if cu
-000144b0: 7374 6f6d 5f67 7269 6420 6973 204e 6f6e  stom_grid is Non
-000144c0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000144d0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000144e0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-000144f0: 2020 2020 2020 2020 2022 5768 656e 2070           "When p
-00014500: 6173 7369 6e67 2061 206d 6f64 656c 206e  assing a model n
-00014510: 6f74 2069 6e20 5079 4361 7265 7427 7320  ot in PyCaret's 
-00014520: 6d6f 6465 6c20 6c69 6272 6172 792c 2074  model library, t
-00014530: 6865 2063 7573 746f 6d5f 6772 6964 2070  he custom_grid p
-00014540: 6172 616d 6574 6572 206d 7573 7420 6265  arameter must be
-00014550: 2070 726f 7669 6465 642e 220a 2020 2020   provided.".    
-00014560: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00014570: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-00014580: 746f 725f 6e61 6d65 203d 2073 656c 662e  tor_name = self.
-00014590: 5f67 6574 5f6d 6f64 656c 5f6e 616d 6528  _get_model_name(
-000145a0: 6573 7469 6d61 746f 7229 0a20 2020 2020  estimator).     
-000145b0: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
-000145c0: 5f64 6566 696e 6974 696f 6e20 3d20 4e6f  _definition = No
-000145d0: 6e65 0a20 2020 2020 2020 2020 2020 2073  ne.            s
-000145e0: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
-000145f0: 2241 2063 7573 746f 6d20 6d6f 6465 6c20  "A custom model 
-00014600: 6861 7320 6265 656e 2070 6173 7365 6422  has been passed"
-00014610: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00014620: 2020 2020 2020 2020 2020 2020 6573 7469              esti
-00014630: 6d61 746f 725f 6465 6669 6e69 7469 6f6e  mator_definition
-00014640: 203d 2073 656c 662e 5f61 6c6c 5f6d 6f64   = self._all_mod
-00014650: 656c 735f 696e 7465 726e 616c 5b65 7374  els_internal[est
-00014660: 696d 6174 6f72 5f69 645d 0a20 2020 2020  imator_id].     
-00014670: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
-00014680: 5f6e 616d 6520 3d20 6573 7469 6d61 746f  _name = estimato
-00014690: 725f 6465 6669 6e69 7469 6f6e 2e6e 616d  r_definition.nam
-000146a0: 650a 2020 2020 2020 2020 7365 6c66 2e6c  e.        self.l
-000146b0: 6f67 6765 722e 696e 666f 2866 2242 6173  ogger.info(f"Bas
-000146c0: 6520 6d6f 6465 6c20 3a20 7b65 7374 696d  e model : {estim
-000146d0: 6174 6f72 5f6e 616d 657d 2229 0a0a 2020  ator_name}")..  
-000146e0: 2020 2020 2020 6966 2065 7374 696d 6174        if estimat
-000146f0: 6f72 5f64 6566 696e 6974 696f 6e20 6973  or_definition is
-00014700: 204e 6f6e 6520 6f72 2065 7374 696d 6174   None or estimat
-00014710: 6f72 5f64 6566 696e 6974 696f 6e2e 7475  or_definition.tu
-00014720: 6e61 626c 6520 6973 204e 6f6e 653a 0a20  nable is None:. 
-00014730: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-00014740: 203d 2063 6c6f 6e65 2865 7374 696d 6174   = clone(estimat
-00014750: 6f72 290a 2020 2020 2020 2020 656c 7365  or).        else
-00014760: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00014770: 6c66 2e6c 6f67 6765 722e 696e 666f 2822  lf.logger.info("
-00014780: 4d6f 6465 6c20 6861 7320 6120 7370 6563  Model has a spec
-00014790: 6961 6c20 7475 6e61 626c 6520 636c 6173  ial tunable clas
-000147a0: 732c 2075 7369 6e67 2074 6861 7422 290a  s, using that").
-000147b0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-000147c0: 6c20 3d20 636c 6f6e 6528 6573 7469 6d61  l = clone(estima
-000147d0: 746f 725f 6465 6669 6e69 7469 6f6e 2e74  tor_definition.t
-000147e0: 756e 6162 6c65 282a 2a65 7374 696d 6174  unable(**estimat
-000147f0: 6f72 2e67 6574 5f70 6172 616d 7328 2929  or.get_params())
-00014800: 290a 0a20 2020 2020 2020 2062 6173 655f  )..        base_
-00014810: 6573 7469 6d61 746f 7220 3d20 6d6f 6465  estimator = mode
-00014820: 6c0a 0a20 2020 2020 2020 2064 6973 706c  l..        displ
-00014830: 6179 2e75 7064 6174 655f 6d6f 6e69 746f  ay.update_monito
-00014840: 7228 322c 2065 7374 696d 6174 6f72 5f6e  r(2, estimator_n
-00014850: 616d 6529 0a0a 2020 2020 2020 2020 6469  ame)..        di
-00014860: 7370 6c61 792e 6d6f 7665 5f70 726f 6772  splay.move_progr
-00014870: 6573 7328 290a 0a20 2020 2020 2020 2073  ess()..        s
-00014880: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
-00014890: 2244 6563 6c61 7269 6e67 206d 6574 7269  "Declaring metri
-000148a0: 6320 7661 7269 6162 6c65 7322 290a 0a20  c variables").. 
-000148b0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000148c0: 2020 204d 4f4e 4954 4f52 2055 5044 4154     MONITOR UPDAT
-000148d0: 4520 5354 4152 5453 0a20 2020 2020 2020  E STARTS.       
-000148e0: 2022 2222 0a0a 2020 2020 2020 2020 6469   """..        di
-000148f0: 7370 6c61 792e 7570 6461 7465 5f6d 6f6e  splay.update_mon
-00014900: 6974 6f72 2831 2c20 2253 6561 7263 6869  itor(1, "Searchi
-00014910: 6e67 2048 7970 6572 7061 7261 6d65 7465  ng Hyperparamete
-00014920: 7273 2229 0a0a 2020 2020 2020 2020 2222  rs")..        ""
-00014930: 220a 2020 2020 2020 2020 4d4f 4e49 544f  ".        MONITO
-00014940: 5220 5550 4441 5445 2045 4e44 530a 2020  R UPDATE ENDS.  
-00014950: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00014960: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
-00014970: 6e66 6f28 2244 6566 696e 696e 6720 4879  nfo("Defining Hy
-00014980: 7065 7270 6172 616d 6574 6572 7322 290a  perparameters").
-00014990: 0a20 2020 2020 2020 2066 726f 6d20 7079  .        from py
-000149a0: 6361 7265 742e 696e 7465 726e 616c 2e74  caret.internal.t
-000149b0: 756e 6162 6c65 2069 6d70 6f72 7420 566f  unable import Vo
-000149c0: 7469 6e67 436c 6173 7369 6669 6572 2c20  tingClassifier, 
-000149d0: 566f 7469 6e67 5265 6772 6573 736f 720a  VotingRegressor.
-000149e0: 0a20 2020 2020 2020 2064 6566 2074 6f74  .        def tot
-000149f0: 616c 5f63 6f6d 6269 6e61 7469 6f6e 735f  al_combinations_
-00014a00: 696e 5f67 7269 6428 6772 6964 293a 0a20  in_grid(grid):. 
-00014a10: 2020 2020 2020 2020 2020 206e 6320 3d20             nc = 
-00014a20: 310a 0a20 2020 2020 2020 2020 2020 2064  1..            d
-00014a30: 6566 2067 6574 5f69 7465 7228 7829 3a0a  ef get_iter(x):.
-00014a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014a50: 6966 2069 7369 6e73 7461 6e63 6528 782c  if isinstance(x,
-00014a60: 2064 6963 7429 3a0a 2020 2020 2020 2020   dict):.        
-00014a70: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00014a80: 726e 2078 2e76 616c 7565 7328 290a 2020  rn x.values().  
-00014a90: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00014aa0: 7475 726e 2078 0a0a 2020 2020 2020 2020  turn x..        
-00014ab0: 2020 2020 666f 7220 7620 696e 2067 6574      for v in get
-00014ac0: 5f69 7465 7228 6772 6964 293a 0a20 2020  _iter(grid):.   
-00014ad0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00014ae0: 6973 696e 7374 616e 6365 2876 2c20 6469  isinstance(v, di
-00014af0: 6374 293a 0a20 2020 2020 2020 2020 2020  ct):.           
-00014b00: 2020 2020 2020 2020 2066 6f72 2076 3220           for v2 
-00014b10: 696e 2067 6574 5f69 7465 7228 7629 3a0a  in get_iter(v):.
+00014010: 2e20 2e20 2e22 2c0a 2020 2020 2020 2020  . . .",.        
+00014020: 2020 2020 2020 2020 2243 6f6d 7069 6c69          "Compili
+00014030: 6e67 204c 6962 7261 7279 222c 0a20 2020  ng Library",.   
+00014040: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+00014050: 2020 2020 5d0a 2020 2020 2020 2020 6469      ].        di
+00014060: 7370 6c61 7920 3d20 436f 6d6d 6f6e 4469  splay = CommonDi
+00014070: 7370 6c61 7928 0a20 2020 2020 2020 2020  splay(.         
+00014080: 2020 2076 6572 626f 7365 3d76 6572 626f     verbose=verbo
+00014090: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
+000140a0: 6874 6d6c 5f70 6172 616d 3d73 656c 662e  html_param=self.
+000140b0: 6874 6d6c 5f70 6172 616d 2c0a 2020 2020  html_param,.    
+000140c0: 2020 2020 2020 2020 7072 6f67 7265 7373          progress
+000140d0: 5f61 7267 733d 7072 6f67 7265 7373 5f61  _args=progress_a
+000140e0: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
+000140f0: 206d 6f6e 6974 6f72 5f72 6f77 733d 6d6f   monitor_rows=mo
+00014100: 6e69 746f 725f 726f 7773 2c0a 2020 2020  nitor_rows,.    
+00014110: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
+00014120: 6d70 6f72 7420 6c6f 6767 696e 670a 0a20  mport logging.. 
+00014130: 2020 2020 2020 206e 702e 7261 6e64 6f6d         np.random
+00014140: 2e73 6565 6428 7365 6c66 2e73 6565 6429  .seed(self.seed)
+00014150: 0a0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+00014160: 6f67 6765 722e 696e 666f 2822 436f 7079  ogger.info("Copy
+00014170: 696e 6720 7472 6169 6e69 6e67 2064 6174  ing training dat
+00014180: 6173 6574 2229 0a20 2020 2020 2020 2023  aset").        #
+00014190: 2053 746f 7269 6e67 2058 5f74 7261 696e   Storing X_train
+000141a0: 2061 6e64 2079 5f74 7261 696e 2069 6e20   and y_train in 
+000141b0: 6461 7461 5f58 2061 6e64 2064 6174 615f  data_X and data_
+000141c0: 7920 7061 7261 6d65 7465 720a 2020 2020  y parameter.    
+000141d0: 2020 2020 6461 7461 5f58 203d 2073 656c      data_X = sel
+000141e0: 662e 585f 7472 6169 6e0a 2020 2020 2020  f.X_train.      
+000141f0: 2020 6461 7461 5f79 203d 2073 656c 662e    data_y = self.
+00014200: 795f 7472 6169 6e0a 0a20 2020 2020 2020  y_train..       
+00014210: 2064 6973 706c 6179 2e6d 6f76 655f 7072   display.move_pr
+00014220: 6f67 7265 7373 2829 0a0a 2020 2020 2020  ogress()..      
+00014230: 2020 2320 7365 7474 696e 6720 6f70 7469    # setting opti
+00014240: 6d69 7a65 2070 6172 616d 6574 6572 0a0a  mize parameter..
+00014250: 2020 2020 2020 2020 636f 6d70 6172 655f          compare_
+00014260: 6469 6d65 6e73 696f 6e20 3d20 6f70 7469  dimension = opti
+00014270: 6d69 7a65 2e64 6973 706c 6179 5f6e 616d  mize.display_nam
+00014280: 650a 2020 2020 2020 2020 6f70 7469 6d69  e.        optimi
+00014290: 7a65 203d 206f 7074 696d 697a 652e 7363  ze = optimize.sc
+000142a0: 6f72 6572 0a0a 2020 2020 2020 2020 2320  orer..        # 
+000142b0: 636f 6e76 6572 7420 7472 6169 6e65 6420  convert trained 
+000142c0: 6573 7469 6d61 746f 7220 696e 746f 2073  estimator into s
+000142d0: 7472 696e 6720 6e61 6d65 2066 6f72 2067  tring name for g
+000142e0: 7269 6473 0a0a 2020 2020 2020 2020 7365  rids..        se
+000142f0: 6c66 2e6c 6f67 6765 722e 696e 666f 2822  lf.logger.info("
+00014300: 4368 6563 6b69 6e67 2062 6173 6520 6d6f  Checking base mo
+00014310: 6465 6c22 290a 0a20 2020 2020 2020 2069  del")..        i
+00014320: 735f 7374 6163 6b65 645f 6d6f 6465 6c20  s_stacked_model 
+00014330: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
+00014340: 2069 6620 6861 7361 7474 7228 6573 7469   if hasattr(esti
+00014350: 6d61 746f 722c 2022 6669 6e61 6c5f 6573  mator, "final_es
+00014360: 7469 6d61 746f 7222 293a 0a20 2020 2020  timator"):.     
+00014370: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+00014380: 6572 2e69 6e66 6f28 224d 6f64 656c 2069  er.info("Model i
+00014390: 7320 7374 6163 6b65 642c 2075 7369 6e67  s stacked, using
+000143a0: 2074 6865 2064 6566 696e 6974 696f 6e20   the definition 
+000143b0: 6f66 2074 6865 206d 6574 612d 6d6f 6465  of the meta-mode
+000143c0: 6c22 290a 2020 2020 2020 2020 2020 2020  l").            
+000143d0: 6973 5f73 7461 636b 6564 5f6d 6f64 656c  is_stacked_model
+000143e0: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
+000143f0: 2020 2020 6573 7469 6d61 746f 725f 6964      estimator_id
+00014400: 203d 2073 656c 662e 5f67 6574 5f6d 6f64   = self._get_mod
+00014410: 656c 5f69 6428 6573 7469 6d61 746f 722e  el_id(estimator.
+00014420: 6669 6e61 6c5f 6573 7469 6d61 746f 7229  final_estimator)
+00014430: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00014440: 2020 2020 2020 2020 2020 2065 7374 696d             estim
+00014450: 6174 6f72 5f69 6420 3d20 7365 6c66 2e5f  ator_id = self._
+00014460: 6765 745f 6d6f 6465 6c5f 6964 2865 7374  get_model_id(est
+00014470: 696d 6174 6f72 290a 2020 2020 2020 2020  imator).        
+00014480: 6966 2065 7374 696d 6174 6f72 5f69 6420  if estimator_id 
+00014490: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+000144a0: 2020 2020 2069 6620 6375 7374 6f6d 5f67       if custom_g
+000144b0: 7269 6420 6973 204e 6f6e 653a 0a20 2020  rid is None:.   
+000144c0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+000144d0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+000144e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000144f0: 2020 2022 5768 656e 2070 6173 7369 6e67     "When passing
+00014500: 2061 206d 6f64 656c 206e 6f74 2069 6e20   a model not in 
+00014510: 5079 4361 7265 7427 7320 6d6f 6465 6c20  PyCaret's model 
+00014520: 6c69 6272 6172 792c 2074 6865 2063 7573  library, the cus
+00014530: 746f 6d5f 6772 6964 2070 6172 616d 6574  tom_grid paramet
+00014540: 6572 206d 7573 7420 6265 2070 726f 7669  er must be provi
+00014550: 6465 642e 220a 2020 2020 2020 2020 2020  ded.".          
+00014560: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00014570: 2020 2020 6573 7469 6d61 746f 725f 6e61      estimator_na
+00014580: 6d65 203d 2073 656c 662e 5f67 6574 5f6d  me = self._get_m
+00014590: 6f64 656c 5f6e 616d 6528 6573 7469 6d61  odel_name(estima
+000145a0: 746f 7229 0a20 2020 2020 2020 2020 2020  tor).           
+000145b0: 2065 7374 696d 6174 6f72 5f64 6566 696e   estimator_defin
+000145c0: 6974 696f 6e20 3d20 4e6f 6e65 0a20 2020  ition = None.   
+000145d0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
+000145e0: 6767 6572 2e69 6e66 6f28 2241 2063 7573  gger.info("A cus
+000145f0: 746f 6d20 6d6f 6465 6c20 6861 7320 6265  tom model has be
+00014600: 656e 2070 6173 7365 6422 290a 2020 2020  en passed").    
+00014610: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00014620: 2020 2020 2020 6573 7469 6d61 746f 725f        estimator_
+00014630: 6465 6669 6e69 7469 6f6e 203d 2073 656c  definition = sel
+00014640: 662e 5f61 6c6c 5f6d 6f64 656c 735f 696e  f._all_models_in
+00014650: 7465 726e 616c 5b65 7374 696d 6174 6f72  ternal[estimator
+00014660: 5f69 645d 0a20 2020 2020 2020 2020 2020  _id].           
+00014670: 2065 7374 696d 6174 6f72 5f6e 616d 6520   estimator_name 
+00014680: 3d20 6573 7469 6d61 746f 725f 6465 6669  = estimator_defi
+00014690: 6e69 7469 6f6e 2e6e 616d 650a 2020 2020  nition.name.    
+000146a0: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
+000146b0: 696e 666f 2866 2242 6173 6520 6d6f 6465  info(f"Base mode
+000146c0: 6c20 3a20 7b65 7374 696d 6174 6f72 5f6e  l : {estimator_n
+000146d0: 616d 657d 2229 0a0a 2020 2020 2020 2020  ame}")..        
+000146e0: 6966 2065 7374 696d 6174 6f72 5f64 6566  if estimator_def
+000146f0: 696e 6974 696f 6e20 6973 204e 6f6e 6520  inition is None 
+00014700: 6f72 2065 7374 696d 6174 6f72 5f64 6566  or estimator_def
+00014710: 696e 6974 696f 6e2e 7475 6e61 626c 6520  inition.tunable 
+00014720: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00014730: 2020 2020 206d 6f64 656c 203d 2063 6c6f       model = clo
+00014740: 6e65 2865 7374 696d 6174 6f72 290a 2020  ne(estimator).  
+00014750: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00014760: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+00014770: 6765 722e 696e 666f 2822 4d6f 6465 6c20  ger.info("Model 
+00014780: 6861 7320 6120 7370 6563 6961 6c20 7475  has a special tu
+00014790: 6e61 626c 6520 636c 6173 732c 2075 7369  nable class, usi
+000147a0: 6e67 2074 6861 7422 290a 2020 2020 2020  ng that").      
+000147b0: 2020 2020 2020 6d6f 6465 6c20 3d20 636c        model = cl
+000147c0: 6f6e 6528 6573 7469 6d61 746f 725f 6465  one(estimator_de
+000147d0: 6669 6e69 7469 6f6e 2e74 756e 6162 6c65  finition.tunable
+000147e0: 282a 2a65 7374 696d 6174 6f72 2e67 6574  (**estimator.get
+000147f0: 5f70 6172 616d 7328 2929 290a 0a20 2020  _params()))..   
+00014800: 2020 2020 2062 6173 655f 6573 7469 6d61       base_estima
+00014810: 746f 7220 3d20 6d6f 6465 6c0a 0a20 2020  tor = model..   
+00014820: 2020 2020 2064 6973 706c 6179 2e75 7064       display.upd
+00014830: 6174 655f 6d6f 6e69 746f 7228 322c 2065  ate_monitor(2, e
+00014840: 7374 696d 6174 6f72 5f6e 616d 6529 0a0a  stimator_name)..
+00014850: 2020 2020 2020 2020 6469 7370 6c61 792e          display.
+00014860: 6d6f 7665 5f70 726f 6772 6573 7328 290a  move_progress().
+00014870: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
+00014880: 6767 6572 2e69 6e66 6f28 2244 6563 6c61  gger.info("Decla
+00014890: 7269 6e67 206d 6574 7269 6320 7661 7269  ring metric vari
+000148a0: 6162 6c65 7322 290a 0a20 2020 2020 2020  ables")..       
+000148b0: 2022 2222 0a20 2020 2020 2020 204d 4f4e   """.        MON
+000148c0: 4954 4f52 2055 5044 4154 4520 5354 4152  ITOR UPDATE STAR
+000148d0: 5453 0a20 2020 2020 2020 2022 2222 0a0a  TS.        """..
+000148e0: 2020 2020 2020 2020 6469 7370 6c61 792e          display.
+000148f0: 7570 6461 7465 5f6d 6f6e 6974 6f72 2831  update_monitor(1
+00014900: 2c20 2253 6561 7263 6869 6e67 2048 7970  , "Searching Hyp
+00014910: 6572 7061 7261 6d65 7465 7273 2229 0a0a  erparameters")..
+00014920: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00014930: 2020 2020 4d4f 4e49 544f 5220 5550 4441      MONITOR UPDA
+00014940: 5445 2045 4e44 530a 2020 2020 2020 2020  TE ENDS.        
+00014950: 2222 220a 0a20 2020 2020 2020 2073 656c  """..        sel
+00014960: 662e 6c6f 6767 6572 2e69 6e66 6f28 2244  f.logger.info("D
+00014970: 6566 696e 696e 6720 4879 7065 7270 6172  efining Hyperpar
+00014980: 616d 6574 6572 7322 290a 0a20 2020 2020  ameters")..     
+00014990: 2020 2066 726f 6d20 7079 6361 7265 742e     from pycaret.
+000149a0: 696e 7465 726e 616c 2e74 756e 6162 6c65  internal.tunable
+000149b0: 2069 6d70 6f72 7420 566f 7469 6e67 436c   import VotingCl
+000149c0: 6173 7369 6669 6572 2c20 566f 7469 6e67  assifier, Voting
+000149d0: 5265 6772 6573 736f 720a 0a20 2020 2020  Regressor..     
+000149e0: 2020 2064 6566 2074 6f74 616c 5f63 6f6d     def total_com
+000149f0: 6269 6e61 7469 6f6e 735f 696e 5f67 7269  binations_in_gri
+00014a00: 6428 6772 6964 293a 0a20 2020 2020 2020  d(grid):.       
+00014a10: 2020 2020 206e 6320 3d20 310a 0a20 2020       nc = 1..   
+00014a20: 2020 2020 2020 2020 2064 6566 2067 6574           def get
+00014a30: 5f69 7465 7228 7829 3a0a 2020 2020 2020  _iter(x):.      
+00014a40: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+00014a50: 6e73 7461 6e63 6528 782c 2064 6963 7429  nstance(x, dict)
+00014a60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014a70: 2020 2020 2020 7265 7475 726e 2078 2e76        return x.v
+00014a80: 616c 7565 7328 290a 2020 2020 2020 2020  alues().        
+00014a90: 2020 2020 2020 2020 7265 7475 726e 2078          return x
+00014aa0: 0a0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+00014ab0: 7220 7620 696e 2067 6574 5f69 7465 7228  r v in get_iter(
+00014ac0: 6772 6964 293a 0a20 2020 2020 2020 2020  grid):.         
+00014ad0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00014ae0: 616e 6365 2876 2c20 6469 6374 293a 0a20  ance(v, dict):. 
+00014af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014b00: 2020 2066 6f72 2076 3220 696e 2067 6574     for v2 in get
+00014b10: 5f69 7465 7228 7629 3a0a 2020 2020 2020  _iter(v):.      
 00014b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014b30: 2020 2020 2020 2020 6e63 202a 3d20 6c65          nc *= le
-00014b40: 6e28 7632 290a 2020 2020 2020 2020 2020  n(v2).          
-00014b50: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00014b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014b70: 6e63 202a 3d20 6c65 6e28 7629 0a20 2020  nc *= len(v).   
-00014b80: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00014b90: 6e63 0a0a 2020 2020 2020 2020 6966 2063  nc..        if c
-00014ba0: 7573 746f 6d5f 6772 6964 2069 7320 6e6f  ustom_grid is no
-00014bb0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00014bc0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-00014bd0: 7461 6e63 6528 6375 7374 6f6d 5f67 7269  tance(custom_gri
-00014be0: 642c 2064 6963 7429 3a0a 2020 2020 2020  d, dict):.      
-00014bf0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00014c00: 5479 7065 4572 726f 7228 6622 6375 7374  TypeError(f"cust
-00014c10: 6f6d 5f67 7269 6420 6d75 7374 2062 6520  om_grid must be 
-00014c20: 6120 6469 6374 2c20 676f 7420 7b74 7970  a dict, got {typ
-00014c30: 6528 6375 7374 6f6d 5f67 7269 6429 7d2e  e(custom_grid)}.
-00014c40: 2229 0a20 2020 2020 2020 2020 2020 2070  ").            p
-00014c50: 6172 616d 5f67 7269 6420 3d20 6375 7374  aram_grid = cust
-00014c60: 6f6d 5f67 7269 640a 2020 2020 2020 2020  om_grid.        
-00014c70: 2020 2020 6966 206e 6f74 2028 0a20 2020      if not (.   
-00014c80: 2020 2020 2020 2020 2020 2020 2073 6561               sea
-00014c90: 7263 685f 6c69 6272 6172 7920 3d3d 2022  rch_library == "
-00014ca0: 7363 696b 6974 2d6c 6561 726e 220a 2020  scikit-learn".  
-00014cb0: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-00014cc0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00014cd0: 2020 2020 2020 2073 6561 7263 685f 6c69         search_li
-00014ce0: 6272 6172 7920 3d3d 2022 7475 6e65 2d73  brary == "tune-s
-00014cf0: 6b6c 6561 726e 220a 2020 2020 2020 2020  klearn".        
-00014d00: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00014d10: 2873 6561 7263 685f 616c 676f 7269 7468  (search_algorith
-00014d20: 6d20 3d3d 2022 6772 6964 2220 6f72 2073  m == "grid" or s
-00014d30: 6561 7263 685f 616c 676f 7269 7468 6d20  earch_algorithm 
-00014d40: 3d3d 2022 7261 6e64 6f6d 2229 0a20 2020  == "random").   
-00014d50: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00014d60: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
-00014d70: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00014d80: 7261 6d5f 6772 6964 203d 207b 0a20 2020  ram_grid = {.   
-00014d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014da0: 206b 3a20 4361 7465 676f 7269 6361 6c44   k: CategoricalD
-00014db0: 6973 7472 6962 7574 696f 6e28 7629 2069  istribution(v) i
-00014dc0: 6620 6973 696e 7374 616e 6365 2876 2c20  f isinstance(v, 
-00014dd0: 4974 6572 6162 6c65 2920 656c 7365 2076  Iterable) else v
-00014de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014df0: 2020 2020 2066 6f72 206b 2c20 7620 696e       for k, v in
-00014e00: 2070 6172 616d 5f67 7269 642e 6974 656d   param_grid.item
-00014e10: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
-00014e20: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
-00014e30: 2020 656c 6966 2061 6e79 2869 7369 6e73    elif any(isins
-00014e40: 7461 6e63 6528 762c 2044 6973 7472 6962  tance(v, Distrib
-00014e50: 7574 696f 6e29 2066 6f72 206b 2c20 7620  ution) for k, v 
-00014e60: 696e 2070 6172 616d 5f67 7269 642e 6974  in param_grid.it
-00014e70: 656d 7328 2929 3a0a 2020 2020 2020 2020  ems()):.        
-00014e80: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00014e90: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
-00014ea0: 2020 2020 2020 2020 2020 2020 2066 2246               f"F
-00014eb0: 6f72 2074 6865 2063 6f6d 6269 6e61 7469  or the combinati
-00014ec0: 6f6e 206f 6620 7365 6172 6368 5f6c 6962  on of search_lib
-00014ed0: 7261 7279 207b 7365 6172 6368 5f6c 6962  rary {search_lib
-00014ee0: 7261 7279 7d20 616e 6420 7365 6172 6368  rary} and search
-00014ef0: 5f61 6c67 6f72 6974 686d 207b 7365 6172  _algorithm {sear
-00014f00: 6368 5f61 6c67 6f72 6974 686d 7d2c 2050  ch_algorithm}, P
-00014f10: 7943 6172 6574 2044 6973 7472 6962 7574  yCaret Distribut
-00014f20: 696f 6e20 6f62 6a65 6374 7320 6172 6520  ion objects are 
-00014f30: 6e6f 7420 7375 7070 6f72 7465 642e 2050  not supported. P
-00014f40: 6173 7320 6120 6c69 7374 206f 7220 6f74  ass a list or ot
-00014f50: 6865 7220 6f62 6a65 6374 2073 7570 706f  her object suppo
-00014f60: 7274 6564 2062 7920 7468 6520 7365 6172  rted by the sear
-00014f70: 6368 206c 6962 7261 7279 2028 696e 206d  ch library (in m
-00014f80: 6f73 7420 6361 7365 732c 2061 6e20 6f62  ost cases, an ob
-00014f90: 6a65 6374 2077 6974 6820 6120 2772 7673  ject with a 'rvs
-00014fa0: 2720 6675 6e63 7469 6f6e 292e 220a 2020  ' function).".  
-00014fb0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00014fc0: 2020 2020 2020 2020 656c 6966 2073 6561          elif sea
-00014fd0: 7263 685f 6c69 6272 6172 7920 3d3d 2022  rch_library == "
-00014fe0: 7363 696b 6974 2d6c 6561 726e 2220 6f72  scikit-learn" or
-00014ff0: 2028 0a20 2020 2020 2020 2020 2020 2073   (.            s
-00015000: 6561 7263 685f 6c69 6272 6172 7920 3d3d  earch_library ==
-00015010: 2022 7475 6e65 2d73 6b6c 6561 726e 220a   "tune-sklearn".
-00015020: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00015030: 2873 6561 7263 685f 616c 676f 7269 7468  (search_algorith
-00015040: 6d20 3d3d 2022 6772 6964 2220 6f72 2073  m == "grid" or s
-00015050: 6561 7263 685f 616c 676f 7269 7468 6d20  earch_algorithm 
-00015060: 3d3d 2022 7261 6e64 6f6d 2229 0a20 2020  == "random").   
-00015070: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-00015080: 2020 2020 7061 7261 6d5f 6772 6964 203d      param_grid =
-00015090: 2065 7374 696d 6174 6f72 5f64 6566 696e   estimator_defin
-000150a0: 6974 696f 6e2e 7475 6e65 5f67 7269 640a  ition.tune_grid.
-000150b0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-000150c0: 7369 6e73 7461 6e63 6528 6261 7365 5f65  sinstance(base_e
-000150d0: 7374 696d 6174 6f72 2c20 2856 6f74 696e  stimator, (Votin
-000150e0: 6743 6c61 7373 6966 6965 722c 2056 6f74  gClassifier, Vot
-000150f0: 696e 6752 6567 7265 7373 6f72 2929 3a0a  ingRegressor)):.
-00015100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015110: 2320 7370 6563 6961 6c20 6361 7365 2074  # special case t
-00015120: 6f20 6861 6e64 6c65 2056 6f74 696e 6743  o handle VotingC
-00015130: 6c61 7373 6966 6965 722c 2061 7320 7765  lassifier, as we
-00015140: 6967 6874 7320 6e65 6564 2074 6f20 6265  ights need to be
-00015150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015160: 2023 2067 656e 6572 6174 6564 2064 796e   # generated dyn
-00015170: 616d 6963 616c 6c79 0a20 2020 2020 2020  amically.       
-00015180: 2020 2020 2020 2020 2070 6172 616d 5f67           param_g
-00015190: 7269 6420 3d20 7b0a 2020 2020 2020 2020  rid = {.        
-000151a0: 2020 2020 2020 2020 2020 2020 6622 7765              f"we
-000151b0: 6967 6874 5f7b 697d 223a 206e 702e 6172  ight_{i}": np.ar
-000151c0: 616e 6765 2830 2e30 312c 2031 2c20 302e  ange(0.01, 1, 0.
-000151d0: 3031 290a 2020 2020 2020 2020 2020 2020  01).            
-000151e0: 2020 2020 2020 2020 666f 7220 692c 2065          for i, e
-000151f0: 2069 6e20 656e 756d 6572 6174 6528 6261   in enumerate(ba
-00015200: 7365 5f65 7374 696d 6174 6f72 2e65 7374  se_estimator.est
-00015210: 696d 6174 6f72 7329 0a20 2020 2020 2020  imators).       
-00015220: 2020 2020 2020 2020 207d 0a0a 2020 2020           }..    
-00015230: 2020 2020 2020 2020 6966 2073 6561 7263          if searc
-00015240: 685f 616c 676f 7269 7468 6d20 213d 2022  h_algorithm != "
-00015250: 6772 6964 223a 0a20 2020 2020 2020 2020  grid":.         
-00015260: 2020 2020 2020 2074 6320 3d20 746f 7461         tc = tota
-00015270: 6c5f 636f 6d62 696e 6174 696f 6e73 5f69  l_combinations_i
-00015280: 6e5f 6772 6964 2870 6172 616d 5f67 7269  n_grid(param_gri
-00015290: 6429 0a20 2020 2020 2020 2020 2020 2020  d).             
-000152a0: 2020 2069 6620 7463 203c 3d20 6e5f 6974     if tc <= n_it
-000152b0: 6572 3a0a 2020 2020 2020 2020 2020 2020  er:.            
-000152c0: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-000152d0: 6765 722e 696e 666f 280a 2020 2020 2020  ger.info(.      
-000152e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000152f0: 2020 6622 7b6e 5f69 7465 727d 2069 7320    f"{n_iter} is 
-00015300: 6269 6767 6572 2074 6861 6e20 746f 7461  bigger than tota
-00015310: 6c20 636f 6d62 696e 6174 696f 6e73 207b  l combinations {
-00015320: 7463 7d2c 2073 6574 7469 6e67 2073 6561  tc}, setting sea
-00015330: 7263 6820 616c 676f 7269 7468 6d20 746f  rch algorithm to
-00015340: 2067 7269 6422 0a20 2020 2020 2020 2020   grid".         
-00015350: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00015360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015370: 2073 6561 7263 685f 616c 676f 7269 7468   search_algorith
-00015380: 6d20 3d20 2267 7269 6422 0a20 2020 2020  m = "grid".     
-00015390: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000153a0: 2020 2020 2070 6172 616d 5f67 7269 6420       param_grid 
-000153b0: 3d20 6573 7469 6d61 746f 725f 6465 6669  = estimator_defi
-000153c0: 6e69 7469 6f6e 2e74 756e 655f 6469 7374  nition.tune_dist
-000153d0: 7269 6275 7469 6f6e 0a0a 2020 2020 2020  ribution..      
-000153e0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-000153f0: 6e63 6528 6261 7365 5f65 7374 696d 6174  nce(base_estimat
-00015400: 6f72 2c20 2856 6f74 696e 6743 6c61 7373  or, (VotingClass
-00015410: 6966 6965 722c 2056 6f74 696e 6752 6567  ifier, VotingReg
-00015420: 7265 7373 6f72 2929 3a0a 2020 2020 2020  ressor)):.      
-00015430: 2020 2020 2020 2020 2020 2320 7370 6563            # spec
-00015440: 6961 6c20 6361 7365 2074 6f20 6861 6e64  ial case to hand
-00015450: 6c65 2056 6f74 696e 6743 6c61 7373 6966  le VotingClassif
-00015460: 6965 722c 2061 7320 7765 6967 6874 7320  ier, as weights 
-00015470: 6e65 6564 2074 6f20 6265 0a20 2020 2020  need to be.     
-00015480: 2020 2020 2020 2020 2020 2023 2067 656e             # gen
-00015490: 6572 6174 6564 2064 796e 616d 6963 616c  erated dynamical
-000154a0: 6c79 0a20 2020 2020 2020 2020 2020 2020  ly.             
-000154b0: 2020 2070 6172 616d 5f67 7269 6420 3d20     param_grid = 
-000154c0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-000154d0: 2020 2020 2020 6622 7765 6967 6874 5f7b        f"weight_{
-000154e0: 697d 223a 2055 6e69 666f 726d 4469 7374  i}": UniformDist
-000154f0: 7269 6275 7469 6f6e 2830 2e30 3030 3030  ribution(0.00000
-00015500: 3030 3031 2c20 3129 0a20 2020 2020 2020  0001, 1).       
-00015510: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00015520: 2069 2c20 6520 696e 2065 6e75 6d65 7261   i, e in enumera
-00015530: 7465 2862 6173 655f 6573 7469 6d61 746f  te(base_estimato
-00015540: 722e 6573 7469 6d61 746f 7273 290a 2020  r.estimators).  
-00015550: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
-00015560: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00015570: 7061 7261 6d5f 6772 6964 3a0a 2020 2020  param_grid:.    
-00015580: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00015590: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-000155a0: 2020 2020 2020 2020 2020 2270 6172 616d            "param
-000155b0: 6574 6572 2067 7269 6420 666f 7220 7475  eter grid for tu
-000155c0: 6e69 6e67 2069 7320 656d 7074 792e 2049  ning is empty. I
-000155d0: 6620 7061 7373 696e 6720 6375 7374 6f6d  f passing custom
-000155e0: 5f67 7269 642c 206d 616b 6520 7375 7265  _grid, make sure
-000155f0: 2074 6861 7420 6974 2069 7320 6e6f 7420   that it is not 
-00015600: 656d 7074 792e 2049 6620 6e6f 7420 7061  empty. If not pa
-00015610: 7373 696e 6720 6375 7374 6f6d 5f67 7269  ssing custom_gri
-00015620: 642c 2074 6865 2070 6173 7365 6420 6573  d, the passed es
-00015630: 7469 6d61 746f 7220 646f 6573 206e 6f74  timator does not
-00015640: 2068 6176 6520 6120 6275 696c 742d 696e   have a built-in
-00015650: 2074 756e 696e 6720 6772 6964 2e22 0a20   tuning grid.". 
-00015660: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00015670: 2020 2020 2020 7375 6666 6978 6573 203d        suffixes =
-00015680: 205b 5d0a 0a20 2020 2020 2020 2069 6620   []..        if 
-00015690: 6973 5f73 7461 636b 6564 5f6d 6f64 656c  is_stacked_model
-000156a0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-000156b0: 6c66 2e6c 6f67 6765 722e 696e 666f 280a  lf.logger.info(.
-000156c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000156d0: 2253 7461 636b 6564 206d 6f64 656c 2070  "Stacked model p
-000156e0: 6173 7365 642c 2077 696c 6c20 7475 6e65  assed, will tune
-000156f0: 206d 6574 6120 6d6f 6465 6c20 6879 7065   meta model hype
-00015700: 7270 6172 616d 6574 6572 7322 0a20 2020  rparameters".   
-00015710: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00015720: 2020 2020 2020 2073 7566 6669 7865 732e         suffixes.
-00015730: 6170 7065 6e64 2822 6669 6e61 6c5f 6573  append("final_es
-00015740: 7469 6d61 746f 7222 290a 0a20 2020 2020  timator")..     
-00015750: 2020 2067 632e 636f 6c6c 6563 7428 290a     gc.collect().
-00015760: 0a20 2020 2020 2020 2077 6974 6820 6573  .        with es
-00015770: 7469 6d61 746f 725f 7069 7065 6c69 6e65  timator_pipeline
-00015780: 2873 656c 662e 7069 7065 6c69 6e65 2c20  (self.pipeline, 
-00015790: 6d6f 6465 6c29 2061 7320 7069 7065 6c69  model) as pipeli
-000157a0: 6e65 5f77 6974 685f 6d6f 6465 6c3a 0a20  ne_with_model:. 
-000157b0: 2020 2020 2020 2020 2020 2065 7874 7261             extra
-000157c0: 5f70 6172 616d 7320 3d20 7b7d 0a0a 2020  _params = {}..  
-000157d0: 2020 2020 2020 2020 2020 6669 745f 6b77            fit_kw
-000157e0: 6172 6773 203d 2067 6574 5f70 6970 656c  args = get_pipel
-000157f0: 696e 655f 6669 745f 6b77 6172 6773 2870  ine_fit_kwargs(p
-00015800: 6970 656c 696e 655f 7769 7468 5f6d 6f64  ipeline_with_mod
-00015810: 656c 2c20 6669 745f 6b77 6172 6773 290a  el, fit_kwargs).
-00015820: 0a20 2020 2020 2020 2020 2020 2061 6374  .            act
-00015830: 7561 6c5f 6573 7469 6d61 746f 725f 6c61  ual_estimator_la
-00015840: 6265 6c20 3d20 6765 745f 7069 7065 6c69  bel = get_pipeli
-00015850: 6e65 5f65 7374 696d 6174 6f72 5f6c 6162  ne_estimator_lab
-00015860: 656c 2870 6970 656c 696e 655f 7769 7468  el(pipeline_with
-00015870: 5f6d 6f64 656c 290a 0a20 2020 2020 2020  _model)..       
-00015880: 2020 2020 2073 7566 6669 7865 732e 6170       suffixes.ap
-00015890: 7065 6e64 2861 6374 7561 6c5f 6573 7469  pend(actual_esti
-000158a0: 6d61 746f 725f 6c61 6265 6c29 0a0a 2020  mator_label)..  
-000158b0: 2020 2020 2020 2020 2020 7375 6666 6978            suffix
-000158c0: 6573 203d 2022 5f5f 222e 6a6f 696e 2872  es = "__".join(r
-000158d0: 6576 6572 7365 6428 7375 6666 6978 6573  eversed(suffixes
-000158e0: 2929 0a0a 2020 2020 2020 2020 2020 2020  ))..            
-000158f0: 7061 7261 6d5f 6772 6964 203d 207b 6622  param_grid = {f"
-00015900: 7b73 7566 6669 7865 737d 5f5f 7b6b 7d22  {suffixes}__{k}"
-00015910: 3a20 7620 666f 7220 6b2c 2076 2069 6e20  : v for k, v in 
-00015920: 7061 7261 6d5f 6772 6964 2e69 7465 6d73  param_grid.items
-00015930: 2829 7d0a 0a20 2020 2020 2020 2020 2020  ()}..           
-00015940: 2069 6620 6573 7469 6d61 746f 725f 6465   if estimator_de
-00015950: 6669 6e69 7469 6f6e 2069 7320 6e6f 7420  finition is not 
-00015960: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00015970: 2020 2020 2020 7365 6172 6368 5f6b 7761        search_kwa
-00015980: 7267 7320 3d20 7b2a 2a65 7374 696d 6174  rgs = {**estimat
-00015990: 6f72 5f64 6566 696e 6974 696f 6e2e 7475  or_definition.tu
-000159a0: 6e65 5f61 7267 732c 202a 2a6b 7761 7267  ne_args, **kwarg
-000159b0: 737d 0a20 2020 2020 2020 2020 2020 2020  s}.             
-000159c0: 2020 206e 5f6a 6f62 7320 3d20 280a 2020     n_jobs = (.  
-000159d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000159e0: 2020 7365 6c66 2e67 7075 5f6e 5f6a 6f62    self.gpu_n_job
-000159f0: 735f 7061 7261 6d0a 2020 2020 2020 2020  s_param.        
-00015a00: 2020 2020 2020 2020 2020 2020 6966 2065              if e
-00015a10: 7374 696d 6174 6f72 5f64 6566 696e 6974  stimator_definit
-00015a20: 696f 6e2e 6973 5f67 7075 5f65 6e61 626c  ion.is_gpu_enabl
-00015a30: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
-00015a40: 2020 2020 2020 2065 6c73 6520 7365 6c66         else self
-00015a50: 2e6e 5f6a 6f62 735f 7061 7261 6d0a 2020  .n_jobs_param.  
-00015a60: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00015a70: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00015a80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00015a90: 2020 7365 6172 6368 5f6b 7761 7267 7320    search_kwargs 
-00015aa0: 3d20 7b7d 0a20 2020 2020 2020 2020 2020  = {}.           
-00015ab0: 2020 2020 206e 5f6a 6f62 7320 3d20 7365       n_jobs = se
-00015ac0: 6c66 2e6e 5f6a 6f62 735f 7061 7261 6d0a  lf.n_jobs_param.
-00015ad0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00015ae0: 6375 7374 6f6d 5f67 7269 6420 6973 206e  custom_grid is n
-00015af0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00015b00: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
-00015b10: 6767 6572 2e69 6e66 6f28 6622 6375 7374  gger.info(f"cust
-00015b20: 6f6d 5f67 7269 643a 207b 7061 7261 6d5f  om_grid: {param_
-00015b30: 6772 6964 7d22 290a 0a20 2020 2020 2020  grid}")..       
-00015b40: 2020 2020 2066 726f 6d20 736b 6c65 6172       from sklear
-00015b50: 6e2e 6761 7573 7369 616e 5f70 726f 6365  n.gaussian_proce
-00015b60: 7373 2069 6d70 6f72 7420 4761 7573 7369  ss import Gaussi
-00015b70: 616e 5072 6f63 6573 7343 6c61 7373 6966  anProcessClassif
-00015b80: 6965 720a 0a20 2020 2020 2020 2020 2020  ier..           
-00015b90: 2023 2073 7065 6369 616c 2063 6173 6520   # special case 
-00015ba0: 746f 2070 7265 7665 6e74 2072 756e 6e69  to prevent runni
-00015bb0: 6e67 206f 7574 206f 6620 6d65 6d6f 7279  ng out of memory
-00015bc0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00015bd0: 6973 696e 7374 616e 6365 2870 6970 656c  isinstance(pipel
-00015be0: 696e 655f 7769 7468 5f6d 6f64 656c 2e73  ine_with_model.s
-00015bf0: 7465 7073 5b2d 315d 5b31 5d2c 2047 6175  teps[-1][1], Gau
-00015c00: 7373 6961 6e50 726f 6365 7373 436c 6173  ssianProcessClas
-00015c10: 7369 6669 6572 293a 0a20 2020 2020 2020  sifier):.       
-00015c20: 2020 2020 2020 2020 206e 5f6a 6f62 7320           n_jobs 
-00015c30: 3d20 310a 0a20 2020 2020 2020 2020 2020  = 1..           
-00015c40: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
-00015c50: 6f28 6622 5475 6e69 6e67 2077 6974 6820  o(f"Tuning with 
-00015c60: 6e5f 6a6f 6273 3d7b 6e5f 6a6f 6273 7d22  n_jobs={n_jobs}"
-00015c70: 290a 0a20 2020 2020 2020 2020 2020 2064  )..            d
-00015c80: 6566 2067 6574 5f6f 7074 756e 615f 7470  ef get_optuna_tp
-00015c90: 655f 7361 6d70 6c65 7228 293a 0a20 2020  e_sampler():.   
-00015ca0: 2020 2020 2020 2020 2020 2020 2074 7279               try
-00015cb0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00015cc0: 2020 2020 2020 7470 655f 7361 6d70 6c65        tpe_sample
-00015cd0: 7220 3d20 6f70 7475 6e61 2e73 616d 706c  r = optuna.sampl
-00015ce0: 6572 732e 5450 4553 616d 706c 6572 280a  ers.TPESampler(.
+00014b30: 2020 6e63 202a 3d20 6c65 6e28 7632 290a    nc *= len(v2).
+00014b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014b50: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00014b60: 2020 2020 2020 2020 2020 6e63 202a 3d20            nc *= 
+00014b70: 6c65 6e28 7629 0a20 2020 2020 2020 2020  len(v).         
+00014b80: 2020 2072 6574 7572 6e20 6e63 0a0a 2020     return nc..  
+00014b90: 2020 2020 2020 6966 2063 7573 746f 6d5f        if custom_
+00014ba0: 6772 6964 2069 7320 6e6f 7420 4e6f 6e65  grid is not None
+00014bb0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00014bc0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00014bd0: 6375 7374 6f6d 5f67 7269 642c 2064 6963  custom_grid, dic
+00014be0: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+00014bf0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+00014c00: 726f 7228 6622 6375 7374 6f6d 5f67 7269  ror(f"custom_gri
+00014c10: 6420 6d75 7374 2062 6520 6120 6469 6374  d must be a dict
+00014c20: 2c20 676f 7420 7b74 7970 6528 6375 7374  , got {type(cust
+00014c30: 6f6d 5f67 7269 6429 7d2e 2229 0a20 2020  om_grid)}.").   
+00014c40: 2020 2020 2020 2020 2070 6172 616d 5f67           param_g
+00014c50: 7269 6420 3d20 6375 7374 6f6d 5f67 7269  rid = custom_gri
+00014c60: 640a 2020 2020 2020 2020 2020 2020 6966  d.            if
+00014c70: 206e 6f74 2028 0a20 2020 2020 2020 2020   not (.         
+00014c80: 2020 2020 2020 2073 6561 7263 685f 6c69         search_li
+00014c90: 6272 6172 7920 3d3d 2022 7363 696b 6974  brary == "scikit
+00014ca0: 2d6c 6561 726e 220a 2020 2020 2020 2020  -learn".        
+00014cb0: 2020 2020 2020 2020 6f72 2028 0a20 2020          or (.   
+00014cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014cd0: 2073 6561 7263 685f 6c69 6272 6172 7920   search_library 
+00014ce0: 3d3d 2022 7475 6e65 2d73 6b6c 6561 726e  == "tune-sklearn
+00014cf0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00014d00: 2020 2020 2020 616e 6420 2873 6561 7263        and (searc
+00014d10: 685f 616c 676f 7269 7468 6d20 3d3d 2022  h_algorithm == "
+00014d20: 6772 6964 2220 6f72 2073 6561 7263 685f  grid" or search_
+00014d30: 616c 676f 7269 7468 6d20 3d3d 2022 7261  algorithm == "ra
+00014d40: 6e64 6f6d 2229 0a20 2020 2020 2020 2020  ndom").         
+00014d50: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00014d60: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+00014d70: 2020 2020 2020 2020 7061 7261 6d5f 6772          param_gr
+00014d80: 6964 203d 207b 0a20 2020 2020 2020 2020  id = {.         
+00014d90: 2020 2020 2020 2020 2020 206b 3a20 4361             k: Ca
+00014da0: 7465 676f 7269 6361 6c44 6973 7472 6962  tegoricalDistrib
+00014db0: 7574 696f 6e28 7629 2069 6620 6973 696e  ution(v) if isin
+00014dc0: 7374 616e 6365 2876 2c20 4974 6572 6162  stance(v, Iterab
+00014dd0: 6c65 2920 656c 7365 2076 0a20 2020 2020  le) else v.     
+00014de0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00014df0: 6f72 206b 2c20 7620 696e 2070 6172 616d  or k, v in param
+00014e00: 5f67 7269 642e 6974 656d 7328 290a 2020  _grid.items().  
+00014e10: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
+00014e20: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00014e30: 2061 6e79 2869 7369 6e73 7461 6e63 6528   any(isinstance(
+00014e40: 762c 2044 6973 7472 6962 7574 696f 6e29  v, Distribution)
+00014e50: 2066 6f72 206b 2c20 7620 696e 2070 6172   for k, v in par
+00014e60: 616d 5f67 7269 642e 6974 656d 7328 2929  am_grid.items())
+00014e70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014e80: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+00014e90: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00014ea0: 2020 2020 2020 2066 2246 6f72 2074 6865         f"For the
+00014eb0: 2063 6f6d 6269 6e61 7469 6f6e 206f 6620   combination of 
+00014ec0: 7365 6172 6368 5f6c 6962 7261 7279 207b  search_library {
+00014ed0: 7365 6172 6368 5f6c 6962 7261 7279 7d20  search_library} 
+00014ee0: 616e 6420 7365 6172 6368 5f61 6c67 6f72  and search_algor
+00014ef0: 6974 686d 207b 7365 6172 6368 5f61 6c67  ithm {search_alg
+00014f00: 6f72 6974 686d 7d2c 2050 7943 6172 6574  orithm}, PyCaret
+00014f10: 2044 6973 7472 6962 7574 696f 6e20 6f62   Distribution ob
+00014f20: 6a65 6374 7320 6172 6520 6e6f 7420 7375  jects are not su
+00014f30: 7070 6f72 7465 642e 2050 6173 7320 6120  pported. Pass a 
+00014f40: 6c69 7374 206f 7220 6f74 6865 7220 6f62  list or other ob
+00014f50: 6a65 6374 2073 7570 706f 7274 6564 2062  ject supported b
+00014f60: 7920 7468 6520 7365 6172 6368 206c 6962  y the search lib
+00014f70: 7261 7279 2028 696e 206d 6f73 7420 6361  rary (in most ca
+00014f80: 7365 732c 2061 6e20 6f62 6a65 6374 2077  ses, an object w
+00014f90: 6974 6820 6120 2772 7673 2720 6675 6e63  ith a 'rvs' func
+00014fa0: 7469 6f6e 292e 220a 2020 2020 2020 2020  tion).".        
+00014fb0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00014fc0: 2020 656c 6966 2073 6561 7263 685f 6c69    elif search_li
+00014fd0: 6272 6172 7920 3d3d 2022 7363 696b 6974  brary == "scikit
+00014fe0: 2d6c 6561 726e 2220 6f72 2028 0a20 2020  -learn" or (.   
+00014ff0: 2020 2020 2020 2020 2073 6561 7263 685f           search_
+00015000: 6c69 6272 6172 7920 3d3d 2022 7475 6e65  library == "tune
+00015010: 2d73 6b6c 6561 726e 220a 2020 2020 2020  -sklearn".      
+00015020: 2020 2020 2020 616e 6420 2873 6561 7263        and (searc
+00015030: 685f 616c 676f 7269 7468 6d20 3d3d 2022  h_algorithm == "
+00015040: 6772 6964 2220 6f72 2073 6561 7263 685f  grid" or search_
+00015050: 616c 676f 7269 7468 6d20 3d3d 2022 7261  algorithm == "ra
+00015060: 6e64 6f6d 2229 0a20 2020 2020 2020 2029  ndom").        )
+00015070: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
+00015080: 7261 6d5f 6772 6964 203d 2065 7374 696d  ram_grid = estim
+00015090: 6174 6f72 5f64 6566 696e 6974 696f 6e2e  ator_definition.
+000150a0: 7475 6e65 5f67 7269 640a 2020 2020 2020  tune_grid.      
+000150b0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+000150c0: 6e63 6528 6261 7365 5f65 7374 696d 6174  nce(base_estimat
+000150d0: 6f72 2c20 2856 6f74 696e 6743 6c61 7373  or, (VotingClass
+000150e0: 6966 6965 722c 2056 6f74 696e 6752 6567  ifier, VotingReg
+000150f0: 7265 7373 6f72 2929 3a0a 2020 2020 2020  ressor)):.      
+00015100: 2020 2020 2020 2020 2020 2320 7370 6563            # spec
+00015110: 6961 6c20 6361 7365 2074 6f20 6861 6e64  ial case to hand
+00015120: 6c65 2056 6f74 696e 6743 6c61 7373 6966  le VotingClassif
+00015130: 6965 722c 2061 7320 7765 6967 6874 7320  ier, as weights 
+00015140: 6e65 6564 2074 6f20 6265 0a20 2020 2020  need to be.     
+00015150: 2020 2020 2020 2020 2020 2023 2067 656e             # gen
+00015160: 6572 6174 6564 2064 796e 616d 6963 616c  erated dynamical
+00015170: 6c79 0a20 2020 2020 2020 2020 2020 2020  ly.             
+00015180: 2020 2070 6172 616d 5f67 7269 6420 3d20     param_grid = 
+00015190: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+000151a0: 2020 2020 2020 6622 7765 6967 6874 5f7b        f"weight_{
+000151b0: 697d 223a 206e 702e 6172 616e 6765 2830  i}": np.arange(0
+000151c0: 2e30 312c 2031 2c20 302e 3031 290a 2020  .01, 1, 0.01).  
+000151d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000151e0: 2020 666f 7220 692c 2065 2069 6e20 656e    for i, e in en
+000151f0: 756d 6572 6174 6528 6261 7365 5f65 7374  umerate(base_est
+00015200: 696d 6174 6f72 2e65 7374 696d 6174 6f72  imator.estimator
+00015210: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+00015220: 2020 207d 0a0a 2020 2020 2020 2020 2020     }..          
+00015230: 2020 6966 2073 6561 7263 685f 616c 676f    if search_algo
+00015240: 7269 7468 6d20 213d 2022 6772 6964 223a  rithm != "grid":
+00015250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015260: 2074 6320 3d20 746f 7461 6c5f 636f 6d62   tc = total_comb
+00015270: 696e 6174 696f 6e73 5f69 6e5f 6772 6964  inations_in_grid
+00015280: 2870 6172 616d 5f67 7269 6429 0a20 2020  (param_grid).   
+00015290: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000152a0: 7463 203c 3d20 6e5f 6974 6572 3a0a 2020  tc <= n_iter:.  
+000152b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000152c0: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
+000152d0: 666f 280a 2020 2020 2020 2020 2020 2020  fo(.            
+000152e0: 2020 2020 2020 2020 2020 2020 6622 7b6e              f"{n
+000152f0: 5f69 7465 727d 2069 7320 6269 6767 6572  _iter} is bigger
+00015300: 2074 6861 6e20 746f 7461 6c20 636f 6d62   than total comb
+00015310: 696e 6174 696f 6e73 207b 7463 7d2c 2073  inations {tc}, s
+00015320: 6574 7469 6e67 2073 6561 7263 6820 616c  etting search al
+00015330: 676f 7269 7468 6d20 746f 2067 7269 6422  gorithm to grid"
+00015340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015350: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00015360: 2020 2020 2020 2020 2020 2073 6561 7263             searc
+00015370: 685f 616c 676f 7269 7468 6d20 3d20 2267  h_algorithm = "g
+00015380: 7269 6422 0a20 2020 2020 2020 2065 6c73  rid".        els
+00015390: 653a 0a20 2020 2020 2020 2020 2020 2070  e:.            p
+000153a0: 6172 616d 5f67 7269 6420 3d20 6573 7469  aram_grid = esti
+000153b0: 6d61 746f 725f 6465 6669 6e69 7469 6f6e  mator_definition
+000153c0: 2e74 756e 655f 6469 7374 7269 6275 7469  .tune_distributi
+000153d0: 6f6e 0a0a 2020 2020 2020 2020 2020 2020  on..            
+000153e0: 6966 2069 7369 6e73 7461 6e63 6528 6261  if isinstance(ba
+000153f0: 7365 5f65 7374 696d 6174 6f72 2c20 2856  se_estimator, (V
+00015400: 6f74 696e 6743 6c61 7373 6966 6965 722c  otingClassifier,
+00015410: 2056 6f74 696e 6752 6567 7265 7373 6f72   VotingRegressor
+00015420: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+00015430: 2020 2020 2320 7370 6563 6961 6c20 6361      # special ca
+00015440: 7365 2074 6f20 6861 6e64 6c65 2056 6f74  se to handle Vot
+00015450: 696e 6743 6c61 7373 6966 6965 722c 2061  ingClassifier, a
+00015460: 7320 7765 6967 6874 7320 6e65 6564 2074  s weights need t
+00015470: 6f20 6265 0a20 2020 2020 2020 2020 2020  o be.           
+00015480: 2020 2020 2023 2067 656e 6572 6174 6564       # generated
+00015490: 2064 796e 616d 6963 616c 6c79 0a20 2020   dynamically.   
+000154a0: 2020 2020 2020 2020 2020 2020 2070 6172               par
+000154b0: 616d 5f67 7269 6420 3d20 7b0a 2020 2020  am_grid = {.    
+000154c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000154d0: 6622 7765 6967 6874 5f7b 697d 223a 2055  f"weight_{i}": U
+000154e0: 6e69 666f 726d 4469 7374 7269 6275 7469  niformDistributi
+000154f0: 6f6e 2830 2e30 3030 3030 3030 3031 2c20  on(0.000000001, 
+00015500: 3129 0a20 2020 2020 2020 2020 2020 2020  1).             
+00015510: 2020 2020 2020 2066 6f72 2069 2c20 6520         for i, e 
+00015520: 696e 2065 6e75 6d65 7261 7465 2862 6173  in enumerate(bas
+00015530: 655f 6573 7469 6d61 746f 722e 6573 7469  e_estimator.esti
+00015540: 6d61 746f 7273 290a 2020 2020 2020 2020  mators).        
+00015550: 2020 2020 2020 2020 7d0a 0a20 2020 2020          }..     
+00015560: 2020 2069 6620 6e6f 7420 7061 7261 6d5f     if not param_
+00015570: 6772 6964 3a0a 2020 2020 2020 2020 2020  grid:.          
+00015580: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00015590: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+000155a0: 2020 2020 2270 6172 616d 6574 6572 2067      "parameter g
+000155b0: 7269 6420 666f 7220 7475 6e69 6e67 2069  rid for tuning i
+000155c0: 7320 656d 7074 792e 2049 6620 7061 7373  s empty. If pass
+000155d0: 696e 6720 6375 7374 6f6d 5f67 7269 642c  ing custom_grid,
+000155e0: 206d 616b 6520 7375 7265 2074 6861 7420   make sure that 
+000155f0: 6974 2069 7320 6e6f 7420 656d 7074 792e  it is not empty.
+00015600: 2049 6620 6e6f 7420 7061 7373 696e 6720   If not passing 
+00015610: 6375 7374 6f6d 5f67 7269 642c 2074 6865  custom_grid, the
+00015620: 2070 6173 7365 6420 6573 7469 6d61 746f   passed estimato
+00015630: 7220 646f 6573 206e 6f74 2068 6176 6520  r does not have 
+00015640: 6120 6275 696c 742d 696e 2074 756e 696e  a built-in tunin
+00015650: 6720 6772 6964 2e22 0a20 2020 2020 2020  g grid.".       
+00015660: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00015670: 7375 6666 6978 6573 203d 205b 5d0a 0a20  suffixes = [].. 
+00015680: 2020 2020 2020 2069 6620 6973 5f73 7461         if is_sta
+00015690: 636b 6564 5f6d 6f64 656c 3a0a 2020 2020  cked_model:.    
+000156a0: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+000156b0: 6765 722e 696e 666f 280a 2020 2020 2020  ger.info(.      
+000156c0: 2020 2020 2020 2020 2020 2253 7461 636b            "Stack
+000156d0: 6564 206d 6f64 656c 2070 6173 7365 642c  ed model passed,
+000156e0: 2077 696c 6c20 7475 6e65 206d 6574 6120   will tune meta 
+000156f0: 6d6f 6465 6c20 6879 7065 7270 6172 616d  model hyperparam
+00015700: 6574 6572 7322 0a20 2020 2020 2020 2020  eters".         
+00015710: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00015720: 2073 7566 6669 7865 732e 6170 7065 6e64   suffixes.append
+00015730: 2822 6669 6e61 6c5f 6573 7469 6d61 746f  ("final_estimato
+00015740: 7222 290a 0a20 2020 2020 2020 2067 632e  r")..        gc.
+00015750: 636f 6c6c 6563 7428 290a 0a20 2020 2020  collect()..     
+00015760: 2020 2077 6974 6820 6573 7469 6d61 746f     with estimato
+00015770: 725f 7069 7065 6c69 6e65 2873 656c 662e  r_pipeline(self.
+00015780: 7069 7065 6c69 6e65 2c20 6d6f 6465 6c29  pipeline, model)
+00015790: 2061 7320 7069 7065 6c69 6e65 5f77 6974   as pipeline_wit
+000157a0: 685f 6d6f 6465 6c3a 0a20 2020 2020 2020  h_model:.       
+000157b0: 2020 2020 2065 7874 7261 5f70 6172 616d       extra_param
+000157c0: 7320 3d20 7b7d 0a0a 2020 2020 2020 2020  s = {}..        
+000157d0: 2020 2020 6669 745f 6b77 6172 6773 203d      fit_kwargs =
+000157e0: 2067 6574 5f70 6970 656c 696e 655f 6669   get_pipeline_fi
+000157f0: 745f 6b77 6172 6773 2870 6970 656c 696e  t_kwargs(pipelin
+00015800: 655f 7769 7468 5f6d 6f64 656c 2c20 6669  e_with_model, fi
+00015810: 745f 6b77 6172 6773 290a 0a20 2020 2020  t_kwargs)..     
+00015820: 2020 2020 2020 2061 6374 7561 6c5f 6573         actual_es
+00015830: 7469 6d61 746f 725f 6c61 6265 6c20 3d20  timator_label = 
+00015840: 6765 745f 7069 7065 6c69 6e65 5f65 7374  get_pipeline_est
+00015850: 696d 6174 6f72 5f6c 6162 656c 2870 6970  imator_label(pip
+00015860: 656c 696e 655f 7769 7468 5f6d 6f64 656c  eline_with_model
+00015870: 290a 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00015880: 7566 6669 7865 732e 6170 7065 6e64 2861  uffixes.append(a
+00015890: 6374 7561 6c5f 6573 7469 6d61 746f 725f  ctual_estimator_
+000158a0: 6c61 6265 6c29 0a0a 2020 2020 2020 2020  label)..        
+000158b0: 2020 2020 7375 6666 6978 6573 203d 2022      suffixes = "
+000158c0: 5f5f 222e 6a6f 696e 2872 6576 6572 7365  __".join(reverse
+000158d0: 6428 7375 6666 6978 6573 2929 0a0a 2020  d(suffixes))..  
+000158e0: 2020 2020 2020 2020 2020 7061 7261 6d5f            param_
+000158f0: 6772 6964 203d 207b 6622 7b73 7566 6669  grid = {f"{suffi
+00015900: 7865 737d 5f5f 7b6b 7d22 3a20 7620 666f  xes}__{k}": v fo
+00015910: 7220 6b2c 2076 2069 6e20 7061 7261 6d5f  r k, v in param_
+00015920: 6772 6964 2e69 7465 6d73 2829 7d0a 0a20  grid.items()}.. 
+00015930: 2020 2020 2020 2020 2020 2069 6620 6573             if es
+00015940: 7469 6d61 746f 725f 6465 6669 6e69 7469  timator_definiti
+00015950: 6f6e 2069 7320 6e6f 7420 4e6f 6e65 3a0a  on is not None:.
+00015960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015970: 7365 6172 6368 5f6b 7761 7267 7320 3d20  search_kwargs = 
+00015980: 7b2a 2a65 7374 696d 6174 6f72 5f64 6566  {**estimator_def
+00015990: 696e 6974 696f 6e2e 7475 6e65 5f61 7267  inition.tune_arg
+000159a0: 732c 202a 2a6b 7761 7267 737d 0a20 2020  s, **kwargs}.   
+000159b0: 2020 2020 2020 2020 2020 2020 206e 5f6a               n_j
+000159c0: 6f62 7320 3d20 280a 2020 2020 2020 2020  obs = (.        
+000159d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000159e0: 2e67 7075 5f6e 5f6a 6f62 735f 7061 7261  .gpu_n_jobs_para
+000159f0: 6d0a 2020 2020 2020 2020 2020 2020 2020  m.              
+00015a00: 2020 2020 2020 6966 2065 7374 696d 6174        if estimat
+00015a10: 6f72 5f64 6566 696e 6974 696f 6e2e 6973  or_definition.is
+00015a20: 5f67 7075 5f65 6e61 626c 6564 0a20 2020  _gpu_enabled.   
+00015a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015a40: 2065 6c73 6520 7365 6c66 2e6e 5f6a 6f62   else self.n_job
+00015a50: 735f 7061 7261 6d0a 2020 2020 2020 2020  s_param.        
+00015a60: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00015a70: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00015a80: 2020 2020 2020 2020 2020 2020 7365 6172              sear
+00015a90: 6368 5f6b 7761 7267 7320 3d20 7b7d 0a20  ch_kwargs = {}. 
+00015aa0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00015ab0: 5f6a 6f62 7320 3d20 7365 6c66 2e6e 5f6a  _jobs = self.n_j
+00015ac0: 6f62 735f 7061 7261 6d0a 0a20 2020 2020  obs_param..     
+00015ad0: 2020 2020 2020 2069 6620 6375 7374 6f6d         if custom
+00015ae0: 5f67 7269 6420 6973 206e 6f74 204e 6f6e  _grid is not Non
+00015af0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00015b00: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
+00015b10: 6e66 6f28 6622 6375 7374 6f6d 5f67 7269  nfo(f"custom_gri
+00015b20: 643a 207b 7061 7261 6d5f 6772 6964 7d22  d: {param_grid}"
+00015b30: 290a 0a20 2020 2020 2020 2020 2020 2066  )..            f
+00015b40: 726f 6d20 736b 6c65 6172 6e2e 6761 7573  rom sklearn.gaus
+00015b50: 7369 616e 5f70 726f 6365 7373 2069 6d70  sian_process imp
+00015b60: 6f72 7420 4761 7573 7369 616e 5072 6f63  ort GaussianProc
+00015b70: 6573 7343 6c61 7373 6966 6965 720a 0a20  essClassifier.. 
+00015b80: 2020 2020 2020 2020 2020 2023 2073 7065             # spe
+00015b90: 6369 616c 2063 6173 6520 746f 2070 7265  cial case to pre
+00015ba0: 7665 6e74 2072 756e 6e69 6e67 206f 7574  vent running out
+00015bb0: 206f 6620 6d65 6d6f 7279 0a20 2020 2020   of memory.     
+00015bc0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00015bd0: 616e 6365 2870 6970 656c 696e 655f 7769  ance(pipeline_wi
+00015be0: 7468 5f6d 6f64 656c 2e73 7465 7073 5b2d  th_model.steps[-
+00015bf0: 315d 5b31 5d2c 2047 6175 7373 6961 6e50  1][1], GaussianP
+00015c00: 726f 6365 7373 436c 6173 7369 6669 6572  rocessClassifier
+00015c10: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00015c20: 2020 206e 5f6a 6f62 7320 3d20 310a 0a20     n_jobs = 1.. 
+00015c30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00015c40: 6c6f 6767 6572 2e69 6e66 6f28 6622 5475  logger.info(f"Tu
+00015c50: 6e69 6e67 2077 6974 6820 6e5f 6a6f 6273  ning with n_jobs
+00015c60: 3d7b 6e5f 6a6f 6273 7d22 290a 0a20 2020  ={n_jobs}")..   
+00015c70: 2020 2020 2020 2020 2064 6566 2067 6574           def get
+00015c80: 5f6f 7074 756e 615f 7470 655f 7361 6d70  _optuna_tpe_samp
+00015c90: 6c65 7228 293a 0a20 2020 2020 2020 2020  ler():.         
+00015ca0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00015cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015cc0: 7470 655f 7361 6d70 6c65 7220 3d20 6f70  tpe_sampler = op
+00015cd0: 7475 6e61 2e73 616d 706c 6572 732e 5450  tuna.samplers.TP
+00015ce0: 4553 616d 706c 6572 280a 2020 2020 2020  ESampler(.      
 00015cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d00: 2020 2020 2020 2020 7365 6564 3d73 656c          seed=sel
-00015d10: 662e 7365 6564 2c20 6d75 6c74 6976 6172  f.seed, multivar
-00015d20: 6961 7465 3d54 7275 652c 2063 6f6e 7374  iate=True, const
-00015d30: 616e 745f 6c69 6172 3d54 7275 650a 2020  ant_liar=True.  
-00015d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d50: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00015d60: 2020 2020 6578 6365 7074 2054 7970 6545      except TypeE
-00015d70: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
-00015d80: 2020 2020 2020 2020 2020 2320 636f 6e73            # cons
-00015d90: 7461 6e74 5f6c 6961 7220 6164 6465 6420  tant_liar added 
-00015da0: 696e 2032 2e38 2e30 0a20 2020 2020 2020  in 2.8.0.       
-00015db0: 2020 2020 2020 2020 2020 2020 2074 7065               tpe
-00015dc0: 5f73 616d 706c 6572 203d 206f 7074 756e  _sampler = optun
-00015dd0: 612e 7361 6d70 6c65 7273 2e54 5045 5361  a.samplers.TPESa
-00015de0: 6d70 6c65 7228 0a20 2020 2020 2020 2020  mpler(.         
-00015df0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00015e00: 6565 643d 7365 6c66 2e73 6565 642c 206d  eed=self.seed, m
-00015e10: 756c 7469 7661 7269 6174 653d 5472 7565  ultivariate=True
-00015e20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015e30: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00015e40: 2020 2020 2020 2072 6574 7572 6e20 7470         return tp
-00015e50: 655f 7361 6d70 6c65 720a 0a20 2020 2020  e_sampler..     
-00015e60: 2020 2020 2020 2069 6620 7365 6172 6368         if search
-00015e70: 5f6c 6962 7261 7279 203d 3d20 226f 7074  _library == "opt
-00015e80: 756e 6122 3a0a 2020 2020 2020 2020 2020  una":.          
-00015e90: 2020 2020 2020 2320 7375 7070 7265 7373        # suppress
-00015ea0: 206f 7574 7075 740a 2020 2020 2020 2020   output.        
-00015eb0: 2020 2020 2020 2020 6c6f 6767 696e 672e          logging.
-00015ec0: 6765 744c 6f67 6765 7228 226f 7074 756e  getLogger("optun
-00015ed0: 6122 292e 7365 744c 6576 656c 286c 6f67  a").setLevel(log
-00015ee0: 6769 6e67 2e57 4152 4e49 4e47 290a 0a20  ging.WARNING).. 
-00015ef0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00015f00: 7275 6e65 725f 7472 616e 736c 6174 6f72  runer_translator
-00015f10: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00015f20: 2020 2020 2020 2020 2022 6173 6861 223a           "asha":
-00015f30: 206f 7074 756e 612e 7072 756e 6572 732e   optuna.pruners.
-00015f40: 5375 6363 6573 7369 7665 4861 6c76 696e  SuccessiveHalvin
-00015f50: 6750 7275 6e65 7228 292c 2020 2320 7479  gPruner(),  # ty
-00015f60: 7065 3a20 6967 6e6f 7265 0a20 2020 2020  pe: ignore.     
-00015f70: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00015f80: 6879 7065 7262 616e 6422 3a20 6f70 7475  hyperband": optu
-00015f90: 6e61 2e70 7275 6e65 7273 2e48 7970 6572  na.pruners.Hyper
-00015fa0: 6261 6e64 5072 756e 6572 2829 2c20 2023  bandPruner(),  #
-00015fb0: 2074 7970 653a 2069 676e 6f72 650a 2020   type: ignore.  
-00015fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015fd0: 2020 226d 6564 6961 6e22 3a20 6f70 7475    "median": optu
-00015fe0: 6e61 2e70 7275 6e65 7273 2e4d 6564 6961  na.pruners.Media
-00015ff0: 6e50 7275 6e65 7228 292c 2020 2320 7479  nPruner(),  # ty
-00016000: 7065 3a20 6967 6e6f 7265 0a20 2020 2020  pe: ignore.     
-00016010: 2020 2020 2020 2020 2020 2020 2020 2046                 F
-00016020: 616c 7365 3a20 6f70 7475 6e61 2e70 7275  alse: optuna.pru
-00016030: 6e65 7273 2e4e 6f70 5072 756e 6572 2829  ners.NopPruner()
-00016040: 2c20 2023 2074 7970 653a 2069 676e 6f72  ,  # type: ignor
-00016050: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00016060: 2020 2020 2020 4e6f 6e65 3a20 6f70 7475        None: optu
-00016070: 6e61 2e70 7275 6e65 7273 2e4e 6f70 5072  na.pruners.NopPr
-00016080: 756e 6572 2829 2c20 2023 2074 7970 653a  uner(),  # type:
-00016090: 2069 676e 6f72 650a 2020 2020 2020 2020   ignore.        
-000160a0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-000160b0: 2020 2020 2020 2020 2020 7072 756e 6572            pruner
-000160c0: 203d 2065 6172 6c79 5f73 746f 7070 696e   = early_stoppin
-000160d0: 670a 2020 2020 2020 2020 2020 2020 2020  g.              
-000160e0: 2020 6966 2070 7275 6e65 7220 696e 2070    if pruner in p
-000160f0: 7275 6e65 725f 7472 616e 736c 6174 6f72  runer_translator
-00016100: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00016110: 2020 2020 2020 7072 756e 6572 203d 2070        pruner = p
-00016120: 7275 6e65 725f 7472 616e 736c 6174 6f72  runer_translator
-00016130: 5b65 6172 6c79 5f73 746f 7070 696e 675d  [early_stopping]
-00016140: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00016150: 2020 7361 6d70 6c65 725f 7472 616e 736c    sampler_transl
-00016160: 6174 6f72 203d 207b 0a20 2020 2020 2020  ator = {.       
-00016170: 2020 2020 2020 2020 2020 2020 2022 7470               "tp
-00016180: 6522 3a20 6765 745f 6f70 7475 6e61 5f74  e": get_optuna_t
-00016190: 7065 5f73 616d 706c 6572 2829 2c20 2023  pe_sampler(),  #
-000161a0: 2074 7970 653a 2069 676e 6f72 650a 2020   type: ignore.  
-000161b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000161c0: 2020 2272 616e 646f 6d22 3a20 6f70 7475    "random": optu
-000161d0: 6e61 2e73 616d 706c 6572 732e 5261 6e64  na.samplers.Rand
-000161e0: 6f6d 5361 6d70 6c65 7228 7365 6564 3d73  omSampler(seed=s
-000161f0: 656c 662e 7365 6564 292c 2020 2320 7479  elf.seed),  # ty
-00016200: 7065 3a20 6967 6e6f 7265 0a20 2020 2020  pe: ignore.     
-00016210: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
-00016220: 2020 2020 2020 2020 2020 2020 2073 616d               sam
-00016230: 706c 6572 203d 2073 616d 706c 6572 5f74  pler = sampler_t
-00016240: 7261 6e73 6c61 746f 725b 7365 6172 6368  ranslator[search
-00016250: 5f61 6c67 6f72 6974 686d 5d0a 0a20 2020  _algorithm]..   
-00016260: 2020 2020 2020 2020 2020 2020 2074 7279               try
-00016270: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00016280: 2020 2020 2020 7061 7261 6d5f 6772 6964        param_grid
-00016290: 203d 2067 6574 5f6f 7074 756e 615f 6469   = get_optuna_di
-000162a0: 7374 7269 6275 7469 6f6e 7328 7061 7261  stributions(para
-000162b0: 6d5f 6772 6964 290a 2020 2020 2020 2020  m_grid).        
-000162c0: 2020 2020 2020 2020 6578 6365 7074 2045          except E
-000162d0: 7863 6570 7469 6f6e 3a0a 2020 2020 2020  xception:.      
-000162e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000162f0: 6c66 2e6c 6f67 6765 722e 7761 726e 696e  lf.logger.warnin
-00016300: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
-00016310: 2020 2020 2020 2020 2020 2022 436f 756c             "Coul
-00016320: 646e 2774 2063 6f6e 7665 7274 2070 6172  dn't convert par
-00016330: 616d 5f67 7269 6420 746f 2073 7065 6369  am_grid to speci
-00016340: 6669 6320 6c69 6272 6172 7920 6469 7374  fic library dist
-00016350: 7269 6275 7469 6f6e 732e 2045 7863 6570  ributions. Excep
-00016360: 7469 6f6e 3a22 0a20 2020 2020 2020 2020  tion:".         
-00016370: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00016380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016390: 2073 656c 662e 6c6f 6767 6572 2e77 6172   self.logger.war
-000163a0: 6e69 6e67 2874 7261 6365 6261 636b 2e66  ning(traceback.f
-000163b0: 6f72 6d61 745f 6578 6328 2929 0a0a 2020  ormat_exc())..  
-000163c0: 2020 2020 2020 2020 2020 2020 2020 7374                st
-000163d0: 7564 7920 3d20 6f70 7475 6e61 2e63 7265  udy = optuna.cre
-000163e0: 6174 655f 7374 7564 7928 2020 2320 7479  ate_study(  # ty
-000163f0: 7065 3a20 6967 6e6f 7265 0a20 2020 2020  pe: ignore.     
-00016400: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00016410: 6972 6563 7469 6f6e 3d22 6d61 7869 6d69  irection="maximi
-00016420: 7a65 222c 2073 616d 706c 6572 3d73 616d  ze", sampler=sam
-00016430: 706c 6572 2c20 7072 756e 6572 3d70 7275  pler, pruner=pru
-00016440: 6e65 720a 2020 2020 2020 2020 2020 2020  ner.            
-00016450: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-00016460: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
-00016470: 6572 2e69 6e66 6f28 2249 6e69 7469 616c  er.info("Initial
-00016480: 697a 696e 6720 6f70 7475 6e61 2e69 6e74  izing optuna.int
-00016490: 6567 7261 7469 6f6e 2e4f 7074 756e 6153  egration.OptunaS
-000164a0: 6561 7263 6843 5622 290a 2020 2020 2020  earchCV").      
-000164b0: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-000164c0: 6772 6964 203d 206f 7074 756e 612e 696e  grid = optuna.in
-000164d0: 7465 6772 6174 696f 6e2e 4f70 7475 6e61  tegration.Optuna
-000164e0: 5365 6172 6368 4356 2820 2023 2074 7970  SearchCV(  # typ
-000164f0: 653a 2069 676e 6f72 650a 2020 2020 2020  e: ignore.      
-00016500: 2020 2020 2020 2020 2020 2020 2020 6573                es
-00016510: 7469 6d61 746f 723d 7069 7065 6c69 6e65  timator=pipeline
-00016520: 5f77 6974 685f 6d6f 6465 6c2c 0a20 2020  _with_model,.   
-00016530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016540: 2070 6172 616d 5f64 6973 7472 6962 7574   param_distribut
-00016550: 696f 6e73 3d70 6172 616d 5f67 7269 642c  ions=param_grid,
-00016560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016570: 2020 2020 2063 763d 666f 6c64 2c0a 2020       cv=fold,.  
-00016580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016590: 2020 656e 6162 6c65 5f70 7275 6e69 6e67    enable_pruning
-000165a0: 3d65 6172 6c79 5f73 746f 7070 696e 670a  =early_stopping.
-000165b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000165c0: 2020 2020 616e 6420 6361 6e5f 6561 726c      and can_earl
-000165d0: 795f 7374 6f70 280a 2020 2020 2020 2020  y_stop(.        
-000165e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000165f0: 7069 7065 6c69 6e65 5f77 6974 685f 6d6f  pipeline_with_mo
-00016600: 6465 6c2c 2054 7275 652c 2046 616c 7365  del, True, False
-00016610: 2c20 4661 6c73 652c 2070 6172 616d 5f67  , False, param_g
-00016620: 7269 640a 2020 2020 2020 2020 2020 2020  rid.            
-00016630: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-00016640: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00016650: 6178 5f69 7465 723d 6561 726c 795f 7374  ax_iter=early_st
-00016660: 6f70 7069 6e67 5f6d 6178 5f69 7465 7273  opping_max_iters
-00016670: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00016680: 2020 2020 2020 6e5f 6a6f 6273 3d6e 5f6a        n_jobs=n_j
-00016690: 6f62 732c 0a20 2020 2020 2020 2020 2020  obs,.           
-000166a0: 2020 2020 2020 2020 206e 5f74 7269 616c           n_trial
-000166b0: 733d 6e5f 6974 6572 2c0a 2020 2020 2020  s=n_iter,.      
-000166c0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-000166d0: 6e64 6f6d 5f73 7461 7465 3d73 656c 662e  ndom_state=self.
-000166e0: 7365 6564 2c0a 2020 2020 2020 2020 2020  seed,.          
-000166f0: 2020 2020 2020 2020 2020 7363 6f72 696e            scorin
-00016700: 673d 6f70 7469 6d69 7a65 2c0a 2020 2020  g=optimize,.    
-00016710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016720: 7374 7564 793d 7374 7564 792c 0a20 2020  study=study,.   
-00016730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016740: 2072 6566 6974 3d46 616c 7365 2c0a 2020   refit=False,.  
-00016750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016760: 2020 7665 7262 6f73 653d 7475 6e65 725f    verbose=tuner_
-00016770: 7665 7262 6f73 652c 0a20 2020 2020 2020  verbose,.       
-00016780: 2020 2020 2020 2020 2020 2020 2065 7272               err
-00016790: 6f72 5f73 636f 7265 3d22 7261 6973 6522  or_score="raise"
-000167a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000167b0: 2020 2020 2020 2a2a 7365 6172 6368 5f6b        **search_k
-000167c0: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
-000167d0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-000167e0: 2020 2020 2020 656c 6966 2073 6561 7263        elif searc
-000167f0: 685f 6c69 6272 6172 7920 3d3d 2022 7475  h_library == "tu
-00016800: 6e65 2d73 6b6c 6561 726e 223a 0a0a 2020  ne-sklearn":..  
-00016810: 2020 2020 2020 2020 2020 2020 2020 6561                ea
-00016820: 726c 795f 7374 6f70 7069 6e67 5f74 7261  rly_stopping_tra
-00016830: 6e73 6c61 746f 7220 3d20 7b0a 2020 2020  nslator = {.    
-00016840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016850: 2261 7368 6122 3a20 2241 5348 4153 6368  "asha": "ASHASch
-00016860: 6564 756c 6572 222c 0a20 2020 2020 2020  eduler",.       
-00016870: 2020 2020 2020 2020 2020 2020 2022 6879               "hy
-00016880: 7065 7262 616e 6422 3a20 2248 7970 6572  perband": "Hyper
-00016890: 4261 6e64 5363 6865 6475 6c65 7222 2c0a  BandScheduler",.
-000168a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000168b0: 2020 2020 226d 6564 6961 6e22 3a20 224d      "median": "M
-000168c0: 6564 6961 6e53 746f 7070 696e 6752 756c  edianStoppingRul
-000168d0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-000168e0: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
-000168f0: 2020 2020 2020 6966 2065 6172 6c79 5f73        if early_s
-00016900: 746f 7070 696e 6720 696e 2065 6172 6c79  topping in early
-00016910: 5f73 746f 7070 696e 675f 7472 616e 736c  _stopping_transl
-00016920: 6174 6f72 3a0a 2020 2020 2020 2020 2020  ator:.          
-00016930: 2020 2020 2020 2020 2020 6561 726c 795f            early_
-00016940: 7374 6f70 7069 6e67 203d 2065 6172 6c79  stopping = early
-00016950: 5f73 746f 7070 696e 675f 7472 616e 736c  _stopping_transl
-00016960: 6174 6f72 5b65 6172 6c79 5f73 746f 7070  ator[early_stopp
-00016970: 696e 675d 0a0a 2020 2020 2020 2020 2020  ing]..          
-00016980: 2020 2020 2020 646f 5f65 6172 6c79 5f73        do_early_s
-00016990: 746f 7020 3d20 6561 726c 795f 7374 6f70  top = early_stop
-000169a0: 7069 6e67 2061 6e64 2063 616e 5f65 6172  ping and can_ear
-000169b0: 6c79 5f73 746f 7028 0a20 2020 2020 2020  ly_stop(.       
-000169c0: 2020 2020 2020 2020 2020 2020 2070 6970               pip
-000169d0: 656c 696e 655f 7769 7468 5f6d 6f64 656c  eline_with_model
-000169e0: 2c20 5472 7565 2c20 5472 7565 2c20 5472  , True, True, Tr
-000169f0: 7565 2c20 7061 7261 6d5f 6772 6964 0a20  ue, param_grid. 
-00016a00: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00016a10: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00016a20: 2020 6966 206e 6f74 2064 6f5f 6561 726c    if not do_earl
-00016a30: 795f 7374 6f70 2061 6e64 2073 6561 7263  y_stop and searc
-00016a40: 685f 616c 676f 7269 7468 6d20 3d3d 2022  h_algorithm == "
-00016a50: 626f 6862 223a 0a20 2020 2020 2020 2020  bohb":.         
-00016a60: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00016a70: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-00016a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a90: 2020 2020 2022 2762 6f68 6227 2072 6571       "'bohb' req
-00016aa0: 7569 7265 7320 6561 726c 795f 7374 6f70  uires early_stop
-00016ab0: 7069 6e67 203d 2054 7275 6520 616e 6420  ping = True and 
-00016ac0: 7468 6520 6573 7469 6d61 746f 7220 746f  the estimator to
-00016ad0: 2073 7570 706f 7274 2065 6172 6c79 2073   support early s
-00016ae0: 746f 7070 696e 6720 2868 6173 2070 6172  topping (has par
-00016af0: 7469 616c 5f66 6974 2c20 7761 726d 5f73  tial_fit, warm_s
-00016b00: 7461 7274 206f 7220 6973 2061 6e20 5847  tart or is an XG
-00016b10: 426f 6f73 7420 6d6f 6465 6c29 2e22 0a20  Boost model).". 
-00016b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b30: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
-00016b40: 2020 2020 2020 656c 6966 2065 6172 6c79        elif early
-00016b50: 5f73 746f 7070 696e 6720 616e 6420 6361  _stopping and ca
-00016b60: 6e5f 6561 726c 795f 7374 6f70 280a 2020  n_early_stop(.  
-00016b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b80: 2020 7069 7065 6c69 6e65 5f77 6974 685f    pipeline_with_
-00016b90: 6d6f 6465 6c2c 2046 616c 7365 2c20 5472  model, False, Tr
-00016ba0: 7565 2c20 4661 6c73 652c 2070 6172 616d  ue, False, param
-00016bb0: 5f67 7269 640a 2020 2020 2020 2020 2020  _grid.          
-00016bc0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-00016bd0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00016be0: 2261 6374 7561 6c5f 6573 7469 6d61 746f  "actual_estimato
-00016bf0: 725f 5f6e 5f65 7374 696d 6174 6f72 7322  r__n_estimators"
-00016c00: 2069 6e20 7061 7261 6d5f 6772 6964 3a0a   in param_grid:.
+00015d00: 2020 7365 6564 3d73 656c 662e 7365 6564    seed=self.seed
+00015d10: 2c20 6d75 6c74 6976 6172 6961 7465 3d54  , multivariate=T
+00015d20: 7275 652c 2063 6f6e 7374 616e 745f 6c69  rue, constant_li
+00015d30: 6172 3d54 7275 650a 2020 2020 2020 2020  ar=True.        
+00015d40: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00015d50: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00015d60: 6365 7074 2054 7970 6545 7272 6f72 3a0a  cept TypeError:.
+00015d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d80: 2020 2020 2320 636f 6e73 7461 6e74 5f6c      # constant_l
+00015d90: 6961 7220 6164 6465 6420 696e 2032 2e38  iar added in 2.8
+00015da0: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
+00015db0: 2020 2020 2020 2074 7065 5f73 616d 706c         tpe_sampl
+00015dc0: 6572 203d 206f 7074 756e 612e 7361 6d70  er = optuna.samp
+00015dd0: 6c65 7273 2e54 5045 5361 6d70 6c65 7228  lers.TPESampler(
+00015de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015df0: 2020 2020 2020 2020 2073 6565 643d 7365           seed=se
+00015e00: 6c66 2e73 6565 642c 206d 756c 7469 7661  lf.seed, multiva
+00015e10: 7269 6174 653d 5472 7565 0a20 2020 2020  riate=True.     
+00015e20: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00015e30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015e40: 2072 6574 7572 6e20 7470 655f 7361 6d70   return tpe_samp
+00015e50: 6c65 720a 0a20 2020 2020 2020 2020 2020  ler..           
+00015e60: 2069 6620 7365 6172 6368 5f6c 6962 7261   if search_libra
+00015e70: 7279 203d 3d20 226f 7074 756e 6122 3a0a  ry == "optuna":.
+00015e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015e90: 2320 7375 7070 7265 7373 206f 7574 7075  # suppress outpu
+00015ea0: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
+00015eb0: 2020 6c6f 6767 696e 672e 6765 744c 6f67    logging.getLog
+00015ec0: 6765 7228 226f 7074 756e 6122 292e 7365  ger("optuna").se
+00015ed0: 744c 6576 656c 286c 6f67 6769 6e67 2e57  tLevel(logging.W
+00015ee0: 4152 4e49 4e47 290a 0a20 2020 2020 2020  ARNING)..       
+00015ef0: 2020 2020 2020 2020 2070 7275 6e65 725f           pruner_
+00015f00: 7472 616e 736c 6174 6f72 203d 207b 0a20  translator = {. 
+00015f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015f20: 2020 2022 6173 6861 223a 206f 7074 756e     "asha": optun
+00015f30: 612e 7072 756e 6572 732e 5375 6363 6573  a.pruners.Succes
+00015f40: 7369 7665 4861 6c76 696e 6750 7275 6e65  siveHalvingPrune
+00015f50: 7228 292c 2020 2320 7479 7065 3a20 6967  r(),  # type: ig
+00015f60: 6e6f 7265 0a20 2020 2020 2020 2020 2020  nore.           
+00015f70: 2020 2020 2020 2020 2022 6879 7065 7262           "hyperb
+00015f80: 616e 6422 3a20 6f70 7475 6e61 2e70 7275  and": optuna.pru
+00015f90: 6e65 7273 2e48 7970 6572 6261 6e64 5072  ners.HyperbandPr
+00015fa0: 756e 6572 2829 2c20 2023 2074 7970 653a  uner(),  # type:
+00015fb0: 2069 676e 6f72 650a 2020 2020 2020 2020   ignore.        
+00015fc0: 2020 2020 2020 2020 2020 2020 226d 6564              "med
+00015fd0: 6961 6e22 3a20 6f70 7475 6e61 2e70 7275  ian": optuna.pru
+00015fe0: 6e65 7273 2e4d 6564 6961 6e50 7275 6e65  ners.MedianPrune
+00015ff0: 7228 292c 2020 2320 7479 7065 3a20 6967  r(),  # type: ig
+00016000: 6e6f 7265 0a20 2020 2020 2020 2020 2020  nore.           
+00016010: 2020 2020 2020 2020 2046 616c 7365 3a20           False: 
+00016020: 6f70 7475 6e61 2e70 7275 6e65 7273 2e4e  optuna.pruners.N
+00016030: 6f70 5072 756e 6572 2829 2c20 2023 2074  opPruner(),  # t
+00016040: 7970 653a 2069 676e 6f72 650a 2020 2020  ype: ignore.    
+00016050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016060: 4e6f 6e65 3a20 6f70 7475 6e61 2e70 7275  None: optuna.pru
+00016070: 6e65 7273 2e4e 6f70 5072 756e 6572 2829  ners.NopPruner()
+00016080: 2c20 2023 2074 7970 653a 2069 676e 6f72  ,  # type: ignor
+00016090: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+000160a0: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
+000160b0: 2020 2020 7072 756e 6572 203d 2065 6172      pruner = ear
+000160c0: 6c79 5f73 746f 7070 696e 670a 2020 2020  ly_stopping.    
+000160d0: 2020 2020 2020 2020 2020 2020 6966 2070              if p
+000160e0: 7275 6e65 7220 696e 2070 7275 6e65 725f  runer in pruner_
+000160f0: 7472 616e 736c 6174 6f72 3a0a 2020 2020  translator:.    
+00016100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016110: 7072 756e 6572 203d 2070 7275 6e65 725f  pruner = pruner_
+00016120: 7472 616e 736c 6174 6f72 5b65 6172 6c79  translator[early
+00016130: 5f73 746f 7070 696e 675d 0a0a 2020 2020  _stopping]..    
+00016140: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+00016150: 6c65 725f 7472 616e 736c 6174 6f72 203d  ler_translator =
+00016160: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00016170: 2020 2020 2020 2022 7470 6522 3a20 6765         "tpe": ge
+00016180: 745f 6f70 7475 6e61 5f74 7065 5f73 616d  t_optuna_tpe_sam
+00016190: 706c 6572 2829 2c20 2023 2074 7970 653a  pler(),  # type:
+000161a0: 2069 676e 6f72 650a 2020 2020 2020 2020   ignore.        
+000161b0: 2020 2020 2020 2020 2020 2020 2272 616e              "ran
+000161c0: 646f 6d22 3a20 6f70 7475 6e61 2e73 616d  dom": optuna.sam
+000161d0: 706c 6572 732e 5261 6e64 6f6d 5361 6d70  plers.RandomSamp
+000161e0: 6c65 7228 7365 6564 3d73 656c 662e 7365  ler(seed=self.se
+000161f0: 6564 292c 2020 2320 7479 7065 3a20 6967  ed),  # type: ig
+00016200: 6e6f 7265 0a20 2020 2020 2020 2020 2020  nore.           
+00016210: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
+00016220: 2020 2020 2020 2073 616d 706c 6572 203d         sampler =
+00016230: 2073 616d 706c 6572 5f74 7261 6e73 6c61   sampler_transla
+00016240: 746f 725b 7365 6172 6368 5f61 6c67 6f72  tor[search_algor
+00016250: 6974 686d 5d0a 0a20 2020 2020 2020 2020  ithm]..         
+00016260: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00016270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016280: 7061 7261 6d5f 6772 6964 203d 2067 6574  param_grid = get
+00016290: 5f6f 7074 756e 615f 6469 7374 7269 6275  _optuna_distribu
+000162a0: 7469 6f6e 7328 7061 7261 6d5f 6772 6964  tions(param_grid
+000162b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000162c0: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
+000162d0: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
+000162e0: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+000162f0: 6765 722e 7761 726e 696e 6728 0a20 2020  ger.warning(.   
+00016300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016310: 2020 2020 2022 436f 756c 646e 2774 2063       "Couldn't c
+00016320: 6f6e 7665 7274 2070 6172 616d 5f67 7269  onvert param_gri
+00016330: 6420 746f 2073 7065 6369 6669 6320 6c69  d to specific li
+00016340: 6272 6172 7920 6469 7374 7269 6275 7469  brary distributi
+00016350: 6f6e 732e 2045 7863 6570 7469 6f6e 3a22  ons. Exception:"
+00016360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016370: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00016380: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00016390: 6c6f 6767 6572 2e77 6172 6e69 6e67 2874  logger.warning(t
+000163a0: 7261 6365 6261 636b 2e66 6f72 6d61 745f  raceback.format_
+000163b0: 6578 6328 2929 0a0a 2020 2020 2020 2020  exc())..        
+000163c0: 2020 2020 2020 2020 7374 7564 7920 3d20          study = 
+000163d0: 6f70 7475 6e61 2e63 7265 6174 655f 7374  optuna.create_st
+000163e0: 7564 7928 2020 2320 7479 7065 3a20 6967  udy(  # type: ig
+000163f0: 6e6f 7265 0a20 2020 2020 2020 2020 2020  nore.           
+00016400: 2020 2020 2020 2020 2064 6972 6563 7469           directi
+00016410: 6f6e 3d22 6d61 7869 6d69 7a65 222c 2073  on="maximize", s
+00016420: 616d 706c 6572 3d73 616d 706c 6572 2c20  ampler=sampler, 
+00016430: 7072 756e 6572 3d70 7275 6e65 720a 2020  pruner=pruner.  
+00016440: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00016450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016460: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
+00016470: 6f28 2249 6e69 7469 616c 697a 696e 6720  o("Initializing 
+00016480: 6f70 7475 6e61 2e69 6e74 6567 7261 7469  optuna.integrati
+00016490: 6f6e 2e4f 7074 756e 6153 6561 7263 6843  on.OptunaSearchC
+000164a0: 5622 290a 2020 2020 2020 2020 2020 2020  V").            
+000164b0: 2020 2020 6d6f 6465 6c5f 6772 6964 203d      model_grid =
+000164c0: 206f 7074 756e 612e 696e 7465 6772 6174   optuna.integrat
+000164d0: 696f 6e2e 4f70 7475 6e61 5365 6172 6368  ion.OptunaSearch
+000164e0: 4356 2820 2023 2074 7970 653a 2069 676e  CV(  # type: ign
+000164f0: 6f72 650a 2020 2020 2020 2020 2020 2020  ore.            
+00016500: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
+00016510: 723d 7069 7065 6c69 6e65 5f77 6974 685f  r=pipeline_with_
+00016520: 6d6f 6465 6c2c 0a20 2020 2020 2020 2020  model,.         
+00016530: 2020 2020 2020 2020 2020 2070 6172 616d             param
+00016540: 5f64 6973 7472 6962 7574 696f 6e73 3d70  _distributions=p
+00016550: 6172 616d 5f67 7269 642c 0a20 2020 2020  aram_grid,.     
+00016560: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00016570: 763d 666f 6c64 2c0a 2020 2020 2020 2020  v=fold,.        
+00016580: 2020 2020 2020 2020 2020 2020 656e 6162              enab
+00016590: 6c65 5f70 7275 6e69 6e67 3d65 6172 6c79  le_pruning=early
+000165a0: 5f73 746f 7070 696e 670a 2020 2020 2020  _stopping.      
+000165b0: 2020 2020 2020 2020 2020 2020 2020 616e                an
+000165c0: 6420 6361 6e5f 6561 726c 795f 7374 6f70  d can_early_stop
+000165d0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000165e0: 2020 2020 2020 2020 2020 7069 7065 6c69            pipeli
+000165f0: 6e65 5f77 6974 685f 6d6f 6465 6c2c 2054  ne_with_model, T
+00016600: 7275 652c 2046 616c 7365 2c20 4661 6c73  rue, False, Fals
+00016610: 652c 2070 6172 616d 5f67 7269 640a 2020  e, param_grid.  
+00016620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016630: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
+00016640: 2020 2020 2020 2020 206d 6178 5f69 7465           max_ite
+00016650: 723d 6561 726c 795f 7374 6f70 7069 6e67  r=early_stopping
+00016660: 5f6d 6178 5f69 7465 7273 2c0a 2020 2020  _max_iters,.    
+00016670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016680: 6e5f 6a6f 6273 3d6e 5f6a 6f62 732c 0a20  n_jobs=n_jobs,. 
+00016690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000166a0: 2020 206e 5f74 7269 616c 733d 6e5f 6974     n_trials=n_it
+000166b0: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+000166c0: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
+000166d0: 7461 7465 3d73 656c 662e 7365 6564 2c0a  tate=self.seed,.
+000166e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000166f0: 2020 2020 7363 6f72 696e 673d 6f70 7469      scoring=opti
+00016700: 6d69 7a65 2c0a 2020 2020 2020 2020 2020  mize,.          
+00016710: 2020 2020 2020 2020 2020 7374 7564 793d            study=
+00016720: 7374 7564 792c 0a20 2020 2020 2020 2020  study,.         
+00016730: 2020 2020 2020 2020 2020 2072 6566 6974             refit
+00016740: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00016750: 2020 2020 2020 2020 2020 2020 7665 7262              verb
+00016760: 6f73 653d 7475 6e65 725f 7665 7262 6f73  ose=tuner_verbos
+00016770: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00016780: 2020 2020 2020 2065 7272 6f72 5f73 636f         error_sco
+00016790: 7265 3d22 7261 6973 6522 2c0a 2020 2020  re="raise",.    
+000167a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000167b0: 2a2a 7365 6172 6368 5f6b 7761 7267 732c  **search_kwargs,
+000167c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000167d0: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
+000167e0: 656c 6966 2073 6561 7263 685f 6c69 6272  elif search_libr
+000167f0: 6172 7920 3d3d 2022 7475 6e65 2d73 6b6c  ary == "tune-skl
+00016800: 6561 726e 223a 0a20 2020 2020 2020 2020  earn":.         
+00016810: 2020 2020 2020 2065 6172 6c79 5f73 746f         early_sto
+00016820: 7070 696e 675f 7472 616e 736c 6174 6f72  pping_translator
+00016830: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+00016840: 2020 2020 2020 2020 2022 6173 6861 223a           "asha":
+00016850: 2022 4153 4841 5363 6865 6475 6c65 7222   "ASHAScheduler"
+00016860: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00016870: 2020 2020 2020 2268 7970 6572 6261 6e64        "hyperband
+00016880: 223a 2022 4879 7065 7242 616e 6453 6368  ": "HyperBandSch
+00016890: 6564 756c 6572 222c 0a20 2020 2020 2020  eduler",.       
+000168a0: 2020 2020 2020 2020 2020 2020 2022 6d65               "me
+000168b0: 6469 616e 223a 2022 4d65 6469 616e 5374  dian": "MedianSt
+000168c0: 6f70 7069 6e67 5275 6c65 222c 0a20 2020  oppingRule",.   
+000168d0: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
+000168e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000168f0: 6620 6561 726c 795f 7374 6f70 7069 6e67  f early_stopping
+00016900: 2069 6e20 6561 726c 795f 7374 6f70 7069   in early_stoppi
+00016910: 6e67 5f74 7261 6e73 6c61 746f 723a 0a20  ng_translator:. 
+00016920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016930: 2020 2065 6172 6c79 5f73 746f 7070 696e     early_stoppin
+00016940: 6720 3d20 6561 726c 795f 7374 6f70 7069  g = early_stoppi
+00016950: 6e67 5f74 7261 6e73 6c61 746f 725b 6561  ng_translator[ea
+00016960: 726c 795f 7374 6f70 7069 6e67 5d0a 0a20  rly_stopping].. 
+00016970: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00016980: 6f5f 6561 726c 795f 7374 6f70 203d 2065  o_early_stop = e
+00016990: 6172 6c79 5f73 746f 7070 696e 6720 616e  arly_stopping an
+000169a0: 6420 6361 6e5f 6561 726c 795f 7374 6f70  d can_early_stop
+000169b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000169c0: 2020 2020 2020 7069 7065 6c69 6e65 5f77        pipeline_w
+000169d0: 6974 685f 6d6f 6465 6c2c 2054 7275 652c  ith_model, True,
+000169e0: 2054 7275 652c 2054 7275 652c 2070 6172   True, True, par
+000169f0: 616d 5f67 7269 640a 2020 2020 2020 2020  am_grid.        
+00016a00: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00016a10: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00016a20: 7420 646f 5f65 6172 6c79 5f73 746f 7020  t do_early_stop 
+00016a30: 616e 6420 7365 6172 6368 5f61 6c67 6f72  and search_algor
+00016a40: 6974 686d 203d 3d20 2262 6f68 6222 3a0a  ithm == "bohb":.
+00016a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a60: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00016a70: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00016a80: 2020 2020 2020 2020 2020 2020 2020 2227                "'
+00016a90: 626f 6862 2720 7265 7175 6972 6573 2065  bohb' requires e
+00016aa0: 6172 6c79 5f73 746f 7070 696e 6720 3d20  arly_stopping = 
+00016ab0: 5472 7565 2061 6e64 2074 6865 2065 7374  True and the est
+00016ac0: 696d 6174 6f72 2074 6f20 7375 7070 6f72  imator to suppor
+00016ad0: 7420 6561 726c 7920 7374 6f70 7069 6e67  t early stopping
+00016ae0: 2028 6861 7320 7061 7274 6961 6c5f 6669   (has partial_fi
+00016af0: 742c 2077 6172 6d5f 7374 6172 7420 6f72  t, warm_start or
+00016b00: 2069 7320 616e 2058 4742 6f6f 7374 206d   is an XGBoost m
+00016b10: 6f64 656c 292e 220a 2020 2020 2020 2020  odel).".        
+00016b20: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00016b30: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00016b40: 6c69 6620 6561 726c 795f 7374 6f70 7069  lif early_stoppi
+00016b50: 6e67 2061 6e64 2063 616e 5f65 6172 6c79  ng and can_early
+00016b60: 5f73 746f 7028 0a20 2020 2020 2020 2020  _stop(.         
+00016b70: 2020 2020 2020 2020 2020 2070 6970 656c             pipel
+00016b80: 696e 655f 7769 7468 5f6d 6f64 656c 2c20  ine_with_model, 
+00016b90: 4661 6c73 652c 2054 7275 652c 2046 616c  False, True, Fal
+00016ba0: 7365 2c20 7061 7261 6d5f 6772 6964 0a20  se, param_grid. 
+00016bb0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00016bc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00016bd0: 2020 2020 2020 6966 2022 6163 7475 616c        if "actual
+00016be0: 5f65 7374 696d 6174 6f72 5f5f 6e5f 6573  _estimator__n_es
+00016bf0: 7469 6d61 746f 7273 2220 696e 2070 6172  timators" in par
+00016c00: 616d 5f67 7269 643a 0a20 2020 2020 2020  am_grid:.       
 00016c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c20: 2020 2020 2020 2020 6966 2063 7573 746f          if custo
-00016c30: 6d5f 6772 6964 2069 7320 4e6f 6e65 3a0a  m_grid is None:.
+00016c20: 2069 6620 6375 7374 6f6d 5f67 7269 6420   if custom_grid 
+00016c30: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
 00016c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c50: 2020 2020 2020 2020 2020 2020 6578 7472              extr
-00016c60: 615f 7061 7261 6d73 5b0a 2020 2020 2020  a_params[.      
+00016c50: 2020 2020 2065 7874 7261 5f70 6172 616d       extra_param
+00016c60: 735b 0a20 2020 2020 2020 2020 2020 2020  s[.             
 00016c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c80: 2020 2020 2020 2020 2020 2261 6374 7561            "actua
-00016c90: 6c5f 6573 7469 6d61 746f 725f 5f6e 5f65  l_estimator__n_e
-00016ca0: 7374 696d 6174 6f72 7322 0a20 2020 2020  stimators".     
+00016c80: 2020 2022 6163 7475 616c 5f65 7374 696d     "actual_estim
+00016c90: 6174 6f72 5f5f 6e5f 6573 7469 6d61 746f  ator__n_estimato
+00016ca0: 7273 220a 2020 2020 2020 2020 2020 2020  rs".            
 00016cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016cc0: 2020 2020 2020 205d 203d 2070 6970 656c         ] = pipel
-00016cd0: 696e 655f 7769 7468 5f6d 6f64 656c 2e67  ine_with_model.g
-00016ce0: 6574 5f70 6172 616d 7328 295b 0a20 2020  et_params()[.   
+00016cc0: 5d20 3d20 7069 7065 6c69 6e65 5f77 6974  ] = pipeline_wit
+00016cd0: 685f 6d6f 6465 6c2e 6765 745f 7061 7261  h_model.get_para
+00016ce0: 6d73 2829 5b0a 2020 2020 2020 2020 2020  ms()[.          
 00016cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d00: 2020 2020 2020 2020 2020 2020 2022 6163               "ac
-00016d10: 7475 616c 5f65 7374 696d 6174 6f72 5f5f  tual_estimator__
-00016d20: 6e5f 6573 7469 6d61 746f 7273 220a 2020  n_estimators".  
+00016d00: 2020 2020 2020 2261 6374 7561 6c5f 6573        "actual_es
+00016d10: 7469 6d61 746f 725f 5f6e 5f65 7374 696d  timator__n_estim
+00016d20: 6174 6f72 7322 0a20 2020 2020 2020 2020  ators".         
 00016d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d40: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
+00016d40: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
 00016d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d60: 2020 2020 2020 2020 7061 7261 6d5f 6772          param_gr
-00016d70: 6964 2e70 6f70 2822 6163 7475 616c 5f65  id.pop("actual_e
-00016d80: 7374 696d 6174 6f72 5f5f 6e5f 6573 7469  stimator__n_esti
-00016d90: 6d61 746f 7273 2229 0a20 2020 2020 2020  mators").       
-00016da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016db0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00016dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016dd0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00016de0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00016df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e00: 2020 2020 2022 7061 7261 6d65 7465 7220       "parameter 
-00016e10: 6772 6964 2063 616e 6e6f 7420 636f 6e74  grid cannot cont
-00016e20: 6169 6e20 6e5f 6573 7469 6d61 746f 7273  ain n_estimators
-00016e30: 206f 7220 6d61 785f 6974 6572 2069 6620   or max_iter if 
-00016e40: 6561 726c 795f 7374 6f70 7069 6e67 2069  early_stopping i
-00016e50: 7320 5472 7565 2061 6e64 2074 6865 206d  s True and the m
-00016e60: 6f64 656c 2069 7320 7761 726d 2073 7461  odel is warm sta
-00016e70: 7274 6564 2e20 5573 6520 6561 726c 795f  rted. Use early_
-00016e80: 7374 6f70 7069 6e67 5f6d 6178 5f69 7465  stopping_max_ite
-00016e90: 7273 2070 6172 616d 7320 746f 2073 6574  rs params to set
-00016ea0: 2074 6865 2075 7070 6572 2062 6f75 6e64   the upper bound
-00016eb0: 206f 6620 6e5f 6573 7469 6d61 746f 7273   of n_estimators
-00016ec0: 206f 7220 6d61 785f 6974 6572 2e22 0a20   or max_iter.". 
+00016d60: 2070 6172 616d 5f67 7269 642e 706f 7028   param_grid.pop(
+00016d70: 2261 6374 7561 6c5f 6573 7469 6d61 746f  "actual_estimato
+00016d80: 725f 5f6e 5f65 7374 696d 6174 6f72 7322  r__n_estimators"
+00016d90: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00016da0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00016db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016dc0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00016dd0: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+00016de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016df0: 2020 2020 2020 2020 2020 2020 2020 2270                "p
+00016e00: 6172 616d 6574 6572 2067 7269 6420 6361  arameter grid ca
+00016e10: 6e6e 6f74 2063 6f6e 7461 696e 206e 5f65  nnot contain n_e
+00016e20: 7374 696d 6174 6f72 7320 6f72 206d 6178  stimators or max
+00016e30: 5f69 7465 7220 6966 2065 6172 6c79 5f73  _iter if early_s
+00016e40: 746f 7070 696e 6720 6973 2054 7275 6520  topping is True 
+00016e50: 616e 6420 7468 6520 6d6f 6465 6c20 6973  and the model is
+00016e60: 2077 6172 6d20 7374 6172 7465 642e 2055   warm started. U
+00016e70: 7365 2065 6172 6c79 5f73 746f 7070 696e  se early_stoppin
+00016e80: 675f 6d61 785f 6974 6572 7320 7061 7261  g_max_iters para
+00016e90: 6d73 2074 6f20 7365 7420 7468 6520 7570  ms to set the up
+00016ea0: 7065 7220 626f 756e 6420 6f66 206e 5f65  per bound of n_e
+00016eb0: 7374 696d 6174 6f72 7320 6f72 206d 6178  stimators or max
+00016ec0: 5f69 7465 722e 220a 2020 2020 2020 2020  _iter.".        
 00016ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ee0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00016ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016f00: 2069 6620 2261 6374 7561 6c5f 6573 7469   if "actual_esti
-00016f10: 6d61 746f 725f 5f6d 6178 5f69 7465 7222  mator__max_iter"
-00016f20: 2069 6e20 7061 7261 6d5f 6772 6964 3a0a   in param_grid:.
+00016ee0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00016ef0: 2020 2020 2020 2020 2020 6966 2022 6163            if "ac
+00016f00: 7475 616c 5f65 7374 696d 6174 6f72 5f5f  tual_estimator__
+00016f10: 6d61 785f 6974 6572 2220 696e 2070 6172  max_iter" in par
+00016f20: 616d 5f67 7269 643a 0a20 2020 2020 2020  am_grid:.       
 00016f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016f40: 2020 2020 2020 2020 6966 2063 7573 746f          if custo
-00016f50: 6d5f 6772 6964 2069 7320 4e6f 6e65 3a0a  m_grid is None:.
+00016f40: 2069 6620 6375 7374 6f6d 5f67 7269 6420   if custom_grid 
+00016f50: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
 00016f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016f70: 2020 2020 2020 2020 2020 2020 7061 7261              para
-00016f80: 6d5f 6772 6964 2e70 6f70 2822 6163 7475  m_grid.pop("actu
-00016f90: 616c 5f65 7374 696d 6174 6f72 5f5f 6d61  al_estimator__ma
-00016fa0: 785f 6974 6572 2229 0a20 2020 2020 2020  x_iter").       
-00016fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016fc0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00016fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016fe0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00016ff0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00017000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017010: 2020 2020 2022 7061 7261 6d65 7465 7220       "parameter 
-00017020: 6772 6964 2063 616e 6e6f 7420 636f 6e74  grid cannot cont
-00017030: 6169 6e20 6e5f 6573 7469 6d61 746f 7273  ain n_estimators
-00017040: 206f 7220 6d61 785f 6974 6572 2069 6620   or max_iter if 
-00017050: 6561 726c 795f 7374 6f70 7069 6e67 2069  early_stopping i
-00017060: 7320 5472 7565 2061 6e64 2074 6865 206d  s True and the m
-00017070: 6f64 656c 2069 7320 7761 726d 2073 7461  odel is warm sta
-00017080: 7274 6564 2e20 5573 6520 6561 726c 795f  rted. Use early_
-00017090: 7374 6f70 7069 6e67 5f6d 6178 5f69 7465  stopping_max_ite
-000170a0: 7273 2070 6172 616d 7320 746f 2073 6574  rs params to set
-000170b0: 2074 6865 2075 7070 6572 2062 6f75 6e64   the upper bound
-000170c0: 206f 6620 6e5f 6573 7469 6d61 746f 7273   of n_estimators
-000170d0: 206f 7220 6d61 785f 6974 6572 2e22 0a20   or max_iter.". 
+00016f70: 2020 2020 2070 6172 616d 5f67 7269 642e       param_grid.
+00016f80: 706f 7028 2261 6374 7561 6c5f 6573 7469  pop("actual_esti
+00016f90: 6d61 746f 725f 5f6d 6178 5f69 7465 7222  mator__max_iter"
+00016fa0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00016fb0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00016fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016fd0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00016fe0: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+00016ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017000: 2020 2020 2020 2020 2020 2020 2020 2270                "p
+00017010: 6172 616d 6574 6572 2067 7269 6420 6361  arameter grid ca
+00017020: 6e6e 6f74 2063 6f6e 7461 696e 206e 5f65  nnot contain n_e
+00017030: 7374 696d 6174 6f72 7320 6f72 206d 6178  stimators or max
+00017040: 5f69 7465 7220 6966 2065 6172 6c79 5f73  _iter if early_s
+00017050: 746f 7070 696e 6720 6973 2054 7275 6520  topping is True 
+00017060: 616e 6420 7468 6520 6d6f 6465 6c20 6973  and the model is
+00017070: 2077 6172 6d20 7374 6172 7465 642e 2055   warm started. U
+00017080: 7365 2065 6172 6c79 5f73 746f 7070 696e  se early_stoppin
+00017090: 675f 6d61 785f 6974 6572 7320 7061 7261  g_max_iters para
+000170a0: 6d73 2074 6f20 7365 7420 7468 6520 7570  ms to set the up
+000170b0: 7065 7220 626f 756e 6420 6f66 206e 5f65  per bound of n_e
+000170c0: 7374 696d 6174 6f72 7320 6f72 206d 6178  stimators or max
+000170d0: 5f69 7465 722e 220a 2020 2020 2020 2020  _iter.".        
 000170e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000170f0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00017100: 2020 2020 2020 2020 2020 2020 2020 6672                fr
-00017110: 6f6d 2074 756e 655f 736b 6c65 6172 6e20  om tune_sklearn 
-00017120: 696d 706f 7274 2054 756e 6547 7269 6453  import TuneGridS
-00017130: 6561 7263 6843 562c 2054 756e 6553 6561  earchCV, TuneSea
-00017140: 7263 6843 560a 0a20 2020 2020 2020 2020  rchCV..         
-00017150: 2020 2020 2020 2077 6974 6820 7472 7565         with true
-00017160: 5f77 6172 6d5f 7374 6172 7428 0a20 2020  _warm_start(.   
-00017170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017180: 2070 6970 656c 696e 655f 7769 7468 5f6d   pipeline_with_m
-00017190: 6f64 656c 0a20 2020 2020 2020 2020 2020  odel.           
-000171a0: 2020 2020 2029 2069 6620 646f 5f65 6172       ) if do_ear
-000171b0: 6c79 5f73 746f 7020 656c 7365 206e 756c  ly_stop else nul
-000171c0: 6c63 6f6e 7465 7874 2829 3a0a 2020 2020  lcontext():.    
-000171d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000171e0: 6966 2073 6561 7263 685f 616c 676f 7269  if search_algori
-000171f0: 7468 6d20 3d3d 2022 6772 6964 223a 0a0a  thm == "grid":..
+000170f0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00017100: 2020 2020 2020 2066 726f 6d20 7475 6e65         from tune
+00017110: 5f73 6b6c 6561 726e 2069 6d70 6f72 7420  _sklearn import 
+00017120: 5475 6e65 4772 6964 5365 6172 6368 4356  TuneGridSearchCV
+00017130: 2c20 5475 6e65 5365 6172 6368 4356 0a0a  , TuneSearchCV..
+00017140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017150: 7769 7468 2074 7275 655f 7761 726d 5f73  with true_warm_s
+00017160: 7461 7274 280a 2020 2020 2020 2020 2020  tart(.          
+00017170: 2020 2020 2020 2020 2020 7069 7065 6c69            pipeli
+00017180: 6e65 5f77 6974 685f 6d6f 6465 6c0a 2020  ne_with_model.  
+00017190: 2020 2020 2020 2020 2020 2020 2020 2920                ) 
+000171a0: 6966 2064 6f5f 6561 726c 795f 7374 6f70  if do_early_stop
+000171b0: 2065 6c73 6520 6e75 6c6c 636f 6e74 6578   else nullcontex
+000171c0: 7428 293a 0a20 2020 2020 2020 2020 2020  t():.           
+000171d0: 2020 2020 2020 2020 2069 6620 7365 6172           if sear
+000171e0: 6368 5f61 6c67 6f72 6974 686d 203d 3d20  ch_algorithm == 
+000171f0: 2267 7269 6422 3a0a 2020 2020 2020 2020  "grid":.        
 00017200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017210: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-00017220: 6765 722e 696e 666f 2822 496e 6974 6961  ger.info("Initia
-00017230: 6c69 7a69 6e67 2074 756e 655f 736b 6c65  lizing tune_skle
-00017240: 6172 6e2e 5475 6e65 4772 6964 5365 6172  arn.TuneGridSear
-00017250: 6368 4356 2229 0a20 2020 2020 2020 2020  chCV").         
-00017260: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00017270: 6f64 656c 5f67 7269 6420 3d20 5475 6e65  odel_grid = Tune
-00017280: 4772 6964 5365 6172 6368 4356 280a 2020  GridSearchCV(.  
+00017210: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
+00017220: 2822 496e 6974 6961 6c69 7a69 6e67 2074  ("Initializing t
+00017230: 756e 655f 736b 6c65 6172 6e2e 5475 6e65  une_sklearn.Tune
+00017240: 4772 6964 5365 6172 6368 4356 2229 0a20  GridSearchCV"). 
+00017250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017260: 2020 2020 2020 206d 6f64 656c 5f67 7269         model_gri
+00017270: 6420 3d20 5475 6e65 4772 6964 5365 6172  d = TuneGridSear
+00017280: 6368 4356 280a 2020 2020 2020 2020 2020  chCV(.          
 00017290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000172a0: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-000172b0: 746f 723d 7069 7065 6c69 6e65 5f77 6974  tor=pipeline_wit
-000172c0: 685f 6d6f 6465 6c2c 0a20 2020 2020 2020  h_model,.       
-000172d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000172e0: 2020 2020 2070 6172 616d 5f67 7269 643d       param_grid=
-000172f0: 7061 7261 6d5f 6772 6964 2c0a 2020 2020  param_grid,.    
+000172a0: 2020 6573 7469 6d61 746f 723d 7069 7065    estimator=pipe
+000172b0: 6c69 6e65 5f77 6974 685f 6d6f 6465 6c2c  line_with_model,
+000172c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000172d0: 2020 2020 2020 2020 2020 2020 2070 6172               par
+000172e0: 616d 5f67 7269 643d 7061 7261 6d5f 6772  am_grid=param_gr
+000172f0: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
 00017300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017310: 2020 2020 2020 2020 6561 726c 795f 7374          early_st
-00017320: 6f70 7069 6e67 3d64 6f5f 6561 726c 795f  opping=do_early_
-00017330: 7374 6f70 2c0a 2020 2020 2020 2020 2020  stop,.          
-00017340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017350: 2020 7363 6f72 696e 673d 6f70 7469 6d69    scoring=optimi
-00017360: 7a65 2c0a 2020 2020 2020 2020 2020 2020  ze,.            
-00017370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017380: 6376 3d66 6f6c 642c 0a20 2020 2020 2020  cv=fold,.       
-00017390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000173a0: 2020 2020 206d 6178 5f69 7465 7273 3d65       max_iters=e
-000173b0: 6172 6c79 5f73 746f 7070 696e 675f 6d61  arly_stopping_ma
-000173c0: 785f 6974 6572 732c 0a20 2020 2020 2020  x_iters,.       
-000173d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000173e0: 2020 2020 206e 5f6a 6f62 733d 6e5f 6a6f       n_jobs=n_jo
-000173f0: 6273 2c0a 2020 2020 2020 2020 2020 2020  bs,.            
-00017400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017410: 7573 655f 6770 753d 7365 6c66 2e67 7075  use_gpu=self.gpu
-00017420: 5f70 6172 616d 2c0a 2020 2020 2020 2020  _param,.        
-00017430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017440: 2020 2020 7265 6669 743d 4661 6c73 652c      refit=False,
-00017450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017460: 2020 2020 2020 2020 2020 2020 2076 6572               ver
-00017470: 626f 7365 3d74 756e 6572 5f76 6572 626f  bose=tuner_verbo
-00017480: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-00017490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000174a0: 7069 7065 6c69 6e65 5f61 7574 6f5f 6561  pipeline_auto_ea
-000174b0: 726c 795f 7374 6f70 3d54 7275 652c 0a20  rly_stop=True,. 
+00017310: 6561 726c 795f 7374 6f70 7069 6e67 3d64  early_stopping=d
+00017320: 6f5f 6561 726c 795f 7374 6f70 2c0a 2020  o_early_stop,.  
+00017330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017340: 2020 2020 2020 2020 2020 7363 6f72 696e            scorin
+00017350: 673d 6f70 7469 6d69 7a65 2c0a 2020 2020  g=optimize,.    
+00017360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017370: 2020 2020 2020 2020 6376 3d66 6f6c 642c          cv=fold,
+00017380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017390: 2020 2020 2020 2020 2020 2020 206d 6178               max
+000173a0: 5f69 7465 7273 3d65 6172 6c79 5f73 746f  _iters=early_sto
+000173b0: 7070 696e 675f 6d61 785f 6974 6572 732c  pping_max_iters,
+000173c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000173d0: 2020 2020 2020 2020 2020 2020 206e 5f6a               n_j
+000173e0: 6f62 733d 6e5f 6a6f 6273 2c0a 2020 2020  obs=n_jobs,.    
+000173f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017400: 2020 2020 2020 2020 7573 655f 6770 753d          use_gpu=
+00017410: 7365 6c66 2e67 7075 5f70 6172 616d 2c0a  self.gpu_param,.
+00017420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017430: 2020 2020 2020 2020 2020 2020 7265 6669              refi
+00017440: 743d 4661 6c73 652c 0a20 2020 2020 2020  t=False,.       
+00017450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017460: 2020 2020 2076 6572 626f 7365 3d74 756e       verbose=tun
+00017470: 6572 5f76 6572 626f 7365 2c0a 2020 2020  er_verbose,.    
+00017480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017490: 2020 2020 2020 2020 7069 7065 6c69 6e65          pipeline
+000174a0: 5f61 7574 6f5f 6561 726c 795f 7374 6f70  _auto_early_stop
+000174b0: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
 000174c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000174d0: 2020 2020 2020 2020 2020 202a 2a73 6561             **sea
-000174e0: 7263 685f 6b77 6172 6773 2c0a 2020 2020  rch_kwargs,.    
-000174f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017500: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00017510: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+000174d0: 2020 202a 2a73 6561 7263 685f 6b77 6172     **search_kwar
+000174e0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+000174f0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00017500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017510: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
 00017520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017530: 2020 2020 2020 2020 6966 2073 6561 7263          if searc
-00017540: 685f 616c 676f 7269 7468 6d20 3d3d 2022  h_algorithm == "
-00017550: 6879 7065 726f 7074 223a 0a20 2020 2020  hyperopt":.     
-00017560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017570: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00017530: 6966 2073 6561 7263 685f 616c 676f 7269  if search_algori
+00017540: 7468 6d20 3d3d 2022 6879 7065 726f 7074  thm == "hyperopt
+00017550: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
+00017560: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00017570: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
 00017580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017590: 2020 2020 2020 2020 2020 2020 7061 7261              para
-000175a0: 6d5f 6772 6964 203d 2067 6574 5f68 7970  m_grid = get_hyp
-000175b0: 6572 6f70 745f 6469 7374 7269 6275 7469  eropt_distributi
-000175c0: 6f6e 7328 7061 7261 6d5f 6772 6964 290a  ons(param_grid).
+00017590: 2020 2020 7061 7261 6d5f 6772 6964 203d      param_grid =
+000175a0: 2067 6574 5f68 7970 6572 6f70 745f 6469   get_hyperopt_di
+000175b0: 7374 7269 6275 7469 6f6e 7328 7061 7261  stributions(para
+000175c0: 6d5f 6772 6964 290a 2020 2020 2020 2020  m_grid).        
 000175d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000175e0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-000175f0: 7074 2045 7863 6570 7469 6f6e 3a0a 2020  pt Exception:.  
+000175e0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
+000175f0: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
 00017600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017610: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00017620: 6c66 2e6c 6f67 6765 722e 7761 726e 696e  lf.logger.warnin
-00017630: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
-00017640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017650: 2020 2020 2020 2022 436f 756c 646e 2774         "Couldn't
-00017660: 2063 6f6e 7665 7274 2070 6172 616d 5f67   convert param_g
-00017670: 7269 6420 746f 2073 7065 6369 6669 6320  rid to specific 
-00017680: 6c69 6272 6172 7920 6469 7374 7269 6275  library distribu
-00017690: 7469 6f6e 732e 2045 7863 6570 7469 6f6e  tions. Exception
-000176a0: 3a22 0a20 2020 2020 2020 2020 2020 2020  :".             
-000176b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000176c0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-000176d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000176e0: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
-000176f0: 2e77 6172 6e69 6e67 2874 7261 6365 6261  .warning(traceba
-00017700: 636b 2e66 6f72 6d61 745f 6578 6328 2929  ck.format_exc())
-00017710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017720: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
-00017730: 6172 6368 5f61 6c67 6f72 6974 686d 203d  arch_algorithm =
-00017740: 3d20 2262 6179 6573 6961 6e22 3a0a 2020  = "bayesian":.  
+00017610: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
+00017620: 722e 7761 726e 696e 6728 0a20 2020 2020  r.warning(.     
+00017630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017640: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00017650: 436f 756c 646e 2774 2063 6f6e 7665 7274  Couldn't convert
+00017660: 2070 6172 616d 5f67 7269 6420 746f 2073   param_grid to s
+00017670: 7065 6369 6669 6320 6c69 6272 6172 7920  pecific library 
+00017680: 6469 7374 7269 6275 7469 6f6e 732e 2045  distributions. E
+00017690: 7863 6570 7469 6f6e 3a22 0a20 2020 2020  xception:".     
+000176a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000176b0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000176c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000176d0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000176e0: 662e 6c6f 6767 6572 2e77 6172 6e69 6e67  f.logger.warning
+000176f0: 2874 7261 6365 6261 636b 2e66 6f72 6d61  (traceback.forma
+00017700: 745f 6578 6328 2929 0a20 2020 2020 2020  t_exc()).       
+00017710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017720: 2065 6c69 6620 7365 6172 6368 5f61 6c67   elif search_alg
+00017730: 6f72 6974 686d 203d 3d20 2262 6179 6573  orithm == "bayes
+00017740: 6961 6e22 3a0a 2020 2020 2020 2020 2020  ian":.          
 00017750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017760: 2020 2020 2020 2020 2020 7472 793a 0a20            try:. 
+00017760: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
 00017770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017780: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00017790: 6172 616d 5f67 7269 6420 3d20 6765 745f  aram_grid = get_
-000177a0: 736b 6f70 745f 6469 7374 7269 6275 7469  skopt_distributi
-000177b0: 6f6e 7328 7061 7261 6d5f 6772 6964 290a  ons(param_grid).
+00017780: 2020 2020 2020 2070 6172 616d 5f67 7269         param_gri
+00017790: 6420 3d20 6765 745f 736b 6f70 745f 6469  d = get_skopt_di
+000177a0: 7374 7269 6275 7469 6f6e 7328 7061 7261  stributions(para
+000177b0: 6d5f 6772 6964 290a 2020 2020 2020 2020  m_grid).        
 000177c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000177d0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-000177e0: 7074 2045 7863 6570 7469 6f6e 3a0a 2020  pt Exception:.  
+000177d0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
+000177e0: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
 000177f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017800: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00017810: 6c66 2e6c 6f67 6765 722e 7761 726e 696e  lf.logger.warnin
-00017820: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
-00017830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017840: 2020 2020 2020 2022 436f 756c 646e 2774         "Couldn't
-00017850: 2063 6f6e 7665 7274 2070 6172 616d 5f67   convert param_g
-00017860: 7269 6420 746f 2073 7065 6369 6669 6320  rid to specific 
-00017870: 6c69 6272 6172 7920 6469 7374 7269 6275  library distribu
-00017880: 7469 6f6e 732e 2045 7863 6570 7469 6f6e  tions. Exception
-00017890: 3a22 0a20 2020 2020 2020 2020 2020 2020  :".             
-000178a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000178b0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-000178c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000178d0: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
-000178e0: 2e77 6172 6e69 6e67 2874 7261 6365 6261  .warning(traceba
-000178f0: 636b 2e66 6f72 6d61 745f 6578 6328 2929  ck.format_exc())
-00017900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017910: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
-00017920: 6172 6368 5f61 6c67 6f72 6974 686d 203d  arch_algorithm =
-00017930: 3d20 2262 6f68 6222 3a0a 2020 2020 2020  = "bohb":.      
-00017940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017950: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+00017800: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
+00017810: 722e 7761 726e 696e 6728 0a20 2020 2020  r.warning(.     
+00017820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017830: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00017840: 436f 756c 646e 2774 2063 6f6e 7665 7274  Couldn't convert
+00017850: 2070 6172 616d 5f67 7269 6420 746f 2073   param_grid to s
+00017860: 7065 6369 6669 6320 6c69 6272 6172 7920  pecific library 
+00017870: 6469 7374 7269 6275 7469 6f6e 732e 2045  distributions. E
+00017880: 7863 6570 7469 6f6e 3a22 0a20 2020 2020  xception:".     
+00017890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000178a0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000178b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000178c0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000178d0: 662e 6c6f 6767 6572 2e77 6172 6e69 6e67  f.logger.warning
+000178e0: 2874 7261 6365 6261 636b 2e66 6f72 6d61  (traceback.forma
+000178f0: 745f 6578 6328 2929 0a20 2020 2020 2020  t_exc()).       
+00017900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017910: 2065 6c69 6620 7365 6172 6368 5f61 6c67   elif search_alg
+00017920: 6f72 6974 686d 203d 3d20 2262 6f68 6222  orithm == "bohb"
+00017930: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00017940: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+00017950: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
 00017960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017970: 2020 2020 2020 2020 2020 2070 6172 616d             param
-00017980: 5f67 7269 6420 3d20 6765 745f 4353 5f64  _grid = get_CS_d
-00017990: 6973 7472 6962 7574 696f 6e73 2870 6172  istributions(par
-000179a0: 616d 5f67 7269 6429 0a20 2020 2020 2020  am_grid).       
-000179b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000179c0: 2020 2020 2065 7863 6570 7420 4578 6365       except Exce
-000179d0: 7074 696f 6e3a 0a20 2020 2020 2020 2020  ption:.         
-000179e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000179f0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
-00017a00: 6572 2e77 6172 6e69 6e67 280a 2020 2020  er.warning(.    
+00017970: 2020 2070 6172 616d 5f67 7269 6420 3d20     param_grid = 
+00017980: 6765 745f 4353 5f64 6973 7472 6962 7574  get_CS_distribut
+00017990: 696f 6e73 2870 6172 616d 5f67 7269 6429  ions(param_grid)
+000179a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000179b0: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+000179c0: 6570 7420 4578 6365 7074 696f 6e3a 0a20  ept Exception:. 
+000179d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000179e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000179f0: 656c 662e 6c6f 6767 6572 2e77 6172 6e69  elf.logger.warni
+00017a00: 6e67 280a 2020 2020 2020 2020 2020 2020  ng(.            
 00017a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017a30: 2243 6f75 6c64 6e27 7420 636f 6e76 6572  "Couldn't conver
-00017a40: 7420 7061 7261 6d5f 6772 6964 2074 6f20  t param_grid to 
-00017a50: 7370 6563 6966 6963 206c 6962 7261 7279  specific library
-00017a60: 2064 6973 7472 6962 7574 696f 6e73 2e20   distributions. 
-00017a70: 4578 6365 7074 696f 6e3a 220a 2020 2020  Exception:".    
+00017a20: 2020 2020 2020 2020 2243 6f75 6c64 6e27          "Couldn'
+00017a30: 7420 636f 6e76 6572 7420 7061 7261 6d5f  t convert param_
+00017a40: 6772 6964 2074 6f20 7370 6563 6966 6963  grid to specific
+00017a50: 206c 6962 7261 7279 2064 6973 7472 6962   library distrib
+00017a60: 7574 696f 6e73 2e20 4578 6365 7074 696f  utions. Exceptio
+00017a70: 6e3a 220a 2020 2020 2020 2020 2020 2020  n:".            
 00017a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017a90: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00017a90: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
 00017aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017ab0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00017ac0: 6c66 2e6c 6f67 6765 722e 7761 726e 696e  lf.logger.warnin
-00017ad0: 6728 7472 6163 6562 6163 6b2e 666f 726d  g(traceback.form
-00017ae0: 6174 5f65 7863 2829 290a 2020 2020 2020  at_exc()).      
-00017af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017b00: 2020 656c 6966 2073 6561 7263 685f 616c    elif search_al
-00017b10: 676f 7269 7468 6d20 213d 2022 7261 6e64  gorithm != "rand
-00017b20: 6f6d 223a 0a20 2020 2020 2020 2020 2020  om":.           
-00017b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017b40: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-00017b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017b60: 2020 2020 2020 7061 7261 6d5f 6772 6964        param_grid
-00017b70: 203d 2067 6574 5f74 756e 655f 6469 7374   = get_tune_dist
-00017b80: 7269 6275 7469 6f6e 7328 7061 7261 6d5f  ributions(param_
-00017b90: 6772 6964 290a 2020 2020 2020 2020 2020  grid).          
-00017ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017bb0: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
-00017bc0: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-00017bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017be0: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
-00017bf0: 7761 726e 696e 6728 0a20 2020 2020 2020  warning(.       
+00017ab0: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
+00017ac0: 722e 7761 726e 696e 6728 7472 6163 6562  r.warning(traceb
+00017ad0: 6163 6b2e 666f 726d 6174 5f65 7863 2829  ack.format_exc()
+00017ae0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00017af0: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
+00017b00: 6561 7263 685f 616c 676f 7269 7468 6d20  earch_algorithm 
+00017b10: 213d 2022 7261 6e64 6f6d 223a 0a20 2020  != "random":.   
+00017b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017b30: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
+00017b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017b50: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00017b60: 7261 6d5f 6772 6964 203d 2067 6574 5f74  ram_grid = get_t
+00017b70: 756e 655f 6469 7374 7269 6275 7469 6f6e  une_distribution
+00017b80: 7328 7061 7261 6d5f 6772 6964 290a 2020  s(param_grid).  
+00017b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017ba0: 2020 2020 2020 2020 2020 6578 6365 7074            except
+00017bb0: 2045 7863 6570 7469 6f6e 3a0a 2020 2020   Exception:.    
+00017bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017bd0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00017be0: 2e6c 6f67 6765 722e 7761 726e 696e 6728  .logger.warning(
+00017bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00017c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c10: 2020 2020 2020 2020 2020 2020 2022 436f               "Co
-00017c20: 756c 646e 2774 2063 6f6e 7665 7274 2070  uldn't convert p
-00017c30: 6172 616d 5f67 7269 6420 746f 2073 7065  aram_grid to spe
-00017c40: 6369 6669 6320 6c69 6272 6172 7920 6469  cific library di
-00017c50: 7374 7269 6275 7469 6f6e 732e 2045 7863  stributions. Exc
-00017c60: 6570 7469 6f6e 3a22 0a20 2020 2020 2020  eption:".       
+00017c10: 2020 2020 2022 436f 756c 646e 2774 2063       "Couldn't c
+00017c20: 6f6e 7665 7274 2070 6172 616d 5f67 7269  onvert param_gri
+00017c30: 6420 746f 2073 7065 6369 6669 6320 6c69  d to specific li
+00017c40: 6272 6172 7920 6469 7374 7269 6275 7469  brary distributi
+00017c50: 6f6e 732e 2045 7863 6570 7469 6f6e 3a22  ons. Exception:"
+00017c60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00017c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c80: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00017c80: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
 00017c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017ca0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00017cb0: 6c6f 6767 6572 2e77 6172 6e69 6e67 2874  logger.warning(t
-00017cc0: 7261 6365 6261 636b 2e66 6f72 6d61 745f  raceback.format_
-00017cd0: 6578 6328 2929 0a20 2020 2020 2020 2020  exc()).         
-00017ce0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00017cf0: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
-00017d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017d10: 2020 2020 2020 2020 2020 2020 2066 2249               f"I
-00017d20: 6e69 7469 616c 697a 696e 6720 7475 6e65  nitializing tune
-00017d30: 5f73 6b6c 6561 726e 2e54 756e 6553 6561  _sklearn.TuneSea
-00017d40: 7263 6843 562c 207b 7365 6172 6368 5f61  rchCV, {search_a
-00017d50: 6c67 6f72 6974 686d 7d22 0a20 2020 2020  lgorithm}".     
-00017d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017d70: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00017d80: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00017d90: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00017da0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00017db0: 6172 6368 5f61 6c67 6f72 6974 686d 203d  arch_algorithm =
-00017dc0: 3d20 226f 7074 756e 6122 0a20 2020 2020  = "optuna".     
-00017dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017de0: 2020 2020 2020 2061 6e64 2022 7361 6d70         and "samp
-00017df0: 6c65 7222 206e 6f74 2069 6e20 7365 6172  ler" not in sear
-00017e00: 6368 5f6b 7761 7267 730a 2020 2020 2020  ch_kwargs.      
-00017e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017e20: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-00017e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017e40: 2069 6d70 6f72 7420 6f70 7475 6e61 0a0a   import optuna..
+00017ca0: 2020 2073 656c 662e 6c6f 6767 6572 2e77     self.logger.w
+00017cb0: 6172 6e69 6e67 2874 7261 6365 6261 636b  arning(traceback
+00017cc0: 2e66 6f72 6d61 745f 6578 6328 2929 0a20  .format_exc()). 
+00017cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017ce0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+00017cf0: 6572 2e69 6e66 6f28 0a20 2020 2020 2020  er.info(.       
+00017d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017d10: 2020 2020 2066 2249 6e69 7469 616c 697a       f"Initializ
+00017d20: 696e 6720 7475 6e65 5f73 6b6c 6561 726e  ing tune_sklearn
+00017d30: 2e54 756e 6553 6561 7263 6843 562c 207b  .TuneSearchCV, {
+00017d40: 7365 6172 6368 5f61 6c67 6f72 6974 686d  search_algorithm
+00017d50: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
+00017d60: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00017d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017d80: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
+00017d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017da0: 2020 2020 2020 7365 6172 6368 5f61 6c67        search_alg
+00017db0: 6f72 6974 686d 203d 3d20 226f 7074 756e  orithm == "optun
+00017dc0: 6122 0a20 2020 2020 2020 2020 2020 2020  a".             
+00017dd0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00017de0: 6e64 2022 7361 6d70 6c65 7222 206e 6f74  nd "sampler" not
+00017df0: 2069 6e20 7365 6172 6368 5f6b 7761 7267   in search_kwarg
+00017e00: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00017e10: 2020 2020 2020 2020 2020 293a 0a20 2020            ):.   
+00017e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017e30: 2020 2020 2020 2020 2069 6d70 6f72 7420           import 
+00017e40: 6f70 7475 6e61 0a0a 2020 2020 2020 2020  optuna..        
 00017e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017e60: 2020 2020 2020 2020 2020 2020 7365 6172              sear
-00017e70: 6368 5f6b 7761 7267 735b 2273 616d 706c  ch_kwargs["sampl
-00017e80: 6572 225d 203d 2067 6574 5f6f 7074 756e  er"] = get_optun
-00017e90: 615f 7470 655f 7361 6d70 6c65 7228 290a  a_tpe_sampler().
+00017e60: 2020 2020 7365 6172 6368 5f6b 7761 7267      search_kwarg
+00017e70: 735b 2273 616d 706c 6572 225d 203d 2067  s["sampler"] = g
+00017e80: 6574 5f6f 7074 756e 615f 7470 655f 7361  et_optuna_tpe_sa
+00017e90: 6d70 6c65 7228 290a 2020 2020 2020 2020  mpler().        
 00017ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017eb0: 2020 2020 2020 2020 6d6f 6465 6c5f 6772          model_gr
-00017ec0: 6964 203d 2054 756e 6553 6561 7263 6843  id = TuneSearchC
-00017ed0: 5628 0a20 2020 2020 2020 2020 2020 2020  V(.             
-00017ee0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00017ef0: 7374 696d 6174 6f72 3d70 6970 656c 696e  stimator=pipelin
-00017f00: 655f 7769 7468 5f6d 6f64 656c 2c0a 2020  e_with_model,.  
+00017eb0: 6d6f 6465 6c5f 6772 6964 203d 2054 756e  model_grid = Tun
+00017ec0: 6553 6561 7263 6843 5628 0a20 2020 2020  eSearchCV(.     
+00017ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017ee0: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
+00017ef0: 3d70 6970 656c 696e 655f 7769 7468 5f6d  =pipeline_with_m
+00017f00: 6f64 656c 2c0a 2020 2020 2020 2020 2020  odel,.          
 00017f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017f20: 2020 2020 2020 2020 2020 7365 6172 6368            search
-00017f30: 5f6f 7074 696d 697a 6174 696f 6e3d 7365  _optimization=se
-00017f40: 6172 6368 5f61 6c67 6f72 6974 686d 2c0a  arch_algorithm,.
+00017f20: 2020 7365 6172 6368 5f6f 7074 696d 697a    search_optimiz
+00017f30: 6174 696f 6e3d 7365 6172 6368 5f61 6c67  ation=search_alg
+00017f40: 6f72 6974 686d 2c0a 2020 2020 2020 2020  orithm,.        
 00017f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017f60: 2020 2020 2020 2020 2020 2020 7061 7261              para
-00017f70: 6d5f 6469 7374 7269 6275 7469 6f6e 733d  m_distributions=
-00017f80: 7061 7261 6d5f 6772 6964 2c0a 2020 2020  param_grid,.    
+00017f60: 2020 2020 7061 7261 6d5f 6469 7374 7269      param_distri
+00017f70: 6275 7469 6f6e 733d 7061 7261 6d5f 6772  butions=param_gr
+00017f80: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
 00017f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017fa0: 2020 2020 2020 2020 6e5f 7472 6961 6c73          n_trials
-00017fb0: 3d6e 5f69 7465 722c 0a20 2020 2020 2020  =n_iter,.       
-00017fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017fd0: 2020 2020 2065 6172 6c79 5f73 746f 7070       early_stopp
-00017fe0: 696e 673d 646f 5f65 6172 6c79 5f73 746f  ing=do_early_sto
-00017ff0: 702c 0a20 2020 2020 2020 2020 2020 2020  p,.             
-00018000: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00018010: 636f 7269 6e67 3d6f 7074 696d 697a 652c  coring=optimize,
-00018020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018030: 2020 2020 2020 2020 2020 2020 2063 763d               cv=
-00018040: 666f 6c64 2c0a 2020 2020 2020 2020 2020  fold,.          
-00018050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018060: 2020 7261 6e64 6f6d 5f73 7461 7465 3d73    random_state=s
-00018070: 656c 662e 7365 6564 2c0a 2020 2020 2020  elf.seed,.      
-00018080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018090: 2020 2020 2020 6d61 785f 6974 6572 733d        max_iters=
-000180a0: 6561 726c 795f 7374 6f70 7069 6e67 5f6d  early_stopping_m
-000180b0: 6178 5f69 7465 7273 2c0a 2020 2020 2020  ax_iters,.      
-000180c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000180d0: 2020 2020 2020 6e5f 6a6f 6273 3d6e 5f6a        n_jobs=n_j
-000180e0: 6f62 732c 0a20 2020 2020 2020 2020 2020  obs,.           
-000180f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018100: 2075 7365 5f67 7075 3d73 656c 662e 6770   use_gpu=self.gp
-00018110: 755f 7061 7261 6d2c 0a20 2020 2020 2020  u_param,.       
-00018120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018130: 2020 2020 2072 6566 6974 3d54 7275 652c       refit=True,
-00018140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018150: 2020 2020 2020 2020 2020 2020 2076 6572               ver
-00018160: 626f 7365 3d74 756e 6572 5f76 6572 626f  bose=tuner_verbo
-00018170: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-00018180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018190: 7069 7065 6c69 6e65 5f61 7574 6f5f 6561  pipeline_auto_ea
-000181a0: 726c 795f 7374 6f70 3d54 7275 652c 0a20  rly_stop=True,. 
+00017fa0: 6e5f 7472 6961 6c73 3d6e 5f69 7465 722c  n_trials=n_iter,
+00017fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017fc0: 2020 2020 2020 2020 2020 2020 2065 6172               ear
+00017fd0: 6c79 5f73 746f 7070 696e 673d 646f 5f65  ly_stopping=do_e
+00017fe0: 6172 6c79 5f73 746f 702c 0a20 2020 2020  arly_stop,.     
+00017ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018000: 2020 2020 2020 2073 636f 7269 6e67 3d6f         scoring=o
+00018010: 7074 696d 697a 652c 0a20 2020 2020 2020  ptimize,.       
+00018020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018030: 2020 2020 2063 763d 666f 6c64 2c0a 2020       cv=fold,.  
+00018040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018050: 2020 2020 2020 2020 2020 7261 6e64 6f6d            random
+00018060: 5f73 7461 7465 3d73 656c 662e 7365 6564  _state=self.seed
+00018070: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00018080: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+00018090: 785f 6974 6572 733d 6561 726c 795f 7374  x_iters=early_st
+000180a0: 6f70 7069 6e67 5f6d 6178 5f69 7465 7273  opping_max_iters
+000180b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000180c0: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
+000180d0: 6a6f 6273 3d6e 5f6a 6f62 732c 0a20 2020  jobs=n_jobs,.   
+000180e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000180f0: 2020 2020 2020 2020 2075 7365 5f67 7075           use_gpu
+00018100: 3d73 656c 662e 6770 755f 7061 7261 6d2c  =self.gpu_param,
+00018110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018120: 2020 2020 2020 2020 2020 2020 2072 6566               ref
+00018130: 6974 3d54 7275 652c 0a20 2020 2020 2020  it=True,.       
+00018140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018150: 2020 2020 2076 6572 626f 7365 3d74 756e       verbose=tun
+00018160: 6572 5f76 6572 626f 7365 2c0a 2020 2020  er_verbose,.    
+00018170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018180: 2020 2020 2020 2020 7069 7065 6c69 6e65          pipeline
+00018190: 5f61 7574 6f5f 6561 726c 795f 7374 6f70  _auto_early_stop
+000181a0: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
 000181b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000181c0: 2020 2020 2020 2020 2020 2073 6561 7263             searc
-000181d0: 685f 6b77 6172 6773 3d73 6561 7263 685f  h_kwargs=search_
-000181e0: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
-000181f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018200: 290a 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00018210: 6c69 6620 7365 6172 6368 5f6c 6962 7261  lif search_libra
-00018220: 7279 203d 3d20 2273 6369 6b69 742d 6f70  ry == "scikit-op
-00018230: 7469 6d69 7a65 223a 0a20 2020 2020 2020  timize":.       
-00018240: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-00018250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018260: 2020 7061 7261 6d5f 6772 6964 203d 2067    param_grid = g
-00018270: 6574 5f73 6b6f 7074 5f64 6973 7472 6962  et_skopt_distrib
-00018280: 7574 696f 6e73 2870 6172 616d 5f67 7269  utions(param_gri
-00018290: 6429 0a20 2020 2020 2020 2020 2020 2020  d).             
-000182a0: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
-000182b0: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
-000182c0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
-000182d0: 6767 6572 2e77 6172 6e69 6e67 280a 2020  gger.warning(.  
-000182e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000182f0: 2020 2020 2020 2243 6f75 6c64 6e27 7420        "Couldn't 
-00018300: 636f 6e76 6572 7420 7061 7261 6d5f 6772  convert param_gr
-00018310: 6964 2074 6f20 7370 6563 6966 6963 206c  id to specific l
-00018320: 6962 7261 7279 2064 6973 7472 6962 7574  ibrary distribut
-00018330: 696f 6e73 2e20 4578 6365 7074 696f 6e3a  ions. Exception:
-00018340: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00018350: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00018360: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00018370: 2e6c 6f67 6765 722e 7761 726e 696e 6728  .logger.warning(
-00018380: 7472 6163 6562 6163 6b2e 666f 726d 6174  traceback.format
-00018390: 5f65 7863 2829 290a 0a20 2020 2020 2020  _exc())..       
-000183a0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
-000183b0: 6767 6572 2e69 6e66 6f28 2249 6e69 7469  gger.info("Initi
-000183c0: 616c 697a 696e 6720 736b 6f70 742e 4261  alizing skopt.Ba
-000183d0: 7965 7353 6561 7263 6843 5622 290a 2020  yesSearchCV").  
-000183e0: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-000183f0: 6465 6c5f 6772 6964 203d 2073 6b6f 7074  del_grid = skopt
-00018400: 2e42 6179 6573 5365 6172 6368 4356 280a  .BayesSearchCV(.
-00018410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018420: 2020 2020 6573 7469 6d61 746f 723d 7069      estimator=pi
-00018430: 7065 6c69 6e65 5f77 6974 685f 6d6f 6465  peline_with_mode
-00018440: 6c2c 0a20 2020 2020 2020 2020 2020 2020  l,.             
-00018450: 2020 2020 2020 2073 6561 7263 685f 7370         search_sp
-00018460: 6163 6573 3d70 6172 616d 5f67 7269 642c  aces=param_grid,
-00018470: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018480: 2020 2020 2073 636f 7269 6e67 3d6f 7074       scoring=opt
-00018490: 696d 697a 652c 0a20 2020 2020 2020 2020  imize,.         
-000184a0: 2020 2020 2020 2020 2020 206e 5f69 7465             n_ite
-000184b0: 723d 6e5f 6974 6572 2c0a 2020 2020 2020  r=n_iter,.      
-000184c0: 2020 2020 2020 2020 2020 2020 2020 6376                cv
-000184d0: 3d66 6f6c 642c 0a20 2020 2020 2020 2020  =fold,.         
-000184e0: 2020 2020 2020 2020 2020 2072 616e 646f             rando
-000184f0: 6d5f 7374 6174 653d 7365 6c66 2e73 6565  m_state=self.see
-00018500: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
-00018510: 2020 2020 2020 2072 6566 6974 3d46 616c         refit=Fal
-00018520: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-00018530: 2020 2020 2020 2020 6e5f 6a6f 6273 3d6e          n_jobs=n
-00018540: 5f6a 6f62 732c 0a20 2020 2020 2020 2020  _jobs,.         
-00018550: 2020 2020 2020 2020 2020 2076 6572 626f             verbo
-00018560: 7365 3d74 756e 6572 5f76 6572 626f 7365  se=tuner_verbose
-00018570: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00018580: 2020 2020 2020 2a2a 7365 6172 6368 5f6b        **search_k
-00018590: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
-000185a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000185b0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000185c0: 2020 2020 2020 2020 2020 2023 206e 6565             # nee
-000185d0: 6473 2074 6f20 6265 2069 6d70 6f72 7465  ds to be importe
-000185e0: 6420 6c69 6b65 2074 6861 7420 666f 7220  d like that for 
-000185f0: 7468 6520 6d6f 6e6b 6579 7061 7463 680a  the monkeypatch.
-00018600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018610: 696d 706f 7274 2073 6b6c 6561 726e 2e6d  import sklearn.m
-00018620: 6f64 656c 5f73 656c 6563 7469 6f6e 2e5f  odel_selection._
-00018630: 7365 6172 6368 0a0a 2020 2020 2020 2020  search..        
-00018640: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-00018650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018660: 2070 6172 616d 5f67 7269 6420 3d20 6765   param_grid = ge
-00018670: 745f 6261 7365 5f64 6973 7472 6962 7574  t_base_distribut
-00018680: 696f 6e73 2870 6172 616d 5f67 7269 6429  ions(param_grid)
-00018690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000186a0: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
-000186b0: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
-000186c0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
-000186d0: 6572 2e77 6172 6e69 6e67 280a 2020 2020  er.warning(.    
-000186e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000186f0: 2020 2020 2243 6f75 6c64 6e27 7420 636f      "Couldn't co
-00018700: 6e76 6572 7420 7061 7261 6d5f 6772 6964  nvert param_grid
-00018710: 2074 6f20 7370 6563 6966 6963 206c 6962   to specific lib
-00018720: 7261 7279 2064 6973 7472 6962 7574 696f  rary distributio
-00018730: 6e73 2e20 4578 6365 7074 696f 6e3a 220a  ns. Exception:".
-00018740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018750: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00018760: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-00018770: 6f67 6765 722e 7761 726e 696e 6728 7472  ogger.warning(tr
-00018780: 6163 6562 6163 6b2e 666f 726d 6174 5f65  aceback.format_e
-00018790: 7863 2829 290a 0a20 2020 2020 2020 2020  xc())..         
-000187a0: 2020 2020 2020 2069 6620 7365 6172 6368         if search
-000187b0: 5f61 6c67 6f72 6974 686d 203d 3d20 2267  _algorithm == "g
-000187c0: 7269 6422 3a0a 2020 2020 2020 2020 2020  rid":.          
-000187d0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-000187e0: 6f67 6765 722e 696e 666f 2822 496e 6974  ogger.info("Init
-000187f0: 6961 6c69 7a69 6e67 2047 7269 6453 6561  ializing GridSea
-00018800: 7263 6843 5622 290a 2020 2020 2020 2020  rchCV").        
-00018810: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-00018820: 6c5f 6772 6964 203d 2073 6b6c 6561 726e  l_grid = sklearn
-00018830: 2e6d 6f64 656c 5f73 656c 6563 7469 6f6e  .model_selection
-00018840: 2e5f 7365 6172 6368 2e47 7269 6453 6561  ._search.GridSea
-00018850: 7263 6843 5628 0a20 2020 2020 2020 2020  rchCV(.         
-00018860: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00018870: 7374 696d 6174 6f72 3d70 6970 656c 696e  stimator=pipelin
-00018880: 655f 7769 7468 5f6d 6f64 656c 2c0a 2020  e_with_model,.  
-00018890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000188a0: 2020 2020 2020 7061 7261 6d5f 6772 6964        param_grid
-000188b0: 3d70 6172 616d 5f67 7269 642c 0a20 2020  =param_grid,.   
-000188c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000188d0: 2020 2020 2073 636f 7269 6e67 3d6f 7074       scoring=opt
-000188e0: 696d 697a 652c 0a20 2020 2020 2020 2020  imize,.         
-000188f0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00018900: 763d 666f 6c64 2c0a 2020 2020 2020 2020  v=fold,.        
-00018910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018920: 7265 6669 743d 4661 6c73 652c 0a20 2020  refit=False,.   
-00018930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018940: 2020 2020 206e 5f6a 6f62 733d 6e5f 6a6f       n_jobs=n_jo
-00018950: 6273 2c0a 2020 2020 2020 2020 2020 2020  bs,.            
-00018960: 2020 2020 2020 2020 2020 2020 7665 7262              verb
-00018970: 6f73 653d 7475 6e65 725f 7665 7262 6f73  ose=tuner_verbos
-00018980: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00018990: 2020 2020 2020 2020 2020 202a 2a73 6561             **sea
-000189a0: 7263 685f 6b77 6172 6773 2c0a 2020 2020  rch_kwargs,.    
-000189b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000189c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000189d0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000189e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000189f0: 2e6c 6f67 6765 722e 696e 666f 2822 496e  .logger.info("In
-00018a00: 6974 6961 6c69 7a69 6e67 2052 616e 646f  itializing Rando
-00018a10: 6d69 7a65 6453 6561 7263 6843 5622 290a  mizedSearchCV").
-00018a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018a30: 2020 2020 6d6f 6465 6c5f 6772 6964 203d      model_grid =
-00018a40: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
-00018a50: 656c 6563 7469 6f6e 2e5f 7365 6172 6368  election._search
-00018a60: 2e52 616e 646f 6d69 7a65 6453 6561 7263  .RandomizedSearc
-00018a70: 6843 5628 0a20 2020 2020 2020 2020 2020  hCV(.           
-00018a80: 2020 2020 2020 2020 2020 2020 2065 7374               est
-00018a90: 696d 6174 6f72 3d70 6970 656c 696e 655f  imator=pipeline_
-00018aa0: 7769 7468 5f6d 6f64 656c 2c0a 2020 2020  with_model,.    
-00018ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018ac0: 2020 2020 7061 7261 6d5f 6469 7374 7269      param_distri
-00018ad0: 6275 7469 6f6e 733d 7061 7261 6d5f 6772  butions=param_gr
-00018ae0: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
-00018af0: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
-00018b00: 696e 673d 6f70 7469 6d69 7a65 2c0a 2020  ing=optimize,.  
-00018b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018b20: 2020 2020 2020 6e5f 6974 6572 3d6e 5f69        n_iter=n_i
-00018b30: 7465 722c 0a20 2020 2020 2020 2020 2020  ter,.           
-00018b40: 2020 2020 2020 2020 2020 2020 2063 763d               cv=
-00018b50: 666f 6c64 2c0a 2020 2020 2020 2020 2020  fold,.          
-00018b60: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00018b70: 6e64 6f6d 5f73 7461 7465 3d73 656c 662e  ndom_state=self.
-00018b80: 7365 6564 2c0a 2020 2020 2020 2020 2020  seed,.          
-00018b90: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00018ba0: 6669 743d 4661 6c73 652c 0a20 2020 2020  fit=False,.     
-00018bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018bc0: 2020 206e 5f6a 6f62 733d 6e5f 6a6f 6273     n_jobs=n_jobs
-00018bd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00018be0: 2020 2020 2020 2020 2020 7665 7262 6f73            verbos
-00018bf0: 653d 7475 6e65 725f 7665 7262 6f73 652c  e=tuner_verbose,
-00018c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018c10: 2020 2020 2020 2020 202a 2a73 6561 7263           **searc
-00018c20: 685f 6b77 6172 6773 2c0a 2020 2020 2020  h_kwargs,.      
-00018c30: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00018c40: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00018c50: 7365 6172 6368 5f6c 6962 7261 7279 203d  search_library =
-00018c60: 3d20 2273 6369 6b69 742d 6c65 6172 6e22  = "scikit-learn"
-00018c70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00018c80: 2020 2320 6d6f 6e6b 6579 2070 6174 6368    # monkey patch
-00018c90: 696e 6720 746f 2066 6978 206f 7665 7266  ing to fix overf
-00018ca0: 6c6f 7773 206f 6e20 5769 6e64 6f77 730a  lows on Windows.
-00018cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018cc0: 7769 7468 2070 6174 6368 280a 2020 2020  with patch(.    
-00018cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018ce0: 2273 6b6c 6561 726e 2e6d 6f64 656c 5f73  "sklearn.model_s
-00018cf0: 656c 6563 7469 6f6e 2e5f 7365 6172 6368  election._search
-00018d00: 2e73 616d 706c 655f 7769 7468 6f75 745f  .sample_without_
-00018d10: 7265 706c 6163 656d 656e 7422 2c0a 2020  replacement",.  
-00018d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018d30: 2020 7079 6361 7265 742e 696e 7465 726e    pycaret.intern
-00018d40: 616c 2e70 6174 6368 6573 2e73 6b6c 6561  al.patches.sklea
-00018d50: 726e 2e5f 6d70 5f73 616d 706c 655f 7769  rn._mp_sample_wi
-00018d60: 7468 6f75 745f 7265 706c 6163 656d 656e  thout_replacemen
-00018d70: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-00018d80: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-00018d90: 2020 2020 2020 2020 2020 7769 7468 2070            with p
-00018da0: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
-00018db0: 2020 2020 2020 2020 2020 2020 2020 2273                "s
-00018dc0: 6b6c 6561 726e 2e6d 6f64 656c 5f73 656c  klearn.model_sel
-00018dd0: 6563 7469 6f6e 2e5f 7365 6172 6368 2e50  ection._search.P
-00018de0: 6172 616d 6574 6572 4772 6964 2e5f 5f67  arameterGrid.__g
-00018df0: 6574 6974 656d 5f5f 222c 0a20 2020 2020  etitem__",.     
-00018e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018e10: 2020 2070 7963 6172 6574 2e69 6e74 6572     pycaret.inter
-00018e20: 6e61 6c2e 7061 7463 6865 732e 736b 6c65  nal.patches.skle
-00018e30: 6172 6e2e 5f6d 705f 5061 7261 6d65 7465  arn._mp_Paramete
-00018e40: 7247 7269 645f 6765 7469 7465 6d2c 0a20  rGrid_getitem,. 
-00018e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018e60: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-00018e70: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-00018e80: 6465 6c5f 6772 6964 2e66 6974 2864 6174  del_grid.fit(dat
-00018e90: 615f 582c 2064 6174 615f 792c 2067 726f  a_X, data_y, gro
-00018ea0: 7570 733d 6772 6f75 7073 2c20 2a2a 6669  ups=groups, **fi
-00018eb0: 745f 6b77 6172 6773 290a 2020 2020 2020  t_kwargs).      
-00018ec0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00018ed0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-00018ee0: 6c5f 6772 6964 2e66 6974 2864 6174 615f  l_grid.fit(data_
-00018ef0: 582c 2064 6174 615f 792c 2067 726f 7570  X, data_y, group
-00018f00: 733d 6772 6f75 7073 2c20 2a2a 6669 745f  s=groups, **fit_
-00018f10: 6b77 6172 6773 290a 2020 2020 2020 2020  kwargs).        
-00018f20: 2020 2020 6265 7374 5f70 6172 616d 7320      best_params 
-00018f30: 3d20 6d6f 6465 6c5f 6772 6964 2e62 6573  = model_grid.bes
-00018f40: 745f 7061 7261 6d73 5f0a 2020 2020 2020  t_params_.      
-00018f50: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
-00018f60: 722e 696e 666f 2866 2262 6573 745f 7061  r.info(f"best_pa
-00018f70: 7261 6d73 3a20 7b62 6573 745f 7061 7261  rams: {best_para
-00018f80: 6d73 7d22 290a 2020 2020 2020 2020 2020  ms}").          
-00018f90: 2020 6265 7374 5f70 6172 616d 7320 3d20    best_params = 
-00018fa0: 7b2a 2a62 6573 745f 7061 7261 6d73 2c20  {**best_params, 
-00018fb0: 2a2a 6578 7472 615f 7061 7261 6d73 7d0a  **extra_params}.
-00018fc0: 2020 2020 2020 2020 2020 2020 6966 2061              if a
-00018fd0: 6374 7561 6c5f 6573 7469 6d61 746f 725f  ctual_estimator_
-00018fe0: 6c61 6265 6c3a 0a20 2020 2020 2020 2020  label:.         
-00018ff0: 2020 2020 2020 2062 6573 745f 7061 7261         best_para
-00019000: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-00019010: 2020 2020 2020 2020 2020 206b 2e72 6570             k.rep
-00019020: 6c61 6365 2866 227b 6163 7475 616c 5f65  lace(f"{actual_e
-00019030: 7374 696d 6174 6f72 5f6c 6162 656c 7d5f  stimator_label}_
-00019040: 5f22 2c20 2222 293a 2076 0a20 2020 2020  _", ""): v.     
-00019050: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00019060: 6f72 206b 2c20 7620 696e 2062 6573 745f  or k, v in best_
-00019070: 7061 7261 6d73 2e69 7465 6d73 2829 0a20  params.items(). 
-00019080: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-00019090: 0a20 2020 2020 2020 2020 2020 2063 765f  .            cv_
-000190a0: 7265 7375 6c74 7320 3d20 4e6f 6e65 0a20  results = None. 
-000190b0: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-000190c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000190d0: 6376 5f72 6573 756c 7473 203d 206d 6f64  cv_results = mod
-000190e0: 656c 5f67 7269 642e 6376 5f72 6573 756c  el_grid.cv_resul
-000190f0: 7473 5f0a 2020 2020 2020 2020 2020 2020  ts_.            
-00019100: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
-00019110: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00019120: 2020 7365 6c66 2e6c 6f67 6765 722e 7761    self.logger.wa
-00019130: 726e 696e 6728 0a20 2020 2020 2020 2020  rning(.         
-00019140: 2020 2020 2020 2020 2020 2022 436f 756c             "Coul
-00019150: 646e 2774 2067 6574 2063 765f 7265 7375  dn't get cv_resu
-00019160: 6c74 7320 6672 6f6d 206d 6f64 656c 5f67  lts from model_g
-00019170: 7269 642e 2045 7863 6570 7469 6f6e 3a22  rid. Exception:"
-00019180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019190: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-000191a0: 2020 2073 656c 662e 6c6f 6767 6572 2e77     self.logger.w
-000191b0: 6172 6e69 6e67 2874 7261 6365 6261 636b  arning(traceback
-000191c0: 2e66 6f72 6d61 745f 6578 6328 2929 0a0a  .format_exc())..
-000191d0: 2020 2020 2020 2020 6469 7370 6c61 792e          display.
-000191e0: 6d6f 7665 5f70 726f 6772 6573 7328 290a  move_progress().
-000191f0: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
-00019200: 6767 6572 2e69 6e66 6f28 2248 7970 6572  gger.info("Hyper
-00019210: 7061 7261 6d65 7465 7220 7365 6172 6368  parameter search
-00019220: 2063 6f6d 706c 6574 6564 2229 0a0a 2020   completed")..  
-00019230: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00019240: 6e63 6528 6d6f 6465 6c2c 2054 756e 6162  nce(model, Tunab
-00019250: 6c65 4d69 7869 6e29 3a0a 2020 2020 2020  leMixin):.      
-00019260: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
-00019270: 722e 696e 666f 2822 4765 7474 696e 6720  r.info("Getting 
-00019280: 6261 7365 2073 6b6c 6561 726e 206f 626a  base sklearn obj
-00019290: 6563 7420 6672 6f6d 2074 756e 6162 6c65  ect from tunable
-000192a0: 2229 0a20 2020 2020 2020 2020 2020 2062  ").            b
-000192b0: 6573 745f 7061 7261 6d73 203d 207b 0a20  est_params = {. 
-000192c0: 2020 2020 2020 2020 2020 2020 2020 206b                 k
-000192d0: 3a20 760a 2020 2020 2020 2020 2020 2020  : v.            
-000192e0: 2020 2020 666f 7220 6b2c 2076 2069 6e20      for k, v in 
-000192f0: 6d6f 6465 6c2e 6765 745f 7061 7261 6d73  model.get_params
-00019300: 2829 2e69 7465 6d73 2829 0a20 2020 2020  ().items().     
-00019310: 2020 2020 2020 2020 2020 2069 6620 6b20             if k 
-00019320: 696e 206d 6f64 656c 2e67 6574 5f62 6173  in model.get_bas
-00019330: 655f 736b 6c65 6172 6e5f 7061 7261 6d73  e_sklearn_params
-00019340: 2829 2e6b 6579 7328 290a 2020 2020 2020  ().keys().      
-00019350: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00019360: 2020 2020 6d6f 6465 6c20 3d20 6d6f 6465      model = mode
-00019370: 6c2e 6765 745f 6261 7365 5f73 6b6c 6561  l.get_base_sklea
-00019380: 726e 5f6f 626a 6563 7428 290a 0a20 2020  rn_object()..   
-00019390: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
-000193a0: 2e69 6e66 6f28 0a20 2020 2020 2020 2020  .info(.         
-000193b0: 2020 2022 5375 6250 726f 6365 7373 2063     "SubProcess c
-000193c0: 7265 6174 655f 6d6f 6465 6c28 2920 6361  reate_model() ca
-000193d0: 6c6c 6564 203d 3d3d 3d3d 3d3d 3d3d 3d3d  lled ===========
-000193e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000193f0: 3d3d 3d3d 3d3d 3d22 0a20 2020 2020 2020  =======".       
-00019400: 2029 0a20 2020 2020 2020 2062 6573 745f   ).        best_
-00019410: 6d6f 6465 6c2c 206d 6f64 656c 5f66 6974  model, model_fit
-00019420: 5f74 696d 6520 3d20 7365 6c66 2e5f 6372  _time = self._cr
-00019430: 6561 7465 5f6d 6f64 656c 280a 2020 2020  eate_model(.    
-00019440: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
-00019450: 723d 6d6f 6465 6c2c 0a20 2020 2020 2020  r=model,.       
-00019460: 2020 2020 2073 7973 7465 6d3d 4661 6c73       system=Fals
-00019470: 652c 0a20 2020 2020 2020 2020 2020 2064  e,.            d
-00019480: 6973 706c 6179 3d64 6973 706c 6179 2c0a  isplay=display,.
-00019490: 2020 2020 2020 2020 2020 2020 666f 6c64              fold
-000194a0: 3d66 6f6c 642c 0a20 2020 2020 2020 2020  =fold,.         
-000194b0: 2020 2072 6f75 6e64 3d72 6f75 6e64 2c0a     round=round,.
-000194c0: 2020 2020 2020 2020 2020 2020 6772 6f75              grou
-000194d0: 7073 3d67 726f 7570 732c 0a20 2020 2020  ps=groups,.     
-000194e0: 2020 2020 2020 2066 6974 5f6b 7761 7267         fit_kwarg
-000194f0: 733d 6669 745f 6b77 6172 6773 2c0a 2020  s=fit_kwargs,.  
-00019500: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00019510: 5f74 7261 696e 5f73 636f 7265 3d72 6574  _train_score=ret
-00019520: 7572 6e5f 7472 6169 6e5f 7363 6f72 652c  urn_train_score,
-00019530: 0a20 2020 2020 2020 2020 2020 202a 2a62  .            **b
-00019540: 6573 745f 7061 7261 6d73 2c0a 2020 2020  est_params,.    
-00019550: 2020 2020 290a 2020 2020 2020 2020 6d6f      ).        mo
-00019560: 6465 6c5f 7265 7375 6c74 7320 3d20 7365  del_results = se
-00019570: 6c66 2e70 756c 6c28 290a 2020 2020 2020  lf.pull().      
-00019580: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
-00019590: 666f 280a 2020 2020 2020 2020 2020 2020  fo(.            
-000195a0: 2253 7562 5072 6f63 6573 7320 6372 6561  "SubProcess crea
-000195b0: 7465 5f6d 6f64 656c 2829 2065 6e64 203d  te_model() end =
-000195c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000195d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000195e0: 3d22 0a20 2020 2020 2020 2029 0a0a 2020  =".        )..  
-000195f0: 2020 2020 2020 6966 2063 686f 6f73 655f        if choose_
-00019600: 6265 7474 6572 3a0a 2020 2020 2020 2020  better:.        
-00019610: 2020 2020 6e65 775f 6265 7374 5f6d 6f64      new_best_mod
-00019620: 656c 203d 2073 656c 662e 5f63 686f 6f73  el = self._choos
-00019630: 655f 6265 7474 6572 280a 2020 2020 2020  e_better(.      
-00019640: 2020 2020 2020 2020 2020 5b65 7374 696d            [estim
-00019650: 6174 6f72 2c20 2862 6573 745f 6d6f 6465  ator, (best_mode
-00019660: 6c2c 206d 6f64 656c 5f72 6573 756c 7473  l, model_results
-00019670: 295d 2c0a 2020 2020 2020 2020 2020 2020  )],.            
-00019680: 2020 2020 636f 6d70 6172 655f 6469 6d65      compare_dime
-00019690: 6e73 696f 6e2c 0a20 2020 2020 2020 2020  nsion,.         
-000196a0: 2020 2020 2020 2066 6f6c 642c 0a20 2020         fold,.   
-000196b0: 2020 2020 2020 2020 2020 2020 2067 726f               gro
-000196c0: 7570 733d 6772 6f75 7073 2c0a 2020 2020  ups=groups,.    
-000196d0: 2020 2020 2020 2020 2020 2020 6669 745f              fit_
-000196e0: 6b77 6172 6773 3d66 6974 5f6b 7761 7267  kwargs=fit_kwarg
-000196f0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00019700: 2020 2064 6973 706c 6179 3d64 6973 706c     display=displ
-00019710: 6179 2c0a 2020 2020 2020 2020 2020 2020  ay,.            
-00019720: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00019730: 206e 6577 5f62 6573 745f 6d6f 6465 6c20   new_best_model 
-00019740: 6973 206e 6f74 2062 6573 745f 6d6f 6465  is not best_mode
-00019750: 6c3a 0a20 2020 2020 2020 2020 2020 2020  l:.             
-00019760: 2020 206d 7367 203d 2028 0a20 2020 2020     msg = (.     
-00019770: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00019780: 4f72 6967 696e 616c 206d 6f64 656c 2077  Original model w
-00019790: 6173 2062 6574 7465 7220 7468 616e 2074  as better than t
-000197a0: 6865 2074 756e 6564 206d 6f64 656c 2c20  he tuned model, 
-000197b0: 6865 6e63 6520 6974 2077 696c 6c20 6265  hence it will be
-000197c0: 2072 6574 7572 6e65 642e 2022 0a20 2020   returned. ".   
-000197d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000197e0: 2022 4e4f 5445 3a20 5468 6520 6469 7370   "NOTE: The disp
-000197f0: 6c61 7920 6d65 7472 6963 7320 6172 6520  lay metrics are 
-00019800: 666f 7220 7468 6520 7475 6e65 6420 6d6f  for the tuned mo
-00019810: 6465 6c20 286e 6f74 2074 6865 206f 7269  del (not the ori
-00019820: 6769 6e61 6c20 6f6e 6529 2e22 0a20 2020  ginal one).".   
-00019830: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00019840: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00019850: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
-00019860: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00019870: 7269 6e74 286d 7367 290a 2020 2020 2020  rint(msg).      
-00019880: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-00019890: 6f67 6765 722e 696e 666f 286d 7367 290a  ogger.info(msg).
-000198a0: 2020 2020 2020 2020 2020 2020 6265 7374              best
-000198b0: 5f6d 6f64 656c 203d 206e 6577 5f62 6573  _model = new_bes
-000198c0: 745f 6d6f 6465 6c0a 0a20 2020 2020 2020  t_model..       
-000198d0: 2023 2065 6e64 2072 756e 7469 6d65 0a20   # end runtime. 
-000198e0: 2020 2020 2020 2072 756e 7469 6d65 5f65         runtime_e
-000198f0: 6e64 203d 2074 696d 652e 7469 6d65 2829  nd = time.time()
-00019900: 0a20 2020 2020 2020 2072 756e 7469 6d65  .        runtime
-00019910: 203d 206e 702e 6172 7261 7928 7275 6e74   = np.array(runt
-00019920: 696d 655f 656e 6420 2d20 7275 6e74 696d  ime_end - runtim
-00019930: 655f 7374 6172 7429 2e72 6f75 6e64 2832  e_start).round(2
-00019940: 290a 0a20 2020 2020 2020 2023 2064 6173  )..        # das
-00019950: 6862 6f61 7264 206c 6f67 6769 6e67 0a20  hboard logging. 
-00019960: 2020 2020 2020 2069 6620 7365 6c66 2e6c         if self.l
-00019970: 6f67 6769 6e67 5f70 6172 616d 3a0a 2020  ogging_param:.  
-00019980: 2020 2020 2020 2020 2020 696e 6469 6365            indice
-00019990: 7320 3d20 7365 6c66 2e5f 6765 745f 7265  s = self._get_re
-000199a0: 7475 726e 5f74 7261 696e 5f73 636f 7265  turn_train_score
-000199b0: 5f69 6e64 6963 6573 5f66 6f72 5f6c 6f67  _indices_for_log
-000199c0: 6769 6e67 280a 2020 2020 2020 2020 2020  ging(.          
-000199d0: 2020 2020 2020 7265 7475 726e 5f74 7261        return_tra
-000199e0: 696e 5f73 636f 7265 3d72 6574 7572 6e5f  in_score=return_
-000199f0: 7472 6169 6e5f 7363 6f72 650a 2020 2020  train_score.    
-00019a00: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00019a10: 2020 2020 2020 6176 6773 5f64 6963 745f        avgs_dict_
-00019a20: 6c6f 6720 3d20 7b6b 3a20 7620 666f 7220  log = {k: v for 
-00019a30: 6b2c 2076 2069 6e20 6d6f 6465 6c5f 7265  k, v in model_re
-00019a40: 7375 6c74 732e 6c6f 635b 696e 6469 6365  sults.loc[indice
-00019a50: 735d 2e69 7465 6d73 2829 7d0a 2020 2020  s].items()}.    
-00019a60: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-00019a70: 6769 6e67 5f70 6172 616d 2e6c 6f67 5f6d  ging_param.log_m
-00019a80: 6f64 656c 5f63 6f6d 7061 7269 736f 6e28  odel_comparison(
-00019a90: 6d6f 6465 6c5f 7265 7375 6c74 732c 2022  model_results, "
-00019aa0: 7475 6e65 5f6d 6f64 656c 2229 0a0a 2020  tune_model")..  
-00019ab0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00019ac0: 6c6f 675f 6d6f 6465 6c28 0a20 2020 2020  log_model(.     
-00019ad0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-00019ae0: 3d62 6573 745f 6d6f 6465 6c2c 0a20 2020  =best_model,.   
-00019af0: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-00019b00: 656c 5f72 6573 756c 7473 3d6d 6f64 656c  el_results=model
-00019b10: 5f72 6573 756c 7473 2c0a 2020 2020 2020  _results,.      
-00019b20: 2020 2020 2020 2020 2020 7363 6f72 655f            score_
-00019b30: 6469 6374 3d61 7667 735f 6469 6374 5f6c  dict=avgs_dict_l
-00019b40: 6f67 2c0a 2020 2020 2020 2020 2020 2020  og,.            
-00019b50: 2020 2020 736f 7572 6365 3d22 7475 6e65      source="tune
-00019b60: 5f6d 6f64 656c 222c 0a20 2020 2020 2020  _model",.       
-00019b70: 2020 2020 2020 2020 2072 756e 7469 6d65           runtime
-00019b80: 3d72 756e 7469 6d65 2c0a 2020 2020 2020  =runtime,.      
-00019b90: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-00019ba0: 6669 745f 7469 6d65 3d6d 6f64 656c 5f66  fit_time=model_f
-00019bb0: 6974 5f74 696d 652c 0a20 2020 2020 2020  it_time,.       
-00019bc0: 2020 2020 2020 2020 2070 6970 656c 696e           pipelin
-00019bd0: 653d 7365 6c66 2e70 6970 656c 696e 652c  e=self.pipeline,
-00019be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019bf0: 206c 6f67 5f70 6c6f 7473 3d73 656c 662e   log_plots=self.
-00019c00: 6c6f 675f 706c 6f74 735f 7061 7261 6d2c  log_plots_param,
-00019c10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019c20: 2074 756e 655f 6376 5f72 6573 756c 7473   tune_cv_results
-00019c30: 3d63 765f 7265 7375 6c74 732c 0a20 2020  =cv_results,.   
-00019c40: 2020 2020 2020 2020 2020 2020 2064 6973               dis
-00019c50: 706c 6179 3d64 6973 706c 6179 2c0a 2020  play=display,.  
-00019c60: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00019c70: 2020 2020 206d 6f64 656c 5f72 6573 756c       model_resul
-00019c80: 7473 203d 2073 656c 662e 5f68 6967 686c  ts = self._highl
-00019c90: 6967 6874 5f61 6e64 5f72 6f75 6e64 5f6d  ight_and_round_m
-00019ca0: 6f64 656c 5f72 6573 756c 7473 280a 2020  odel_results(.  
-00019cb0: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-00019cc0: 7265 7375 6c74 732c 2072 6574 7572 6e5f  results, return_
-00019cd0: 7472 6169 6e5f 7363 6f72 652c 2072 6f75  train_score, rou
-00019ce0: 6e64 0a20 2020 2020 2020 2029 0a20 2020  nd.        ).   
-00019cf0: 2020 2020 2064 6973 706c 6179 2e64 6973       display.dis
-00019d00: 706c 6179 286d 6f64 656c 5f72 6573 756c  play(model_resul
-00019d10: 7473 290a 0a20 2020 2020 2020 2073 656c  ts)..        sel
-00019d20: 662e 6c6f 6767 6572 2e69 6e66 6f28 0a20  f.logger.info(. 
-00019d30: 2020 2020 2020 2020 2020 2066 225f 6d61             f"_ma
-00019d40: 7374 6572 5f6d 6f64 656c 5f63 6f6e 7461  ster_model_conta
-00019d50: 696e 6572 3a20 7b6c 656e 2873 656c 662e  iner: {len(self.
-00019d60: 5f6d 6173 7465 725f 6d6f 6465 6c5f 636f  _master_model_co
-00019d70: 6e74 6169 6e65 7229 7d22 0a20 2020 2020  ntainer)}".     
-00019d80: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-00019d90: 662e 6c6f 6767 6572 2e69 6e66 6f28 6622  f.logger.info(f"
-00019da0: 5f64 6973 706c 6179 5f63 6f6e 7461 696e  _display_contain
-00019db0: 6572 3a20 7b6c 656e 2873 656c 662e 5f64  er: {len(self._d
-00019dc0: 6973 706c 6179 5f63 6f6e 7461 696e 6572  isplay_container
-00019dd0: 297d 2229 0a0a 2020 2020 2020 2020 7365  )}")..        se
-00019de0: 6c66 2e6c 6f67 6765 722e 696e 666f 2873  lf.logger.info(s
-00019df0: 7472 2862 6573 745f 6d6f 6465 6c29 290a  tr(best_model)).
-00019e00: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-00019e10: 6765 722e 696e 666f 280a 2020 2020 2020  ger.info(.      
-00019e20: 2020 2020 2020 2274 756e 655f 6d6f 6465        "tune_mode
-00019e30: 6c28 2920 7375 6363 6573 7366 756c 6c79  l() successfully
-00019e40: 2063 6f6d 706c 6574 6564 2e2e 2e2e 2e2e   completed......
-00019e50: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00019e60: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00019e70: 220a 2020 2020 2020 2020 290a 0a20 2020  ".        )..   
-00019e80: 2020 2020 2067 632e 636f 6c6c 6563 7428       gc.collect(
-00019e90: 290a 2020 2020 2020 2020 6966 2072 6574  ).        if ret
-00019ea0: 7572 6e5f 7475 6e65 723a 0a20 2020 2020  urn_tuner:.     
-00019eb0: 2020 2020 2020 2072 6574 7572 6e20 2862         return (b
-00019ec0: 6573 745f 6d6f 6465 6c2c 206d 6f64 656c  est_model, model
-00019ed0: 5f67 7269 6429 0a20 2020 2020 2020 2072  _grid).        r
-00019ee0: 6574 7572 6e20 6265 7374 5f6d 6f64 656c  eturn best_model
-00019ef0: 0a0a 2020 2020 6465 6620 656e 7365 6d62  ..    def ensemb
-00019f00: 6c65 5f6d 6f64 656c 280a 2020 2020 2020  le_model(.      
-00019f10: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00019f20: 6573 7469 6d61 746f 722c 0a20 2020 2020  estimator,.     
-00019f30: 2020 206d 6574 686f 643a 2073 7472 203d     method: str =
-00019f40: 2022 4261 6767 696e 6722 2c0a 2020 2020   "Bagging",.    
-00019f50: 2020 2020 666f 6c64 3a20 4f70 7469 6f6e      fold: Option
-00019f60: 616c 5b55 6e69 6f6e 5b69 6e74 2c20 416e  al[Union[int, An
-00019f70: 795d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  y]] = None,.    
-00019f80: 2020 2020 6e5f 6573 7469 6d61 746f 7273      n_estimators
-00019f90: 3a20 696e 7420 3d20 3130 2c0a 2020 2020  : int = 10,.    
-00019fa0: 2020 2020 726f 756e 643a 2069 6e74 203d      round: int =
-00019fb0: 2034 2c0a 2020 2020 2020 2020 6368 6f6f   4,.        choo
-00019fc0: 7365 5f62 6574 7465 723a 2062 6f6f 6c20  se_better: bool 
-00019fd0: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
-00019fe0: 206f 7074 696d 697a 653a 2073 7472 203d   optimize: str =
-00019ff0: 2022 4163 6375 7261 6379 222c 0a20 2020   "Accuracy",.   
-0001a000: 2020 2020 2066 6974 5f6b 7761 7267 733a       fit_kwargs:
-0001a010: 204f 7074 696f 6e61 6c5b 6469 6374 5d20   Optional[dict] 
-0001a020: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0001a030: 6772 6f75 7073 3a20 4f70 7469 6f6e 616c  groups: Optional
-0001a040: 5b55 6e69 6f6e 5b73 7472 2c20 416e 795d  [Union[str, Any]
-0001a050: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-0001a060: 2020 7072 6f62 6162 696c 6974 795f 7468    probability_th
-0001a070: 7265 7368 6f6c 643a 204f 7074 696f 6e61  reshold: Optiona
-0001a080: 6c5b 666c 6f61 745d 203d 204e 6f6e 652c  l[float] = None,
-0001a090: 0a20 2020 2020 2020 2076 6572 626f 7365  .        verbose
-0001a0a0: 3a20 626f 6f6c 203d 2054 7275 652c 0a20  : bool = True,. 
-0001a0b0: 2020 2020 2020 2072 6574 7572 6e5f 7472         return_tr
-0001a0c0: 6169 6e5f 7363 6f72 653a 2062 6f6f 6c20  ain_score: bool 
-0001a0d0: 3d20 4661 6c73 652c 0a20 2020 2029 202d  = False,.    ) -
-0001a0e0: 3e20 416e 793a 0a20 2020 2020 2020 2022  > Any:.        "
-0001a0f0: 2222 0a20 2020 2020 2020 2054 6869 7320  "".        This 
-0001a100: 6675 6e63 7469 6f6e 2065 6e73 656d 626c  function ensembl
-0001a110: 6573 2074 6865 2074 7261 696e 6564 2062  es the trained b
-0001a120: 6173 6520 6573 7469 6d61 746f 7220 7573  ase estimator us
-0001a130: 696e 6720 7468 6520 6d65 7468 6f64 2064  ing the method d
-0001a140: 6566 696e 6564 2069 6e0a 2020 2020 2020  efined in.      
-0001a150: 2020 276d 6574 686f 6427 2070 6172 616d    'method' param
-0001a160: 6574 6572 2028 6465 6661 756c 7420 3d20  eter (default = 
-0001a170: 2742 6167 6769 6e67 2729 2e20 5468 6520  'Bagging'). The 
-0001a180: 6f75 7470 7574 2070 7269 6e74 7320 6120  output prints a 
-0001a190: 7363 6f72 6520 6772 6964 2074 6861 7420  score grid that 
-0001a1a0: 7368 6f77 730a 2020 2020 2020 2020 4163  shows.        Ac
-0001a1b0: 6375 7261 6379 2c20 4155 432c 2052 6563  curacy, AUC, Rec
-0001a1c0: 616c 6c2c 2050 7265 6369 7369 6f6e 2c20  all, Precision, 
-0001a1d0: 4631 2c20 4b61 7070 6120 616e 6420 4d43  F1, Kappa and MC
-0001a1e0: 4320 6279 2066 6f6c 6420 2864 6566 6175  C by fold (defau
-0001a1f0: 6c74 203d 2031 3020 466f 6c64 292e 0a0a  lt = 10 Fold)...
-0001a200: 2020 2020 2020 2020 5468 6973 2066 756e          This fun
-0001a210: 6374 696f 6e20 7265 7475 726e 7320 6120  ction returns a 
-0001a220: 7472 6169 6e65 6420 6d6f 6465 6c20 6f62  trained model ob
-0001a230: 6a65 6374 2e0a 0a20 2020 2020 2020 204d  ject...        M
-0001a240: 6f64 656c 206d 7573 7420 6265 2063 7265  odel must be cre
-0001a250: 6174 6564 2075 7369 6e67 2063 7265 6174  ated using creat
-0001a260: 655f 6d6f 6465 6c28 2920 6f72 2074 756e  e_model() or tun
-0001a270: 655f 6d6f 6465 6c28 292e 0a0a 2020 2020  e_model()...    
-0001a280: 2020 2020 4578 616d 706c 650a 2020 2020      Example.    
-0001a290: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-0001a2a0: 2020 2020 3e3e 3e20 6672 6f6d 2070 7963      >>> from pyc
-0001a2b0: 6172 6574 2e64 6174 6173 6574 7320 696d  aret.datasets im
-0001a2c0: 706f 7274 2067 6574 5f64 6174 610a 2020  port get_data.  
-0001a2d0: 2020 2020 2020 3e3e 3e20 6a75 6963 6520        >>> juice 
-0001a2e0: 3d20 6765 745f 6461 7461 2827 6a75 6963  = get_data('juic
-0001a2f0: 6527 290a 2020 2020 2020 2020 3e3e 3e20  e').        >>> 
-0001a300: 6578 7065 7269 6d65 6e74 5f6e 616d 6520  experiment_name 
-0001a310: 3d20 7365 7475 7028 6461 7461 203d 206a  = setup(data = j
-0001a320: 7569 6365 2c20 2074 6172 6765 7420 3d20  uice,  target = 
-0001a330: 2750 7572 6368 6173 6527 290a 2020 2020  'Purchase').    
-0001a340: 2020 2020 3e3e 3e20 6474 203d 2063 7265      >>> dt = cre
-0001a350: 6174 655f 6d6f 6465 6c28 2764 7427 290a  ate_model('dt').
-0001a360: 2020 2020 2020 2020 3e3e 3e20 656e 7365          >>> ense
-0001a370: 6d62 6c65 645f 6474 203d 2065 6e73 656d  mbled_dt = ensem
-0001a380: 626c 655f 6d6f 6465 6c28 6474 290a 0a20  ble_model(dt).. 
-0001a390: 2020 2020 2020 2054 6869 7320 7769 6c6c         This will
-0001a3a0: 2072 6574 7572 6e20 616e 2065 6e73 656d   return an ensem
-0001a3b0: 626c 6564 2044 6563 6973 696f 6e20 5472  bled Decision Tr
-0001a3c0: 6565 206d 6f64 656c 2075 7369 6e67 2027  ee model using '
-0001a3d0: 4261 6767 696e 6727 2e0a 0a20 2020 2020  Bagging'...     
-0001a3e0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-0001a3f0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0001a400: 0a20 2020 2020 2020 2065 7374 696d 6174  .        estimat
-0001a410: 6f72 203a 206f 626a 6563 742c 2064 6566  or : object, def
-0001a420: 6175 6c74 203d 204e 6f6e 650a 0a20 2020  ault = None..   
-0001a430: 2020 2020 206d 6574 686f 643a 2073 7472       method: str
-0001a440: 2c20 6465 6661 756c 7420 3d20 2742 6167  , default = 'Bag
-0001a450: 6769 6e67 270a 2020 2020 2020 2020 2020  ging'.          
-0001a460: 2020 4261 6767 696e 6720 6d65 7468 6f64    Bagging method
-0001a470: 2077 696c 6c20 6372 6561 7465 2061 6e20   will create an 
-0001a480: 656e 7365 6d62 6c65 206d 6574 612d 6573  ensemble meta-es
-0001a490: 7469 6d61 746f 7220 7468 6174 2066 6974  timator that fit
-0001a4a0: 7320 6261 7365 0a20 2020 2020 2020 2020  s base.         
-0001a4b0: 2020 2063 6c61 7373 6966 6965 7273 2065     classifiers e
-0001a4c0: 6163 6820 6f6e 2072 616e 646f 6d20 7375  ach on random su
-0001a4d0: 6273 6574 7320 6f66 2074 6865 206f 7269  bsets of the ori
-0001a4e0: 6769 6e61 6c20 6461 7461 7365 742e 2054  ginal dataset. T
-0001a4f0: 6865 206f 7468 6572 0a20 2020 2020 2020  he other.       
-0001a500: 2020 2020 2061 7661 696c 6162 6c65 206d       available m
-0001a510: 6574 686f 6420 6973 2027 426f 6f73 7469  ethod is 'Boosti
-0001a520: 6e67 2720 7768 6963 6820 7769 6c6c 2063  ng' which will c
-0001a530: 7265 6174 6520 6120 6d65 7461 2d65 7374  reate a meta-est
-0001a540: 696d 6174 6f72 7320 6279 0a20 2020 2020  imators by.     
-0001a550: 2020 2020 2020 2066 6974 7469 6e67 2061         fitting a
-0001a560: 2063 6c61 7373 6966 6965 7220 6f6e 2074   classifier on t
-0001a570: 6865 206f 7269 6769 6e61 6c20 6461 7461  he original data
-0001a580: 7365 7420 616e 6420 7468 656e 2066 6974  set and then fit
-0001a590: 7320 6164 6469 7469 6f6e 616c 0a20 2020  s additional.   
-0001a5a0: 2020 2020 2020 2020 2063 6f70 6965 7320           copies 
-0001a5b0: 6f66 2074 6865 2063 6c61 7373 6966 6965  of the classifie
-0001a5c0: 7220 6f6e 2074 6865 2073 616d 6520 6461  r on the same da
-0001a5d0: 7461 7365 7420 6275 7420 7768 6572 6520  taset but where 
-0001a5e0: 7468 6520 7765 6967 6874 7320 6f66 0a20  the weights of. 
-0001a5f0: 2020 2020 2020 2020 2020 2069 6e63 6f72             incor
-0001a600: 7265 6374 6c79 2063 6c61 7373 6966 6965  rectly classifie
-0001a610: 6420 696e 7374 616e 6365 7320 6172 6520  d instances are 
-0001a620: 6164 6a75 7374 6564 2073 7563 6820 7468  adjusted such th
-0001a630: 6174 2073 7562 7365 7175 656e 740a 2020  at subsequent.  
-0001a640: 2020 2020 2020 2020 2020 636c 6173 7369            classi
-0001a650: 6669 6572 7320 666f 6375 7320 6d6f 7265  fiers focus more
-0001a660: 206f 6e20 6469 6666 6963 756c 7420 6361   on difficult ca
-0001a670: 7365 732e 0a0a 2020 2020 2020 2020 666f  ses...        fo
-0001a680: 6c64 3a20 696e 7465 6765 7220 6f72 2073  ld: integer or s
-0001a690: 6369 6b69 742d 6c65 6172 6e20 636f 6d70  cikit-learn comp
-0001a6a0: 6174 6962 6c65 2043 5620 6765 6e65 7261  atible CV genera
-0001a6b0: 746f 722c 2064 6566 6175 6c74 203d 204e  tor, default = N
-0001a6c0: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-0001a6d0: 436f 6e74 726f 6c73 2063 726f 7373 2d76  Controls cross-v
-0001a6e0: 616c 6964 6174 696f 6e2e 2049 6620 4e6f  alidation. If No
-0001a6f0: 6e65 2c20 7769 6c6c 2075 7365 2074 6865  ne, will use the
-0001a700: 2043 5620 6765 6e65 7261 746f 7220 6465   CV generator de
-0001a710: 6669 6e65 6420 696e 2073 6574 7570 2829  fined in setup()
-0001a720: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-0001a730: 2069 6e74 6567 6572 2c20 7769 6c6c 2075   integer, will u
-0001a740: 7365 204b 466f 6c64 2043 5620 7769 7468  se KFold CV with
-0001a750: 2074 6861 7420 6d61 6e79 2066 6f6c 6473   that many folds
-0001a760: 2e0a 2020 2020 2020 2020 2020 2020 5768  ..            Wh
-0001a770: 656e 2063 726f 7373 5f76 616c 6964 6174  en cross_validat
-0001a780: 696f 6e20 6973 2046 616c 7365 2c20 7468  ion is False, th
-0001a790: 6973 2070 6172 616d 6574 6572 2069 7320  is parameter is 
-0001a7a0: 6967 6e6f 7265 642e 0a0a 2020 2020 2020  ignored...      
-0001a7b0: 2020 6e5f 6573 7469 6d61 746f 7273 3a20    n_estimators: 
-0001a7c0: 696e 7465 6765 722c 2064 6566 6175 6c74  integer, default
-0001a7d0: 203d 2031 300a 2020 2020 2020 2020 2020   = 10.          
-0001a7e0: 2020 5468 6520 6e75 6d62 6572 206f 6620    The number of 
-0001a7f0: 6261 7365 2065 7374 696d 6174 6f72 7320  base estimators 
-0001a800: 696e 2074 6865 2065 6e73 656d 626c 652e  in the ensemble.
-0001a810: 0a20 2020 2020 2020 2020 2020 2049 6e20  .            In 
-0001a820: 6361 7365 206f 6620 7065 7266 6563 7420  case of perfect 
-0001a830: 6669 742c 2074 6865 206c 6561 726e 696e  fit, the learnin
-0001a840: 6720 7072 6f63 6564 7572 6520 6973 2073  g procedure is s
-0001a850: 746f 7070 6564 2065 6172 6c79 2e0a 0a20  topped early... 
-0001a860: 2020 2020 2020 2072 6f75 6e64 3a20 696e         round: in
-0001a870: 7465 6765 722c 2064 6566 6175 6c74 203d  teger, default =
-0001a880: 2034 0a20 2020 2020 2020 2020 2020 204e   4.            N
-0001a890: 756d 6265 7220 6f66 2064 6563 696d 616c  umber of decimal
-0001a8a0: 2070 6c61 6365 7320 7468 6520 6d65 7472   places the metr
-0001a8b0: 6963 7320 696e 2074 6865 2073 636f 7265  ics in the score
-0001a8c0: 2067 7269 6420 7769 6c6c 2062 6520 726f   grid will be ro
-0001a8d0: 756e 6465 6420 746f 2e0a 0a20 2020 2020  unded to...     
-0001a8e0: 2020 2063 686f 6f73 655f 6265 7474 6572     choose_better
-0001a8f0: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
-0001a900: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
-0001a910: 2020 2020 5768 656e 2073 6574 2074 6f20      When set to 
-0001a920: 7365 7420 746f 2054 7275 652c 2062 6173  set to True, bas
-0001a930: 6520 6573 7469 6d61 746f 7220 6973 2072  e estimator is r
-0001a940: 6574 7572 6e65 6420 7768 656e 2074 6865  eturned when the
-0001a950: 206d 6574 7269 6320 646f 6573 6e27 740a   metric doesn't.
-0001a960: 2020 2020 2020 2020 2020 2020 696d 7072              impr
-0001a970: 6f76 6520 6279 2065 6e73 656d 626c 655f  ove by ensemble_
-0001a980: 6d6f 6465 6c2e 2054 6869 7320 6775 6172  model. This guar
-0001a990: 616e 7465 6573 2074 6865 2072 6574 7572  antees the retur
-0001a9a0: 6e65 6420 6f62 6a65 6374 2077 6f75 6c64  ned object would
-0001a9b0: 2070 6572 666f 726d 0a20 2020 2020 2020   perform.       
-0001a9c0: 2020 2020 2061 7420 6c65 6173 7420 6571       at least eq
-0001a9d0: 7569 7661 6c65 6e74 2074 6f20 6261 7365  uivalent to base
-0001a9e0: 2065 7374 696d 6174 6f72 2063 7265 6174   estimator creat
-0001a9f0: 6564 2075 7369 6e67 2063 7265 6174 655f  ed using create_
-0001aa00: 6d6f 6465 6c20 6f72 206d 6f64 656c 0a20  model or model. 
-0001aa10: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001aa20: 6e65 6420 6279 2063 6f6d 7061 7265 5f6d  ned by compare_m
-0001aa30: 6f64 656c 732e 0a0a 2020 2020 2020 2020  odels...        
-0001aa40: 6f70 7469 6d69 7a65 3a20 7374 722c 2064  optimize: str, d
-0001aa50: 6566 6175 6c74 203d 2027 4163 6375 7261  efault = 'Accura
-0001aa60: 6379 270a 2020 2020 2020 2020 2020 2020  cy'.            
-0001aa70: 4f6e 6c79 2075 7365 6420 7768 656e 2063  Only used when c
-0001aa80: 686f 6f73 655f 6265 7474 6572 2069 7320  hoose_better is 
-0001aa90: 7365 7420 746f 2054 7275 652e 206f 7074  set to True. opt
-0001aaa0: 696d 697a 6520 7061 7261 6d65 7465 7220  imize parameter 
-0001aab0: 6973 2075 7365 640a 2020 2020 2020 2020  is used.        
-0001aac0: 2020 2020 746f 2063 6f6d 7061 7265 2065      to compare e
-0001aad0: 6e73 656d 626c 6564 206d 6f64 656c 2077  nsembled model w
-0001aae0: 6974 6820 6261 7365 2065 7374 696d 6174  ith base estimat
-0001aaf0: 6f72 2e20 5661 6c75 6573 2061 6363 6570  or. Values accep
-0001ab00: 7465 6420 696e 0a20 2020 2020 2020 2020  ted in.         
-0001ab10: 2020 206f 7074 696d 697a 6520 7061 7261     optimize para
-0001ab20: 6d65 7465 7220 6172 6520 2741 6363 7572  meter are 'Accur
-0001ab30: 6163 7927 2c20 2741 5543 272c 2027 5265  acy', 'AUC', 'Re
-0001ab40: 6361 6c6c 272c 2027 5072 6563 6973 696f  call', 'Precisio
-0001ab50: 6e27 2c20 2746 3127 2c0a 2020 2020 2020  n', 'F1',.      
-0001ab60: 2020 2020 2020 274b 6170 7061 272c 2027        'Kappa', '
-0001ab70: 4d43 4327 2e0a 0a20 2020 2020 2020 2066  MCC'...        f
-0001ab80: 6974 5f6b 7761 7267 733a 2064 6963 742c  it_kwargs: dict,
-0001ab90: 2064 6566 6175 6c74 203d 207b 7d20 2865   default = {} (e
-0001aba0: 6d70 7479 2064 6963 7429 0a20 2020 2020  mpty dict).     
-0001abb0: 2020 2020 2020 2044 6963 7469 6f6e 6172         Dictionar
-0001abc0: 7920 6f66 2061 7267 756d 656e 7473 2070  y of arguments p
-0001abd0: 6173 7365 6420 746f 2074 6865 2066 6974  assed to the fit
-0001abe0: 206d 6574 686f 6420 6f66 2074 6865 206d   method of the m
-0001abf0: 6f64 656c 2e0a 0a20 2020 2020 2020 2067  odel...        g
-0001ac00: 726f 7570 733a 2073 7472 206f 7220 6172  roups: str or ar
-0001ac10: 7261 792d 6c69 6b65 2c20 7769 7468 2073  ray-like, with s
-0001ac20: 6861 7065 2028 6e5f 7361 6d70 6c65 732c  hape (n_samples,
-0001ac30: 292c 2064 6566 6175 6c74 203d 204e 6f6e  ), default = Non
-0001ac40: 650a 2020 2020 2020 2020 2020 2020 4f70  e.            Op
-0001ac50: 7469 6f6e 616c 2047 726f 7570 206c 6162  tional Group lab
-0001ac60: 656c 7320 666f 7220 7468 6520 7361 6d70  els for the samp
-0001ac70: 6c65 7320 7573 6564 2077 6869 6c65 2073  les used while s
-0001ac80: 706c 6974 7469 6e67 2074 6865 2064 6174  plitting the dat
-0001ac90: 6173 6574 2069 6e74 6f20 7472 6169 6e2f  aset into train/
-0001aca0: 7465 7374 2073 6574 2e0a 2020 2020 2020  test set..      
-0001acb0: 2020 2020 2020 4966 2073 7472 696e 6720        If string 
-0001acc0: 6973 2070 6173 7365 642c 2077 696c 6c20  is passed, will 
-0001acd0: 7573 6520 7468 6520 6461 7461 2063 6f6c  use the data col
-0001ace0: 756d 6e20 7769 7468 2074 6861 7420 6e61  umn with that na
-0001acf0: 6d65 2061 7320 7468 6520 6772 6f75 7073  me as the groups
-0001ad00: 2e0a 2020 2020 2020 2020 2020 2020 4f6e  ..            On
-0001ad10: 6c79 2075 7365 6420 6966 2061 2067 726f  ly used if a gro
-0001ad20: 7570 2062 6173 6564 2063 726f 7373 2d76  up based cross-v
-0001ad30: 616c 6964 6174 696f 6e20 6765 6e65 7261  alidation genera
-0001ad40: 746f 7220 6973 2075 7365 6420 2865 672e  tor is used (eg.
-0001ad50: 2047 726f 7570 4b46 6f6c 6429 2e0a 2020   GroupKFold)..  
-0001ad60: 2020 2020 2020 2020 2020 4966 204e 6f6e            If Non
-0001ad70: 652c 2077 696c 6c20 7573 6520 7468 6520  e, will use the 
-0001ad80: 7661 6c75 6520 7365 7420 696e 2066 6f6c  value set in fol
-0001ad90: 645f 6772 6f75 7073 2070 6172 616d 6574  d_groups paramet
-0001ada0: 6572 2069 6e20 7365 7475 7028 292e 0a0a  er in setup()...
-0001adb0: 2020 2020 2020 2020 7665 7262 6f73 653a          verbose:
-0001adc0: 2062 6f6f 6c2c 2064 6566 6175 6c74 203d   bool, default =
-0001add0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
-0001ade0: 2020 5363 6f72 6520 6772 6964 2069 7320    Score grid is 
-0001adf0: 6e6f 7420 7072 696e 7465 6420 7768 656e  not printed when
-0001ae00: 2076 6572 626f 7365 2069 7320 7365 7420   verbose is set 
-0001ae10: 746f 2046 616c 7365 2e0a 0a20 2020 2020  to False...     
-0001ae20: 2020 2072 6574 7572 6e5f 7472 6169 6e5f     return_train_
-0001ae30: 7363 6f72 653a 2062 6f6f 6c2c 2064 6566  score: bool, def
-0001ae40: 6175 6c74 203d 2046 616c 7365 0a20 2020  ault = False.   
-0001ae50: 2020 2020 2020 2020 2049 6620 4661 6c73           If Fals
-0001ae60: 652c 2072 6574 7572 6e73 2074 6865 2043  e, returns the C
-0001ae70: 5620 5661 6c69 6461 7469 6f6e 2073 636f  V Validation sco
-0001ae80: 7265 7320 6f6e 6c79 2e0a 2020 2020 2020  res only..      
-0001ae90: 2020 2020 2020 4966 2054 7275 652c 2072        If True, r
-0001aea0: 6574 7572 6e73 2074 6865 2043 5620 7472  eturns the CV tr
-0001aeb0: 6169 6e69 6e67 2073 636f 7265 7320 616c  aining scores al
-0001aec0: 6f6e 6720 7769 7468 2074 6865 2043 5620  ong with the CV 
-0001aed0: 7661 6c69 6461 7469 6f6e 2073 636f 7265  validation score
-0001aee0: 732e 0a20 2020 2020 2020 2020 2020 2054  s..            T
-0001aef0: 6869 7320 6973 2075 7365 6675 6c20 7768  his is useful wh
-0001af00: 656e 2074 6865 2075 7365 7220 7761 6e74  en the user want
-0001af10: 7320 746f 2064 6f20 6269 6173 2d76 6172  s to do bias-var
-0001af20: 6961 6e63 6520 7472 6164 656f 6666 2e20  iance tradeoff. 
-0001af30: 4120 6869 6768 2043 560a 2020 2020 2020  A high CV.      
-0001af40: 2020 2020 2020 7472 6169 6e69 6e67 2073        training s
-0001af50: 636f 7265 2077 6974 6820 6120 6c6f 7720  core with a low 
-0001af60: 636f 7272 6573 706f 6e64 696e 6720 4356  corresponding CV
-0001af70: 2076 616c 6964 6174 696f 6e20 7363 6f72   validation scor
-0001af80: 6520 696e 6469 6361 7465 7320 6f76 6572  e indicates over
-0001af90: 6669 7474 696e 672e 0a0a 2020 2020 2020  fitting...      
-0001afa0: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
-0001afb0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-0001afc0: 2020 7363 6f72 655f 6772 6964 0a20 2020    score_grid.   
-0001afd0: 2020 2020 2020 2020 2041 2074 6162 6c65           A table
-0001afe0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-0001aff0: 7363 6f72 6573 206f 6620 7468 6520 6d6f  scores of the mo
-0001b000: 6465 6c20 6163 726f 7373 2074 6865 206b  del across the k
-0001b010: 666f 6c64 732e 0a20 2020 2020 2020 2020  folds..         
-0001b020: 2020 2053 636f 7269 6e67 206d 6574 7269     Scoring metri
-0001b030: 6373 2075 7365 6420 6172 6520 4163 6375  cs used are Accu
-0001b040: 7261 6379 2c20 4155 432c 2052 6563 616c  racy, AUC, Recal
-0001b050: 6c2c 2050 7265 6369 7369 6f6e 2c20 4631  l, Precision, F1
-0001b060: 2c0a 2020 2020 2020 2020 2020 2020 4b61  ,.            Ka
-0001b070: 7070 6120 616e 6420 4d43 432e 204d 6561  ppa and MCC. Mea
-0001b080: 6e20 616e 6420 7374 616e 6461 7264 2064  n and standard d
-0001b090: 6576 6961 7469 6f6e 206f 6620 7468 6520  eviation of the 
-0001b0a0: 7363 6f72 6573 2061 6372 6f73 730a 2020  scores across.  
-0001b0b0: 2020 2020 2020 2020 2020 7468 6520 666f            the fo
-0001b0c0: 6c64 7320 6172 6520 616c 736f 2072 6574  lds are also ret
-0001b0d0: 7572 6e65 642e 0a0a 2020 2020 2020 2020  urned...        
-0001b0e0: 6d6f 6465 6c0a 2020 2020 2020 2020 2020  model.          
-0001b0f0: 2020 5472 6169 6e65 6420 656e 7365 6d62    Trained ensemb
-0001b100: 6c65 6420 6d6f 6465 6c20 6f62 6a65 6374  led model object
-0001b110: 2e0a 0a20 2020 2020 2020 2057 6172 6e69  ...        Warni
-0001b120: 6e67 730a 2020 2020 2020 2020 2d2d 2d2d  ngs.        ----
-0001b130: 2d2d 2d2d 0a20 2020 2020 2020 202d 2049  ----.        - I
-0001b140: 6620 7461 7267 6574 2076 6172 6961 626c  f target variabl
-0001b150: 6520 6973 206d 756c 7469 636c 6173 7320  e is multiclass 
-0001b160: 286d 6f72 6520 7468 616e 2032 2063 6c61  (more than 2 cla
-0001b170: 7373 6573 292c 2041 5543 2077 696c 6c20  sses), AUC will 
-0001b180: 6265 2072 6574 7572 6e65 640a 2020 2020  be returned.    
-0001b190: 2020 2020 6173 207a 6572 6f20 2830 2e30      as zero (0.0
-0001b1a0: 292e 0a0a 0a20 2020 2020 2020 2022 2222  )....        """
-0001b1b0: 0a0a 2020 2020 2020 2020 6675 6e63 7469  ..        functi
-0001b1c0: 6f6e 5f70 6172 616d 735f 7374 7220 3d20  on_params_str = 
-0001b1d0: 222c 2022 2e6a 6f69 6e28 5b66 227b 6b7d  ", ".join([f"{k}
-0001b1e0: 3d7b 767d 2220 666f 7220 6b2c 2076 2069  ={v}" for k, v i
-0001b1f0: 6e20 6c6f 6361 6c73 2829 2e69 7465 6d73  n locals().items
-0001b200: 2829 5d29 0a0a 2020 2020 2020 2020 7365  ()])..        se
-0001b210: 6c66 2e6c 6f67 6765 722e 696e 666f 2822  lf.logger.info("
-0001b220: 496e 6974 6961 6c69 7a69 6e67 2065 6e73  Initializing ens
-0001b230: 656d 626c 655f 6d6f 6465 6c28 2922 290a  emble_model()").
-0001b240: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-0001b250: 6765 722e 696e 666f 2866 2265 6e73 656d  ger.info(f"ensem
-0001b260: 626c 655f 6d6f 6465 6c28 7b66 756e 6374  ble_model({funct
-0001b270: 696f 6e5f 7061 7261 6d73 5f73 7472 7d29  ion_params_str})
-0001b280: 2229 0a0a 2020 2020 2020 2020 7365 6c66  ")..        self
-0001b290: 2e6c 6f67 6765 722e 696e 666f 2822 4368  .logger.info("Ch
-0001b2a0: 6563 6b69 6e67 2065 7863 6570 7469 6f6e  ecking exception
-0001b2b0: 7322 290a 0a20 2020 2020 2020 2023 2072  s")..        # r
-0001b2c0: 756e 5f74 696d 650a 2020 2020 2020 2020  un_time.        
-0001b2d0: 7275 6e74 696d 655f 7374 6172 7420 3d20  runtime_start = 
-0001b2e0: 7469 6d65 2e74 696d 6528 290a 0a20 2020  time.time()..   
-0001b2f0: 2020 2020 2069 6620 6e6f 7420 6669 745f       if not fit_
-0001b300: 6b77 6172 6773 3a0a 2020 2020 2020 2020  kwargs:.        
-0001b310: 2020 2020 6669 745f 6b77 6172 6773 203d      fit_kwargs =
-0001b320: 207b 7d0a 0a20 2020 2020 2020 2023 2043   {}..        # C
-0001b330: 6865 636b 2066 6f72 2065 7374 696d 6174  heck for estimat
-0001b340: 6f72 0a20 2020 2020 2020 2069 6620 6e6f  or.        if no
-0001b350: 7420 6861 7361 7474 7228 6573 7469 6d61  t hasattr(estima
-0001b360: 746f 722c 2022 6669 7422 293a 0a20 2020  tor, "fit"):.   
-0001b370: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0001b380: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-0001b390: 2020 2020 2020 2020 2020 2066 2245 7374             f"Est
-0001b3a0: 696d 6174 6f72 207b 6573 7469 6d61 746f  imator {estimato
-0001b3b0: 727d 2064 6f65 7320 6e6f 7420 6861 7665  r} does not have
-0001b3c0: 2074 6865 2072 6571 7569 7265 6420 6669   the required fi
-0001b3d0: 7428 2920 6d65 7468 6f64 2e22 0a20 2020  t() method.".   
-0001b3e0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0001b3f0: 2020 2020 2320 4368 6563 6b20 666f 7220      # Check for 
-0001b400: 616c 6c6f 7765 6420 6d65 7468 6f64 0a20  allowed method. 
-0001b410: 2020 2020 2020 2061 7661 696c 6162 6c65         available
-0001b420: 5f6d 6574 686f 6420 3d20 5b22 4261 6767  _method = ["Bagg
-0001b430: 696e 6722 2c20 2242 6f6f 7374 696e 6722  ing", "Boosting"
-0001b440: 5d0a 2020 2020 2020 2020 6966 206d 6574  ].        if met
-0001b450: 686f 6420 6e6f 7420 696e 2061 7661 696c  hod not in avail
-0001b460: 6162 6c65 5f6d 6574 686f 643a 0a20 2020  able_method:.   
-0001b470: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0001b480: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-0001b490: 2020 2020 2020 2020 2020 2022 4d65 7468             "Meth
-0001b4a0: 6f64 2070 6172 616d 6574 6572 206f 6e6c  od parameter onl
-0001b4b0: 7920 6163 6365 7074 7320 7477 6f20 7661  y accepts two va
-0001b4c0: 6c75 6573 2027 4261 6767 696e 6727 206f  lues 'Bagging' o
-0001b4d0: 7220 2742 6f6f 7374 696e 6727 2e22 0a20  r 'Boosting'.". 
-0001b4e0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0001b4f0: 2020 2020 2020 2320 6368 6563 6b20 626f        # check bo
-0001b500: 6f73 7469 6e67 2063 6f6e 666c 6963 740a  osting conflict.
-0001b510: 2020 2020 2020 2020 6966 206d 6574 686f          if metho
-0001b520: 6420 3d3d 2022 426f 6f73 7469 6e67 223a  d == "Boosting":
-0001b530: 0a0a 2020 2020 2020 2020 2020 2020 626f  ..            bo
-0001b540: 6f73 7469 6e67 5f6d 6f64 656c 5f64 6566  osting_model_def
-0001b550: 696e 6974 696f 6e20 3d20 7365 6c66 2e5f  inition = self._
-0001b560: 616c 6c5f 6d6f 6465 6c73 5f69 6e74 6572  all_models_inter
-0001b570: 6e61 6c5b 2261 6461 225d 0a0a 2020 2020  nal["ada"]..    
-0001b580: 2020 2020 2020 2020 6368 6563 6b5f 6d6f          check_mo
-0001b590: 6465 6c20 3d20 6573 7469 6d61 746f 720a  del = estimator.
-0001b5a0: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
-0001b5b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001b5c0: 2020 6368 6563 6b5f 6d6f 6465 6c20 3d20    check_model = 
-0001b5d0: 626f 6f73 7469 6e67 5f6d 6f64 656c 5f64  boosting_model_d
-0001b5e0: 6566 696e 6974 696f 6e2e 636c 6173 735f  efinition.class_
-0001b5f0: 6465 6628 0a20 2020 2020 2020 2020 2020  def(.           
-0001b600: 2020 2020 2020 2020 2063 6865 636b 5f6d           check_m
-0001b610: 6f64 656c 2c0a 2020 2020 2020 2020 2020  odel,.          
-0001b620: 2020 2020 2020 2020 2020 6e5f 6573 7469            n_esti
-0001b630: 6d61 746f 7273 3d6e 5f65 7374 696d 6174  mators=n_estimat
-0001b640: 6f72 732c 0a20 2020 2020 2020 2020 2020  ors,.           
-0001b650: 2020 2020 2020 2020 202a 2a62 6f6f 7374           **boost
-0001b660: 696e 675f 6d6f 6465 6c5f 6465 6669 6e69  ing_model_defini
-0001b670: 7469 6f6e 2e61 7267 732c 0a20 2020 2020  tion.args,.     
-0001b680: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001b690: 2020 2020 2020 2020 2020 2020 2077 6974               wit
-0001b6a0: 6820 7265 6469 7265 6374 5f6f 7574 7075  h redirect_outpu
-0001b6b0: 7428 7365 6c66 2e6c 6f67 6765 7229 3a0a  t(self.logger):.
-0001b6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b6d0: 2020 2020 6368 6563 6b5f 6d6f 6465 6c2e      check_model.
-0001b6e0: 6669 7428 7365 6c66 2e58 5f74 7261 696e  fit(self.X_train
-0001b6f0: 5f74 7261 6e73 666f 726d 6564 2c20 7365  _transformed, se
-0001b700: 6c66 2e79 5f74 7261 696e 5f74 7261 6e73  lf.y_train_trans
-0001b710: 666f 726d 6564 290a 2020 2020 2020 2020  formed).        
-0001b720: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
-0001b730: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
-0001b740: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-0001b750: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0001b760: 2020 2020 2020 2020 2020 2022 4573 7469             "Esti
-0001b770: 6d61 746f 7220 6e6f 7420 7375 7070 6f72  mator not suppor
-0001b780: 7465 6420 666f 7220 7468 6520 426f 6f73  ted for the Boos
-0001b790: 7469 6e67 206d 6574 686f 642e 2043 6861  ting method. Cha
-0001b7a0: 6e67 6520 7468 6520 6573 7469 6d61 746f  nge the estimato
-0001b7b0: 7220 6f72 206d 6574 686f 6420 746f 2027  r or method to '
-0001b7c0: 4261 6767 696e 6727 2e22 0a20 2020 2020  Bagging'.".     
-0001b7d0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0001b7e0: 2020 2020 2020 2320 6368 6563 6b69 6e67        # checking
-0001b7f0: 2066 6f6c 6420 7061 7261 6d65 7465 720a   fold parameter.
-0001b800: 2020 2020 2020 2020 6966 2066 6f6c 6420          if fold 
-0001b810: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
-0001b820: 6e6f 7420 280a 2020 2020 2020 2020 2020  not (.          
-0001b830: 2020 7479 7065 2866 6f6c 6429 2069 7320    type(fold) is 
-0001b840: 696e 7420 6f72 2069 735f 736b 6c65 6172  int or is_sklear
-0001b850: 6e5f 6376 5f67 656e 6572 6174 6f72 2866  n_cv_generator(f
-0001b860: 6f6c 6429 0a20 2020 2020 2020 2029 3a0a  old).        ):.
-0001b870: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0001b880: 6520 5479 7065 4572 726f 7228 0a20 2020  e TypeError(.   
-0001b890: 2020 2020 2020 2020 2020 2020 2022 666f               "fo
-0001b8a0: 6c64 2070 6172 616d 6574 6572 206d 7573  ld parameter mus
-0001b8b0: 7420 6265 2065 6974 6865 7220 4e6f 6e65  t be either None
-0001b8c0: 2c20 616e 2069 6e74 6567 6572 206f 7220  , an integer or 
-0001b8d0: 6120 7363 696b 6974 2d6c 6561 726e 2063  a scikit-learn c
-0001b8e0: 6f6d 7061 7469 626c 6520 4356 2067 656e  ompatible CV gen
-0001b8f0: 6572 6174 6f72 206f 626a 6563 742e 220a  erator object.".
-0001b900: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0001b910: 2020 2020 2020 2023 2063 6865 636b 696e         # checkin
-0001b920: 6720 6e5f 6573 7469 6d61 746f 7273 2070  g n_estimators p
-0001b930: 6172 616d 6574 6572 0a20 2020 2020 2020  arameter.       
-0001b940: 2069 6620 7479 7065 286e 5f65 7374 696d   if type(n_estim
-0001b950: 6174 6f72 7329 2069 7320 6e6f 7420 696e  ators) is not in
-0001b960: 743a 0a20 2020 2020 2020 2020 2020 2072  t:.            r
-0001b970: 6169 7365 2054 7970 6545 7272 6f72 2822  aise TypeError("
-0001b980: 6e5f 6573 7469 6d61 746f 7273 2070 6172  n_estimators par
-0001b990: 616d 6574 6572 206f 6e6c 7920 6163 6365  ameter only acce
-0001b9a0: 7074 7320 696e 7465 6765 7220 7661 6c75  pts integer valu
-0001b9b0: 652e 2229 0a0a 2020 2020 2020 2020 2320  e.")..        # 
-0001b9c0: 6368 6563 6b69 6e67 2072 6f75 6e64 2070  checking round p
-0001b9d0: 6172 616d 6574 6572 0a20 2020 2020 2020  arameter.       
-0001b9e0: 2069 6620 7479 7065 2872 6f75 6e64 2920   if type(round) 
-0001b9f0: 6973 206e 6f74 2069 6e74 3a0a 2020 2020  is not int:.    
-0001ba00: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-0001ba10: 7065 4572 726f 7228 2252 6f75 6e64 2070  peError("Round p
-0001ba20: 6172 616d 6574 6572 206f 6e6c 7920 6163  arameter only ac
-0001ba30: 6365 7074 7320 696e 7465 6765 7220 7661  cepts integer va
-0001ba40: 6c75 652e 2229 0a0a 2020 2020 2020 2020  lue.")..        
-0001ba50: 2320 6368 6563 6b69 6e67 2076 6572 626f  # checking verbo
-0001ba60: 7365 2070 6172 616d 6574 6572 0a20 2020  se parameter.   
-0001ba70: 2020 2020 2069 6620 7479 7065 2876 6572       if type(ver
-0001ba80: 626f 7365 2920 6973 206e 6f74 2062 6f6f  bose) is not boo
-0001ba90: 6c3a 0a20 2020 2020 2020 2020 2020 2072  l:.            r
-0001baa0: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
-0001bab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bac0: 2256 6572 626f 7365 2070 6172 616d 6574  "Verbose paramet
-0001bad0: 6572 2063 616e 206f 6e6c 7920 7461 6b65  er can only take
-0001bae0: 2061 7267 756d 656e 7420 6173 2054 7275   argument as Tru
-0001baf0: 6520 6f72 2046 616c 7365 2e22 0a20 2020  e or False.".   
-0001bb00: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0001bb10: 2020 2020 2320 6368 6563 6b69 6e67 206f      # checking o
-0001bb20: 7074 696d 697a 6520 7061 7261 6d65 7465  ptimize paramete
-0001bb30: 720a 2020 2020 2020 2020 6f70 7469 6d69  r.        optimi
-0001bb40: 7a65 203d 2073 656c 662e 5f67 6574 5f6d  ze = self._get_m
-0001bb50: 6574 7269 635f 6279 5f6e 616d 655f 6f72  etric_by_name_or
-0001bb60: 5f69 6428 6f70 7469 6d69 7a65 290a 2020  _id(optimize).  
-0001bb70: 2020 2020 2020 6966 206f 7074 696d 697a        if optimiz
-0001bb80: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-0001bb90: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0001bba0: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
-0001bbb0: 2020 2020 2020 2020 2022 4f70 7469 6d69           "Optimi
-0001bbc0: 7a65 206d 6574 686f 6420 6e6f 7420 7375  ze method not su
-0001bbd0: 7070 6f72 7465 642e 2053 6565 2064 6f63  pported. See doc
-0001bbe0: 7374 7269 6e67 2066 6f72 206c 6973 7420  string for list 
-0001bbf0: 6f66 2061 7661 696c 6162 6c65 2070 6172  of available par
-0001bc00: 616d 6574 6572 732e 220a 2020 2020 2020  ameters.".      
-0001bc10: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0001bc20: 2023 2063 6865 636b 696e 6720 6f70 7469   # checking opti
-0001bc30: 6d69 7a65 2070 6172 616d 6574 6572 2066  mize parameter f
-0001bc40: 6f72 206d 756c 7469 636c 6173 730a 2020  or multiclass.  
-0001bc50: 2020 2020 2020 6966 2073 656c 662e 6973        if self.is
-0001bc60: 5f6d 756c 7469 636c 6173 733a 0a20 2020  _multiclass:.   
-0001bc70: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-0001bc80: 6f70 7469 6d69 7a65 2e69 735f 6d75 6c74  optimize.is_mult
-0001bc90: 6963 6c61 7373 3a0a 2020 2020 2020 2020  iclass:.        
-0001bca0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-0001bcb0: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
-0001bcc0: 2020 2020 2020 2020 2020 2020 2022 4f70               "Op
-0001bcd0: 7469 6d69 7a61 7469 6f6e 206d 6574 7269  timization metri
-0001bce0: 6320 6e6f 7420 7375 7070 6f72 7465 6420  c not supported 
-0001bcf0: 666f 7220 6d75 6c74 6963 6c61 7373 2070  for multiclass p
-0001bd00: 726f 626c 656d 732e 2053 6565 2064 6f63  roblems. See doc
-0001bd10: 7374 7269 6e67 2066 6f72 206c 6973 7420  string for list 
-0001bd20: 6f66 206f 7468 6572 206f 7074 696d 697a  of other optimiz
-0001bd30: 6174 696f 6e20 7061 7261 6d65 7465 7273  ation parameters
-0001bd40: 2e22 0a20 2020 2020 2020 2020 2020 2020  .".             
-0001bd50: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
-0001bd60: 6368 6563 6b69 6e67 2072 6574 7572 6e5f  checking return_
-0001bd70: 7472 6169 6e5f 7363 6f72 6520 7061 7261  train_score para
-0001bd80: 6d65 7465 720a 2020 2020 2020 2020 6966  meter.        if
-0001bd90: 2074 7970 6528 7265 7475 726e 5f74 7261   type(return_tra
-0001bda0: 696e 5f73 636f 7265 2920 6973 206e 6f74  in_score) is not
-0001bdb0: 2062 6f6f 6c3a 0a20 2020 2020 2020 2020   bool:.         
-0001bdc0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-0001bdd0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0001bde0: 2020 2020 2272 6574 7572 6e5f 7472 6169      "return_trai
-0001bdf0: 6e5f 7363 6f72 6520 6361 6e20 6f6e 6c79  n_score can only
-0001be00: 2074 616b 6520 6172 6775 6d65 6e74 2061   take argument a
-0001be10: 7320 5472 7565 206f 7220 4661 6c73 6522  s True or False"
-0001be20: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-0001be30: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-0001be40: 2020 2020 2045 5252 4f52 2048 414e 444c       ERROR HANDL
-0001be50: 494e 4720 454e 4453 2048 4552 450a 0a20  ING ENDS HERE.. 
-0001be60: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-0001be70: 2020 2020 666f 6c64 203d 2073 656c 662e      fold = self.
-0001be80: 5f67 6574 5f63 765f 7370 6c69 7474 6572  _get_cv_splitter
-0001be90: 2866 6f6c 6429 0a0a 2020 2020 2020 2020  (fold)..        
-0001bea0: 6772 6f75 7073 203d 2073 656c 662e 5f67  groups = self._g
-0001beb0: 6574 5f67 726f 7570 7328 6772 6f75 7073  et_groups(groups
-0001bec0: 290a 0a20 2020 2020 2020 2070 726f 6772  )..        progr
-0001bed0: 6573 735f 6172 6773 203d 207b 226d 6178  ess_args = {"max
-0001bee0: 223a 2032 202b 2034 7d0a 2020 2020 2020  ": 2 + 4}.      
-0001bef0: 2020 7469 6d65 7374 616d 7053 7472 203d    timestampStr =
-0001bf00: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
-0001bf10: 6d65 2e6e 6f77 2829 2e73 7472 6674 696d  me.now().strftim
-0001bf20: 6528 2225 483a 254d 3a25 5322 290a 2020  e("%H:%M:%S").  
-0001bf30: 2020 2020 2020 6d6f 6e69 746f 725f 726f        monitor_ro
-0001bf40: 7773 203d 205b 0a20 2020 2020 2020 2020  ws = [.         
-0001bf50: 2020 205b 2249 6e69 7469 6174 6564 222c     ["Initiated",
-0001bf60: 2022 2e20 2e20 2e20 2e20 2e20 2e20 2e20   ". . . . . . . 
-0001bf70: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
-0001bf80: 2e20 2e20 2e22 2c20 7469 6d65 7374 616d  . . .", timestam
-0001bf90: 7053 7472 5d2c 0a20 2020 2020 2020 2020  pStr],.         
-0001bfa0: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-0001bfb0: 2020 2020 2022 5374 6174 7573 222c 0a20       "Status",. 
-0001bfc0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001bfd0: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
-0001bfe0: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
-0001bff0: 2e20 2e22 2c0a 2020 2020 2020 2020 2020  . .",.          
-0001c000: 2020 2020 2020 224c 6f61 6469 6e67 2044        "Loading D
-0001c010: 6570 656e 6465 6e63 6965 7322 2c0a 2020  ependencies",.  
-0001c020: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-0001c030: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
-0001c040: 2020 2020 2020 2020 2020 2022 4573 7469             "Esti
-0001c050: 6d61 746f 7222 2c0a 2020 2020 2020 2020  mator",.        
-0001c060: 2020 2020 2020 2020 222e 202e 202e 202e          ". . . .
-0001c070: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
-0001c080: 202e 202e 202e 202e 202e 202e 222c 0a20   . . . . . .",. 
-0001c090: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001c0a0: 436f 6d70 696c 696e 6720 4c69 6272 6172  Compiling Librar
-0001c0b0: 7922 2c0a 2020 2020 2020 2020 2020 2020  y",.            
-0001c0c0: 5d2c 0a20 2020 2020 2020 205d 0a20 2020  ],.        ].   
-0001c0d0: 2020 2020 2064 6973 706c 6179 203d 2043       display = C
-0001c0e0: 6f6d 6d6f 6e44 6973 706c 6179 280a 2020  ommonDisplay(.  
-0001c0f0: 2020 2020 2020 2020 2020 7665 7262 6f73            verbos
-0001c100: 653d 7665 7262 6f73 652c 0a20 2020 2020  e=verbose,.     
-0001c110: 2020 2020 2020 2068 746d 6c5f 7061 7261         html_para
-0001c120: 6d3d 7365 6c66 2e68 746d 6c5f 7061 7261  m=self.html_para
-0001c130: 6d2c 0a20 2020 2020 2020 2020 2020 2070  m,.            p
-0001c140: 726f 6772 6573 735f 6172 6773 3d70 726f  rogress_args=pro
-0001c150: 6772 6573 735f 6172 6773 2c0a 2020 2020  gress_args,.    
-0001c160: 2020 2020 2020 2020 6d6f 6e69 746f 725f          monitor_
-0001c170: 726f 7773 3d6d 6f6e 6974 6f72 5f72 6f77  rows=monitor_row
-0001c180: 732c 0a20 2020 2020 2020 2029 0a0a 2020  s,.        )..  
-0001c190: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
-0001c1a0: 722e 696e 666f 2822 496d 706f 7274 696e  r.info("Importin
-0001c1b0: 6720 6c69 6272 6172 6965 7322 290a 0a20  g libraries").. 
-0001c1c0: 2020 2020 2020 206e 702e 7261 6e64 6f6d         np.random
-0001c1d0: 2e73 6565 6428 7365 6c66 2e73 6565 6429  .seed(self.seed)
-0001c1e0: 0a0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
-0001c1f0: 6f67 6765 722e 696e 666f 2822 436f 7079  ogger.info("Copy
-0001c200: 696e 6720 7472 6169 6e69 6e67 2064 6174  ing training dat
-0001c210: 6173 6574 2229 0a0a 2020 2020 2020 2020  aset")..        
-0001c220: 6469 7370 6c61 792e 6d6f 7665 5f70 726f  display.move_pro
-0001c230: 6772 6573 7328 290a 0a20 2020 2020 2020  gress()..       
-0001c240: 2023 2073 6574 7469 6e67 206f 7074 696d   # setting optim
-0001c250: 697a 6520 7061 7261 6d65 7465 720a 0a20  ize parameter.. 
-0001c260: 2020 2020 2020 2063 6f6d 7061 7265 5f64         compare_d
-0001c270: 696d 656e 7369 6f6e 203d 206f 7074 696d  imension = optim
-0001c280: 697a 652e 6469 7370 6c61 795f 6e61 6d65  ize.display_name
-0001c290: 0a20 2020 2020 2020 206f 7074 696d 697a  .        optimiz
-0001c2a0: 6520 3d20 6f70 7469 6d69 7a65 2e73 636f  e = optimize.sco
-0001c2b0: 7265 720a 0a20 2020 2020 2020 2073 656c  rer..        sel
-0001c2c0: 662e 6c6f 6767 6572 2e69 6e66 6f28 2243  f.logger.info("C
-0001c2d0: 6865 636b 696e 6720 6261 7365 206d 6f64  hecking base mod
-0001c2e0: 656c 2229 0a0a 2020 2020 2020 2020 5f65  el")..        _e
-0001c2f0: 7374 696d 6174 6f72 5f20 3d20 6573 7469  stimator_ = esti
-0001c300: 6d61 746f 720a 0a20 2020 2020 2020 2065  mator..        e
-0001c310: 7374 696d 6174 6f72 5f69 6420 3d20 7365  stimator_id = se
-0001c320: 6c66 2e5f 6765 745f 6d6f 6465 6c5f 6964  lf._get_model_id
-0001c330: 2865 7374 696d 6174 6f72 290a 0a20 2020  (estimator)..   
-0001c340: 2020 2020 2069 6620 6573 7469 6d61 746f       if estimato
-0001c350: 725f 6964 2069 7320 4e6f 6e65 3a0a 2020  r_id is None:.  
-0001c360: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-0001c370: 746f 725f 6e61 6d65 203d 2073 656c 662e  tor_name = self.
-0001c380: 5f67 6574 5f6d 6f64 656c 5f6e 616d 6528  _get_model_name(
-0001c390: 6573 7469 6d61 746f 7229 0a20 2020 2020  estimator).     
-0001c3a0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
-0001c3b0: 6572 2e69 6e66 6f28 2241 2063 7573 746f  er.info("A custo
-0001c3c0: 6d20 6d6f 6465 6c20 6861 7320 6265 656e  m model has been
-0001c3d0: 2070 6173 7365 6422 290a 2020 2020 2020   passed").      
-0001c3e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001c3f0: 2020 2020 6573 7469 6d61 746f 725f 6465      estimator_de
-0001c400: 6669 6e69 7469 6f6e 203d 2073 656c 662e  finition = self.
-0001c410: 5f61 6c6c 5f6d 6f64 656c 735f 696e 7465  _all_models_inte
-0001c420: 726e 616c 5b65 7374 696d 6174 6f72 5f69  rnal[estimator_i
-0001c430: 645d 0a20 2020 2020 2020 2020 2020 2065  d].            e
-0001c440: 7374 696d 6174 6f72 5f6e 616d 6520 3d20  stimator_name = 
-0001c450: 6573 7469 6d61 746f 725f 6465 6669 6e69  estimator_defini
-0001c460: 7469 6f6e 2e6e 616d 650a 0a20 2020 2020  tion.name..     
-0001c470: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
-0001c480: 6e66 6f28 6622 4261 7365 206d 6f64 656c  nfo(f"Base model
-0001c490: 203a 207b 6573 7469 6d61 746f 725f 6e61   : {estimator_na
-0001c4a0: 6d65 7d22 290a 0a20 2020 2020 2020 2064  me}")..        d
-0001c4b0: 6973 706c 6179 2e75 7064 6174 655f 6d6f  isplay.update_mo
-0001c4c0: 6e69 746f 7228 322c 2065 7374 696d 6174  nitor(2, estimat
-0001c4d0: 6f72 5f6e 616d 6529 0a0a 2020 2020 2020  or_name)..      
-0001c4e0: 2020 2222 220a 2020 2020 2020 2020 4d4f    """.        MO
-0001c4f0: 4e49 544f 5220 5550 4441 5445 2053 5441  NITOR UPDATE STA
-0001c500: 5254 530a 2020 2020 2020 2020 2222 220a  RTS.        """.
-0001c510: 0a20 2020 2020 2020 2064 6973 706c 6179  .        display
-0001c520: 2e75 7064 6174 655f 6d6f 6e69 746f 7228  .update_monitor(
-0001c530: 312c 2022 5365 6c65 6374 696e 6720 4573  1, "Selecting Es
-0001c540: 7469 6d61 746f 7222 290a 0a20 2020 2020  timator")..     
-0001c550: 2020 2022 2222 0a20 2020 2020 2020 204d     """.        M
-0001c560: 4f4e 4954 4f52 2055 5044 4154 4520 454e  ONITOR UPDATE EN
-0001c570: 4453 0a20 2020 2020 2020 2022 2222 0a0a  DS.        """..
-0001c580: 2020 2020 2020 2020 6d6f 6465 6c20 3d20          model = 
-0001c590: 6765 745f 6573 7469 6d61 746f 725f 6672  get_estimator_fr
-0001c5a0: 6f6d 5f6d 6574 615f 6573 7469 6d61 746f  om_meta_estimato
-0001c5b0: 7228 5f65 7374 696d 6174 6f72 5f29 0a0a  r(_estimator_)..
-0001c5c0: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-0001c5d0: 6765 722e 696e 666f 2822 496d 706f 7274  ger.info("Import
-0001c5e0: 696e 6720 756e 7472 6169 6e65 6420 656e  ing untrained en
-0001c5f0: 7365 6d62 6c65 7222 290a 0a20 2020 2020  sembler")..     
-0001c600: 2020 2069 6620 6d65 7468 6f64 203d 3d20     if method == 
-0001c610: 2242 6167 6769 6e67 223a 0a20 2020 2020  "Bagging":.     
-0001c620: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
-0001c630: 6572 2e69 6e66 6f28 2245 6e73 656d 626c  er.info("Ensembl
-0001c640: 6520 6d65 7468 6f64 2073 6574 2074 6f20  e method set to 
-0001c650: 4261 6767 696e 6722 290a 2020 2020 2020  Bagging").      
-0001c660: 2020 2020 2020 6261 6767 696e 675f 6d6f        bagging_mo
-0001c670: 6465 6c5f 6465 6669 6e69 7469 6f6e 203d  del_definition =
-0001c680: 2073 656c 662e 5f61 6c6c 5f6d 6f64 656c   self._all_model
-0001c690: 735f 696e 7465 726e 616c 5b22 4261 6767  s_internal["Bagg
-0001c6a0: 696e 6722 5d0a 0a20 2020 2020 2020 2020  ing"]..         
-0001c6b0: 2020 206d 6f64 656c 203d 2062 6167 6769     model = baggi
-0001c6c0: 6e67 5f6d 6f64 656c 5f64 6566 696e 6974  ng_model_definit
-0001c6d0: 696f 6e2e 636c 6173 735f 6465 6628 0a20  ion.class_def(. 
-0001c6e0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0001c6f0: 6f64 656c 2c0a 2020 2020 2020 2020 2020  odel,.          
-0001c700: 2020 2020 2020 626f 6f74 7374 7261 703d        bootstrap=
-0001c710: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
-0001c720: 2020 2020 2020 6e5f 6573 7469 6d61 746f        n_estimato
-0001c730: 7273 3d6e 5f65 7374 696d 6174 6f72 732c  rs=n_estimators,
-0001c740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c750: 202a 2a62 6167 6769 6e67 5f6d 6f64 656c   **bagging_model
-0001c760: 5f64 6566 696e 6974 696f 6e2e 6172 6773  _definition.args
-0001c770: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0001c780: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0001c790: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001c7a0: 6c6f 6767 6572 2e69 6e66 6f28 2245 6e73  logger.info("Ens
-0001c7b0: 656d 626c 6520 6d65 7468 6f64 2073 6574  emble method set
-0001c7c0: 2074 6f20 426f 6f73 7469 6e67 2229 0a20   to Boosting"). 
-0001c7d0: 2020 2020 2020 2020 2020 2062 6f6f 7374             boost
-0001c7e0: 696e 675f 6d6f 6465 6c5f 6465 6669 6e69  ing_model_defini
-0001c7f0: 7469 6f6e 203d 2073 656c 662e 5f61 6c6c  tion = self._all
-0001c800: 5f6d 6f64 656c 735f 696e 7465 726e 616c  _models_internal
-0001c810: 5b22 6164 6122 5d0a 2020 2020 2020 2020  ["ada"].        
-0001c820: 2020 2020 6d6f 6465 6c20 3d20 626f 6f73      model = boos
-0001c830: 7469 6e67 5f6d 6f64 656c 5f64 6566 696e  ting_model_defin
-0001c840: 6974 696f 6e2e 636c 6173 735f 6465 6628  ition.class_def(
-0001c850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c860: 206d 6f64 656c 2c20 6e5f 6573 7469 6d61   model, n_estima
-0001c870: 746f 7273 3d6e 5f65 7374 696d 6174 6f72  tors=n_estimator
-0001c880: 732c 202a 2a62 6f6f 7374 696e 675f 6d6f  s, **boosting_mo
-0001c890: 6465 6c5f 6465 6669 6e69 7469 6f6e 2e61  del_definition.a
-0001c8a0: 7267 730a 2020 2020 2020 2020 2020 2020  rgs.            
-0001c8b0: 290a 0a20 2020 2020 2020 2064 6973 706c  )..        displ
-0001c8c0: 6179 2e6d 6f76 655f 7072 6f67 7265 7373  ay.move_progress
-0001c8d0: 2829 0a0a 2020 2020 2020 2020 7365 6c66  ()..        self
-0001c8e0: 2e6c 6f67 6765 722e 696e 666f 280a 2020  .logger.info(.  
-0001c8f0: 2020 2020 2020 2020 2020 2253 7562 5072            "SubPr
-0001c900: 6f63 6573 7320 6372 6561 7465 5f6d 6f64  ocess create_mod
-0001c910: 656c 2829 2063 616c 6c65 6420 3d3d 3d3d  el() called ====
-0001c920: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001c930: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 220a  ==============".
-0001c940: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001c950: 2020 6d6f 6465 6c2c 206d 6f64 656c 5f66    model, model_f
-0001c960: 6974 5f74 696d 6520 3d20 7365 6c66 2e5f  it_time = self._
-0001c970: 6372 6561 7465 5f6d 6f64 656c 280a 2020  create_model(.  
-0001c980: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-0001c990: 746f 723d 6d6f 6465 6c2c 0a20 2020 2020  tor=model,.     
-0001c9a0: 2020 2020 2020 2073 7973 7465 6d3d 4661         system=Fa
-0001c9b0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-0001c9c0: 2064 6973 706c 6179 3d64 6973 706c 6179   display=display
-0001c9d0: 2c0a 2020 2020 2020 2020 2020 2020 666f  ,.            fo
-0001c9e0: 6c64 3d66 6f6c 642c 0a20 2020 2020 2020  ld=fold,.       
-0001c9f0: 2020 2020 2072 6f75 6e64 3d72 6f75 6e64       round=round
-0001ca00: 2c0a 2020 2020 2020 2020 2020 2020 6669  ,.            fi
-0001ca10: 745f 6b77 6172 6773 3d66 6974 5f6b 7761  t_kwargs=fit_kwa
-0001ca20: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
-0001ca30: 2067 726f 7570 733d 6772 6f75 7073 2c0a   groups=groups,.
-0001ca40: 2020 2020 2020 2020 2020 2020 7072 6f62              prob
-0001ca50: 6162 696c 6974 795f 7468 7265 7368 6f6c  ability_threshol
-0001ca60: 643d 7072 6f62 6162 696c 6974 795f 7468  d=probability_th
-0001ca70: 7265 7368 6f6c 642c 0a20 2020 2020 2020  reshold,.       
-0001ca80: 2020 2020 2072 6574 7572 6e5f 7472 6169       return_trai
-0001ca90: 6e5f 7363 6f72 653d 7265 7475 726e 5f74  n_score=return_t
-0001caa0: 7261 696e 5f73 636f 7265 2c0a 2020 2020  rain_score,.    
-0001cab0: 2020 2020 290a 2020 2020 2020 2020 6265      ).        be
-0001cac0: 7374 5f6d 6f64 656c 203d 206d 6f64 656c  st_model = model
-0001cad0: 0a20 2020 2020 2020 206d 6f64 656c 5f72  .        model_r
-0001cae0: 6573 756c 7473 203d 2073 656c 662e 7075  esults = self.pu
-0001caf0: 6c6c 2829 0a20 2020 2020 2020 2073 656c  ll().        sel
-0001cb00: 662e 6c6f 6767 6572 2e69 6e66 6f28 0a20  f.logger.info(. 
-0001cb10: 2020 2020 2020 2020 2020 2022 5375 6250             "SubP
-0001cb20: 726f 6365 7373 2063 7265 6174 655f 6d6f  rocess create_mo
-0001cb30: 6465 6c28 2920 656e 6420 3d3d 3d3d 3d3d  del() end ======
-0001cb40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001cb50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 220a 2020  ============".  
-0001cb60: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0001cb70: 2023 2065 6e64 2072 756e 7469 6d65 0a20   # end runtime. 
-0001cb80: 2020 2020 2020 2072 756e 7469 6d65 5f65         runtime_e
-0001cb90: 6e64 203d 2074 696d 652e 7469 6d65 2829  nd = time.time()
-0001cba0: 0a20 2020 2020 2020 2072 756e 7469 6d65  .        runtime
-0001cbb0: 203d 206e 702e 6172 7261 7928 7275 6e74   = np.array(runt
-0001cbc0: 696d 655f 656e 6420 2d20 7275 6e74 696d  ime_end - runtim
-0001cbd0: 655f 7374 6172 7429 2e72 6f75 6e64 2832  e_start).round(2
-0001cbe0: 290a 0a20 2020 2020 2020 2023 2064 6173  )..        # das
-0001cbf0: 6862 6f61 7264 206c 6f67 6769 6e67 0a20  hboard logging. 
-0001cc00: 2020 2020 2020 2069 6620 7365 6c66 2e6c         if self.l
-0001cc10: 6f67 6769 6e67 5f70 6172 616d 3a0a 2020  ogging_param:.  
-0001cc20: 2020 2020 2020 2020 2020 696e 6469 6365            indice
-0001cc30: 7320 3d20 7365 6c66 2e5f 6765 745f 7265  s = self._get_re
-0001cc40: 7475 726e 5f74 7261 696e 5f73 636f 7265  turn_train_score
-0001cc50: 5f69 6e64 6963 6573 5f66 6f72 5f6c 6f67  _indices_for_log
-0001cc60: 6769 6e67 280a 2020 2020 2020 2020 2020  ging(.          
-0001cc70: 2020 2020 2020 7265 7475 726e 5f74 7261        return_tra
-0001cc80: 696e 5f73 636f 7265 3d72 6574 7572 6e5f  in_score=return_
-0001cc90: 7472 6169 6e5f 7363 6f72 650a 2020 2020  train_score.    
-0001cca0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001ccb0: 2020 2020 2020 6176 6773 5f64 6963 745f        avgs_dict_
-0001ccc0: 6c6f 6720 3d20 7b6b 3a20 7620 666f 7220  log = {k: v for 
-0001ccd0: 6b2c 2076 2069 6e20 6d6f 6465 6c5f 7265  k, v in model_re
-0001cce0: 7375 6c74 732e 6c6f 635b 696e 6469 6365  sults.loc[indice
-0001ccf0: 735d 2e69 7465 6d73 2829 7d0a 2020 2020  s].items()}.    
-0001cd00: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-0001cd10: 6769 6e67 5f70 6172 616d 2e6c 6f67 5f6d  ging_param.log_m
-0001cd20: 6f64 656c 5f63 6f6d 7061 7269 736f 6e28  odel_comparison(
-0001cd30: 6d6f 6465 6c5f 7265 7375 6c74 732c 2022  model_results, "
-0001cd40: 656e 7365 6d62 6c65 5f6d 6f64 656c 2229  ensemble_model")
-0001cd50: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0001cd60: 6c66 2e5f 6c6f 675f 6d6f 6465 6c28 0a20  lf._log_model(. 
-0001cd70: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0001cd80: 6f64 656c 3d62 6573 745f 6d6f 6465 6c2c  odel=best_model,
-0001cd90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001cda0: 206d 6f64 656c 5f72 6573 756c 7473 3d6d   model_results=m
-0001cdb0: 6f64 656c 5f72 6573 756c 7473 2c0a 2020  odel_results,.  
-0001cdc0: 2020 2020 2020 2020 2020 2020 2020 7363                sc
-0001cdd0: 6f72 655f 6469 6374 3d61 7667 735f 6469  ore_dict=avgs_di
-0001cde0: 6374 5f6c 6f67 2c0a 2020 2020 2020 2020  ct_log,.        
-0001cdf0: 2020 2020 2020 2020 736f 7572 6365 3d22          source="
-0001ce00: 656e 7365 6d62 6c65 5f6d 6f64 656c 222c  ensemble_model",
-0001ce10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ce20: 2072 756e 7469 6d65 3d72 756e 7469 6d65   runtime=runtime
-0001ce30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001ce40: 2020 6d6f 6465 6c5f 6669 745f 7469 6d65    model_fit_time
-0001ce50: 3d6d 6f64 656c 5f66 6974 5f74 696d 652c  =model_fit_time,
-0001ce60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ce70: 2070 6970 656c 696e 653d 7365 6c66 2e70   pipeline=self.p
-0001ce80: 6970 656c 696e 652c 0a20 2020 2020 2020  ipeline,.       
-0001ce90: 2020 2020 2020 2020 206c 6f67 5f70 6c6f           log_plo
-0001cea0: 7473 3d73 656c 662e 6c6f 675f 706c 6f74  ts=self.log_plot
-0001ceb0: 735f 7061 7261 6d2c 0a20 2020 2020 2020  s_param,.       
-0001cec0: 2020 2020 2020 2020 2064 6973 706c 6179           display
-0001ced0: 3d64 6973 706c 6179 2c0a 2020 2020 2020  =display,.      
-0001cee0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0001cef0: 2069 6620 6368 6f6f 7365 5f62 6574 7465   if choose_bette
-0001cf00: 723a 0a20 2020 2020 2020 2020 2020 206e  r:.            n
-0001cf10: 6577 5f6d 6f64 656c 203d 2073 656c 662e  ew_model = self.
-0001cf20: 5f63 686f 6f73 655f 6265 7474 6572 280a  _choose_better(.
-0001cf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cf40: 5b5f 6573 7469 6d61 746f 725f 2c20 2862  [_estimator_, (b
-0001cf50: 6573 745f 6d6f 6465 6c2c 206d 6f64 656c  est_model, model
-0001cf60: 5f72 6573 756c 7473 295d 2c0a 2020 2020  _results)],.    
-0001cf70: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-0001cf80: 6172 655f 6469 6d65 6e73 696f 6e2c 0a20  are_dimension,. 
-0001cf90: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001cfa0: 6f6c 642c 0a20 2020 2020 2020 2020 2020  old,.           
-0001cfb0: 2020 2020 2067 726f 7570 733d 6772 6f75       groups=grou
-0001cfc0: 7073 2c0a 2020 2020 2020 2020 2020 2020  ps,.            
-0001cfd0: 2020 2020 6669 745f 6b77 6172 6773 3d66      fit_kwargs=f
-0001cfe0: 6974 5f6b 7761 7267 732c 0a20 2020 2020  it_kwargs,.     
-0001cff0: 2020 2020 2020 2020 2020 2064 6973 706c             displ
-0001d000: 6179 3d64 6973 706c 6179 2c0a 2020 2020  ay=display,.    
-0001d010: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001d020: 2020 2020 2020 6966 206e 6577 5f6d 6f64        if new_mod
-0001d030: 656c 2069 7320 6e6f 7420 6265 7374 5f6d  el is not best_m
-0001d040: 6f64 656c 3a0a 2020 2020 2020 2020 2020  odel:.          
-0001d050: 2020 2020 2020 6d73 6720 3d20 280a 2020        msg = (.  
-0001d060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d070: 2020 224f 7269 6769 6e61 6c20 6d6f 6465    "Original mode
-0001d080: 6c20 7761 7320 6265 7474 6572 2074 6861  l was better tha
-0001d090: 6e20 7468 6520 656e 7365 6d62 6c65 6420  n the ensembled 
-0001d0a0: 6d6f 6465 6c2c 2068 656e 6365 2069 7420  model, hence it 
-0001d0b0: 7769 6c6c 2062 6520 7265 7475 726e 6564  will be returned
-0001d0c0: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-0001d0d0: 2020 2020 2020 2020 224e 4f54 453a 2054          "NOTE: T
-0001d0e0: 6865 2064 6973 706c 6179 206d 6574 7269  he display metri
-0001d0f0: 6373 2061 7265 2066 6f72 2074 6865 2065  cs are for the e
-0001d100: 6e73 656d 626c 6564 206d 6f64 656c 2028  nsembled model (
-0001d110: 6e6f 7420 7468 6520 6f72 6967 696e 616c  not the original
-0001d120: 206f 6e65 292e 220a 2020 2020 2020 2020   one).".        
-0001d130: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001d140: 2020 2020 2020 2020 2020 6966 2076 6572            if ver
-0001d150: 626f 7365 3a0a 2020 2020 2020 2020 2020  bose:.          
-0001d160: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0001d170: 6d73 6729 0a20 2020 2020 2020 2020 2020  msg).           
-0001d180: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
-0001d190: 2e69 6e66 6f28 6d73 6729 0a20 2020 2020  .info(msg).     
-0001d1a0: 2020 2020 2020 206d 6f64 656c 203d 206e         model = n
-0001d1b0: 6577 5f6d 6f64 656c 0a0a 2020 2020 2020  ew_model..      
-0001d1c0: 2020 6d6f 6465 6c5f 7265 7375 6c74 7320    model_results 
-0001d1d0: 3d20 7365 6c66 2e5f 6869 6768 6c69 6768  = self._highligh
-0001d1e0: 745f 616e 645f 726f 756e 645f 6d6f 6465  t_and_round_mode
-0001d1f0: 6c5f 7265 7375 6c74 7328 0a20 2020 2020  l_results(.     
-0001d200: 2020 2020 2020 206d 6f64 656c 5f72 6573         model_res
-0001d210: 756c 7473 2c20 7265 7475 726e 5f74 7261  ults, return_tra
-0001d220: 696e 5f73 636f 7265 2c20 726f 756e 640a  in_score, round.
-0001d230: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001d240: 2020 6469 7370 6c61 792e 6469 7370 6c61    display.displa
-0001d250: 7928 6d6f 6465 6c5f 7265 7375 6c74 7329  y(model_results)
-0001d260: 0a0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
-0001d270: 6f67 6765 722e 696e 666f 280a 2020 2020  ogger.info(.    
-0001d280: 2020 2020 2020 2020 6622 5f6d 6173 7465          f"_maste
-0001d290: 725f 6d6f 6465 6c5f 636f 6e74 6169 6e65  r_model_containe
-0001d2a0: 723a 207b 6c65 6e28 7365 6c66 2e5f 6d61  r: {len(self._ma
-0001d2b0: 7374 6572 5f6d 6f64 656c 5f63 6f6e 7461  ster_model_conta
-0001d2c0: 696e 6572 297d 220a 2020 2020 2020 2020  iner)}".        
-0001d2d0: 290a 2020 2020 2020 2020 7365 6c66 2e6c  ).        self.l
-0001d2e0: 6f67 6765 722e 696e 666f 2866 225f 6469  ogger.info(f"_di
-0001d2f0: 7370 6c61 795f 636f 6e74 6169 6e65 723a  splay_container:
-0001d300: 207b 6c65 6e28 7365 6c66 2e5f 6469 7370   {len(self._disp
-0001d310: 6c61 795f 636f 6e74 6169 6e65 7229 7d22  lay_container)}"
-0001d320: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-0001d330: 6c6f 6767 6572 2e69 6e66 6f28 7374 7228  logger.info(str(
-0001d340: 6d6f 6465 6c29 290a 2020 2020 2020 2020  model)).        
-0001d350: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
-0001d360: 280a 2020 2020 2020 2020 2020 2020 2265  (.            "e
-0001d370: 6e73 656d 626c 655f 6d6f 6465 6c28 2920  nsemble_model() 
-0001d380: 7375 6363 6573 7366 756c 6c79 2063 6f6d  successfully com
-0001d390: 706c 6574 6564 2e2e 2e2e 2e2e 2e2e 2e2e  pleted..........
-0001d3a0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0001d3b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 220a 2020  ............".  
-0001d3c0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0001d3d0: 2067 632e 636f 6c6c 6563 7428 290a 2020   gc.collect().  
-0001d3e0: 2020 2020 2020 7265 7475 726e 206d 6f64        return mod
-0001d3f0: 656c 0a0a 2020 2020 6465 6620 626c 656e  el..    def blen
-0001d400: 645f 6d6f 6465 6c73 280a 2020 2020 2020  d_models(.      
-0001d410: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0001d420: 6573 7469 6d61 746f 725f 6c69 7374 3a20  estimator_list: 
-0001d430: 6c69 7374 2c0a 2020 2020 2020 2020 666f  list,.        fo
-0001d440: 6c64 3a20 4f70 7469 6f6e 616c 5b55 6e69  ld: Optional[Uni
-0001d450: 6f6e 5b69 6e74 2c20 416e 795d 5d20 3d20  on[int, Any]] = 
-0001d460: 4e6f 6e65 2c0a 2020 2020 2020 2020 726f  None,.        ro
-0001d470: 756e 643a 2069 6e74 203d 2034 2c0a 2020  und: int = 4,.  
-0001d480: 2020 2020 2020 6368 6f6f 7365 5f62 6574        choose_bet
-0001d490: 7465 723a 2062 6f6f 6c20 3d20 4661 6c73  ter: bool = Fals
-0001d4a0: 652c 0a20 2020 2020 2020 206f 7074 696d  e,.        optim
-0001d4b0: 697a 653a 2073 7472 203d 2022 4163 6375  ize: str = "Accu
-0001d4c0: 7261 6379 222c 0a20 2020 2020 2020 206d  racy",.        m
-0001d4d0: 6574 686f 643a 2073 7472 203d 2022 6175  ethod: str = "au
-0001d4e0: 746f 222c 0a20 2020 2020 2020 2077 6569  to",.        wei
-0001d4f0: 6768 7473 3a20 4f70 7469 6f6e 616c 5b4c  ghts: Optional[L
-0001d500: 6973 745b 666c 6f61 745d 5d20 3d20 4e6f  ist[float]] = No
-0001d510: 6e65 2c20 2023 2061 6464 6564 2069 6e20  ne,  # added in 
-0001d520: 7079 6361 7265 743d 3d32 2e32 2e30 0a20  pycaret==2.2.0. 
-0001d530: 2020 2020 2020 2066 6974 5f6b 7761 7267         fit_kwarg
-0001d540: 733a 204f 7074 696f 6e61 6c5b 6469 6374  s: Optional[dict
-0001d550: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-0001d560: 2020 6772 6f75 7073 3a20 4f70 7469 6f6e    groups: Option
-0001d570: 616c 5b55 6e69 6f6e 5b73 7472 2c20 416e  al[Union[str, An
-0001d580: 795d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  y]] = None,.    
-0001d590: 2020 2020 7072 6f62 6162 696c 6974 795f      probability_
-0001d5a0: 7468 7265 7368 6f6c 643a 204f 7074 696f  threshold: Optio
-0001d5b0: 6e61 6c5b 666c 6f61 745d 203d 204e 6f6e  nal[float] = Non
-0001d5c0: 652c 0a20 2020 2020 2020 2076 6572 626f  e,.        verbo
-0001d5d0: 7365 3a20 626f 6f6c 203d 2054 7275 652c  se: bool = True,
-0001d5e0: 0a20 2020 2020 2020 2072 6574 7572 6e5f  .        return_
-0001d5f0: 7472 6169 6e5f 7363 6f72 653a 2062 6f6f  train_score: boo
-0001d600: 6c20 3d20 4661 6c73 652c 0a20 2020 2029  l = False,.    )
-0001d610: 202d 3e20 416e 793a 0a0a 2020 2020 2020   -> Any:..      
-0001d620: 2020 2222 220a 2020 2020 2020 2020 5468    """.        Th
-0001d630: 6973 2066 756e 6374 696f 6e20 6372 6561  is function crea
-0001d640: 7465 7320 6120 536f 6674 2056 6f74 696e  tes a Soft Votin
-0001d650: 6720 2f20 4d61 6a6f 7269 7479 2052 756c  g / Majority Rul
-0001d660: 6520 636c 6173 7369 6669 6572 2066 6f72  e classifier for
-0001d670: 2061 6c6c 2074 6865 0a20 2020 2020 2020   all the.       
-0001d680: 2065 7374 696d 6174 6f72 7320 696e 2074   estimators in t
-0001d690: 6865 206d 6f64 656c 206c 6962 7261 7279  he model library
-0001d6a0: 2028 6578 636c 7564 696e 6720 7468 6520   (excluding the 
-0001d6b0: 6665 7720 7768 656e 2074 7572 626f 2069  few when turbo i
-0001d6c0: 7320 5472 7565 2920 6f72 0a20 2020 2020  s True) or.     
-0001d6d0: 2020 2066 6f72 2073 7065 6369 6669 6320     for specific 
-0001d6e0: 7472 6169 6e65 6420 6573 7469 6d61 746f  trained estimato
-0001d6f0: 7273 2070 6173 7365 6420 6173 2061 206c  rs passed as a l
-0001d700: 6973 7420 696e 2065 7374 696d 6174 6f72  ist in estimator
-0001d710: 5f6c 6973 7420 7061 7261 6d2e 0a20 2020  _list param..   
-0001d720: 2020 2020 2049 7420 7363 6f72 6573 2069       It scores i
-0001d730: 7420 7573 696e 6720 4372 6f73 7320 5661  t using Cross Va
-0001d740: 6c69 6461 7469 6f6e 2e20 5468 6520 6f75  lidation. The ou
-0001d750: 7470 7574 2070 7269 6e74 7320 6120 7363  tput prints a sc
-0001d760: 6f72 650a 2020 2020 2020 2020 6772 6964  ore.        grid
-0001d770: 2074 6861 7420 7368 6f77 7320 4163 6375   that shows Accu
-0001d780: 7261 6379 2c20 4155 432c 2052 6563 616c  racy, AUC, Recal
-0001d790: 6c2c 2050 7265 6369 7369 6f6e 2c20 4631  l, Precision, F1
-0001d7a0: 2c20 4b61 7070 6120 616e 6420 4d43 4320  , Kappa and MCC 
-0001d7b0: 6279 0a20 2020 2020 2020 2066 6f6c 6420  by.        fold 
-0001d7c0: 2864 6566 6175 6c74 2043 5620 3d20 3130  (default CV = 10
-0001d7d0: 2046 6f6c 6473 292e 0a0a 2020 2020 2020   Folds)...      
-0001d7e0: 2020 5468 6973 2066 756e 6374 696f 6e20    This function 
-0001d7f0: 7265 7475 726e 7320 6120 7472 6169 6e65  returns a traine
-0001d800: 6420 6d6f 6465 6c20 6f62 6a65 6374 2e0a  d model object..
-0001d810: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
-0001d820: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001d830: 0a20 2020 2020 2020 203e 3e3e 206c 7220  .        >>> lr 
-0001d840: 3d20 6372 6561 7465 5f6d 6f64 656c 2827  = create_model('
-0001d850: 6c72 2729 0a20 2020 2020 2020 203e 3e3e  lr').        >>>
-0001d860: 2072 6620 3d20 6372 6561 7465 5f6d 6f64   rf = create_mod
-0001d870: 656c 2827 7266 2729 0a20 2020 2020 2020  el('rf').       
-0001d880: 203e 3e3e 206b 6e6e 203d 2063 7265 6174   >>> knn = creat
-0001d890: 655f 6d6f 6465 6c28 276b 6e6e 2729 0a20  e_model('knn'). 
-0001d8a0: 2020 2020 2020 203e 3e3e 2062 6c65 6e64         >>> blend
-0001d8b0: 5f74 6872 6565 203d 2062 6c65 6e64 5f6d  _three = blend_m
-0001d8c0: 6f64 656c 7328 6573 7469 6d61 746f 725f  odels(estimator_
-0001d8d0: 6c69 7374 203d 205b 6c72 2c72 662c 6b6e  list = [lr,rf,kn
-0001d8e0: 6e5d 290a 0a20 2020 2020 2020 2054 6869  n])..        Thi
-0001d8f0: 7320 7769 6c6c 2063 7265 6174 6520 6120  s will create a 
-0001d900: 566f 7469 6e67 436c 6173 7369 6669 6572  VotingClassifier
-0001d910: 206f 6620 6c72 2c20 7266 2061 6e64 206b   of lr, rf and k
-0001d920: 6e6e 2e0a 0a20 2020 2020 2020 2050 6172  nn...        Par
-0001d930: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-0001d940: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0001d950: 2020 2065 7374 696d 6174 6f72 5f6c 6973     estimator_lis
-0001d960: 7420 3a20 6c69 7374 206f 6620 6f62 6a65  t : list of obje
-0001d970: 6374 730a 0a20 2020 2020 2020 2066 6f6c  cts..        fol
-0001d980: 643a 2069 6e74 6567 6572 206f 7220 7363  d: integer or sc
-0001d990: 696b 6974 2d6c 6561 726e 2063 6f6d 7061  ikit-learn compa
-0001d9a0: 7469 626c 6520 4356 2067 656e 6572 6174  tible CV generat
-0001d9b0: 6f72 2c20 6465 6661 756c 7420 3d20 4e6f  or, default = No
-0001d9c0: 6e65 0a20 2020 2020 2020 2020 2020 2043  ne.            C
-0001d9d0: 6f6e 7472 6f6c 7320 6372 6f73 732d 7661  ontrols cross-va
-0001d9e0: 6c69 6461 7469 6f6e 2e20 4966 204e 6f6e  lidation. If Non
-0001d9f0: 652c 2077 696c 6c20 7573 6520 7468 6520  e, will use the 
-0001da00: 4356 2067 656e 6572 6174 6f72 2064 6566  CV generator def
-0001da10: 696e 6564 2069 6e20 7365 7475 7028 292e  ined in setup().
-0001da20: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-0001da30: 696e 7465 6765 722c 2077 696c 6c20 7573  integer, will us
-0001da40: 6520 4b46 6f6c 6420 4356 2077 6974 6820  e KFold CV with 
-0001da50: 7468 6174 206d 616e 7920 666f 6c64 732e  that many folds.
-0001da60: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
-0001da70: 6e20 6372 6f73 735f 7661 6c69 6461 7469  n cross_validati
-0001da80: 6f6e 2069 7320 4661 6c73 652c 2074 6869  on is False, thi
-0001da90: 7320 7061 7261 6d65 7465 7220 6973 2069  s parameter is i
-0001daa0: 676e 6f72 6564 2e0a 0a20 2020 2020 2020  gnored...       
-0001dab0: 2072 6f75 6e64 3a20 696e 7465 6765 722c   round: integer,
-0001dac0: 2064 6566 6175 6c74 203d 2034 0a20 2020   default = 4.   
-0001dad0: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
-0001dae0: 6f66 2064 6563 696d 616c 2070 6c61 6365  of decimal place
-0001daf0: 7320 7468 6520 6d65 7472 6963 7320 696e  s the metrics in
-0001db00: 2074 6865 2073 636f 7265 2067 7269 6420   the score grid 
-0001db10: 7769 6c6c 2062 6520 726f 756e 6465 6420  will be rounded 
-0001db20: 746f 2e0a 0a20 2020 2020 2020 2063 686f  to...        cho
-0001db30: 6f73 655f 6265 7474 6572 3a20 626f 6f6c  ose_better: bool
-0001db40: 2c20 6465 6661 756c 7420 3d20 4661 6c73  , default = Fals
-0001db50: 650a 2020 2020 2020 2020 2020 2020 5768  e.            Wh
-0001db60: 656e 2073 6574 2074 6f20 7365 7420 746f  en set to set to
-0001db70: 2054 7275 652c 2062 6173 6520 6573 7469   True, base esti
-0001db80: 6d61 746f 7220 6973 2072 6574 7572 6e65  mator is returne
-0001db90: 6420 7768 656e 2074 6865 206d 6574 7269  d when the metri
-0001dba0: 6320 646f 6573 6e27 740a 2020 2020 2020  c doesn't.      
-0001dbb0: 2020 2020 2020 696d 7072 6f76 6520 6279        improve by
-0001dbc0: 2065 6e73 656d 626c 655f 6d6f 6465 6c2e   ensemble_model.
-0001dbd0: 2054 6869 7320 6775 6172 616e 7465 6573   This guarantees
-0001dbe0: 2074 6865 2072 6574 7572 6e65 6420 6f62   the returned ob
-0001dbf0: 6a65 6374 2077 6f75 6c64 2070 6572 666f  ject would perfo
-0001dc00: 726d 0a20 2020 2020 2020 2020 2020 2061  rm.            a
-0001dc10: 7420 6c65 6173 7420 6571 7569 7661 6c65  t least equivale
-0001dc20: 6e74 2074 6f20 6261 7365 2065 7374 696d  nt to base estim
-0001dc30: 6174 6f72 2063 7265 6174 6564 2075 7369  ator created usi
-0001dc40: 6e67 2063 7265 6174 655f 6d6f 6465 6c20  ng create_model 
-0001dc50: 6f72 206d 6f64 656c 0a20 2020 2020 2020  or model.       
-0001dc60: 2020 2020 2072 6574 7572 6e65 6420 6279       returned by
-0001dc70: 2063 6f6d 7061 7265 5f6d 6f64 656c 732e   compare_models.
-0001dc80: 0a0a 2020 2020 2020 2020 6f70 7469 6d69  ..        optimi
-0001dc90: 7a65 3a20 7374 722c 2064 6566 6175 6c74  ze: str, default
-0001dca0: 203d 2027 4163 6375 7261 6379 270a 2020   = 'Accuracy'.  
-0001dcb0: 2020 2020 2020 2020 2020 4f6e 6c79 2075            Only u
-0001dcc0: 7365 6420 7768 656e 2063 686f 6f73 655f  sed when choose_
-0001dcd0: 6265 7474 6572 2069 7320 7365 7420 746f  better is set to
-0001dce0: 2054 7275 652e 206f 7074 696d 697a 6520   True. optimize 
-0001dcf0: 7061 7261 6d65 7465 7220 6973 2075 7365  parameter is use
-0001dd00: 640a 2020 2020 2020 2020 2020 2020 746f  d.            to
-0001dd10: 2063 6f6d 7061 7265 2065 6e73 656d 626c   compare ensembl
-0001dd20: 6564 206d 6f64 656c 2077 6974 6820 6261  ed model with ba
-0001dd30: 7365 2065 7374 696d 6174 6f72 2e20 5661  se estimator. Va
-0001dd40: 6c75 6573 2061 6363 6570 7465 6420 696e  lues accepted in
-0001dd50: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
-0001dd60: 696d 697a 6520 7061 7261 6d65 7465 7220  imize parameter 
-0001dd70: 6172 6520 2741 6363 7572 6163 7927 2c20  are 'Accuracy', 
-0001dd80: 2741 5543 272c 2027 5265 6361 6c6c 272c  'AUC', 'Recall',
-0001dd90: 2027 5072 6563 6973 696f 6e27 2c20 2746   'Precision', 'F
-0001dda0: 3127 2c0a 2020 2020 2020 2020 2020 2020  1',.            
-0001ddb0: 274b 6170 7061 272c 2027 4d43 4327 2e0a  'Kappa', 'MCC'..
-0001ddc0: 0a20 2020 2020 2020 206d 6574 686f 643a  .        method:
-0001ddd0: 2073 7472 2c20 6465 6661 756c 7420 3d20   str, default = 
-0001dde0: 2761 7574 6f27 0a20 2020 2020 2020 2020  'auto'.         
-0001ddf0: 2020 2027 6861 7264 2720 7573 6573 2070     'hard' uses p
-0001de00: 7265 6469 6374 6564 2063 6c61 7373 206c  redicted class l
-0001de10: 6162 656c 7320 666f 7220 6d61 6a6f 7269  abels for majori
-0001de20: 7479 2072 756c 6520 766f 7469 6e67 2e20  ty rule voting. 
-0001de30: 2773 6f66 7427 2c20 7072 6564 6963 7473  'soft', predicts
-0001de40: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
-0001de50: 2063 6c61 7373 206c 6162 656c 2062 6173   class label bas
-0001de60: 6564 206f 6e20 7468 6520 6172 676d 6178  ed on the argmax
-0001de70: 206f 6620 7468 6520 7375 6d73 206f 6620   of the sums of 
-0001de80: 7468 6520 7072 6564 6963 7465 6420 7072  the predicted pr
-0001de90: 6f62 6162 696c 6974 6965 732c 0a20 2020  obabilities,.   
-0001dea0: 2020 2020 2020 2020 2077 6869 6368 2069           which i
-0001deb0: 7320 7265 636f 6d6d 656e 6465 6420 666f  s recommended fo
-0001dec0: 7220 616e 2065 6e73 656d 626c 6520 6f66  r an ensemble of
-0001ded0: 2077 656c 6c2d 6361 6c69 6272 6174 6564   well-calibrated
-0001dee0: 2063 6c61 7373 6966 6965 7273 2e20 4465   classifiers. De
-0001def0: 6661 756c 7420 7661 6c75 652c 0a20 2020  fault value,.   
-0001df00: 2020 2020 2020 2020 2027 6175 746f 272c           'auto',
-0001df10: 2077 696c 6c20 7472 7920 746f 2075 7365   will try to use
-0001df20: 2027 736f 6674 2720 616e 6420 6661 6c6c   'soft' and fall
-0001df30: 2062 6163 6b20 746f 2027 6861 7264 2720   back to 'hard' 
-0001df40: 6966 2074 6865 2066 6f72 6d65 7220 6973  if the former is
-0001df50: 206e 6f74 2073 7570 706f 7274 6564 2e0a   not supported..
-0001df60: 0a20 2020 2020 2020 2077 6569 6768 7473  .        weights
-0001df70: 3a20 6c69 7374 2c20 6465 6661 756c 7420  : list, default 
-0001df80: 3d20 4e6f 6e65 0a20 2020 2020 2020 2020  = None.         
-0001df90: 2020 2053 6571 7565 6e63 6520 6f66 2077     Sequence of w
-0001dfa0: 6569 6768 7473 2028 666c 6f61 7420 6f72  eights (float or
-0001dfb0: 2069 6e74 2920 746f 2077 6569 6768 7420   int) to weight 
-0001dfc0: 7468 6520 6f63 6375 7272 656e 6365 7320  the occurrences 
-0001dfd0: 6f66 2070 7265 6469 6374 6564 2063 6c61  of predicted cla
-0001dfe0: 7373 206c 6162 656c 7320 2868 6172 6420  ss labels (hard 
-0001dff0: 766f 7469 6e67 290a 2020 2020 2020 2020  voting).        
-0001e000: 2020 2020 6f72 2063 6c61 7373 2070 726f      or class pro
-0001e010: 6261 6269 6c69 7469 6573 2062 6566 6f72  babilities befor
-0001e020: 6520 6176 6572 6167 696e 6720 2873 6f66  e averaging (sof
-0001e030: 7420 766f 7469 6e67 292e 2055 7365 7320  t voting). Uses 
-0001e040: 756e 6966 6f72 6d20 7765 6967 6874 7320  uniform weights 
-0001e050: 6966 204e 6f6e 652e 0a0a 2020 2020 2020  if None...      
-0001e060: 2020 6669 745f 6b77 6172 6773 3a20 6469    fit_kwargs: di
-0001e070: 6374 2c20 6465 6661 756c 7420 3d20 7b7d  ct, default = {}
-0001e080: 2028 656d 7074 7920 6469 6374 290a 2020   (empty dict).  
-0001e090: 2020 2020 2020 2020 2020 4469 6374 696f            Dictio
-0001e0a0: 6e61 7279 206f 6620 6172 6775 6d65 6e74  nary of argument
-0001e0b0: 7320 7061 7373 6564 2074 6f20 7468 6520  s passed to the 
-0001e0c0: 6669 7420 6d65 7468 6f64 206f 6620 7468  fit method of th
-0001e0d0: 6520 6d6f 6465 6c2e 0a0a 2020 2020 2020  e model...      
-0001e0e0: 2020 6772 6f75 7073 3a20 7374 7220 6f72    groups: str or
-0001e0f0: 2061 7272 6179 2d6c 696b 652c 2077 6974   array-like, wit
-0001e100: 6820 7368 6170 6520 286e 5f73 616d 706c  h shape (n_sampl
-0001e110: 6573 2c29 2c20 6465 6661 756c 7420 3d20  es,), default = 
-0001e120: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-0001e130: 204f 7074 696f 6e61 6c20 4772 6f75 7020   Optional Group 
-0001e140: 6c61 6265 6c73 2066 6f72 2074 6865 2073  labels for the s
-0001e150: 616d 706c 6573 2075 7365 6420 7768 696c  amples used whil
-0001e160: 6520 7370 6c69 7474 696e 6720 7468 6520  e splitting the 
-0001e170: 6461 7461 7365 7420 696e 746f 2074 7261  dataset into tra
-0001e180: 696e 2f74 6573 7420 7365 742e 0a20 2020  in/test set..   
-0001e190: 2020 2020 2020 2020 2049 6620 7374 7269           If stri
-0001e1a0: 6e67 2069 7320 7061 7373 6564 2c20 7769  ng is passed, wi
-0001e1b0: 6c6c 2075 7365 2074 6865 2064 6174 6120  ll use the data 
-0001e1c0: 636f 6c75 6d6e 2077 6974 6820 7468 6174  column with that
-0001e1d0: 206e 616d 6520 6173 2074 6865 2067 726f   name as the gro
-0001e1e0: 7570 732e 0a20 2020 2020 2020 2020 2020  ups..           
-0001e1f0: 204f 6e6c 7920 7573 6564 2069 6620 6120   Only used if a 
-0001e200: 6772 6f75 7020 6261 7365 6420 6372 6f73  group based cros
-0001e210: 732d 7661 6c69 6461 7469 6f6e 2067 656e  s-validation gen
-0001e220: 6572 6174 6f72 2069 7320 7573 6564 2028  erator is used (
-0001e230: 6567 2e20 4772 6f75 704b 466f 6c64 292e  eg. GroupKFold).
-0001e240: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-0001e250: 4e6f 6e65 2c20 7769 6c6c 2075 7365 2074  None, will use t
-0001e260: 6865 2076 616c 7565 2073 6574 2069 6e20  he value set in 
-0001e270: 666f 6c64 5f67 726f 7570 7320 7061 7261  fold_groups para
-0001e280: 6d65 7465 7220 696e 2073 6574 7570 2829  meter in setup()
-0001e290: 2e0a 0a20 2020 2020 2020 2076 6572 626f  ...        verbo
-0001e2a0: 7365 3a20 626f 6f6c 2c20 6465 6661 756c  se: bool, defaul
-0001e2b0: 7420 3d20 5472 7565 0a20 2020 2020 2020  t = True.       
-0001e2c0: 2020 2020 2053 636f 7265 2067 7269 6420       Score grid 
-0001e2d0: 6973 206e 6f74 2070 7269 6e74 6564 2077  is not printed w
-0001e2e0: 6865 6e20 7665 7262 6f73 6520 6973 2073  hen verbose is s
-0001e2f0: 6574 2074 6f20 4661 6c73 652e 0a0a 2020  et to False...  
-0001e300: 2020 2020 2020 7265 7475 726e 5f74 7261        return_tra
-0001e310: 696e 5f73 636f 7265 3a20 626f 6f6c 2c20  in_score: bool, 
-0001e320: 6465 6661 756c 7420 3d20 4661 6c73 650a  default = False.
-0001e330: 2020 2020 2020 2020 2020 2020 4966 2046              If F
-0001e340: 616c 7365 2c20 7265 7475 726e 7320 7468  alse, returns th
-0001e350: 6520 4356 2056 616c 6964 6174 696f 6e20  e CV Validation 
-0001e360: 7363 6f72 6573 206f 6e6c 792e 0a20 2020  scores only..   
-0001e370: 2020 2020 2020 2020 2049 6620 5472 7565           If True
-0001e380: 2c20 7265 7475 726e 7320 7468 6520 4356  , returns the CV
-0001e390: 2074 7261 696e 696e 6720 7363 6f72 6573   training scores
-0001e3a0: 2061 6c6f 6e67 2077 6974 6820 7468 6520   along with the 
-0001e3b0: 4356 2076 616c 6964 6174 696f 6e20 7363  CV validation sc
-0001e3c0: 6f72 6573 2e0a 2020 2020 2020 2020 2020  ores..          
-0001e3d0: 2020 5468 6973 2069 7320 7573 6566 756c    This is useful
-0001e3e0: 2077 6865 6e20 7468 6520 7573 6572 2077   when the user w
-0001e3f0: 616e 7473 2074 6f20 646f 2062 6961 732d  ants to do bias-
-0001e400: 7661 7269 616e 6365 2074 7261 6465 6f66  variance tradeof
-0001e410: 662e 2041 2068 6967 6820 4356 0a20 2020  f. A high CV.   
-0001e420: 2020 2020 2020 2020 2074 7261 696e 696e           trainin
-0001e430: 6720 7363 6f72 6520 7769 7468 2061 206c  g score with a l
-0001e440: 6f77 2063 6f72 7265 7370 6f6e 6469 6e67  ow corresponding
-0001e450: 2043 5620 7661 6c69 6461 7469 6f6e 2073   CV validation s
-0001e460: 636f 7265 2069 6e64 6963 6174 6573 206f  core indicates o
-0001e470: 7665 7266 6974 7469 6e67 2e0a 0a20 2020  verfitting...   
-0001e480: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-0001e490: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-0001e4a0: 2020 2020 2073 636f 7265 5f67 7269 640a       score_grid.
-0001e4b0: 2020 2020 2020 2020 2020 2020 4120 7461              A ta
-0001e4c0: 626c 6520 636f 6e74 6169 6e69 6e67 2074  ble containing t
-0001e4d0: 6865 2073 636f 7265 7320 6f66 2074 6865  he scores of the
-0001e4e0: 206d 6f64 656c 2061 6372 6f73 7320 7468   model across th
-0001e4f0: 6520 6b66 6f6c 6473 2e0a 2020 2020 2020  e kfolds..      
-0001e500: 2020 2020 2020 5363 6f72 696e 6720 6d65        Scoring me
-0001e510: 7472 6963 7320 7573 6564 2061 7265 2041  trics used are A
-0001e520: 6363 7572 6163 792c 2041 5543 2c20 5265  ccuracy, AUC, Re
-0001e530: 6361 6c6c 2c20 5072 6563 6973 696f 6e2c  call, Precision,
-0001e540: 2046 312c 0a20 2020 2020 2020 2020 2020   F1,.           
-0001e550: 204b 6170 7061 2061 6e64 204d 4343 2e20   Kappa and MCC. 
-0001e560: 4d65 616e 2061 6e64 2073 7461 6e64 6172  Mean and standar
-0001e570: 6420 6465 7669 6174 696f 6e20 6f66 2074  d deviation of t
-0001e580: 6865 2073 636f 7265 7320 6163 726f 7373  he scores across
-0001e590: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
-0001e5a0: 2066 6f6c 6473 2061 7265 2061 6c73 6f20   folds are also 
-0001e5b0: 7265 7475 726e 6564 2e0a 0a20 2020 2020  returned...     
-0001e5c0: 2020 206d 6f64 656c 0a20 2020 2020 2020     model.       
-0001e5d0: 2020 2020 2054 7261 696e 6564 2056 6f74       Trained Vot
-0001e5e0: 696e 6720 436c 6173 7369 6669 6572 206d  ing Classifier m
-0001e5f0: 6f64 656c 206f 626a 6563 742e 0a0a 2020  odel object...  
-0001e600: 2020 2020 2020 5761 726e 696e 6773 0a20        Warnings. 
-0001e610: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-0001e620: 2020 2020 2020 2020 2d20 5768 656e 2070          - When p
-0001e630: 6173 7369 6e67 2065 7374 696d 6174 6f72  assing estimator
-0001e640: 5f6c 6973 7420 7769 7468 206d 6574 686f  _list with metho
-0001e650: 6420 7365 7420 746f 2027 736f 6674 272e  d set to 'soft'.
-0001e660: 2041 6c6c 2074 6865 206d 6f64 656c 7320   All the models 
-0001e670: 696e 2074 6865 0a20 2020 2020 2020 2065  in the.        e
-0001e680: 7374 696d 6174 6f72 5f6c 6973 7420 6d75  stimator_list mu
-0001e690: 7374 2073 7570 706f 7274 2070 7265 6469  st support predi
-0001e6a0: 6374 5f70 726f 6261 2066 756e 6374 696f  ct_proba functio
-0001e6b0: 6e2e 2027 7376 6d27 2061 6e64 2027 7269  n. 'svm' and 'ri
-0001e6c0: 6467 6527 2064 6f65 7320 6e6f 740a 2020  dge' does not.  
-0001e6d0: 2020 2020 2020 7375 7070 6f72 7420 7468        support th
-0001e6e0: 6520 7072 6564 6963 745f 7072 6f62 6120  e predict_proba 
-0001e6f0: 616e 6420 6865 6e63 6520 616e 2065 7863  and hence an exc
-0001e700: 6570 7469 6f6e 2077 696c 6c20 6265 2072  eption will be r
-0001e710: 6169 7365 642e 0a0a 2020 2020 2020 2020  aised...        
-0001e720: 2d20 5768 656e 2065 7374 696d 6174 6f72  - When estimator
-0001e730: 5f6c 6973 7420 6973 2073 6574 2074 6f20  _list is set to 
-0001e740: 2741 6c6c 2720 616e 6420 6d65 7468 6f64  'All' and method
-0001e750: 2069 7320 666f 7263 6564 2074 6f20 2773   is forced to 's
-0001e760: 6f66 7427 2c20 6573 7469 6d61 746f 7273  oft', estimators
-0001e770: 0a20 2020 2020 2020 2074 6861 7420 646f  .        that do
-0001e780: 6573 206e 6f74 2073 7570 706f 7274 2074  es not support t
-0001e790: 6865 2070 7265 6469 6374 5f70 726f 6261  he predict_proba
-0001e7a0: 2066 756e 6374 696f 6e20 7769 6c6c 2062   function will b
-0001e7b0: 6520 6472 6f70 7065 6420 6672 6f6d 2074  e dropped from t
-0001e7c0: 6865 2065 7374 696d 6174 6f72 0a20 2020  he estimator.   
-0001e7d0: 2020 2020 206c 6973 742e 0a0a 2020 2020       list...    
-0001e7e0: 2020 2020 2d20 4966 2074 6172 6765 7420      - If target 
-0001e7f0: 7661 7269 6162 6c65 2069 7320 6d75 6c74  variable is mult
-0001e800: 6963 6c61 7373 2028 6d6f 7265 2074 6861  iclass (more tha
-0001e810: 6e20 3220 636c 6173 7365 7329 2c20 4155  n 2 classes), AU
-0001e820: 4320 7769 6c6c 2062 6520 7265 7475 726e  C will be return
-0001e830: 6564 2061 730a 2020 2020 2020 2020 7a65  ed as.        ze
-0001e840: 726f 2028 302e 3029 2e0a 0a0a 0a20 2020  ro (0.0).....   
-0001e850: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001e860: 2073 656c 662e 5f63 6865 636b 5f73 6574   self._check_set
-0001e870: 7570 5f72 616e 2829 0a0a 2020 2020 2020  up_ran()..      
-0001e880: 2020 6675 6e63 7469 6f6e 5f70 6172 616d    function_param
-0001e890: 735f 7374 7220 3d20 222c 2022 2e6a 6f69  s_str = ", ".joi
-0001e8a0: 6e28 5b66 227b 6b7d 3d7b 767d 2220 666f  n([f"{k}={v}" fo
-0001e8b0: 7220 6b2c 2076 2069 6e20 6c6f 6361 6c73  r k, v in locals
-0001e8c0: 2829 2e69 7465 6d73 2829 5d29 0a0a 2020  ().items()])..  
-0001e8d0: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
-0001e8e0: 722e 696e 666f 2822 496e 6974 6961 6c69  r.info("Initiali
-0001e8f0: 7a69 6e67 2062 6c65 6e64 5f6d 6f64 656c  zing blend_model
-0001e900: 7328 2922 290a 2020 2020 2020 2020 7365  s()").        se
-0001e910: 6c66 2e6c 6f67 6765 722e 696e 666f 2866  lf.logger.info(f
-0001e920: 2262 6c65 6e64 5f6d 6f64 656c 7328 7b66  "blend_models({f
-0001e930: 756e 6374 696f 6e5f 7061 7261 6d73 5f73  unction_params_s
-0001e940: 7472 7d29 2229 0a0a 2020 2020 2020 2020  tr})")..        
-0001e950: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
-0001e960: 2822 4368 6563 6b69 6e67 2065 7863 6570  ("Checking excep
-0001e970: 7469 6f6e 7322 290a 0a20 2020 2020 2020  tions")..       
-0001e980: 2023 2072 756e 5f74 696d 650a 2020 2020   # run_time.    
-0001e990: 2020 2020 7275 6e74 696d 655f 7374 6172      runtime_star
-0001e9a0: 7420 3d20 7469 6d65 2e74 696d 6528 290a  t = time.time().
-0001e9b0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-0001e9c0: 6669 745f 6b77 6172 6773 3a0a 2020 2020  fit_kwargs:.    
-0001e9d0: 2020 2020 2020 2020 6669 745f 6b77 6172          fit_kwar
-0001e9e0: 6773 203d 207b 7d0a 0a20 2020 2020 2020  gs = {}..       
-0001e9f0: 2023 2063 6865 636b 696e 6720 6d65 7468   # checking meth
-0001ea00: 6f64 2070 6172 616d 6574 6572 0a20 2020  od parameter.   
-0001ea10: 2020 2020 2061 7661 696c 6162 6c65 5f6d       available_m
-0001ea20: 6574 686f 6420 3d20 5b22 6175 746f 222c  ethod = ["auto",
-0001ea30: 2022 736f 6674 222c 2022 6861 7264 222c   "soft", "hard",
-0001ea40: 2022 6d65 616e 222c 2022 6d65 6469 616e   "mean", "median
-0001ea50: 222c 2022 766f 7469 6e67 225d 0a20 2020  ", "voting"].   
-0001ea60: 2020 2020 2069 6620 6d65 7468 6f64 206e       if method n
-0001ea70: 6f74 2069 6e20 6176 6169 6c61 626c 655f  ot in available_
-0001ea80: 6d65 7468 6f64 3a0a 2020 2020 2020 2020  method:.        
-0001ea90: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0001eaa0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0001eab0: 2020 2020 2020 224d 6574 686f 6420 7061        "Method pa
-0001eac0: 7261 6d65 7465 7220 6f6e 6c79 2061 6363  rameter only acc
-0001ead0: 6570 7473 2027 6175 746f 272c 2027 736f  epts 'auto', 'so
-0001eae0: 6674 272c 2027 6861 7264 272c 2027 6d65  ft', 'hard', 'me
-0001eaf0: 616e 272c 2027 6d65 6469 616e 2720 6f72  an', 'median' or
-0001eb00: 2027 766f 7469 6e67 2720 6173 2061 2070   'voting' as a p
-0001eb10: 6172 616d 6574 6572 2e20 5365 6520 446f  arameter. See Do
-0001eb20: 6373 7472 696e 6720 666f 7220 6465 7461  cstring for deta
-0001eb30: 696c 732e 220a 2020 2020 2020 2020 2020  ils.".          
-0001eb40: 2020 290a 0a20 2020 2020 2020 2023 2063    )..        # c
-0001eb50: 6865 636b 696e 6720 6572 726f 7220 666f  hecking error fo
-0001eb60: 7220 6573 7469 6d61 746f 725f 6c69 7374  r estimator_list
-0001eb70: 2028 736b 6970 2066 6f72 2074 696d 6573   (skip for times
-0001eb80: 6572 6965 7329 0a20 2020 2020 2020 2069  eries).        i
-0001eb90: 6620 6e6f 7420 7365 6c66 2e5f 6d6c 5f75  f not self._ml_u
-0001eba0: 7365 6361 7365 203d 3d20 4d4c 5573 6563  secase == MLUsec
-0001ebb0: 6173 652e 5449 4d45 5f53 4552 4945 533a  ase.TIME_SERIES:
-0001ebc0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-0001ebd0: 2069 2069 6e20 6573 7469 6d61 746f 725f   i in estimator_
-0001ebe0: 6c69 7374 3a0a 2020 2020 2020 2020 2020  list:.          
-0001ebf0: 2020 2020 2020 6966 206e 6f74 2068 6173        if not has
-0001ec00: 6174 7472 2869 2c20 2266 6974 2229 3a0a  attr(i, "fit"):.
-0001ec10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ec20: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0001ec30: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0001ec40: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0001ec50: 4573 7469 6d61 746f 7220 7b69 7d20 646f  Estimator {i} do
-0001ec60: 6573 206e 6f74 2068 6176 6520 7468 6520  es not have the 
-0001ec70: 7265 7175 6972 6564 2066 6974 2829 206d  required fit() m
-0001ec80: 6574 686f 642e 220a 2020 2020 2020 2020  ethod.".        
-0001ec90: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0001eca0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001ecb0: 2073 656c 662e 5f6d 6c5f 7573 6563 6173   self._ml_usecas
-0001ecc0: 6520 3d3d 204d 4c55 7365 6361 7365 2e43  e == MLUsecase.C
-0001ecd0: 4c41 5353 4946 4943 4154 494f 4e3a 0a20  LASSIFICATION:. 
+000181c0: 2020 2073 6561 7263 685f 6b77 6172 6773     search_kwargs
+000181d0: 3d73 6561 7263 685f 6b77 6172 6773 2c0a  =search_kwargs,.
+000181e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000181f0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00018200: 2020 2020 2020 2065 6c69 6620 7365 6172         elif sear
+00018210: 6368 5f6c 6962 7261 7279 203d 3d20 2273  ch_library == "s
+00018220: 6369 6b69 742d 6f70 7469 6d69 7a65 223a  cikit-optimize":
+00018230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018240: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+00018250: 2020 2020 2020 2020 2020 7061 7261 6d5f            param_
+00018260: 6772 6964 203d 2067 6574 5f73 6b6f 7074  grid = get_skopt
+00018270: 5f64 6973 7472 6962 7574 696f 6e73 2870  _distributions(p
+00018280: 6172 616d 5f67 7269 6429 0a20 2020 2020  aram_grid).     
+00018290: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+000182a0: 7420 4578 6365 7074 696f 6e3a 0a20 2020  t Exception:.   
+000182b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000182c0: 2073 656c 662e 6c6f 6767 6572 2e77 6172   self.logger.war
+000182d0: 6e69 6e67 280a 2020 2020 2020 2020 2020  ning(.          
+000182e0: 2020 2020 2020 2020 2020 2020 2020 2243                "C
+000182f0: 6f75 6c64 6e27 7420 636f 6e76 6572 7420  ouldn't convert 
+00018300: 7061 7261 6d5f 6772 6964 2074 6f20 7370  param_grid to sp
+00018310: 6563 6966 6963 206c 6962 7261 7279 2064  ecific library d
+00018320: 6973 7472 6962 7574 696f 6e73 2e20 4578  istributions. Ex
+00018330: 6365 7074 696f 6e3a 220a 2020 2020 2020  ception:".      
+00018340: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00018350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018360: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
+00018370: 7761 726e 696e 6728 7472 6163 6562 6163  warning(tracebac
+00018380: 6b2e 666f 726d 6174 5f65 7863 2829 290a  k.format_exc()).
+00018390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000183a0: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
+000183b0: 6f28 2249 6e69 7469 616c 697a 696e 6720  o("Initializing 
+000183c0: 736b 6f70 742e 4261 7965 7353 6561 7263  skopt.BayesSearc
+000183d0: 6843 5622 290a 2020 2020 2020 2020 2020  hCV").          
+000183e0: 2020 2020 2020 6d6f 6465 6c5f 6772 6964        model_grid
+000183f0: 203d 2073 6b6f 7074 2e42 6179 6573 5365   = skopt.BayesSe
+00018400: 6172 6368 4356 280a 2020 2020 2020 2020  archCV(.        
+00018410: 2020 2020 2020 2020 2020 2020 6573 7469              esti
+00018420: 6d61 746f 723d 7069 7065 6c69 6e65 5f77  mator=pipeline_w
+00018430: 6974 685f 6d6f 6465 6c2c 0a20 2020 2020  ith_model,.     
+00018440: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00018450: 6561 7263 685f 7370 6163 6573 3d70 6172  earch_spaces=par
+00018460: 616d 5f67 7269 642c 0a20 2020 2020 2020  am_grid,.       
+00018470: 2020 2020 2020 2020 2020 2020 2073 636f               sco
+00018480: 7269 6e67 3d6f 7074 696d 697a 652c 0a20  ring=optimize,. 
+00018490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000184a0: 2020 206e 5f69 7465 723d 6e5f 6974 6572     n_iter=n_iter
+000184b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000184c0: 2020 2020 2020 6376 3d66 6f6c 642c 0a20        cv=fold,. 
+000184d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000184e0: 2020 2072 616e 646f 6d5f 7374 6174 653d     random_state=
+000184f0: 7365 6c66 2e73 6565 642c 0a20 2020 2020  self.seed,.     
+00018500: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00018510: 6566 6974 3d46 616c 7365 2c0a 2020 2020  efit=False,.    
+00018520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018530: 6e5f 6a6f 6273 3d6e 5f6a 6f62 732c 0a20  n_jobs=n_jobs,. 
+00018540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018550: 2020 2076 6572 626f 7365 3d74 756e 6572     verbose=tuner
+00018560: 5f76 6572 626f 7365 2c0a 2020 2020 2020  _verbose,.      
+00018570: 2020 2020 2020 2020 2020 2020 2020 2a2a                **
+00018580: 7365 6172 6368 5f6b 7761 7267 732c 0a20  search_kwargs,. 
+00018590: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000185a0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+000185b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000185c0: 2020 2023 206e 6565 6473 2074 6f20 6265     # needs to be
+000185d0: 2069 6d70 6f72 7465 6420 6c69 6b65 2074   imported like t
+000185e0: 6861 7420 666f 7220 7468 6520 6d6f 6e6b  hat for the monk
+000185f0: 6579 7061 7463 680a 2020 2020 2020 2020  eypatch.        
+00018600: 2020 2020 2020 2020 696d 706f 7274 2073          import s
+00018610: 6b6c 6561 726e 2e6d 6f64 656c 5f73 656c  klearn.model_sel
+00018620: 6563 7469 6f6e 2e5f 7365 6172 6368 0a0a  ection._search..
+00018630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018640: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00018650: 2020 2020 2020 2020 2070 6172 616d 5f67           param_g
+00018660: 7269 6420 3d20 6765 745f 6261 7365 5f64  rid = get_base_d
+00018670: 6973 7472 6962 7574 696f 6e73 2870 6172  istributions(par
+00018680: 616d 5f67 7269 6429 0a20 2020 2020 2020  am_grid).       
+00018690: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+000186a0: 4578 6365 7074 696f 6e3a 0a20 2020 2020  Exception:.     
+000186b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000186c0: 656c 662e 6c6f 6767 6572 2e77 6172 6e69  elf.logger.warni
+000186d0: 6e67 280a 2020 2020 2020 2020 2020 2020  ng(.            
+000186e0: 2020 2020 2020 2020 2020 2020 2243 6f75              "Cou
+000186f0: 6c64 6e27 7420 636f 6e76 6572 7420 7061  ldn't convert pa
+00018700: 7261 6d5f 6772 6964 2074 6f20 7370 6563  ram_grid to spec
+00018710: 6966 6963 206c 6962 7261 7279 2064 6973  ific library dis
+00018720: 7472 6962 7574 696f 6e73 2e20 4578 6365  tributions. Exce
+00018730: 7074 696f 6e3a 220a 2020 2020 2020 2020  ption:".        
+00018740: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00018750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018760: 2020 7365 6c66 2e6c 6f67 6765 722e 7761    self.logger.wa
+00018770: 726e 696e 6728 7472 6163 6562 6163 6b2e  rning(traceback.
+00018780: 666f 726d 6174 5f65 7863 2829 290a 0a20  format_exc()).. 
+00018790: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000187a0: 6620 7365 6172 6368 5f61 6c67 6f72 6974  f search_algorit
+000187b0: 686d 203d 3d20 2267 7269 6422 3a0a 2020  hm == "grid":.  
+000187c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000187d0: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
+000187e0: 666f 2822 496e 6974 6961 6c69 7a69 6e67  fo("Initializing
+000187f0: 2047 7269 6453 6561 7263 6843 5622 290a   GridSearchCV").
+00018800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018810: 2020 2020 6d6f 6465 6c5f 6772 6964 203d      model_grid =
+00018820: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
+00018830: 656c 6563 7469 6f6e 2e5f 7365 6172 6368  election._search
+00018840: 2e47 7269 6453 6561 7263 6843 5628 0a20  .GridSearchCV(. 
+00018850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018860: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
+00018870: 3d70 6970 656c 696e 655f 7769 7468 5f6d  =pipeline_with_m
+00018880: 6f64 656c 2c0a 2020 2020 2020 2020 2020  odel,.          
+00018890: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+000188a0: 7261 6d5f 6772 6964 3d70 6172 616d 5f67  ram_grid=param_g
+000188b0: 7269 642c 0a20 2020 2020 2020 2020 2020  rid,.           
+000188c0: 2020 2020 2020 2020 2020 2020 2073 636f               sco
+000188d0: 7269 6e67 3d6f 7074 696d 697a 652c 0a20  ring=optimize,. 
+000188e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000188f0: 2020 2020 2020 2063 763d 666f 6c64 2c0a         cv=fold,.
+00018900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018910: 2020 2020 2020 2020 7265 6669 743d 4661          refit=Fa
+00018920: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00018930: 2020 2020 2020 2020 2020 2020 206e 5f6a               n_j
+00018940: 6f62 733d 6e5f 6a6f 6273 2c0a 2020 2020  obs=n_jobs,.    
+00018950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018960: 2020 2020 7665 7262 6f73 653d 7475 6e65      verbose=tune
+00018970: 725f 7665 7262 6f73 652c 0a20 2020 2020  r_verbose,.     
+00018980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018990: 2020 202a 2a73 6561 7263 685f 6b77 6172     **search_kwar
+000189a0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+000189b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000189c0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+000189d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000189e0: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
+000189f0: 696e 666f 2822 496e 6974 6961 6c69 7a69  info("Initializi
+00018a00: 6e67 2052 616e 646f 6d69 7a65 6453 6561  ng RandomizedSea
+00018a10: 7263 6843 5622 290a 2020 2020 2020 2020  rchCV").        
+00018a20: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+00018a30: 6c5f 6772 6964 203d 2073 6b6c 6561 726e  l_grid = sklearn
+00018a40: 2e6d 6f64 656c 5f73 656c 6563 7469 6f6e  .model_selection
+00018a50: 2e5f 7365 6172 6368 2e52 616e 646f 6d69  ._search.Randomi
+00018a60: 7a65 6453 6561 7263 6843 5628 0a20 2020  zedSearchCV(.   
+00018a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018a80: 2020 2020 2065 7374 696d 6174 6f72 3d70       estimator=p
+00018a90: 6970 656c 696e 655f 7769 7468 5f6d 6f64  ipeline_with_mod
+00018aa0: 656c 2c0a 2020 2020 2020 2020 2020 2020  el,.            
+00018ab0: 2020 2020 2020 2020 2020 2020 7061 7261              para
+00018ac0: 6d5f 6469 7374 7269 6275 7469 6f6e 733d  m_distributions=
+00018ad0: 7061 7261 6d5f 6772 6964 2c0a 2020 2020  param_grid,.    
+00018ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018af0: 2020 2020 7363 6f72 696e 673d 6f70 7469      scoring=opti
+00018b00: 6d69 7a65 2c0a 2020 2020 2020 2020 2020  mize,.          
+00018b10: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
+00018b20: 6974 6572 3d6e 5f69 7465 722c 0a20 2020  iter=n_iter,.   
+00018b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018b40: 2020 2020 2063 763d 666f 6c64 2c0a 2020       cv=fold,.  
+00018b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018b60: 2020 2020 2020 7261 6e64 6f6d 5f73 7461        random_sta
+00018b70: 7465 3d73 656c 662e 7365 6564 2c0a 2020  te=self.seed,.  
+00018b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018b90: 2020 2020 2020 7265 6669 743d 4661 6c73        refit=Fals
+00018ba0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00018bb0: 2020 2020 2020 2020 2020 206e 5f6a 6f62             n_job
+00018bc0: 733d 6e5f 6a6f 6273 2c0a 2020 2020 2020  s=n_jobs,.      
+00018bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018be0: 2020 7665 7262 6f73 653d 7475 6e65 725f    verbose=tuner_
+00018bf0: 7665 7262 6f73 652c 0a20 2020 2020 2020  verbose,.       
+00018c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018c10: 202a 2a73 6561 7263 685f 6b77 6172 6773   **search_kwargs
+00018c20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00018c30: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00018c40: 2020 2020 2069 6620 7365 6172 6368 5f6c       if search_l
+00018c50: 6962 7261 7279 203d 3d20 2273 6369 6b69  ibrary == "sciki
+00018c60: 742d 6c65 6172 6e22 3a0a 2020 2020 2020  t-learn":.      
+00018c70: 2020 2020 2020 2020 2020 2320 6d6f 6e6b            # monk
+00018c80: 6579 2070 6174 6368 696e 6720 746f 2066  ey patching to f
+00018c90: 6978 206f 7665 7266 6c6f 7773 206f 6e20  ix overflows on 
+00018ca0: 5769 6e64 6f77 730a 2020 2020 2020 2020  Windows.        
+00018cb0: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
+00018cc0: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+00018cd0: 2020 2020 2020 2020 2273 6b6c 6561 726e          "sklearn
+00018ce0: 2e6d 6f64 656c 5f73 656c 6563 7469 6f6e  .model_selection
+00018cf0: 2e5f 7365 6172 6368 2e73 616d 706c 655f  ._search.sample_
+00018d00: 7769 7468 6f75 745f 7265 706c 6163 656d  without_replacem
+00018d10: 656e 7422 2c0a 2020 2020 2020 2020 2020  ent",.          
+00018d20: 2020 2020 2020 2020 2020 7079 6361 7265            pycare
+00018d30: 742e 696e 7465 726e 616c 2e70 6174 6368  t.internal.patch
+00018d40: 6573 2e73 6b6c 6561 726e 2e5f 6d70 5f73  es.sklearn._mp_s
+00018d50: 616d 706c 655f 7769 7468 6f75 745f 7265  ample_without_re
+00018d60: 706c 6163 656d 656e 742c 0a20 2020 2020  placement,.     
+00018d70: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
+00018d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018d90: 2020 7769 7468 2070 6174 6368 280a 2020    with patch(.  
+00018da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018db0: 2020 2020 2020 2273 6b6c 6561 726e 2e6d        "sklearn.m
+00018dc0: 6f64 656c 5f73 656c 6563 7469 6f6e 2e5f  odel_selection._
+00018dd0: 7365 6172 6368 2e50 6172 616d 6574 6572  search.Parameter
+00018de0: 4772 6964 2e5f 5f67 6574 6974 656d 5f5f  Grid.__getitem__
+00018df0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00018e00: 2020 2020 2020 2020 2020 2070 7963 6172             pycar
+00018e10: 6574 2e69 6e74 6572 6e61 6c2e 7061 7463  et.internal.patc
+00018e20: 6865 732e 736b 6c65 6172 6e2e 5f6d 705f  hes.sklearn._mp_
+00018e30: 5061 7261 6d65 7465 7247 7269 645f 6765  ParameterGrid_ge
+00018e40: 7469 7465 6d2c 0a20 2020 2020 2020 2020  titem,.         
+00018e50: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
+00018e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018e70: 2020 2020 2020 6d6f 6465 6c5f 6772 6964        model_grid
+00018e80: 2e66 6974 2864 6174 615f 582c 2064 6174  .fit(data_X, dat
+00018e90: 615f 792c 2067 726f 7570 733d 6772 6f75  a_y, groups=grou
+00018ea0: 7073 2c20 2a2a 6669 745f 6b77 6172 6773  ps, **fit_kwargs
+00018eb0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+00018ec0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00018ed0: 2020 2020 6d6f 6465 6c5f 6772 6964 2e66      model_grid.f
+00018ee0: 6974 2864 6174 615f 582c 2064 6174 615f  it(data_X, data_
+00018ef0: 792c 2067 726f 7570 733d 6772 6f75 7073  y, groups=groups
+00018f00: 2c20 2a2a 6669 745f 6b77 6172 6773 290a  , **fit_kwargs).
+00018f10: 2020 2020 2020 2020 2020 2020 6265 7374              best
+00018f20: 5f70 6172 616d 7320 3d20 6d6f 6465 6c5f  _params = model_
+00018f30: 6772 6964 2e62 6573 745f 7061 7261 6d73  grid.best_params
+00018f40: 5f0a 2020 2020 2020 2020 2020 2020 7365  _.            se
+00018f50: 6c66 2e6c 6f67 6765 722e 696e 666f 2866  lf.logger.info(f
+00018f60: 2262 6573 745f 7061 7261 6d73 3a20 7b62  "best_params: {b
+00018f70: 6573 745f 7061 7261 6d73 7d22 290a 2020  est_params}").  
+00018f80: 2020 2020 2020 2020 2020 6265 7374 5f70            best_p
+00018f90: 6172 616d 7320 3d20 7b2a 2a62 6573 745f  arams = {**best_
+00018fa0: 7061 7261 6d73 2c20 2a2a 6578 7472 615f  params, **extra_
+00018fb0: 7061 7261 6d73 7d0a 2020 2020 2020 2020  params}.        
+00018fc0: 2020 2020 6966 2061 6374 7561 6c5f 6573      if actual_es
+00018fd0: 7469 6d61 746f 725f 6c61 6265 6c3a 0a20  timator_label:. 
+00018fe0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00018ff0: 6573 745f 7061 7261 6d73 203d 207b 0a20  est_params = {. 
+00019000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019010: 2020 206b 2e72 6570 6c61 6365 2866 227b     k.replace(f"{
+00019020: 6163 7475 616c 5f65 7374 696d 6174 6f72  actual_estimator
+00019030: 5f6c 6162 656c 7d5f 5f22 2c20 2222 293a  _label}__", ""):
+00019040: 2076 0a20 2020 2020 2020 2020 2020 2020   v.             
+00019050: 2020 2020 2020 2066 6f72 206b 2c20 7620         for k, v 
+00019060: 696e 2062 6573 745f 7061 7261 6d73 2e69  in best_params.i
+00019070: 7465 6d73 2829 0a20 2020 2020 2020 2020  tems().         
+00019080: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00019090: 2020 2020 2063 765f 7265 7375 6c74 7320       cv_results 
+000190a0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2020  = None.         
+000190b0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+000190c0: 2020 2020 2020 2020 6376 5f72 6573 756c          cv_resul
+000190d0: 7473 203d 206d 6f64 656c 5f67 7269 642e  ts = model_grid.
+000190e0: 6376 5f72 6573 756c 7473 5f0a 2020 2020  cv_results_.    
+000190f0: 2020 2020 2020 2020 6578 6365 7074 2045          except E
+00019100: 7863 6570 7469 6f6e 3a0a 2020 2020 2020  xception:.      
+00019110: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+00019120: 6f67 6765 722e 7761 726e 696e 6728 0a20  ogger.warning(. 
+00019130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019140: 2020 2022 436f 756c 646e 2774 2067 6574     "Couldn't get
+00019150: 2063 765f 7265 7375 6c74 7320 6672 6f6d   cv_results from
+00019160: 206d 6f64 656c 5f67 7269 642e 2045 7863   model_grid. Exc
+00019170: 6570 7469 6f6e 3a22 0a20 2020 2020 2020  eption:".       
+00019180: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00019190: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000191a0: 6c6f 6767 6572 2e77 6172 6e69 6e67 2874  logger.warning(t
+000191b0: 7261 6365 6261 636b 2e66 6f72 6d61 745f  raceback.format_
+000191c0: 6578 6328 2929 0a0a 2020 2020 2020 2020  exc())..        
+000191d0: 6469 7370 6c61 792e 6d6f 7665 5f70 726f  display.move_pro
+000191e0: 6772 6573 7328 290a 0a20 2020 2020 2020  gress()..       
+000191f0: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
+00019200: 6f28 2248 7970 6572 7061 7261 6d65 7465  o("Hyperparamete
+00019210: 7220 7365 6172 6368 2063 6f6d 706c 6574  r search complet
+00019220: 6564 2229 0a0a 2020 2020 2020 2020 6966  ed")..        if
+00019230: 2069 7369 6e73 7461 6e63 6528 6d6f 6465   isinstance(mode
+00019240: 6c2c 2054 756e 6162 6c65 4d69 7869 6e29  l, TunableMixin)
+00019250: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00019260: 6c66 2e6c 6f67 6765 722e 696e 666f 2822  lf.logger.info("
+00019270: 4765 7474 696e 6720 6261 7365 2073 6b6c  Getting base skl
+00019280: 6561 726e 206f 626a 6563 7420 6672 6f6d  earn object from
+00019290: 2074 756e 6162 6c65 2229 0a20 2020 2020   tunable").     
+000192a0: 2020 2020 2020 206d 6f64 656c 203d 2063         model = c
+000192b0: 6c6f 6e65 286d 6f64 656c 290a 2020 2020  lone(model).    
+000192c0: 2020 2020 2020 2020 6d6f 6465 6c2e 7365          model.se
+000192d0: 745f 7061 7261 6d73 282a 2a62 6573 745f  t_params(**best_
+000192e0: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
+000192f0: 2020 2020 6265 7374 5f70 6172 616d 7320      best_params 
+00019300: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00019310: 2020 2020 6b3a 2076 0a20 2020 2020 2020      k: v.       
+00019320: 2020 2020 2020 2020 2066 6f72 206b 2c20           for k, 
+00019330: 7620 696e 206d 6f64 656c 2e67 6574 5f70  v in model.get_p
+00019340: 6172 616d 7328 292e 6974 656d 7328 290a  arams().items().
+00019350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019360: 6966 206b 2069 6e20 6d6f 6465 6c2e 6765  if k in model.ge
+00019370: 745f 6261 7365 5f73 6b6c 6561 726e 5f70  t_base_sklearn_p
+00019380: 6172 616d 7328 292e 6b65 7973 2829 0a20  arams().keys(). 
+00019390: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+000193a0: 2020 2020 2020 2020 206d 6f64 656c 203d           model =
+000193b0: 206d 6f64 656c 2e67 6574 5f62 6173 655f   model.get_base_
+000193c0: 736b 6c65 6172 6e5f 6f62 6a65 6374 2829  sklearn_object()
+000193d0: 0a0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+000193e0: 6f67 6765 722e 696e 666f 280a 2020 2020  ogger.info(.    
+000193f0: 2020 2020 2020 2020 2253 7562 5072 6f63          "SubProc
+00019400: 6573 7320 6372 6561 7465 5f6d 6f64 656c  ess create_model
+00019410: 2829 2063 616c 6c65 6420 3d3d 3d3d 3d3d  () called ======
+00019420: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00019430: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 220a 2020  ============".  
+00019440: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00019450: 6265 7374 5f6d 6f64 656c 2c20 6d6f 6465  best_model, mode
+00019460: 6c5f 6669 745f 7469 6d65 203d 2073 656c  l_fit_time = sel
+00019470: 662e 5f63 7265 6174 655f 6d6f 6465 6c28  f._create_model(
+00019480: 0a20 2020 2020 2020 2020 2020 2065 7374  .            est
+00019490: 696d 6174 6f72 3d6d 6f64 656c 2c0a 2020  imator=model,.  
+000194a0: 2020 2020 2020 2020 2020 7379 7374 656d            system
+000194b0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+000194c0: 2020 2020 6469 7370 6c61 793d 6469 7370      display=disp
+000194d0: 6c61 792c 0a20 2020 2020 2020 2020 2020  lay,.           
+000194e0: 2066 6f6c 643d 666f 6c64 2c0a 2020 2020   fold=fold,.    
+000194f0: 2020 2020 2020 2020 726f 756e 643d 726f          round=ro
+00019500: 756e 642c 0a20 2020 2020 2020 2020 2020  und,.           
+00019510: 2067 726f 7570 733d 6772 6f75 7073 2c0a   groups=groups,.
+00019520: 2020 2020 2020 2020 2020 2020 6669 745f              fit_
+00019530: 6b77 6172 6773 3d66 6974 5f6b 7761 7267  kwargs=fit_kwarg
+00019540: 732c 0a20 2020 2020 2020 2020 2020 2072  s,.            r
+00019550: 6574 7572 6e5f 7472 6169 6e5f 7363 6f72  eturn_train_scor
+00019560: 653d 7265 7475 726e 5f74 7261 696e 5f73  e=return_train_s
+00019570: 636f 7265 2c0a 2020 2020 2020 2020 2020  core,.          
+00019580: 2020 2a2a 6265 7374 5f70 6172 616d 732c    **best_params,
+00019590: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+000195a0: 2020 206d 6f64 656c 5f72 6573 756c 7473     model_results
+000195b0: 203d 2073 656c 662e 7075 6c6c 2829 0a20   = self.pull(). 
+000195c0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+000195d0: 6572 2e69 6e66 6f28 0a20 2020 2020 2020  er.info(.       
+000195e0: 2020 2020 2022 5375 6250 726f 6365 7373       "SubProcess
+000195f0: 2063 7265 6174 655f 6d6f 6465 6c28 2920   create_model() 
+00019600: 656e 6420 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  end ============
+00019610: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00019620: 3d3d 3d3d 3d3d 220a 2020 2020 2020 2020  ======".        
+00019630: 290a 0a20 2020 2020 2020 2069 6620 6368  )..        if ch
+00019640: 6f6f 7365 5f62 6574 7465 723a 0a20 2020  oose_better:.   
+00019650: 2020 2020 2020 2020 206e 6577 5f62 6573           new_bes
+00019660: 745f 6d6f 6465 6c20 3d20 7365 6c66 2e5f  t_model = self._
+00019670: 6368 6f6f 7365 5f62 6574 7465 7228 0a20  choose_better(. 
+00019680: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00019690: 6573 7469 6d61 746f 722c 2028 6265 7374  estimator, (best
+000196a0: 5f6d 6f64 656c 2c20 6d6f 6465 6c5f 7265  _model, model_re
+000196b0: 7375 6c74 7329 5d2c 0a20 2020 2020 2020  sults)],.       
+000196c0: 2020 2020 2020 2020 2063 6f6d 7061 7265           compare
+000196d0: 5f64 696d 656e 7369 6f6e 2c0a 2020 2020  _dimension,.    
+000196e0: 2020 2020 2020 2020 2020 2020 666f 6c64              fold
+000196f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00019700: 2020 6772 6f75 7073 3d67 726f 7570 732c    groups=groups,
+00019710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019720: 2066 6974 5f6b 7761 7267 733d 6669 745f   fit_kwargs=fit_
+00019730: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+00019740: 2020 2020 2020 2020 6469 7370 6c61 793d          display=
+00019750: 6469 7370 6c61 792c 0a20 2020 2020 2020  display,.       
+00019760: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00019770: 2020 2069 6620 6e65 775f 6265 7374 5f6d     if new_best_m
+00019780: 6f64 656c 2069 7320 6e6f 7420 6265 7374  odel is not best
+00019790: 5f6d 6f64 656c 3a0a 2020 2020 2020 2020  _model:.        
+000197a0: 2020 2020 2020 2020 6d73 6720 3d20 280a          msg = (.
+000197b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000197c0: 2020 2020 224f 7269 6769 6e61 6c20 6d6f      "Original mo
+000197d0: 6465 6c20 7761 7320 6265 7474 6572 2074  del was better t
+000197e0: 6861 6e20 7468 6520 7475 6e65 6420 6d6f  han the tuned mo
+000197f0: 6465 6c2c 2068 656e 6365 2069 7420 7769  del, hence it wi
+00019800: 6c6c 2062 6520 7265 7475 726e 6564 2e20  ll be returned. 
+00019810: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00019820: 2020 2020 2020 224e 4f54 453a 2054 6865        "NOTE: The
+00019830: 2064 6973 706c 6179 206d 6574 7269 6373   display metrics
+00019840: 2061 7265 2066 6f72 2074 6865 2074 756e   are for the tun
+00019850: 6564 206d 6f64 656c 2028 6e6f 7420 7468  ed model (not th
+00019860: 6520 6f72 6967 696e 616c 206f 6e65 292e  e original one).
+00019870: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00019880: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00019890: 2020 2020 6966 2076 6572 626f 7365 3a0a      if verbose:.
+000198a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000198b0: 2020 2020 7072 696e 7428 6d73 6729 0a20      print(msg). 
+000198c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000198d0: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
+000198e0: 6d73 6729 0a20 2020 2020 2020 2020 2020  msg).           
+000198f0: 2062 6573 745f 6d6f 6465 6c20 3d20 6e65   best_model = ne
+00019900: 775f 6265 7374 5f6d 6f64 656c 0a0a 2020  w_best_model..  
+00019910: 2020 2020 2020 2320 656e 6420 7275 6e74        # end runt
+00019920: 696d 650a 2020 2020 2020 2020 7275 6e74  ime.        runt
+00019930: 696d 655f 656e 6420 3d20 7469 6d65 2e74  ime_end = time.t
+00019940: 696d 6528 290a 2020 2020 2020 2020 7275  ime().        ru
+00019950: 6e74 696d 6520 3d20 6e70 2e61 7272 6179  ntime = np.array
+00019960: 2872 756e 7469 6d65 5f65 6e64 202d 2072  (runtime_end - r
+00019970: 756e 7469 6d65 5f73 7461 7274 292e 726f  untime_start).ro
+00019980: 756e 6428 3229 0a0a 2020 2020 2020 2020  und(2)..        
+00019990: 2320 6461 7368 626f 6172 6420 6c6f 6767  # dashboard logg
+000199a0: 696e 670a 2020 2020 2020 2020 6966 2073  ing.        if s
+000199b0: 656c 662e 6c6f 6767 696e 675f 7061 7261  elf.logging_para
+000199c0: 6d3a 0a20 2020 2020 2020 2020 2020 2069  m:.            i
+000199d0: 6e64 6963 6573 203d 2073 656c 662e 5f67  ndices = self._g
+000199e0: 6574 5f72 6574 7572 6e5f 7472 6169 6e5f  et_return_train_
+000199f0: 7363 6f72 655f 696e 6469 6365 735f 666f  score_indices_fo
+00019a00: 725f 6c6f 6767 696e 6728 0a20 2020 2020  r_logging(.     
+00019a10: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00019a20: 6e5f 7472 6169 6e5f 7363 6f72 653d 7265  n_train_score=re
+00019a30: 7475 726e 5f74 7261 696e 5f73 636f 7265  turn_train_score
+00019a40: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00019a50: 2020 2020 2020 2020 2020 2061 7667 735f             avgs_
+00019a60: 6469 6374 5f6c 6f67 203d 207b 6b3a 2076  dict_log = {k: v
+00019a70: 2066 6f72 206b 2c20 7620 696e 206d 6f64   for k, v in mod
+00019a80: 656c 5f72 6573 756c 7473 2e6c 6f63 5b69  el_results.loc[i
+00019a90: 6e64 6963 6573 5d2e 6974 656d 7328 297d  ndices].items()}
+00019aa0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00019ab0: 662e 6c6f 6767 696e 675f 7061 7261 6d2e  f.logging_param.
+00019ac0: 6c6f 675f 6d6f 6465 6c5f 636f 6d70 6172  log_model_compar
+00019ad0: 6973 6f6e 286d 6f64 656c 5f72 6573 756c  ison(model_resul
+00019ae0: 7473 2c20 2274 756e 655f 6d6f 6465 6c22  ts, "tune_model"
+00019af0: 290a 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00019b00: 656c 662e 5f6c 6f67 5f6d 6f64 656c 280a  elf._log_model(.
+00019b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019b20: 6d6f 6465 6c3d 6265 7374 5f6d 6f64 656c  model=best_model
+00019b30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00019b40: 2020 6d6f 6465 6c5f 7265 7375 6c74 733d    model_results=
+00019b50: 6d6f 6465 6c5f 7265 7375 6c74 732c 0a20  model_results,. 
+00019b60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00019b70: 636f 7265 5f64 6963 743d 6176 6773 5f64  core_dict=avgs_d
+00019b80: 6963 745f 6c6f 672c 0a20 2020 2020 2020  ict_log,.       
+00019b90: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
+00019ba0: 2274 756e 655f 6d6f 6465 6c22 2c0a 2020  "tune_model",.  
+00019bb0: 2020 2020 2020 2020 2020 2020 2020 7275                ru
+00019bc0: 6e74 696d 653d 7275 6e74 696d 652c 0a20  ntime=runtime,. 
+00019bd0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00019be0: 6f64 656c 5f66 6974 5f74 696d 653d 6d6f  odel_fit_time=mo
+00019bf0: 6465 6c5f 6669 745f 7469 6d65 2c0a 2020  del_fit_time,.  
+00019c00: 2020 2020 2020 2020 2020 2020 2020 7069                pi
+00019c10: 7065 6c69 6e65 3d73 656c 662e 7069 7065  peline=self.pipe
+00019c20: 6c69 6e65 2c0a 2020 2020 2020 2020 2020  line,.          
+00019c30: 2020 2020 2020 6c6f 675f 706c 6f74 733d        log_plots=
+00019c40: 7365 6c66 2e6c 6f67 5f70 6c6f 7473 5f70  self.log_plots_p
+00019c50: 6172 616d 2c0a 2020 2020 2020 2020 2020  aram,.          
+00019c60: 2020 2020 2020 7475 6e65 5f63 765f 7265        tune_cv_re
+00019c70: 7375 6c74 733d 6376 5f72 6573 756c 7473  sults=cv_results
+00019c80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00019c90: 2020 6469 7370 6c61 793d 6469 7370 6c61    display=displa
+00019ca0: 792c 0a20 2020 2020 2020 2020 2020 2029  y,.            )
+00019cb0: 0a0a 2020 2020 2020 2020 6d6f 6465 6c5f  ..        model_
+00019cc0: 7265 7375 6c74 7320 3d20 7365 6c66 2e5f  results = self._
+00019cd0: 6869 6768 6c69 6768 745f 616e 645f 726f  highlight_and_ro
+00019ce0: 756e 645f 6d6f 6465 6c5f 7265 7375 6c74  und_model_result
+00019cf0: 7328 0a20 2020 2020 2020 2020 2020 206d  s(.            m
+00019d00: 6f64 656c 5f72 6573 756c 7473 2c20 7265  odel_results, re
+00019d10: 7475 726e 5f74 7261 696e 5f73 636f 7265  turn_train_score
+00019d20: 2c20 726f 756e 640a 2020 2020 2020 2020  , round.        
+00019d30: 290a 2020 2020 2020 2020 6469 7370 6c61  ).        displa
+00019d40: 792e 6469 7370 6c61 7928 6d6f 6465 6c5f  y.display(model_
+00019d50: 7265 7375 6c74 7329 0a0a 2020 2020 2020  results)..      
+00019d60: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
+00019d70: 666f 280a 2020 2020 2020 2020 2020 2020  fo(.            
+00019d80: 6622 5f6d 6173 7465 725f 6d6f 6465 6c5f  f"_master_model_
+00019d90: 636f 6e74 6169 6e65 723a 207b 6c65 6e28  container: {len(
+00019da0: 7365 6c66 2e5f 6d61 7374 6572 5f6d 6f64  self._master_mod
+00019db0: 656c 5f63 6f6e 7461 696e 6572 297d 220a  el_container)}".
+00019dc0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00019dd0: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
+00019de0: 666f 2866 225f 6469 7370 6c61 795f 636f  fo(f"_display_co
+00019df0: 6e74 6169 6e65 723a 207b 6c65 6e28 7365  ntainer: {len(se
+00019e00: 6c66 2e5f 6469 7370 6c61 795f 636f 6e74  lf._display_cont
+00019e10: 6169 6e65 7229 7d22 290a 0a20 2020 2020  ainer)}")..     
+00019e20: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
+00019e30: 6e66 6f28 7374 7228 6265 7374 5f6d 6f64  nfo(str(best_mod
+00019e40: 656c 2929 0a20 2020 2020 2020 2073 656c  el)).        sel
+00019e50: 662e 6c6f 6767 6572 2e69 6e66 6f28 0a20  f.logger.info(. 
+00019e60: 2020 2020 2020 2020 2020 2022 7475 6e65             "tune
+00019e70: 5f6d 6f64 656c 2829 2073 7563 6365 7373  _model() success
+00019e80: 6675 6c6c 7920 636f 6d70 6c65 7465 642e  fully completed.
+00019e90: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00019ea0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00019eb0: 2e2e 2e2e 2e22 0a20 2020 2020 2020 2029  .....".        )
+00019ec0: 0a0a 2020 2020 2020 2020 6763 2e63 6f6c  ..        gc.col
+00019ed0: 6c65 6374 2829 0a20 2020 2020 2020 2069  lect().        i
+00019ee0: 6620 7265 7475 726e 5f74 756e 6572 3a0a  f return_tuner:.
+00019ef0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00019f00: 726e 2028 6265 7374 5f6d 6f64 656c 2c20  rn (best_model, 
+00019f10: 6d6f 6465 6c5f 6772 6964 290a 2020 2020  model_grid).    
+00019f20: 2020 2020 7265 7475 726e 2062 6573 745f      return best_
+00019f30: 6d6f 6465 6c0a 0a20 2020 2064 6566 2065  model..    def e
+00019f40: 6e73 656d 626c 655f 6d6f 6465 6c28 0a20  nsemble_model(. 
+00019f50: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00019f60: 2020 2020 2065 7374 696d 6174 6f72 2c0a       estimator,.
+00019f70: 2020 2020 2020 2020 6d65 7468 6f64 3a20          method: 
+00019f80: 7374 7220 3d20 2242 6167 6769 6e67 222c  str = "Bagging",
+00019f90: 0a20 2020 2020 2020 2066 6f6c 643a 204f  .        fold: O
+00019fa0: 7074 696f 6e61 6c5b 556e 696f 6e5b 696e  ptional[Union[in
+00019fb0: 742c 2041 6e79 5d5d 203d 204e 6f6e 652c  t, Any]] = None,
+00019fc0: 0a20 2020 2020 2020 206e 5f65 7374 696d  .        n_estim
+00019fd0: 6174 6f72 733a 2069 6e74 203d 2031 302c  ators: int = 10,
+00019fe0: 0a20 2020 2020 2020 2072 6f75 6e64 3a20  .        round: 
+00019ff0: 696e 7420 3d20 342c 0a20 2020 2020 2020  int = 4,.       
+0001a000: 2063 686f 6f73 655f 6265 7474 6572 3a20   choose_better: 
+0001a010: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+0001a020: 2020 2020 2020 6f70 7469 6d69 7a65 3a20        optimize: 
+0001a030: 7374 7220 3d20 2241 6363 7572 6163 7922  str = "Accuracy"
+0001a040: 2c0a 2020 2020 2020 2020 6669 745f 6b77  ,.        fit_kw
+0001a050: 6172 6773 3a20 4f70 7469 6f6e 616c 5b64  args: Optional[d
+0001a060: 6963 745d 203d 204e 6f6e 652c 0a20 2020  ict] = None,.   
+0001a070: 2020 2020 2067 726f 7570 733a 204f 7074       groups: Opt
+0001a080: 696f 6e61 6c5b 556e 696f 6e5b 7374 722c  ional[Union[str,
+0001a090: 2041 6e79 5d5d 203d 204e 6f6e 652c 0a20   Any]] = None,. 
+0001a0a0: 2020 2020 2020 2070 726f 6261 6269 6c69         probabili
+0001a0b0: 7479 5f74 6872 6573 686f 6c64 3a20 4f70  ty_threshold: Op
+0001a0c0: 7469 6f6e 616c 5b66 6c6f 6174 5d20 3d20  tional[float] = 
+0001a0d0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7665  None,.        ve
+0001a0e0: 7262 6f73 653a 2062 6f6f 6c20 3d20 5472  rbose: bool = Tr
+0001a0f0: 7565 2c0a 2020 2020 2020 2020 7265 7475  ue,.        retu
+0001a100: 726e 5f74 7261 696e 5f73 636f 7265 3a20  rn_train_score: 
+0001a110: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+0001a120: 2020 2920 2d3e 2041 6e79 3a0a 2020 2020    ) -> Any:.    
+0001a130: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001a140: 5468 6973 2066 756e 6374 696f 6e20 656e  This function en
+0001a150: 7365 6d62 6c65 7320 7468 6520 7472 6169  sembles the trai
+0001a160: 6e65 6420 6261 7365 2065 7374 696d 6174  ned base estimat
+0001a170: 6f72 2075 7369 6e67 2074 6865 206d 6574  or using the met
+0001a180: 686f 6420 6465 6669 6e65 6420 696e 0a20  hod defined in. 
+0001a190: 2020 2020 2020 2027 6d65 7468 6f64 2720         'method' 
+0001a1a0: 7061 7261 6d65 7465 7220 2864 6566 6175  parameter (defau
+0001a1b0: 6c74 203d 2027 4261 6767 696e 6727 292e  lt = 'Bagging').
+0001a1c0: 2054 6865 206f 7574 7075 7420 7072 696e   The output prin
+0001a1d0: 7473 2061 2073 636f 7265 2067 7269 6420  ts a score grid 
+0001a1e0: 7468 6174 2073 686f 7773 0a20 2020 2020  that shows.     
+0001a1f0: 2020 2041 6363 7572 6163 792c 2041 5543     Accuracy, AUC
+0001a200: 2c20 5265 6361 6c6c 2c20 5072 6563 6973  , Recall, Precis
+0001a210: 696f 6e2c 2046 312c 204b 6170 7061 2061  ion, F1, Kappa a
+0001a220: 6e64 204d 4343 2062 7920 666f 6c64 2028  nd MCC by fold (
+0001a230: 6465 6661 756c 7420 3d20 3130 2046 6f6c  default = 10 Fol
+0001a240: 6429 2e0a 0a20 2020 2020 2020 2054 6869  d)...        Thi
+0001a250: 7320 6675 6e63 7469 6f6e 2072 6574 7572  s function retur
+0001a260: 6e73 2061 2074 7261 696e 6564 206d 6f64  ns a trained mod
+0001a270: 656c 206f 626a 6563 742e 0a0a 2020 2020  el object...    
+0001a280: 2020 2020 4d6f 6465 6c20 6d75 7374 2062      Model must b
+0001a290: 6520 6372 6561 7465 6420 7573 696e 6720  e created using 
+0001a2a0: 6372 6561 7465 5f6d 6f64 656c 2829 206f  create_model() o
+0001a2b0: 7220 7475 6e65 5f6d 6f64 656c 2829 2e0a  r tune_model()..
+0001a2c0: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+0001a2d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0001a2e0: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+0001a2f0: 6d20 7079 6361 7265 742e 6461 7461 7365  m pycaret.datase
+0001a300: 7473 2069 6d70 6f72 7420 6765 745f 6461  ts import get_da
+0001a310: 7461 0a20 2020 2020 2020 203e 3e3e 206a  ta.        >>> j
+0001a320: 7569 6365 203d 2067 6574 5f64 6174 6128  uice = get_data(
+0001a330: 276a 7569 6365 2729 0a20 2020 2020 2020  'juice').       
+0001a340: 203e 3e3e 2065 7870 6572 696d 656e 745f   >>> experiment_
+0001a350: 6e61 6d65 203d 2073 6574 7570 2864 6174  name = setup(dat
+0001a360: 6120 3d20 6a75 6963 652c 2020 7461 7267  a = juice,  targ
+0001a370: 6574 203d 2027 5075 7263 6861 7365 2729  et = 'Purchase')
+0001a380: 0a20 2020 2020 2020 203e 3e3e 2064 7420  .        >>> dt 
+0001a390: 3d20 6372 6561 7465 5f6d 6f64 656c 2827  = create_model('
+0001a3a0: 6474 2729 0a20 2020 2020 2020 203e 3e3e  dt').        >>>
+0001a3b0: 2065 6e73 656d 626c 6564 5f64 7420 3d20   ensembled_dt = 
+0001a3c0: 656e 7365 6d62 6c65 5f6d 6f64 656c 2864  ensemble_model(d
+0001a3d0: 7429 0a0a 2020 2020 2020 2020 5468 6973  t)..        This
+0001a3e0: 2077 696c 6c20 7265 7475 726e 2061 6e20   will return an 
+0001a3f0: 656e 7365 6d62 6c65 6420 4465 6369 7369  ensembled Decisi
+0001a400: 6f6e 2054 7265 6520 6d6f 6465 6c20 7573  on Tree model us
+0001a410: 696e 6720 2742 6167 6769 6e67 272e 0a0a  ing 'Bagging'...
+0001a420: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0001a430: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+0001a440: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6573  -----.        es
+0001a450: 7469 6d61 746f 7220 3a20 6f62 6a65 6374  timator : object
+0001a460: 2c20 6465 6661 756c 7420 3d20 4e6f 6e65  , default = None
+0001a470: 0a0a 2020 2020 2020 2020 6d65 7468 6f64  ..        method
+0001a480: 3a20 7374 722c 2064 6566 6175 6c74 203d  : str, default =
+0001a490: 2027 4261 6767 696e 6727 0a20 2020 2020   'Bagging'.     
+0001a4a0: 2020 2020 2020 2042 6167 6769 6e67 206d         Bagging m
+0001a4b0: 6574 686f 6420 7769 6c6c 2063 7265 6174  ethod will creat
+0001a4c0: 6520 616e 2065 6e73 656d 626c 6520 6d65  e an ensemble me
+0001a4d0: 7461 2d65 7374 696d 6174 6f72 2074 6861  ta-estimator tha
+0001a4e0: 7420 6669 7473 2062 6173 650a 2020 2020  t fits base.    
+0001a4f0: 2020 2020 2020 2020 636c 6173 7369 6669          classifi
+0001a500: 6572 7320 6561 6368 206f 6e20 7261 6e64  ers each on rand
+0001a510: 6f6d 2073 7562 7365 7473 206f 6620 7468  om subsets of th
+0001a520: 6520 6f72 6967 696e 616c 2064 6174 6173  e original datas
+0001a530: 6574 2e20 5468 6520 6f74 6865 720a 2020  et. The other.  
+0001a540: 2020 2020 2020 2020 2020 6176 6169 6c61            availa
+0001a550: 626c 6520 6d65 7468 6f64 2069 7320 2742  ble method is 'B
+0001a560: 6f6f 7374 696e 6727 2077 6869 6368 2077  oosting' which w
+0001a570: 696c 6c20 6372 6561 7465 2061 206d 6574  ill create a met
+0001a580: 612d 6573 7469 6d61 746f 7273 2062 790a  a-estimators by.
+0001a590: 2020 2020 2020 2020 2020 2020 6669 7474              fitt
+0001a5a0: 696e 6720 6120 636c 6173 7369 6669 6572  ing a classifier
+0001a5b0: 206f 6e20 7468 6520 6f72 6967 696e 616c   on the original
+0001a5c0: 2064 6174 6173 6574 2061 6e64 2074 6865   dataset and the
+0001a5d0: 6e20 6669 7473 2061 6464 6974 696f 6e61  n fits additiona
+0001a5e0: 6c0a 2020 2020 2020 2020 2020 2020 636f  l.            co
+0001a5f0: 7069 6573 206f 6620 7468 6520 636c 6173  pies of the clas
+0001a600: 7369 6669 6572 206f 6e20 7468 6520 7361  sifier on the sa
+0001a610: 6d65 2064 6174 6173 6574 2062 7574 2077  me dataset but w
+0001a620: 6865 7265 2074 6865 2077 6569 6768 7473  here the weights
+0001a630: 206f 660a 2020 2020 2020 2020 2020 2020   of.            
+0001a640: 696e 636f 7272 6563 746c 7920 636c 6173  incorrectly clas
+0001a650: 7369 6669 6564 2069 6e73 7461 6e63 6573  sified instances
+0001a660: 2061 7265 2061 646a 7573 7465 6420 7375   are adjusted su
+0001a670: 6368 2074 6861 7420 7375 6273 6571 7565  ch that subseque
+0001a680: 6e74 0a20 2020 2020 2020 2020 2020 2063  nt.            c
+0001a690: 6c61 7373 6966 6965 7273 2066 6f63 7573  lassifiers focus
+0001a6a0: 206d 6f72 6520 6f6e 2064 6966 6669 6375   more on difficu
+0001a6b0: 6c74 2063 6173 6573 2e0a 0a20 2020 2020  lt cases...     
+0001a6c0: 2020 2066 6f6c 643a 2069 6e74 6567 6572     fold: integer
+0001a6d0: 206f 7220 7363 696b 6974 2d6c 6561 726e   or scikit-learn
+0001a6e0: 2063 6f6d 7061 7469 626c 6520 4356 2067   compatible CV g
+0001a6f0: 656e 6572 6174 6f72 2c20 6465 6661 756c  enerator, defaul
+0001a700: 7420 3d20 4e6f 6e65 0a20 2020 2020 2020  t = None.       
+0001a710: 2020 2020 2043 6f6e 7472 6f6c 7320 6372       Controls cr
+0001a720: 6f73 732d 7661 6c69 6461 7469 6f6e 2e20  oss-validation. 
+0001a730: 4966 204e 6f6e 652c 2077 696c 6c20 7573  If None, will us
+0001a740: 6520 7468 6520 4356 2067 656e 6572 6174  e the CV generat
+0001a750: 6f72 2064 6566 696e 6564 2069 6e20 7365  or defined in se
+0001a760: 7475 7028 292e 0a20 2020 2020 2020 2020  tup()..         
+0001a770: 2020 2049 6620 696e 7465 6765 722c 2077     If integer, w
+0001a780: 696c 6c20 7573 6520 4b46 6f6c 6420 4356  ill use KFold CV
+0001a790: 2077 6974 6820 7468 6174 206d 616e 7920   with that many 
+0001a7a0: 666f 6c64 732e 0a20 2020 2020 2020 2020  folds..         
+0001a7b0: 2020 2057 6865 6e20 6372 6f73 735f 7661     When cross_va
+0001a7c0: 6c69 6461 7469 6f6e 2069 7320 4661 6c73  lidation is Fals
+0001a7d0: 652c 2074 6869 7320 7061 7261 6d65 7465  e, this paramete
+0001a7e0: 7220 6973 2069 676e 6f72 6564 2e0a 0a20  r is ignored... 
+0001a7f0: 2020 2020 2020 206e 5f65 7374 696d 6174         n_estimat
+0001a800: 6f72 733a 2069 6e74 6567 6572 2c20 6465  ors: integer, de
+0001a810: 6661 756c 7420 3d20 3130 0a20 2020 2020  fault = 10.     
+0001a820: 2020 2020 2020 2054 6865 206e 756d 6265         The numbe
+0001a830: 7220 6f66 2062 6173 6520 6573 7469 6d61  r of base estima
+0001a840: 746f 7273 2069 6e20 7468 6520 656e 7365  tors in the ense
+0001a850: 6d62 6c65 2e0a 2020 2020 2020 2020 2020  mble..          
+0001a860: 2020 496e 2063 6173 6520 6f66 2070 6572    In case of per
+0001a870: 6665 6374 2066 6974 2c20 7468 6520 6c65  fect fit, the le
+0001a880: 6172 6e69 6e67 2070 726f 6365 6475 7265  arning procedure
+0001a890: 2069 7320 7374 6f70 7065 6420 6561 726c   is stopped earl
+0001a8a0: 792e 0a0a 2020 2020 2020 2020 726f 756e  y...        roun
+0001a8b0: 643a 2069 6e74 6567 6572 2c20 6465 6661  d: integer, defa
+0001a8c0: 756c 7420 3d20 340a 2020 2020 2020 2020  ult = 4.        
+0001a8d0: 2020 2020 4e75 6d62 6572 206f 6620 6465      Number of de
+0001a8e0: 6369 6d61 6c20 706c 6163 6573 2074 6865  cimal places the
+0001a8f0: 206d 6574 7269 6373 2069 6e20 7468 6520   metrics in the 
+0001a900: 7363 6f72 6520 6772 6964 2077 696c 6c20  score grid will 
+0001a910: 6265 2072 6f75 6e64 6564 2074 6f2e 0a0a  be rounded to...
+0001a920: 2020 2020 2020 2020 6368 6f6f 7365 5f62          choose_b
+0001a930: 6574 7465 723a 2062 6f6f 6c2c 2064 6566  etter: bool, def
+0001a940: 6175 6c74 203d 2046 616c 7365 0a20 2020  ault = False.   
+0001a950: 2020 2020 2020 2020 2057 6865 6e20 7365           When se
+0001a960: 7420 746f 2073 6574 2074 6f20 5472 7565  t to set to True
+0001a970: 2c20 6261 7365 2065 7374 696d 6174 6f72  , base estimator
+0001a980: 2069 7320 7265 7475 726e 6564 2077 6865   is returned whe
+0001a990: 6e20 7468 6520 6d65 7472 6963 2064 6f65  n the metric doe
+0001a9a0: 736e 2774 0a20 2020 2020 2020 2020 2020  sn't.           
+0001a9b0: 2069 6d70 726f 7665 2062 7920 656e 7365   improve by ense
+0001a9c0: 6d62 6c65 5f6d 6f64 656c 2e20 5468 6973  mble_model. This
+0001a9d0: 2067 7561 7261 6e74 6565 7320 7468 6520   guarantees the 
+0001a9e0: 7265 7475 726e 6564 206f 626a 6563 7420  returned object 
+0001a9f0: 776f 756c 6420 7065 7266 6f72 6d0a 2020  would perform.  
+0001aa00: 2020 2020 2020 2020 2020 6174 206c 6561            at lea
+0001aa10: 7374 2065 7175 6976 616c 656e 7420 746f  st equivalent to
+0001aa20: 2062 6173 6520 6573 7469 6d61 746f 7220   base estimator 
+0001aa30: 6372 6561 7465 6420 7573 696e 6720 6372  created using cr
+0001aa40: 6561 7465 5f6d 6f64 656c 206f 7220 6d6f  eate_model or mo
+0001aa50: 6465 6c0a 2020 2020 2020 2020 2020 2020  del.            
+0001aa60: 7265 7475 726e 6564 2062 7920 636f 6d70  returned by comp
+0001aa70: 6172 655f 6d6f 6465 6c73 2e0a 0a20 2020  are_models...   
+0001aa80: 2020 2020 206f 7074 696d 697a 653a 2073       optimize: s
+0001aa90: 7472 2c20 6465 6661 756c 7420 3d20 2741  tr, default = 'A
+0001aaa0: 6363 7572 6163 7927 0a20 2020 2020 2020  ccuracy'.       
+0001aab0: 2020 2020 204f 6e6c 7920 7573 6564 2077       Only used w
+0001aac0: 6865 6e20 6368 6f6f 7365 5f62 6574 7465  hen choose_bette
+0001aad0: 7220 6973 2073 6574 2074 6f20 5472 7565  r is set to True
+0001aae0: 2e20 6f70 7469 6d69 7a65 2070 6172 616d  . optimize param
+0001aaf0: 6574 6572 2069 7320 7573 6564 0a20 2020  eter is used.   
+0001ab00: 2020 2020 2020 2020 2074 6f20 636f 6d70           to comp
+0001ab10: 6172 6520 656e 7365 6d62 6c65 6420 6d6f  are ensembled mo
+0001ab20: 6465 6c20 7769 7468 2062 6173 6520 6573  del with base es
+0001ab30: 7469 6d61 746f 722e 2056 616c 7565 7320  timator. Values 
+0001ab40: 6163 6365 7074 6564 2069 6e0a 2020 2020  accepted in.    
+0001ab50: 2020 2020 2020 2020 6f70 7469 6d69 7a65          optimize
+0001ab60: 2070 6172 616d 6574 6572 2061 7265 2027   parameter are '
+0001ab70: 4163 6375 7261 6379 272c 2027 4155 4327  Accuracy', 'AUC'
+0001ab80: 2c20 2752 6563 616c 6c27 2c20 2750 7265  , 'Recall', 'Pre
+0001ab90: 6369 7369 6f6e 272c 2027 4631 272c 0a20  cision', 'F1',. 
+0001aba0: 2020 2020 2020 2020 2020 2027 4b61 7070             'Kapp
+0001abb0: 6127 2c20 274d 4343 272e 0a0a 2020 2020  a', 'MCC'...    
+0001abc0: 2020 2020 6669 745f 6b77 6172 6773 3a20      fit_kwargs: 
+0001abd0: 6469 6374 2c20 6465 6661 756c 7420 3d20  dict, default = 
+0001abe0: 7b7d 2028 656d 7074 7920 6469 6374 290a  {} (empty dict).
+0001abf0: 2020 2020 2020 2020 2020 2020 4469 6374              Dict
+0001ac00: 696f 6e61 7279 206f 6620 6172 6775 6d65  ionary of argume
+0001ac10: 6e74 7320 7061 7373 6564 2074 6f20 7468  nts passed to th
+0001ac20: 6520 6669 7420 6d65 7468 6f64 206f 6620  e fit method of 
+0001ac30: 7468 6520 6d6f 6465 6c2e 0a0a 2020 2020  the model...    
+0001ac40: 2020 2020 6772 6f75 7073 3a20 7374 7220      groups: str 
+0001ac50: 6f72 2061 7272 6179 2d6c 696b 652c 2077  or array-like, w
+0001ac60: 6974 6820 7368 6170 6520 286e 5f73 616d  ith shape (n_sam
+0001ac70: 706c 6573 2c29 2c20 6465 6661 756c 7420  ples,), default 
+0001ac80: 3d20 4e6f 6e65 0a20 2020 2020 2020 2020  = None.         
+0001ac90: 2020 204f 7074 696f 6e61 6c20 4772 6f75     Optional Grou
+0001aca0: 7020 6c61 6265 6c73 2066 6f72 2074 6865  p labels for the
+0001acb0: 2073 616d 706c 6573 2075 7365 6420 7768   samples used wh
+0001acc0: 696c 6520 7370 6c69 7474 696e 6720 7468  ile splitting th
+0001acd0: 6520 6461 7461 7365 7420 696e 746f 2074  e dataset into t
+0001ace0: 7261 696e 2f74 6573 7420 7365 742e 0a20  rain/test set.. 
+0001acf0: 2020 2020 2020 2020 2020 2049 6620 7374             If st
+0001ad00: 7269 6e67 2069 7320 7061 7373 6564 2c20  ring is passed, 
+0001ad10: 7769 6c6c 2075 7365 2074 6865 2064 6174  will use the dat
+0001ad20: 6120 636f 6c75 6d6e 2077 6974 6820 7468  a column with th
+0001ad30: 6174 206e 616d 6520 6173 2074 6865 2067  at name as the g
+0001ad40: 726f 7570 732e 0a20 2020 2020 2020 2020  roups..         
+0001ad50: 2020 204f 6e6c 7920 7573 6564 2069 6620     Only used if 
+0001ad60: 6120 6772 6f75 7020 6261 7365 6420 6372  a group based cr
+0001ad70: 6f73 732d 7661 6c69 6461 7469 6f6e 2067  oss-validation g
+0001ad80: 656e 6572 6174 6f72 2069 7320 7573 6564  enerator is used
+0001ad90: 2028 6567 2e20 4772 6f75 704b 466f 6c64   (eg. GroupKFold
+0001ada0: 292e 0a20 2020 2020 2020 2020 2020 2049  )..            I
+0001adb0: 6620 4e6f 6e65 2c20 7769 6c6c 2075 7365  f None, will use
+0001adc0: 2074 6865 2076 616c 7565 2073 6574 2069   the value set i
+0001add0: 6e20 666f 6c64 5f67 726f 7570 7320 7061  n fold_groups pa
+0001ade0: 7261 6d65 7465 7220 696e 2073 6574 7570  rameter in setup
+0001adf0: 2829 2e0a 0a20 2020 2020 2020 2076 6572  ()...        ver
+0001ae00: 626f 7365 3a20 626f 6f6c 2c20 6465 6661  bose: bool, defa
+0001ae10: 756c 7420 3d20 5472 7565 0a20 2020 2020  ult = True.     
+0001ae20: 2020 2020 2020 2053 636f 7265 2067 7269         Score gri
+0001ae30: 6420 6973 206e 6f74 2070 7269 6e74 6564  d is not printed
+0001ae40: 2077 6865 6e20 7665 7262 6f73 6520 6973   when verbose is
+0001ae50: 2073 6574 2074 6f20 4661 6c73 652e 0a0a   set to False...
+0001ae60: 2020 2020 2020 2020 7265 7475 726e 5f74          return_t
+0001ae70: 7261 696e 5f73 636f 7265 3a20 626f 6f6c  rain_score: bool
+0001ae80: 2c20 6465 6661 756c 7420 3d20 4661 6c73  , default = Fals
+0001ae90: 650a 2020 2020 2020 2020 2020 2020 4966  e.            If
+0001aea0: 2046 616c 7365 2c20 7265 7475 726e 7320   False, returns 
+0001aeb0: 7468 6520 4356 2056 616c 6964 6174 696f  the CV Validatio
+0001aec0: 6e20 7363 6f72 6573 206f 6e6c 792e 0a20  n scores only.. 
+0001aed0: 2020 2020 2020 2020 2020 2049 6620 5472             If Tr
+0001aee0: 7565 2c20 7265 7475 726e 7320 7468 6520  ue, returns the 
+0001aef0: 4356 2074 7261 696e 696e 6720 7363 6f72  CV training scor
+0001af00: 6573 2061 6c6f 6e67 2077 6974 6820 7468  es along with th
+0001af10: 6520 4356 2076 616c 6964 6174 696f 6e20  e CV validation 
+0001af20: 7363 6f72 6573 2e0a 2020 2020 2020 2020  scores..        
+0001af30: 2020 2020 5468 6973 2069 7320 7573 6566      This is usef
+0001af40: 756c 2077 6865 6e20 7468 6520 7573 6572  ul when the user
+0001af50: 2077 616e 7473 2074 6f20 646f 2062 6961   wants to do bia
+0001af60: 732d 7661 7269 616e 6365 2074 7261 6465  s-variance trade
+0001af70: 6f66 662e 2041 2068 6967 6820 4356 0a20  off. A high CV. 
+0001af80: 2020 2020 2020 2020 2020 2074 7261 696e             train
+0001af90: 696e 6720 7363 6f72 6520 7769 7468 2061  ing score with a
+0001afa0: 206c 6f77 2063 6f72 7265 7370 6f6e 6469   low correspondi
+0001afb0: 6e67 2043 5620 7661 6c69 6461 7469 6f6e  ng CV validation
+0001afc0: 2073 636f 7265 2069 6e64 6963 6174 6573   score indicates
+0001afd0: 206f 7665 7266 6974 7469 6e67 2e0a 0a20   overfitting... 
+0001afe0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
+0001aff0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+0001b000: 2020 2020 2020 2073 636f 7265 5f67 7269         score_gri
+0001b010: 640a 2020 2020 2020 2020 2020 2020 4120  d.            A 
+0001b020: 7461 626c 6520 636f 6e74 6169 6e69 6e67  table containing
+0001b030: 2074 6865 2073 636f 7265 7320 6f66 2074   the scores of t
+0001b040: 6865 206d 6f64 656c 2061 6372 6f73 7320  he model across 
+0001b050: 7468 6520 6b66 6f6c 6473 2e0a 2020 2020  the kfolds..    
+0001b060: 2020 2020 2020 2020 5363 6f72 696e 6720          Scoring 
+0001b070: 6d65 7472 6963 7320 7573 6564 2061 7265  metrics used are
+0001b080: 2041 6363 7572 6163 792c 2041 5543 2c20   Accuracy, AUC, 
+0001b090: 5265 6361 6c6c 2c20 5072 6563 6973 696f  Recall, Precisio
+0001b0a0: 6e2c 2046 312c 0a20 2020 2020 2020 2020  n, F1,.         
+0001b0b0: 2020 204b 6170 7061 2061 6e64 204d 4343     Kappa and MCC
+0001b0c0: 2e20 4d65 616e 2061 6e64 2073 7461 6e64  . Mean and stand
+0001b0d0: 6172 6420 6465 7669 6174 696f 6e20 6f66  ard deviation of
+0001b0e0: 2074 6865 2073 636f 7265 7320 6163 726f   the scores acro
+0001b0f0: 7373 0a20 2020 2020 2020 2020 2020 2074  ss.            t
+0001b100: 6865 2066 6f6c 6473 2061 7265 2061 6c73  he folds are als
+0001b110: 6f20 7265 7475 726e 6564 2e0a 0a20 2020  o returned...   
+0001b120: 2020 2020 206d 6f64 656c 0a20 2020 2020       model.     
+0001b130: 2020 2020 2020 2054 7261 696e 6564 2065         Trained e
+0001b140: 6e73 656d 626c 6564 206d 6f64 656c 206f  nsembled model o
+0001b150: 626a 6563 742e 0a0a 2020 2020 2020 2020  bject...        
+0001b160: 5761 726e 696e 6773 0a20 2020 2020 2020  Warnings.       
+0001b170: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+0001b180: 2020 2d20 4966 2074 6172 6765 7420 7661    - If target va
+0001b190: 7269 6162 6c65 2069 7320 6d75 6c74 6963  riable is multic
+0001b1a0: 6c61 7373 2028 6d6f 7265 2074 6861 6e20  lass (more than 
+0001b1b0: 3220 636c 6173 7365 7329 2c20 4155 4320  2 classes), AUC 
+0001b1c0: 7769 6c6c 2062 6520 7265 7475 726e 6564  will be returned
+0001b1d0: 0a20 2020 2020 2020 2061 7320 7a65 726f  .        as zero
+0001b1e0: 2028 302e 3029 2e0a 0a0a 2020 2020 2020   (0.0)....      
+0001b1f0: 2020 2222 220a 0a20 2020 2020 2020 2066    """..        f
+0001b200: 756e 6374 696f 6e5f 7061 7261 6d73 5f73  unction_params_s
+0001b210: 7472 203d 2022 2c20 222e 6a6f 696e 285b  tr = ", ".join([
+0001b220: 6622 7b6b 7d3d 7b76 7d22 2066 6f72 206b  f"{k}={v}" for k
+0001b230: 2c20 7620 696e 206c 6f63 616c 7328 292e  , v in locals().
+0001b240: 6974 656d 7328 295d 290a 0a20 2020 2020  items()])..     
+0001b250: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
+0001b260: 6e66 6f28 2249 6e69 7469 616c 697a 696e  nfo("Initializin
+0001b270: 6720 656e 7365 6d62 6c65 5f6d 6f64 656c  g ensemble_model
+0001b280: 2829 2229 0a20 2020 2020 2020 2073 656c  ()").        sel
+0001b290: 662e 6c6f 6767 6572 2e69 6e66 6f28 6622  f.logger.info(f"
+0001b2a0: 656e 7365 6d62 6c65 5f6d 6f64 656c 287b  ensemble_model({
+0001b2b0: 6675 6e63 7469 6f6e 5f70 6172 616d 735f  function_params_
+0001b2c0: 7374 727d 2922 290a 0a20 2020 2020 2020  str})")..       
+0001b2d0: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
+0001b2e0: 6f28 2243 6865 636b 696e 6720 6578 6365  o("Checking exce
+0001b2f0: 7074 696f 6e73 2229 0a0a 2020 2020 2020  ptions")..      
+0001b300: 2020 2320 7275 6e5f 7469 6d65 0a20 2020    # run_time.   
+0001b310: 2020 2020 2072 756e 7469 6d65 5f73 7461       runtime_sta
+0001b320: 7274 203d 2074 696d 652e 7469 6d65 2829  rt = time.time()
+0001b330: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+0001b340: 2066 6974 5f6b 7761 7267 733a 0a20 2020   fit_kwargs:.   
+0001b350: 2020 2020 2020 2020 2066 6974 5f6b 7761           fit_kwa
+0001b360: 7267 7320 3d20 7b7d 0a0a 2020 2020 2020  rgs = {}..      
+0001b370: 2020 2320 4368 6563 6b20 666f 7220 6573    # Check for es
+0001b380: 7469 6d61 746f 720a 2020 2020 2020 2020  timator.        
+0001b390: 6966 206e 6f74 2068 6173 6174 7472 2865  if not hasattr(e
+0001b3a0: 7374 696d 6174 6f72 2c20 2266 6974 2229  stimator, "fit")
+0001b3b0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0001b3c0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+0001b3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b3e0: 6622 4573 7469 6d61 746f 7220 7b65 7374  f"Estimator {est
+0001b3f0: 696d 6174 6f72 7d20 646f 6573 206e 6f74  imator} does not
+0001b400: 2068 6176 6520 7468 6520 7265 7175 6972   have the requir
+0001b410: 6564 2066 6974 2829 206d 6574 686f 642e  ed fit() method.
+0001b420: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+0001b430: 0a20 2020 2020 2020 2023 2043 6865 636b  .        # Check
+0001b440: 2066 6f72 2061 6c6c 6f77 6564 206d 6574   for allowed met
+0001b450: 686f 640a 2020 2020 2020 2020 6176 6169  hod.        avai
+0001b460: 6c61 626c 655f 6d65 7468 6f64 203d 205b  lable_method = [
+0001b470: 2242 6167 6769 6e67 222c 2022 426f 6f73  "Bagging", "Boos
+0001b480: 7469 6e67 225d 0a20 2020 2020 2020 2069  ting"].        i
+0001b490: 6620 6d65 7468 6f64 206e 6f74 2069 6e20  f method not in 
+0001b4a0: 6176 6169 6c61 626c 655f 6d65 7468 6f64  available_method
+0001b4b0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0001b4c0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+0001b4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b4e0: 224d 6574 686f 6420 7061 7261 6d65 7465  "Method paramete
+0001b4f0: 7220 6f6e 6c79 2061 6363 6570 7473 2074  r only accepts t
+0001b500: 776f 2076 616c 7565 7320 2742 6167 6769  wo values 'Baggi
+0001b510: 6e67 2720 6f72 2027 426f 6f73 7469 6e67  ng' or 'Boosting
+0001b520: 272e 220a 2020 2020 2020 2020 2020 2020  '.".            
+0001b530: 290a 0a20 2020 2020 2020 2023 2063 6865  )..        # che
+0001b540: 636b 2062 6f6f 7374 696e 6720 636f 6e66  ck boosting conf
+0001b550: 6c69 6374 0a20 2020 2020 2020 2069 6620  lict.        if 
+0001b560: 6d65 7468 6f64 203d 3d20 2242 6f6f 7374  method == "Boost
+0001b570: 696e 6722 3a0a 2020 2020 2020 2020 2020  ing":.          
+0001b580: 2020 626f 6f73 7469 6e67 5f6d 6f64 656c    boosting_model
+0001b590: 5f64 6566 696e 6974 696f 6e20 3d20 7365  _definition = se
+0001b5a0: 6c66 2e5f 616c 6c5f 6d6f 6465 6c73 5f69  lf._all_models_i
+0001b5b0: 6e74 6572 6e61 6c5b 2261 6461 225d 0a0a  nternal["ada"]..
+0001b5c0: 2020 2020 2020 2020 2020 2020 6368 6563              chec
+0001b5d0: 6b5f 6d6f 6465 6c20 3d20 6573 7469 6d61  k_model = estima
+0001b5e0: 746f 720a 0a20 2020 2020 2020 2020 2020  tor..           
+0001b5f0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0001b600: 2020 2020 2020 6368 6563 6b5f 6d6f 6465        check_mode
+0001b610: 6c20 3d20 626f 6f73 7469 6e67 5f6d 6f64  l = boosting_mod
+0001b620: 656c 5f64 6566 696e 6974 696f 6e2e 636c  el_definition.cl
+0001b630: 6173 735f 6465 6628 0a20 2020 2020 2020  ass_def(.       
+0001b640: 2020 2020 2020 2020 2020 2020 2063 6865               che
+0001b650: 636b 5f6d 6f64 656c 2c0a 2020 2020 2020  ck_model,.      
+0001b660: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
+0001b670: 6573 7469 6d61 746f 7273 3d6e 5f65 7374  estimators=n_est
+0001b680: 696d 6174 6f72 732c 0a20 2020 2020 2020  imators,.       
+0001b690: 2020 2020 2020 2020 2020 2020 202a 2a62               **b
+0001b6a0: 6f6f 7374 696e 675f 6d6f 6465 6c5f 6465  oosting_model_de
+0001b6b0: 6669 6e69 7469 6f6e 2e61 7267 732c 0a20  finition.args,. 
+0001b6c0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001b6d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b6e0: 2077 6974 6820 7265 6469 7265 6374 5f6f   with redirect_o
+0001b6f0: 7574 7075 7428 7365 6c66 2e6c 6f67 6765  utput(self.logge
+0001b700: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+0001b710: 2020 2020 2020 2020 6368 6563 6b5f 6d6f          check_mo
+0001b720: 6465 6c2e 6669 7428 7365 6c66 2e58 5f74  del.fit(self.X_t
+0001b730: 7261 696e 5f74 7261 6e73 666f 726d 6564  rain_transformed
+0001b740: 2c20 7365 6c66 2e79 5f74 7261 696e 5f74  , self.y_train_t
+0001b750: 7261 6e73 666f 726d 6564 290a 2020 2020  ransformed).    
+0001b760: 2020 2020 2020 2020 6578 6365 7074 2045          except E
+0001b770: 7863 6570 7469 6f6e 3a0a 2020 2020 2020  xception:.      
+0001b780: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001b790: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
+0001b7a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001b7b0: 4573 7469 6d61 746f 7220 6e6f 7420 7375  Estimator not su
+0001b7c0: 7070 6f72 7465 6420 666f 7220 7468 6520  pported for the 
+0001b7d0: 426f 6f73 7469 6e67 206d 6574 686f 642e  Boosting method.
+0001b7e0: 2043 6861 6e67 6520 7468 6520 6573 7469   Change the esti
+0001b7f0: 6d61 746f 7220 6f72 206d 6574 686f 6420  mator or method 
+0001b800: 746f 2027 4261 6767 696e 6727 2e22 0a20  to 'Bagging'.". 
+0001b810: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001b820: 0a0a 2020 2020 2020 2020 2320 6368 6563  ..        # chec
+0001b830: 6b69 6e67 2066 6f6c 6420 7061 7261 6d65  king fold parame
+0001b840: 7465 720a 2020 2020 2020 2020 6966 2066  ter.        if f
+0001b850: 6f6c 6420 6973 206e 6f74 204e 6f6e 6520  old is not None 
+0001b860: 616e 6420 6e6f 7420 280a 2020 2020 2020  and not (.      
+0001b870: 2020 2020 2020 7479 7065 2866 6f6c 6429        type(fold)
+0001b880: 2069 7320 696e 7420 6f72 2069 735f 736b   is int or is_sk
+0001b890: 6c65 6172 6e5f 6376 5f67 656e 6572 6174  learn_cv_generat
+0001b8a0: 6f72 2866 6f6c 6429 0a20 2020 2020 2020  or(fold).       
+0001b8b0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+0001b8c0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+0001b8d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b8e0: 2022 666f 6c64 2070 6172 616d 6574 6572   "fold parameter
+0001b8f0: 206d 7573 7420 6265 2065 6974 6865 7220   must be either 
+0001b900: 4e6f 6e65 2c20 616e 2069 6e74 6567 6572  None, an integer
+0001b910: 206f 7220 6120 7363 696b 6974 2d6c 6561   or a scikit-lea
+0001b920: 726e 2063 6f6d 7061 7469 626c 6520 4356  rn compatible CV
+0001b930: 2067 656e 6572 6174 6f72 206f 626a 6563   generator objec
+0001b940: 742e 220a 2020 2020 2020 2020 2020 2020  t.".            
+0001b950: 290a 0a20 2020 2020 2020 2023 2063 6865  )..        # che
+0001b960: 636b 696e 6720 6e5f 6573 7469 6d61 746f  cking n_estimato
+0001b970: 7273 2070 6172 616d 6574 6572 0a20 2020  rs parameter.   
+0001b980: 2020 2020 2069 6620 7479 7065 286e 5f65       if type(n_e
+0001b990: 7374 696d 6174 6f72 7329 2069 7320 6e6f  stimators) is no
+0001b9a0: 7420 696e 743a 0a20 2020 2020 2020 2020  t int:.         
+0001b9b0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+0001b9c0: 6f72 2822 6e5f 6573 7469 6d61 746f 7273  or("n_estimators
+0001b9d0: 2070 6172 616d 6574 6572 206f 6e6c 7920   parameter only 
+0001b9e0: 6163 6365 7074 7320 696e 7465 6765 7220  accepts integer 
+0001b9f0: 7661 6c75 652e 2229 0a0a 2020 2020 2020  value.")..      
+0001ba00: 2020 2320 6368 6563 6b69 6e67 2072 6f75    # checking rou
+0001ba10: 6e64 2070 6172 616d 6574 6572 0a20 2020  nd parameter.   
+0001ba20: 2020 2020 2069 6620 7479 7065 2872 6f75       if type(rou
+0001ba30: 6e64 2920 6973 206e 6f74 2069 6e74 3a0a  nd) is not int:.
+0001ba40: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001ba50: 6520 5479 7065 4572 726f 7228 2252 6f75  e TypeError("Rou
+0001ba60: 6e64 2070 6172 616d 6574 6572 206f 6e6c  nd parameter onl
+0001ba70: 7920 6163 6365 7074 7320 696e 7465 6765  y accepts intege
+0001ba80: 7220 7661 6c75 652e 2229 0a0a 2020 2020  r value.")..    
+0001ba90: 2020 2020 2320 6368 6563 6b69 6e67 2076      # checking v
+0001baa0: 6572 626f 7365 2070 6172 616d 6574 6572  erbose parameter
+0001bab0: 0a20 2020 2020 2020 2069 6620 7479 7065  .        if type
+0001bac0: 2876 6572 626f 7365 2920 6973 206e 6f74  (verbose) is not
+0001bad0: 2062 6f6f 6c3a 0a20 2020 2020 2020 2020   bool:.         
+0001bae0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+0001baf0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0001bb00: 2020 2020 2256 6572 626f 7365 2070 6172      "Verbose par
+0001bb10: 616d 6574 6572 2063 616e 206f 6e6c 7920  ameter can only 
+0001bb20: 7461 6b65 2061 7267 756d 656e 7420 6173  take argument as
+0001bb30: 2054 7275 6520 6f72 2046 616c 7365 2e22   True or False."
+0001bb40: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0001bb50: 2020 2020 2020 2020 2320 6368 6563 6b69          # checki
+0001bb60: 6e67 206f 7074 696d 697a 6520 7061 7261  ng optimize para
+0001bb70: 6d65 7465 720a 2020 2020 2020 2020 6f70  meter.        op
+0001bb80: 7469 6d69 7a65 203d 2073 656c 662e 5f67  timize = self._g
+0001bb90: 6574 5f6d 6574 7269 635f 6279 5f6e 616d  et_metric_by_nam
+0001bba0: 655f 6f72 5f69 6428 6f70 7469 6d69 7a65  e_or_id(optimize
+0001bbb0: 290a 2020 2020 2020 2020 6966 206f 7074  ).        if opt
+0001bbc0: 696d 697a 6520 6973 204e 6f6e 653a 0a20  imize is None:. 
+0001bbd0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0001bbe0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+0001bbf0: 2020 2020 2020 2020 2020 2020 2022 4f70               "Op
+0001bc00: 7469 6d69 7a65 206d 6574 686f 6420 6e6f  timize method no
+0001bc10: 7420 7375 7070 6f72 7465 642e 2053 6565  t supported. See
+0001bc20: 2064 6f63 7374 7269 6e67 2066 6f72 206c   docstring for l
+0001bc30: 6973 7420 6f66 2061 7661 696c 6162 6c65  ist of available
+0001bc40: 2070 6172 616d 6574 6572 732e 220a 2020   parameters.".  
+0001bc50: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0001bc60: 2020 2020 2023 2063 6865 636b 696e 6720       # checking 
+0001bc70: 6f70 7469 6d69 7a65 2070 6172 616d 6574  optimize paramet
+0001bc80: 6572 2066 6f72 206d 756c 7469 636c 6173  er for multiclas
+0001bc90: 730a 2020 2020 2020 2020 6966 2073 656c  s.        if sel
+0001bca0: 662e 6973 5f6d 756c 7469 636c 6173 733a  f.is_multiclass:
+0001bcb0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001bcc0: 6e6f 7420 6f70 7469 6d69 7a65 2e69 735f  not optimize.is_
+0001bcd0: 6d75 6c74 6963 6c61 7373 3a0a 2020 2020  multiclass:.    
+0001bce0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001bcf0: 6520 5479 7065 4572 726f 7228 0a20 2020  e TypeError(.   
+0001bd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bd10: 2022 4f70 7469 6d69 7a61 7469 6f6e 206d   "Optimization m
+0001bd20: 6574 7269 6320 6e6f 7420 7375 7070 6f72  etric not suppor
+0001bd30: 7465 6420 666f 7220 6d75 6c74 6963 6c61  ted for multicla
+0001bd40: 7373 2070 726f 626c 656d 732e 2053 6565  ss problems. See
+0001bd50: 2064 6f63 7374 7269 6e67 2066 6f72 206c   docstring for l
+0001bd60: 6973 7420 6f66 206f 7468 6572 206f 7074  ist of other opt
+0001bd70: 696d 697a 6174 696f 6e20 7061 7261 6d65  imization parame
+0001bd80: 7465 7273 2e22 0a20 2020 2020 2020 2020  ters.".         
+0001bd90: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0001bda0: 2020 2320 6368 6563 6b69 6e67 2072 6574    # checking ret
+0001bdb0: 7572 6e5f 7472 6169 6e5f 7363 6f72 6520  urn_train_score 
+0001bdc0: 7061 7261 6d65 7465 720a 2020 2020 2020  parameter.      
+0001bdd0: 2020 6966 2074 7970 6528 7265 7475 726e    if type(return
+0001bde0: 5f74 7261 696e 5f73 636f 7265 2920 6973  _train_score) is
+0001bdf0: 206e 6f74 2062 6f6f 6c3a 0a20 2020 2020   not bool:.     
+0001be00: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+0001be10: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+0001be20: 2020 2020 2020 2020 2272 6574 7572 6e5f          "return_
+0001be30: 7472 6169 6e5f 7363 6f72 6520 6361 6e20  train_score can 
+0001be40: 6f6e 6c79 2074 616b 6520 6172 6775 6d65  only take argume
+0001be50: 6e74 2061 7320 5472 7565 206f 7220 4661  nt as True or Fa
+0001be60: 6c73 6522 0a20 2020 2020 2020 2020 2020  lse".           
+0001be70: 2029 0a0a 2020 2020 2020 2020 2222 220a   )..        """.
+0001be80: 0a20 2020 2020 2020 2045 5252 4f52 2048  .        ERROR H
+0001be90: 414e 444c 494e 4720 454e 4453 2048 4552  ANDLING ENDS HER
+0001bea0: 450a 0a20 2020 2020 2020 2022 2222 0a0a  E..        """..
+0001beb0: 2020 2020 2020 2020 666f 6c64 203d 2073          fold = s
+0001bec0: 656c 662e 5f67 6574 5f63 765f 7370 6c69  elf._get_cv_spli
+0001bed0: 7474 6572 2866 6f6c 6429 0a0a 2020 2020  tter(fold)..    
+0001bee0: 2020 2020 6772 6f75 7073 203d 2073 656c      groups = sel
+0001bef0: 662e 5f67 6574 5f67 726f 7570 7328 6772  f._get_groups(gr
+0001bf00: 6f75 7073 290a 0a20 2020 2020 2020 2070  oups)..        p
+0001bf10: 726f 6772 6573 735f 6172 6773 203d 207b  rogress_args = {
+0001bf20: 226d 6178 223a 2032 202b 2034 7d0a 2020  "max": 2 + 4}.  
+0001bf30: 2020 2020 2020 7469 6d65 7374 616d 7053        timestampS
+0001bf40: 7472 203d 2064 6174 6574 696d 652e 6461  tr = datetime.da
+0001bf50: 7465 7469 6d65 2e6e 6f77 2829 2e73 7472  tetime.now().str
+0001bf60: 6674 696d 6528 2225 483a 254d 3a25 5322  ftime("%H:%M:%S"
+0001bf70: 290a 2020 2020 2020 2020 6d6f 6e69 746f  ).        monito
+0001bf80: 725f 726f 7773 203d 205b 0a20 2020 2020  r_rows = [.     
+0001bf90: 2020 2020 2020 205b 2249 6e69 7469 6174         ["Initiat
+0001bfa0: 6564 222c 2022 2e20 2e20 2e20 2e20 2e20  ed", ". . . . . 
+0001bfb0: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
+0001bfc0: 2e20 2e20 2e20 2e20 2e22 2c20 7469 6d65  . . . . .", time
+0001bfd0: 7374 616d 7053 7472 5d2c 0a20 2020 2020  stampStr],.     
+0001bfe0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+0001bff0: 2020 2020 2020 2020 2022 5374 6174 7573           "Status
+0001c000: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0001c010: 2020 2022 2e20 2e20 2e20 2e20 2e20 2e20     ". . . . . . 
+0001c020: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
+0001c030: 2e20 2e20 2e20 2e22 2c0a 2020 2020 2020  . . . .",.      
+0001c040: 2020 2020 2020 2020 2020 224c 6f61 6469            "Loadi
+0001c050: 6e67 2044 6570 656e 6465 6e63 6965 7322  ng Dependencies"
+0001c060: 2c0a 2020 2020 2020 2020 2020 2020 5d2c  ,.            ],
+0001c070: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
+0001c080: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001c090: 4573 7469 6d61 746f 7222 2c0a 2020 2020  Estimator",.    
+0001c0a0: 2020 2020 2020 2020 2020 2020 222e 202e              ". .
+0001c0b0: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
+0001c0c0: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
+0001c0d0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0001c0e0: 2020 2022 436f 6d70 696c 696e 6720 4c69     "Compiling Li
+0001c0f0: 6272 6172 7922 2c0a 2020 2020 2020 2020  brary",.        
+0001c100: 2020 2020 5d2c 0a20 2020 2020 2020 205d      ],.        ]
+0001c110: 0a20 2020 2020 2020 2064 6973 706c 6179  .        display
+0001c120: 203d 2043 6f6d 6d6f 6e44 6973 706c 6179   = CommonDisplay
+0001c130: 280a 2020 2020 2020 2020 2020 2020 7665  (.            ve
+0001c140: 7262 6f73 653d 7665 7262 6f73 652c 0a20  rbose=verbose,. 
+0001c150: 2020 2020 2020 2020 2020 2068 746d 6c5f             html_
+0001c160: 7061 7261 6d3d 7365 6c66 2e68 746d 6c5f  param=self.html_
+0001c170: 7061 7261 6d2c 0a20 2020 2020 2020 2020  param,.         
+0001c180: 2020 2070 726f 6772 6573 735f 6172 6773     progress_args
+0001c190: 3d70 726f 6772 6573 735f 6172 6773 2c0a  =progress_args,.
+0001c1a0: 2020 2020 2020 2020 2020 2020 6d6f 6e69              moni
+0001c1b0: 746f 725f 726f 7773 3d6d 6f6e 6974 6f72  tor_rows=monitor
+0001c1c0: 5f72 6f77 732c 0a20 2020 2020 2020 2029  _rows,.        )
+0001c1d0: 0a0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+0001c1e0: 6f67 6765 722e 696e 666f 2822 496d 706f  ogger.info("Impo
+0001c1f0: 7274 696e 6720 6c69 6272 6172 6965 7322  rting libraries"
+0001c200: 290a 0a20 2020 2020 2020 206e 702e 7261  )..        np.ra
+0001c210: 6e64 6f6d 2e73 6565 6428 7365 6c66 2e73  ndom.seed(self.s
+0001c220: 6565 6429 0a0a 2020 2020 2020 2020 7365  eed)..        se
+0001c230: 6c66 2e6c 6f67 6765 722e 696e 666f 2822  lf.logger.info("
+0001c240: 436f 7079 696e 6720 7472 6169 6e69 6e67  Copying training
+0001c250: 2064 6174 6173 6574 2229 0a0a 2020 2020   dataset")..    
+0001c260: 2020 2020 6469 7370 6c61 792e 6d6f 7665      display.move
+0001c270: 5f70 726f 6772 6573 7328 290a 0a20 2020  _progress()..   
+0001c280: 2020 2020 2023 2073 6574 7469 6e67 206f       # setting o
+0001c290: 7074 696d 697a 6520 7061 7261 6d65 7465  ptimize paramete
+0001c2a0: 720a 0a20 2020 2020 2020 2063 6f6d 7061  r..        compa
+0001c2b0: 7265 5f64 696d 656e 7369 6f6e 203d 206f  re_dimension = o
+0001c2c0: 7074 696d 697a 652e 6469 7370 6c61 795f  ptimize.display_
+0001c2d0: 6e61 6d65 0a20 2020 2020 2020 206f 7074  name.        opt
+0001c2e0: 696d 697a 6520 3d20 6f70 7469 6d69 7a65  imize = optimize
+0001c2f0: 2e73 636f 7265 720a 0a20 2020 2020 2020  .scorer..       
+0001c300: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
+0001c310: 6f28 2243 6865 636b 696e 6720 6261 7365  o("Checking base
+0001c320: 206d 6f64 656c 2229 0a0a 2020 2020 2020   model")..      
+0001c330: 2020 5f65 7374 696d 6174 6f72 5f20 3d20    _estimator_ = 
+0001c340: 6573 7469 6d61 746f 720a 0a20 2020 2020  estimator..     
+0001c350: 2020 2065 7374 696d 6174 6f72 5f69 6420     estimator_id 
+0001c360: 3d20 7365 6c66 2e5f 6765 745f 6d6f 6465  = self._get_mode
+0001c370: 6c5f 6964 2865 7374 696d 6174 6f72 290a  l_id(estimator).
+0001c380: 0a20 2020 2020 2020 2069 6620 6573 7469  .        if esti
+0001c390: 6d61 746f 725f 6964 2069 7320 4e6f 6e65  mator_id is None
+0001c3a0: 3a0a 2020 2020 2020 2020 2020 2020 6573  :.            es
+0001c3b0: 7469 6d61 746f 725f 6e61 6d65 203d 2073  timator_name = s
+0001c3c0: 656c 662e 5f67 6574 5f6d 6f64 656c 5f6e  elf._get_model_n
+0001c3d0: 616d 6528 6573 7469 6d61 746f 7229 0a20  ame(estimator). 
+0001c3e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001c3f0: 6c6f 6767 6572 2e69 6e66 6f28 2241 2063  logger.info("A c
+0001c400: 7573 746f 6d20 6d6f 6465 6c20 6861 7320  ustom model has 
+0001c410: 6265 656e 2070 6173 7365 6422 290a 2020  been passed").  
+0001c420: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001c430: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
+0001c440: 725f 6465 6669 6e69 7469 6f6e 203d 2073  r_definition = s
+0001c450: 656c 662e 5f61 6c6c 5f6d 6f64 656c 735f  elf._all_models_
+0001c460: 696e 7465 726e 616c 5b65 7374 696d 6174  internal[estimat
+0001c470: 6f72 5f69 645d 0a20 2020 2020 2020 2020  or_id].         
+0001c480: 2020 2065 7374 696d 6174 6f72 5f6e 616d     estimator_nam
+0001c490: 6520 3d20 6573 7469 6d61 746f 725f 6465  e = estimator_de
+0001c4a0: 6669 6e69 7469 6f6e 2e6e 616d 650a 0a20  finition.name.. 
+0001c4b0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+0001c4c0: 6572 2e69 6e66 6f28 6622 4261 7365 206d  er.info(f"Base m
+0001c4d0: 6f64 656c 203a 207b 6573 7469 6d61 746f  odel : {estimato
+0001c4e0: 725f 6e61 6d65 7d22 290a 0a20 2020 2020  r_name}")..     
+0001c4f0: 2020 2064 6973 706c 6179 2e75 7064 6174     display.updat
+0001c500: 655f 6d6f 6e69 746f 7228 322c 2065 7374  e_monitor(2, est
+0001c510: 696d 6174 6f72 5f6e 616d 6529 0a0a 2020  imator_name)..  
+0001c520: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001c530: 2020 4d4f 4e49 544f 5220 5550 4441 5445    MONITOR UPDATE
+0001c540: 2053 5441 5254 530a 2020 2020 2020 2020   STARTS.        
+0001c550: 2222 220a 0a20 2020 2020 2020 2064 6973  """..        dis
+0001c560: 706c 6179 2e75 7064 6174 655f 6d6f 6e69  play.update_moni
+0001c570: 746f 7228 312c 2022 5365 6c65 6374 696e  tor(1, "Selectin
+0001c580: 6720 4573 7469 6d61 746f 7222 290a 0a20  g Estimator").. 
+0001c590: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001c5a0: 2020 204d 4f4e 4954 4f52 2055 5044 4154     MONITOR UPDAT
+0001c5b0: 4520 454e 4453 0a20 2020 2020 2020 2022  E ENDS.        "
+0001c5c0: 2222 0a0a 2020 2020 2020 2020 6d6f 6465  ""..        mode
+0001c5d0: 6c20 3d20 6765 745f 6573 7469 6d61 746f  l = get_estimato
+0001c5e0: 725f 6672 6f6d 5f6d 6574 615f 6573 7469  r_from_meta_esti
+0001c5f0: 6d61 746f 7228 5f65 7374 696d 6174 6f72  mator(_estimator
+0001c600: 5f29 0a0a 2020 2020 2020 2020 7365 6c66  _)..        self
+0001c610: 2e6c 6f67 6765 722e 696e 666f 2822 496d  .logger.info("Im
+0001c620: 706f 7274 696e 6720 756e 7472 6169 6e65  porting untraine
+0001c630: 6420 656e 7365 6d62 6c65 7222 290a 0a20  d ensembler").. 
+0001c640: 2020 2020 2020 2069 6620 6d65 7468 6f64         if method
+0001c650: 203d 3d20 2242 6167 6769 6e67 223a 0a20   == "Bagging":. 
+0001c660: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001c670: 6c6f 6767 6572 2e69 6e66 6f28 2245 6e73  logger.info("Ens
+0001c680: 656d 626c 6520 6d65 7468 6f64 2073 6574  emble method set
+0001c690: 2074 6f20 4261 6767 696e 6722 290a 2020   to Bagging").  
+0001c6a0: 2020 2020 2020 2020 2020 6261 6767 696e            baggin
+0001c6b0: 675f 6d6f 6465 6c5f 6465 6669 6e69 7469  g_model_definiti
+0001c6c0: 6f6e 203d 2073 656c 662e 5f61 6c6c 5f6d  on = self._all_m
+0001c6d0: 6f64 656c 735f 696e 7465 726e 616c 5b22  odels_internal["
+0001c6e0: 4261 6767 696e 6722 5d0a 0a20 2020 2020  Bagging"]..     
+0001c6f0: 2020 2020 2020 206d 6f64 656c 203d 2062         model = b
+0001c700: 6167 6769 6e67 5f6d 6f64 656c 5f64 6566  agging_model_def
+0001c710: 696e 6974 696f 6e2e 636c 6173 735f 6465  inition.class_de
+0001c720: 6628 0a20 2020 2020 2020 2020 2020 2020  f(.             
+0001c730: 2020 206d 6f64 656c 2c0a 2020 2020 2020     model,.      
+0001c740: 2020 2020 2020 2020 2020 626f 6f74 7374            bootst
+0001c750: 7261 703d 5472 7565 2c0a 2020 2020 2020  rap=True,.      
+0001c760: 2020 2020 2020 2020 2020 6e5f 6573 7469            n_esti
+0001c770: 6d61 746f 7273 3d6e 5f65 7374 696d 6174  mators=n_estimat
+0001c780: 6f72 732c 0a20 2020 2020 2020 2020 2020  ors,.           
+0001c790: 2020 2020 202a 2a62 6167 6769 6e67 5f6d       **bagging_m
+0001c7a0: 6f64 656c 5f64 6566 696e 6974 696f 6e2e  odel_definition.
+0001c7b0: 6172 6773 2c0a 2020 2020 2020 2020 2020  args,.          
+0001c7c0: 2020 290a 0a20 2020 2020 2020 2065 6c73    )..        els
+0001c7d0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+0001c7e0: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
+0001c7f0: 2245 6e73 656d 626c 6520 6d65 7468 6f64  "Ensemble method
+0001c800: 2073 6574 2074 6f20 426f 6f73 7469 6e67   set to Boosting
+0001c810: 2229 0a20 2020 2020 2020 2020 2020 2062  ").            b
+0001c820: 6f6f 7374 696e 675f 6d6f 6465 6c5f 6465  oosting_model_de
+0001c830: 6669 6e69 7469 6f6e 203d 2073 656c 662e  finition = self.
+0001c840: 5f61 6c6c 5f6d 6f64 656c 735f 696e 7465  _all_models_inte
+0001c850: 726e 616c 5b22 6164 6122 5d0a 2020 2020  rnal["ada"].    
+0001c860: 2020 2020 2020 2020 6d6f 6465 6c20 3d20          model = 
+0001c870: 626f 6f73 7469 6e67 5f6d 6f64 656c 5f64  boosting_model_d
+0001c880: 6566 696e 6974 696f 6e2e 636c 6173 735f  efinition.class_
+0001c890: 6465 6628 0a20 2020 2020 2020 2020 2020  def(.           
+0001c8a0: 2020 2020 206d 6f64 656c 2c20 6e5f 6573       model, n_es
+0001c8b0: 7469 6d61 746f 7273 3d6e 5f65 7374 696d  timators=n_estim
+0001c8c0: 6174 6f72 732c 202a 2a62 6f6f 7374 696e  ators, **boostin
+0001c8d0: 675f 6d6f 6465 6c5f 6465 6669 6e69 7469  g_model_definiti
+0001c8e0: 6f6e 2e61 7267 730a 2020 2020 2020 2020  on.args.        
+0001c8f0: 2020 2020 290a 0a20 2020 2020 2020 2064      )..        d
+0001c900: 6973 706c 6179 2e6d 6f76 655f 7072 6f67  isplay.move_prog
+0001c910: 7265 7373 2829 0a0a 2020 2020 2020 2020  ress()..        
+0001c920: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
+0001c930: 280a 2020 2020 2020 2020 2020 2020 2253  (.            "S
+0001c940: 7562 5072 6f63 6573 7320 6372 6561 7465  ubProcess create
+0001c950: 5f6d 6f64 656c 2829 2063 616c 6c65 6420  _model() called 
+0001c960: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001c970: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001c980: 3d3d 220a 2020 2020 2020 2020 290a 2020  ==".        ).  
+0001c990: 2020 2020 2020 6d6f 6465 6c2c 206d 6f64        model, mod
+0001c9a0: 656c 5f66 6974 5f74 696d 6520 3d20 7365  el_fit_time = se
+0001c9b0: 6c66 2e5f 6372 6561 7465 5f6d 6f64 656c  lf._create_model
+0001c9c0: 280a 2020 2020 2020 2020 2020 2020 6573  (.            es
+0001c9d0: 7469 6d61 746f 723d 6d6f 6465 6c2c 0a20  timator=model,. 
+0001c9e0: 2020 2020 2020 2020 2020 2073 7973 7465             syste
+0001c9f0: 6d3d 4661 6c73 652c 0a20 2020 2020 2020  m=False,.       
+0001ca00: 2020 2020 2064 6973 706c 6179 3d64 6973       display=dis
+0001ca10: 706c 6179 2c0a 2020 2020 2020 2020 2020  play,.          
+0001ca20: 2020 666f 6c64 3d66 6f6c 642c 0a20 2020    fold=fold,.   
+0001ca30: 2020 2020 2020 2020 2072 6f75 6e64 3d72           round=r
+0001ca40: 6f75 6e64 2c0a 2020 2020 2020 2020 2020  ound,.          
+0001ca50: 2020 6669 745f 6b77 6172 6773 3d66 6974    fit_kwargs=fit
+0001ca60: 5f6b 7761 7267 732c 0a20 2020 2020 2020  _kwargs,.       
+0001ca70: 2020 2020 2067 726f 7570 733d 6772 6f75       groups=grou
+0001ca80: 7073 2c0a 2020 2020 2020 2020 2020 2020  ps,.            
+0001ca90: 7072 6f62 6162 696c 6974 795f 7468 7265  probability_thre
+0001caa0: 7368 6f6c 643d 7072 6f62 6162 696c 6974  shold=probabilit
+0001cab0: 795f 7468 7265 7368 6f6c 642c 0a20 2020  y_threshold,.   
+0001cac0: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
+0001cad0: 7472 6169 6e5f 7363 6f72 653d 7265 7475  train_score=retu
+0001cae0: 726e 5f74 7261 696e 5f73 636f 7265 2c0a  rn_train_score,.
+0001caf0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001cb00: 2020 6265 7374 5f6d 6f64 656c 203d 206d    best_model = m
+0001cb10: 6f64 656c 0a20 2020 2020 2020 206d 6f64  odel.        mod
+0001cb20: 656c 5f72 6573 756c 7473 203d 2073 656c  el_results = sel
+0001cb30: 662e 7075 6c6c 2829 0a20 2020 2020 2020  f.pull().       
+0001cb40: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
+0001cb50: 6f28 0a20 2020 2020 2020 2020 2020 2022  o(.            "
+0001cb60: 5375 6250 726f 6365 7373 2063 7265 6174  SubProcess creat
+0001cb70: 655f 6d6f 6465 6c28 2920 656e 6420 3d3d  e_model() end ==
+0001cb80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001cb90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001cba0: 220a 2020 2020 2020 2020 290a 0a20 2020  ".        )..   
+0001cbb0: 2020 2020 2023 2065 6e64 2072 756e 7469       # end runti
+0001cbc0: 6d65 0a20 2020 2020 2020 2072 756e 7469  me.        runti
+0001cbd0: 6d65 5f65 6e64 203d 2074 696d 652e 7469  me_end = time.ti
+0001cbe0: 6d65 2829 0a20 2020 2020 2020 2072 756e  me().        run
+0001cbf0: 7469 6d65 203d 206e 702e 6172 7261 7928  time = np.array(
+0001cc00: 7275 6e74 696d 655f 656e 6420 2d20 7275  runtime_end - ru
+0001cc10: 6e74 696d 655f 7374 6172 7429 2e72 6f75  ntime_start).rou
+0001cc20: 6e64 2832 290a 0a20 2020 2020 2020 2023  nd(2)..        #
+0001cc30: 2064 6173 6862 6f61 7264 206c 6f67 6769   dashboard loggi
+0001cc40: 6e67 0a20 2020 2020 2020 2069 6620 7365  ng.        if se
+0001cc50: 6c66 2e6c 6f67 6769 6e67 5f70 6172 616d  lf.logging_param
+0001cc60: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
+0001cc70: 6469 6365 7320 3d20 7365 6c66 2e5f 6765  dices = self._ge
+0001cc80: 745f 7265 7475 726e 5f74 7261 696e 5f73  t_return_train_s
+0001cc90: 636f 7265 5f69 6e64 6963 6573 5f66 6f72  core_indices_for
+0001cca0: 5f6c 6f67 6769 6e67 280a 2020 2020 2020  _logging(.      
+0001ccb0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001ccc0: 5f74 7261 696e 5f73 636f 7265 3d72 6574  _train_score=ret
+0001ccd0: 7572 6e5f 7472 6169 6e5f 7363 6f72 650a  urn_train_score.
+0001cce0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001ccf0: 2020 2020 2020 2020 2020 6176 6773 5f64            avgs_d
+0001cd00: 6963 745f 6c6f 6720 3d20 7b6b 3a20 7620  ict_log = {k: v 
+0001cd10: 666f 7220 6b2c 2076 2069 6e20 6d6f 6465  for k, v in mode
+0001cd20: 6c5f 7265 7375 6c74 732e 6c6f 635b 696e  l_results.loc[in
+0001cd30: 6469 6365 735d 2e69 7465 6d73 2829 7d0a  dices].items()}.
+0001cd40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001cd50: 2e6c 6f67 6769 6e67 5f70 6172 616d 2e6c  .logging_param.l
+0001cd60: 6f67 5f6d 6f64 656c 5f63 6f6d 7061 7269  og_model_compari
+0001cd70: 736f 6e28 6d6f 6465 6c5f 7265 7375 6c74  son(model_result
+0001cd80: 732c 2022 656e 7365 6d62 6c65 5f6d 6f64  s, "ensemble_mod
+0001cd90: 656c 2229 0a0a 2020 2020 2020 2020 2020  el")..          
+0001cda0: 2020 7365 6c66 2e5f 6c6f 675f 6d6f 6465    self._log_mode
+0001cdb0: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
+0001cdc0: 2020 206d 6f64 656c 3d62 6573 745f 6d6f     model=best_mo
+0001cdd0: 6465 6c2c 0a20 2020 2020 2020 2020 2020  del,.           
+0001cde0: 2020 2020 206d 6f64 656c 5f72 6573 756c       model_resul
+0001cdf0: 7473 3d6d 6f64 656c 5f72 6573 756c 7473  ts=model_results
+0001ce00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001ce10: 2020 7363 6f72 655f 6469 6374 3d61 7667    score_dict=avg
+0001ce20: 735f 6469 6374 5f6c 6f67 2c0a 2020 2020  s_dict_log,.    
+0001ce30: 2020 2020 2020 2020 2020 2020 736f 7572              sour
+0001ce40: 6365 3d22 656e 7365 6d62 6c65 5f6d 6f64  ce="ensemble_mod
+0001ce50: 656c 222c 0a20 2020 2020 2020 2020 2020  el",.           
+0001ce60: 2020 2020 2072 756e 7469 6d65 3d72 756e       runtime=run
+0001ce70: 7469 6d65 2c0a 2020 2020 2020 2020 2020  time,.          
+0001ce80: 2020 2020 2020 6d6f 6465 6c5f 6669 745f        model_fit_
+0001ce90: 7469 6d65 3d6d 6f64 656c 5f66 6974 5f74  time=model_fit_t
+0001cea0: 696d 652c 0a20 2020 2020 2020 2020 2020  ime,.           
+0001ceb0: 2020 2020 2070 6970 656c 696e 653d 7365       pipeline=se
+0001cec0: 6c66 2e70 6970 656c 696e 652c 0a20 2020  lf.pipeline,.   
+0001ced0: 2020 2020 2020 2020 2020 2020 206c 6f67               log
+0001cee0: 5f70 6c6f 7473 3d73 656c 662e 6c6f 675f  _plots=self.log_
+0001cef0: 706c 6f74 735f 7061 7261 6d2c 0a20 2020  plots_param,.   
+0001cf00: 2020 2020 2020 2020 2020 2020 2064 6973               dis
+0001cf10: 706c 6179 3d64 6973 706c 6179 2c0a 2020  play=display,.  
+0001cf20: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0001cf30: 2020 2020 2069 6620 6368 6f6f 7365 5f62       if choose_b
+0001cf40: 6574 7465 723a 0a20 2020 2020 2020 2020  etter:.         
+0001cf50: 2020 206e 6577 5f6d 6f64 656c 203d 2073     new_model = s
+0001cf60: 656c 662e 5f63 686f 6f73 655f 6265 7474  elf._choose_bett
+0001cf70: 6572 280a 2020 2020 2020 2020 2020 2020  er(.            
+0001cf80: 2020 2020 5b5f 6573 7469 6d61 746f 725f      [_estimator_
+0001cf90: 2c20 2862 6573 745f 6d6f 6465 6c2c 206d  , (best_model, m
+0001cfa0: 6f64 656c 5f72 6573 756c 7473 295d 2c0a  odel_results)],.
+0001cfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cfc0: 636f 6d70 6172 655f 6469 6d65 6e73 696f  compare_dimensio
+0001cfd0: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
+0001cfe0: 2020 2066 6f6c 642c 0a20 2020 2020 2020     fold,.       
+0001cff0: 2020 2020 2020 2020 2067 726f 7570 733d           groups=
+0001d000: 6772 6f75 7073 2c0a 2020 2020 2020 2020  groups,.        
+0001d010: 2020 2020 2020 2020 6669 745f 6b77 6172          fit_kwar
+0001d020: 6773 3d66 6974 5f6b 7761 7267 732c 0a20  gs=fit_kwargs,. 
+0001d030: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0001d040: 6973 706c 6179 3d64 6973 706c 6179 2c0a  isplay=display,.
+0001d050: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001d060: 2020 2020 2020 2020 2020 6966 206e 6577            if new
+0001d070: 5f6d 6f64 656c 2069 7320 6e6f 7420 6265  _model is not be
+0001d080: 7374 5f6d 6f64 656c 3a0a 2020 2020 2020  st_model:.      
+0001d090: 2020 2020 2020 2020 2020 6d73 6720 3d20            msg = 
+0001d0a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001d0b0: 2020 2020 2020 224f 7269 6769 6e61 6c20        "Original 
+0001d0c0: 6d6f 6465 6c20 7761 7320 6265 7474 6572  model was better
+0001d0d0: 2074 6861 6e20 7468 6520 656e 7365 6d62   than the ensemb
+0001d0e0: 6c65 6420 6d6f 6465 6c2c 2068 656e 6365  led model, hence
+0001d0f0: 2069 7420 7769 6c6c 2062 6520 7265 7475   it will be retu
+0001d100: 726e 6564 2e20 220a 2020 2020 2020 2020  rned. ".        
+0001d110: 2020 2020 2020 2020 2020 2020 224e 4f54              "NOT
+0001d120: 453a 2054 6865 2064 6973 706c 6179 206d  E: The display m
+0001d130: 6574 7269 6373 2061 7265 2066 6f72 2074  etrics are for t
+0001d140: 6865 2065 6e73 656d 626c 6564 206d 6f64  he ensembled mod
+0001d150: 656c 2028 6e6f 7420 7468 6520 6f72 6967  el (not the orig
+0001d160: 696e 616c 206f 6e65 292e 220a 2020 2020  inal one).".    
+0001d170: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001d180: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001d190: 2076 6572 626f 7365 3a0a 2020 2020 2020   verbose:.      
+0001d1a0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0001d1b0: 696e 7428 6d73 6729 0a20 2020 2020 2020  int(msg).       
+0001d1c0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
+0001d1d0: 6767 6572 2e69 6e66 6f28 6d73 6729 0a20  gger.info(msg). 
+0001d1e0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+0001d1f0: 203d 206e 6577 5f6d 6f64 656c 0a0a 2020   = new_model..  
+0001d200: 2020 2020 2020 6d6f 6465 6c5f 7265 7375        model_resu
+0001d210: 6c74 7320 3d20 7365 6c66 2e5f 6869 6768  lts = self._high
+0001d220: 6c69 6768 745f 616e 645f 726f 756e 645f  light_and_round_
+0001d230: 6d6f 6465 6c5f 7265 7375 6c74 7328 0a20  model_results(. 
+0001d240: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+0001d250: 5f72 6573 756c 7473 2c20 7265 7475 726e  _results, return
+0001d260: 5f74 7261 696e 5f73 636f 7265 2c20 726f  _train_score, ro
+0001d270: 756e 640a 2020 2020 2020 2020 290a 2020  und.        ).  
+0001d280: 2020 2020 2020 6469 7370 6c61 792e 6469        display.di
+0001d290: 7370 6c61 7928 6d6f 6465 6c5f 7265 7375  splay(model_resu
+0001d2a0: 6c74 7329 0a0a 2020 2020 2020 2020 7365  lts)..        se
+0001d2b0: 6c66 2e6c 6f67 6765 722e 696e 666f 280a  lf.logger.info(.
+0001d2c0: 2020 2020 2020 2020 2020 2020 6622 5f6d              f"_m
+0001d2d0: 6173 7465 725f 6d6f 6465 6c5f 636f 6e74  aster_model_cont
+0001d2e0: 6169 6e65 723a 207b 6c65 6e28 7365 6c66  ainer: {len(self
+0001d2f0: 2e5f 6d61 7374 6572 5f6d 6f64 656c 5f63  ._master_model_c
+0001d300: 6f6e 7461 696e 6572 297d 220a 2020 2020  ontainer)}".    
+0001d310: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+0001d320: 6c66 2e6c 6f67 6765 722e 696e 666f 2866  lf.logger.info(f
+0001d330: 225f 6469 7370 6c61 795f 636f 6e74 6169  "_display_contai
+0001d340: 6e65 723a 207b 6c65 6e28 7365 6c66 2e5f  ner: {len(self._
+0001d350: 6469 7370 6c61 795f 636f 6e74 6169 6e65  display_containe
+0001d360: 7229 7d22 290a 0a20 2020 2020 2020 2073  r)}")..        s
+0001d370: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
+0001d380: 7374 7228 6d6f 6465 6c29 290a 2020 2020  str(model)).    
+0001d390: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
+0001d3a0: 696e 666f 280a 2020 2020 2020 2020 2020  info(.          
+0001d3b0: 2020 2265 6e73 656d 626c 655f 6d6f 6465    "ensemble_mode
+0001d3c0: 6c28 2920 7375 6363 6573 7366 756c 6c79  l() successfully
+0001d3d0: 2063 6f6d 706c 6574 6564 2e2e 2e2e 2e2e   completed......
+0001d3e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0001d3f0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0001d400: 220a 2020 2020 2020 2020 290a 0a20 2020  ".        )..   
+0001d410: 2020 2020 2067 632e 636f 6c6c 6563 7428       gc.collect(
+0001d420: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0001d430: 206d 6f64 656c 0a0a 2020 2020 6465 6620   model..    def 
+0001d440: 626c 656e 645f 6d6f 6465 6c73 280a 2020  blend_models(.  
+0001d450: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0001d460: 2020 2020 6573 7469 6d61 746f 725f 6c69      estimator_li
+0001d470: 7374 3a20 6c69 7374 2c0a 2020 2020 2020  st: list,.      
+0001d480: 2020 666f 6c64 3a20 4f70 7469 6f6e 616c    fold: Optional
+0001d490: 5b55 6e69 6f6e 5b69 6e74 2c20 416e 795d  [Union[int, Any]
+0001d4a0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+0001d4b0: 2020 726f 756e 643a 2069 6e74 203d 2034    round: int = 4
+0001d4c0: 2c0a 2020 2020 2020 2020 6368 6f6f 7365  ,.        choose
+0001d4d0: 5f62 6574 7465 723a 2062 6f6f 6c20 3d20  _better: bool = 
+0001d4e0: 4661 6c73 652c 0a20 2020 2020 2020 206f  False,.        o
+0001d4f0: 7074 696d 697a 653a 2073 7472 203d 2022  ptimize: str = "
+0001d500: 4163 6375 7261 6379 222c 0a20 2020 2020  Accuracy",.     
+0001d510: 2020 206d 6574 686f 643a 2073 7472 203d     method: str =
+0001d520: 2022 6175 746f 222c 0a20 2020 2020 2020   "auto",.       
+0001d530: 2077 6569 6768 7473 3a20 4f70 7469 6f6e   weights: Option
+0001d540: 616c 5b4c 6973 745b 666c 6f61 745d 5d20  al[List[float]] 
+0001d550: 3d20 4e6f 6e65 2c20 2023 2061 6464 6564  = None,  # added
+0001d560: 2069 6e20 7079 6361 7265 743d 3d32 2e32   in pycaret==2.2
+0001d570: 2e30 0a20 2020 2020 2020 2066 6974 5f6b  .0.        fit_k
+0001d580: 7761 7267 733a 204f 7074 696f 6e61 6c5b  wargs: Optional[
+0001d590: 6469 6374 5d20 3d20 4e6f 6e65 2c0a 2020  dict] = None,.  
+0001d5a0: 2020 2020 2020 6772 6f75 7073 3a20 4f70        groups: Op
+0001d5b0: 7469 6f6e 616c 5b55 6e69 6f6e 5b73 7472  tional[Union[str
+0001d5c0: 2c20 416e 795d 5d20 3d20 4e6f 6e65 2c0a  , Any]] = None,.
+0001d5d0: 2020 2020 2020 2020 7072 6f62 6162 696c          probabil
+0001d5e0: 6974 795f 7468 7265 7368 6f6c 643a 204f  ity_threshold: O
+0001d5f0: 7074 696f 6e61 6c5b 666c 6f61 745d 203d  ptional[float] =
+0001d600: 204e 6f6e 652c 0a20 2020 2020 2020 2076   None,.        v
+0001d610: 6572 626f 7365 3a20 626f 6f6c 203d 2054  erbose: bool = T
+0001d620: 7275 652c 0a20 2020 2020 2020 2072 6574  rue,.        ret
+0001d630: 7572 6e5f 7472 6169 6e5f 7363 6f72 653a  urn_train_score:
+0001d640: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
+0001d650: 2020 2029 202d 3e20 416e 793a 0a20 2020     ) -> Any:.   
+0001d660: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001d670: 2054 6869 7320 6675 6e63 7469 6f6e 2063   This function c
+0001d680: 7265 6174 6573 2061 2053 6f66 7420 566f  reates a Soft Vo
+0001d690: 7469 6e67 202f 204d 616a 6f72 6974 7920  ting / Majority 
+0001d6a0: 5275 6c65 2063 6c61 7373 6966 6965 7220  Rule classifier 
+0001d6b0: 666f 7220 616c 6c20 7468 650a 2020 2020  for all the.    
+0001d6c0: 2020 2020 6573 7469 6d61 746f 7273 2069      estimators i
+0001d6d0: 6e20 7468 6520 6d6f 6465 6c20 6c69 6272  n the model libr
+0001d6e0: 6172 7920 2865 7863 6c75 6469 6e67 2074  ary (excluding t
+0001d6f0: 6865 2066 6577 2077 6865 6e20 7475 7262  he few when turb
+0001d700: 6f20 6973 2054 7275 6529 206f 720a 2020  o is True) or.  
+0001d710: 2020 2020 2020 666f 7220 7370 6563 6966        for specif
+0001d720: 6963 2074 7261 696e 6564 2065 7374 696d  ic trained estim
+0001d730: 6174 6f72 7320 7061 7373 6564 2061 7320  ators passed as 
+0001d740: 6120 6c69 7374 2069 6e20 6573 7469 6d61  a list in estima
+0001d750: 746f 725f 6c69 7374 2070 6172 616d 2e0a  tor_list param..
+0001d760: 2020 2020 2020 2020 4974 2073 636f 7265          It score
+0001d770: 7320 6974 2075 7369 6e67 2043 726f 7373  s it using Cross
+0001d780: 2056 616c 6964 6174 696f 6e2e 2054 6865   Validation. The
+0001d790: 206f 7574 7075 7420 7072 696e 7473 2061   output prints a
+0001d7a0: 2073 636f 7265 0a20 2020 2020 2020 2067   score.        g
+0001d7b0: 7269 6420 7468 6174 2073 686f 7773 2041  rid that shows A
+0001d7c0: 6363 7572 6163 792c 2041 5543 2c20 5265  ccuracy, AUC, Re
+0001d7d0: 6361 6c6c 2c20 5072 6563 6973 696f 6e2c  call, Precision,
+0001d7e0: 2046 312c 204b 6170 7061 2061 6e64 204d   F1, Kappa and M
+0001d7f0: 4343 2062 790a 2020 2020 2020 2020 666f  CC by.        fo
+0001d800: 6c64 2028 6465 6661 756c 7420 4356 203d  ld (default CV =
+0001d810: 2031 3020 466f 6c64 7329 2e0a 0a20 2020   10 Folds)...   
+0001d820: 2020 2020 2054 6869 7320 6675 6e63 7469       This functi
+0001d830: 6f6e 2072 6574 7572 6e73 2061 2074 7261  on returns a tra
+0001d840: 696e 6564 206d 6f64 656c 206f 626a 6563  ined model objec
+0001d850: 742e 0a0a 2020 2020 2020 2020 4578 616d  t...        Exam
+0001d860: 706c 650a 2020 2020 2020 2020 2d2d 2d2d  ple.        ----
+0001d870: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
+0001d880: 6c72 203d 2063 7265 6174 655f 6d6f 6465  lr = create_mode
+0001d890: 6c28 276c 7227 290a 2020 2020 2020 2020  l('lr').        
+0001d8a0: 3e3e 3e20 7266 203d 2063 7265 6174 655f  >>> rf = create_
+0001d8b0: 6d6f 6465 6c28 2772 6627 290a 2020 2020  model('rf').    
+0001d8c0: 2020 2020 3e3e 3e20 6b6e 6e20 3d20 6372      >>> knn = cr
+0001d8d0: 6561 7465 5f6d 6f64 656c 2827 6b6e 6e27  eate_model('knn'
+0001d8e0: 290a 2020 2020 2020 2020 3e3e 3e20 626c  ).        >>> bl
+0001d8f0: 656e 645f 7468 7265 6520 3d20 626c 656e  end_three = blen
+0001d900: 645f 6d6f 6465 6c73 2865 7374 696d 6174  d_models(estimat
+0001d910: 6f72 5f6c 6973 7420 3d20 5b6c 722c 7266  or_list = [lr,rf
+0001d920: 2c6b 6e6e 5d29 0a0a 2020 2020 2020 2020  ,knn])..        
+0001d930: 5468 6973 2077 696c 6c20 6372 6561 7465  This will create
+0001d940: 2061 2056 6f74 696e 6743 6c61 7373 6966   a VotingClassif
+0001d950: 6965 7220 6f66 206c 722c 2072 6620 616e  ier of lr, rf an
+0001d960: 6420 6b6e 6e2e 0a0a 2020 2020 2020 2020  d knn...        
+0001d970: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+0001d980: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+0001d990: 2020 2020 2020 6573 7469 6d61 746f 725f        estimator_
+0001d9a0: 6c69 7374 203a 206c 6973 7420 6f66 206f  list : list of o
+0001d9b0: 626a 6563 7473 0a0a 2020 2020 2020 2020  bjects..        
+0001d9c0: 666f 6c64 3a20 696e 7465 6765 7220 6f72  fold: integer or
+0001d9d0: 2073 6369 6b69 742d 6c65 6172 6e20 636f   scikit-learn co
+0001d9e0: 6d70 6174 6962 6c65 2043 5620 6765 6e65  mpatible CV gene
+0001d9f0: 7261 746f 722c 2064 6566 6175 6c74 203d  rator, default =
+0001da00: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+0001da10: 2020 436f 6e74 726f 6c73 2063 726f 7373    Controls cross
+0001da20: 2d76 616c 6964 6174 696f 6e2e 2049 6620  -validation. If 
+0001da30: 4e6f 6e65 2c20 7769 6c6c 2075 7365 2074  None, will use t
+0001da40: 6865 2043 5620 6765 6e65 7261 746f 7220  he CV generator 
+0001da50: 6465 6669 6e65 6420 696e 2073 6574 7570  defined in setup
+0001da60: 2829 2e0a 2020 2020 2020 2020 2020 2020  ()..            
+0001da70: 4966 2069 6e74 6567 6572 2c20 7769 6c6c  If integer, will
+0001da80: 2075 7365 204b 466f 6c64 2043 5620 7769   use KFold CV wi
+0001da90: 7468 2074 6861 7420 6d61 6e79 2066 6f6c  th that many fol
+0001daa0: 6473 2e0a 2020 2020 2020 2020 2020 2020  ds..            
+0001dab0: 5768 656e 2063 726f 7373 5f76 616c 6964  When cross_valid
+0001dac0: 6174 696f 6e20 6973 2046 616c 7365 2c20  ation is False, 
+0001dad0: 7468 6973 2070 6172 616d 6574 6572 2069  this parameter i
+0001dae0: 7320 6967 6e6f 7265 642e 0a0a 2020 2020  s ignored...    
+0001daf0: 2020 2020 726f 756e 643a 2069 6e74 6567      round: integ
+0001db00: 6572 2c20 6465 6661 756c 7420 3d20 340a  er, default = 4.
+0001db10: 2020 2020 2020 2020 2020 2020 4e75 6d62              Numb
+0001db20: 6572 206f 6620 6465 6369 6d61 6c20 706c  er of decimal pl
+0001db30: 6163 6573 2074 6865 206d 6574 7269 6373  aces the metrics
+0001db40: 2069 6e20 7468 6520 7363 6f72 6520 6772   in the score gr
+0001db50: 6964 2077 696c 6c20 6265 2072 6f75 6e64  id will be round
+0001db60: 6564 2074 6f2e 0a0a 2020 2020 2020 2020  ed to...        
+0001db70: 6368 6f6f 7365 5f62 6574 7465 723a 2062  choose_better: b
+0001db80: 6f6f 6c2c 2064 6566 6175 6c74 203d 2046  ool, default = F
+0001db90: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+0001dba0: 2057 6865 6e20 7365 7420 746f 2073 6574   When set to set
+0001dbb0: 2074 6f20 5472 7565 2c20 6261 7365 2065   to True, base e
+0001dbc0: 7374 696d 6174 6f72 2069 7320 7265 7475  stimator is retu
+0001dbd0: 726e 6564 2077 6865 6e20 7468 6520 6d65  rned when the me
+0001dbe0: 7472 6963 2064 6f65 736e 2774 0a20 2020  tric doesn't.   
+0001dbf0: 2020 2020 2020 2020 2069 6d70 726f 7665           improve
+0001dc00: 2062 7920 656e 7365 6d62 6c65 5f6d 6f64   by ensemble_mod
+0001dc10: 656c 2e20 5468 6973 2067 7561 7261 6e74  el. This guarant
+0001dc20: 6565 7320 7468 6520 7265 7475 726e 6564  ees the returned
+0001dc30: 206f 626a 6563 7420 776f 756c 6420 7065   object would pe
+0001dc40: 7266 6f72 6d0a 2020 2020 2020 2020 2020  rform.          
+0001dc50: 2020 6174 206c 6561 7374 2065 7175 6976    at least equiv
+0001dc60: 616c 656e 7420 746f 2062 6173 6520 6573  alent to base es
+0001dc70: 7469 6d61 746f 7220 6372 6561 7465 6420  timator created 
+0001dc80: 7573 696e 6720 6372 6561 7465 5f6d 6f64  using create_mod
+0001dc90: 656c 206f 7220 6d6f 6465 6c0a 2020 2020  el or model.    
+0001dca0: 2020 2020 2020 2020 7265 7475 726e 6564          returned
+0001dcb0: 2062 7920 636f 6d70 6172 655f 6d6f 6465   by compare_mode
+0001dcc0: 6c73 2e0a 0a20 2020 2020 2020 206f 7074  ls...        opt
+0001dcd0: 696d 697a 653a 2073 7472 2c20 6465 6661  imize: str, defa
+0001dce0: 756c 7420 3d20 2741 6363 7572 6163 7927  ult = 'Accuracy'
+0001dcf0: 0a20 2020 2020 2020 2020 2020 204f 6e6c  .            Onl
+0001dd00: 7920 7573 6564 2077 6865 6e20 6368 6f6f  y used when choo
+0001dd10: 7365 5f62 6574 7465 7220 6973 2073 6574  se_better is set
+0001dd20: 2074 6f20 5472 7565 2e20 6f70 7469 6d69   to True. optimi
+0001dd30: 7a65 2070 6172 616d 6574 6572 2069 7320  ze parameter is 
+0001dd40: 7573 6564 0a20 2020 2020 2020 2020 2020  used.           
+0001dd50: 2074 6f20 636f 6d70 6172 6520 656e 7365   to compare ense
+0001dd60: 6d62 6c65 6420 6d6f 6465 6c20 7769 7468  mbled model with
+0001dd70: 2062 6173 6520 6573 7469 6d61 746f 722e   base estimator.
+0001dd80: 2056 616c 7565 7320 6163 6365 7074 6564   Values accepted
+0001dd90: 2069 6e0a 2020 2020 2020 2020 2020 2020   in.            
+0001dda0: 6f70 7469 6d69 7a65 2070 6172 616d 6574  optimize paramet
+0001ddb0: 6572 2061 7265 2027 4163 6375 7261 6379  er are 'Accuracy
+0001ddc0: 272c 2027 4155 4327 2c20 2752 6563 616c  ', 'AUC', 'Recal
+0001ddd0: 6c27 2c20 2750 7265 6369 7369 6f6e 272c  l', 'Precision',
+0001dde0: 2027 4631 272c 0a20 2020 2020 2020 2020   'F1',.         
+0001ddf0: 2020 2027 4b61 7070 6127 2c20 274d 4343     'Kappa', 'MCC
+0001de00: 272e 0a0a 2020 2020 2020 2020 6d65 7468  '...        meth
+0001de10: 6f64 3a20 7374 722c 2064 6566 6175 6c74  od: str, default
+0001de20: 203d 2027 6175 746f 270a 2020 2020 2020   = 'auto'.      
+0001de30: 2020 2020 2020 2768 6172 6427 2075 7365        'hard' use
+0001de40: 7320 7072 6564 6963 7465 6420 636c 6173  s predicted clas
+0001de50: 7320 6c61 6265 6c73 2066 6f72 206d 616a  s labels for maj
+0001de60: 6f72 6974 7920 7275 6c65 2076 6f74 696e  ority rule votin
+0001de70: 672e 2027 736f 6674 272c 2070 7265 6469  g. 'soft', predi
+0001de80: 6374 730a 2020 2020 2020 2020 2020 2020  cts.            
+0001de90: 7468 6520 636c 6173 7320 6c61 6265 6c20  the class label 
+0001dea0: 6261 7365 6420 6f6e 2074 6865 2061 7267  based on the arg
+0001deb0: 6d61 7820 6f66 2074 6865 2073 756d 7320  max of the sums 
+0001dec0: 6f66 2074 6865 2070 7265 6469 6374 6564  of the predicted
+0001ded0: 2070 726f 6261 6269 6c69 7469 6573 2c0a   probabilities,.
+0001dee0: 2020 2020 2020 2020 2020 2020 7768 6963              whic
+0001def0: 6820 6973 2072 6563 6f6d 6d65 6e64 6564  h is recommended
+0001df00: 2066 6f72 2061 6e20 656e 7365 6d62 6c65   for an ensemble
+0001df10: 206f 6620 7765 6c6c 2d63 616c 6962 7261   of well-calibra
+0001df20: 7465 6420 636c 6173 7369 6669 6572 732e  ted classifiers.
+0001df30: 2044 6566 6175 6c74 2076 616c 7565 2c0a   Default value,.
+0001df40: 2020 2020 2020 2020 2020 2020 2761 7574              'aut
+0001df50: 6f27 2c20 7769 6c6c 2074 7279 2074 6f20  o', will try to 
+0001df60: 7573 6520 2773 6f66 7427 2061 6e64 2066  use 'soft' and f
+0001df70: 616c 6c20 6261 636b 2074 6f20 2768 6172  all back to 'har
+0001df80: 6427 2069 6620 7468 6520 666f 726d 6572  d' if the former
+0001df90: 2069 7320 6e6f 7420 7375 7070 6f72 7465   is not supporte
+0001dfa0: 642e 0a0a 2020 2020 2020 2020 7765 6967  d...        weig
+0001dfb0: 6874 733a 206c 6973 742c 2064 6566 6175  hts: list, defau
+0001dfc0: 6c74 203d 204e 6f6e 650a 2020 2020 2020  lt = None.      
+0001dfd0: 2020 2020 2020 5365 7175 656e 6365 206f        Sequence o
+0001dfe0: 6620 7765 6967 6874 7320 2866 6c6f 6174  f weights (float
+0001dff0: 206f 7220 696e 7429 2074 6f20 7765 6967   or int) to weig
+0001e000: 6874 2074 6865 206f 6363 7572 7265 6e63  ht the occurrenc
+0001e010: 6573 206f 6620 7072 6564 6963 7465 6420  es of predicted 
+0001e020: 636c 6173 7320 6c61 6265 6c73 2028 6861  class labels (ha
+0001e030: 7264 2076 6f74 696e 6729 0a20 2020 2020  rd voting).     
+0001e040: 2020 2020 2020 206f 7220 636c 6173 7320         or class 
+0001e050: 7072 6f62 6162 696c 6974 6965 7320 6265  probabilities be
+0001e060: 666f 7265 2061 7665 7261 6769 6e67 2028  fore averaging (
+0001e070: 736f 6674 2076 6f74 696e 6729 2e20 5573  soft voting). Us
+0001e080: 6573 2075 6e69 666f 726d 2077 6569 6768  es uniform weigh
+0001e090: 7473 2069 6620 4e6f 6e65 2e0a 0a20 2020  ts if None...   
+0001e0a0: 2020 2020 2066 6974 5f6b 7761 7267 733a       fit_kwargs:
+0001e0b0: 2064 6963 742c 2064 6566 6175 6c74 203d   dict, default =
+0001e0c0: 207b 7d20 2865 6d70 7479 2064 6963 7429   {} (empty dict)
+0001e0d0: 0a20 2020 2020 2020 2020 2020 2044 6963  .            Dic
+0001e0e0: 7469 6f6e 6172 7920 6f66 2061 7267 756d  tionary of argum
+0001e0f0: 656e 7473 2070 6173 7365 6420 746f 2074  ents passed to t
+0001e100: 6865 2066 6974 206d 6574 686f 6420 6f66  he fit method of
+0001e110: 2074 6865 206d 6f64 656c 2e0a 0a20 2020   the model...   
+0001e120: 2020 2020 2067 726f 7570 733a 2073 7472       groups: str
+0001e130: 206f 7220 6172 7261 792d 6c69 6b65 2c20   or array-like, 
+0001e140: 7769 7468 2073 6861 7065 2028 6e5f 7361  with shape (n_sa
+0001e150: 6d70 6c65 732c 292c 2064 6566 6175 6c74  mples,), default
+0001e160: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+0001e170: 2020 2020 4f70 7469 6f6e 616c 2047 726f      Optional Gro
+0001e180: 7570 206c 6162 656c 7320 666f 7220 7468  up labels for th
+0001e190: 6520 7361 6d70 6c65 7320 7573 6564 2077  e samples used w
+0001e1a0: 6869 6c65 2073 706c 6974 7469 6e67 2074  hile splitting t
+0001e1b0: 6865 2064 6174 6173 6574 2069 6e74 6f20  he dataset into 
+0001e1c0: 7472 6169 6e2f 7465 7374 2073 6574 2e0a  train/test set..
+0001e1d0: 2020 2020 2020 2020 2020 2020 4966 2073              If s
+0001e1e0: 7472 696e 6720 6973 2070 6173 7365 642c  tring is passed,
+0001e1f0: 2077 696c 6c20 7573 6520 7468 6520 6461   will use the da
+0001e200: 7461 2063 6f6c 756d 6e20 7769 7468 2074  ta column with t
+0001e210: 6861 7420 6e61 6d65 2061 7320 7468 6520  hat name as the 
+0001e220: 6772 6f75 7073 2e0a 2020 2020 2020 2020  groups..        
+0001e230: 2020 2020 4f6e 6c79 2075 7365 6420 6966      Only used if
+0001e240: 2061 2067 726f 7570 2062 6173 6564 2063   a group based c
+0001e250: 726f 7373 2d76 616c 6964 6174 696f 6e20  ross-validation 
+0001e260: 6765 6e65 7261 746f 7220 6973 2075 7365  generator is use
+0001e270: 6420 2865 672e 2047 726f 7570 4b46 6f6c  d (eg. GroupKFol
+0001e280: 6429 2e0a 2020 2020 2020 2020 2020 2020  d)..            
+0001e290: 4966 204e 6f6e 652c 2077 696c 6c20 7573  If None, will us
+0001e2a0: 6520 7468 6520 7661 6c75 6520 7365 7420  e the value set 
+0001e2b0: 696e 2066 6f6c 645f 6772 6f75 7073 2070  in fold_groups p
+0001e2c0: 6172 616d 6574 6572 2069 6e20 7365 7475  arameter in setu
+0001e2d0: 7028 292e 0a0a 2020 2020 2020 2020 7665  p()...        ve
+0001e2e0: 7262 6f73 653a 2062 6f6f 6c2c 2064 6566  rbose: bool, def
+0001e2f0: 6175 6c74 203d 2054 7275 650a 2020 2020  ault = True.    
+0001e300: 2020 2020 2020 2020 5363 6f72 6520 6772          Score gr
+0001e310: 6964 2069 7320 6e6f 7420 7072 696e 7465  id is not printe
+0001e320: 6420 7768 656e 2076 6572 626f 7365 2069  d when verbose i
+0001e330: 7320 7365 7420 746f 2046 616c 7365 2e0a  s set to False..
+0001e340: 0a20 2020 2020 2020 2072 6574 7572 6e5f  .        return_
+0001e350: 7472 6169 6e5f 7363 6f72 653a 2062 6f6f  train_score: boo
+0001e360: 6c2c 2064 6566 6175 6c74 203d 2046 616c  l, default = Fal
+0001e370: 7365 0a20 2020 2020 2020 2020 2020 2049  se.            I
+0001e380: 6620 4661 6c73 652c 2072 6574 7572 6e73  f False, returns
+0001e390: 2074 6865 2043 5620 5661 6c69 6461 7469   the CV Validati
+0001e3a0: 6f6e 2073 636f 7265 7320 6f6e 6c79 2e0a  on scores only..
+0001e3b0: 2020 2020 2020 2020 2020 2020 4966 2054              If T
+0001e3c0: 7275 652c 2072 6574 7572 6e73 2074 6865  rue, returns the
+0001e3d0: 2043 5620 7472 6169 6e69 6e67 2073 636f   CV training sco
+0001e3e0: 7265 7320 616c 6f6e 6720 7769 7468 2074  res along with t
+0001e3f0: 6865 2043 5620 7661 6c69 6461 7469 6f6e  he CV validation
+0001e400: 2073 636f 7265 732e 0a20 2020 2020 2020   scores..       
+0001e410: 2020 2020 2054 6869 7320 6973 2075 7365       This is use
+0001e420: 6675 6c20 7768 656e 2074 6865 2075 7365  ful when the use
+0001e430: 7220 7761 6e74 7320 746f 2064 6f20 6269  r wants to do bi
+0001e440: 6173 2d76 6172 6961 6e63 6520 7472 6164  as-variance trad
+0001e450: 656f 6666 2e20 4120 6869 6768 2043 560a  eoff. A high CV.
+0001e460: 2020 2020 2020 2020 2020 2020 7472 6169              trai
+0001e470: 6e69 6e67 2073 636f 7265 2077 6974 6820  ning score with 
+0001e480: 6120 6c6f 7720 636f 7272 6573 706f 6e64  a low correspond
+0001e490: 696e 6720 4356 2076 616c 6964 6174 696f  ing CV validatio
+0001e4a0: 6e20 7363 6f72 6520 696e 6469 6361 7465  n score indicate
+0001e4b0: 7320 6f76 6572 6669 7474 696e 672e 0a0a  s overfitting...
+0001e4c0: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
+0001e4d0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+0001e4e0: 2020 2020 2020 2020 7363 6f72 655f 6772          score_gr
+0001e4f0: 6964 0a20 2020 2020 2020 2020 2020 2041  id.            A
+0001e500: 2074 6162 6c65 2063 6f6e 7461 696e 696e   table containin
+0001e510: 6720 7468 6520 7363 6f72 6573 206f 6620  g the scores of 
+0001e520: 7468 6520 6d6f 6465 6c20 6163 726f 7373  the model across
+0001e530: 2074 6865 206b 666f 6c64 732e 0a20 2020   the kfolds..   
+0001e540: 2020 2020 2020 2020 2053 636f 7269 6e67           Scoring
+0001e550: 206d 6574 7269 6373 2075 7365 6420 6172   metrics used ar
+0001e560: 6520 4163 6375 7261 6379 2c20 4155 432c  e Accuracy, AUC,
+0001e570: 2052 6563 616c 6c2c 2050 7265 6369 7369   Recall, Precisi
+0001e580: 6f6e 2c20 4631 2c0a 2020 2020 2020 2020  on, F1,.        
+0001e590: 2020 2020 4b61 7070 6120 616e 6420 4d43      Kappa and MC
+0001e5a0: 432e 204d 6561 6e20 616e 6420 7374 616e  C. Mean and stan
+0001e5b0: 6461 7264 2064 6576 6961 7469 6f6e 206f  dard deviation o
+0001e5c0: 6620 7468 6520 7363 6f72 6573 2061 6372  f the scores acr
+0001e5d0: 6f73 730a 2020 2020 2020 2020 2020 2020  oss.            
+0001e5e0: 7468 6520 666f 6c64 7320 6172 6520 616c  the folds are al
+0001e5f0: 736f 2072 6574 7572 6e65 642e 0a0a 2020  so returned...  
+0001e600: 2020 2020 2020 6d6f 6465 6c0a 2020 2020        model.    
+0001e610: 2020 2020 2020 2020 5472 6169 6e65 6420          Trained 
+0001e620: 566f 7469 6e67 2043 6c61 7373 6966 6965  Voting Classifie
+0001e630: 7220 6d6f 6465 6c20 6f62 6a65 6374 2e0a  r model object..
+0001e640: 0a20 2020 2020 2020 2057 6172 6e69 6e67  .        Warning
+0001e650: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0001e660: 2d2d 0a20 2020 2020 2020 202d 2057 6865  --.        - Whe
+0001e670: 6e20 7061 7373 696e 6720 6573 7469 6d61  n passing estima
+0001e680: 746f 725f 6c69 7374 2077 6974 6820 6d65  tor_list with me
+0001e690: 7468 6f64 2073 6574 2074 6f20 2773 6f66  thod set to 'sof
+0001e6a0: 7427 2e20 416c 6c20 7468 6520 6d6f 6465  t'. All the mode
+0001e6b0: 6c73 2069 6e20 7468 650a 2020 2020 2020  ls in the.      
+0001e6c0: 2020 6573 7469 6d61 746f 725f 6c69 7374    estimator_list
+0001e6d0: 206d 7573 7420 7375 7070 6f72 7420 7072   must support pr
+0001e6e0: 6564 6963 745f 7072 6f62 6120 6675 6e63  edict_proba func
+0001e6f0: 7469 6f6e 2e20 2773 766d 2720 616e 6420  tion. 'svm' and 
+0001e700: 2772 6964 6765 2720 646f 6573 206e 6f74  'ridge' does not
+0001e710: 0a20 2020 2020 2020 2073 7570 706f 7274  .        support
+0001e720: 2074 6865 2070 7265 6469 6374 5f70 726f   the predict_pro
+0001e730: 6261 2061 6e64 2068 656e 6365 2061 6e20  ba and hence an 
+0001e740: 6578 6365 7074 696f 6e20 7769 6c6c 2062  exception will b
+0001e750: 6520 7261 6973 6564 2e0a 0a20 2020 2020  e raised...     
+0001e760: 2020 202d 2057 6865 6e20 6573 7469 6d61     - When estima
+0001e770: 746f 725f 6c69 7374 2069 7320 7365 7420  tor_list is set 
+0001e780: 746f 2027 416c 6c27 2061 6e64 206d 6574  to 'All' and met
+0001e790: 686f 6420 6973 2066 6f72 6365 6420 746f  hod is forced to
+0001e7a0: 2027 736f 6674 272c 2065 7374 696d 6174   'soft', estimat
+0001e7b0: 6f72 730a 2020 2020 2020 2020 7468 6174  ors.        that
+0001e7c0: 2064 6f65 7320 6e6f 7420 7375 7070 6f72   does not suppor
+0001e7d0: 7420 7468 6520 7072 6564 6963 745f 7072  t the predict_pr
+0001e7e0: 6f62 6120 6675 6e63 7469 6f6e 2077 696c  oba function wil
+0001e7f0: 6c20 6265 2064 726f 7070 6564 2066 726f  l be dropped fro
+0001e800: 6d20 7468 6520 6573 7469 6d61 746f 720a  m the estimator.
+0001e810: 2020 2020 2020 2020 6c69 7374 2e0a 0a20          list... 
+0001e820: 2020 2020 2020 202d 2049 6620 7461 7267         - If targ
+0001e830: 6574 2076 6172 6961 626c 6520 6973 206d  et variable is m
+0001e840: 756c 7469 636c 6173 7320 286d 6f72 6520  ulticlass (more 
+0001e850: 7468 616e 2032 2063 6c61 7373 6573 292c  than 2 classes),
+0001e860: 2041 5543 2077 696c 6c20 6265 2072 6574   AUC will be ret
+0001e870: 7572 6e65 6420 6173 0a20 2020 2020 2020  urned as.       
+0001e880: 207a 6572 6f20 2830 2e30 292e 0a0a 0a0a   zero (0.0).....
+0001e890: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001e8a0: 2020 2020 7365 6c66 2e5f 6368 6563 6b5f      self._check_
+0001e8b0: 7365 7475 705f 7261 6e28 290a 0a20 2020  setup_ran()..   
+0001e8c0: 2020 2020 2066 756e 6374 696f 6e5f 7061       function_pa
+0001e8d0: 7261 6d73 5f73 7472 203d 2022 2c20 222e  rams_str = ", ".
+0001e8e0: 6a6f 696e 285b 6622 7b6b 7d3d 7b76 7d22  join([f"{k}={v}"
+0001e8f0: 2066 6f72 206b 2c20 7620 696e 206c 6f63   for k, v in loc
+0001e900: 616c 7328 292e 6974 656d 7328 295d 290a  als().items()]).
+0001e910: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
+0001e920: 6767 6572 2e69 6e66 6f28 2249 6e69 7469  gger.info("Initi
+0001e930: 616c 697a 696e 6720 626c 656e 645f 6d6f  alizing blend_mo
+0001e940: 6465 6c73 2829 2229 0a20 2020 2020 2020  dels()").       
+0001e950: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
+0001e960: 6f28 6622 626c 656e 645f 6d6f 6465 6c73  o(f"blend_models
+0001e970: 287b 6675 6e63 7469 6f6e 5f70 6172 616d  ({function_param
+0001e980: 735f 7374 727d 2922 290a 0a20 2020 2020  s_str})")..     
+0001e990: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
+0001e9a0: 6e66 6f28 2243 6865 636b 696e 6720 6578  nfo("Checking ex
+0001e9b0: 6365 7074 696f 6e73 2229 0a0a 2020 2020  ceptions")..    
+0001e9c0: 2020 2020 2320 7275 6e5f 7469 6d65 0a20      # run_time. 
+0001e9d0: 2020 2020 2020 2072 756e 7469 6d65 5f73         runtime_s
+0001e9e0: 7461 7274 203d 2074 696d 652e 7469 6d65  tart = time.time
+0001e9f0: 2829 0a0a 2020 2020 2020 2020 6966 206e  ()..        if n
+0001ea00: 6f74 2066 6974 5f6b 7761 7267 733a 0a20  ot fit_kwargs:. 
+0001ea10: 2020 2020 2020 2020 2020 2066 6974 5f6b             fit_k
+0001ea20: 7761 7267 7320 3d20 7b7d 0a0a 2020 2020  wargs = {}..    
+0001ea30: 2020 2020 2320 6368 6563 6b69 6e67 206d      # checking m
+0001ea40: 6574 686f 6420 7061 7261 6d65 7465 720a  ethod parameter.
+0001ea50: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0001ea60: 5f6d 6c5f 7573 6563 6173 6520 3d3d 204d  _ml_usecase == M
+0001ea70: 4c55 7365 6361 7365 2e54 494d 455f 5345  LUsecase.TIME_SE
+0001ea80: 5249 4553 3a0a 2020 2020 2020 2020 2020  RIES:.          
+0001ea90: 2020 6176 6169 6c61 626c 655f 6d65 7468    available_meth
+0001eaa0: 6f64 203d 205b 226d 6561 6e22 2c20 226d  od = ["mean", "m
+0001eab0: 6564 6961 6e22 2c20 226d 696e 222c 2022  edian", "min", "
+0001eac0: 6d61 7822 2c20 2267 6d65 616e 225d 0a20  max", "gmean"]. 
+0001ead0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001eae0: 2020 2020 2020 2020 2061 7661 696c 6162           availab
+0001eaf0: 6c65 5f6d 6574 686f 6420 3d20 5b22 6175  le_method = ["au
+0001eb00: 746f 222c 2022 736f 6674 222c 2022 6861  to", "soft", "ha
+0001eb10: 7264 222c 2022 6d65 616e 222c 2022 6d65  rd", "mean", "me
+0001eb20: 6469 616e 222c 2022 766f 7469 6e67 225d  dian", "voting"]
+0001eb30: 0a20 2020 2020 2020 2069 6620 6d65 7468  .        if meth
+0001eb40: 6f64 206e 6f74 2069 6e20 6176 6169 6c61  od not in availa
+0001eb50: 626c 655f 6d65 7468 6f64 3a0a 2020 2020  ble_method:.    
+0001eb60: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0001eb70: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+0001eb80: 2020 2020 2020 2020 2020 6622 4d65 7468            f"Meth
+0001eb90: 6f64 2070 6172 616d 6574 6572 206f 6e6c  od parameter onl
+0001eba0: 7920 6163 6365 7074 7320 7468 6520 666f  y accepts the fo
+0001ebb0: 6c6c 6f77 696e 6720 7661 6c75 6573 3a20  llowing values: 
+0001ebc0: 7b61 7661 696c 6162 6c65 5f6d 6574 686f  {available_metho
+0001ebd0: 647d 2e20 220a 2020 2020 2020 2020 2020  d}. ".          
+0001ebe0: 2020 2020 2020 2253 6565 2044 6f63 7374        "See Docst
+0001ebf0: 7269 6e67 2066 6f72 2064 6574 6169 6c73  ring for details
+0001ec00: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
+0001ec10: 0a0a 2020 2020 2020 2020 2320 6368 6563  ..        # chec
+0001ec20: 6b69 6e67 2065 7272 6f72 2066 6f72 2065  king error for e
+0001ec30: 7374 696d 6174 6f72 5f6c 6973 7420 2873  stimator_list (s
+0001ec40: 6b69 7020 666f 7220 7469 6d65 7365 7269  kip for timeseri
+0001ec50: 6573 290a 2020 2020 2020 2020 6966 206e  es).        if n
+0001ec60: 6f74 2073 656c 662e 5f6d 6c5f 7573 6563  ot self._ml_usec
+0001ec70: 6173 6520 3d3d 204d 4c55 7365 6361 7365  ase == MLUsecase
+0001ec80: 2e54 494d 455f 5345 5249 4553 3a0a 2020  .TIME_SERIES:.  
+0001ec90: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
+0001eca0: 696e 2065 7374 696d 6174 6f72 5f6c 6973  in estimator_lis
+0001ecb0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+0001ecc0: 2020 2069 6620 6e6f 7420 6861 7361 7474     if not hasatt
+0001ecd0: 7228 692c 2022 6669 7422 293a 0a20 2020  r(i, "fit"):.   
 0001ece0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ecf0: 2020 2023 2063 6865 636b 696e 6720 6d65     # checking me
-0001ed00: 7468 6f64 2070 6172 616d 6574 6572 2077  thod parameter w
-0001ed10: 6974 6820 6573 7469 6d61 746f 7220 6c69  ith estimator li
-0001ed20: 7374 0a20 2020 2020 2020 2020 2020 2020  st.             
-0001ed30: 2020 2020 2020 2069 6620 6d65 7468 6f64         if method
-0001ed40: 2021 3d20 2268 6172 6422 3a0a 0a20 2020   != "hard":..   
-0001ed50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ed60: 2020 2020 2066 6f72 2069 2069 6e20 6573       for i in es
-0001ed70: 7469 6d61 746f 725f 6c69 7374 3a0a 2020  timator_list:.  
-0001ed80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ed90: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0001eda0: 2068 6173 6174 7472 2869 2c20 2270 7265   hasattr(i, "pre
-0001edb0: 6469 6374 5f70 726f 6261 2229 3a0a 2020  dict_proba"):.  
-0001edc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001edd0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001ede0: 206d 6574 686f 6420 213d 2022 6175 746f   method != "auto
-0001edf0: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
-0001ee00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ee10: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-0001ee20: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-0001ee30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ee40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ee50: 6622 4573 7469 6d61 746f 7220 6c69 7374  f"Estimator list
-0001ee60: 2063 6f6e 7461 696e 7320 6573 7469 6d61   contains estima
-0001ee70: 746f 7220 7b69 7d20 7468 6174 2064 6f65  tor {i} that doe
-0001ee80: 736e 2774 2073 7570 706f 7274 2070 726f  sn't support pro
-0001ee90: 6261 6269 6c69 7469 6573 2061 6e64 206d  babilities and m
-0001eea0: 6574 686f 6420 6973 2066 6f72 6365 6420  ethod is forced 
-0001eeb0: 746f 2027 736f 6674 272e 2045 6974 6865  to 'soft'. Eithe
-0001eec0: 7220 6368 616e 6765 2074 6865 206d 6574  r change the met
-0001eed0: 686f 6420 6f72 2064 726f 7020 7468 6520  hod or drop the 
-0001eee0: 6573 7469 6d61 746f 722e 220a 2020 2020  estimator.".    
-0001eef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ecf0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0001ed00: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0001ed10: 2020 2020 2020 2020 2020 2066 2245 7374             f"Est
+0001ed20: 696d 6174 6f72 207b 697d 2064 6f65 7320  imator {i} does 
+0001ed30: 6e6f 7420 6861 7665 2074 6865 2072 6571  not have the req
+0001ed40: 7569 7265 6420 6669 7428 2920 6d65 7468  uired fit() meth
+0001ed50: 6f64 2e22 0a20 2020 2020 2020 2020 2020  od.".           
+0001ed60: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001ed70: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0001ed80: 6c66 2e5f 6d6c 5f75 7365 6361 7365 203d  lf._ml_usecase =
+0001ed90: 3d20 4d4c 5573 6563 6173 652e 434c 4153  = MLUsecase.CLAS
+0001eda0: 5349 4649 4341 5449 4f4e 3a0a 2020 2020  SIFICATION:.    
+0001edb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001edc0: 2320 6368 6563 6b69 6e67 206d 6574 686f  # checking metho
+0001edd0: 6420 7061 7261 6d65 7465 7220 7769 7468  d parameter with
+0001ede0: 2065 7374 696d 6174 6f72 206c 6973 740a   estimator list.
+0001edf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ee00: 2020 2020 6966 206d 6574 686f 6420 213d      if method !=
+0001ee10: 2022 6861 7264 223a 0a20 2020 2020 2020   "hard":.       
+0001ee20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ee30: 2066 6f72 2069 2069 6e20 6573 7469 6d61   for i in estima
+0001ee40: 746f 725f 6c69 7374 3a0a 2020 2020 2020  tor_list:.      
+0001ee50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ee60: 2020 2020 2020 6966 206e 6f74 2068 6173        if not has
+0001ee70: 6174 7472 2869 2c20 2270 7265 6469 6374  attr(i, "predict
+0001ee80: 5f70 726f 6261 2229 3a0a 2020 2020 2020  _proba"):.      
+0001ee90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eea0: 2020 2020 2020 2020 2020 6966 206d 6574            if met
+0001eeb0: 686f 6420 213d 2022 6175 746f 223a 0a20  hod != "auto":. 
+0001eec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eee0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+0001eef0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
 0001ef00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ef10: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001ef20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ef30: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001ef40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ef50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001ef60: 2e6c 6f67 6765 722e 696e 666f 280a 2020  .logger.info(.  
-0001ef70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ef80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ef90: 2020 2020 2020 6622 4573 7469 6d61 746f        f"Estimato
-0001efa0: 7220 7b69 7d20 646f 6573 6e27 7420 7375  r {i} doesn't su
-0001efb0: 7070 6f72 7420 7072 6f62 6162 696c 6974  pport probabilit
-0001efc0: 6965 732c 2066 616c 6c69 6e67 2062 6163  ies, falling bac
-0001efd0: 6b20 746f 2027 6861 7264 272e 220a 2020  k to 'hard'.".  
+0001ef10: 2020 2020 2020 2020 2020 2020 6622 4573              f"Es
+0001ef20: 7469 6d61 746f 7220 6c69 7374 2063 6f6e  timator list con
+0001ef30: 7461 696e 7320 6573 7469 6d61 746f 7220  tains estimator 
+0001ef40: 7b69 7d20 7468 6174 2064 6f65 736e 2774  {i} that doesn't
+0001ef50: 2073 7570 706f 7274 2070 726f 6261 6269   support probabi
+0001ef60: 6c69 7469 6573 2061 6e64 206d 6574 686f  lities and metho
+0001ef70: 6420 6973 2066 6f72 6365 6420 746f 2027  d is forced to '
+0001ef80: 736f 6674 272e 2045 6974 6865 7220 6368  soft'. Either ch
+0001ef90: 616e 6765 2074 6865 206d 6574 686f 6420  ange the method 
+0001efa0: 6f72 2064 726f 7020 7468 6520 6573 7469  or drop the esti
+0001efb0: 6d61 746f 722e 220a 2020 2020 2020 2020  mator.".        
+0001efc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001efd0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
 0001efe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f000: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0001eff0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0001f000: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
 0001f010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f020: 2020 2020 2020 2020 6d65 7468 6f64 203d          method =
-0001f030: 2022 6861 7264 220a 2020 2020 2020 2020   "hard".        
+0001f020: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+0001f030: 6765 722e 696e 666f 280a 2020 2020 2020  ger.info(.      
 0001f040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f050: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-0001f060: 6b0a 0a20 2020 2020 2020 2020 2020 2020  k..             
-0001f070: 2020 2020 2020 2020 2020 2069 6620 6d65             if me
-0001f080: 7468 6f64 203d 3d20 2261 7574 6f22 3a0a  thod == "auto":.
-0001f090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f0a0: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-0001f0b0: 6f64 203d 2022 736f 6674 220a 0a20 2020  od = "soft"..   
-0001f0c0: 2020 2020 2023 2063 6865 636b 696e 6720       # checking 
-0001f0d0: 666f 6c64 2070 6172 616d 6574 6572 0a20  fold parameter. 
-0001f0e0: 2020 2020 2020 2069 6620 666f 6c64 2069         if fold i
-0001f0f0: 7320 6e6f 7420 4e6f 6e65 2061 6e64 206e  s not None and n
-0001f100: 6f74 2028 0a20 2020 2020 2020 2020 2020  ot (.           
-0001f110: 2074 7970 6528 666f 6c64 2920 6973 2069   type(fold) is i
-0001f120: 6e74 206f 7220 6973 5f73 6b6c 6561 726e  nt or is_sklearn
-0001f130: 5f63 765f 6765 6e65 7261 746f 7228 666f  _cv_generator(fo
-0001f140: 6c64 290a 2020 2020 2020 2020 293a 0a20  ld).        ):. 
-0001f150: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0001f160: 2054 7970 6545 7272 6f72 280a 2020 2020   TypeError(.    
-0001f170: 2020 2020 2020 2020 2020 2020 2266 6f6c              "fol
-0001f180: 6420 7061 7261 6d65 7465 7220 6d75 7374  d parameter must
-0001f190: 2062 6520 6569 7468 6572 204e 6f6e 652c   be either None,
-0001f1a0: 2061 6e20 696e 7465 6765 7220 6f72 2061   an integer or a
-0001f1b0: 2073 6369 6b69 742d 6c65 6172 6e20 636f   scikit-learn co
-0001f1c0: 6d70 6174 6962 6c65 2043 5620 6765 6e65  mpatible CV gene
-0001f1d0: 7261 746f 7220 6f62 6a65 6374 2e22 0a20  rator object.". 
-0001f1e0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0001f1f0: 2020 2020 2020 2320 6368 6563 6b69 6e67        # checking
-0001f200: 2072 6f75 6e64 2070 6172 616d 6574 6572   round parameter
-0001f210: 0a20 2020 2020 2020 2069 6620 7479 7065  .        if type
-0001f220: 2872 6f75 6e64 2920 6973 206e 6f74 2069  (round) is not i
-0001f230: 6e74 3a0a 2020 2020 2020 2020 2020 2020  nt:.            
-0001f240: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-0001f250: 2252 6f75 6e64 2070 6172 616d 6574 6572  "Round parameter
-0001f260: 206f 6e6c 7920 6163 6365 7074 7320 696e   only accepts in
-0001f270: 7465 6765 7220 7661 6c75 652e 2229 0a0a  teger value.")..
-0001f280: 2020 2020 2020 2020 6966 2077 6569 6768          if weigh
-0001f290: 7473 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ts is not None:.
-0001f2a0: 2020 2020 2020 2020 2020 2020 6e75 6d5f              num_
-0001f2b0: 6573 7469 6d61 746f 7273 203d 206c 656e  estimators = len
-0001f2c0: 2865 7374 696d 6174 6f72 5f6c 6973 7429  (estimator_list)
-0001f2d0: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
-0001f2e0: 6865 636b 696e 6720 7765 6967 6874 7320  hecking weights 
-0001f2f0: 7061 7261 6d65 7465 720a 2020 2020 2020  parameter.      
-0001f300: 2020 2020 2020 6966 206c 656e 2877 6569        if len(wei
-0001f310: 6768 7473 2920 213d 206e 756d 5f65 7374  ghts) != num_est
-0001f320: 696d 6174 6f72 733a 0a20 2020 2020 2020  imators:.       
-0001f330: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0001f340: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-0001f350: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001f360: 7765 6967 6874 7320 7061 7261 6d65 7465  weights paramete
-0001f370: 7220 6d75 7374 2068 6176 6520 7468 6520  r must have the 
-0001f380: 7361 6d65 206c 656e 6774 6820 6173 2074  same length as t
-0001f390: 6865 2065 7374 696d 6174 6f72 5f6c 6973  he estimator_lis
-0001f3a0: 742e 220a 2020 2020 2020 2020 2020 2020  t.".            
-0001f3b0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0001f3c0: 2020 6966 206e 6f74 2061 6c6c 2828 6973    if not all((is
-0001f3d0: 696e 7374 616e 6365 2878 2c20 696e 7429  instance(x, int)
-0001f3e0: 206f 7220 6973 696e 7374 616e 6365 2878   or isinstance(x
-0001f3f0: 2c20 666c 6f61 7429 2920 666f 7220 7820  , float)) for x 
-0001f400: 696e 2077 6569 6768 7473 293a 0a20 2020  in weights):.   
-0001f410: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0001f420: 7365 2054 7970 6545 7272 6f72 2822 7765  se TypeError("we
-0001f430: 6967 6874 7320 6d75 7374 2063 6f6e 7461  ights must conta
-0001f440: 696e 206f 6e6c 7920 696e 7473 206f 7220  in only ints or 
-0001f450: 666c 6f61 7473 2e22 290a 0a20 2020 2020  floats.")..     
-0001f460: 2020 2023 2063 6865 636b 696e 6720 7665     # checking ve
-0001f470: 7262 6f73 6520 7061 7261 6d65 7465 720a  rbose parameter.
-0001f480: 2020 2020 2020 2020 6966 2074 7970 6528          if type(
-0001f490: 7665 7262 6f73 6529 2069 7320 6e6f 7420  verbose) is not 
-0001f4a0: 626f 6f6c 3a0a 2020 2020 2020 2020 2020  bool:.          
-0001f4b0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-0001f4c0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0001f4d0: 2020 2022 5665 7262 6f73 6520 7061 7261     "Verbose para
-0001f4e0: 6d65 7465 7220 6361 6e20 6f6e 6c79 2074  meter can only t
-0001f4f0: 616b 6520 6172 6775 6d65 6e74 2061 7320  ake argument as 
-0001f500: 5472 7565 206f 7220 4661 6c73 652e 220a  True or False.".
-0001f510: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0001f520: 2020 2020 2020 2023 2063 6865 636b 696e         # checkin
-0001f530: 6720 6f70 7469 6d69 7a65 2070 6172 616d  g optimize param
-0001f540: 6574 6572 0a20 2020 2020 2020 206f 7074  eter.        opt
-0001f550: 696d 697a 6520 3d20 7365 6c66 2e5f 6765  imize = self._ge
-0001f560: 745f 6d65 7472 6963 5f62 795f 6e61 6d65  t_metric_by_name
-0001f570: 5f6f 725f 6964 286f 7074 696d 697a 6529  _or_id(optimize)
-0001f580: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
-0001f590: 6d69 7a65 2069 7320 4e6f 6e65 3a0a 2020  mize is None:.  
-0001f5a0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001f5b0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-0001f5c0: 2020 2020 2020 2020 2020 2020 224f 7074              "Opt
-0001f5d0: 696d 697a 6520 6d65 7468 6f64 206e 6f74  imize method not
-0001f5e0: 2073 7570 706f 7274 6564 2e20 5365 6520   supported. See 
-0001f5f0: 646f 6373 7472 696e 6720 666f 7220 6c69  docstring for li
-0001f600: 7374 206f 6620 6176 6169 6c61 626c 6520  st of available 
-0001f610: 7061 7261 6d65 7465 7273 2e22 0a20 2020  parameters.".   
-0001f620: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0001f630: 2020 2020 2320 6368 6563 6b69 6e67 206f      # checking o
-0001f640: 7074 696d 697a 6520 7061 7261 6d65 7465  ptimize paramete
-0001f650: 7220 666f 7220 6d75 6c74 6963 6c61 7373  r for multiclass
-0001f660: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0001f670: 2e69 735f 6d75 6c74 6963 6c61 7373 3a0a  .is_multiclass:.
-0001f680: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0001f690: 6f74 206f 7074 696d 697a 652e 6973 5f6d  ot optimize.is_m
-0001f6a0: 756c 7469 636c 6173 733a 0a20 2020 2020  ulticlass:.     
-0001f6b0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0001f6c0: 2054 7970 6545 7272 6f72 280a 2020 2020   TypeError(.    
-0001f6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f6e0: 224f 7074 696d 697a 6174 696f 6e20 6d65  "Optimization me
-0001f6f0: 7472 6963 206e 6f74 2073 7570 706f 7274  tric not support
-0001f700: 6564 2066 6f72 206d 756c 7469 636c 6173  ed for multiclas
-0001f710: 7320 7072 6f62 6c65 6d73 2e20 5365 6520  s problems. See 
-0001f720: 646f 6373 7472 696e 6720 666f 7220 6c69  docstring for li
-0001f730: 7374 206f 6620 6f74 6865 7220 6f70 7469  st of other opti
-0001f740: 6d69 7a61 7469 6f6e 2070 6172 616d 6574  mization paramet
-0001f750: 6572 732e 220a 2020 2020 2020 2020 2020  ers.".          
-0001f760: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0001f770: 2023 2063 6865 636b 696e 6720 7265 7475   # checking retu
-0001f780: 726e 5f74 7261 696e 5f73 636f 7265 2070  rn_train_score p
-0001f790: 6172 616d 6574 6572 0a20 2020 2020 2020  arameter.       
-0001f7a0: 2069 6620 7479 7065 2872 6574 7572 6e5f   if type(return_
-0001f7b0: 7472 6169 6e5f 7363 6f72 6529 2069 7320  train_score) is 
-0001f7c0: 6e6f 7420 626f 6f6c 3a0a 2020 2020 2020  not bool:.      
-0001f7d0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-0001f7e0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0001f7f0: 2020 2020 2020 2022 7265 7475 726e 5f74         "return_t
-0001f800: 7261 696e 5f73 636f 7265 2063 616e 206f  rain_score can o
-0001f810: 6e6c 7920 7461 6b65 2061 7267 756d 656e  nly take argumen
-0001f820: 7420 6173 2054 7275 6520 6f72 2046 616c  t as True or Fal
-0001f830: 7365 220a 2020 2020 2020 2020 2020 2020  se".            
-0001f840: 290a 0a20 2020 2020 2020 2022 2222 0a0a  )..        """..
-0001f850: 2020 2020 2020 2020 4552 524f 5220 4841          ERROR HA
-0001f860: 4e44 4c49 4e47 2045 4e44 5320 4845 5245  NDLING ENDS HERE
-0001f870: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0001f880: 2020 2020 2020 6966 2073 656c 662e 5f6d        if self._m
-0001f890: 6c5f 7573 6563 6173 6520 3d3d 204d 4c55  l_usecase == MLU
-0001f8a0: 7365 6361 7365 2e54 494d 455f 5345 5249  secase.TIME_SERI
-0001f8b0: 4553 3a0a 2020 2020 2020 2020 2020 2020  ES:.            
-0001f8c0: 2320 4a75 7374 2072 6574 7572 6e20 7468  # Just return th
-0001f8d0: 6520 666f 6c64 2074 6f20 6372 6561 7465  e fold to create
-0001f8e0: 5f6d 6f64 656c 2e20 4974 2077 696c 6c20  _model. It will 
-0001f8f0: 646f 2074 6865 2072 6573 740a 2020 2020  do the rest.    
-0001f900: 2020 2020 2020 2020 2320 666f 6c64 203d          # fold =
-0001f910: 2066 6f6c 640a 2020 2020 2020 2020 2020   fold.          
-0001f920: 2020 7061 7373 0a20 2020 2020 2020 2065    pass.        e
-0001f930: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001f940: 2066 6f6c 6420 3d20 7365 6c66 2e5f 6765   fold = self._ge
-0001f950: 745f 6376 5f73 706c 6974 7465 7228 666f  t_cv_splitter(fo
-0001f960: 6c64 290a 0a20 2020 2020 2020 2067 726f  ld)..        gro
-0001f970: 7570 7320 3d20 7365 6c66 2e5f 6765 745f  ups = self._get_
-0001f980: 6772 6f75 7073 2867 726f 7570 7329 0a0a  groups(groups)..
-0001f990: 2020 2020 2020 2020 7072 6f67 7265 7373          progress
-0001f9a0: 5f61 7267 7320 3d20 7b22 6d61 7822 3a20  _args = {"max": 
-0001f9b0: 3220 2b20 347d 0a20 2020 2020 2020 2074  2 + 4}.        t
-0001f9c0: 696d 6573 7461 6d70 5374 7220 3d20 6461  imestampStr = da
-0001f9d0: 7465 7469 6d65 2e64 6174 6574 696d 652e  tetime.datetime.
-0001f9e0: 6e6f 7728 292e 7374 7266 7469 6d65 2822  now().strftime("
-0001f9f0: 2548 3a25 4d3a 2553 2229 0a20 2020 2020  %H:%M:%S").     
-0001fa00: 2020 206d 6f6e 6974 6f72 5f72 6f77 7320     monitor_rows 
-0001fa10: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
-0001fa20: 5b22 496e 6974 6961 7465 6422 2c20 222e  ["Initiated", ".
-0001fa30: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
-0001fa40: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
-0001fa50: 202e 222c 2074 696d 6573 7461 6d70 5374   .", timestampSt
-0001fa60: 725d 2c0a 2020 2020 2020 2020 2020 2020  r],.            
-0001fa70: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0001fa80: 2020 2253 7461 7475 7322 2c0a 2020 2020    "Status",.    
-0001fa90: 2020 2020 2020 2020 2020 2020 222e 202e              ". .
-0001faa0: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
-0001fab0: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
-0001fac0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0001fad0: 2020 2022 4c6f 6164 696e 6720 4465 7065     "Loading Depe
-0001fae0: 6e64 656e 6369 6573 222c 0a20 2020 2020  ndencies",.     
-0001faf0: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-0001fb00: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
-0001fb10: 2020 2020 2020 2020 2245 7374 696d 6174          "Estimat
-0001fb20: 6f72 222c 0a20 2020 2020 2020 2020 2020  or",.           
-0001fb30: 2020 2020 2022 2e20 2e20 2e20 2e20 2e20       ". . . . . 
-0001fb40: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
-0001fb50: 2e20 2e20 2e20 2e20 2e22 2c0a 2020 2020  . . . . .",.    
-0001fb60: 2020 2020 2020 2020 2020 2020 2243 6f6d              "Com
-0001fb70: 7069 6c69 6e67 204c 6962 7261 7279 222c  piling Library",
-0001fb80: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
-0001fb90: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
-0001fba0: 2020 6469 7370 6c61 7920 3d20 436f 6d6d    display = Comm
-0001fbb0: 6f6e 4469 7370 6c61 7928 0a20 2020 2020  onDisplay(.     
-0001fbc0: 2020 2020 2020 2076 6572 626f 7365 3d76         verbose=v
-0001fbd0: 6572 626f 7365 2c0a 2020 2020 2020 2020  erbose,.        
-0001fbe0: 2020 2020 6874 6d6c 5f70 6172 616d 3d73      html_param=s
-0001fbf0: 656c 662e 6874 6d6c 5f70 6172 616d 2c0a  elf.html_param,.
-0001fc00: 2020 2020 2020 2020 2020 2020 7072 6f67              prog
-0001fc10: 7265 7373 5f61 7267 733d 7072 6f67 7265  ress_args=progre
-0001fc20: 7373 5f61 7267 732c 0a20 2020 2020 2020  ss_args,.       
-0001fc30: 2020 2020 206d 6f6e 6974 6f72 5f72 6f77       monitor_row
-0001fc40: 733d 6d6f 6e69 746f 725f 726f 7773 2c0a  s=monitor_rows,.
-0001fc50: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0001fc60: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
-0001fc70: 6e66 6f28 2249 6d70 6f72 7469 6e67 206c  nfo("Importing l
-0001fc80: 6962 7261 7269 6573 2229 0a0a 2020 2020  ibraries")..    
-0001fc90: 2020 2020 6e70 2e72 616e 646f 6d2e 7365      np.random.se
-0001fca0: 6564 2873 656c 662e 7365 6564 290a 0a20  ed(self.seed).. 
-0001fcb0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
-0001fcc0: 6572 2e69 6e66 6f28 2243 6f70 7969 6e67  er.info("Copying
-0001fcd0: 2074 7261 696e 696e 6720 6461 7461 7365   training datase
-0001fce0: 7422 290a 0a20 2020 2020 2020 2023 2073  t")..        # s
-0001fcf0: 6574 7469 6e67 206f 7074 696d 697a 6520  etting optimize 
-0001fd00: 7061 7261 6d65 7465 720a 2020 2020 2020  parameter.      
-0001fd10: 2020 636f 6d70 6172 655f 6469 6d65 6e73    compare_dimens
-0001fd20: 696f 6e20 3d20 6f70 7469 6d69 7a65 2e64  ion = optimize.d
-0001fd30: 6973 706c 6179 5f6e 616d 650a 2020 2020  isplay_name.    
-0001fd40: 2020 2020 6f70 7469 6d69 7a65 203d 206f      optimize = o
-0001fd50: 7074 696d 697a 652e 7363 6f72 6572 0a0a  ptimize.scorer..
-0001fd60: 2020 2020 2020 2020 6469 7370 6c61 792e          display.
-0001fd70: 6d6f 7665 5f70 726f 6772 6573 7328 290a  move_progress().
-0001fd80: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001fd90: 2020 2020 204d 4f4e 4954 4f52 2055 5044       MONITOR UPD
-0001fda0: 4154 4520 5354 4152 5453 0a20 2020 2020  ATE STARTS.     
-0001fdb0: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-0001fdc0: 6469 7370 6c61 792e 7570 6461 7465 5f6d  display.update_m
-0001fdd0: 6f6e 6974 6f72 2831 2c20 2243 6f6d 7069  onitor(1, "Compi
-0001fde0: 6c69 6e67 2045 7374 696d 6174 6f72 7322  ling Estimators"
-0001fdf0: 290a 0a20 2020 2020 2020 2022 2222 0a20  )..        """. 
-0001fe00: 2020 2020 2020 204d 4f4e 4954 4f52 2055         MONITOR U
-0001fe10: 5044 4154 4520 454e 4453 0a20 2020 2020  PDATE ENDS.     
-0001fe20: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-0001fe30: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
-0001fe40: 2822 4765 7474 696e 6720 6d6f 6465 6c20  ("Getting model 
-0001fe50: 6e61 6d65 7322 290a 2020 2020 2020 2020  names").        
-0001fe60: 6573 7469 6d61 746f 725f 6469 6374 203d  estimator_dict =
-0001fe70: 207b 7d0a 2020 2020 2020 2020 666f 7220   {}.        for 
-0001fe80: 7820 696e 2065 7374 696d 6174 6f72 5f6c  x in estimator_l
-0001fe90: 6973 743a 0a20 2020 2020 2020 2020 2020  ist:.           
-0001fea0: 2078 203d 2067 6574 5f65 7374 696d 6174   x = get_estimat
-0001feb0: 6f72 5f66 726f 6d5f 6d65 7461 5f65 7374  or_from_meta_est
-0001fec0: 696d 6174 6f72 2878 290a 2020 2020 2020  imator(x).      
-0001fed0: 2020 2020 2020 6e61 6d65 203d 2073 656c        name = sel
-0001fee0: 662e 5f67 6574 5f6d 6f64 656c 5f6e 616d  f._get_model_nam
-0001fef0: 6528 7829 0a20 2020 2020 2020 2020 2020  e(x).           
-0001ff00: 2073 7566 6669 7820 3d20 310a 2020 2020   suffix = 1.    
-0001ff10: 2020 2020 2020 2020 6f72 6967 696e 616c          original
-0001ff20: 5f6e 616d 6520 3d20 6e61 6d65 0a20 2020  _name = name.   
-0001ff30: 2020 2020 2020 2020 2077 6869 6c65 206e           while n
-0001ff40: 616d 6520 696e 2065 7374 696d 6174 6f72  ame in estimator
-0001ff50: 5f64 6963 743a 0a20 2020 2020 2020 2020  _dict:.         
-0001ff60: 2020 2020 2020 206e 616d 6520 3d20 6622         name = f"
-0001ff70: 7b6f 7269 6769 6e61 6c5f 6e61 6d65 7d5f  {original_name}_
-0001ff80: 7b73 7566 6669 787d 220a 2020 2020 2020  {suffix}".      
-0001ff90: 2020 2020 2020 2020 2020 7375 6666 6978            suffix
-0001ffa0: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
-0001ffb0: 2020 6573 7469 6d61 746f 725f 6469 6374    estimator_dict
-0001ffc0: 5b6e 616d 655d 203d 2078 0a0a 2020 2020  [name] = x..    
-0001ffd0: 2020 2020 6573 7469 6d61 746f 725f 6c69      estimator_li
-0001ffe0: 7374 203d 206c 6973 7428 6573 7469 6d61  st = list(estima
-0001fff0: 746f 725f 6469 6374 2e69 7465 6d73 2829  tor_dict.items()
-00020000: 290a 0a20 2020 2020 2020 2069 6620 7365  )..        if se
-00020010: 6c66 2e5f 6d6c 5f75 7365 6361 7365 203d  lf._ml_usecase =
-00020020: 3d20 4d4c 5573 6563 6173 652e 5449 4d45  = MLUsecase.TIME
-00020030: 5f53 4552 4945 533a 0a20 2020 2020 2020  _SERIES:.       
-00020040: 2020 2020 2076 6f74 696e 675f 6d6f 6465       voting_mode
-00020050: 6c5f 6465 6669 6e69 7469 6f6e 203d 2073  l_definition = s
-00020060: 656c 662e 5f61 6c6c 5f6d 6f64 656c 735f  elf._all_models_
-00020070: 696e 7465 726e 616c 5b22 656e 7365 6d62  internal["ensemb
-00020080: 6c65 5f66 6f72 6563 6173 7465 7222 5d0a  le_forecaster"].
-00020090: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000200a0: 2020 2020 2020 2020 2020 766f 7469 6e67            voting
-000200b0: 5f6d 6f64 656c 5f64 6566 696e 6974 696f  _model_definitio
-000200c0: 6e20 3d20 7365 6c66 2e5f 616c 6c5f 6d6f  n = self._all_mo
-000200d0: 6465 6c73 5f69 6e74 6572 6e61 6c5b 2256  dels_internal["V
-000200e0: 6f74 696e 6722 5d0a 0a20 2020 2020 2020  oting"]..       
-000200f0: 2069 6620 7365 6c66 2e5f 6d6c 5f75 7365   if self._ml_use
-00020100: 6361 7365 203d 3d20 4d4c 5573 6563 6173  case == MLUsecas
-00020110: 652e 434c 4153 5349 4649 4341 5449 4f4e  e.CLASSIFICATION
-00020120: 3a0a 2020 2020 2020 2020 2020 2020 6d6f  :.            mo
-00020130: 6465 6c20 3d20 766f 7469 6e67 5f6d 6f64  del = voting_mod
-00020140: 656c 5f64 6566 696e 6974 696f 6e2e 636c  el_definition.cl
-00020150: 6173 735f 6465 6628 0a20 2020 2020 2020  ass_def(.       
-00020160: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
-00020170: 6f72 733d 6573 7469 6d61 746f 725f 6c69  ors=estimator_li
-00020180: 7374 2c20 766f 7469 6e67 3d6d 6574 686f  st, voting=metho
-00020190: 642c 206e 5f6a 6f62 733d 7365 6c66 2e67  d, n_jobs=self.g
-000201a0: 7075 5f6e 5f6a 6f62 735f 7061 7261 6d0a  pu_n_jobs_param.
-000201b0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000201c0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-000201d0: 5f6d 6c5f 7573 6563 6173 6520 3d3d 204d  _ml_usecase == M
-000201e0: 4c55 7365 6361 7365 2e54 494d 455f 5345  LUsecase.TIME_SE
-000201f0: 5249 4553 3a0a 2020 2020 2020 2020 2020  RIES:.          
-00020200: 2020 6d6f 6465 6c20 3d20 766f 7469 6e67    model = voting
-00020210: 5f6d 6f64 656c 5f64 6566 696e 6974 696f  _model_definitio
-00020220: 6e2e 636c 6173 735f 6465 6628 0a20 2020  n.class_def(.   
-00020230: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00020240: 6563 6173 7465 7273 3d65 7374 696d 6174  ecasters=estimat
-00020250: 6f72 5f6c 6973 742c 0a20 2020 2020 2020  or_list,.       
-00020260: 2020 2020 2020 2020 206d 6574 686f 643d           method=
-00020270: 6d65 7468 6f64 2c0a 2020 2020 2020 2020  method,.        
-00020280: 2020 2020 2020 2020 7765 6967 6874 733d          weights=
-00020290: 7765 6967 6874 732c 0a20 2020 2020 2020  weights,.       
-000202a0: 2020 2020 2020 2020 206e 5f6a 6f62 733d           n_jobs=
-000202b0: 7365 6c66 2e67 7075 5f6e 5f6a 6f62 735f  self.gpu_n_jobs_
-000202c0: 7061 7261 6d2c 0a20 2020 2020 2020 2020  param,.         
-000202d0: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
-000202e0: 653a 0a20 2020 2020 2020 2020 2020 206d  e:.            m
-000202f0: 6f64 656c 203d 2076 6f74 696e 675f 6d6f  odel = voting_mo
-00020300: 6465 6c5f 6465 6669 6e69 7469 6f6e 2e63  del_definition.c
-00020310: 6c61 7373 5f64 6566 280a 2020 2020 2020  lass_def(.      
-00020320: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-00020330: 746f 7273 3d65 7374 696d 6174 6f72 5f6c  tors=estimator_l
-00020340: 6973 742c 206e 5f6a 6f62 733d 7365 6c66  ist, n_jobs=self
-00020350: 2e67 7075 5f6e 5f6a 6f62 735f 7061 7261  .gpu_n_jobs_para
-00020360: 6d0a 2020 2020 2020 2020 2020 2020 290a  m.            ).
-00020370: 0a20 2020 2020 2020 2064 6973 706c 6179  .        display
-00020380: 2e75 7064 6174 655f 6d6f 6e69 746f 7228  .update_monitor(
-00020390: 322c 2076 6f74 696e 675f 6d6f 6465 6c5f  2, voting_model_
-000203a0: 6465 6669 6e69 7469 6f6e 2e6e 616d 6529  definition.name)
-000203b0: 0a0a 2020 2020 2020 2020 6469 7370 6c61  ..        displa
-000203c0: 792e 6d6f 7665 5f70 726f 6772 6573 7328  y.move_progress(
-000203d0: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-000203e0: 6c6f 6767 6572 2e69 6e66 6f28 0a20 2020  logger.info(.   
-000203f0: 2020 2020 2020 2020 2022 5375 6250 726f           "SubPro
-00020400: 6365 7373 2063 7265 6174 655f 6d6f 6465  cess create_mode
-00020410: 6c28 2920 6361 6c6c 6564 203d 3d3d 3d3d  l() called =====
-00020420: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00020430: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d22 0a20  =============". 
-00020440: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00020450: 206d 6f64 656c 2c20 6d6f 6465 6c5f 6669   model, model_fi
-00020460: 745f 7469 6d65 203d 2073 656c 662e 5f63  t_time = self._c
-00020470: 7265 6174 655f 6d6f 6465 6c28 0a20 2020  reate_model(.   
-00020480: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
-00020490: 6f72 3d6d 6f64 656c 2c0a 2020 2020 2020  or=model,.      
-000204a0: 2020 2020 2020 7379 7374 656d 3d46 616c        system=Fal
-000204b0: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-000204c0: 6469 7370 6c61 793d 6469 7370 6c61 792c  display=display,
-000204d0: 0a20 2020 2020 2020 2020 2020 2066 6f6c  .            fol
-000204e0: 643d 666f 6c64 2c0a 2020 2020 2020 2020  d=fold,.        
-000204f0: 2020 2020 726f 756e 643d 726f 756e 642c      round=round,
-00020500: 0a20 2020 2020 2020 2020 2020 2066 6974  .            fit
-00020510: 5f6b 7761 7267 733d 6669 745f 6b77 6172  _kwargs=fit_kwar
-00020520: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
-00020530: 6772 6f75 7073 3d67 726f 7570 732c 0a20  groups=groups,. 
-00020540: 2020 2020 2020 2020 2020 2070 726f 6261             proba
-00020550: 6269 6c69 7479 5f74 6872 6573 686f 6c64  bility_threshold
-00020560: 3d70 726f 6261 6269 6c69 7479 5f74 6872  =probability_thr
-00020570: 6573 686f 6c64 2c0a 2020 2020 2020 2020  eshold,.        
-00020580: 2020 2020 7265 7475 726e 5f74 7261 696e      return_train
-00020590: 5f73 636f 7265 3d72 6574 7572 6e5f 7472  _score=return_tr
-000205a0: 6169 6e5f 7363 6f72 652c 0a20 2020 2020  ain_score,.     
-000205b0: 2020 2029 0a0a 2020 2020 2020 2020 6d6f     )..        mo
-000205c0: 6465 6c5f 7265 7375 6c74 7320 3d20 7365  del_results = se
-000205d0: 6c66 2e70 756c 6c28 290a 2020 2020 2020  lf.pull().      
-000205e0: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
-000205f0: 666f 280a 2020 2020 2020 2020 2020 2020  fo(.            
-00020600: 2253 7562 5072 6f63 6573 7320 6372 6561  "SubProcess crea
-00020610: 7465 5f6d 6f64 656c 2829 2065 6e64 203d  te_model() end =
-00020620: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00020630: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00020640: 3d22 0a20 2020 2020 2020 2029 0a0a 2020  =".        )..  
-00020650: 2020 2020 2020 2320 656e 6420 7275 6e74        # end runt
-00020660: 696d 650a 2020 2020 2020 2020 7275 6e74  ime.        runt
-00020670: 696d 655f 656e 6420 3d20 7469 6d65 2e74  ime_end = time.t
-00020680: 696d 6528 290a 2020 2020 2020 2020 7275  ime().        ru
-00020690: 6e74 696d 6520 3d20 6e70 2e61 7272 6179  ntime = np.array
-000206a0: 2872 756e 7469 6d65 5f65 6e64 202d 2072  (runtime_end - r
-000206b0: 756e 7469 6d65 5f73 7461 7274 292e 726f  untime_start).ro
-000206c0: 756e 6428 3229 0a0a 2020 2020 2020 2020  und(2)..        
-000206d0: 2320 6461 7368 626f 6172 6420 6c6f 6767  # dashboard logg
-000206e0: 696e 670a 2020 2020 2020 2020 6966 2073  ing.        if s
-000206f0: 656c 662e 6c6f 6767 696e 675f 7061 7261  elf.logging_para
-00020700: 6d3a 0a20 2020 2020 2020 2020 2020 2069  m:.            i
-00020710: 6e64 6963 6573 203d 2073 656c 662e 5f67  ndices = self._g
-00020720: 6574 5f72 6574 7572 6e5f 7472 6169 6e5f  et_return_train_
-00020730: 7363 6f72 655f 696e 6469 6365 735f 666f  score_indices_fo
-00020740: 725f 6c6f 6767 696e 6728 0a20 2020 2020  r_logging(.     
-00020750: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00020760: 6e5f 7472 6169 6e5f 7363 6f72 653d 7265  n_train_score=re
-00020770: 7475 726e 5f74 7261 696e 5f73 636f 7265  turn_train_score
-00020780: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00020790: 2020 2020 2020 2020 2020 2061 7667 735f             avgs_
-000207a0: 6469 6374 5f6c 6f67 203d 207b 6b3a 2076  dict_log = {k: v
-000207b0: 2066 6f72 206b 2c20 7620 696e 206d 6f64   for k, v in mod
-000207c0: 656c 5f72 6573 756c 7473 2e6c 6f63 5b69  el_results.loc[i
-000207d0: 6e64 6963 6573 5d2e 6974 656d 7328 297d  ndices].items()}
-000207e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000207f0: 662e 6c6f 6767 696e 675f 7061 7261 6d2e  f.logging_param.
-00020800: 6c6f 675f 6d6f 6465 6c5f 636f 6d70 6172  log_model_compar
-00020810: 6973 6f6e 286d 6f64 656c 5f72 6573 756c  ison(model_resul
-00020820: 7473 2c20 2262 6c65 6e64 5f6d 6f64 656c  ts, "blend_model
-00020830: 7322 290a 0a20 2020 2020 2020 2020 2020  s")..           
-00020840: 2073 656c 662e 5f6c 6f67 5f6d 6f64 656c   self._log_model
-00020850: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00020860: 2020 6d6f 6465 6c3d 6d6f 6465 6c2c 0a20    model=model,. 
-00020870: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00020880: 6f64 656c 5f72 6573 756c 7473 3d6d 6f64  odel_results=mod
-00020890: 656c 5f72 6573 756c 7473 2c0a 2020 2020  el_results,.    
-000208a0: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
-000208b0: 655f 6469 6374 3d61 7667 735f 6469 6374  e_dict=avgs_dict
-000208c0: 5f6c 6f67 2c0a 2020 2020 2020 2020 2020  _log,.          
-000208d0: 2020 2020 2020 736f 7572 6365 3d22 626c        source="bl
-000208e0: 656e 645f 6d6f 6465 6c73 222c 0a20 2020  end_models",.   
-000208f0: 2020 2020 2020 2020 2020 2020 2072 756e               run
-00020900: 7469 6d65 3d72 756e 7469 6d65 2c0a 2020  time=runtime,.  
-00020910: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-00020920: 6465 6c5f 6669 745f 7469 6d65 3d6d 6f64  del_fit_time=mod
-00020930: 656c 5f66 6974 5f74 696d 652c 0a20 2020  el_fit_time,.   
-00020940: 2020 2020 2020 2020 2020 2020 2070 6970               pip
-00020950: 656c 696e 653d 7365 6c66 2e70 6970 656c  eline=self.pipel
-00020960: 696e 652c 0a20 2020 2020 2020 2020 2020  ine,.           
-00020970: 2020 2020 206c 6f67 5f70 6c6f 7473 3d73       log_plots=s
-00020980: 656c 662e 6c6f 675f 706c 6f74 735f 7061  elf.log_plots_pa
-00020990: 7261 6d2c 0a20 2020 2020 2020 2020 2020  ram,.           
-000209a0: 2020 2020 2064 6973 706c 6179 3d64 6973       display=dis
-000209b0: 706c 6179 2c0a 2020 2020 2020 2020 2020  play,.          
-000209c0: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
-000209d0: 6368 6f6f 7365 5f62 6574 7465 723a 0a20  choose_better:. 
-000209e0: 2020 2020 2020 2020 2020 206e 6577 5f6d             new_m
-000209f0: 6f64 656c 203d 2073 656c 662e 5f63 686f  odel = self._cho
-00020a00: 6f73 655f 6265 7474 6572 280a 2020 2020  ose_better(.    
-00020a10: 2020 2020 2020 2020 2020 2020 5b28 6d6f              [(mo
-00020a20: 6465 6c2c 206d 6f64 656c 5f72 6573 756c  del, model_resul
-00020a30: 7473 295d 202b 2065 7374 696d 6174 6f72  ts)] + estimator
-00020a40: 5f6c 6973 742c 0a20 2020 2020 2020 2020  _list,.         
-00020a50: 2020 2020 2020 2063 6f6d 7061 7265 5f64         compare_d
-00020a60: 696d 656e 7369 6f6e 2c0a 2020 2020 2020  imension,.      
-00020a70: 2020 2020 2020 2020 2020 666f 6c64 2c0a            fold,.
-00020a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020a90: 6772 6f75 7073 3d67 726f 7570 732c 0a20  groups=groups,. 
-00020aa0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00020ab0: 6974 5f6b 7761 7267 733d 6669 745f 6b77  it_kwargs=fit_kw
-00020ac0: 6172 6773 2c0a 2020 2020 2020 2020 2020  args,.          
-00020ad0: 2020 2020 2020 6469 7370 6c61 793d 6469        display=di
-00020ae0: 7370 6c61 792c 0a20 2020 2020 2020 2020  splay,.         
-00020af0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00020b00: 2069 6620 6e65 775f 6d6f 6465 6c20 6973   if new_model is
-00020b10: 206e 6f74 206d 6f64 656c 3a0a 2020 2020   not model:.    
-00020b20: 2020 2020 2020 2020 2020 2020 6d73 6720              msg 
-00020b30: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-00020b40: 2020 2020 2020 2020 224f 7269 6769 6e61          "Origina
-00020b50: 6c20 6d6f 6465 6c20 7761 7320 6265 7474  l model was bett
-00020b60: 6572 2074 6861 6e20 7468 6520 626c 656e  er than the blen
-00020b70: 6465 6420 6d6f 6465 6c2c 2068 656e 6365  ded model, hence
-00020b80: 2069 7420 7769 6c6c 2062 6520 7265 7475   it will be retu
-00020b90: 726e 6564 2e20 220a 2020 2020 2020 2020  rned. ".        
-00020ba0: 2020 2020 2020 2020 2020 2020 224e 4f54              "NOT
-00020bb0: 453a 2054 6865 2064 6973 706c 6179 206d  E: The display m
-00020bc0: 6574 7269 6373 2061 7265 2066 6f72 2074  etrics are for t
-00020bd0: 6865 2062 6c65 6e64 6564 206d 6f64 656c  he blended model
-00020be0: 2028 6e6f 7420 7468 6520 6f72 6967 696e   (not the origin
-00020bf0: 616c 206f 6e65 292e 220a 2020 2020 2020  al one).".      
-00020c00: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00020c10: 2020 2020 2020 2020 2020 2020 6966 2076              if v
-00020c20: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
-00020c30: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00020c40: 7428 6d73 6729 0a20 2020 2020 2020 2020  t(msg).         
-00020c50: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
-00020c60: 6572 2e69 6e66 6f28 6d73 6729 0a20 2020  er.info(msg).   
-00020c70: 2020 2020 2020 2020 206d 6f64 656c 203d           model =
-00020c80: 206e 6577 5f6d 6f64 656c 0a0a 2020 2020   new_model..    
-00020c90: 2020 2020 6d6f 6465 6c5f 7265 7375 6c74      model_result
-00020ca0: 7320 3d20 7365 6c66 2e5f 6869 6768 6c69  s = self._highli
-00020cb0: 6768 745f 616e 645f 726f 756e 645f 6d6f  ght_and_round_mo
-00020cc0: 6465 6c5f 7265 7375 6c74 7328 0a20 2020  del_results(.   
-00020cd0: 2020 2020 2020 2020 206d 6f64 656c 5f72           model_r
-00020ce0: 6573 756c 7473 2c20 7265 7475 726e 5f74  esults, return_t
-00020cf0: 7261 696e 5f73 636f 7265 2c20 726f 756e  rain_score, roun
-00020d00: 640a 2020 2020 2020 2020 290a 2020 2020  d.        ).    
-00020d10: 2020 2020 6469 7370 6c61 792e 6469 7370      display.disp
-00020d20: 6c61 7928 6d6f 6465 6c5f 7265 7375 6c74  lay(model_result
-00020d30: 7329 0a0a 2020 2020 2020 2020 7365 6c66  s)..        self
-00020d40: 2e6c 6f67 6765 722e 696e 666f 280a 2020  .logger.info(.  
-00020d50: 2020 2020 2020 2020 2020 6622 5f6d 6173            f"_mas
-00020d60: 7465 725f 6d6f 6465 6c5f 636f 6e74 6169  ter_model_contai
-00020d70: 6e65 723a 207b 6c65 6e28 7365 6c66 2e5f  ner: {len(self._
-00020d80: 6d61 7374 6572 5f6d 6f64 656c 5f63 6f6e  master_model_con
-00020d90: 7461 696e 6572 297d 220a 2020 2020 2020  tainer)}".      
-00020da0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-00020db0: 2e6c 6f67 6765 722e 696e 666f 2866 225f  .logger.info(f"_
-00020dc0: 6469 7370 6c61 795f 636f 6e74 6169 6e65  display_containe
-00020dd0: 723a 207b 6c65 6e28 7365 6c66 2e5f 6469  r: {len(self._di
-00020de0: 7370 6c61 795f 636f 6e74 6169 6e65 7229  splay_container)
-00020df0: 7d22 290a 0a20 2020 2020 2020 2073 656c  }")..        sel
-00020e00: 662e 6c6f 6767 6572 2e69 6e66 6f28 7374  f.logger.info(st
-00020e10: 7228 6d6f 6465 6c29 290a 2020 2020 2020  r(model)).      
-00020e20: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
-00020e30: 666f 280a 2020 2020 2020 2020 2020 2020  fo(.            
-00020e40: 2262 6c65 6e64 5f6d 6f64 656c 7328 2920  "blend_models() 
-00020e50: 7375 6363 6573 7366 756c 6c79 2063 6f6d  successfully com
-00020e60: 706c 6574 6564 2e2e 2e2e 2e2e 2e2e 2e2e  pleted..........
-00020e70: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00020e80: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 220a 2020  ............".  
-00020e90: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00020ea0: 2067 632e 636f 6c6c 6563 7428 290a 2020   gc.collect().  
-00020eb0: 2020 2020 2020 7265 7475 726e 206d 6f64        return mod
-00020ec0: 656c 0a0a 2020 2020 6465 6620 7374 6163  el..    def stac
-00020ed0: 6b5f 6d6f 6465 6c73 280a 2020 2020 2020  k_models(.      
-00020ee0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00020ef0: 6573 7469 6d61 746f 725f 6c69 7374 3a20  estimator_list: 
-00020f00: 6c69 7374 2c0a 2020 2020 2020 2020 6d65  list,.        me
-00020f10: 7461 5f6d 6f64 656c 3d4e 6f6e 652c 0a20  ta_model=None,. 
-00020f20: 2020 2020 2020 206d 6574 615f 6d6f 6465         meta_mode
-00020f30: 6c5f 666f 6c64 3a20 4f70 7469 6f6e 616c  l_fold: Optional
-00020f40: 5b55 6e69 6f6e 5b69 6e74 2c20 416e 795d  [Union[int, Any]
-00020f50: 5d20 3d20 352c 0a20 2020 2020 2020 2066  ] = 5,.        f
-00020f60: 6f6c 643a 204f 7074 696f 6e61 6c5b 556e  old: Optional[Un
-00020f70: 696f 6e5b 696e 742c 2041 6e79 5d5d 203d  ion[int, Any]] =
-00020f80: 204e 6f6e 652c 0a20 2020 2020 2020 2072   None,.        r
-00020f90: 6f75 6e64 3a20 696e 7420 3d20 342c 0a20  ound: int = 4,. 
-00020fa0: 2020 2020 2020 206d 6574 686f 643a 2073         method: s
-00020fb0: 7472 203d 2022 6175 746f 222c 0a20 2020  tr = "auto",.   
-00020fc0: 2020 2020 2072 6573 7461 636b 3a20 626f       restack: bo
-00020fd0: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-00020fe0: 2020 2020 6368 6f6f 7365 5f62 6574 7465      choose_bette
-00020ff0: 723a 2062 6f6f 6c20 3d20 4661 6c73 652c  r: bool = False,
-00021000: 0a20 2020 2020 2020 206f 7074 696d 697a  .        optimiz
-00021010: 653a 2073 7472 203d 2022 4163 6375 7261  e: str = "Accura
-00021020: 6379 222c 0a20 2020 2020 2020 2066 6974  cy",.        fit
-00021030: 5f6b 7761 7267 733a 204f 7074 696f 6e61  _kwargs: Optiona
-00021040: 6c5b 6469 6374 5d20 3d20 4e6f 6e65 2c0a  l[dict] = None,.
-00021050: 2020 2020 2020 2020 6772 6f75 7073 3a20          groups: 
-00021060: 4f70 7469 6f6e 616c 5b55 6e69 6f6e 5b73  Optional[Union[s
-00021070: 7472 2c20 416e 795d 5d20 3d20 4e6f 6e65  tr, Any]] = None
-00021080: 2c0a 2020 2020 2020 2020 7072 6f62 6162  ,.        probab
-00021090: 696c 6974 795f 7468 7265 7368 6f6c 643a  ility_threshold:
-000210a0: 204f 7074 696f 6e61 6c5b 666c 6f61 745d   Optional[float]
-000210b0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-000210c0: 2076 6572 626f 7365 3a20 626f 6f6c 203d   verbose: bool =
-000210d0: 2054 7275 652c 0a20 2020 2020 2020 2072   True,.        r
-000210e0: 6574 7572 6e5f 7472 6169 6e5f 7363 6f72  eturn_train_scor
-000210f0: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
-00021100: 0a20 2020 2029 202d 3e20 416e 793a 0a0a  .    ) -> Any:..
-00021110: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00021120: 2020 2020 5468 6973 2066 756e 6374 696f      This functio
-00021130: 6e20 7472 6169 6e73 2061 206d 6574 6120  n trains a meta 
-00021140: 6d6f 6465 6c20 616e 6420 7363 6f72 6573  model and scores
-00021150: 2069 7420 7573 696e 6720 4372 6f73 7320   it using Cross 
-00021160: 5661 6c69 6461 7469 6f6e 2e0a 2020 2020  Validation..    
-00021170: 2020 2020 5468 6520 7072 6564 6963 7469      The predicti
-00021180: 6f6e 7320 6672 6f6d 2074 6865 2062 6173  ons from the bas
-00021190: 6520 6c65 7665 6c20 6d6f 6465 6c73 2061  e level models a
-000211a0: 7320 7061 7373 6564 2069 6e20 7468 6520  s passed in the 
-000211b0: 6573 7469 6d61 746f 725f 6c69 7374 2070  estimator_list p
-000211c0: 6172 616d 6574 6572 0a20 2020 2020 2020  arameter.       
-000211d0: 2061 7265 2075 7365 6420 6173 2069 6e70   are used as inp
-000211e0: 7574 2066 6561 7475 7265 7320 666f 7220  ut features for 
-000211f0: 7468 6520 6d65 7461 206d 6f64 656c 2e20  the meta model. 
-00021200: 5468 6520 7265 7374 6163 6b69 6e67 2070  The restacking p
-00021210: 6172 616d 6574 6572 2063 6f6e 7472 6f6c  arameter control
-00021220: 730a 2020 2020 2020 2020 7468 6520 6162  s.        the ab
-00021230: 696c 6974 7920 746f 2065 7870 6f73 6520  ility to expose 
-00021240: 7261 7720 6665 6174 7572 6573 2074 6f20  raw features to 
-00021250: 7468 6520 6d65 7461 206d 6f64 656c 2077  the meta model w
-00021260: 6865 6e20 7365 7420 746f 2054 7275 650a  hen set to True.
-00021270: 2020 2020 2020 2020 2864 6566 6175 6c74          (default
-00021280: 203d 2046 616c 7365 292e 0a0a 2020 2020   = False)...    
-00021290: 2020 2020 5468 6520 6f75 7470 7574 2070      The output p
-000212a0: 7269 6e74 7320 7468 6520 7363 6f72 6520  rints the score 
-000212b0: 6772 6964 2074 6861 7420 7368 6f77 7320  grid that shows 
-000212c0: 4163 6375 7261 6379 2c20 4155 432c 2052  Accuracy, AUC, R
-000212d0: 6563 616c 6c2c 2050 7265 6369 7369 6f6e  ecall, Precision
-000212e0: 2c0a 2020 2020 2020 2020 4631 2c20 4b61  ,.        F1, Ka
-000212f0: 7070 6120 616e 6420 4d43 4320 6279 2066  ppa and MCC by f
-00021300: 6f6c 6420 2864 6566 6175 6c74 203d 2031  old (default = 1
-00021310: 3020 466f 6c64 7329 2e0a 0a20 2020 2020  0 Folds)...     
-00021320: 2020 2054 6869 7320 6675 6e63 7469 6f6e     This function
-00021330: 2072 6574 7572 6e73 2061 2074 7261 696e   returns a train
-00021340: 6564 206d 6f64 656c 206f 626a 6563 742e  ed model object.
-00021350: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00021360: 650a 2020 2020 2020 2020 2d2d 2d2d 2d2d  e.        ------
-00021370: 2d0a 2020 2020 2020 2020 3e3e 3e20 6672  -.        >>> fr
-00021380: 6f6d 2070 7963 6172 6574 2e64 6174 6173  om pycaret.datas
-00021390: 6574 7320 696d 706f 7274 2067 6574 5f64  ets import get_d
-000213a0: 6174 610a 2020 2020 2020 2020 3e3e 3e20  ata.        >>> 
-000213b0: 6a75 6963 6520 3d20 6765 745f 6461 7461  juice = get_data
-000213c0: 2827 6a75 6963 6527 290a 2020 2020 2020  ('juice').      
-000213d0: 2020 3e3e 3e20 6578 7065 7269 6d65 6e74    >>> experiment
-000213e0: 5f6e 616d 6520 3d20 7365 7475 7028 6461  _name = setup(da
-000213f0: 7461 203d 206a 7569 6365 2c20 2074 6172  ta = juice,  tar
-00021400: 6765 7420 3d20 2750 7572 6368 6173 6527  get = 'Purchase'
-00021410: 290a 2020 2020 2020 2020 3e3e 3e20 6474  ).        >>> dt
-00021420: 203d 2063 7265 6174 655f 6d6f 6465 6c28   = create_model(
-00021430: 2764 7427 290a 2020 2020 2020 2020 3e3e  'dt').        >>
-00021440: 3e20 7266 203d 2063 7265 6174 655f 6d6f  > rf = create_mo
-00021450: 6465 6c28 2772 6627 290a 2020 2020 2020  del('rf').      
-00021460: 2020 3e3e 3e20 6164 6120 3d20 6372 6561    >>> ada = crea
-00021470: 7465 5f6d 6f64 656c 2827 6164 6127 290a  te_model('ada').
-00021480: 2020 2020 2020 2020 3e3e 3e20 7269 6467          >>> ridg
-00021490: 6520 3d20 6372 6561 7465 5f6d 6f64 656c  e = create_model
-000214a0: 2827 7269 6467 6527 290a 2020 2020 2020  ('ridge').      
-000214b0: 2020 3e3e 3e20 6b6e 6e20 3d20 6372 6561    >>> knn = crea
-000214c0: 7465 5f6d 6f64 656c 2827 6b6e 6e27 290a  te_model('knn').
-000214d0: 2020 2020 2020 2020 3e3e 3e20 7374 6163          >>> stac
-000214e0: 6b65 645f 6d6f 6465 6c73 203d 2073 7461  ked_models = sta
-000214f0: 636b 5f6d 6f64 656c 7328 6573 7469 6d61  ck_models(estima
-00021500: 746f 725f 6c69 7374 3d5b 6474 2c72 662c  tor_list=[dt,rf,
-00021510: 6164 612c 7269 6467 652c 6b6e 6e5d 290a  ada,ridge,knn]).
-00021520: 0a20 2020 2020 2020 2054 6869 7320 7769  .        This wi
-00021530: 6c6c 2063 7265 6174 6520 6120 6d65 7461  ll create a meta
-00021540: 206d 6f64 656c 2074 6861 7420 7769 6c6c   model that will
-00021550: 2075 7365 2074 6865 2070 7265 6469 6374   use the predict
-00021560: 696f 6e73 206f 6620 616c 6c20 7468 650a  ions of all the.
-00021570: 2020 2020 2020 2020 6d6f 6465 6c73 2070          models p
-00021580: 726f 7669 6465 6420 696e 2065 7374 696d  rovided in estim
-00021590: 6174 6f72 5f6c 6973 7420 7061 7261 6d2e  ator_list param.
-000215a0: 2042 7920 6465 6661 756c 742c 2074 6865   By default, the
-000215b0: 206d 6574 6120 6d6f 6465 6c20 6973 0a20   meta model is. 
-000215c0: 2020 2020 2020 204c 6f67 6973 7469 6320         Logistic 
-000215d0: 5265 6772 6573 7369 6f6e 2062 7574 2063  Regression but c
-000215e0: 616e 2062 6520 6368 616e 6765 6420 7769  an be changed wi
-000215f0: 7468 206d 6574 615f 6d6f 6465 6c20 7061  th meta_model pa
-00021600: 7261 6d2e 0a0a 2020 2020 2020 2020 5061  ram...        Pa
-00021610: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-00021620: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00021630: 2020 2020 6573 7469 6d61 746f 725f 6c69      estimator_li
-00021640: 7374 203a 206c 6973 7420 6f66 206f 626a  st : list of obj
-00021650: 6563 7473 0a0a 2020 2020 2020 2020 6d65  ects..        me
-00021660: 7461 5f6d 6f64 656c 203a 206f 626a 6563  ta_model : objec
-00021670: 742c 2064 6566 6175 6c74 203d 204e 6f6e  t, default = Non
-00021680: 650a 2020 2020 2020 2020 2020 2020 4966  e.            If
-00021690: 2073 6574 2074 6f20 4e6f 6e65 2c20 4c6f   set to None, Lo
-000216a0: 6769 7374 6963 2052 6567 7265 7373 696f  gistic Regressio
-000216b0: 6e20 6973 2075 7365 6420 6173 2061 206d  n is used as a m
-000216c0: 6574 6120 6d6f 6465 6c2e 0a0a 2020 2020  eta model...    
-000216d0: 2020 2020 666f 6c64 3a20 696e 7420 6f72      fold: int or
-000216e0: 2073 6369 6b69 742d 6c65 6172 6e20 636f   scikit-learn co
-000216f0: 6d70 6174 6962 6c65 2043 5620 6765 6e65  mpatible CV gene
-00021700: 7261 746f 722c 2064 6566 6175 6c74 203d  rator, default =
-00021710: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
-00021720: 2020 436f 6e74 726f 6c73 2063 726f 7373    Controls cross
-00021730: 2d76 616c 6964 6174 696f 6e2e 2049 6620  -validation. If 
-00021740: 4e6f 6e65 2c20 7468 6520 4356 2067 656e  None, the CV gen
-00021750: 6572 6174 6f72 2069 6e20 7468 6520 6060  erator in the ``
-00021760: 666f 6c64 5f73 7472 6174 6567 7960 600a  fold_strategy``.
-00021770: 2020 2020 2020 2020 2020 2020 7061 7261              para
-00021780: 6d65 7465 7220 6f66 2074 6865 2060 6073  meter of the ``s
-00021790: 6574 7570 6060 2066 756e 6374 696f 6e20  etup`` function 
-000217a0: 6973 2075 7365 642e 2057 6865 6e20 616e  is used. When an
-000217b0: 2069 6e74 6567 6572 2069 7320 7061 7373   integer is pass
-000217c0: 6564 2c0a 2020 2020 2020 2020 2020 2020  ed,.            
-000217d0: 6974 2069 7320 696e 7465 7270 7265 7465  it is interprete
-000217e0: 6420 6173 2074 6865 2027 6e5f 7370 6c69  d as the 'n_spli
-000217f0: 7473 2720 7061 7261 6d65 7465 7220 6f66  ts' parameter of
-00021800: 2074 6865 2043 5620 6765 6e65 7261 746f   the CV generato
-00021810: 7220 696e 2074 6865 0a20 2020 2020 2020  r in the.       
-00021820: 2020 2020 2060 6073 6574 7570 6060 2066       ``setup`` f
-00021830: 756e 6374 696f 6e2e 0a0a 2020 2020 2020  unction...      
-00021840: 2020 666f 6c64 3a20 696e 7465 6765 7220    fold: integer 
-00021850: 6f72 2073 6369 6b69 742d 6c65 6172 6e20  or scikit-learn 
-00021860: 636f 6d70 6174 6962 6c65 2043 5620 6765  compatible CV ge
-00021870: 6e65 7261 746f 722c 2064 6566 6175 6c74  nerator, default
-00021880: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00021890: 2020 2020 436f 6e74 726f 6c73 2063 726f      Controls cro
-000218a0: 7373 2d76 616c 6964 6174 696f 6e2e 2049  ss-validation. I
-000218b0: 6620 4e6f 6e65 2c20 7769 6c6c 2075 7365  f None, will use
-000218c0: 2074 6865 2043 5620 6765 6e65 7261 746f   the CV generato
-000218d0: 7220 6465 6669 6e65 6420 696e 2073 6574  r defined in set
-000218e0: 7570 2829 2e0a 2020 2020 2020 2020 2020  up()..          
-000218f0: 2020 4966 2069 6e74 6567 6572 2c20 7769    If integer, wi
-00021900: 6c6c 2075 7365 204b 466f 6c64 2043 5620  ll use KFold CV 
-00021910: 7769 7468 2074 6861 7420 6d61 6e79 2066  with that many f
-00021920: 6f6c 6473 2e0a 2020 2020 2020 2020 2020  olds..          
-00021930: 2020 5768 656e 2063 726f 7373 5f76 616c    When cross_val
-00021940: 6964 6174 696f 6e20 6973 2046 616c 7365  idation is False
-00021950: 2c20 7468 6973 2070 6172 616d 6574 6572  , this parameter
-00021960: 2069 7320 6967 6e6f 7265 642e 0a0a 2020   is ignored...  
-00021970: 2020 2020 2020 726f 756e 643a 2069 6e74        round: int
-00021980: 6567 6572 2c20 6465 6661 756c 7420 3d20  eger, default = 
-00021990: 340a 2020 2020 2020 2020 2020 2020 4e75  4.            Nu
-000219a0: 6d62 6572 206f 6620 6465 6369 6d61 6c20  mber of decimal 
-000219b0: 706c 6163 6573 2074 6865 206d 6574 7269  places the metri
-000219c0: 6373 2069 6e20 7468 6520 7363 6f72 6520  cs in the score 
-000219d0: 6772 6964 2077 696c 6c20 6265 2072 6f75  grid will be rou
-000219e0: 6e64 6564 2074 6f2e 0a0a 2020 2020 2020  nded to...      
-000219f0: 2020 6d65 7468 6f64 3a20 7374 7269 6e67    method: string
-00021a00: 2c20 6465 6661 756c 7420 3d20 2761 7574  , default = 'aut
-00021a10: 6f27 0a20 2020 2020 2020 2020 2020 202d  o'.            -
-00021a20: 2069 6620 e280 9861 7574 6fe2 8099 2c20   if ...auto..., 
-00021a30: 6974 2077 696c 6c20 7472 7920 746f 2069  it will try to i
-00021a40: 6e76 6f6b 652c 2066 6f72 2065 6163 6820  nvoke, for each 
-00021a50: 6573 7469 6d61 746f 722c 2027 7072 6564  estimator, 'pred
-00021a60: 6963 745f 7072 6f62 6127 2c0a 2020 2020  ict_proba',.    
-00021a70: 2020 2020 2020 2020 2764 6563 6973 696f          'decisio
-00021a80: 6e5f 6675 6e63 7469 6f6e 2720 6f72 2027  n_function' or '
-00021a90: 7072 6564 6963 7427 2069 6e20 7468 6174  predict' in that
-00021aa0: 206f 7264 6572 2e0a 2020 2020 2020 2020   order..        
-00021ab0: 2020 2020 2d20 6f74 6865 7277 6973 652c      - otherwise,
-00021ac0: 206f 6e65 206f 6620 2770 7265 6469 6374   one of 'predict
-00021ad0: 5f70 726f 6261 272c 2027 6465 6369 7369  _proba', 'decisi
-00021ae0: 6f6e 5f66 756e 6374 696f 6e27 206f 7220  on_function' or 
-00021af0: 2770 7265 6469 6374 272e 0a20 2020 2020  'predict'..     
-00021b00: 2020 2020 2020 2049 6620 7468 6520 6d65         If the me
-00021b10: 7468 6f64 2069 7320 6e6f 7420 696d 706c  thod is not impl
-00021b20: 656d 656e 7465 6420 6279 2074 6865 2065  emented by the e
-00021b30: 7374 696d 6174 6f72 2c20 6974 2077 696c  stimator, it wil
-00021b40: 6c20 7261 6973 6520 616e 2065 7272 6f72  l raise an error
-00021b50: 2e0a 0a20 2020 2020 2020 2072 6573 7461  ...        resta
-00021b60: 636b 3a20 626f 6f6c 2c20 6465 6661 756c  ck: bool, defaul
-00021b70: 7420 3d20 4661 6c73 650a 2020 2020 2020  t = False.      
-00021b80: 2020 2020 2020 5768 656e 2072 6573 7461        When resta
-00021b90: 636b 2069 7320 7365 7420 746f 2054 7275  ck is set to Tru
-00021ba0: 652c 2072 6177 2064 6174 6120 7769 6c6c  e, raw data will
-00021bb0: 2062 6520 6578 706f 7365 6420 746f 206d   be exposed to m
-00021bc0: 6574 6120 6d6f 6465 6c20 7768 656e 0a20  eta model when. 
-00021bd0: 2020 2020 2020 2020 2020 206d 616b 696e             makin
-00021be0: 6720 7072 6564 6963 7469 6f6e 732c 206f  g predictions, o
-00021bf0: 7468 6572 7769 7365 2077 6865 6e20 4661  therwise when Fa
-00021c00: 6c73 652c 206f 6e6c 7920 7468 6520 7072  lse, only the pr
-00021c10: 6564 6963 7465 6420 6c61 6265 6c20 6f72  edicted label or
-00021c20: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
-00021c30: 6261 6269 6c69 7469 6573 2069 7320 7061  babilities is pa
-00021c40: 7373 6564 2074 6f20 6d65 7461 206d 6f64  ssed to meta mod
-00021c50: 656c 2077 6865 6e20 6d61 6b69 6e67 2066  el when making f
-00021c60: 696e 616c 2070 7265 6469 6374 696f 6e73  inal predictions
-00021c70: 2e0a 0a20 2020 2020 2020 2063 686f 6f73  ...        choos
-00021c80: 655f 6265 7474 6572 3a20 626f 6f6c 2c20  e_better: bool, 
-00021c90: 6465 6661 756c 7420 3d20 4661 6c73 650a  default = False.
-00021ca0: 2020 2020 2020 2020 2020 2020 5768 656e              When
-00021cb0: 2073 6574 2074 6f20 7365 7420 746f 2054   set to set to T
-00021cc0: 7275 652c 2062 6173 6520 6573 7469 6d61  rue, base estima
-00021cd0: 746f 7220 6973 2072 6574 7572 6e65 6420  tor is returned 
-00021ce0: 7768 656e 2074 6865 206d 6574 7269 6320  when the metric 
-00021cf0: 646f 6573 6e27 740a 2020 2020 2020 2020  doesn't.        
-00021d00: 2020 2020 696d 7072 6f76 6520 6279 2065      improve by e
-00021d10: 6e73 656d 626c 655f 6d6f 6465 6c2e 2054  nsemble_model. T
-00021d20: 6869 7320 6775 6172 616e 7465 6573 2074  his guarantees t
-00021d30: 6865 2072 6574 7572 6e65 6420 6f62 6a65  he returned obje
-00021d40: 6374 2077 6f75 6c64 2070 6572 666f 726d  ct would perform
-00021d50: 0a20 2020 2020 2020 2020 2020 2061 7420  .            at 
-00021d60: 6c65 6173 7420 6571 7569 7661 6c65 6e74  least equivalent
-00021d70: 2074 6f20 6261 7365 2065 7374 696d 6174   to base estimat
-00021d80: 6f72 2063 7265 6174 6564 2075 7369 6e67  or created using
-00021d90: 2063 7265 6174 655f 6d6f 6465 6c20 6f72   create_model or
-00021da0: 206d 6f64 656c 0a20 2020 2020 2020 2020   model.         
-00021db0: 2020 2072 6574 7572 6e65 6420 6279 2063     returned by c
-00021dc0: 6f6d 7061 7265 5f6d 6f64 656c 732e 0a0a  ompare_models...
-00021dd0: 2020 2020 2020 2020 6f70 7469 6d69 7a65          optimize
-00021de0: 3a20 7374 722c 2064 6566 6175 6c74 203d  : str, default =
-00021df0: 2027 4163 6375 7261 6379 270a 2020 2020   'Accuracy'.    
-00021e00: 2020 2020 2020 2020 4f6e 6c79 2075 7365          Only use
-00021e10: 6420 7768 656e 2063 686f 6f73 655f 6265  d when choose_be
-00021e20: 7474 6572 2069 7320 7365 7420 746f 2054  tter is set to T
-00021e30: 7275 652e 206f 7074 696d 697a 6520 7061  rue. optimize pa
-00021e40: 7261 6d65 7465 7220 6973 2075 7365 640a  rameter is used.
-00021e50: 2020 2020 2020 2020 2020 2020 746f 2063              to c
-00021e60: 6f6d 7061 7265 2065 6e73 656d 626c 6564  ompare ensembled
-00021e70: 206d 6f64 656c 2077 6974 6820 6261 7365   model with base
-00021e80: 2065 7374 696d 6174 6f72 2e20 5661 6c75   estimator. Valu
-00021e90: 6573 2061 6363 6570 7465 6420 696e 0a20  es accepted in. 
-00021ea0: 2020 2020 2020 2020 2020 206f 7074 696d             optim
-00021eb0: 697a 6520 7061 7261 6d65 7465 7220 6172  ize parameter ar
-00021ec0: 6520 2741 6363 7572 6163 7927 2c20 2741  e 'Accuracy', 'A
-00021ed0: 5543 272c 2027 5265 6361 6c6c 272c 2027  UC', 'Recall', '
-00021ee0: 5072 6563 6973 696f 6e27 2c20 2746 3127  Precision', 'F1'
-00021ef0: 2c0a 2020 2020 2020 2020 2020 2020 274b  ,.            'K
-00021f00: 6170 7061 272c 2027 4d43 4327 2e0a 0a20  appa', 'MCC'... 
-00021f10: 2020 2020 2020 2066 6974 5f6b 7761 7267         fit_kwarg
-00021f20: 733a 2064 6963 742c 2064 6566 6175 6c74  s: dict, default
-00021f30: 203d 207b 7d20 2865 6d70 7479 2064 6963   = {} (empty dic
-00021f40: 7429 0a20 2020 2020 2020 2020 2020 2044  t).            D
-00021f50: 6963 7469 6f6e 6172 7920 6f66 2061 7267  ictionary of arg
-00021f60: 756d 656e 7473 2070 6173 7365 6420 746f  uments passed to
-00021f70: 2074 6865 2066 6974 206d 6574 686f 6420   the fit method 
-00021f80: 6f66 2074 6865 206d 6f64 656c 2e0a 0a20  of the model... 
-00021f90: 2020 2020 2020 2067 726f 7570 733a 2073         groups: s
-00021fa0: 7472 206f 7220 6172 7261 792d 6c69 6b65  tr or array-like
-00021fb0: 2c20 7769 7468 2073 6861 7065 2028 6e5f  , with shape (n_
-00021fc0: 7361 6d70 6c65 732c 292c 2064 6566 6175  samples,), defau
-00021fd0: 6c74 203d 204e 6f6e 650a 2020 2020 2020  lt = None.      
-00021fe0: 2020 2020 2020 4f70 7469 6f6e 616c 2047        Optional G
-00021ff0: 726f 7570 206c 6162 656c 7320 666f 7220  roup labels for 
-00022000: 7468 6520 7361 6d70 6c65 7320 7573 6564  the samples used
-00022010: 2077 6869 6c65 2073 706c 6974 7469 6e67   while splitting
-00022020: 2074 6865 2064 6174 6173 6574 2069 6e74   the dataset int
-00022030: 6f20 7472 6169 6e2f 7465 7374 2073 6574  o train/test set
-00022040: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-00022050: 2073 7472 696e 6720 6973 2070 6173 7365   string is passe
-00022060: 642c 2077 696c 6c20 7573 6520 7468 6520  d, will use the 
-00022070: 6461 7461 2063 6f6c 756d 6e20 7769 7468  data column with
-00022080: 2074 6861 7420 6e61 6d65 2061 7320 7468   that name as th
-00022090: 6520 6772 6f75 7073 2e0a 2020 2020 2020  e groups..      
-000220a0: 2020 2020 2020 4f6e 6c79 2075 7365 6420        Only used 
-000220b0: 6966 2061 2067 726f 7570 2062 6173 6564  if a group based
-000220c0: 2063 726f 7373 2d76 616c 6964 6174 696f   cross-validatio
-000220d0: 6e20 6765 6e65 7261 746f 7220 6973 2075  n generator is u
-000220e0: 7365 6420 2865 672e 2047 726f 7570 4b46  sed (eg. GroupKF
-000220f0: 6f6c 6429 2e0a 2020 2020 2020 2020 2020  old)..          
-00022100: 2020 4966 204e 6f6e 652c 2077 696c 6c20    If None, will 
-00022110: 7573 6520 7468 6520 7661 6c75 6520 7365  use the value se
-00022120: 7420 696e 2066 6f6c 645f 6772 6f75 7073  t in fold_groups
-00022130: 2070 6172 616d 6574 6572 2069 6e20 7365   parameter in se
-00022140: 7475 7028 292e 0a0a 2020 2020 2020 2020  tup()...        
-00022150: 7665 7262 6f73 653a 2062 6f6f 6c2c 2064  verbose: bool, d
-00022160: 6566 6175 6c74 203d 2054 7275 650a 2020  efault = True.  
-00022170: 2020 2020 2020 2020 2020 5363 6f72 6520            Score 
-00022180: 6772 6964 2069 7320 6e6f 7420 7072 696e  grid is not prin
-00022190: 7465 6420 7768 656e 2076 6572 626f 7365  ted when verbose
-000221a0: 2069 7320 7365 7420 746f 2046 616c 7365   is set to False
-000221b0: 2e0a 0a20 2020 2020 2020 2072 6574 7572  ...        retur
-000221c0: 6e5f 7472 6169 6e5f 7363 6f72 653a 2062  n_train_score: b
-000221d0: 6f6f 6c2c 2064 6566 6175 6c74 203d 2046  ool, default = F
-000221e0: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-000221f0: 2049 6620 4661 6c73 652c 2072 6574 7572   If False, retur
-00022200: 6e73 2074 6865 2043 5620 5661 6c69 6461  ns the CV Valida
-00022210: 7469 6f6e 2073 636f 7265 7320 6f6e 6c79  tion scores only
-00022220: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-00022230: 2054 7275 652c 2072 6574 7572 6e73 2074   True, returns t
-00022240: 6865 2043 5620 7472 6169 6e69 6e67 2073  he CV training s
-00022250: 636f 7265 7320 616c 6f6e 6720 7769 7468  cores along with
-00022260: 2074 6865 2043 5620 7661 6c69 6461 7469   the CV validati
-00022270: 6f6e 2073 636f 7265 732e 0a20 2020 2020  on scores..     
-00022280: 2020 2020 2020 2054 6869 7320 6973 2075         This is u
-00022290: 7365 6675 6c20 7768 656e 2074 6865 2075  seful when the u
-000222a0: 7365 7220 7761 6e74 7320 746f 2064 6f20  ser wants to do 
-000222b0: 6269 6173 2d76 6172 6961 6e63 6520 7472  bias-variance tr
-000222c0: 6164 656f 6666 2e20 4120 6869 6768 2043  adeoff. A high C
-000222d0: 560a 2020 2020 2020 2020 2020 2020 7472  V.            tr
-000222e0: 6169 6e69 6e67 2073 636f 7265 2077 6974  aining score wit
-000222f0: 6820 6120 6c6f 7720 636f 7272 6573 706f  h a low correspo
-00022300: 6e64 696e 6720 4356 2076 616c 6964 6174  nding CV validat
-00022310: 696f 6e20 7363 6f72 6520 696e 6469 6361  ion score indica
-00022320: 7465 7320 6f76 6572 6669 7474 696e 672e  tes overfitting.
-00022330: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00022340: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00022350: 2d0a 2020 2020 2020 2020 7363 6f72 655f  -.        score_
-00022360: 6772 6964 0a20 2020 2020 2020 2020 2020  grid.           
-00022370: 2041 2074 6162 6c65 2063 6f6e 7461 696e   A table contain
-00022380: 696e 6720 7468 6520 7363 6f72 6573 206f  ing the scores o
-00022390: 6620 7468 6520 6d6f 6465 6c20 6163 726f  f the model acro
-000223a0: 7373 2074 6865 206b 666f 6c64 732e 0a20  ss the kfolds.. 
-000223b0: 2020 2020 2020 2020 2020 2053 636f 7269             Scori
-000223c0: 6e67 206d 6574 7269 6373 2075 7365 6420  ng metrics used 
-000223d0: 6172 6520 4163 6375 7261 6379 2c20 4155  are Accuracy, AU
-000223e0: 432c 2052 6563 616c 6c2c 2050 7265 6369  C, Recall, Preci
-000223f0: 7369 6f6e 2c20 4631 2c0a 2020 2020 2020  sion, F1,.      
-00022400: 2020 2020 2020 4b61 7070 6120 616e 6420        Kappa and 
-00022410: 4d43 432e 204d 6561 6e20 616e 6420 7374  MCC. Mean and st
-00022420: 616e 6461 7264 2064 6576 6961 7469 6f6e  andard deviation
-00022430: 206f 6620 7468 6520 7363 6f72 6573 2061   of the scores a
-00022440: 6372 6f73 730a 2020 2020 2020 2020 2020  cross.          
-00022450: 2020 7468 6520 666f 6c64 7320 6172 6520    the folds are 
-00022460: 616c 736f 2072 6574 7572 6e65 642e 0a0a  also returned...
-00022470: 2020 2020 2020 2020 6d6f 6465 6c0a 2020          model.  
-00022480: 2020 2020 2020 2020 2020 5472 6169 6e65            Traine
-00022490: 6420 6d6f 6465 6c20 6f62 6a65 6374 2e0a  d model object..
-000224a0: 0a20 2020 2020 2020 2057 6172 6e69 6e67  .        Warning
-000224b0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-000224c0: 2d2d 0a20 2020 2020 2020 202d 2020 4966  --.        -  If
-000224d0: 2074 6172 6765 7420 7661 7269 6162 6c65   target variable
-000224e0: 2069 7320 6d75 6c74 6963 6c61 7373 2028   is multiclass (
-000224f0: 6d6f 7265 2074 6861 6e20 3220 636c 6173  more than 2 clas
-00022500: 7365 7329 2c20 4155 4320 7769 6c6c 2062  ses), AUC will b
-00022510: 6520 7265 7475 726e 6564 0a20 2020 2020  e returned.     
-00022520: 2020 2061 7320 7a65 726f 2028 302e 3029     as zero (0.0)
-00022530: 2e0a 0a20 2020 2020 2020 2022 2222 0a0a  ...        """..
-00022540: 2020 2020 2020 2020 6675 6e63 7469 6f6e          function
-00022550: 5f70 6172 616d 735f 7374 7220 3d20 222c  _params_str = ",
-00022560: 2022 2e6a 6f69 6e28 5b66 227b 6b7d 3d7b   ".join([f"{k}={
-00022570: 767d 2220 666f 7220 6b2c 2076 2069 6e20  v}" for k, v in 
-00022580: 6c6f 6361 6c73 2829 2e69 7465 6d73 2829  locals().items()
-00022590: 5d29 0a0a 2020 2020 2020 2020 7365 6c66  ])..        self
-000225a0: 2e6c 6f67 6765 722e 696e 666f 2822 496e  .logger.info("In
-000225b0: 6974 6961 6c69 7a69 6e67 2073 7461 636b  itializing stack
-000225c0: 5f6d 6f64 656c 7328 2922 290a 2020 2020  _models()").    
-000225d0: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
-000225e0: 696e 666f 2866 2273 7461 636b 5f6d 6f64  info(f"stack_mod
-000225f0: 656c 7328 7b66 756e 6374 696f 6e5f 7061  els({function_pa
-00022600: 7261 6d73 5f73 7472 7d29 2229 0a0a 2020  rams_str})")..  
-00022610: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
-00022620: 722e 696e 666f 2822 4368 6563 6b69 6e67  r.info("Checking
-00022630: 2065 7863 6570 7469 6f6e 7322 290a 0a20   exceptions").. 
-00022640: 2020 2020 2020 2023 2072 756e 5f74 696d         # run_tim
-00022650: 650a 2020 2020 2020 2020 7275 6e74 696d  e.        runtim
-00022660: 655f 7374 6172 7420 3d20 7469 6d65 2e74  e_start = time.t
-00022670: 696d 6528 290a 0a20 2020 2020 2020 2069  ime()..        i
-00022680: 6620 6e6f 7420 6669 745f 6b77 6172 6773  f not fit_kwargs
-00022690: 3a0a 2020 2020 2020 2020 2020 2020 6669  :.            fi
-000226a0: 745f 6b77 6172 6773 203d 207b 7d0a 0a20  t_kwargs = {}.. 
-000226b0: 2020 2020 2020 2023 2063 6865 636b 696e         # checkin
-000226c0: 6720 6572 726f 7220 666f 7220 6573 7469  g error for esti
-000226d0: 6d61 746f 725f 6c69 7374 0a20 2020 2020  mator_list.     
-000226e0: 2020 2066 6f72 2069 2069 6e20 6573 7469     for i in esti
-000226f0: 6d61 746f 725f 6c69 7374 3a0a 2020 2020  mator_list:.    
-00022700: 2020 2020 2020 2020 6966 206e 6f74 2068          if not h
-00022710: 6173 6174 7472 2869 2c20 2266 6974 2229  asattr(i, "fit")
-00022720: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00022730: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00022740: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00022750: 2020 2020 2020 2020 6622 4573 7469 6d61          f"Estima
-00022760: 746f 7220 7b69 7d20 646f 6573 206e 6f74  tor {i} does not
-00022770: 2068 6176 6520 7468 6520 7265 7175 6972   have the requir
-00022780: 6564 2066 6974 2829 206d 6574 686f 642e  ed fit() method.
-00022790: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-000227a0: 2020 290a 0a20 2020 2020 2020 2023 2063    )..        # c
-000227b0: 6865 636b 696e 6720 6d65 7461 206d 6f64  hecking meta mod
-000227c0: 656c 0a20 2020 2020 2020 2069 6620 6d65  el.        if me
-000227d0: 7461 5f6d 6f64 656c 2069 7320 6e6f 7420  ta_model is not 
-000227e0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-000227f0: 2020 6966 206e 6f74 2068 6173 6174 7472    if not hasattr
-00022800: 286d 6574 615f 6d6f 6465 6c2c 2022 6669  (meta_model, "fi
-00022810: 7422 293a 0a20 2020 2020 2020 2020 2020  t"):.           
-00022820: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00022830: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00022840: 2020 2020 2020 2020 2020 2066 224d 6574             f"Met
-00022850: 6120 4d6f 6465 6c20 7b6d 6574 615f 6d6f  a Model {meta_mo
-00022860: 6465 6c7d 2064 6f65 7320 6e6f 7420 6861  del} does not ha
-00022870: 7665 2074 6865 2072 6571 7569 7265 6420  ve the required 
-00022880: 6669 7428 2920 6d65 7468 6f64 2e22 0a20  fit() method.". 
-00022890: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000228a0: 0a0a 2020 2020 2020 2020 2320 6368 6563  ..        # chec
-000228b0: 6b69 6e67 2066 6f6c 6420 7061 7261 6d65  king fold parame
-000228c0: 7465 720a 2020 2020 2020 2020 6966 2066  ter.        if f
-000228d0: 6f6c 6420 6973 206e 6f74 204e 6f6e 6520  old is not None 
-000228e0: 616e 6420 6e6f 7420 280a 2020 2020 2020  and not (.      
-000228f0: 2020 2020 2020 7479 7065 2866 6f6c 6429        type(fold)
-00022900: 2069 7320 696e 7420 6f72 2069 735f 736b   is int or is_sk
-00022910: 6c65 6172 6e5f 6376 5f67 656e 6572 6174  learn_cv_generat
-00022920: 6f72 2866 6f6c 6429 0a20 2020 2020 2020  or(fold).       
-00022930: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-00022940: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-00022950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022960: 2022 666f 6c64 2070 6172 616d 6574 6572   "fold parameter
-00022970: 206d 7573 7420 6265 2065 6974 6865 7220   must be either 
-00022980: 4e6f 6e65 2c20 616e 2069 6e74 6567 6572  None, an integer
-00022990: 206f 7220 6120 7363 696b 6974 2d6c 6561   or a scikit-lea
-000229a0: 726e 2063 6f6d 7061 7469 626c 6520 4356  rn compatible CV
-000229b0: 2067 656e 6572 6174 6f72 206f 626a 6563   generator objec
-000229c0: 742e 220a 2020 2020 2020 2020 2020 2020  t.".            
-000229d0: 290a 0a20 2020 2020 2020 2023 2063 6865  )..        # che
-000229e0: 636b 696e 6720 726f 756e 6420 7061 7261  cking round para
-000229f0: 6d65 7465 720a 2020 2020 2020 2020 6966  meter.        if
-00022a00: 2074 7970 6528 726f 756e 6429 2069 7320   type(round) is 
-00022a10: 6e6f 7420 696e 743a 0a20 2020 2020 2020  not int:.       
-00022a20: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00022a30: 7272 6f72 2822 526f 756e 6420 7061 7261  rror("Round para
-00022a40: 6d65 7465 7220 6f6e 6c79 2061 6363 6570  meter only accep
-00022a50: 7473 2069 6e74 6567 6572 2076 616c 7565  ts integer value
-00022a60: 2e22 290a 0a20 2020 2020 2020 2023 2063  .")..        # c
-00022a70: 6865 636b 696e 6720 6d65 7468 6f64 2070  hecking method p
-00022a80: 6172 616d 6574 6572 0a20 2020 2020 2020  arameter.       
-00022a90: 2061 7661 696c 6162 6c65 5f6d 6574 686f   available_metho
-00022aa0: 6420 3d20 5b22 6175 746f 222c 2022 7072  d = ["auto", "pr
-00022ab0: 6564 6963 745f 7072 6f62 6122 2c20 2264  edict_proba", "d
-00022ac0: 6563 6973 696f 6e5f 6675 6e63 7469 6f6e  ecision_function
-00022ad0: 222c 2022 7072 6564 6963 7422 5d0a 2020  ", "predict"].  
-00022ae0: 2020 2020 2020 6966 206d 6574 686f 6420        if method 
-00022af0: 6e6f 7420 696e 2061 7661 696c 6162 6c65  not in available
-00022b00: 5f6d 6574 686f 643a 0a20 2020 2020 2020  _method:.       
-00022b10: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00022b20: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00022b30: 2020 2020 2020 2022 4d65 7468 6f64 2070         "Method p
-00022b40: 6172 616d 6574 6572 206e 6f74 2061 6363  arameter not acc
-00022b50: 6570 7461 626c 652e 2049 7420 6f6e 6c79  eptable. It only
-00022b60: 2061 6363 6570 7473 2027 6175 746f 272c   accepts 'auto',
-00022b70: 2027 7072 6564 6963 745f 7072 6f62 6127   'predict_proba'
-00022b80: 2c20 2764 6563 6973 696f 6e5f 6675 6e63  , 'decision_func
-00022b90: 7469 6f6e 272c 2027 7072 6564 6963 7427  tion', 'predict'
-00022ba0: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
-00022bb0: 0a0a 2020 2020 2020 2020 2320 6368 6563  ..        # chec
-00022bc0: 6b69 6e67 2072 6573 7461 636b 2070 6172  king restack par
-00022bd0: 616d 6574 6572 0a20 2020 2020 2020 2069  ameter.        i
-00022be0: 6620 7479 7065 2872 6573 7461 636b 2920  f type(restack) 
-00022bf0: 6973 206e 6f74 2062 6f6f 6c3a 0a20 2020  is not bool:.   
-00022c00: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00022c10: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
-00022c20: 2020 2020 2020 2020 2020 2252 6573 7461            "Resta
-00022c30: 636b 2070 6172 616d 6574 6572 2063 616e  ck parameter can
-00022c40: 206f 6e6c 7920 7461 6b65 2061 7267 756d   only take argum
-00022c50: 656e 7420 6173 2054 7275 6520 6f72 2046  ent as True or F
-00022c60: 616c 7365 2e22 0a20 2020 2020 2020 2020  alse.".         
-00022c70: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
-00022c80: 6368 6563 6b69 6e67 2076 6572 626f 7365  checking verbose
-00022c90: 2070 6172 616d 6574 6572 0a20 2020 2020   parameter.     
-00022ca0: 2020 2069 6620 7479 7065 2876 6572 626f     if type(verbo
-00022cb0: 7365 2920 6973 206e 6f74 2062 6f6f 6c3a  se) is not bool:
-00022cc0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00022cd0: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
-00022ce0: 2020 2020 2020 2020 2020 2020 2020 2256                "V
-00022cf0: 6572 626f 7365 2070 6172 616d 6574 6572  erbose parameter
-00022d00: 2063 616e 206f 6e6c 7920 7461 6b65 2061   can only take a
-00022d10: 7267 756d 656e 7420 6173 2054 7275 6520  rgument as True 
-00022d20: 6f72 2046 616c 7365 2e22 0a20 2020 2020  or False.".     
-00022d30: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00022d40: 2020 2320 6368 6563 6b69 6e67 206f 7074    # checking opt
-00022d50: 696d 697a 6520 7061 7261 6d65 7465 720a  imize parameter.
-00022d60: 2020 2020 2020 2020 6f70 7469 6d69 7a65          optimize
-00022d70: 203d 2073 656c 662e 5f67 6574 5f6d 6574   = self._get_met
-00022d80: 7269 635f 6279 5f6e 616d 655f 6f72 5f69  ric_by_name_or_i
-00022d90: 6428 6f70 7469 6d69 7a65 290a 2020 2020  d(optimize).    
-00022da0: 2020 2020 6966 206f 7074 696d 697a 6520      if optimize 
-00022db0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00022dc0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00022dd0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00022de0: 2020 2020 2020 2022 4f70 7469 6d69 7a65         "Optimize
-00022df0: 206d 6574 686f 6420 6e6f 7420 7375 7070   method not supp
-00022e00: 6f72 7465 642e 2053 6565 2064 6f63 7374  orted. See docst
-00022e10: 7269 6e67 2066 6f72 206c 6973 7420 6f66  ring for list of
-00022e20: 2061 7661 696c 6162 6c65 2070 6172 616d   available param
-00022e30: 6574 6572 732e 220a 2020 2020 2020 2020  eters.".        
-00022e40: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
-00022e50: 2063 6865 636b 696e 6720 6f70 7469 6d69   checking optimi
-00022e60: 7a65 2070 6172 616d 6574 6572 2066 6f72  ze parameter for
-00022e70: 206d 756c 7469 636c 6173 730a 2020 2020   multiclass.    
-00022e80: 2020 2020 6966 2073 656c 662e 6973 5f6d      if self.is_m
-00022e90: 756c 7469 636c 6173 733a 0a20 2020 2020  ulticlass:.     
-00022ea0: 2020 2020 2020 2069 6620 6e6f 7420 6f70         if not op
-00022eb0: 7469 6d69 7a65 2e69 735f 6d75 6c74 6963  timize.is_multic
-00022ec0: 6c61 7373 3a0a 2020 2020 2020 2020 2020  lass:.          
-00022ed0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00022ee0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00022ef0: 2020 2020 2020 2020 2020 2022 4f70 7469             "Opti
-00022f00: 6d69 7a61 7469 6f6e 206d 6574 7269 6320  mization metric 
-00022f10: 6e6f 7420 7375 7070 6f72 7465 6420 666f  not supported fo
-00022f20: 7220 6d75 6c74 6963 6c61 7373 2070 726f  r multiclass pro
-00022f30: 626c 656d 732e 2053 6565 2064 6f63 7374  blems. See docst
-00022f40: 7269 6e67 2066 6f72 206c 6973 7420 6f66  ring for list of
-00022f50: 206f 7468 6572 206f 7074 696d 697a 6174   other optimizat
-00022f60: 696f 6e20 7061 7261 6d65 7465 7273 2e22  ion parameters."
-00022f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022f80: 2029 0a0a 2020 2020 2020 2020 2320 6368   )..        # ch
-00022f90: 6563 6b69 6e67 2072 6574 7572 6e5f 7472  ecking return_tr
-00022fa0: 6169 6e5f 7363 6f72 6520 7061 7261 6d65  ain_score parame
-00022fb0: 7465 720a 2020 2020 2020 2020 6966 2074  ter.        if t
-00022fc0: 7970 6528 7265 7475 726e 5f74 7261 696e  ype(return_train
-00022fd0: 5f73 636f 7265 2920 6973 206e 6f74 2062  _score) is not b
-00022fe0: 6f6f 6c3a 0a20 2020 2020 2020 2020 2020  ool:.           
-00022ff0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-00023000: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00023010: 2020 2272 6574 7572 6e5f 7472 6169 6e5f    "return_train_
-00023020: 7363 6f72 6520 6361 6e20 6f6e 6c79 2074  score can only t
-00023030: 616b 6520 6172 6775 6d65 6e74 2061 7320  ake argument as 
-00023040: 5472 7565 206f 7220 4661 6c73 6522 0a20  True or False". 
-00023050: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00023060: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00023070: 2020 2045 5252 4f52 2048 414e 444c 494e     ERROR HANDLIN
-00023080: 4720 454e 4453 2048 4552 450a 0a20 2020  G ENDS HERE..   
-00023090: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-000230a0: 2020 666f 6c64 203d 2073 656c 662e 5f67    fold = self._g
-000230b0: 6574 5f63 765f 7370 6c69 7474 6572 2866  et_cv_splitter(f
-000230c0: 6f6c 6429 0a0a 2020 2020 2020 2020 6772  old)..        gr
-000230d0: 6f75 7073 203d 2073 656c 662e 5f67 6574  oups = self._get
-000230e0: 5f67 726f 7570 7328 6772 6f75 7073 290a  _groups(groups).
-000230f0: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
-00023100: 6767 6572 2e69 6e66 6f28 2244 6566 696e  gger.info("Defin
-00023110: 696e 6720 6d65 7461 206d 6f64 656c 2229  ing meta model")
-00023120: 0a20 2020 2020 2020 2069 6620 6d65 7461  .        if meta
-00023130: 5f6d 6f64 656c 2069 7320 4e6f 6e65 3a0a  _model is None:.
-00023140: 2020 2020 2020 2020 2020 2020 6573 7469              esti
-00023150: 6d61 746f 7220 3d20 226c 7222 0a20 2020  mator = "lr".   
-00023160: 2020 2020 2020 2020 206d 6574 615f 6d6f           meta_mo
-00023170: 6465 6c5f 6465 6669 6e69 7469 6f6e 203d  del_definition =
-00023180: 2073 656c 662e 5f61 6c6c 5f6d 6f64 656c   self._all_model
-00023190: 735f 696e 7465 726e 616c 5b65 7374 696d  s_internal[estim
-000231a0: 6174 6f72 5d0a 2020 2020 2020 2020 2020  ator].          
-000231b0: 2020 6d65 7461 5f6d 6f64 656c 5f61 7267    meta_model_arg
-000231c0: 7320 3d20 6d65 7461 5f6d 6f64 656c 5f64  s = meta_model_d
-000231d0: 6566 696e 6974 696f 6e2e 6172 6773 0a20  efinition.args. 
-000231e0: 2020 2020 2020 2020 2020 206d 6574 615f             meta_
-000231f0: 6d6f 6465 6c20 3d20 6d65 7461 5f6d 6f64  model = meta_mod
-00023200: 656c 5f64 6566 696e 6974 696f 6e2e 636c  el_definition.cl
-00023210: 6173 735f 6465 6628 2a2a 6d65 7461 5f6d  ass_def(**meta_m
-00023220: 6f64 656c 5f61 7267 7329 0a20 2020 2020  odel_args).     
-00023230: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00023240: 2020 2020 206d 6574 615f 6d6f 6465 6c20       meta_model 
-00023250: 3d20 636c 6f6e 6528 6765 745f 6573 7469  = clone(get_esti
-00023260: 6d61 746f 725f 6672 6f6d 5f6d 6574 615f  mator_from_meta_
-00023270: 6573 7469 6d61 746f 7228 6d65 7461 5f6d  estimator(meta_m
-00023280: 6f64 656c 2929 0a0a 2020 2020 2020 2020  odel))..        
-00023290: 7072 6f67 7265 7373 5f61 7267 7320 3d20  progress_args = 
-000232a0: 7b22 6d61 7822 3a20 3220 2b20 347d 0a20  {"max": 2 + 4}. 
-000232b0: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
-000232c0: 5374 7220 3d20 6461 7465 7469 6d65 2e64  Str = datetime.d
-000232d0: 6174 6574 696d 652e 6e6f 7728 292e 7374  atetime.now().st
-000232e0: 7266 7469 6d65 2822 2548 3a25 4d3a 2553  rftime("%H:%M:%S
-000232f0: 2229 0a20 2020 2020 2020 206d 6f6e 6974  ").        monit
-00023300: 6f72 5f72 6f77 7320 3d20 5b0a 2020 2020  or_rows = [.    
-00023310: 2020 2020 2020 2020 5b22 496e 6974 6961          ["Initia
-00023320: 7465 6422 2c20 222e 202e 202e 202e 202e  ted", ". . . . .
-00023330: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
-00023340: 202e 202e 202e 202e 202e 222c 2074 696d   . . . . .", tim
-00023350: 6573 7461 6d70 5374 725d 2c0a 2020 2020  estampStr],.    
-00023360: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-00023370: 2020 2020 2020 2020 2020 2253 7461 7475            "Statu
-00023380: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
-00023390: 2020 2020 222e 202e 202e 202e 202e 202e      ". . . . . .
-000233a0: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
-000233b0: 202e 202e 202e 202e 222c 0a20 2020 2020   . . . .",.     
-000233c0: 2020 2020 2020 2020 2020 2022 4c6f 6164             "Load
-000233d0: 696e 6720 4465 7065 6e64 656e 6369 6573  ing Dependencies
-000233e0: 222c 0a20 2020 2020 2020 2020 2020 205d  ",.            ]
-000233f0: 2c0a 2020 2020 2020 2020 2020 2020 5b0a  ,.            [.
-00023400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023410: 2245 7374 696d 6174 6f72 222c 0a20 2020  "Estimator",.   
-00023420: 2020 2020 2020 2020 2020 2020 2022 2e20               ". 
-00023430: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
-00023440: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
-00023450: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
-00023460: 2020 2020 2243 6f6d 7069 6c69 6e67 204c      "Compiling L
-00023470: 6962 7261 7279 222c 0a20 2020 2020 2020  ibrary",.       
-00023480: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-00023490: 5d0a 2020 2020 2020 2020 6469 7370 6c61  ].        displa
-000234a0: 7920 3d20 436f 6d6d 6f6e 4469 7370 6c61  y = CommonDispla
-000234b0: 7928 0a20 2020 2020 2020 2020 2020 2076  y(.            v
-000234c0: 6572 626f 7365 3d76 6572 626f 7365 2c0a  erbose=verbose,.
-000234d0: 2020 2020 2020 2020 2020 2020 6874 6d6c              html
-000234e0: 5f70 6172 616d 3d73 656c 662e 6874 6d6c  _param=self.html
-000234f0: 5f70 6172 616d 2c0a 2020 2020 2020 2020  _param,.        
-00023500: 2020 2020 7072 6f67 7265 7373 5f61 7267      progress_arg
-00023510: 733d 7072 6f67 7265 7373 5f61 7267 732c  s=progress_args,
-00023520: 0a20 2020 2020 2020 2020 2020 206d 6f6e  .            mon
-00023530: 6974 6f72 5f72 6f77 733d 6d6f 6e69 746f  itor_rows=monito
-00023540: 725f 726f 7773 2c0a 2020 2020 2020 2020  r_rows,.        
-00023550: 290a 0a20 2020 2020 2020 206e 702e 7261  )..        np.ra
-00023560: 6e64 6f6d 2e73 6565 6428 7365 6c66 2e73  ndom.seed(self.s
-00023570: 6565 6429 0a0a 2020 2020 2020 2020 2320  eed)..        # 
-00023580: 7365 7474 696e 6720 6f70 7469 6d69 7a65  setting optimize
-00023590: 2070 6172 616d 6574 6572 0a20 2020 2020   parameter.     
-000235a0: 2020 2063 6f6d 7061 7265 5f64 696d 656e     compare_dimen
-000235b0: 7369 6f6e 203d 206f 7074 696d 697a 652e  sion = optimize.
-000235c0: 6469 7370 6c61 795f 6e61 6d65 0a20 2020  display_name.   
-000235d0: 2020 2020 206f 7074 696d 697a 6520 3d20       optimize = 
-000235e0: 6f70 7469 6d69 7a65 2e73 636f 7265 720a  optimize.scorer.
-000235f0: 0a20 2020 2020 2020 2064 6973 706c 6179  .        display
-00023600: 2e6d 6f76 655f 7072 6f67 7265 7373 2829  .move_progress()
-00023610: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00023620: 2020 2020 2020 4d4f 4e49 544f 5220 5550        MONITOR UP
-00023630: 4441 5445 2053 5441 5254 530a 2020 2020  DATE STARTS.    
-00023640: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-00023650: 2064 6973 706c 6179 2e75 7064 6174 655f   display.update_
-00023660: 6d6f 6e69 746f 7228 312c 2022 436f 6d70  monitor(1, "Comp
-00023670: 696c 696e 6720 4573 7469 6d61 746f 7273  iling Estimators
-00023680: 2229 0a0a 2020 2020 2020 2020 2222 220a  ")..        """.
-00023690: 2020 2020 2020 2020 4d4f 4e49 544f 5220          MONITOR 
-000236a0: 5550 4441 5445 2045 4e44 530a 2020 2020  UPDATE ENDS.    
-000236b0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-000236c0: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
-000236d0: 6f28 2247 6574 7469 6e67 206d 6f64 656c  o("Getting model
-000236e0: 206e 616d 6573 2229 0a20 2020 2020 2020   names").       
-000236f0: 2065 7374 696d 6174 6f72 5f64 6963 7420   estimator_dict 
-00023700: 3d20 7b7d 0a20 2020 2020 2020 2066 6f72  = {}.        for
-00023710: 2078 2069 6e20 6573 7469 6d61 746f 725f   x in estimator_
-00023720: 6c69 7374 3a0a 2020 2020 2020 2020 2020  list:.          
-00023730: 2020 7820 3d20 6765 745f 6573 7469 6d61    x = get_estima
-00023740: 746f 725f 6672 6f6d 5f6d 6574 615f 6573  tor_from_meta_es
-00023750: 7469 6d61 746f 7228 7829 0a20 2020 2020  timator(x).     
-00023760: 2020 2020 2020 206e 616d 6520 3d20 7365         name = se
-00023770: 6c66 2e5f 6765 745f 6d6f 6465 6c5f 6e61  lf._get_model_na
-00023780: 6d65 2878 290a 2020 2020 2020 2020 2020  me(x).          
-00023790: 2020 7375 6666 6978 203d 2031 0a20 2020    suffix = 1.   
-000237a0: 2020 2020 2020 2020 206f 7269 6769 6e61           origina
-000237b0: 6c5f 6e61 6d65 203d 206e 616d 650a 2020  l_name = name.  
-000237c0: 2020 2020 2020 2020 2020 7768 696c 6520            while 
-000237d0: 6e61 6d65 2069 6e20 6573 7469 6d61 746f  name in estimato
-000237e0: 725f 6469 6374 3a0a 2020 2020 2020 2020  r_dict:.        
-000237f0: 2020 2020 2020 2020 6e61 6d65 203d 2066          name = f
-00023800: 227b 6f72 6967 696e 616c 5f6e 616d 657d  "{original_name}
-00023810: 5f7b 7375 6666 6978 7d22 0a20 2020 2020  _{suffix}".     
-00023820: 2020 2020 2020 2020 2020 2073 7566 6669             suffi
-00023830: 7820 2b3d 2031 0a20 2020 2020 2020 2020  x += 1.         
-00023840: 2020 2065 7374 696d 6174 6f72 5f64 6963     estimator_dic
-00023850: 745b 6e61 6d65 5d20 3d20 780a 0a20 2020  t[name] = x..   
-00023860: 2020 2020 2065 7374 696d 6174 6f72 5f6c       estimator_l
-00023870: 6973 7420 3d20 6c69 7374 2865 7374 696d  ist = list(estim
-00023880: 6174 6f72 5f64 6963 742e 6974 656d 7328  ator_dict.items(
-00023890: 2929 0a0a 2020 2020 2020 2020 7365 6c66  ))..        self
-000238a0: 2e6c 6f67 6765 722e 696e 666f 2865 7374  .logger.info(est
-000238b0: 696d 6174 6f72 5f6c 6973 7429 0a0a 2020  imator_list)..  
-000238c0: 2020 2020 2020 7374 6163 6b69 6e67 5f6d        stacking_m
-000238d0: 6f64 656c 5f64 6566 696e 6974 696f 6e20  odel_definition 
-000238e0: 3d20 7365 6c66 2e5f 616c 6c5f 6d6f 6465  = self._all_mode
-000238f0: 6c73 5f69 6e74 6572 6e61 6c5b 2253 7461  ls_internal["Sta
-00023900: 636b 696e 6722 5d0a 2020 2020 2020 2020  cking"].        
-00023910: 6966 2073 656c 662e 5f6d 6c5f 7573 6563  if self._ml_usec
-00023920: 6173 6520 3d3d 204d 4c55 7365 6361 7365  ase == MLUsecase
-00023930: 2e43 4c41 5353 4946 4943 4154 494f 4e3a  .CLASSIFICATION:
-00023940: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
-00023950: 656c 203d 2073 7461 636b 696e 675f 6d6f  el = stacking_mo
-00023960: 6465 6c5f 6465 6669 6e69 7469 6f6e 2e63  del_definition.c
-00023970: 6c61 7373 5f64 6566 280a 2020 2020 2020  lass_def(.      
-00023980: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-00023990: 746f 7273 3d65 7374 696d 6174 6f72 5f6c  tors=estimator_l
-000239a0: 6973 742c 0a20 2020 2020 2020 2020 2020  ist,.           
-000239b0: 2020 2020 2066 696e 616c 5f65 7374 696d       final_estim
-000239c0: 6174 6f72 3d6d 6574 615f 6d6f 6465 6c2c  ator=meta_model,
-000239d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000239e0: 2063 763d 6d65 7461 5f6d 6f64 656c 5f66   cv=meta_model_f
-000239f0: 6f6c 642c 0a20 2020 2020 2020 2020 2020  old,.           
-00023a00: 2020 2020 2073 7461 636b 5f6d 6574 686f       stack_metho
-00023a10: 643d 6d65 7468 6f64 2c0a 2020 2020 2020  d=method,.      
-00023a20: 2020 2020 2020 2020 2020 6e5f 6a6f 6273            n_jobs
-00023a30: 3d73 656c 662e 6770 755f 6e5f 6a6f 6273  =self.gpu_n_jobs
-00023a40: 5f70 6172 616d 2c0a 2020 2020 2020 2020  _param,.        
-00023a50: 2020 2020 2020 2020 7061 7373 7468 726f          passthro
-00023a60: 7567 683d 7265 7374 6163 6b2c 0a20 2020  ugh=restack,.   
-00023a70: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00023a80: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00023a90: 2020 2020 206d 6f64 656c 203d 2073 7461       model = sta
-00023aa0: 636b 696e 675f 6d6f 6465 6c5f 6465 6669  cking_model_defi
-00023ab0: 6e69 7469 6f6e 2e63 6c61 7373 5f64 6566  nition.class_def
-00023ac0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00023ad0: 2020 6573 7469 6d61 746f 7273 3d65 7374    estimators=est
-00023ae0: 696d 6174 6f72 5f6c 6973 742c 0a20 2020  imator_list,.   
-00023af0: 2020 2020 2020 2020 2020 2020 2066 696e               fin
-00023b00: 616c 5f65 7374 696d 6174 6f72 3d6d 6574  al_estimator=met
-00023b10: 615f 6d6f 6465 6c2c 0a20 2020 2020 2020  a_model,.       
-00023b20: 2020 2020 2020 2020 2063 763d 6d65 7461           cv=meta
-00023b30: 5f6d 6f64 656c 5f66 6f6c 642c 0a20 2020  _model_fold,.   
-00023b40: 2020 2020 2020 2020 2020 2020 206e 5f6a               n_j
-00023b50: 6f62 733d 7365 6c66 2e67 7075 5f6e 5f6a  obs=self.gpu_n_j
-00023b60: 6f62 735f 7061 7261 6d2c 0a20 2020 2020  obs_param,.     
-00023b70: 2020 2020 2020 2020 2020 2070 6173 7374             passt
-00023b80: 6872 6f75 6768 3d72 6573 7461 636b 2c0a  hrough=restack,.
-00023b90: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00023ba0: 2020 2020 2020 2064 6973 706c 6179 2e75         display.u
-00023bb0: 7064 6174 655f 6d6f 6e69 746f 7228 322c  pdate_monitor(2,
-00023bc0: 2073 7461 636b 696e 675f 6d6f 6465 6c5f   stacking_model_
-00023bd0: 6465 6669 6e69 7469 6f6e 2e6e 616d 6529  definition.name)
-00023be0: 0a0a 2020 2020 2020 2020 6469 7370 6c61  ..        displa
-00023bf0: 792e 6d6f 7665 5f70 726f 6772 6573 7328  y.move_progress(
-00023c00: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00023c10: 6c6f 6767 6572 2e69 6e66 6f28 0a20 2020  logger.info(.   
-00023c20: 2020 2020 2020 2020 2022 5375 6250 726f           "SubPro
-00023c30: 6365 7373 2063 7265 6174 655f 6d6f 6465  cess create_mode
-00023c40: 6c28 2920 6361 6c6c 6564 203d 3d3d 3d3d  l() called =====
-00023c50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00023c60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d22 0a20  =============". 
-00023c70: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00023c80: 206d 6f64 656c 2c20 6d6f 6465 6c5f 6669   model, model_fi
-00023c90: 745f 7469 6d65 203d 2073 656c 662e 5f63  t_time = self._c
-00023ca0: 7265 6174 655f 6d6f 6465 6c28 0a20 2020  reate_model(.   
-00023cb0: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
-00023cc0: 6f72 3d6d 6f64 656c 2c0a 2020 2020 2020  or=model,.      
-00023cd0: 2020 2020 2020 7379 7374 656d 3d46 616c        system=Fal
-00023ce0: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-00023cf0: 6469 7370 6c61 793d 6469 7370 6c61 792c  display=display,
-00023d00: 0a20 2020 2020 2020 2020 2020 2066 6f6c  .            fol
-00023d10: 643d 666f 6c64 2c0a 2020 2020 2020 2020  d=fold,.        
-00023d20: 2020 2020 726f 756e 643d 726f 756e 642c      round=round,
-00023d30: 0a20 2020 2020 2020 2020 2020 2066 6974  .            fit
-00023d40: 5f6b 7761 7267 733d 6669 745f 6b77 6172  _kwargs=fit_kwar
-00023d50: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
-00023d60: 6772 6f75 7073 3d67 726f 7570 732c 0a20  groups=groups,. 
-00023d70: 2020 2020 2020 2020 2020 2070 726f 6261             proba
-00023d80: 6269 6c69 7479 5f74 6872 6573 686f 6c64  bility_threshold
-00023d90: 3d70 726f 6261 6269 6c69 7479 5f74 6872  =probability_thr
-00023da0: 6573 686f 6c64 2c0a 2020 2020 2020 2020  eshold,.        
-00023db0: 2020 2020 7265 7475 726e 5f74 7261 696e      return_train
-00023dc0: 5f73 636f 7265 3d72 6574 7572 6e5f 7472  _score=return_tr
-00023dd0: 6169 6e5f 7363 6f72 652c 0a20 2020 2020  ain_score,.     
-00023de0: 2020 2029 0a20 2020 2020 2020 206d 6f64     ).        mod
-00023df0: 656c 5f72 6573 756c 7473 203d 2073 656c  el_results = sel
-00023e00: 662e 7075 6c6c 2829 0a20 2020 2020 2020  f.pull().       
-00023e10: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
-00023e20: 6f28 0a20 2020 2020 2020 2020 2020 2022  o(.            "
-00023e30: 5375 6250 726f 6365 7373 2063 7265 6174  SubProcess creat
-00023e40: 655f 6d6f 6465 6c28 2920 656e 6420 3d3d  e_model() end ==
-00023e50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00023e60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00023e70: 220a 2020 2020 2020 2020 290a 0a20 2020  ".        )..   
-00023e80: 2020 2020 2023 2065 6e64 2072 756e 7469       # end runti
-00023e90: 6d65 0a20 2020 2020 2020 2072 756e 7469  me.        runti
-00023ea0: 6d65 5f65 6e64 203d 2074 696d 652e 7469  me_end = time.ti
-00023eb0: 6d65 2829 0a20 2020 2020 2020 2072 756e  me().        run
-00023ec0: 7469 6d65 203d 206e 702e 6172 7261 7928  time = np.array(
-00023ed0: 7275 6e74 696d 655f 656e 6420 2d20 7275  runtime_end - ru
-00023ee0: 6e74 696d 655f 7374 6172 7429 2e72 6f75  ntime_start).rou
-00023ef0: 6e64 2832 290a 0a20 2020 2020 2020 2023  nd(2)..        #
-00023f00: 2064 6173 6862 6f61 7264 206c 6f67 6769   dashboard loggi
-00023f10: 6e67 0a20 2020 2020 2020 2069 6620 7365  ng.        if se
-00023f20: 6c66 2e6c 6f67 6769 6e67 5f70 6172 616d  lf.logging_param
-00023f30: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
-00023f40: 6469 6365 7320 3d20 7365 6c66 2e5f 6765  dices = self._ge
-00023f50: 745f 7265 7475 726e 5f74 7261 696e 5f73  t_return_train_s
-00023f60: 636f 7265 5f69 6e64 6963 6573 5f66 6f72  core_indices_for
-00023f70: 5f6c 6f67 6769 6e67 280a 2020 2020 2020  _logging(.      
-00023f80: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00023f90: 5f74 7261 696e 5f73 636f 7265 3d72 6574  _train_score=ret
-00023fa0: 7572 6e5f 7472 6169 6e5f 7363 6f72 650a  urn_train_score.
-00023fb0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00023fc0: 2020 2020 2020 2020 2020 6176 6773 5f64            avgs_d
-00023fd0: 6963 745f 6c6f 6720 3d20 7b6b 3a20 7620  ict_log = {k: v 
-00023fe0: 666f 7220 6b2c 2076 2069 6e20 6d6f 6465  for k, v in mode
-00023ff0: 6c5f 7265 7375 6c74 732e 6c6f 635b 696e  l_results.loc[in
-00024000: 6469 6365 735d 2e69 7465 6d73 2829 7d0a  dices].items()}.
-00024010: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00024020: 2e6c 6f67 6769 6e67 5f70 6172 616d 2e6c  .logging_param.l
-00024030: 6f67 5f6d 6f64 656c 5f63 6f6d 7061 7269  og_model_compari
-00024040: 736f 6e28 6d6f 6465 6c5f 7265 7375 6c74  son(model_result
-00024050: 732c 2022 7374 6163 6b5f 6d6f 6465 6c22  s, "stack_model"
-00024060: 290a 0a20 2020 2020 2020 2020 2020 2073  )..            s
-00024070: 656c 662e 5f6c 6f67 5f6d 6f64 656c 280a  elf._log_model(.
-00024080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024090: 6d6f 6465 6c3d 6d6f 6465 6c2c 0a20 2020  model=model,.   
-000240a0: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-000240b0: 656c 5f72 6573 756c 7473 3d6d 6f64 656c  el_results=model
-000240c0: 5f72 6573 756c 7473 2c0a 2020 2020 2020  _results,.      
-000240d0: 2020 2020 2020 2020 2020 7363 6f72 655f            score_
-000240e0: 6469 6374 3d61 7667 735f 6469 6374 5f6c  dict=avgs_dict_l
-000240f0: 6f67 2c0a 2020 2020 2020 2020 2020 2020  og,.            
-00024100: 2020 2020 736f 7572 6365 3d22 7374 6163      source="stac
-00024110: 6b5f 6d6f 6465 6c73 222c 0a20 2020 2020  k_models",.     
-00024120: 2020 2020 2020 2020 2020 2072 756e 7469             runti
-00024130: 6d65 3d72 756e 7469 6d65 2c0a 2020 2020  me=runtime,.    
-00024140: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-00024150: 6c5f 6669 745f 7469 6d65 3d6d 6f64 656c  l_fit_time=model
-00024160: 5f66 6974 5f74 696d 652c 0a20 2020 2020  _fit_time,.     
-00024170: 2020 2020 2020 2020 2020 2070 6970 656c             pipel
-00024180: 696e 653d 7365 6c66 2e70 6970 656c 696e  ine=self.pipelin
-00024190: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-000241a0: 2020 206c 6f67 5f70 6c6f 7473 3d73 656c     log_plots=sel
-000241b0: 662e 6c6f 675f 706c 6f74 735f 7061 7261  f.log_plots_para
-000241c0: 6d2c 0a20 2020 2020 2020 2020 2020 2020  m,.             
-000241d0: 2020 2064 6973 706c 6179 3d64 6973 706c     display=displ
-000241e0: 6179 2c0a 2020 2020 2020 2020 2020 2020  ay,.            
-000241f0: 290a 0a20 2020 2020 2020 2069 6620 6368  )..        if ch
-00024200: 6f6f 7365 5f62 6574 7465 723a 0a20 2020  oose_better:.   
-00024210: 2020 2020 2020 2020 206e 6577 5f6d 6f64           new_mod
-00024220: 656c 203d 2073 656c 662e 5f63 686f 6f73  el = self._choos
-00024230: 655f 6265 7474 6572 280a 2020 2020 2020  e_better(.      
-00024240: 2020 2020 2020 2020 2020 5b28 6d6f 6465            [(mode
-00024250: 6c2c 206d 6f64 656c 5f72 6573 756c 7473  l, model_results
-00024260: 295d 202b 2065 7374 696d 6174 6f72 5f6c  )] + estimator_l
-00024270: 6973 742c 0a20 2020 2020 2020 2020 2020  ist,.           
-00024280: 2020 2020 2063 6f6d 7061 7265 5f64 696d       compare_dim
-00024290: 656e 7369 6f6e 2c0a 2020 2020 2020 2020  ension,.        
-000242a0: 2020 2020 2020 2020 666f 6c64 2c0a 2020          fold,.  
-000242b0: 2020 2020 2020 2020 2020 2020 2020 6772                gr
-000242c0: 6f75 7073 3d67 726f 7570 732c 0a20 2020  oups=groups,.   
-000242d0: 2020 2020 2020 2020 2020 2020 2066 6974               fit
-000242e0: 5f6b 7761 7267 733d 6669 745f 6b77 6172  _kwargs=fit_kwar
-000242f0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
-00024300: 2020 2020 6469 7370 6c61 793d 6469 7370      display=disp
-00024310: 6c61 792c 0a20 2020 2020 2020 2020 2020  lay,.           
-00024320: 2029 0a20 2020 2020 2020 2020 2020 2069   ).            i
-00024330: 6620 6e65 775f 6d6f 6465 6c20 6973 206e  f new_model is n
-00024340: 6f74 206d 6f64 656c 3a0a 2020 2020 2020  ot model:.      
-00024350: 2020 2020 2020 2020 2020 6d73 6720 3d20            msg = 
-00024360: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00024370: 2020 2020 2020 224f 7269 6769 6e61 6c20        "Original 
-00024380: 6d6f 6465 6c20 7761 7320 6265 7474 6572  model was better
-00024390: 2074 6861 6e20 7468 6520 7374 6163 6b65   than the stacke
-000243a0: 6420 6d6f 6465 6c2c 2068 656e 6365 2069  d model, hence i
-000243b0: 7420 7769 6c6c 2062 6520 7265 7475 726e  t will be return
-000243c0: 6564 2e20 220a 2020 2020 2020 2020 2020  ed. ".          
-000243d0: 2020 2020 2020 2020 2020 224e 4f54 453a            "NOTE:
-000243e0: 2054 6865 2064 6973 706c 6179 206d 6574   The display met
-000243f0: 7269 6373 2061 7265 2066 6f72 2074 6865  rics are for the
-00024400: 2073 7461 636b 6564 206d 6f64 656c 2028   stacked model (
-00024410: 6e6f 7420 7468 6520 6f72 6967 696e 616c  not the original
-00024420: 206f 6e65 292e 220a 2020 2020 2020 2020   one).".        
-00024430: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00024440: 2020 2020 2020 2020 2020 6966 2076 6572            if ver
-00024450: 626f 7365 3a0a 2020 2020 2020 2020 2020  bose:.          
-00024460: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00024470: 6d73 6729 0a20 2020 2020 2020 2020 2020  msg).           
-00024480: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
-00024490: 2e69 6e66 6f28 6d73 6729 0a20 2020 2020  .info(msg).     
-000244a0: 2020 2020 2020 206d 6f64 656c 203d 206e         model = n
-000244b0: 6577 5f6d 6f64 656c 0a0a 2020 2020 2020  ew_model..      
-000244c0: 2020 6d6f 6465 6c5f 7265 7375 6c74 7320    model_results 
-000244d0: 3d20 7365 6c66 2e5f 6869 6768 6c69 6768  = self._highligh
-000244e0: 745f 616e 645f 726f 756e 645f 6d6f 6465  t_and_round_mode
-000244f0: 6c5f 7265 7375 6c74 7328 0a20 2020 2020  l_results(.     
-00024500: 2020 2020 2020 206d 6f64 656c 5f72 6573         model_res
-00024510: 756c 7473 2c20 7265 7475 726e 5f74 7261  ults, return_tra
-00024520: 696e 5f73 636f 7265 2c20 726f 756e 640a  in_score, round.
-00024530: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00024540: 2020 6469 7370 6c61 792e 6469 7370 6c61    display.displa
-00024550: 7928 6d6f 6465 6c5f 7265 7375 6c74 7329  y(model_results)
-00024560: 0a0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
-00024570: 6f67 6765 722e 696e 666f 280a 2020 2020  ogger.info(.    
-00024580: 2020 2020 2020 2020 6622 5f6d 6173 7465          f"_maste
-00024590: 725f 6d6f 6465 6c5f 636f 6e74 6169 6e65  r_model_containe
-000245a0: 723a 207b 6c65 6e28 7365 6c66 2e5f 6d61  r: {len(self._ma
-000245b0: 7374 6572 5f6d 6f64 656c 5f63 6f6e 7461  ster_model_conta
-000245c0: 696e 6572 297d 220a 2020 2020 2020 2020  iner)}".        
-000245d0: 290a 2020 2020 2020 2020 7365 6c66 2e6c  ).        self.l
-000245e0: 6f67 6765 722e 696e 666f 2866 225f 6469  ogger.info(f"_di
-000245f0: 7370 6c61 795f 636f 6e74 6169 6e65 723a  splay_container:
-00024600: 207b 6c65 6e28 7365 6c66 2e5f 6469 7370   {len(self._disp
-00024610: 6c61 795f 636f 6e74 6169 6e65 7229 7d22  lay_container)}"
-00024620: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00024630: 6c6f 6767 6572 2e69 6e66 6f28 7374 7228  logger.info(str(
-00024640: 6d6f 6465 6c29 290a 2020 2020 2020 2020  model)).        
-00024650: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
-00024660: 280a 2020 2020 2020 2020 2020 2020 2273  (.            "s
-00024670: 7461 636b 5f6d 6f64 656c 7328 2920 7375  tack_models() su
-00024680: 6363 6573 7366 756c 6c79 2063 6f6d 706c  ccessfully compl
-00024690: 6574 6564 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  eted............
-000246a0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000246b0: 2e2e 2e2e 2e2e 2e2e 2e2e 220a 2020 2020  ..........".    
-000246c0: 2020 2020 290a 0a20 2020 2020 2020 2067      )..        g
-000246d0: 632e 636f 6c6c 6563 7428 290a 2020 2020  c.collect().    
-000246e0: 2020 2020 7265 7475 726e 206d 6f64 656c      return model
-000246f0: 0a0a 2020 2020 6465 6620 696e 7465 7270  ..    def interp
-00024700: 7265 745f 6d6f 6465 6c28 0a20 2020 2020  ret_model(.     
-00024710: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00024720: 2065 7374 696d 6174 6f72 2c0a 2020 2020   estimator,.    
-00024730: 2020 2020 706c 6f74 3a20 7374 7220 3d20      plot: str = 
-00024740: 2273 756d 6d61 7279 222c 0a20 2020 2020  "summary",.     
-00024750: 2020 2066 6561 7475 7265 3a20 4f70 7469     feature: Opti
-00024760: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
-00024770: 2c0a 2020 2020 2020 2020 6f62 7365 7276  ,.        observ
-00024780: 6174 696f 6e3a 204f 7074 696f 6e61 6c5b  ation: Optional[
-00024790: 696e 745d 203d 204e 6f6e 652c 0a20 2020  int] = None,.   
-000247a0: 2020 2020 2075 7365 5f74 7261 696e 5f64       use_train_d
-000247b0: 6174 613a 2062 6f6f 6c20 3d20 4661 6c73  ata: bool = Fals
-000247c0: 652c 0a20 2020 2020 2020 2058 5f6e 6577  e,.        X_new
-000247d0: 5f73 616d 706c 653a 204f 7074 696f 6e61  _sample: Optiona
-000247e0: 6c5b 7064 2e44 6174 6146 7261 6d65 5d20  l[pd.DataFrame] 
-000247f0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00024800: 795f 6e65 775f 7361 6d70 6c65 3a20 4f70  y_new_sample: Op
-00024810: 7469 6f6e 616c 5b70 642e 4461 7461 4672  tional[pd.DataFr
-00024820: 616d 655d 203d 204e 6f6e 652c 2020 2320  ame] = None,  # 
-00024830: 6164 6420 666f 7220 7066 6920 6578 706c  add for pfi expl
-00024840: 6169 6e65 720a 2020 2020 2020 2020 7361  ainer.        sa
-00024850: 7665 3a20 556e 696f 6e5b 7374 722c 2062  ve: Union[str, b
-00024860: 6f6f 6c5d 203d 2046 616c 7365 2c0a 2020  ool] = False,.  
-00024870: 2020 2020 2020 2a2a 6b77 6172 6773 2c20        **kwargs, 
-00024880: 2023 2061 6464 6564 2069 6e20 7079 6361   # added in pyca
-00024890: 7265 743d 3d32 2e31 0a20 2020 2029 3a0a  ret==2.1.    ):.
-000248a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000248b0: 2020 2020 2054 6869 7320 6675 6e63 7469       This functi
-000248c0: 6f6e 2074 616b 6573 2061 2074 7261 696e  on takes a train
-000248d0: 6564 206d 6f64 656c 206f 626a 6563 7420  ed model object 
-000248e0: 616e 6420 7265 7475 726e 7320 616e 2069  and returns an i
-000248f0: 6e74 6572 7072 6574 6174 696f 6e20 706c  nterpretation pl
-00024900: 6f74 0a20 2020 2020 2020 2062 6173 6564  ot.        based
-00024910: 206f 6e20 7468 6520 7465 7374 202f 2068   on the test / h
-00024920: 6f6c 642d 6f75 7420 7365 742e 2049 7420  old-out set. It 
-00024930: 6f6e 6c79 2073 7570 706f 7274 7320 7472  only supports tr
-00024940: 6565 2062 6173 6564 2061 6c67 6f72 6974  ee based algorit
-00024950: 686d 732e 0a0a 2020 2020 2020 2020 5468  hms...        Th
-00024960: 6973 2066 756e 6374 696f 6e20 6973 2069  is function is i
-00024970: 6d70 6c65 6d65 6e74 6564 2062 6173 6564  mplemented based
-00024980: 206f 6e20 7468 6520 5348 4150 2028 5348   on the SHAP (SH
-00024990: 6170 6c65 7920 4164 6469 7469 7665 2065  apley Additive e
-000249a0: 7850 6c61 6e61 7469 6f6e 7329 2c0a 2020  xPlanations),.  
-000249b0: 2020 2020 2020 7768 6963 6820 6973 2061        which is a
-000249c0: 2075 6e69 6669 6564 2061 7070 726f 6163   unified approac
-000249d0: 6820 746f 2065 7870 6c61 696e 2074 6865  h to explain the
-000249e0: 206f 7574 7075 7420 6f66 2061 6e79 206d   output of any m
-000249f0: 6163 6869 6e65 206c 6561 726e 696e 6720  achine learning 
-00024a00: 6d6f 6465 6c2e 0a20 2020 2020 2020 2053  model..        S
-00024a10: 4841 5020 636f 6e6e 6563 7473 2067 616d  HAP connects gam
-00024a20: 6520 7468 656f 7279 2077 6974 6820 6c6f  e theory with lo
-00024a30: 6361 6c20 6578 706c 616e 6174 696f 6e73  cal explanations
-00024a40: 2e0a 0a20 2020 2020 2020 2046 6f72 206d  ...        For m
-00024a50: 6f72 6520 696e 666f 726d 6174 696f 6e20  ore information 
-00024a60: 3a20 6874 7470 733a 2f2f 7368 6170 2e72  : https://shap.r
-00024a70: 6561 6474 6865 646f 6373 2e69 6f2f 656e  eadthedocs.io/en
-00024a80: 2f6c 6174 6573 742f 0a0a 2020 2020 2020  /latest/..      
-00024a90: 2020 466f 7220 5061 7274 6961 6c20 4465    For Partial De
-00024aa0: 7065 6e64 656e 6365 2050 6c6f 7420 3a20  pendence Plot : 
-00024ab0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-00024ac0: 6f6d 2f53 6175 6365 4361 742f 5044 5062  om/SauceCat/PDPb
-00024ad0: 6f78 0a0a 2020 2020 2020 2020 4578 616d  ox..        Exam
-00024ae0: 706c 650a 2020 2020 2020 2020 2d2d 2d2d  ple.        ----
-00024af0: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
-00024b00: 6672 6f6d 2070 7963 6172 6574 2e64 6174  from pycaret.dat
-00024b10: 6173 6574 7320 696d 706f 7274 2067 6574  asets import get
-00024b20: 5f64 6174 610a 2020 2020 2020 2020 3e3e  _data.        >>
-00024b30: 3e20 6a75 6963 6520 3d20 6765 745f 6461  > juice = get_da
-00024b40: 7461 2827 6a75 6963 6527 290a 2020 2020  ta('juice').    
-00024b50: 2020 2020 3e3e 3e20 6578 7065 7269 6d65      >>> experime
-00024b60: 6e74 5f6e 616d 6520 3d20 7365 7475 7028  nt_name = setup(
-00024b70: 6461 7461 203d 206a 7569 6365 2c20 2074  data = juice,  t
-00024b80: 6172 6765 7420 3d20 2750 7572 6368 6173  arget = 'Purchas
-00024b90: 6527 290a 2020 2020 2020 2020 3e3e 3e20  e').        >>> 
-00024ba0: 6474 203d 2063 7265 6174 655f 6d6f 6465  dt = create_mode
-00024bb0: 6c28 2764 7427 290a 2020 2020 2020 2020  l('dt').        
-00024bc0: 3e3e 3e20 696e 7465 7270 7265 745f 6d6f  >>> interpret_mo
-00024bd0: 6465 6c28 6474 290a 0a20 2020 2020 2020  del(dt)..       
-00024be0: 2054 6869 7320 7769 6c6c 2072 6574 7572   This will retur
-00024bf0: 6e20 6120 7375 6d6d 6172 7920 696e 7465  n a summary inte
-00024c00: 7270 7265 7461 7469 6f6e 2070 6c6f 7420  rpretation plot 
-00024c10: 6f66 2044 6563 6973 696f 6e20 5472 6565  of Decision Tree
-00024c20: 206d 6f64 656c 2e0a 0a20 2020 2020 2020   model...       
-00024c30: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00024c40: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00024c50: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
-00024c60: 203a 206f 626a 6563 742c 2064 6566 6175   : object, defau
-00024c70: 6c74 203d 206e 6f6e 650a 2020 2020 2020  lt = none.      
-00024c80: 2020 2020 2020 4120 7472 6169 6e65 6420        A trained 
-00024c90: 6d6f 6465 6c20 6f62 6a65 6374 2074 6f20  model object to 
-00024ca0: 6265 2070 6173 7365 6420 6173 2061 6e20  be passed as an 
-00024cb0: 6573 7469 6d61 746f 722e 204f 6e6c 7920  estimator. Only 
-00024cc0: 7472 6565 2d62 6173 6564 0a20 2020 2020  tree-based.     
-00024cd0: 2020 2020 2020 206d 6f64 656c 7320 6172         models ar
-00024ce0: 6520 6163 6365 7074 6564 2077 6865 6e20  e accepted when 
-00024cf0: 706c 6f74 2074 7970 6520 6973 2027 7375  plot type is 'su
-00024d00: 6d6d 6172 7927 2c20 2763 6f72 7265 6c61  mmary', 'correla
-00024d10: 7469 6f6e 272c 206f 720a 2020 2020 2020  tion', or.      
-00024d20: 2020 2020 2020 2772 6561 736f 6e27 2e20        'reason'. 
-00024d30: 2770 6470 2720 706c 6f74 2069 7320 6d6f  'pdp' plot is mo
-00024d40: 6465 6c20 6167 6e6f 7374 6963 2e0a 0a20  del agnostic... 
-00024d50: 2020 2020 2020 2070 6c6f 7420 3a20 7374         plot : st
-00024d60: 722c 2064 6566 6175 6c74 203d 2027 7375  r, default = 'su
-00024d70: 6d6d 6172 7927 0a20 2020 2020 2020 2020  mmary'.         
-00024d80: 2020 2041 6262 7265 7669 6174 696f 6e20     Abbreviation 
-00024d90: 6f66 2074 7970 6520 6f66 2070 6c6f 742e  of type of plot.
-00024da0: 2054 6865 2063 7572 7265 6e74 206c 6973   The current lis
-00024db0: 7420 6f66 2070 6c6f 7473 2073 7570 706f  t of plots suppo
-00024dc0: 7274 6564 0a20 2020 2020 2020 2020 2020  rted.           
-00024dd0: 2061 7265 2028 506c 6f74 202d 204e 616d   are (Plot - Nam
-00024de0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-00024df0: 2a20 2773 756d 6d61 7279 2720 2d20 5375  * 'summary' - Su
-00024e00: 6d6d 6172 7920 506c 6f74 2075 7369 6e67  mmary Plot using
-00024e10: 2053 4841 500a 2020 2020 2020 2020 2020   SHAP.          
-00024e20: 2020 2a20 2763 6f72 7265 6c61 7469 6f6e    * 'correlation
-00024e30: 2720 2d20 4465 7065 6e64 656e 6365 2050  ' - Dependence P
-00024e40: 6c6f 7420 7573 696e 6720 5348 4150 0a20  lot using SHAP. 
-00024e50: 2020 2020 2020 2020 2020 202a 2027 7265             * 're
-00024e60: 6173 6f6e 2720 2d20 466f 7263 6520 506c  ason' - Force Pl
-00024e70: 6f74 2075 7369 6e67 2053 4841 500a 2020  ot using SHAP.  
-00024e80: 2020 2020 2020 2020 2020 2a20 2770 6470            * 'pdp
-00024e90: 2720 2d20 5061 7274 6961 6c20 4465 7065  ' - Partial Depe
-00024ea0: 6e64 656e 6365 2050 6c6f 740a 2020 2020  ndence Plot.    
-00024eb0: 2020 2020 2020 2020 2a20 276d 7361 2720          * 'msa' 
-00024ec0: 2d20 4d6f 7272 6973 2053 656e 7369 7469  - Morris Sensiti
-00024ed0: 7669 7479 2041 6e61 6c79 7369 730a 2020  vity Analysis.  
-00024ee0: 2020 2020 2020 2020 2020 2a20 2770 6669            * 'pfi
-00024ef0: 2720 2d20 5065 726d 7574 6174 696f 6e20  ' - Permutation 
-00024f00: 4665 6174 7572 6520 496d 706f 7274 616e  Feature Importan
-00024f10: 6365 0a0a 2020 2020 2020 2020 6665 6174  ce..        feat
-00024f20: 7572 653a 2073 7472 2c20 6465 6661 756c  ure: str, defaul
-00024f30: 7420 3d20 4e6f 6e65 0a20 2020 2020 2020  t = None.       
-00024f40: 2020 2020 2054 6869 7320 7061 7261 6d65       This parame
-00024f50: 7465 7220 6973 206f 6e6c 7920 6e65 6564  ter is only need
-00024f60: 6564 2077 6865 6e20 706c 6f74 203d 2027  ed when plot = '
-00024f70: 636f 7272 656c 6174 696f 6e27 206f 7220  correlation' or 
-00024f80: 2770 6470 272e 0a20 2020 2020 2020 2020  'pdp'..         
-00024f90: 2020 2042 7920 6465 6661 756c 7420 6665     By default fe
-00024fa0: 6174 7572 6520 6973 2073 6574 2074 6f20  ature is set to 
-00024fb0: 4e6f 6e65 2077 6869 6368 206d 6561 6e73  None which means
-00024fc0: 2074 6865 2066 6972 7374 2063 6f6c 756d   the first colum
-00024fd0: 6e20 6f66 2074 6865 0a20 2020 2020 2020  n of the.       
-00024fe0: 2020 2020 2064 6174 6173 6574 2077 696c       dataset wil
-00024ff0: 6c20 6265 2075 7365 6420 6173 2061 2076  l be used as a v
-00025000: 6172 6961 626c 652e 2041 2066 6561 7475  ariable. A featu
-00025010: 7265 2070 6172 616d 6574 6572 206d 7573  re parameter mus
-00025020: 7420 6265 2070 6173 7365 640a 2020 2020  t be passed.    
-00025030: 2020 2020 2020 2020 746f 2063 6861 6e67          to chang
-00025040: 6520 7468 6973 2e0a 0a20 2020 2020 2020  e this...       
-00025050: 206f 6273 6572 7661 7469 6f6e 3a20 696e   observation: in
-00025060: 7465 6765 722c 2064 6566 6175 6c74 203d  teger, default =
-00025070: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
-00025080: 2020 5468 6973 2070 6172 616d 6574 6572    This parameter
-00025090: 206f 6e6c 7920 636f 6d65 7320 696e 746f   only comes into
-000250a0: 2065 6666 6563 7420 7768 656e 2070 6c6f   effect when plo
-000250b0: 7420 6973 2073 6574 2074 6f20 2772 6561  t is set to 'rea
-000250c0: 736f 6e27 2e20 4966 206e 6f0a 2020 2020  son'. If no.    
-000250d0: 2020 2020 2020 2020 6f62 7365 7276 6174          observat
-000250e0: 696f 6e20 6e75 6d62 6572 2069 7320 7072  ion number is pr
-000250f0: 6f76 6964 6564 2c20 6974 2077 696c 6c20  ovided, it will 
-00025100: 7265 7475 726e 2061 6e20 616e 616c 7973  return an analys
-00025110: 6973 206f 6620 616c 6c20 6f62 7365 7276  is of all observ
-00025120: 6174 696f 6e73 0a20 2020 2020 2020 2020  ations.         
-00025130: 2020 2077 6974 6820 7468 6520 6f70 7469     with the opti
-00025140: 6f6e 2074 6f20 7365 6c65 6374 2074 6865  on to select the
-00025150: 2066 6561 7475 7265 206f 6e20 7820 616e   feature on x an
-00025160: 6420 7920 6178 6573 2074 6872 6f75 6768  d y axes through
-00025170: 2064 726f 7020 646f 776e 0a20 2020 2020   drop down.     
-00025180: 2020 2020 2020 2069 6e74 6572 6163 7469         interacti
-00025190: 7669 7479 2e20 466f 7220 616e 616c 7973  vity. For analys
-000251a0: 6973 2061 7420 7468 6520 7361 6d70 6c65  is at the sample
-000251b0: 206c 6576 656c 2c20 616e 206f 6273 6572   level, an obser
-000251c0: 7661 7469 6f6e 2070 6172 616d 6574 6572  vation parameter
-000251d0: 206d 7573 740a 2020 2020 2020 2020 2020   must.          
-000251e0: 2020 6265 2070 6173 7365 6420 7769 7468    be passed with
-000251f0: 2074 6865 2069 6e64 6578 2076 616c 7565   the index value
-00025200: 206f 6620 7468 6520 6f62 7365 7276 6174   of the observat
-00025210: 696f 6e20 696e 2074 6573 7420 2f20 686f  ion in test / ho
-00025220: 6c64 2d6f 7574 2073 6574 2e0a 0a20 2020  ld-out set...   
-00025230: 2020 2020 2075 7365 5f74 7261 696e 5f64       use_train_d
-00025240: 6174 613a 2062 6f6f 6c2c 2064 6566 6175  ata: bool, defau
-00025250: 6c74 203d 2046 616c 7365 0a20 2020 2020  lt = False.     
-00025260: 2020 2020 2020 2057 6865 6e20 7365 7420         When set 
-00025270: 746f 2074 7275 652c 2074 7261 696e 2064  to true, train d
-00025280: 6174 6120 7769 6c6c 2062 6520 7573 6564  ata will be used
-00025290: 2066 6f72 2070 6c6f 7473 2c20 696e 7374   for plots, inst
-000252a0: 6561 640a 2020 2020 2020 2020 2020 2020  ead.            
-000252b0: 6f66 2074 6573 7420 6461 7461 2e0a 0a20  of test data... 
-000252c0: 2020 2020 2020 2058 5f6e 6577 5f73 616d         X_new_sam
-000252d0: 706c 653a 2070 642e 4461 7461 4672 616d  ple: pd.DataFram
-000252e0: 652c 2064 6566 6175 6c74 203d 204e 6f6e  e, default = Non
-000252f0: 650a 2020 2020 2020 2020 2020 2020 526f  e.            Ro
-00025300: 7720 6672 6f6d 2061 6e20 6f75 742d 6f66  w from an out-of
-00025310: 2d73 616d 706c 6520 6461 7461 6672 616d  -sample datafram
-00025320: 6520 286e 6569 7468 6572 2074 7261 696e  e (neither train
-00025330: 206e 6f72 2074 6573 7420 6461 7461 2920   nor test data) 
-00025340: 746f 2062 6520 706c 6f74 7465 642e 0a20  to be plotted.. 
-00025350: 2020 2020 2020 2020 2020 2054 6865 2073             The s
-00025360: 616d 706c 6520 6d75 7374 2068 6176 6520  ample must have 
-00025370: 7468 6520 7361 6d65 2063 6f6c 756d 6e73  the same columns
-00025380: 2061 7320 7468 6520 7261 7720 696e 7075   as the raw inpu
-00025390: 7420 7472 6169 6e20 6461 7461 2c20 616e  t train data, an
-000253a0: 6420 6974 2069 7320 7472 616e 7366 6f72  d it is transfor
-000253b0: 6d65 640a 2020 2020 2020 2020 2020 2020  med.            
-000253c0: 6279 2074 6865 2070 7265 7072 6f63 6573  by the preproces
-000253d0: 7369 6e67 2070 6970 656c 696e 6520 6175  sing pipeline au
-000253e0: 746f 6d61 7469 6361 6c6c 7920 6265 666f  tomatically befo
-000253f0: 7265 2070 6c6f 7474 696e 672e 0a0a 2020  re plotting...  
-00025400: 2020 2020 2020 795f 6e65 775f 7361 6d70        y_new_samp
-00025410: 6c65 3a20 7064 2e44 6174 6146 7261 6d65  le: pd.DataFrame
-00025420: 2c20 6465 6661 756c 7420 3d20 4e6f 6e65  , default = None
-00025430: 0a20 2020 2020 2020 2020 2020 2052 6f77  .            Row
-00025440: 2066 726f 6d20 616e 206f 7574 2d6f 662d   from an out-of-
-00025450: 7361 6d70 6c65 2064 6174 6166 7261 6d65  sample dataframe
-00025460: 2028 6e65 6974 6865 7220 7472 6169 6e20   (neither train 
-00025470: 6e6f 7220 7465 7374 2064 6174 6129 2074  nor test data) t
-00025480: 6f20 6265 2070 6c6f 7474 6564 2e0a 2020  o be plotted..  
-00025490: 2020 2020 2020 2020 2020 5468 6520 7361            The sa
-000254a0: 6d70 6c65 206d 7573 7420 6861 7665 2074  mple must have t
-000254b0: 6865 2073 616d 6520 636f 6c75 6d6e 7320  he same columns 
-000254c0: 6173 2074 6865 2072 6177 2069 6e70 7574  as the raw input
-000254d0: 206c 6162 656c 2064 6174 612c 2061 6e64   label data, and
-000254e0: 2069 7420 6973 2074 7261 6e73 666f 726d   it is transform
-000254f0: 6564 0a20 2020 2020 2020 2020 2020 2062  ed.            b
-00025500: 7920 7468 6520 7072 6570 726f 6365 7373  y the preprocess
-00025510: 696e 6720 7069 7065 6c69 6e65 2061 7574  ing pipeline aut
-00025520: 6f6d 6174 6963 616c 6c79 2062 6566 6f72  omatically befor
-00025530: 6520 706c 6f74 7469 6e67 2e0a 0a20 2020  e plotting...   
-00025540: 2020 2020 2073 6176 653a 2073 7472 696e       save: strin
-00025550: 6720 6f72 2062 6f6f 6c2c 2064 6566 6175  g or bool, defau
-00025560: 6c74 203d 2046 616c 7365 0a20 2020 2020  lt = False.     
-00025570: 2020 2020 2020 2057 6865 6e20 7365 7420         When set 
-00025580: 746f 2054 7275 652c 2050 6c6f 7420 6973  to True, Plot is
-00025590: 2073 6176 6564 2061 7320 6120 2770 6e67   saved as a 'png
-000255a0: 2720 6669 6c65 2069 6e20 6375 7272 656e  ' file in curren
-000255b0: 7420 776f 726b 696e 6720 6469 7265 6374  t working direct
-000255c0: 6f72 792e 0a20 2020 2020 2020 2020 2020  ory..           
-000255d0: 2057 6865 6e20 6120 7061 7468 2064 6573   When a path des
-000255e0: 7469 6e61 7469 6f6e 2069 7320 6769 7665  tination is give
-000255f0: 6e2c 2050 6c6f 7420 6973 2073 6176 6564  n, Plot is saved
-00025600: 2061 7320 6120 2770 6e67 2720 6669 6c65   as a 'png' file
-00025610: 2074 6865 2067 6976 656e 2070 6174 6820   the given path 
-00025620: 746f 2074 6865 2064 6972 6563 746f 7279  to the directory
-00025630: 206f 6620 6368 6f69 6365 2e0a 0a20 2020   of choice...   
-00025640: 2020 2020 202a 2a6b 7761 7267 733a 0a20       **kwargs:. 
-00025650: 2020 2020 2020 2020 2020 2041 6464 6974             Addit
-00025660: 696f 6e61 6c20 6b65 7977 6f72 6420 6172  ional keyword ar
-00025670: 6775 6d65 6e74 7320 746f 2070 6173 7320  guments to pass 
-00025680: 746f 2074 6865 2070 6c6f 742e 0a0a 2020  to the plot...  
-00025690: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
-000256a0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-000256b0: 2020 2020 2020 5669 7375 616c 5f50 6c6f        Visual_Plo
-000256c0: 740a 2020 2020 2020 2020 2020 2020 5265  t.            Re
-000256d0: 7475 726e 7320 7468 6520 7669 7375 616c  turns the visual
-000256e0: 2070 6c6f 742e 0a20 2020 2020 2020 2020   plot..         
-000256f0: 2020 2052 6574 7572 6e73 2074 6865 2069     Returns the i
-00025700: 6e74 6572 6163 7469 7665 204a 5320 706c  nteractive JS pl
-00025710: 6f74 2077 6865 6e20 706c 6f74 203d 2027  ot when plot = '
-00025720: 7265 6173 6f6e 272e 0a0a 2020 2020 2020  reason'...      
-00025730: 2020 5761 726e 696e 6773 0a20 2020 2020    Warnings.     
-00025740: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00025750: 2020 2020 2d20 696e 7465 7270 7265 745f      - interpret_
-00025760: 6d6f 6465 6c20 646f 6573 6e27 7420 7375  model doesn't su
-00025770: 7070 6f72 7420 6d75 6c74 6963 6c61 7373  pport multiclass
-00025780: 2070 726f 626c 656d 732e 0a0a 2020 2020   problems...    
-00025790: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-000257a0: 2066 756e 6374 696f 6e5f 7061 7261 6d73   function_params
-000257b0: 5f73 7472 203d 2022 2c20 222e 6a6f 696e  _str = ", ".join
-000257c0: 285b 6622 7b6b 7d3d 7b76 7d22 2066 6f72  ([f"{k}={v}" for
-000257d0: 206b 2c20 7620 696e 206c 6f63 616c 7328   k, v in locals(
-000257e0: 292e 6974 656d 7328 295d 290a 0a20 2020  ).items()])..   
-000257f0: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
-00025800: 2e69 6e66 6f28 2249 6e69 7469 616c 697a  .info("Initializ
-00025810: 696e 6720 696e 7465 7270 7265 745f 6d6f  ing interpret_mo
-00025820: 6465 6c28 2922 290a 2020 2020 2020 2020  del()").        
-00025830: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
-00025840: 2866 2269 6e74 6572 7072 6574 5f6d 6f64  (f"interpret_mod
-00025850: 656c 287b 6675 6e63 7469 6f6e 5f70 6172  el({function_par
-00025860: 616d 735f 7374 727d 2922 290a 0a20 2020  ams_str})")..   
-00025870: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
-00025880: 2e69 6e66 6f28 2243 6865 636b 696e 6720  .info("Checking 
-00025890: 6578 6365 7074 696f 6e73 2229 0a0a 2020  exceptions")..  
-000258a0: 2020 2020 2020 2320 6368 6563 6b69 6e67        # checking
-000258b0: 2069 6620 7368 6170 2061 7661 696c 6162   if shap availab
-000258c0: 6c65 0a20 2020 2020 2020 2069 6620 706c  le.        if pl
-000258d0: 6f74 2069 6e20 5b22 7375 6d6d 6172 7922  ot in ["summary"
-000258e0: 2c20 2263 6f72 7265 6c61 7469 6f6e 222c  , "correlation",
-000258f0: 2022 7265 6173 6f6e 225d 3a0a 2020 2020   "reason"]:.    
-00025900: 2020 2020 2020 2020 5f63 6865 636b 5f73          _check_s
-00025910: 6f66 745f 6465 7065 6e64 656e 6369 6573  oft_dependencies
-00025920: 2822 7368 6170 222c 2065 7874 7261 3d22  ("shap", extra="
-00025930: 616e 616c 7973 6973 222c 2073 6576 6572  analysis", sever
-00025940: 6974 793d 2265 7272 6f72 2229 0a20 2020  ity="error").   
-00025950: 2020 2020 2020 2020 2069 6d70 6f72 7420           import 
-00025960: 7368 6170 0a0a 2020 2020 2020 2020 2320  shap..        # 
-00025970: 6368 6563 6b69 6e67 2069 6620 7064 7062  checking if pdpb
-00025980: 6f78 2069 7320 6176 6169 6c61 626c 650a  ox is available.
-00025990: 2020 2020 2020 2020 6966 2070 6c6f 7420          if plot 
-000259a0: 3d3d 2022 7064 7022 3a0a 2020 2020 2020  == "pdp":.      
-000259b0: 2020 2020 2020 5f63 6865 636b 5f73 6f66        _check_sof
-000259c0: 745f 6465 7065 6e64 656e 6369 6573 2822  t_dependencies("
-000259d0: 696e 7465 7270 7265 7422 2c20 6578 7472  interpret", extr
-000259e0: 613d 2261 6e61 6c79 7369 7322 2c20 7365  a="analysis", se
-000259f0: 7665 7269 7479 3d22 6572 726f 7222 290a  verity="error").
-00025a00: 0a20 2020 2020 2020 2023 2063 6865 636b  .        # check
-00025a10: 696e 6720 696e 7465 7270 7265 7420 6973  ing interpret is
-00025a20: 2061 7661 696c 6162 6c65 0a20 2020 2020   available.     
-00025a30: 2020 2069 6620 706c 6f74 203d 3d20 226d     if plot == "m
-00025a40: 7361 223a 0a20 2020 2020 2020 2020 2020  sa":.           
-00025a50: 205f 6368 6563 6b5f 736f 6674 5f64 6570   _check_soft_dep
-00025a60: 656e 6465 6e63 6965 7328 2269 6e74 6572  endencies("inter
-00025a70: 7072 6574 222c 2065 7874 7261 3d22 616e  pret", extra="an
-00025a80: 616c 7973 6973 222c 2073 6576 6572 6974  alysis", severit
-00025a90: 793d 2265 7272 6f72 2229 0a0a 2020 2020  y="error")..    
-00025aa0: 2020 2020 2320 6368 6563 6b69 6e67 2069      # checking i
-00025ab0: 6e74 6572 7072 6574 2d63 6f6d 6d75 6e69  nterpret-communi
-00025ac0: 7479 2069 7320 6176 6169 6c61 626c 650a  ty is available.
-00025ad0: 2020 2020 2020 2020 6966 2070 6c6f 7420          if plot 
-00025ae0: 3d3d 2022 7066 6922 3a0a 2020 2020 2020  == "pfi":.      
-00025af0: 2020 2020 2020 5f63 6865 636b 5f73 6f66        _check_sof
-00025b00: 745f 6465 7065 6e64 656e 6369 6573 280a  t_dependencies(.
-00025b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025b20: 2269 6e74 6572 7072 6574 5f63 6f6d 6d75  "interpret_commu
-00025b30: 6e69 7479 222c 0a20 2020 2020 2020 2020  nity",.         
-00025b40: 2020 2020 2020 2065 7874 7261 3d4e 6f6e         extra=Non
-00025b50: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00025b60: 2020 2073 6576 6572 6974 793d 2265 7272     severity="err
-00025b70: 6f72 222c 0a20 2020 2020 2020 2020 2020  or",.           
-00025b80: 2020 2020 2069 6e73 7461 6c6c 5f6e 616d       install_nam
-00025b90: 653d 2269 6e74 6572 7072 6574 2d63 6f6d  e="interpret-com
-00025ba0: 6d75 6e69 7479 222c 0a20 2020 2020 2020  munity",.       
-00025bb0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00025bc0: 2320 6765 7420 6573 7469 6d61 746f 7220  # get estimator 
-00025bd0: 6672 6f6d 206d 6574 6120 6573 7469 6d61  from meta estima
-00025be0: 746f 720a 2020 2020 2020 2020 6573 7469  tor.        esti
-00025bf0: 6d61 746f 7220 3d20 6765 745f 6573 7469  mator = get_esti
-00025c00: 6d61 746f 725f 6672 6f6d 5f6d 6574 615f  mator_from_meta_
-00025c10: 6573 7469 6d61 746f 7228 6573 7469 6d61  estimator(estima
-00025c20: 746f 7229 0a0a 2020 2020 2020 2020 2320  tor)..        # 
-00025c30: 616c 6c6f 7765 6420 6d6f 6465 6c73 0a20  allowed models. 
-00025c40: 2020 2020 2020 206d 6f64 656c 5f69 6420         model_id 
-00025c50: 3d20 7365 6c66 2e5f 6765 745f 6d6f 6465  = self._get_mode
-00025c60: 6c5f 6964 2865 7374 696d 6174 6f72 290a  l_id(estimator).
-00025c70: 0a20 2020 2020 2020 2073 6861 705f 6d6f  .        shap_mo
-00025c80: 6465 6c73 203d 207b 6b3a 2076 2066 6f72  dels = {k: v for
-00025c90: 206b 2c20 7620 696e 2073 656c 662e 5f61   k, v in self._a
-00025ca0: 6c6c 5f6d 6f64 656c 735f 696e 7465 726e  ll_models_intern
-00025cb0: 616c 2e69 7465 6d73 2829 2069 6620 762e  al.items() if v.
-00025cc0: 7368 6170 7d0a 2020 2020 2020 2020 7368  shap}.        sh
-00025cd0: 6170 5f6d 6f64 656c 735f 6964 7320 3d20  ap_models_ids = 
-00025ce0: 7365 7428 7368 6170 5f6d 6f64 656c 732e  set(shap_models.
-00025cf0: 6b65 7973 2829 290a 0a20 2020 2020 2020  keys())..       
-00025d00: 2069 6620 706c 6f74 2069 6e20 5b22 7375   if plot in ["su
-00025d10: 6d6d 6172 7922 2c20 2263 6f72 7265 6c61  mmary", "correla
-00025d20: 7469 6f6e 222c 2022 7265 6173 6f6e 225d  tion", "reason"]
-00025d30: 2061 6e64 2028 0a20 2020 2020 2020 2020   and (.         
-00025d40: 2020 206d 6f64 656c 5f69 6420 6e6f 7420     model_id not 
-00025d50: 696e 2073 6861 705f 6d6f 6465 6c73 5f69  in shap_models_i
-00025d60: 6473 0a20 2020 2020 2020 2029 3a0a 2020  ds.        ):.  
-00025d70: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00025d80: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
-00025d90: 2020 2020 2020 2020 2020 2066 2254 6869             f"Thi
-00025da0: 7320 6675 6e63 7469 6f6e 206f 6e6c 7920  s function only 
-00025db0: 7375 7070 6f72 7473 2074 7265 6520 6261  supports tree ba
-00025dc0: 7365 6420 6d6f 6465 6c73 2066 6f72 2062  sed models for b
-00025dd0: 696e 6172 7920 636c 6173 7369 6669 6361  inary classifica
-00025de0: 7469 6f6e 3a20 7b27 2c20 272e 6a6f 696e  tion: {', '.join
-00025df0: 2873 6861 705f 6d6f 6465 6c73 5f69 6473  (shap_models_ids
-00025e00: 297d 2e22 0a20 2020 2020 2020 2020 2020  )}.".           
-00025e10: 2029 0a0a 2020 2020 2020 2020 2320 706c   )..        # pl
-00025e20: 6f74 2074 7970 650a 2020 2020 2020 2020  ot type.        
-00025e30: 616c 6c6f 7765 645f 7479 7065 7320 3d20  allowed_types = 
-00025e40: 5b22 7375 6d6d 6172 7922 2c20 2263 6f72  ["summary", "cor
-00025e50: 7265 6c61 7469 6f6e 222c 2022 7265 6173  relation", "reas
-00025e60: 6f6e 222c 2022 7064 7022 2c20 226d 7361  on", "pdp", "msa
-00025e70: 222c 2022 7066 6922 5d0a 2020 2020 2020  ", "pfi"].      
-00025e80: 2020 6966 2070 6c6f 7420 6e6f 7420 696e    if plot not in
-00025e90: 2061 6c6c 6f77 6564 5f74 7970 6573 3a0a   allowed_types:.
-00025ea0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00025eb0: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
-00025ec0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-00025ed0: 7479 7065 2070 6172 616d 6574 6572 206f  type parameter o
-00025ee0: 6e6c 7920 6163 6365 7074 7320 7b27 2c20  nly accepts {', 
-00025ef0: 272e 6a6f 696e 286c 6973 7428 616c 6c6f  '.join(list(allo
-00025f00: 7765 645f 7479 7065 7329 202b 2073 7472  wed_types) + str
-00025f10: 284e 6f6e 6529 297d 2e22 0a20 2020 2020  (None))}.".     
-00025f20: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00025f30: 2020 6966 2058 5f6e 6577 5f73 616d 706c    if X_new_sampl
-00025f40: 6520 6973 206e 6f74 204e 6f6e 6520 616e  e is not None an
-00025f50: 6420 286f 6273 6572 7661 7469 6f6e 2069  d (observation i
-00025f60: 7320 6e6f 7420 4e6f 6e65 206f 7220 7573  s not None or us
-00025f70: 655f 7472 6169 6e5f 6461 7461 293a 0a20  e_train_data):. 
-00025f80: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00025f90: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-00025fa0: 2020 2020 2020 2020 2020 2020 2022 5370               "Sp
-00025fb0: 6563 6966 7969 6e67 2027 585f 6e65 775f  ecifying 'X_new_
-00025fc0: 7361 6d70 6c65 2720 616e 6420 2827 6f62  sample' and ('ob
-00025fd0: 7365 7276 6174 696f 6e27 206f 7220 2775  servation' or 'u
-00025fe0: 7365 5f74 7261 696e 5f64 6174 6127 2920  se_train_data') 
-00025ff0: 6973 2061 6d62 6967 756f 7573 2e22 0a20  is ambiguous.". 
-00026000: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00026010: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00026020: 2020 4572 726f 7220 4368 6563 6b69 6e67    Error Checking
-00026030: 2045 6e64 7320 6865 7265 0a0a 2020 2020   Ends here..    
-00026040: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-00026050: 2023 2053 746f 7269 6e67 2058 5f74 7261   # Storing X_tra
-00026060: 696e 2061 6e64 2079 5f74 7261 696e 2069  in and y_train i
-00026070: 6e20 6461 7461 5f58 2061 6e64 2064 6174  n data_X and dat
-00026080: 615f 7920 7061 7261 6d65 7465 720a 2020  a_y parameter.  
-00026090: 2020 2020 2020 6966 2058 5f6e 6577 5f73        if X_new_s
-000260a0: 616d 706c 6520 6973 206e 6f74 204e 6f6e  ample is not Non
-000260b0: 653a 0a20 2020 2020 2020 2020 2020 2074  e:.            t
-000260c0: 6573 745f 5820 3d20 7365 6c66 2e70 6970  est_X = self.pip
-000260d0: 656c 696e 652e 7472 616e 7366 6f72 6d28  eline.transform(
-000260e0: 585f 6e65 775f 7361 6d70 6c65 290a 2020  X_new_sample).  
-000260f0: 2020 2020 2020 2020 2020 6966 2070 6c6f            if plo
-00026100: 7420 3d3d 2022 7066 6922 3a0a 2020 2020  t == "pfi":.    
-00026110: 2020 2020 2020 2020 2020 2020 7465 7374              test
-00026120: 5f79 203d 2073 656c 662e 7069 7065 6c69  _y = self.pipeli
-00026130: 6e65 2e74 7261 6e73 666f 726d 2879 5f6e  ne.transform(y_n
-00026140: 6577 5f73 616d 706c 6529 2020 2320 6164  ew_sample)  # ad
-00026150: 6420 666f 7220 7066 6920 6578 706c 6169  d for pfi explai
-00026160: 6e65 720a 2020 2020 2020 2020 656c 7365  ner.        else
-00026170: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-00026180: 5374 6f72 696e 6720 585f 7472 6169 6e20  Storing X_train 
-00026190: 616e 6420 795f 7472 6169 6e20 696e 2064  and y_train in d
-000261a0: 6174 615f 5820 616e 6420 6461 7461 5f79  ata_X and data_y
-000261b0: 2070 6172 616d 6574 6572 0a20 2020 2020   parameter.     
-000261c0: 2020 2020 2020 2069 6620 7573 655f 7472         if use_tr
-000261d0: 6169 6e5f 6461 7461 3a0a 2020 2020 2020  ain_data:.      
-000261e0: 2020 2020 2020 2020 2020 7465 7374 5f58            test_X
-000261f0: 203d 2073 656c 662e 585f 7472 6169 6e5f   = self.X_train_
-00026200: 7472 616e 7366 6f72 6d65 640a 2020 2020  transformed.    
-00026210: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00026220: 2020 2020 2020 2020 2020 2020 2020 7465                te
-00026230: 7374 5f58 203d 2073 656c 662e 585f 7465  st_X = self.X_te
-00026240: 7374 5f74 7261 6e73 666f 726d 6564 0a20  st_transformed. 
-00026250: 2020 2020 2020 2020 2020 2069 6620 706c             if pl
-00026260: 6f74 203d 3d20 2270 6669 223a 0a20 2020  ot == "pfi":.   
-00026270: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00026280: 7573 655f 7472 6169 6e5f 6461 7461 3a0a  use_train_data:.
-00026290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000262a0: 2020 2020 7465 7374 5f79 203d 2073 656c      test_y = sel
-000262b0: 662e 795f 7472 6169 6e5f 7472 616e 7366  f.y_train_transf
-000262c0: 6f72 6d65 640a 2020 2020 2020 2020 2020  ormed.          
-000262d0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000262e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000262f0: 7465 7374 5f79 203d 2073 656c 662e 795f  test_y = self.y_
-00026300: 7465 7374 5f74 7261 6e73 666f 726d 6564  test_transformed
-00026310: 0a0a 2020 2020 2020 2020 6e70 2e72 616e  ..        np.ran
-00026320: 646f 6d2e 7365 6564 2873 656c 662e 7365  dom.seed(self.se
-00026330: 6564 290a 0a20 2020 2020 2020 2023 2073  ed)..        # s
-00026340: 746f 7269 6e67 2065 7374 696d 6174 6f72  toring estimator
-00026350: 2069 6e20 6d6f 6465 6c20 7661 7269 6162   in model variab
-00026360: 6c65 0a20 2020 2020 2020 206d 6f64 656c  le.        model
-00026370: 203d 2065 7374 696d 6174 6f72 0a0a 2020   = estimator..  
-00026380: 2020 2020 2020 2320 6465 6669 6e69 6e67        # defining
-00026390: 2074 7970 6520 6f66 2063 6c61 7373 6966   type of classif
-000263a0: 6965 720a 2020 2020 2020 2020 7368 6170  ier.        shap
-000263b0: 5f6d 6f64 656c 735f 7479 7065 3120 3d20  _models_type1 = 
-000263c0: 7b6b 2066 6f72 206b 2c20 7620 696e 2073  {k for k, v in s
-000263d0: 6861 705f 6d6f 6465 6c73 2e69 7465 6d73  hap_models.items
-000263e0: 2829 2069 6620 762e 7368 6170 203d 3d20  () if v.shap == 
-000263f0: 2274 7970 6531 227d 0a20 2020 2020 2020  "type1"}.       
-00026400: 2073 6861 705f 6d6f 6465 6c73 5f74 7970   shap_models_typ
-00026410: 6532 203d 207b 6b20 666f 7220 6b2c 2076  e2 = {k for k, v
-00026420: 2069 6e20 7368 6170 5f6d 6f64 656c 732e   in shap_models.
-00026430: 6974 656d 7328 2920 6966 2076 2e73 6861  items() if v.sha
-00026440: 7020 3d3d 2022 7479 7065 3222 7d0a 0a20  p == "type2"}.. 
-00026450: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
-00026460: 6572 2e69 6e66 6f28 6622 706c 6f74 2074  er.info(f"plot t
-00026470: 7970 653a 207b 706c 6f74 7d22 290a 0a20  ype: {plot}").. 
-00026480: 2020 2020 2020 2073 6861 705f 706c 6f74         shap_plot
-00026490: 203d 204e 6f6e 650a 0a20 2020 2020 2020   = None..       
-000264a0: 2064 6566 2073 756d 6d61 7279 2873 686f   def summary(sho
-000264b0: 773a 2062 6f6f 6c20 3d20 5472 7565 293a  w: bool = True):
-000264c0: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-000264d0: 6c66 2e6c 6f67 6765 722e 696e 666f 2822  lf.logger.info("
-000264e0: 4372 6561 7469 6e67 2054 7265 6545 7870  Creating TreeExp
-000264f0: 6c61 696e 6572 2229 0a20 2020 2020 2020  lainer").       
-00026500: 2020 2020 2065 7870 6c61 696e 6572 203d       explainer =
-00026510: 2073 6861 702e 5472 6565 4578 706c 6169   shap.TreeExplai
-00026520: 6e65 7228 6d6f 6465 6c29 0a20 2020 2020  ner(model).     
-00026530: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
-00026540: 6572 2e69 6e66 6f28 2243 6f6d 7069 6c69  er.info("Compili
-00026550: 6e67 2073 6861 7020 7661 6c75 6573 2229  ng shap values")
-00026560: 0a20 2020 2020 2020 2020 2020 2073 6861  .            sha
-00026570: 705f 7661 6c75 6573 203d 2065 7870 6c61  p_values = expla
-00026580: 696e 6572 2e73 6861 705f 7661 6c75 6573  iner.shap_values
-00026590: 2874 6573 745f 5829 0a20 2020 2020 2020  (test_X).       
-000265a0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-000265b0: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-000265c0: 206c 656e 2873 6861 705f 7661 6c75 6573   len(shap_values
-000265d0: 2920 3d3d 2032 0a20 2020 2020 2020 2020  ) == 2.         
-000265e0: 2020 2020 2020 2073 6861 705f 706c 6f74         shap_plot
-000265f0: 203d 2073 6861 702e 7375 6d6d 6172 795f   = shap.summary_
-00026600: 706c 6f74 280a 2020 2020 2020 2020 2020  plot(.          
-00026610: 2020 2020 2020 2020 2020 7368 6170 5f76            shap_v
-00026620: 616c 7565 735b 315d 2c20 7465 7374 5f58  alues[1], test_X
-00026630: 2c20 7368 6f77 3d73 686f 772c 202a 2a6b  , show=show, **k
-00026640: 7761 7267 730a 2020 2020 2020 2020 2020  wargs.          
-00026650: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00026660: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
-00026670: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
-00026680: 2020 2020 2020 7368 6170 5f70 6c6f 7420        shap_plot 
-00026690: 3d20 7368 6170 2e73 756d 6d61 7279 5f70  = shap.summary_p
-000266a0: 6c6f 7428 7368 6170 5f76 616c 7565 732c  lot(shap_values,
-000266b0: 2074 6573 745f 582c 2073 686f 773d 7368   test_X, show=sh
-000266c0: 6f77 2c20 2a2a 6b77 6172 6773 290a 2020  ow, **kwargs).  
-000266d0: 2020 2020 2020 2020 2020 6966 2073 6176            if sav
-000266e0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000266f0: 2020 2070 6c6f 745f 6669 6c65 6e61 6d65     plot_filename
-00026700: 203d 2066 2253 4841 5020 7b70 6c6f 747d   = f"SHAP {plot}
-00026710: 2e70 6e67 220a 2020 2020 2020 2020 2020  .png".          
-00026720: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-00026730: 6e73 7461 6e63 6528 7361 7665 2c20 626f  nstance(save, bo
-00026740: 6f6c 293a 0a20 2020 2020 2020 2020 2020  ol):.           
-00026750: 2020 2020 2020 2020 2070 6c6f 745f 6669           plot_fi
-00026760: 6c65 6e61 6d65 203d 206f 732e 7061 7468  lename = os.path
-00026770: 2e6a 6f69 6e28 7361 7665 2c20 706c 6f74  .join(save, plot
-00026780: 5f66 696c 656e 616d 6529 0a20 2020 2020  _filename).     
-00026790: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000267a0: 6c6f 6767 6572 2e69 6e66 6f28 6622 5361  logger.info(f"Sa
-000267b0: 7669 6e67 2027 7b70 6c6f 745f 6669 6c65  ving '{plot_file
-000267c0: 6e61 6d65 7d27 2229 0a20 2020 2020 2020  name}'").       
-000267d0: 2020 2020 2020 2020 2070 6c74 2e73 6176           plt.sav
-000267e0: 6566 6967 2870 6c6f 745f 6669 6c65 6e61  efig(plot_filena
-000267f0: 6d65 2c20 6262 6f78 5f69 6e63 6865 733d  me, bbox_inches=
-00026800: 2274 6967 6874 2229 0a20 2020 2020 2020  "tight").       
-00026810: 2020 2020 2020 2020 2070 6c74 2e63 6c6f           plt.clo
-00026820: 7365 2829 0a20 2020 2020 2020 2020 2020  se().           
-00026830: 2072 6574 7572 6e20 7368 6170 5f70 6c6f   return shap_plo
-00026840: 740a 0a20 2020 2020 2020 2064 6566 2063  t..        def c
-00026850: 6f72 7265 6c61 7469 6f6e 2873 686f 773a  orrelation(show:
-00026860: 2062 6f6f 6c20 3d20 5472 7565 293a 0a0a   bool = True):..
-00026870: 2020 2020 2020 2020 2020 2020 6966 2066              if f
-00026880: 6561 7475 7265 2069 7320 4e6f 6e65 3a0a  eature is None:.
-00026890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000268a0: 2073 656c 662e 6c6f 6767 6572 2e77 6172   self.logger.war
-000268b0: 6e69 6e67 280a 2020 2020 2020 2020 2020  ning(.          
-000268c0: 2020 2020 2020 2020 2020 6622 4e6f 2066            f"No f
-000268d0: 6561 7475 7265 2070 6173 7365 642e 2044  eature passed. D
-000268e0: 6566 6175 6c74 2076 616c 7565 206f 6620  efault value of 
-000268f0: 6665 6174 7572 6520 7573 6564 2066 6f72  feature used for
-00026900: 2063 6f72 7265 6c61 7469 6f6e 2070 6c6f   correlation plo
-00026910: 743a 207b 7465 7374 5f58 2e63 6f6c 756d  t: {test_X.colum
-00026920: 6e73 5b30 5d7d 220a 2020 2020 2020 2020  ns[0]}".        
-00026930: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00026940: 2020 2020 2020 2020 2020 6465 7065 6e64            depend
-00026950: 656e 6365 203d 2074 6573 745f 582e 636f  ence = test_X.co
-00026960: 6c75 6d6e 735b 305d 0a0a 2020 2020 2020  lumns[0]..      
-00026970: 2020 2020 2020 656c 7365 3a0a 0a20 2020        else:..   
-00026980: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00026990: 662e 6c6f 6767 6572 2e77 6172 6e69 6e67  f.logger.warning
-000269a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000269b0: 2020 2020 2020 6622 6665 6174 7572 6520        f"feature 
-000269c0: 7661 6c75 6520 7061 7373 6564 2e20 4665  value passed. Fe
-000269d0: 6174 7572 6520 7573 6564 2066 6f72 2063  ature used for c
-000269e0: 6f72 7265 6c61 7469 6f6e 2070 6c6f 743a  orrelation plot:
-000269f0: 207b 6665 6174 7572 657d 220a 2020 2020   {feature}".    
-00026a00: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00026a10: 2020 2020 2020 2020 2020 2020 2020 6465                de
-00026a20: 7065 6e64 656e 6365 203d 2066 6561 7475  pendence = featu
-00026a30: 7265 0a0a 2020 2020 2020 2020 2020 2020  re..            
-00026a40: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
-00026a50: 2822 4372 6561 7469 6e67 2054 7265 6545  ("Creating TreeE
-00026a60: 7870 6c61 696e 6572 2229 0a20 2020 2020  xplainer").     
-00026a70: 2020 2020 2020 2065 7870 6c61 696e 6572         explainer
-00026a80: 203d 2073 6861 702e 5472 6565 4578 706c   = shap.TreeExpl
-00026a90: 6169 6e65 7228 6d6f 6465 6c29 0a20 2020  ainer(model).   
-00026aa0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
-00026ab0: 6767 6572 2e69 6e66 6f28 2243 6f6d 7069  gger.info("Compi
-00026ac0: 6c69 6e67 2073 6861 7020 7661 6c75 6573  ling shap values
-00026ad0: 2229 0a20 2020 2020 2020 2020 2020 2073  ").            s
-00026ae0: 6861 705f 7661 6c75 6573 203d 2065 7870  hap_values = exp
-00026af0: 6c61 696e 6572 2e73 6861 705f 7661 6c75  lainer.shap_valu
-00026b00: 6573 2874 6573 745f 5829 0a0a 2020 2020  es(test_X)..    
-00026b10: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
-00026b20: 5f69 6420 696e 2073 6861 705f 6d6f 6465  _id in shap_mode
-00026b30: 6c73 5f74 7970 6531 3a0a 2020 2020 2020  ls_type1:.      
-00026b40: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-00026b50: 6f67 6765 722e 696e 666f 2822 6d6f 6465  ogger.info("mode
-00026b60: 6c20 7479 7065 2064 6574 6563 7465 643a  l type detected:
-00026b70: 2074 7970 6520 3122 290a 2020 2020 2020   type 1").      
-00026b80: 2020 2020 2020 2020 2020 7368 6170 2e64            shap.d
-00026b90: 6570 656e 6465 6e63 655f 706c 6f74 280a  ependence_plot(.
-00026ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026bb0: 2020 2020 6465 7065 6e64 656e 6365 2c20      dependence, 
-00026bc0: 7368 6170 5f76 616c 7565 735b 315d 2c20  shap_values[1], 
-00026bd0: 7465 7374 5f58 2c20 7368 6f77 3d73 686f  test_X, show=sho
-00026be0: 772c 202a 2a6b 7761 7267 730a 2020 2020  w, **kwargs.    
-00026bf0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00026c00: 2020 2020 2020 2020 2020 656c 6966 206d            elif m
-00026c10: 6f64 656c 5f69 6420 696e 2073 6861 705f  odel_id in shap_
-00026c20: 6d6f 6465 6c73 5f74 7970 6532 3a0a 2020  models_type2:.  
-00026c30: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00026c40: 6c66 2e6c 6f67 6765 722e 696e 666f 2822  lf.logger.info("
-00026c50: 6d6f 6465 6c20 7479 7065 2064 6574 6563  model type detec
-00026c60: 7465 643a 2074 7970 6520 3222 290a 2020  ted: type 2").  
-00026c70: 2020 2020 2020 2020 2020 2020 2020 7368                sh
-00026c80: 6170 2e64 6570 656e 6465 6e63 655f 706c  ap.dependence_pl
-00026c90: 6f74 280a 2020 2020 2020 2020 2020 2020  ot(.            
-00026ca0: 2020 2020 2020 2020 6465 7065 6e64 656e          dependen
-00026cb0: 6365 2c20 7368 6170 5f76 616c 7565 732c  ce, shap_values,
-00026cc0: 2074 6573 745f 582c 2073 686f 773d 7368   test_X, show=sh
-00026cd0: 6f77 2c20 2a2a 6b77 6172 6773 0a20 2020  ow, **kwargs.   
-00026ce0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00026cf0: 2020 2020 2020 2020 2020 2069 6620 7361             if sa
-00026d00: 7665 3a0a 2020 2020 2020 2020 2020 2020  ve:.            
-00026d10: 2020 2020 706c 6f74 5f66 696c 656e 616d      plot_filenam
-00026d20: 6520 3d20 6622 5348 4150 207b 706c 6f74  e = f"SHAP {plot
-00026d30: 7d2e 706e 6722 0a20 2020 2020 2020 2020  }.png".         
-00026d40: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
-00026d50: 696e 7374 616e 6365 2873 6176 652c 2062  instance(save, b
-00026d60: 6f6f 6c29 3a0a 2020 2020 2020 2020 2020  ool):.          
-00026d70: 2020 2020 2020 2020 2020 706c 6f74 5f66            plot_f
-00026d80: 696c 656e 616d 6520 3d20 6f73 2e70 6174  ilename = os.pat
-00026d90: 682e 6a6f 696e 2873 6176 652c 2070 6c6f  h.join(save, plo
-00026da0: 745f 6669 6c65 6e61 6d65 290a 2020 2020  t_filename).    
-00026db0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00026dc0: 2e6c 6f67 6765 722e 696e 666f 2866 2253  .logger.info(f"S
-00026dd0: 6176 696e 6720 277b 706c 6f74 5f66 696c  aving '{plot_fil
-00026de0: 656e 616d 657d 2722 290a 2020 2020 2020  ename}'").      
-00026df0: 2020 2020 2020 2020 2020 706c 742e 7361            plt.sa
-00026e00: 7665 6669 6728 706c 6f74 5f66 696c 656e  vefig(plot_filen
-00026e10: 616d 652c 2062 626f 785f 696e 6368 6573  ame, bbox_inches
-00026e20: 3d22 7469 6768 7422 290a 2020 2020 2020  ="tight").      
-00026e30: 2020 2020 2020 2020 2020 706c 742e 636c            plt.cl
-00026e40: 6f73 6528 290a 2020 2020 2020 2020 2020  ose().          
-00026e50: 2020 7265 7475 726e 204e 6f6e 650a 0a20    return None.. 
-00026e60: 2020 2020 2020 2064 6566 2072 6561 736f         def reaso
-00026e70: 6e28 7368 6f77 3a20 626f 6f6c 203d 2054  n(show: bool = T
-00026e80: 7275 6529 3a0a 2020 2020 2020 2020 2020  rue):.          
-00026e90: 2020 7368 6170 5f70 6c6f 7420 3d20 4e6f    shap_plot = No
-00026ea0: 6e65 0a20 2020 2020 2020 2020 2020 2069  ne.            i
-00026eb0: 6620 6d6f 6465 6c5f 6964 2069 6e20 7368  f model_id in sh
-00026ec0: 6170 5f6d 6f64 656c 735f 7479 7065 313a  ap_models_type1:
-00026ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026ee0: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
-00026ef0: 6f28 226d 6f64 656c 2074 7970 6520 6465  o("model type de
-00026f00: 7465 6374 6564 3a20 7479 7065 2031 2229  tected: type 1")
-00026f10: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00026f20: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
-00026f30: 666f 2822 4372 6561 7469 6e67 2054 7265  fo("Creating Tre
-00026f40: 6545 7870 6c61 696e 6572 2229 0a20 2020  eExplainer").   
-00026f50: 2020 2020 2020 2020 2020 2020 2065 7870               exp
-00026f60: 6c61 696e 6572 203d 2073 6861 702e 5472  lainer = shap.Tr
-00026f70: 6565 4578 706c 6169 6e65 7228 6d6f 6465  eeExplainer(mode
-00026f80: 6c29 0a20 2020 2020 2020 2020 2020 2020  l).             
-00026f90: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
-00026fa0: 6e66 6f28 2243 6f6d 7069 6c69 6e67 2073  nfo("Compiling s
-00026fb0: 6861 7020 7661 6c75 6573 2229 0a0a 2020  hap values")..  
-00026fc0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00026fd0: 206f 6273 6572 7661 7469 6f6e 2069 7320   observation is 
-00026fe0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00026ff0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-00027000: 6f67 6765 722e 7761 726e 696e 6728 0a20  ogger.warning(. 
-00027010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027020: 2020 2020 2020 2022 4f62 7365 7276 6174         "Observat
-00027030: 696f 6e20 7365 7420 746f 204e 6f6e 652e  ion set to None.
-00027040: 204d 6f64 656c 2061 676e 6f73 7469 6320   Model agnostic 
-00027050: 706c 6f74 2077 696c 6c20 6265 2072 656e  plot will be ren
-00027060: 6465 7265 642e 220a 2020 2020 2020 2020  dered.".        
-00027070: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00027080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027090: 2020 7368 6170 5f76 616c 7565 7320 3d20    shap_values = 
-000270a0: 6578 706c 6169 6e65 722e 7368 6170 5f76  explainer.shap_v
-000270b0: 616c 7565 7328 7465 7374 5f58 290a 2020  alues(test_X).  
-000270c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000270d0: 2020 7368 6170 2e69 6e69 746a 7328 290a    shap.initjs().
-000270e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000270f0: 2020 2020 7368 6170 5f70 6c6f 7420 3d20      shap_plot = 
-00027100: 7368 6170 2e66 6f72 6365 5f70 6c6f 7428  shap.force_plot(
-00027110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027120: 2020 2020 2020 2020 2065 7870 6c61 696e           explain
-00027130: 6572 2e65 7870 6563 7465 645f 7661 6c75  er.expected_valu
-00027140: 655b 315d 2c20 7368 6170 5f76 616c 7565  e[1], shap_value
-00027150: 735b 315d 2c20 7465 7374 5f58 2c20 2a2a  s[1], test_X, **
-00027160: 6b77 6172 6773 0a20 2020 2020 2020 2020  kwargs.         
-00027170: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00027180: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00027190: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000271a0: 2020 2020 2020 2020 726f 775f 746f 5f73          row_to_s
-000271b0: 686f 7720 3d20 6f62 7365 7276 6174 696f  how = observatio
-000271c0: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
-000271d0: 2020 2020 2020 6461 7461 5f66 6f72 5f70        data_for_p
-000271e0: 7265 6469 6374 696f 6e20 3d20 7465 7374  rediction = test
-000271f0: 5f58 2e69 6c6f 635b 726f 775f 746f 5f73  _X.iloc[row_to_s
-00027200: 686f 775d 0a0a 2020 2020 2020 2020 2020  how]..          
-00027210: 2020 2020 2020 2020 2020 6966 206d 6f64            if mod
-00027220: 656c 5f69 6420 3d3d 2022 6c69 6768 7467  el_id == "lightg
-00027230: 626d 223a 0a20 2020 2020 2020 2020 2020  bm":.           
-00027240: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00027250: 662e 6c6f 6767 6572 2e69 6e66 6f28 226d  f.logger.info("m
-00027260: 6f64 656c 2074 7970 6520 6465 7465 6374  odel type detect
-00027270: 6564 3a20 4c47 424d 436c 6173 7369 6669  ed: LGBMClassifi
-00027280: 6572 2229 0a20 2020 2020 2020 2020 2020  er").           
-00027290: 2020 2020 2020 2020 2020 2020 2073 6861               sha
-000272a0: 705f 7661 6c75 6573 203d 2065 7870 6c61  p_values = expla
-000272b0: 696e 6572 2e73 6861 705f 7661 6c75 6573  iner.shap_values
-000272c0: 2874 6573 745f 5829 0a20 2020 2020 2020  (test_X).       
-000272d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000272e0: 2073 6861 702e 696e 6974 6a73 2829 0a20   shap.initjs(). 
-000272f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027300: 2020 2020 2020 2073 6861 705f 706c 6f74         shap_plot
-00027310: 203d 2073 6861 702e 666f 7263 655f 706c   = shap.force_pl
-00027320: 6f74 280a 2020 2020 2020 2020 2020 2020  ot(.            
-00027330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027340: 6578 706c 6169 6e65 722e 6578 7065 6374  explainer.expect
-00027350: 6564 5f76 616c 7565 5b31 5d2c 0a20 2020  ed_value[1],.   
-00027360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027370: 2020 2020 2020 2020 2073 6861 705f 7661           shap_va
-00027380: 6c75 6573 5b30 5d5b 726f 775f 746f 5f73  lues[0][row_to_s
-00027390: 686f 775d 2c0a 2020 2020 2020 2020 2020  how],.          
+0001f050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f060: 2020 6622 4573 7469 6d61 746f 7220 7b69    f"Estimator {i
+0001f070: 7d20 646f 6573 6e27 7420 7375 7070 6f72  } doesn't suppor
+0001f080: 7420 7072 6f62 6162 696c 6974 6965 732c  t probabilities,
+0001f090: 2066 616c 6c69 6e67 2062 6163 6b20 746f   falling back to
+0001f0a0: 2027 6861 7264 272e 220a 2020 2020 2020   'hard'.".      
+0001f0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f0c0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0001f0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f0f0: 2020 2020 6d65 7468 6f64 203d 2022 6861      method = "ha
+0001f100: 7264 220a 2020 2020 2020 2020 2020 2020  rd".            
+0001f110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f120: 2020 2020 2020 2020 6272 6561 6b0a 0a20          break.. 
+0001f130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f140: 2020 2020 2020 2069 6620 6d65 7468 6f64         if method
+0001f150: 203d 3d20 2261 7574 6f22 3a0a 2020 2020   == "auto":.    
+0001f160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f170: 2020 2020 2020 2020 6d65 7468 6f64 203d          method =
+0001f180: 2022 736f 6674 220a 0a20 2020 2020 2020   "soft"..       
+0001f190: 2023 2063 6865 636b 696e 6720 666f 6c64   # checking fold
+0001f1a0: 2070 6172 616d 6574 6572 0a20 2020 2020   parameter.     
+0001f1b0: 2020 2069 6620 666f 6c64 2069 7320 6e6f     if fold is no
+0001f1c0: 7420 4e6f 6e65 2061 6e64 206e 6f74 2028  t None and not (
+0001f1d0: 0a20 2020 2020 2020 2020 2020 2074 7970  .            typ
+0001f1e0: 6528 666f 6c64 2920 6973 2069 6e74 206f  e(fold) is int o
+0001f1f0: 7220 6973 5f73 6b6c 6561 726e 5f63 765f  r is_sklearn_cv_
+0001f200: 6765 6e65 7261 746f 7228 666f 6c64 290a  generator(fold).
+0001f210: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
+0001f220: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+0001f230: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+0001f240: 2020 2020 2020 2020 2266 6f6c 6420 7061          "fold pa
+0001f250: 7261 6d65 7465 7220 6d75 7374 2062 6520  rameter must be 
+0001f260: 6569 7468 6572 204e 6f6e 652c 2061 6e20  either None, an 
+0001f270: 696e 7465 6765 7220 6f72 2061 2073 6369  integer or a sci
+0001f280: 6b69 742d 6c65 6172 6e20 636f 6d70 6174  kit-learn compat
+0001f290: 6962 6c65 2043 5620 6765 6e65 7261 746f  ible CV generato
+0001f2a0: 7220 6f62 6a65 6374 2e22 0a20 2020 2020  r object.".     
+0001f2b0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0001f2c0: 2020 2320 6368 6563 6b69 6e67 2072 6f75    # checking rou
+0001f2d0: 6e64 2070 6172 616d 6574 6572 0a20 2020  nd parameter.   
+0001f2e0: 2020 2020 2069 6620 7479 7065 2872 6f75       if type(rou
+0001f2f0: 6e64 2920 6973 206e 6f74 2069 6e74 3a0a  nd) is not int:.
+0001f300: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001f310: 6520 5479 7065 4572 726f 7228 2252 6f75  e TypeError("Rou
+0001f320: 6e64 2070 6172 616d 6574 6572 206f 6e6c  nd parameter onl
+0001f330: 7920 6163 6365 7074 7320 696e 7465 6765  y accepts intege
+0001f340: 7220 7661 6c75 652e 2229 0a0a 2020 2020  r value.")..    
+0001f350: 2020 2020 6966 2077 6569 6768 7473 2069      if weights i
+0001f360: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0001f370: 2020 2020 2020 2020 6e75 6d5f 6573 7469          num_esti
+0001f380: 6d61 746f 7273 203d 206c 656e 2865 7374  mators = len(est
+0001f390: 696d 6174 6f72 5f6c 6973 7429 0a20 2020  imator_list).   
+0001f3a0: 2020 2020 2020 2020 2023 2063 6865 636b           # check
+0001f3b0: 696e 6720 7765 6967 6874 7320 7061 7261  ing weights para
+0001f3c0: 6d65 7465 720a 2020 2020 2020 2020 2020  meter.          
+0001f3d0: 2020 6966 206c 656e 2877 6569 6768 7473    if len(weights
+0001f3e0: 2920 213d 206e 756d 5f65 7374 696d 6174  ) != num_estimat
+0001f3f0: 6f72 733a 0a20 2020 2020 2020 2020 2020  ors:.           
+0001f400: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0001f410: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+0001f420: 2020 2020 2020 2020 2020 2022 7765 6967             "weig
+0001f430: 6874 7320 7061 7261 6d65 7465 7220 6d75  hts parameter mu
+0001f440: 7374 2068 6176 6520 7468 6520 7361 6d65  st have the same
+0001f450: 206c 656e 6774 6820 6173 2074 6865 2065   length as the e
+0001f460: 7374 696d 6174 6f72 5f6c 6973 742e 220a  stimator_list.".
+0001f470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f480: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+0001f490: 206e 6f74 2061 6c6c 2828 6973 696e 7374   not all((isinst
+0001f4a0: 616e 6365 2878 2c20 696e 7429 206f 7220  ance(x, int) or 
+0001f4b0: 6973 696e 7374 616e 6365 2878 2c20 666c  isinstance(x, fl
+0001f4c0: 6f61 7429 2920 666f 7220 7820 696e 2077  oat)) for x in w
+0001f4d0: 6569 6768 7473 293a 0a20 2020 2020 2020  eights):.       
+0001f4e0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+0001f4f0: 7970 6545 7272 6f72 2822 7765 6967 6874  ypeError("weight
+0001f500: 7320 6d75 7374 2063 6f6e 7461 696e 206f  s must contain o
+0001f510: 6e6c 7920 696e 7473 206f 7220 666c 6f61  nly ints or floa
+0001f520: 7473 2e22 290a 0a20 2020 2020 2020 2023  ts.")..        #
+0001f530: 2063 6865 636b 696e 6720 7665 7262 6f73   checking verbos
+0001f540: 6520 7061 7261 6d65 7465 720a 2020 2020  e parameter.    
+0001f550: 2020 2020 6966 2074 7970 6528 7665 7262      if type(verb
+0001f560: 6f73 6529 2069 7320 6e6f 7420 626f 6f6c  ose) is not bool
+0001f570: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0001f580: 6973 6520 5479 7065 4572 726f 7228 0a20  ise TypeError(. 
+0001f590: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001f5a0: 5665 7262 6f73 6520 7061 7261 6d65 7465  Verbose paramete
+0001f5b0: 7220 6361 6e20 6f6e 6c79 2074 616b 6520  r can only take 
+0001f5c0: 6172 6775 6d65 6e74 2061 7320 5472 7565  argument as True
+0001f5d0: 206f 7220 4661 6c73 652e 220a 2020 2020   or False.".    
+0001f5e0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0001f5f0: 2020 2023 2063 6865 636b 696e 6720 6f70     # checking op
+0001f600: 7469 6d69 7a65 2070 6172 616d 6574 6572  timize parameter
+0001f610: 0a20 2020 2020 2020 206f 7074 696d 697a  .        optimiz
+0001f620: 6520 3d20 7365 6c66 2e5f 6765 745f 6d65  e = self._get_me
+0001f630: 7472 6963 5f62 795f 6e61 6d65 5f6f 725f  tric_by_name_or_
+0001f640: 6964 286f 7074 696d 697a 6529 0a20 2020  id(optimize).   
+0001f650: 2020 2020 2069 6620 6f70 7469 6d69 7a65       if optimize
+0001f660: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0001f670: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0001f680: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+0001f690: 2020 2020 2020 2020 224f 7074 696d 697a          "Optimiz
+0001f6a0: 6520 6d65 7468 6f64 206e 6f74 2073 7570  e method not sup
+0001f6b0: 706f 7274 6564 2e20 5365 6520 646f 6373  ported. See docs
+0001f6c0: 7472 696e 6720 666f 7220 6c69 7374 206f  tring for list o
+0001f6d0: 6620 6176 6169 6c61 626c 6520 7061 7261  f available para
+0001f6e0: 6d65 7465 7273 2e22 0a20 2020 2020 2020  meters.".       
+0001f6f0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0001f700: 2320 6368 6563 6b69 6e67 206f 7074 696d  # checking optim
+0001f710: 697a 6520 7061 7261 6d65 7465 7220 666f  ize parameter fo
+0001f720: 7220 6d75 6c74 6963 6c61 7373 0a20 2020  r multiclass.   
+0001f730: 2020 2020 2069 6620 7365 6c66 2e69 735f       if self.is_
+0001f740: 6d75 6c74 6963 6c61 7373 3a0a 2020 2020  multiclass:.    
+0001f750: 2020 2020 2020 2020 6966 206e 6f74 206f          if not o
+0001f760: 7074 696d 697a 652e 6973 5f6d 756c 7469  ptimize.is_multi
+0001f770: 636c 6173 733a 0a20 2020 2020 2020 2020  class:.         
+0001f780: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+0001f790: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+0001f7a0: 2020 2020 2020 2020 2020 2020 224f 7074              "Opt
+0001f7b0: 696d 697a 6174 696f 6e20 6d65 7472 6963  imization metric
+0001f7c0: 206e 6f74 2073 7570 706f 7274 6564 2066   not supported f
+0001f7d0: 6f72 206d 756c 7469 636c 6173 7320 7072  or multiclass pr
+0001f7e0: 6f62 6c65 6d73 2e20 5365 6520 646f 6373  oblems. See docs
+0001f7f0: 7472 696e 6720 666f 7220 6c69 7374 206f  tring for list o
+0001f800: 6620 6f74 6865 7220 6f70 7469 6d69 7a61  f other optimiza
+0001f810: 7469 6f6e 2070 6172 616d 6574 6572 732e  tion parameters.
+0001f820: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0001f830: 2020 290a 0a20 2020 2020 2020 2023 2063    )..        # c
+0001f840: 6865 636b 696e 6720 7265 7475 726e 5f74  hecking return_t
+0001f850: 7261 696e 5f73 636f 7265 2070 6172 616d  rain_score param
+0001f860: 6574 6572 0a20 2020 2020 2020 2069 6620  eter.        if 
+0001f870: 7479 7065 2872 6574 7572 6e5f 7472 6169  type(return_trai
+0001f880: 6e5f 7363 6f72 6529 2069 7320 6e6f 7420  n_score) is not 
+0001f890: 626f 6f6c 3a0a 2020 2020 2020 2020 2020  bool:.          
+0001f8a0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+0001f8b0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0001f8c0: 2020 2022 7265 7475 726e 5f74 7261 696e     "return_train
+0001f8d0: 5f73 636f 7265 2063 616e 206f 6e6c 7920  _score can only 
+0001f8e0: 7461 6b65 2061 7267 756d 656e 7420 6173  take argument as
+0001f8f0: 2054 7275 6520 6f72 2046 616c 7365 220a   True or False".
+0001f900: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0001f910: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0001f920: 2020 2020 4552 524f 5220 4841 4e44 4c49      ERROR HANDLI
+0001f930: 4e47 2045 4e44 5320 4845 5245 0a0a 2020  NG ENDS HERE..  
+0001f940: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001f950: 2020 6966 2073 656c 662e 5f6d 6c5f 7573    if self._ml_us
+0001f960: 6563 6173 6520 3d3d 204d 4c55 7365 6361  ecase == MLUseca
+0001f970: 7365 2e54 494d 455f 5345 5249 4553 3a0a  se.TIME_SERIES:.
+0001f980: 2020 2020 2020 2020 2020 2020 2320 4a75              # Ju
+0001f990: 7374 2072 6574 7572 6e20 7468 6520 666f  st return the fo
+0001f9a0: 6c64 2074 6f20 6372 6561 7465 5f6d 6f64  ld to create_mod
+0001f9b0: 656c 2e20 4974 2077 696c 6c20 646f 2074  el. It will do t
+0001f9c0: 6865 2072 6573 740a 2020 2020 2020 2020  he rest.        
+0001f9d0: 2020 2020 2320 666f 6c64 203d 2066 6f6c      # fold = fol
+0001f9e0: 640a 2020 2020 2020 2020 2020 2020 7061  d.            pa
+0001f9f0: 7373 0a20 2020 2020 2020 2065 6c73 653a  ss.        else:
+0001fa00: 0a20 2020 2020 2020 2020 2020 2066 6f6c  .            fol
+0001fa10: 6420 3d20 7365 6c66 2e5f 6765 745f 6376  d = self._get_cv
+0001fa20: 5f73 706c 6974 7465 7228 666f 6c64 290a  _splitter(fold).
+0001fa30: 0a20 2020 2020 2020 2067 726f 7570 7320  .        groups 
+0001fa40: 3d20 7365 6c66 2e5f 6765 745f 6772 6f75  = self._get_grou
+0001fa50: 7073 2867 726f 7570 7329 0a0a 2020 2020  ps(groups)..    
+0001fa60: 2020 2020 7072 6f67 7265 7373 5f61 7267      progress_arg
+0001fa70: 7320 3d20 7b22 6d61 7822 3a20 3220 2b20  s = {"max": 2 + 
+0001fa80: 347d 0a20 2020 2020 2020 2074 696d 6573  4}.        times
+0001fa90: 7461 6d70 5374 7220 3d20 6461 7465 7469  tampStr = dateti
+0001faa0: 6d65 2e64 6174 6574 696d 652e 6e6f 7728  me.datetime.now(
+0001fab0: 292e 7374 7266 7469 6d65 2822 2548 3a25  ).strftime("%H:%
+0001fac0: 4d3a 2553 2229 0a20 2020 2020 2020 206d  M:%S").        m
+0001fad0: 6f6e 6974 6f72 5f72 6f77 7320 3d20 5b0a  onitor_rows = [.
+0001fae0: 2020 2020 2020 2020 2020 2020 5b22 496e              ["In
+0001faf0: 6974 6961 7465 6422 2c20 222e 202e 202e  itiated", ". . .
+0001fb00: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
+0001fb10: 202e 202e 202e 202e 202e 202e 202e 222c   . . . . . . .",
+0001fb20: 2074 696d 6573 7461 6d70 5374 725d 2c0a   timestampStr],.
+0001fb30: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+0001fb40: 2020 2020 2020 2020 2020 2020 2020 2253                "S
+0001fb50: 7461 7475 7322 2c0a 2020 2020 2020 2020  tatus",.        
+0001fb60: 2020 2020 2020 2020 222e 202e 202e 202e          ". . . .
+0001fb70: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
+0001fb80: 202e 202e 202e 202e 202e 202e 222c 0a20   . . . . . .",. 
+0001fb90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001fba0: 4c6f 6164 696e 6720 4465 7065 6e64 656e  Loading Dependen
+0001fbb0: 6369 6573 222c 0a20 2020 2020 2020 2020  cies",.         
+0001fbc0: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
+0001fbd0: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
+0001fbe0: 2020 2020 2245 7374 696d 6174 6f72 222c      "Estimator",
+0001fbf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fc00: 2022 2e20 2e20 2e20 2e20 2e20 2e20 2e20   ". . . . . . . 
+0001fc10: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
+0001fc20: 2e20 2e20 2e22 2c0a 2020 2020 2020 2020  . . .",.        
+0001fc30: 2020 2020 2020 2020 2243 6f6d 7069 6c69          "Compili
+0001fc40: 6e67 204c 6962 7261 7279 222c 0a20 2020  ng Library",.   
+0001fc50: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+0001fc60: 2020 2020 5d0a 2020 2020 2020 2020 6469      ].        di
+0001fc70: 7370 6c61 7920 3d20 436f 6d6d 6f6e 4469  splay = CommonDi
+0001fc80: 7370 6c61 7928 0a20 2020 2020 2020 2020  splay(.         
+0001fc90: 2020 2076 6572 626f 7365 3d76 6572 626f     verbose=verbo
+0001fca0: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
+0001fcb0: 6874 6d6c 5f70 6172 616d 3d73 656c 662e  html_param=self.
+0001fcc0: 6874 6d6c 5f70 6172 616d 2c0a 2020 2020  html_param,.    
+0001fcd0: 2020 2020 2020 2020 7072 6f67 7265 7373          progress
+0001fce0: 5f61 7267 733d 7072 6f67 7265 7373 5f61  _args=progress_a
+0001fcf0: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
+0001fd00: 206d 6f6e 6974 6f72 5f72 6f77 733d 6d6f   monitor_rows=mo
+0001fd10: 6e69 746f 725f 726f 7773 2c0a 2020 2020  nitor_rows,.    
+0001fd20: 2020 2020 290a 0a20 2020 2020 2020 2073      )..        s
+0001fd30: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
+0001fd40: 2249 6d70 6f72 7469 6e67 206c 6962 7261  "Importing libra
+0001fd50: 7269 6573 2229 0a0a 2020 2020 2020 2020  ries")..        
+0001fd60: 6e70 2e72 616e 646f 6d2e 7365 6564 2873  np.random.seed(s
+0001fd70: 656c 662e 7365 6564 290a 0a20 2020 2020  elf.seed)..     
+0001fd80: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
+0001fd90: 6e66 6f28 2243 6f70 7969 6e67 2074 7261  nfo("Copying tra
+0001fda0: 696e 696e 6720 6461 7461 7365 7422 290a  ining dataset").
+0001fdb0: 0a20 2020 2020 2020 2023 2073 6574 7469  .        # setti
+0001fdc0: 6e67 206f 7074 696d 697a 6520 7061 7261  ng optimize para
+0001fdd0: 6d65 7465 720a 2020 2020 2020 2020 636f  meter.        co
+0001fde0: 6d70 6172 655f 6469 6d65 6e73 696f 6e20  mpare_dimension 
+0001fdf0: 3d20 6f70 7469 6d69 7a65 2e64 6973 706c  = optimize.displ
+0001fe00: 6179 5f6e 616d 650a 2020 2020 2020 2020  ay_name.        
+0001fe10: 6f70 7469 6d69 7a65 203d 206f 7074 696d  optimize = optim
+0001fe20: 697a 652e 7363 6f72 6572 0a0a 2020 2020  ize.scorer..    
+0001fe30: 2020 2020 6469 7370 6c61 792e 6d6f 7665      display.move
+0001fe40: 5f70 726f 6772 6573 7328 290a 0a20 2020  _progress()..   
+0001fe50: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001fe60: 204d 4f4e 4954 4f52 2055 5044 4154 4520   MONITOR UPDATE 
+0001fe70: 5354 4152 5453 0a20 2020 2020 2020 2022  STARTS.        "
+0001fe80: 2222 0a0a 2020 2020 2020 2020 6469 7370  ""..        disp
+0001fe90: 6c61 792e 7570 6461 7465 5f6d 6f6e 6974  lay.update_monit
+0001fea0: 6f72 2831 2c20 2243 6f6d 7069 6c69 6e67  or(1, "Compiling
+0001feb0: 2045 7374 696d 6174 6f72 7322 290a 0a20   Estimators").. 
+0001fec0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001fed0: 2020 204d 4f4e 4954 4f52 2055 5044 4154     MONITOR UPDAT
+0001fee0: 4520 454e 4453 0a20 2020 2020 2020 2022  E ENDS.        "
+0001fef0: 2222 0a0a 2020 2020 2020 2020 7365 6c66  ""..        self
+0001ff00: 2e6c 6f67 6765 722e 696e 666f 2822 4765  .logger.info("Ge
+0001ff10: 7474 696e 6720 6d6f 6465 6c20 6e61 6d65  tting model name
+0001ff20: 7322 290a 2020 2020 2020 2020 6573 7469  s").        esti
+0001ff30: 6d61 746f 725f 6469 6374 203d 207b 7d0a  mator_dict = {}.
+0001ff40: 2020 2020 2020 2020 666f 7220 7820 696e          for x in
+0001ff50: 2065 7374 696d 6174 6f72 5f6c 6973 743a   estimator_list:
+0001ff60: 0a20 2020 2020 2020 2020 2020 2078 203d  .            x =
+0001ff70: 2067 6574 5f65 7374 696d 6174 6f72 5f66   get_estimator_f
+0001ff80: 726f 6d5f 6d65 7461 5f65 7374 696d 6174  rom_meta_estimat
+0001ff90: 6f72 2878 290a 2020 2020 2020 2020 2020  or(x).          
+0001ffa0: 2020 6e61 6d65 203d 2073 656c 662e 5f67    name = self._g
+0001ffb0: 6574 5f6d 6f64 656c 5f6e 616d 6528 7829  et_model_name(x)
+0001ffc0: 0a20 2020 2020 2020 2020 2020 2073 7566  .            suf
+0001ffd0: 6669 7820 3d20 310a 2020 2020 2020 2020  fix = 1.        
+0001ffe0: 2020 2020 6f72 6967 696e 616c 5f6e 616d      original_nam
+0001fff0: 6520 3d20 6e61 6d65 0a20 2020 2020 2020  e = name.       
+00020000: 2020 2020 2077 6869 6c65 206e 616d 6520       while name 
+00020010: 696e 2065 7374 696d 6174 6f72 5f64 6963  in estimator_dic
+00020020: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+00020030: 2020 206e 616d 6520 3d20 6622 7b6f 7269     name = f"{ori
+00020040: 6769 6e61 6c5f 6e61 6d65 7d5f 7b73 7566  ginal_name}_{suf
+00020050: 6669 787d 220a 2020 2020 2020 2020 2020  fix}".          
+00020060: 2020 2020 2020 7375 6666 6978 202b 3d20        suffix += 
+00020070: 310a 2020 2020 2020 2020 2020 2020 6573  1.            es
+00020080: 7469 6d61 746f 725f 6469 6374 5b6e 616d  timator_dict[nam
+00020090: 655d 203d 2078 0a0a 2020 2020 2020 2020  e] = x..        
+000200a0: 6573 7469 6d61 746f 725f 6c69 7374 203d  estimator_list =
+000200b0: 206c 6973 7428 6573 7469 6d61 746f 725f   list(estimator_
+000200c0: 6469 6374 2e69 7465 6d73 2829 290a 0a20  dict.items()).. 
+000200d0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+000200e0: 6d6c 5f75 7365 6361 7365 203d 3d20 4d4c  ml_usecase == ML
+000200f0: 5573 6563 6173 652e 5449 4d45 5f53 4552  Usecase.TIME_SER
+00020100: 4945 533a 0a20 2020 2020 2020 2020 2020  IES:.           
+00020110: 2076 6f74 696e 675f 6d6f 6465 6c5f 6465   voting_model_de
+00020120: 6669 6e69 7469 6f6e 203d 2073 656c 662e  finition = self.
+00020130: 5f61 6c6c 5f6d 6f64 656c 735f 696e 7465  _all_models_inte
+00020140: 726e 616c 5b22 656e 7365 6d62 6c65 5f66  rnal["ensemble_f
+00020150: 6f72 6563 6173 7465 7222 5d0a 2020 2020  orecaster"].    
+00020160: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00020170: 2020 2020 2020 766f 7469 6e67 5f6d 6f64        voting_mod
+00020180: 656c 5f64 6566 696e 6974 696f 6e20 3d20  el_definition = 
+00020190: 7365 6c66 2e5f 616c 6c5f 6d6f 6465 6c73  self._all_models
+000201a0: 5f69 6e74 6572 6e61 6c5b 2256 6f74 696e  _internal["Votin
+000201b0: 6722 5d0a 0a20 2020 2020 2020 2069 6620  g"]..        if 
+000201c0: 7365 6c66 2e5f 6d6c 5f75 7365 6361 7365  self._ml_usecase
+000201d0: 203d 3d20 4d4c 5573 6563 6173 652e 434c   == MLUsecase.CL
+000201e0: 4153 5349 4649 4341 5449 4f4e 3a0a 2020  ASSIFICATION:.  
+000201f0: 2020 2020 2020 2020 2020 6d6f 6465 6c20            model 
+00020200: 3d20 766f 7469 6e67 5f6d 6f64 656c 5f64  = voting_model_d
+00020210: 6566 696e 6974 696f 6e2e 636c 6173 735f  efinition.class_
+00020220: 6465 6628 0a20 2020 2020 2020 2020 2020  def(.           
+00020230: 2020 2020 2065 7374 696d 6174 6f72 733d       estimators=
+00020240: 6573 7469 6d61 746f 725f 6c69 7374 2c0a  estimator_list,.
+00020250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020260: 766f 7469 6e67 3d6d 6574 686f 642c 0a20  voting=method,. 
+00020270: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00020280: 5f6a 6f62 733d 7365 6c66 2e67 7075 5f6e  _jobs=self.gpu_n
+00020290: 5f6a 6f62 735f 7061 7261 6d2c 0a20 2020  _jobs_param,.   
+000202a0: 2020 2020 2020 2020 2020 2020 2077 6569               wei
+000202b0: 6768 7473 3d77 6569 6768 7473 2c0a 2020  ghts=weights,.  
+000202c0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000202d0: 2020 2020 656c 6966 2073 656c 662e 5f6d      elif self._m
+000202e0: 6c5f 7573 6563 6173 6520 3d3d 204d 4c55  l_usecase == MLU
+000202f0: 7365 6361 7365 2e54 494d 455f 5345 5249  secase.TIME_SERI
+00020300: 4553 3a0a 2020 2020 2020 2020 2020 2020  ES:.            
+00020310: 6d6f 6465 6c20 3d20 766f 7469 6e67 5f6d  model = voting_m
+00020320: 6f64 656c 5f64 6566 696e 6974 696f 6e2e  odel_definition.
+00020330: 636c 6173 735f 6465 6628 0a20 2020 2020  class_def(.     
+00020340: 2020 2020 2020 2020 2020 2066 6f72 6563             forec
+00020350: 6173 7465 7273 3d65 7374 696d 6174 6f72  asters=estimator
+00020360: 5f6c 6973 742c 0a20 2020 2020 2020 2020  _list,.         
+00020370: 2020 2020 2020 2061 6767 6675 6e63 3d6d         aggfunc=m
+00020380: 6574 686f 642c 0a20 2020 2020 2020 2020  ethod,.         
+00020390: 2020 2020 2020 2077 6569 6768 7473 3d77         weights=w
+000203a0: 6569 6768 7473 2c0a 2020 2020 2020 2020  eights,.        
+000203b0: 2020 2020 2020 2020 6e5f 6a6f 6273 3d73          n_jobs=s
+000203c0: 656c 662e 6770 755f 6e5f 6a6f 6273 5f70  elf.gpu_n_jobs_p
+000203d0: 6172 616d 2c0a 2020 2020 2020 2020 2020  aram,.          
+000203e0: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
+000203f0: 3a0a 2020 2020 2020 2020 2020 2020 6d6f  :.            mo
+00020400: 6465 6c20 3d20 766f 7469 6e67 5f6d 6f64  del = voting_mod
+00020410: 656c 5f64 6566 696e 6974 696f 6e2e 636c  el_definition.cl
+00020420: 6173 735f 6465 6628 0a20 2020 2020 2020  ass_def(.       
+00020430: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
+00020440: 6f72 733d 6573 7469 6d61 746f 725f 6c69  ors=estimator_li
+00020450: 7374 2c20 6e5f 6a6f 6273 3d73 656c 662e  st, n_jobs=self.
+00020460: 6770 755f 6e5f 6a6f 6273 5f70 6172 616d  gpu_n_jobs_param
+00020470: 2c20 7765 6967 6874 733d 7765 6967 6874  , weights=weight
+00020480: 730a 2020 2020 2020 2020 2020 2020 290a  s.            ).
+00020490: 0a20 2020 2020 2020 2064 6973 706c 6179  .        display
+000204a0: 2e75 7064 6174 655f 6d6f 6e69 746f 7228  .update_monitor(
+000204b0: 322c 2076 6f74 696e 675f 6d6f 6465 6c5f  2, voting_model_
+000204c0: 6465 6669 6e69 7469 6f6e 2e6e 616d 6529  definition.name)
+000204d0: 0a0a 2020 2020 2020 2020 6469 7370 6c61  ..        displa
+000204e0: 792e 6d6f 7665 5f70 726f 6772 6573 7328  y.move_progress(
+000204f0: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00020500: 6c6f 6767 6572 2e69 6e66 6f28 0a20 2020  logger.info(.   
+00020510: 2020 2020 2020 2020 2022 5375 6250 726f           "SubPro
+00020520: 6365 7373 2063 7265 6174 655f 6d6f 6465  cess create_mode
+00020530: 6c28 2920 6361 6c6c 6564 203d 3d3d 3d3d  l() called =====
+00020540: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00020550: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d22 0a20  =============". 
+00020560: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00020570: 206d 6f64 656c 2c20 6d6f 6465 6c5f 6669   model, model_fi
+00020580: 745f 7469 6d65 203d 2073 656c 662e 5f63  t_time = self._c
+00020590: 7265 6174 655f 6d6f 6465 6c28 0a20 2020  reate_model(.   
+000205a0: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
+000205b0: 6f72 3d6d 6f64 656c 2c0a 2020 2020 2020  or=model,.      
+000205c0: 2020 2020 2020 7379 7374 656d 3d46 616c        system=Fal
+000205d0: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
+000205e0: 6469 7370 6c61 793d 6469 7370 6c61 792c  display=display,
+000205f0: 0a20 2020 2020 2020 2020 2020 2066 6f6c  .            fol
+00020600: 643d 666f 6c64 2c0a 2020 2020 2020 2020  d=fold,.        
+00020610: 2020 2020 726f 756e 643d 726f 756e 642c      round=round,
+00020620: 0a20 2020 2020 2020 2020 2020 2066 6974  .            fit
+00020630: 5f6b 7761 7267 733d 6669 745f 6b77 6172  _kwargs=fit_kwar
+00020640: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+00020650: 6772 6f75 7073 3d67 726f 7570 732c 0a20  groups=groups,. 
+00020660: 2020 2020 2020 2020 2020 2070 726f 6261             proba
+00020670: 6269 6c69 7479 5f74 6872 6573 686f 6c64  bility_threshold
+00020680: 3d70 726f 6261 6269 6c69 7479 5f74 6872  =probability_thr
+00020690: 6573 686f 6c64 2c0a 2020 2020 2020 2020  eshold,.        
+000206a0: 2020 2020 7265 7475 726e 5f74 7261 696e      return_train
+000206b0: 5f73 636f 7265 3d72 6574 7572 6e5f 7472  _score=return_tr
+000206c0: 6169 6e5f 7363 6f72 652c 0a20 2020 2020  ain_score,.     
+000206d0: 2020 2029 0a0a 2020 2020 2020 2020 6d6f     )..        mo
+000206e0: 6465 6c5f 7265 7375 6c74 7320 3d20 7365  del_results = se
+000206f0: 6c66 2e70 756c 6c28 290a 2020 2020 2020  lf.pull().      
+00020700: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
+00020710: 666f 280a 2020 2020 2020 2020 2020 2020  fo(.            
+00020720: 2253 7562 5072 6f63 6573 7320 6372 6561  "SubProcess crea
+00020730: 7465 5f6d 6f64 656c 2829 2065 6e64 203d  te_model() end =
+00020740: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00020750: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00020760: 3d22 0a20 2020 2020 2020 2029 0a0a 2020  =".        )..  
+00020770: 2020 2020 2020 2320 656e 6420 7275 6e74        # end runt
+00020780: 696d 650a 2020 2020 2020 2020 7275 6e74  ime.        runt
+00020790: 696d 655f 656e 6420 3d20 7469 6d65 2e74  ime_end = time.t
+000207a0: 696d 6528 290a 2020 2020 2020 2020 7275  ime().        ru
+000207b0: 6e74 696d 6520 3d20 6e70 2e61 7272 6179  ntime = np.array
+000207c0: 2872 756e 7469 6d65 5f65 6e64 202d 2072  (runtime_end - r
+000207d0: 756e 7469 6d65 5f73 7461 7274 292e 726f  untime_start).ro
+000207e0: 756e 6428 3229 0a0a 2020 2020 2020 2020  und(2)..        
+000207f0: 2320 6461 7368 626f 6172 6420 6c6f 6767  # dashboard logg
+00020800: 696e 670a 2020 2020 2020 2020 6966 2073  ing.        if s
+00020810: 656c 662e 6c6f 6767 696e 675f 7061 7261  elf.logging_para
+00020820: 6d3a 0a20 2020 2020 2020 2020 2020 2069  m:.            i
+00020830: 6e64 6963 6573 203d 2073 656c 662e 5f67  ndices = self._g
+00020840: 6574 5f72 6574 7572 6e5f 7472 6169 6e5f  et_return_train_
+00020850: 7363 6f72 655f 696e 6469 6365 735f 666f  score_indices_fo
+00020860: 725f 6c6f 6767 696e 6728 0a20 2020 2020  r_logging(.     
+00020870: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00020880: 6e5f 7472 6169 6e5f 7363 6f72 653d 7265  n_train_score=re
+00020890: 7475 726e 5f74 7261 696e 5f73 636f 7265  turn_train_score
+000208a0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+000208b0: 2020 2020 2020 2020 2020 2061 7667 735f             avgs_
+000208c0: 6469 6374 5f6c 6f67 203d 207b 6b3a 2076  dict_log = {k: v
+000208d0: 2066 6f72 206b 2c20 7620 696e 206d 6f64   for k, v in mod
+000208e0: 656c 5f72 6573 756c 7473 2e6c 6f63 5b69  el_results.loc[i
+000208f0: 6e64 6963 6573 5d2e 6974 656d 7328 297d  ndices].items()}
+00020900: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00020910: 662e 6c6f 6767 696e 675f 7061 7261 6d2e  f.logging_param.
+00020920: 6c6f 675f 6d6f 6465 6c5f 636f 6d70 6172  log_model_compar
+00020930: 6973 6f6e 286d 6f64 656c 5f72 6573 756c  ison(model_resul
+00020940: 7473 2c20 2262 6c65 6e64 5f6d 6f64 656c  ts, "blend_model
+00020950: 7322 290a 0a20 2020 2020 2020 2020 2020  s")..           
+00020960: 2073 656c 662e 5f6c 6f67 5f6d 6f64 656c   self._log_model
+00020970: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00020980: 2020 6d6f 6465 6c3d 6d6f 6465 6c2c 0a20    model=model,. 
+00020990: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+000209a0: 6f64 656c 5f72 6573 756c 7473 3d6d 6f64  odel_results=mod
+000209b0: 656c 5f72 6573 756c 7473 2c0a 2020 2020  el_results,.    
+000209c0: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
+000209d0: 655f 6469 6374 3d61 7667 735f 6469 6374  e_dict=avgs_dict
+000209e0: 5f6c 6f67 2c0a 2020 2020 2020 2020 2020  _log,.          
+000209f0: 2020 2020 2020 736f 7572 6365 3d22 626c        source="bl
+00020a00: 656e 645f 6d6f 6465 6c73 222c 0a20 2020  end_models",.   
+00020a10: 2020 2020 2020 2020 2020 2020 2072 756e               run
+00020a20: 7469 6d65 3d72 756e 7469 6d65 2c0a 2020  time=runtime,.  
+00020a30: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+00020a40: 6465 6c5f 6669 745f 7469 6d65 3d6d 6f64  del_fit_time=mod
+00020a50: 656c 5f66 6974 5f74 696d 652c 0a20 2020  el_fit_time,.   
+00020a60: 2020 2020 2020 2020 2020 2020 2070 6970               pip
+00020a70: 656c 696e 653d 7365 6c66 2e70 6970 656c  eline=self.pipel
+00020a80: 696e 652c 0a20 2020 2020 2020 2020 2020  ine,.           
+00020a90: 2020 2020 206c 6f67 5f70 6c6f 7473 3d73       log_plots=s
+00020aa0: 656c 662e 6c6f 675f 706c 6f74 735f 7061  elf.log_plots_pa
+00020ab0: 7261 6d2c 0a20 2020 2020 2020 2020 2020  ram,.           
+00020ac0: 2020 2020 2064 6973 706c 6179 3d64 6973       display=dis
+00020ad0: 706c 6179 2c0a 2020 2020 2020 2020 2020  play,.          
+00020ae0: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
+00020af0: 6368 6f6f 7365 5f62 6574 7465 723a 0a20  choose_better:. 
+00020b00: 2020 2020 2020 2020 2020 206e 6577 5f6d             new_m
+00020b10: 6f64 656c 203d 2073 656c 662e 5f63 686f  odel = self._cho
+00020b20: 6f73 655f 6265 7474 6572 280a 2020 2020  ose_better(.    
+00020b30: 2020 2020 2020 2020 2020 2020 5b28 6d6f              [(mo
+00020b40: 6465 6c2c 206d 6f64 656c 5f72 6573 756c  del, model_resul
+00020b50: 7473 295d 202b 2065 7374 696d 6174 6f72  ts)] + estimator
+00020b60: 5f6c 6973 742c 0a20 2020 2020 2020 2020  _list,.         
+00020b70: 2020 2020 2020 2063 6f6d 7061 7265 5f64         compare_d
+00020b80: 696d 656e 7369 6f6e 2c0a 2020 2020 2020  imension,.      
+00020b90: 2020 2020 2020 2020 2020 666f 6c64 2c0a            fold,.
+00020ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020bb0: 6772 6f75 7073 3d67 726f 7570 732c 0a20  groups=groups,. 
+00020bc0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00020bd0: 6974 5f6b 7761 7267 733d 6669 745f 6b77  it_kwargs=fit_kw
+00020be0: 6172 6773 2c0a 2020 2020 2020 2020 2020  args,.          
+00020bf0: 2020 2020 2020 6469 7370 6c61 793d 6469        display=di
+00020c00: 7370 6c61 792c 0a20 2020 2020 2020 2020  splay,.         
+00020c10: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00020c20: 2069 6620 6e65 775f 6d6f 6465 6c20 6973   if new_model is
+00020c30: 206e 6f74 206d 6f64 656c 3a0a 2020 2020   not model:.    
+00020c40: 2020 2020 2020 2020 2020 2020 6d73 6720              msg 
+00020c50: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00020c60: 2020 2020 2020 2020 224f 7269 6769 6e61          "Origina
+00020c70: 6c20 6d6f 6465 6c20 7761 7320 6265 7474  l model was bett
+00020c80: 6572 2074 6861 6e20 7468 6520 626c 656e  er than the blen
+00020c90: 6465 6420 6d6f 6465 6c2c 2068 656e 6365  ded model, hence
+00020ca0: 2069 7420 7769 6c6c 2062 6520 7265 7475   it will be retu
+00020cb0: 726e 6564 2e20 220a 2020 2020 2020 2020  rned. ".        
+00020cc0: 2020 2020 2020 2020 2020 2020 224e 4f54              "NOT
+00020cd0: 453a 2054 6865 2064 6973 706c 6179 206d  E: The display m
+00020ce0: 6574 7269 6373 2061 7265 2066 6f72 2074  etrics are for t
+00020cf0: 6865 2062 6c65 6e64 6564 206d 6f64 656c  he blended model
+00020d00: 2028 6e6f 7420 7468 6520 6f72 6967 696e   (not the origin
+00020d10: 616c 206f 6e65 292e 220a 2020 2020 2020  al one).".      
+00020d20: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00020d30: 2020 2020 2020 2020 2020 2020 6966 2076              if v
+00020d40: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
+00020d50: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00020d60: 7428 6d73 6729 0a20 2020 2020 2020 2020  t(msg).         
+00020d70: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+00020d80: 6572 2e69 6e66 6f28 6d73 6729 0a20 2020  er.info(msg).   
+00020d90: 2020 2020 2020 2020 206d 6f64 656c 203d           model =
+00020da0: 206e 6577 5f6d 6f64 656c 0a0a 2020 2020   new_model..    
+00020db0: 2020 2020 6d6f 6465 6c5f 7265 7375 6c74      model_result
+00020dc0: 7320 3d20 7365 6c66 2e5f 6869 6768 6c69  s = self._highli
+00020dd0: 6768 745f 616e 645f 726f 756e 645f 6d6f  ght_and_round_mo
+00020de0: 6465 6c5f 7265 7375 6c74 7328 0a20 2020  del_results(.   
+00020df0: 2020 2020 2020 2020 206d 6f64 656c 5f72           model_r
+00020e00: 6573 756c 7473 2c20 7265 7475 726e 5f74  esults, return_t
+00020e10: 7261 696e 5f73 636f 7265 2c20 726f 756e  rain_score, roun
+00020e20: 640a 2020 2020 2020 2020 290a 2020 2020  d.        ).    
+00020e30: 2020 2020 6469 7370 6c61 792e 6469 7370      display.disp
+00020e40: 6c61 7928 6d6f 6465 6c5f 7265 7375 6c74  lay(model_result
+00020e50: 7329 0a0a 2020 2020 2020 2020 7365 6c66  s)..        self
+00020e60: 2e6c 6f67 6765 722e 696e 666f 280a 2020  .logger.info(.  
+00020e70: 2020 2020 2020 2020 2020 6622 5f6d 6173            f"_mas
+00020e80: 7465 725f 6d6f 6465 6c5f 636f 6e74 6169  ter_model_contai
+00020e90: 6e65 723a 207b 6c65 6e28 7365 6c66 2e5f  ner: {len(self._
+00020ea0: 6d61 7374 6572 5f6d 6f64 656c 5f63 6f6e  master_model_con
+00020eb0: 7461 696e 6572 297d 220a 2020 2020 2020  tainer)}".      
+00020ec0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00020ed0: 2e6c 6f67 6765 722e 696e 666f 2866 225f  .logger.info(f"_
+00020ee0: 6469 7370 6c61 795f 636f 6e74 6169 6e65  display_containe
+00020ef0: 723a 207b 6c65 6e28 7365 6c66 2e5f 6469  r: {len(self._di
+00020f00: 7370 6c61 795f 636f 6e74 6169 6e65 7229  splay_container)
+00020f10: 7d22 290a 0a20 2020 2020 2020 2073 656c  }")..        sel
+00020f20: 662e 6c6f 6767 6572 2e69 6e66 6f28 7374  f.logger.info(st
+00020f30: 7228 6d6f 6465 6c29 290a 2020 2020 2020  r(model)).      
+00020f40: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
+00020f50: 666f 280a 2020 2020 2020 2020 2020 2020  fo(.            
+00020f60: 2262 6c65 6e64 5f6d 6f64 656c 7328 2920  "blend_models() 
+00020f70: 7375 6363 6573 7366 756c 6c79 2063 6f6d  successfully com
+00020f80: 706c 6574 6564 2e2e 2e2e 2e2e 2e2e 2e2e  pleted..........
+00020f90: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00020fa0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 220a 2020  ............".  
+00020fb0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00020fc0: 2067 632e 636f 6c6c 6563 7428 290a 2020   gc.collect().  
+00020fd0: 2020 2020 2020 7265 7475 726e 206d 6f64        return mod
+00020fe0: 656c 0a0a 2020 2020 6465 6620 7374 6163  el..    def stac
+00020ff0: 6b5f 6d6f 6465 6c73 280a 2020 2020 2020  k_models(.      
+00021000: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00021010: 6573 7469 6d61 746f 725f 6c69 7374 3a20  estimator_list: 
+00021020: 6c69 7374 2c0a 2020 2020 2020 2020 6d65  list,.        me
+00021030: 7461 5f6d 6f64 656c 3d4e 6f6e 652c 0a20  ta_model=None,. 
+00021040: 2020 2020 2020 206d 6574 615f 6d6f 6465         meta_mode
+00021050: 6c5f 666f 6c64 3a20 4f70 7469 6f6e 616c  l_fold: Optional
+00021060: 5b55 6e69 6f6e 5b69 6e74 2c20 416e 795d  [Union[int, Any]
+00021070: 5d20 3d20 352c 0a20 2020 2020 2020 2066  ] = 5,.        f
+00021080: 6f6c 643a 204f 7074 696f 6e61 6c5b 556e  old: Optional[Un
+00021090: 696f 6e5b 696e 742c 2041 6e79 5d5d 203d  ion[int, Any]] =
+000210a0: 204e 6f6e 652c 0a20 2020 2020 2020 2072   None,.        r
+000210b0: 6f75 6e64 3a20 696e 7420 3d20 342c 0a20  ound: int = 4,. 
+000210c0: 2020 2020 2020 206d 6574 686f 643a 2073         method: s
+000210d0: 7472 203d 2022 6175 746f 222c 0a20 2020  tr = "auto",.   
+000210e0: 2020 2020 2072 6573 7461 636b 3a20 626f       restack: bo
+000210f0: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+00021100: 2020 2020 6368 6f6f 7365 5f62 6574 7465      choose_bette
+00021110: 723a 2062 6f6f 6c20 3d20 4661 6c73 652c  r: bool = False,
+00021120: 0a20 2020 2020 2020 206f 7074 696d 697a  .        optimiz
+00021130: 653a 2073 7472 203d 2022 4163 6375 7261  e: str = "Accura
+00021140: 6379 222c 0a20 2020 2020 2020 2066 6974  cy",.        fit
+00021150: 5f6b 7761 7267 733a 204f 7074 696f 6e61  _kwargs: Optiona
+00021160: 6c5b 6469 6374 5d20 3d20 4e6f 6e65 2c0a  l[dict] = None,.
+00021170: 2020 2020 2020 2020 6772 6f75 7073 3a20          groups: 
+00021180: 4f70 7469 6f6e 616c 5b55 6e69 6f6e 5b73  Optional[Union[s
+00021190: 7472 2c20 416e 795d 5d20 3d20 4e6f 6e65  tr, Any]] = None
+000211a0: 2c0a 2020 2020 2020 2020 7072 6f62 6162  ,.        probab
+000211b0: 696c 6974 795f 7468 7265 7368 6f6c 643a  ility_threshold:
+000211c0: 204f 7074 696f 6e61 6c5b 666c 6f61 745d   Optional[float]
+000211d0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+000211e0: 2076 6572 626f 7365 3a20 626f 6f6c 203d   verbose: bool =
+000211f0: 2054 7275 652c 0a20 2020 2020 2020 2072   True,.        r
+00021200: 6574 7572 6e5f 7472 6169 6e5f 7363 6f72  eturn_train_scor
+00021210: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
+00021220: 0a20 2020 2029 202d 3e20 416e 793a 0a20  .    ) -> Any:. 
+00021230: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00021240: 2020 2054 6869 7320 6675 6e63 7469 6f6e     This function
+00021250: 2074 7261 696e 7320 6120 6d65 7461 206d   trains a meta m
+00021260: 6f64 656c 2061 6e64 2073 636f 7265 7320  odel and scores 
+00021270: 6974 2075 7369 6e67 2043 726f 7373 2056  it using Cross V
+00021280: 616c 6964 6174 696f 6e2e 0a20 2020 2020  alidation..     
+00021290: 2020 2054 6865 2070 7265 6469 6374 696f     The predictio
+000212a0: 6e73 2066 726f 6d20 7468 6520 6261 7365  ns from the base
+000212b0: 206c 6576 656c 206d 6f64 656c 7320 6173   level models as
+000212c0: 2070 6173 7365 6420 696e 2074 6865 2065   passed in the e
+000212d0: 7374 696d 6174 6f72 5f6c 6973 7420 7061  stimator_list pa
+000212e0: 7261 6d65 7465 720a 2020 2020 2020 2020  rameter.        
+000212f0: 6172 6520 7573 6564 2061 7320 696e 7075  are used as inpu
+00021300: 7420 6665 6174 7572 6573 2066 6f72 2074  t features for t
+00021310: 6865 206d 6574 6120 6d6f 6465 6c2e 2054  he meta model. T
+00021320: 6865 2072 6573 7461 636b 696e 6720 7061  he restacking pa
+00021330: 7261 6d65 7465 7220 636f 6e74 726f 6c73  rameter controls
+00021340: 0a20 2020 2020 2020 2074 6865 2061 6269  .        the abi
+00021350: 6c69 7479 2074 6f20 6578 706f 7365 2072  lity to expose r
+00021360: 6177 2066 6561 7475 7265 7320 746f 2074  aw features to t
+00021370: 6865 206d 6574 6120 6d6f 6465 6c20 7768  he meta model wh
+00021380: 656e 2073 6574 2074 6f20 5472 7565 0a20  en set to True. 
+00021390: 2020 2020 2020 2028 6465 6661 756c 7420         (default 
+000213a0: 3d20 4661 6c73 6529 2e0a 0a20 2020 2020  = False)...     
+000213b0: 2020 2054 6865 206f 7574 7075 7420 7072     The output pr
+000213c0: 696e 7473 2074 6865 2073 636f 7265 2067  ints the score g
+000213d0: 7269 6420 7468 6174 2073 686f 7773 2041  rid that shows A
+000213e0: 6363 7572 6163 792c 2041 5543 2c20 5265  ccuracy, AUC, Re
+000213f0: 6361 6c6c 2c20 5072 6563 6973 696f 6e2c  call, Precision,
+00021400: 0a20 2020 2020 2020 2046 312c 204b 6170  .        F1, Kap
+00021410: 7061 2061 6e64 204d 4343 2062 7920 666f  pa and MCC by fo
+00021420: 6c64 2028 6465 6661 756c 7420 3d20 3130  ld (default = 10
+00021430: 2046 6f6c 6473 292e 0a0a 2020 2020 2020   Folds)...      
+00021440: 2020 5468 6973 2066 756e 6374 696f 6e20    This function 
+00021450: 7265 7475 726e 7320 6120 7472 6169 6e65  returns a traine
+00021460: 6420 6d6f 6465 6c20 6f62 6a65 6374 2e0a  d model object..
+00021470: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+00021480: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00021490: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+000214a0: 6d20 7079 6361 7265 742e 6461 7461 7365  m pycaret.datase
+000214b0: 7473 2069 6d70 6f72 7420 6765 745f 6461  ts import get_da
+000214c0: 7461 0a20 2020 2020 2020 203e 3e3e 206a  ta.        >>> j
+000214d0: 7569 6365 203d 2067 6574 5f64 6174 6128  uice = get_data(
+000214e0: 276a 7569 6365 2729 0a20 2020 2020 2020  'juice').       
+000214f0: 203e 3e3e 2065 7870 6572 696d 656e 745f   >>> experiment_
+00021500: 6e61 6d65 203d 2073 6574 7570 2864 6174  name = setup(dat
+00021510: 6120 3d20 6a75 6963 652c 2020 7461 7267  a = juice,  targ
+00021520: 6574 203d 2027 5075 7263 6861 7365 2729  et = 'Purchase')
+00021530: 0a20 2020 2020 2020 203e 3e3e 2064 7420  .        >>> dt 
+00021540: 3d20 6372 6561 7465 5f6d 6f64 656c 2827  = create_model('
+00021550: 6474 2729 0a20 2020 2020 2020 203e 3e3e  dt').        >>>
+00021560: 2072 6620 3d20 6372 6561 7465 5f6d 6f64   rf = create_mod
+00021570: 656c 2827 7266 2729 0a20 2020 2020 2020  el('rf').       
+00021580: 203e 3e3e 2061 6461 203d 2063 7265 6174   >>> ada = creat
+00021590: 655f 6d6f 6465 6c28 2761 6461 2729 0a20  e_model('ada'). 
+000215a0: 2020 2020 2020 203e 3e3e 2072 6964 6765         >>> ridge
+000215b0: 203d 2063 7265 6174 655f 6d6f 6465 6c28   = create_model(
+000215c0: 2772 6964 6765 2729 0a20 2020 2020 2020  'ridge').       
+000215d0: 203e 3e3e 206b 6e6e 203d 2063 7265 6174   >>> knn = creat
+000215e0: 655f 6d6f 6465 6c28 276b 6e6e 2729 0a20  e_model('knn'). 
+000215f0: 2020 2020 2020 203e 3e3e 2073 7461 636b         >>> stack
+00021600: 6564 5f6d 6f64 656c 7320 3d20 7374 6163  ed_models = stac
+00021610: 6b5f 6d6f 6465 6c73 2865 7374 696d 6174  k_models(estimat
+00021620: 6f72 5f6c 6973 743d 5b64 742c 7266 2c61  or_list=[dt,rf,a
+00021630: 6461 2c72 6964 6765 2c6b 6e6e 5d29 0a0a  da,ridge,knn])..
+00021640: 2020 2020 2020 2020 5468 6973 2077 696c          This wil
+00021650: 6c20 6372 6561 7465 2061 206d 6574 6120  l create a meta 
+00021660: 6d6f 6465 6c20 7468 6174 2077 696c 6c20  model that will 
+00021670: 7573 6520 7468 6520 7072 6564 6963 7469  use the predicti
+00021680: 6f6e 7320 6f66 2061 6c6c 2074 6865 0a20  ons of all the. 
+00021690: 2020 2020 2020 206d 6f64 656c 7320 7072         models pr
+000216a0: 6f76 6964 6564 2069 6e20 6573 7469 6d61  ovided in estima
+000216b0: 746f 725f 6c69 7374 2070 6172 616d 2e20  tor_list param. 
+000216c0: 4279 2064 6566 6175 6c74 2c20 7468 6520  By default, the 
+000216d0: 6d65 7461 206d 6f64 656c 2069 730a 2020  meta model is.  
+000216e0: 2020 2020 2020 4c6f 6769 7374 6963 2052        Logistic R
+000216f0: 6567 7265 7373 696f 6e20 6275 7420 6361  egression but ca
+00021700: 6e20 6265 2063 6861 6e67 6564 2077 6974  n be changed wit
+00021710: 6820 6d65 7461 5f6d 6f64 656c 2070 6172  h meta_model par
+00021720: 616d 2e0a 0a20 2020 2020 2020 2050 6172  am...        Par
+00021730: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+00021740: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00021750: 2020 2065 7374 696d 6174 6f72 5f6c 6973     estimator_lis
+00021760: 7420 3a20 6c69 7374 206f 6620 6f62 6a65  t : list of obje
+00021770: 6374 730a 0a20 2020 2020 2020 206d 6574  cts..        met
+00021780: 615f 6d6f 6465 6c20 3a20 6f62 6a65 6374  a_model : object
+00021790: 2c20 6465 6661 756c 7420 3d20 4e6f 6e65  , default = None
+000217a0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+000217b0: 7365 7420 746f 204e 6f6e 652c 204c 6f67  set to None, Log
+000217c0: 6973 7469 6320 5265 6772 6573 7369 6f6e  istic Regression
+000217d0: 2069 7320 7573 6564 2061 7320 6120 6d65   is used as a me
+000217e0: 7461 206d 6f64 656c 2e0a 0a20 2020 2020  ta model...     
+000217f0: 2020 2066 6f6c 643a 2069 6e74 206f 7220     fold: int or 
+00021800: 7363 696b 6974 2d6c 6561 726e 2063 6f6d  scikit-learn com
+00021810: 7061 7469 626c 6520 4356 2067 656e 6572  patible CV gener
+00021820: 6174 6f72 2c20 6465 6661 756c 7420 3d20  ator, default = 
+00021830: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+00021840: 2043 6f6e 7472 6f6c 7320 6372 6f73 732d   Controls cross-
+00021850: 7661 6c69 6461 7469 6f6e 2e20 4966 204e  validation. If N
+00021860: 6f6e 652c 2074 6865 2043 5620 6765 6e65  one, the CV gene
+00021870: 7261 746f 7220 696e 2074 6865 2060 6066  rator in the ``f
+00021880: 6f6c 645f 7374 7261 7465 6779 6060 0a20  old_strategy``. 
+00021890: 2020 2020 2020 2020 2020 2070 6172 616d             param
+000218a0: 6574 6572 206f 6620 7468 6520 6060 7365  eter of the ``se
+000218b0: 7475 7060 6020 6675 6e63 7469 6f6e 2069  tup`` function i
+000218c0: 7320 7573 6564 2e20 5768 656e 2061 6e20  s used. When an 
+000218d0: 696e 7465 6765 7220 6973 2070 6173 7365  integer is passe
+000218e0: 642c 0a20 2020 2020 2020 2020 2020 2069  d,.            i
+000218f0: 7420 6973 2069 6e74 6572 7072 6574 6564  t is interpreted
+00021900: 2061 7320 7468 6520 276e 5f73 706c 6974   as the 'n_split
+00021910: 7327 2070 6172 616d 6574 6572 206f 6620  s' parameter of 
+00021920: 7468 6520 4356 2067 656e 6572 6174 6f72  the CV generator
+00021930: 2069 6e20 7468 650a 2020 2020 2020 2020   in the.        
+00021940: 2020 2020 6060 7365 7475 7060 6020 6675      ``setup`` fu
+00021950: 6e63 7469 6f6e 2e0a 0a20 2020 2020 2020  nction...       
+00021960: 2066 6f6c 643a 2069 6e74 6567 6572 206f   fold: integer o
+00021970: 7220 7363 696b 6974 2d6c 6561 726e 2063  r scikit-learn c
+00021980: 6f6d 7061 7469 626c 6520 4356 2067 656e  ompatible CV gen
+00021990: 6572 6174 6f72 2c20 6465 6661 756c 7420  erator, default 
+000219a0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2020  = None.         
+000219b0: 2020 2043 6f6e 7472 6f6c 7320 6372 6f73     Controls cros
+000219c0: 732d 7661 6c69 6461 7469 6f6e 2e20 4966  s-validation. If
+000219d0: 204e 6f6e 652c 2077 696c 6c20 7573 6520   None, will use 
+000219e0: 7468 6520 4356 2067 656e 6572 6174 6f72  the CV generator
+000219f0: 2064 6566 696e 6564 2069 6e20 7365 7475   defined in setu
+00021a00: 7028 292e 0a20 2020 2020 2020 2020 2020  p()..           
+00021a10: 2049 6620 696e 7465 6765 722c 2077 696c   If integer, wil
+00021a20: 6c20 7573 6520 4b46 6f6c 6420 4356 2077  l use KFold CV w
+00021a30: 6974 6820 7468 6174 206d 616e 7920 666f  ith that many fo
+00021a40: 6c64 732e 0a20 2020 2020 2020 2020 2020  lds..           
+00021a50: 2057 6865 6e20 6372 6f73 735f 7661 6c69   When cross_vali
+00021a60: 6461 7469 6f6e 2069 7320 4661 6c73 652c  dation is False,
+00021a70: 2074 6869 7320 7061 7261 6d65 7465 7220   this parameter 
+00021a80: 6973 2069 676e 6f72 6564 2e0a 0a20 2020  is ignored...   
+00021a90: 2020 2020 2072 6f75 6e64 3a20 696e 7465       round: inte
+00021aa0: 6765 722c 2064 6566 6175 6c74 203d 2034  ger, default = 4
+00021ab0: 0a20 2020 2020 2020 2020 2020 204e 756d  .            Num
+00021ac0: 6265 7220 6f66 2064 6563 696d 616c 2070  ber of decimal p
+00021ad0: 6c61 6365 7320 7468 6520 6d65 7472 6963  laces the metric
+00021ae0: 7320 696e 2074 6865 2073 636f 7265 2067  s in the score g
+00021af0: 7269 6420 7769 6c6c 2062 6520 726f 756e  rid will be roun
+00021b00: 6465 6420 746f 2e0a 0a20 2020 2020 2020  ded to...       
+00021b10: 206d 6574 686f 643a 2073 7472 696e 672c   method: string,
+00021b20: 2064 6566 6175 6c74 203d 2027 6175 746f   default = 'auto
+00021b30: 270a 2020 2020 2020 2020 2020 2020 2d20  '.            - 
+00021b40: 6966 20e2 8098 6175 746f e280 992c 2069  if ...auto..., i
+00021b50: 7420 7769 6c6c 2074 7279 2074 6f20 696e  t will try to in
+00021b60: 766f 6b65 2c20 666f 7220 6561 6368 2065  voke, for each e
+00021b70: 7374 696d 6174 6f72 2c20 2770 7265 6469  stimator, 'predi
+00021b80: 6374 5f70 726f 6261 272c 0a20 2020 2020  ct_proba',.     
+00021b90: 2020 2020 2020 2027 6465 6369 7369 6f6e         'decision
+00021ba0: 5f66 756e 6374 696f 6e27 206f 7220 2770  _function' or 'p
+00021bb0: 7265 6469 6374 2720 696e 2074 6861 7420  redict' in that 
+00021bc0: 6f72 6465 722e 0a20 2020 2020 2020 2020  order..         
+00021bd0: 2020 202d 206f 7468 6572 7769 7365 2c20     - otherwise, 
+00021be0: 6f6e 6520 6f66 2027 7072 6564 6963 745f  one of 'predict_
+00021bf0: 7072 6f62 6127 2c20 2764 6563 6973 696f  proba', 'decisio
+00021c00: 6e5f 6675 6e63 7469 6f6e 2720 6f72 2027  n_function' or '
+00021c10: 7072 6564 6963 7427 2e0a 2020 2020 2020  predict'..      
+00021c20: 2020 2020 2020 4966 2074 6865 206d 6574        If the met
+00021c30: 686f 6420 6973 206e 6f74 2069 6d70 6c65  hod is not imple
+00021c40: 6d65 6e74 6564 2062 7920 7468 6520 6573  mented by the es
+00021c50: 7469 6d61 746f 722c 2069 7420 7769 6c6c  timator, it will
+00021c60: 2072 6169 7365 2061 6e20 6572 726f 722e   raise an error.
+00021c70: 0a0a 2020 2020 2020 2020 7265 7374 6163  ..        restac
+00021c80: 6b3a 2062 6f6f 6c2c 2064 6566 6175 6c74  k: bool, default
+00021c90: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00021ca0: 2020 2020 2057 6865 6e20 7265 7374 6163       When restac
+00021cb0: 6b20 6973 2073 6574 2074 6f20 5472 7565  k is set to True
+00021cc0: 2c20 7261 7720 6461 7461 2077 696c 6c20  , raw data will 
+00021cd0: 6265 2065 7870 6f73 6564 2074 6f20 6d65  be exposed to me
+00021ce0: 7461 206d 6f64 656c 2077 6865 6e0a 2020  ta model when.  
+00021cf0: 2020 2020 2020 2020 2020 6d61 6b69 6e67            making
+00021d00: 2070 7265 6469 6374 696f 6e73 2c20 6f74   predictions, ot
+00021d10: 6865 7277 6973 6520 7768 656e 2046 616c  herwise when Fal
+00021d20: 7365 2c20 6f6e 6c79 2074 6865 2070 7265  se, only the pre
+00021d30: 6469 6374 6564 206c 6162 656c 206f 720a  dicted label or.
+00021d40: 2020 2020 2020 2020 2020 2020 7072 6f62              prob
+00021d50: 6162 696c 6974 6965 7320 6973 2070 6173  abilities is pas
+00021d60: 7365 6420 746f 206d 6574 6120 6d6f 6465  sed to meta mode
+00021d70: 6c20 7768 656e 206d 616b 696e 6720 6669  l when making fi
+00021d80: 6e61 6c20 7072 6564 6963 7469 6f6e 732e  nal predictions.
+00021d90: 0a0a 2020 2020 2020 2020 6368 6f6f 7365  ..        choose
+00021da0: 5f62 6574 7465 723a 2062 6f6f 6c2c 2064  _better: bool, d
+00021db0: 6566 6175 6c74 203d 2046 616c 7365 0a20  efault = False. 
+00021dc0: 2020 2020 2020 2020 2020 2057 6865 6e20             When 
+00021dd0: 7365 7420 746f 2073 6574 2074 6f20 5472  set to set to Tr
+00021de0: 7565 2c20 6261 7365 2065 7374 696d 6174  ue, base estimat
+00021df0: 6f72 2069 7320 7265 7475 726e 6564 2077  or is returned w
+00021e00: 6865 6e20 7468 6520 6d65 7472 6963 2064  hen the metric d
+00021e10: 6f65 736e 2774 0a20 2020 2020 2020 2020  oesn't.         
+00021e20: 2020 2069 6d70 726f 7665 2062 7920 656e     improve by en
+00021e30: 7365 6d62 6c65 5f6d 6f64 656c 2e20 5468  semble_model. Th
+00021e40: 6973 2067 7561 7261 6e74 6565 7320 7468  is guarantees th
+00021e50: 6520 7265 7475 726e 6564 206f 626a 6563  e returned objec
+00021e60: 7420 776f 756c 6420 7065 7266 6f72 6d0a  t would perform.
+00021e70: 2020 2020 2020 2020 2020 2020 6174 206c              at l
+00021e80: 6561 7374 2065 7175 6976 616c 656e 7420  east equivalent 
+00021e90: 746f 2062 6173 6520 6573 7469 6d61 746f  to base estimato
+00021ea0: 7220 6372 6561 7465 6420 7573 696e 6720  r created using 
+00021eb0: 6372 6561 7465 5f6d 6f64 656c 206f 7220  create_model or 
+00021ec0: 6d6f 6465 6c0a 2020 2020 2020 2020 2020  model.          
+00021ed0: 2020 7265 7475 726e 6564 2062 7920 636f    returned by co
+00021ee0: 6d70 6172 655f 6d6f 6465 6c73 2e0a 0a20  mpare_models... 
+00021ef0: 2020 2020 2020 206f 7074 696d 697a 653a         optimize:
+00021f00: 2073 7472 2c20 6465 6661 756c 7420 3d20   str, default = 
+00021f10: 2741 6363 7572 6163 7927 0a20 2020 2020  'Accuracy'.     
+00021f20: 2020 2020 2020 204f 6e6c 7920 7573 6564         Only used
+00021f30: 2077 6865 6e20 6368 6f6f 7365 5f62 6574   when choose_bet
+00021f40: 7465 7220 6973 2073 6574 2074 6f20 5472  ter is set to Tr
+00021f50: 7565 2e20 6f70 7469 6d69 7a65 2070 6172  ue. optimize par
+00021f60: 616d 6574 6572 2069 7320 7573 6564 0a20  ameter is used. 
+00021f70: 2020 2020 2020 2020 2020 2074 6f20 636f             to co
+00021f80: 6d70 6172 6520 656e 7365 6d62 6c65 6420  mpare ensembled 
+00021f90: 6d6f 6465 6c20 7769 7468 2062 6173 6520  model with base 
+00021fa0: 6573 7469 6d61 746f 722e 2056 616c 7565  estimator. Value
+00021fb0: 7320 6163 6365 7074 6564 2069 6e0a 2020  s accepted in.  
+00021fc0: 2020 2020 2020 2020 2020 6f70 7469 6d69            optimi
+00021fd0: 7a65 2070 6172 616d 6574 6572 2061 7265  ze parameter are
+00021fe0: 2027 4163 6375 7261 6379 272c 2027 4155   'Accuracy', 'AU
+00021ff0: 4327 2c20 2752 6563 616c 6c27 2c20 2750  C', 'Recall', 'P
+00022000: 7265 6369 7369 6f6e 272c 2027 4631 272c  recision', 'F1',
+00022010: 0a20 2020 2020 2020 2020 2020 2027 4b61  .            'Ka
+00022020: 7070 6127 2c20 274d 4343 272e 0a0a 2020  ppa', 'MCC'...  
+00022030: 2020 2020 2020 6669 745f 6b77 6172 6773        fit_kwargs
+00022040: 3a20 6469 6374 2c20 6465 6661 756c 7420  : dict, default 
+00022050: 3d20 7b7d 2028 656d 7074 7920 6469 6374  = {} (empty dict
+00022060: 290a 2020 2020 2020 2020 2020 2020 4469  ).            Di
+00022070: 6374 696f 6e61 7279 206f 6620 6172 6775  ctionary of argu
+00022080: 6d65 6e74 7320 7061 7373 6564 2074 6f20  ments passed to 
+00022090: 7468 6520 6669 7420 6d65 7468 6f64 206f  the fit method o
+000220a0: 6620 7468 6520 6d6f 6465 6c2e 0a0a 2020  f the model...  
+000220b0: 2020 2020 2020 6772 6f75 7073 3a20 7374        groups: st
+000220c0: 7220 6f72 2061 7272 6179 2d6c 696b 652c  r or array-like,
+000220d0: 2077 6974 6820 7368 6170 6520 286e 5f73   with shape (n_s
+000220e0: 616d 706c 6573 2c29 2c20 6465 6661 756c  amples,), defaul
+000220f0: 7420 3d20 4e6f 6e65 0a20 2020 2020 2020  t = None.       
+00022100: 2020 2020 204f 7074 696f 6e61 6c20 4772       Optional Gr
+00022110: 6f75 7020 6c61 6265 6c73 2066 6f72 2074  oup labels for t
+00022120: 6865 2073 616d 706c 6573 2075 7365 6420  he samples used 
+00022130: 7768 696c 6520 7370 6c69 7474 696e 6720  while splitting 
+00022140: 7468 6520 6461 7461 7365 7420 696e 746f  the dataset into
+00022150: 2074 7261 696e 2f74 6573 7420 7365 742e   train/test set.
+00022160: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00022170: 7374 7269 6e67 2069 7320 7061 7373 6564  string is passed
+00022180: 2c20 7769 6c6c 2075 7365 2074 6865 2064  , will use the d
+00022190: 6174 6120 636f 6c75 6d6e 2077 6974 6820  ata column with 
+000221a0: 7468 6174 206e 616d 6520 6173 2074 6865  that name as the
+000221b0: 2067 726f 7570 732e 0a20 2020 2020 2020   groups..       
+000221c0: 2020 2020 204f 6e6c 7920 7573 6564 2069       Only used i
+000221d0: 6620 6120 6772 6f75 7020 6261 7365 6420  f a group based 
+000221e0: 6372 6f73 732d 7661 6c69 6461 7469 6f6e  cross-validation
+000221f0: 2067 656e 6572 6174 6f72 2069 7320 7573   generator is us
+00022200: 6564 2028 6567 2e20 4772 6f75 704b 466f  ed (eg. GroupKFo
+00022210: 6c64 292e 0a20 2020 2020 2020 2020 2020  ld)..           
+00022220: 2049 6620 4e6f 6e65 2c20 7769 6c6c 2075   If None, will u
+00022230: 7365 2074 6865 2076 616c 7565 2073 6574  se the value set
+00022240: 2069 6e20 666f 6c64 5f67 726f 7570 7320   in fold_groups 
+00022250: 7061 7261 6d65 7465 7220 696e 2073 6574  parameter in set
+00022260: 7570 2829 2e0a 0a20 2020 2020 2020 2076  up()...        v
+00022270: 6572 626f 7365 3a20 626f 6f6c 2c20 6465  erbose: bool, de
+00022280: 6661 756c 7420 3d20 5472 7565 0a20 2020  fault = True.   
+00022290: 2020 2020 2020 2020 2053 636f 7265 2067           Score g
+000222a0: 7269 6420 6973 206e 6f74 2070 7269 6e74  rid is not print
+000222b0: 6564 2077 6865 6e20 7665 7262 6f73 6520  ed when verbose 
+000222c0: 6973 2073 6574 2074 6f20 4661 6c73 652e  is set to False.
+000222d0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000222e0: 5f74 7261 696e 5f73 636f 7265 3a20 626f  _train_score: bo
+000222f0: 6f6c 2c20 6465 6661 756c 7420 3d20 4661  ol, default = Fa
+00022300: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+00022310: 4966 2046 616c 7365 2c20 7265 7475 726e  If False, return
+00022320: 7320 7468 6520 4356 2056 616c 6964 6174  s the CV Validat
+00022330: 696f 6e20 7363 6f72 6573 206f 6e6c 792e  ion scores only.
+00022340: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00022350: 5472 7565 2c20 7265 7475 726e 7320 7468  True, returns th
+00022360: 6520 4356 2074 7261 696e 696e 6720 7363  e CV training sc
+00022370: 6f72 6573 2061 6c6f 6e67 2077 6974 6820  ores along with 
+00022380: 7468 6520 4356 2076 616c 6964 6174 696f  the CV validatio
+00022390: 6e20 7363 6f72 6573 2e0a 2020 2020 2020  n scores..      
+000223a0: 2020 2020 2020 5468 6973 2069 7320 7573        This is us
+000223b0: 6566 756c 2077 6865 6e20 7468 6520 7573  eful when the us
+000223c0: 6572 2077 616e 7473 2074 6f20 646f 2062  er wants to do b
+000223d0: 6961 732d 7661 7269 616e 6365 2074 7261  ias-variance tra
+000223e0: 6465 6f66 662e 2041 2068 6967 6820 4356  deoff. A high CV
+000223f0: 0a20 2020 2020 2020 2020 2020 2074 7261  .            tra
+00022400: 696e 696e 6720 7363 6f72 6520 7769 7468  ining score with
+00022410: 2061 206c 6f77 2063 6f72 7265 7370 6f6e   a low correspon
+00022420: 6469 6e67 2043 5620 7661 6c69 6461 7469  ding CV validati
+00022430: 6f6e 2073 636f 7265 2069 6e64 6963 6174  on score indicat
+00022440: 6573 206f 7665 7266 6974 7469 6e67 2e0a  es overfitting..
+00022450: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00022460: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00022470: 0a20 2020 2020 2020 2073 636f 7265 5f67  .        score_g
+00022480: 7269 640a 2020 2020 2020 2020 2020 2020  rid.            
+00022490: 4120 7461 626c 6520 636f 6e74 6169 6e69  A table containi
+000224a0: 6e67 2074 6865 2073 636f 7265 7320 6f66  ng the scores of
+000224b0: 2074 6865 206d 6f64 656c 2061 6372 6f73   the model acros
+000224c0: 7320 7468 6520 6b66 6f6c 6473 2e0a 2020  s the kfolds..  
+000224d0: 2020 2020 2020 2020 2020 5363 6f72 696e            Scorin
+000224e0: 6720 6d65 7472 6963 7320 7573 6564 2061  g metrics used a
+000224f0: 7265 2041 6363 7572 6163 792c 2041 5543  re Accuracy, AUC
+00022500: 2c20 5265 6361 6c6c 2c20 5072 6563 6973  , Recall, Precis
+00022510: 696f 6e2c 2046 312c 0a20 2020 2020 2020  ion, F1,.       
+00022520: 2020 2020 204b 6170 7061 2061 6e64 204d       Kappa and M
+00022530: 4343 2e20 4d65 616e 2061 6e64 2073 7461  CC. Mean and sta
+00022540: 6e64 6172 6420 6465 7669 6174 696f 6e20  ndard deviation 
+00022550: 6f66 2074 6865 2073 636f 7265 7320 6163  of the scores ac
+00022560: 726f 7373 0a20 2020 2020 2020 2020 2020  ross.           
+00022570: 2074 6865 2066 6f6c 6473 2061 7265 2061   the folds are a
+00022580: 6c73 6f20 7265 7475 726e 6564 2e0a 0a20  lso returned... 
+00022590: 2020 2020 2020 206d 6f64 656c 0a20 2020         model.   
+000225a0: 2020 2020 2020 2020 2054 7261 696e 6564           Trained
+000225b0: 206d 6f64 656c 206f 626a 6563 742e 0a0a   model object...
+000225c0: 2020 2020 2020 2020 5761 726e 696e 6773          Warnings
+000225d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000225e0: 2d0a 2020 2020 2020 2020 2d20 2049 6620  -.        -  If 
+000225f0: 7461 7267 6574 2076 6172 6961 626c 6520  target variable 
+00022600: 6973 206d 756c 7469 636c 6173 7320 286d  is multiclass (m
+00022610: 6f72 6520 7468 616e 2032 2063 6c61 7373  ore than 2 class
+00022620: 6573 292c 2041 5543 2077 696c 6c20 6265  es), AUC will be
+00022630: 2072 6574 7572 6e65 640a 2020 2020 2020   returned.      
+00022640: 2020 6173 207a 6572 6f20 2830 2e30 292e    as zero (0.0).
+00022650: 0a0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+00022660: 2020 2020 2020 2066 756e 6374 696f 6e5f         function_
+00022670: 7061 7261 6d73 5f73 7472 203d 2022 2c20  params_str = ", 
+00022680: 222e 6a6f 696e 285b 6622 7b6b 7d3d 7b76  ".join([f"{k}={v
+00022690: 7d22 2066 6f72 206b 2c20 7620 696e 206c  }" for k, v in l
+000226a0: 6f63 616c 7328 292e 6974 656d 7328 295d  ocals().items()]
+000226b0: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+000226c0: 6c6f 6767 6572 2e69 6e66 6f28 2249 6e69  logger.info("Ini
+000226d0: 7469 616c 697a 696e 6720 7374 6163 6b5f  tializing stack_
+000226e0: 6d6f 6465 6c73 2829 2229 0a20 2020 2020  models()").     
+000226f0: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
+00022700: 6e66 6f28 6622 7374 6163 6b5f 6d6f 6465  nfo(f"stack_mode
+00022710: 6c73 287b 6675 6e63 7469 6f6e 5f70 6172  ls({function_par
+00022720: 616d 735f 7374 727d 2922 290a 0a20 2020  ams_str})")..   
+00022730: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
+00022740: 2e69 6e66 6f28 2243 6865 636b 696e 6720  .info("Checking 
+00022750: 6578 6365 7074 696f 6e73 2229 0a0a 2020  exceptions")..  
+00022760: 2020 2020 2020 2320 7275 6e5f 7469 6d65        # run_time
+00022770: 0a20 2020 2020 2020 2072 756e 7469 6d65  .        runtime
+00022780: 5f73 7461 7274 203d 2074 696d 652e 7469  _start = time.ti
+00022790: 6d65 2829 0a0a 2020 2020 2020 2020 6966  me()..        if
+000227a0: 206e 6f74 2066 6974 5f6b 7761 7267 733a   not fit_kwargs:
+000227b0: 0a20 2020 2020 2020 2020 2020 2066 6974  .            fit
+000227c0: 5f6b 7761 7267 7320 3d20 7b7d 0a0a 2020  _kwargs = {}..  
+000227d0: 2020 2020 2020 2320 6368 6563 6b69 6e67        # checking
+000227e0: 2065 7272 6f72 2066 6f72 2065 7374 696d   error for estim
+000227f0: 6174 6f72 5f6c 6973 740a 2020 2020 2020  ator_list.      
+00022800: 2020 666f 7220 6920 696e 2065 7374 696d    for i in estim
+00022810: 6174 6f72 5f6c 6973 743a 0a20 2020 2020  ator_list:.     
+00022820: 2020 2020 2020 2069 6620 6e6f 7420 6861         if not ha
+00022830: 7361 7474 7228 692c 2022 6669 7422 293a  sattr(i, "fit"):
+00022840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022850: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00022860: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00022870: 2020 2020 2020 2066 2245 7374 696d 6174         f"Estimat
+00022880: 6f72 207b 697d 2064 6f65 7320 6e6f 7420  or {i} does not 
+00022890: 6861 7665 2074 6865 2072 6571 7569 7265  have the require
+000228a0: 6420 6669 7428 2920 6d65 7468 6f64 2e22  d fit() method."
+000228b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000228c0: 2029 0a0a 2020 2020 2020 2020 2320 6368   )..        # ch
+000228d0: 6563 6b69 6e67 206d 6574 6120 6d6f 6465  ecking meta mode
+000228e0: 6c0a 2020 2020 2020 2020 6966 206d 6574  l.        if met
+000228f0: 615f 6d6f 6465 6c20 6973 206e 6f74 204e  a_model is not N
+00022900: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00022910: 2069 6620 6e6f 7420 6861 7361 7474 7228   if not hasattr(
+00022920: 6d65 7461 5f6d 6f64 656c 2c20 2266 6974  meta_model, "fit
+00022930: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+00022940: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00022950: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00022960: 2020 2020 2020 2020 2020 6622 4d65 7461            f"Meta
+00022970: 204d 6f64 656c 207b 6d65 7461 5f6d 6f64   Model {meta_mod
+00022980: 656c 7d20 646f 6573 206e 6f74 2068 6176  el} does not hav
+00022990: 6520 7468 6520 7265 7175 6972 6564 2066  e the required f
+000229a0: 6974 2829 206d 6574 686f 642e 220a 2020  it() method.".  
+000229b0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+000229c0: 0a20 2020 2020 2020 2023 2063 6865 636b  .        # check
+000229d0: 696e 6720 666f 6c64 2070 6172 616d 6574  ing fold paramet
+000229e0: 6572 0a20 2020 2020 2020 2069 6620 666f  er.        if fo
+000229f0: 6c64 2069 7320 6e6f 7420 4e6f 6e65 2061  ld is not None a
+00022a00: 6e64 206e 6f74 2028 0a20 2020 2020 2020  nd not (.       
+00022a10: 2020 2020 2074 7970 6528 666f 6c64 2920       type(fold) 
+00022a20: 6973 2069 6e74 206f 7220 6973 5f73 6b6c  is int or is_skl
+00022a30: 6561 726e 5f63 765f 6765 6e65 7261 746f  earn_cv_generato
+00022a40: 7228 666f 6c64 290a 2020 2020 2020 2020  r(fold).        
+00022a50: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00022a60: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
+00022a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022a80: 2266 6f6c 6420 7061 7261 6d65 7465 7220  "fold parameter 
+00022a90: 6d75 7374 2062 6520 6569 7468 6572 204e  must be either N
+00022aa0: 6f6e 652c 2061 6e20 696e 7465 6765 7220  one, an integer 
+00022ab0: 6f72 2061 2073 6369 6b69 742d 6c65 6172  or a scikit-lear
+00022ac0: 6e20 636f 6d70 6174 6962 6c65 2043 5620  n compatible CV 
+00022ad0: 6765 6e65 7261 746f 7220 6f62 6a65 6374  generator object
+00022ae0: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
+00022af0: 0a0a 2020 2020 2020 2020 2320 6368 6563  ..        # chec
+00022b00: 6b69 6e67 2072 6f75 6e64 2070 6172 616d  king round param
+00022b10: 6574 6572 0a20 2020 2020 2020 2069 6620  eter.        if 
+00022b20: 7479 7065 2872 6f75 6e64 2920 6973 206e  type(round) is n
+00022b30: 6f74 2069 6e74 3a0a 2020 2020 2020 2020  ot int:.        
+00022b40: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+00022b50: 726f 7228 2252 6f75 6e64 2070 6172 616d  ror("Round param
+00022b60: 6574 6572 206f 6e6c 7920 6163 6365 7074  eter only accept
+00022b70: 7320 696e 7465 6765 7220 7661 6c75 652e  s integer value.
+00022b80: 2229 0a0a 2020 2020 2020 2020 2320 6368  ")..        # ch
+00022b90: 6563 6b69 6e67 206d 6574 686f 6420 7061  ecking method pa
+00022ba0: 7261 6d65 7465 720a 2020 2020 2020 2020  rameter.        
+00022bb0: 6176 6169 6c61 626c 655f 6d65 7468 6f64  available_method
+00022bc0: 203d 205b 2261 7574 6f22 2c20 2270 7265   = ["auto", "pre
+00022bd0: 6469 6374 5f70 726f 6261 222c 2022 6465  dict_proba", "de
+00022be0: 6369 7369 6f6e 5f66 756e 6374 696f 6e22  cision_function"
+00022bf0: 2c20 2270 7265 6469 6374 225d 0a20 2020  , "predict"].   
+00022c00: 2020 2020 2069 6620 6d65 7468 6f64 206e       if method n
+00022c10: 6f74 2069 6e20 6176 6169 6c61 626c 655f  ot in available_
+00022c20: 6d65 7468 6f64 3a0a 2020 2020 2020 2020  method:.        
+00022c30: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00022c40: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00022c50: 2020 2020 2020 224d 6574 686f 6420 7061        "Method pa
+00022c60: 7261 6d65 7465 7220 6e6f 7420 6163 6365  rameter not acce
+00022c70: 7074 6162 6c65 2e20 4974 206f 6e6c 7920  ptable. It only 
+00022c80: 6163 6365 7074 7320 2761 7574 6f27 2c20  accepts 'auto', 
+00022c90: 2770 7265 6469 6374 5f70 726f 6261 272c  'predict_proba',
+00022ca0: 2027 6465 6369 7369 6f6e 5f66 756e 6374   'decision_funct
+00022cb0: 696f 6e27 2c20 2770 7265 6469 6374 272e  ion', 'predict'.
+00022cc0: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+00022cd0: 0a20 2020 2020 2020 2023 2063 6865 636b  .        # check
+00022ce0: 696e 6720 7265 7374 6163 6b20 7061 7261  ing restack para
+00022cf0: 6d65 7465 720a 2020 2020 2020 2020 6966  meter.        if
+00022d00: 2074 7970 6528 7265 7374 6163 6b29 2069   type(restack) i
+00022d10: 7320 6e6f 7420 626f 6f6c 3a0a 2020 2020  s not bool:.    
+00022d20: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00022d30: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
+00022d40: 2020 2020 2020 2020 2022 5265 7374 6163           "Restac
+00022d50: 6b20 7061 7261 6d65 7465 7220 6361 6e20  k parameter can 
+00022d60: 6f6e 6c79 2074 616b 6520 6172 6775 6d65  only take argume
+00022d70: 6e74 2061 7320 5472 7565 206f 7220 4661  nt as True or Fa
+00022d80: 6c73 652e 220a 2020 2020 2020 2020 2020  lse.".          
+00022d90: 2020 290a 0a20 2020 2020 2020 2023 2063    )..        # c
+00022da0: 6865 636b 696e 6720 7665 7262 6f73 6520  hecking verbose 
+00022db0: 7061 7261 6d65 7465 720a 2020 2020 2020  parameter.      
+00022dc0: 2020 6966 2074 7970 6528 7665 7262 6f73    if type(verbos
+00022dd0: 6529 2069 7320 6e6f 7420 626f 6f6c 3a0a  e) is not bool:.
+00022de0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00022df0: 6520 5479 7065 4572 726f 7228 0a20 2020  e TypeError(.   
+00022e00: 2020 2020 2020 2020 2020 2020 2022 5665               "Ve
+00022e10: 7262 6f73 6520 7061 7261 6d65 7465 7220  rbose parameter 
+00022e20: 6361 6e20 6f6e 6c79 2074 616b 6520 6172  can only take ar
+00022e30: 6775 6d65 6e74 2061 7320 5472 7565 206f  gument as True o
+00022e40: 7220 4661 6c73 652e 220a 2020 2020 2020  r False.".      
+00022e50: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00022e60: 2023 2063 6865 636b 696e 6720 6f70 7469   # checking opti
+00022e70: 6d69 7a65 2070 6172 616d 6574 6572 0a20  mize parameter. 
+00022e80: 2020 2020 2020 206f 7074 696d 697a 6520         optimize 
+00022e90: 3d20 7365 6c66 2e5f 6765 745f 6d65 7472  = self._get_metr
+00022ea0: 6963 5f62 795f 6e61 6d65 5f6f 725f 6964  ic_by_name_or_id
+00022eb0: 286f 7074 696d 697a 6529 0a20 2020 2020  (optimize).     
+00022ec0: 2020 2069 6620 6f70 7469 6d69 7a65 2069     if optimize i
+00022ed0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00022ee0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00022ef0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00022f00: 2020 2020 2020 224f 7074 696d 697a 6520        "Optimize 
+00022f10: 6d65 7468 6f64 206e 6f74 2073 7570 706f  method not suppo
+00022f20: 7274 6564 2e20 5365 6520 646f 6373 7472  rted. See docstr
+00022f30: 696e 6720 666f 7220 6c69 7374 206f 6620  ing for list of 
+00022f40: 6176 6169 6c61 626c 6520 7061 7261 6d65  available parame
+00022f50: 7465 7273 2e22 0a20 2020 2020 2020 2020  ters.".         
+00022f60: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
+00022f70: 6368 6563 6b69 6e67 206f 7074 696d 697a  checking optimiz
+00022f80: 6520 7061 7261 6d65 7465 7220 666f 7220  e parameter for 
+00022f90: 6d75 6c74 6963 6c61 7373 0a20 2020 2020  multiclass.     
+00022fa0: 2020 2069 6620 7365 6c66 2e69 735f 6d75     if self.is_mu
+00022fb0: 6c74 6963 6c61 7373 3a0a 2020 2020 2020  lticlass:.      
+00022fc0: 2020 2020 2020 6966 206e 6f74 206f 7074        if not opt
+00022fd0: 696d 697a 652e 6973 5f6d 756c 7469 636c  imize.is_multicl
+00022fe0: 6173 733a 0a20 2020 2020 2020 2020 2020  ass:.           
+00022ff0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00023000: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00023010: 2020 2020 2020 2020 2020 224f 7074 696d            "Optim
+00023020: 697a 6174 696f 6e20 6d65 7472 6963 206e  ization metric n
+00023030: 6f74 2073 7570 706f 7274 6564 2066 6f72  ot supported for
+00023040: 206d 756c 7469 636c 6173 7320 7072 6f62   multiclass prob
+00023050: 6c65 6d73 2e20 5365 6520 646f 6373 7472  lems. See docstr
+00023060: 696e 6720 666f 7220 6c69 7374 206f 6620  ing for list of 
+00023070: 6f74 6865 7220 6f70 7469 6d69 7a61 7469  other optimizati
+00023080: 6f6e 2070 6172 616d 6574 6572 732e 220a  on parameters.".
+00023090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000230a0: 290a 0a20 2020 2020 2020 2023 2063 6865  )..        # che
+000230b0: 636b 696e 6720 7265 7475 726e 5f74 7261  cking return_tra
+000230c0: 696e 5f73 636f 7265 2070 6172 616d 6574  in_score paramet
+000230d0: 6572 0a20 2020 2020 2020 2069 6620 7479  er.        if ty
+000230e0: 7065 2872 6574 7572 6e5f 7472 6169 6e5f  pe(return_train_
+000230f0: 7363 6f72 6529 2069 7320 6e6f 7420 626f  score) is not bo
+00023100: 6f6c 3a0a 2020 2020 2020 2020 2020 2020  ol:.            
+00023110: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+00023120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023130: 2022 7265 7475 726e 5f74 7261 696e 5f73   "return_train_s
+00023140: 636f 7265 2063 616e 206f 6e6c 7920 7461  core can only ta
+00023150: 6b65 2061 7267 756d 656e 7420 6173 2054  ke argument as T
+00023160: 7275 6520 6f72 2046 616c 7365 220a 2020  rue or False".  
+00023170: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00023180: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00023190: 2020 4552 524f 5220 4841 4e44 4c49 4e47    ERROR HANDLING
+000231a0: 2045 4e44 5320 4845 5245 0a0a 2020 2020   ENDS HERE..    
+000231b0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+000231c0: 2066 6f6c 6420 3d20 7365 6c66 2e5f 6765   fold = self._ge
+000231d0: 745f 6376 5f73 706c 6974 7465 7228 666f  t_cv_splitter(fo
+000231e0: 6c64 290a 0a20 2020 2020 2020 2067 726f  ld)..        gro
+000231f0: 7570 7320 3d20 7365 6c66 2e5f 6765 745f  ups = self._get_
+00023200: 6772 6f75 7073 2867 726f 7570 7329 0a0a  groups(groups)..
+00023210: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+00023220: 6765 722e 696e 666f 2822 4465 6669 6e69  ger.info("Defini
+00023230: 6e67 206d 6574 6120 6d6f 6465 6c22 290a  ng meta model").
+00023240: 2020 2020 2020 2020 6966 206d 6574 615f          if meta_
+00023250: 6d6f 6465 6c20 6973 204e 6f6e 653a 0a20  model is None:. 
+00023260: 2020 2020 2020 2020 2020 2065 7374 696d             estim
+00023270: 6174 6f72 203d 2022 6c72 220a 2020 2020  ator = "lr".    
+00023280: 2020 2020 2020 2020 6d65 7461 5f6d 6f64          meta_mod
+00023290: 656c 5f64 6566 696e 6974 696f 6e20 3d20  el_definition = 
+000232a0: 7365 6c66 2e5f 616c 6c5f 6d6f 6465 6c73  self._all_models
+000232b0: 5f69 6e74 6572 6e61 6c5b 6573 7469 6d61  _internal[estima
+000232c0: 746f 725d 0a20 2020 2020 2020 2020 2020  tor].           
+000232d0: 206d 6574 615f 6d6f 6465 6c5f 6172 6773   meta_model_args
+000232e0: 203d 206d 6574 615f 6d6f 6465 6c5f 6465   = meta_model_de
+000232f0: 6669 6e69 7469 6f6e 2e61 7267 730a 2020  finition.args.  
+00023300: 2020 2020 2020 2020 2020 6d65 7461 5f6d            meta_m
+00023310: 6f64 656c 203d 206d 6574 615f 6d6f 6465  odel = meta_mode
+00023320: 6c5f 6465 6669 6e69 7469 6f6e 2e63 6c61  l_definition.cla
+00023330: 7373 5f64 6566 282a 2a6d 6574 615f 6d6f  ss_def(**meta_mo
+00023340: 6465 6c5f 6172 6773 290a 2020 2020 2020  del_args).      
+00023350: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00023360: 2020 2020 6d65 7461 5f6d 6f64 656c 203d      meta_model =
+00023370: 2063 6c6f 6e65 2867 6574 5f65 7374 696d   clone(get_estim
+00023380: 6174 6f72 5f66 726f 6d5f 6d65 7461 5f65  ator_from_meta_e
+00023390: 7374 696d 6174 6f72 286d 6574 615f 6d6f  stimator(meta_mo
+000233a0: 6465 6c29 290a 0a20 2020 2020 2020 2070  del))..        p
+000233b0: 726f 6772 6573 735f 6172 6773 203d 207b  rogress_args = {
+000233c0: 226d 6178 223a 2032 202b 2034 7d0a 2020  "max": 2 + 4}.  
+000233d0: 2020 2020 2020 7469 6d65 7374 616d 7053        timestampS
+000233e0: 7472 203d 2064 6174 6574 696d 652e 6461  tr = datetime.da
+000233f0: 7465 7469 6d65 2e6e 6f77 2829 2e73 7472  tetime.now().str
+00023400: 6674 696d 6528 2225 483a 254d 3a25 5322  ftime("%H:%M:%S"
+00023410: 290a 2020 2020 2020 2020 6d6f 6e69 746f  ).        monito
+00023420: 725f 726f 7773 203d 205b 0a20 2020 2020  r_rows = [.     
+00023430: 2020 2020 2020 205b 2249 6e69 7469 6174         ["Initiat
+00023440: 6564 222c 2022 2e20 2e20 2e20 2e20 2e20  ed", ". . . . . 
+00023450: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
+00023460: 2e20 2e20 2e20 2e20 2e22 2c20 7469 6d65  . . . . .", time
+00023470: 7374 616d 7053 7472 5d2c 0a20 2020 2020  stampStr],.     
+00023480: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+00023490: 2020 2020 2020 2020 2022 5374 6174 7573           "Status
+000234a0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000234b0: 2020 2022 2e20 2e20 2e20 2e20 2e20 2e20     ". . . . . . 
+000234c0: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
+000234d0: 2e20 2e20 2e20 2e22 2c0a 2020 2020 2020  . . . .",.      
+000234e0: 2020 2020 2020 2020 2020 224c 6f61 6469            "Loadi
+000234f0: 6e67 2044 6570 656e 6465 6e63 6965 7322  ng Dependencies"
+00023500: 2c0a 2020 2020 2020 2020 2020 2020 5d2c  ,.            ],
+00023510: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
+00023520: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00023530: 4573 7469 6d61 746f 7222 2c0a 2020 2020  Estimator",.    
+00023540: 2020 2020 2020 2020 2020 2020 222e 202e              ". .
+00023550: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
+00023560: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
+00023570: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00023580: 2020 2022 436f 6d70 696c 696e 6720 4c69     "Compiling Li
+00023590: 6272 6172 7922 2c0a 2020 2020 2020 2020  brary",.        
+000235a0: 2020 2020 5d2c 0a20 2020 2020 2020 205d      ],.        ]
+000235b0: 0a20 2020 2020 2020 2064 6973 706c 6179  .        display
+000235c0: 203d 2043 6f6d 6d6f 6e44 6973 706c 6179   = CommonDisplay
+000235d0: 280a 2020 2020 2020 2020 2020 2020 7665  (.            ve
+000235e0: 7262 6f73 653d 7665 7262 6f73 652c 0a20  rbose=verbose,. 
+000235f0: 2020 2020 2020 2020 2020 2068 746d 6c5f             html_
+00023600: 7061 7261 6d3d 7365 6c66 2e68 746d 6c5f  param=self.html_
+00023610: 7061 7261 6d2c 0a20 2020 2020 2020 2020  param,.         
+00023620: 2020 2070 726f 6772 6573 735f 6172 6773     progress_args
+00023630: 3d70 726f 6772 6573 735f 6172 6773 2c0a  =progress_args,.
+00023640: 2020 2020 2020 2020 2020 2020 6d6f 6e69              moni
+00023650: 746f 725f 726f 7773 3d6d 6f6e 6974 6f72  tor_rows=monitor
+00023660: 5f72 6f77 732c 0a20 2020 2020 2020 2029  _rows,.        )
+00023670: 0a0a 2020 2020 2020 2020 6e70 2e72 616e  ..        np.ran
+00023680: 646f 6d2e 7365 6564 2873 656c 662e 7365  dom.seed(self.se
+00023690: 6564 290a 0a20 2020 2020 2020 2023 2073  ed)..        # s
+000236a0: 6574 7469 6e67 206f 7074 696d 697a 6520  etting optimize 
+000236b0: 7061 7261 6d65 7465 720a 2020 2020 2020  parameter.      
+000236c0: 2020 636f 6d70 6172 655f 6469 6d65 6e73    compare_dimens
+000236d0: 696f 6e20 3d20 6f70 7469 6d69 7a65 2e64  ion = optimize.d
+000236e0: 6973 706c 6179 5f6e 616d 650a 2020 2020  isplay_name.    
+000236f0: 2020 2020 6f70 7469 6d69 7a65 203d 206f      optimize = o
+00023700: 7074 696d 697a 652e 7363 6f72 6572 0a0a  ptimize.scorer..
+00023710: 2020 2020 2020 2020 6469 7370 6c61 792e          display.
+00023720: 6d6f 7665 5f70 726f 6772 6573 7328 290a  move_progress().
+00023730: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00023740: 2020 2020 204d 4f4e 4954 4f52 2055 5044       MONITOR UPD
+00023750: 4154 4520 5354 4152 5453 0a20 2020 2020  ATE STARTS.     
+00023760: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+00023770: 6469 7370 6c61 792e 7570 6461 7465 5f6d  display.update_m
+00023780: 6f6e 6974 6f72 2831 2c20 2243 6f6d 7069  onitor(1, "Compi
+00023790: 6c69 6e67 2045 7374 696d 6174 6f72 7322  ling Estimators"
+000237a0: 290a 0a20 2020 2020 2020 2022 2222 0a20  )..        """. 
+000237b0: 2020 2020 2020 204d 4f4e 4954 4f52 2055         MONITOR U
+000237c0: 5044 4154 4520 454e 4453 0a20 2020 2020  PDATE ENDS.     
+000237d0: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+000237e0: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
+000237f0: 2822 4765 7474 696e 6720 6d6f 6465 6c20  ("Getting model 
+00023800: 6e61 6d65 7322 290a 2020 2020 2020 2020  names").        
+00023810: 6573 7469 6d61 746f 725f 6469 6374 203d  estimator_dict =
+00023820: 207b 7d0a 2020 2020 2020 2020 666f 7220   {}.        for 
+00023830: 7820 696e 2065 7374 696d 6174 6f72 5f6c  x in estimator_l
+00023840: 6973 743a 0a20 2020 2020 2020 2020 2020  ist:.           
+00023850: 2078 203d 2067 6574 5f65 7374 696d 6174   x = get_estimat
+00023860: 6f72 5f66 726f 6d5f 6d65 7461 5f65 7374  or_from_meta_est
+00023870: 696d 6174 6f72 2878 290a 2020 2020 2020  imator(x).      
+00023880: 2020 2020 2020 6e61 6d65 203d 2073 656c        name = sel
+00023890: 662e 5f67 6574 5f6d 6f64 656c 5f6e 616d  f._get_model_nam
+000238a0: 6528 7829 0a20 2020 2020 2020 2020 2020  e(x).           
+000238b0: 2073 7566 6669 7820 3d20 310a 2020 2020   suffix = 1.    
+000238c0: 2020 2020 2020 2020 6f72 6967 696e 616c          original
+000238d0: 5f6e 616d 6520 3d20 6e61 6d65 0a20 2020  _name = name.   
+000238e0: 2020 2020 2020 2020 2077 6869 6c65 206e           while n
+000238f0: 616d 6520 696e 2065 7374 696d 6174 6f72  ame in estimator
+00023900: 5f64 6963 743a 0a20 2020 2020 2020 2020  _dict:.         
+00023910: 2020 2020 2020 206e 616d 6520 3d20 6622         name = f"
+00023920: 7b6f 7269 6769 6e61 6c5f 6e61 6d65 7d5f  {original_name}_
+00023930: 7b73 7566 6669 787d 220a 2020 2020 2020  {suffix}".      
+00023940: 2020 2020 2020 2020 2020 7375 6666 6978            suffix
+00023950: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
+00023960: 2020 6573 7469 6d61 746f 725f 6469 6374    estimator_dict
+00023970: 5b6e 616d 655d 203d 2078 0a0a 2020 2020  [name] = x..    
+00023980: 2020 2020 6573 7469 6d61 746f 725f 6c69      estimator_li
+00023990: 7374 203d 206c 6973 7428 6573 7469 6d61  st = list(estima
+000239a0: 746f 725f 6469 6374 2e69 7465 6d73 2829  tor_dict.items()
+000239b0: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+000239c0: 6c6f 6767 6572 2e69 6e66 6f28 6573 7469  logger.info(esti
+000239d0: 6d61 746f 725f 6c69 7374 290a 0a20 2020  mator_list)..   
+000239e0: 2020 2020 2073 7461 636b 696e 675f 6d6f       stacking_mo
+000239f0: 6465 6c5f 6465 6669 6e69 7469 6f6e 203d  del_definition =
+00023a00: 2073 656c 662e 5f61 6c6c 5f6d 6f64 656c   self._all_model
+00023a10: 735f 696e 7465 726e 616c 5b22 5374 6163  s_internal["Stac
+00023a20: 6b69 6e67 225d 0a20 2020 2020 2020 2069  king"].        i
+00023a30: 6620 7365 6c66 2e5f 6d6c 5f75 7365 6361  f self._ml_useca
+00023a40: 7365 203d 3d20 4d4c 5573 6563 6173 652e  se == MLUsecase.
+00023a50: 434c 4153 5349 4649 4341 5449 4f4e 3a0a  CLASSIFICATION:.
+00023a60: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+00023a70: 6c20 3d20 7374 6163 6b69 6e67 5f6d 6f64  l = stacking_mod
+00023a80: 656c 5f64 6566 696e 6974 696f 6e2e 636c  el_definition.cl
+00023a90: 6173 735f 6465 6628 0a20 2020 2020 2020  ass_def(.       
+00023aa0: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
+00023ab0: 6f72 733d 6573 7469 6d61 746f 725f 6c69  ors=estimator_li
+00023ac0: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
+00023ad0: 2020 2020 6669 6e61 6c5f 6573 7469 6d61      final_estima
+00023ae0: 746f 723d 6d65 7461 5f6d 6f64 656c 2c0a  tor=meta_model,.
+00023af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023b00: 6376 3d6d 6574 615f 6d6f 6465 6c5f 666f  cv=meta_model_fo
+00023b10: 6c64 2c0a 2020 2020 2020 2020 2020 2020  ld,.            
+00023b20: 2020 2020 7374 6163 6b5f 6d65 7468 6f64      stack_method
+00023b30: 3d6d 6574 686f 642c 0a20 2020 2020 2020  =method,.       
+00023b40: 2020 2020 2020 2020 206e 5f6a 6f62 733d           n_jobs=
+00023b50: 7365 6c66 2e67 7075 5f6e 5f6a 6f62 735f  self.gpu_n_jobs_
+00023b60: 7061 7261 6d2c 0a20 2020 2020 2020 2020  param,.         
+00023b70: 2020 2020 2020 2070 6173 7374 6872 6f75         passthrou
+00023b80: 6768 3d72 6573 7461 636b 2c0a 2020 2020  gh=restack,.    
+00023b90: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00023ba0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00023bb0: 2020 2020 6d6f 6465 6c20 3d20 7374 6163      model = stac
+00023bc0: 6b69 6e67 5f6d 6f64 656c 5f64 6566 696e  king_model_defin
+00023bd0: 6974 696f 6e2e 636c 6173 735f 6465 6628  ition.class_def(
+00023be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023bf0: 2065 7374 696d 6174 6f72 733d 6573 7469   estimators=esti
+00023c00: 6d61 746f 725f 6c69 7374 2c0a 2020 2020  mator_list,.    
+00023c10: 2020 2020 2020 2020 2020 2020 6669 6e61              fina
+00023c20: 6c5f 6573 7469 6d61 746f 723d 6d65 7461  l_estimator=meta
+00023c30: 5f6d 6f64 656c 2c0a 2020 2020 2020 2020  _model,.        
+00023c40: 2020 2020 2020 2020 6376 3d6d 6574 615f          cv=meta_
+00023c50: 6d6f 6465 6c5f 666f 6c64 2c0a 2020 2020  model_fold,.    
+00023c60: 2020 2020 2020 2020 2020 2020 6e5f 6a6f              n_jo
+00023c70: 6273 3d73 656c 662e 6770 755f 6e5f 6a6f  bs=self.gpu_n_jo
+00023c80: 6273 5f70 6172 616d 2c0a 2020 2020 2020  bs_param,.      
+00023c90: 2020 2020 2020 2020 2020 7061 7373 7468            passth
+00023ca0: 726f 7567 683d 7265 7374 6163 6b2c 0a20  rough=restack,. 
+00023cb0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00023cc0: 2020 2020 2020 6469 7370 6c61 792e 7570        display.up
+00023cd0: 6461 7465 5f6d 6f6e 6974 6f72 2832 2c20  date_monitor(2, 
+00023ce0: 7374 6163 6b69 6e67 5f6d 6f64 656c 5f64  stacking_model_d
+00023cf0: 6566 696e 6974 696f 6e2e 6e61 6d65 290a  efinition.name).
+00023d00: 0a20 2020 2020 2020 2064 6973 706c 6179  .        display
+00023d10: 2e6d 6f76 655f 7072 6f67 7265 7373 2829  .move_progress()
+00023d20: 0a0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+00023d30: 6f67 6765 722e 696e 666f 280a 2020 2020  ogger.info(.    
+00023d40: 2020 2020 2020 2020 2253 7562 5072 6f63          "SubProc
+00023d50: 6573 7320 6372 6561 7465 5f6d 6f64 656c  ess create_model
+00023d60: 2829 2063 616c 6c65 6420 3d3d 3d3d 3d3d  () called ======
+00023d70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00023d80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 220a 2020  ============".  
+00023d90: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00023da0: 6d6f 6465 6c2c 206d 6f64 656c 5f66 6974  model, model_fit
+00023db0: 5f74 696d 6520 3d20 7365 6c66 2e5f 6372  _time = self._cr
+00023dc0: 6561 7465 5f6d 6f64 656c 280a 2020 2020  eate_model(.    
+00023dd0: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
+00023de0: 723d 6d6f 6465 6c2c 0a20 2020 2020 2020  r=model,.       
+00023df0: 2020 2020 2073 7973 7465 6d3d 4661 6c73       system=Fals
+00023e00: 652c 0a20 2020 2020 2020 2020 2020 2064  e,.            d
+00023e10: 6973 706c 6179 3d64 6973 706c 6179 2c0a  isplay=display,.
+00023e20: 2020 2020 2020 2020 2020 2020 666f 6c64              fold
+00023e30: 3d66 6f6c 642c 0a20 2020 2020 2020 2020  =fold,.         
+00023e40: 2020 2072 6f75 6e64 3d72 6f75 6e64 2c0a     round=round,.
+00023e50: 2020 2020 2020 2020 2020 2020 6669 745f              fit_
+00023e60: 6b77 6172 6773 3d66 6974 5f6b 7761 7267  kwargs=fit_kwarg
+00023e70: 732c 0a20 2020 2020 2020 2020 2020 2067  s,.            g
+00023e80: 726f 7570 733d 6772 6f75 7073 2c0a 2020  roups=groups,.  
+00023e90: 2020 2020 2020 2020 2020 7072 6f62 6162            probab
+00023ea0: 696c 6974 795f 7468 7265 7368 6f6c 643d  ility_threshold=
+00023eb0: 7072 6f62 6162 696c 6974 795f 7468 7265  probability_thre
+00023ec0: 7368 6f6c 642c 0a20 2020 2020 2020 2020  shold,.         
+00023ed0: 2020 2072 6574 7572 6e5f 7472 6169 6e5f     return_train_
+00023ee0: 7363 6f72 653d 7265 7475 726e 5f74 7261  score=return_tra
+00023ef0: 696e 5f73 636f 7265 2c0a 2020 2020 2020  in_score,.      
+00023f00: 2020 290a 2020 2020 2020 2020 6d6f 6465    ).        mode
+00023f10: 6c5f 7265 7375 6c74 7320 3d20 7365 6c66  l_results = self
+00023f20: 2e70 756c 6c28 290a 2020 2020 2020 2020  .pull().        
+00023f30: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
+00023f40: 280a 2020 2020 2020 2020 2020 2020 2253  (.            "S
+00023f50: 7562 5072 6f63 6573 7320 6372 6561 7465  ubProcess create
+00023f60: 5f6d 6f64 656c 2829 2065 6e64 203d 3d3d  _model() end ===
+00023f70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00023f80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d22  ==============="
+00023f90: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00023fa0: 2020 2020 2320 656e 6420 7275 6e74 696d      # end runtim
+00023fb0: 650a 2020 2020 2020 2020 7275 6e74 696d  e.        runtim
+00023fc0: 655f 656e 6420 3d20 7469 6d65 2e74 696d  e_end = time.tim
+00023fd0: 6528 290a 2020 2020 2020 2020 7275 6e74  e().        runt
+00023fe0: 696d 6520 3d20 6e70 2e61 7272 6179 2872  ime = np.array(r
+00023ff0: 756e 7469 6d65 5f65 6e64 202d 2072 756e  untime_end - run
+00024000: 7469 6d65 5f73 7461 7274 292e 726f 756e  time_start).roun
+00024010: 6428 3229 0a0a 2020 2020 2020 2020 2320  d(2)..        # 
+00024020: 6461 7368 626f 6172 6420 6c6f 6767 696e  dashboard loggin
+00024030: 670a 2020 2020 2020 2020 6966 2073 656c  g.        if sel
+00024040: 662e 6c6f 6767 696e 675f 7061 7261 6d3a  f.logging_param:
+00024050: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+00024060: 6963 6573 203d 2073 656c 662e 5f67 6574  ices = self._get
+00024070: 5f72 6574 7572 6e5f 7472 6169 6e5f 7363  _return_train_sc
+00024080: 6f72 655f 696e 6469 6365 735f 666f 725f  ore_indices_for_
+00024090: 6c6f 6767 696e 6728 0a20 2020 2020 2020  logging(.       
+000240a0: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
+000240b0: 7472 6169 6e5f 7363 6f72 653d 7265 7475  train_score=retu
+000240c0: 726e 5f74 7261 696e 5f73 636f 7265 0a20  rn_train_score. 
+000240d0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000240e0: 2020 2020 2020 2020 2061 7667 735f 6469           avgs_di
+000240f0: 6374 5f6c 6f67 203d 207b 6b3a 2076 2066  ct_log = {k: v f
+00024100: 6f72 206b 2c20 7620 696e 206d 6f64 656c  or k, v in model
+00024110: 5f72 6573 756c 7473 2e6c 6f63 5b69 6e64  _results.loc[ind
+00024120: 6963 6573 5d2e 6974 656d 7328 297d 0a20  ices].items()}. 
+00024130: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00024140: 6c6f 6767 696e 675f 7061 7261 6d2e 6c6f  logging_param.lo
+00024150: 675f 6d6f 6465 6c5f 636f 6d70 6172 6973  g_model_comparis
+00024160: 6f6e 286d 6f64 656c 5f72 6573 756c 7473  on(model_results
+00024170: 2c20 2273 7461 636b 5f6d 6f64 656c 2229  , "stack_model")
+00024180: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00024190: 6c66 2e5f 6c6f 675f 6d6f 6465 6c28 0a20  lf._log_model(. 
+000241a0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+000241b0: 6f64 656c 3d6d 6f64 656c 2c0a 2020 2020  odel=model,.    
+000241c0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+000241d0: 6c5f 7265 7375 6c74 733d 6d6f 6465 6c5f  l_results=model_
+000241e0: 7265 7375 6c74 732c 0a20 2020 2020 2020  results,.       
+000241f0: 2020 2020 2020 2020 2073 636f 7265 5f64           score_d
+00024200: 6963 743d 6176 6773 5f64 6963 745f 6c6f  ict=avgs_dict_lo
+00024210: 672c 0a20 2020 2020 2020 2020 2020 2020  g,.             
+00024220: 2020 2073 6f75 7263 653d 2273 7461 636b     source="stack
+00024230: 5f6d 6f64 656c 7322 2c0a 2020 2020 2020  _models",.      
+00024240: 2020 2020 2020 2020 2020 7275 6e74 696d            runtim
+00024250: 653d 7275 6e74 696d 652c 0a20 2020 2020  e=runtime,.     
+00024260: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+00024270: 5f66 6974 5f74 696d 653d 6d6f 6465 6c5f  _fit_time=model_
+00024280: 6669 745f 7469 6d65 2c0a 2020 2020 2020  fit_time,.      
+00024290: 2020 2020 2020 2020 2020 7069 7065 6c69            pipeli
+000242a0: 6e65 3d73 656c 662e 7069 7065 6c69 6e65  ne=self.pipeline
+000242b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000242c0: 2020 6c6f 675f 706c 6f74 733d 7365 6c66    log_plots=self
+000242d0: 2e6c 6f67 5f70 6c6f 7473 5f70 6172 616d  .log_plots_param
+000242e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000242f0: 2020 6469 7370 6c61 793d 6469 7370 6c61    display=displa
+00024300: 792c 0a20 2020 2020 2020 2020 2020 2029  y,.            )
+00024310: 0a0a 2020 2020 2020 2020 6966 2063 686f  ..        if cho
+00024320: 6f73 655f 6265 7474 6572 3a0a 2020 2020  ose_better:.    
+00024330: 2020 2020 2020 2020 6e65 775f 6d6f 6465          new_mode
+00024340: 6c20 3d20 7365 6c66 2e5f 6368 6f6f 7365  l = self._choose
+00024350: 5f62 6574 7465 7228 0a20 2020 2020 2020  _better(.       
+00024360: 2020 2020 2020 2020 205b 286d 6f64 656c           [(model
+00024370: 2c20 6d6f 6465 6c5f 7265 7375 6c74 7329  , model_results)
+00024380: 5d20 2b20 6573 7469 6d61 746f 725f 6c69  ] + estimator_li
+00024390: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
+000243a0: 2020 2020 636f 6d70 6172 655f 6469 6d65      compare_dime
+000243b0: 6e73 696f 6e2c 0a20 2020 2020 2020 2020  nsion,.         
+000243c0: 2020 2020 2020 2066 6f6c 642c 0a20 2020         fold,.   
+000243d0: 2020 2020 2020 2020 2020 2020 2067 726f               gro
+000243e0: 7570 733d 6772 6f75 7073 2c0a 2020 2020  ups=groups,.    
+000243f0: 2020 2020 2020 2020 2020 2020 6669 745f              fit_
+00024400: 6b77 6172 6773 3d66 6974 5f6b 7761 7267  kwargs=fit_kwarg
+00024410: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00024420: 2020 2064 6973 706c 6179 3d64 6973 706c     display=displ
+00024430: 6179 2c0a 2020 2020 2020 2020 2020 2020  ay,.            
+00024440: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00024450: 206e 6577 5f6d 6f64 656c 2069 7320 6e6f   new_model is no
+00024460: 7420 6d6f 6465 6c3a 0a20 2020 2020 2020  t model:.       
+00024470: 2020 2020 2020 2020 206d 7367 203d 2028           msg = (
+00024480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024490: 2020 2020 2022 4f72 6967 696e 616c 206d       "Original m
+000244a0: 6f64 656c 2077 6173 2062 6574 7465 7220  odel was better 
+000244b0: 7468 616e 2074 6865 2073 7461 636b 6564  than the stacked
+000244c0: 206d 6f64 656c 2c20 6865 6e63 6520 6974   model, hence it
+000244d0: 2077 696c 6c20 6265 2072 6574 7572 6e65   will be returne
+000244e0: 642e 2022 0a20 2020 2020 2020 2020 2020  d. ".           
+000244f0: 2020 2020 2020 2020 2022 4e4f 5445 3a20           "NOTE: 
+00024500: 5468 6520 6469 7370 6c61 7920 6d65 7472  The display metr
+00024510: 6963 7320 6172 6520 666f 7220 7468 6520  ics are for the 
+00024520: 7374 6163 6b65 6420 6d6f 6465 6c20 286e  stacked model (n
+00024530: 6f74 2074 6865 206f 7269 6769 6e61 6c20  ot the original 
+00024540: 6f6e 6529 2e22 0a20 2020 2020 2020 2020  one).".         
+00024550: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00024560: 2020 2020 2020 2020 2069 6620 7665 7262           if verb
+00024570: 6f73 653a 0a20 2020 2020 2020 2020 2020  ose:.           
+00024580: 2020 2020 2020 2020 2070 7269 6e74 286d           print(m
+00024590: 7367 290a 2020 2020 2020 2020 2020 2020  sg).            
+000245a0: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
+000245b0: 696e 666f 286d 7367 290a 2020 2020 2020  info(msg).      
+000245c0: 2020 2020 2020 6d6f 6465 6c20 3d20 6e65        model = ne
+000245d0: 775f 6d6f 6465 6c0a 0a20 2020 2020 2020  w_model..       
+000245e0: 206d 6f64 656c 5f72 6573 756c 7473 203d   model_results =
+000245f0: 2073 656c 662e 5f68 6967 686c 6967 6874   self._highlight
+00024600: 5f61 6e64 5f72 6f75 6e64 5f6d 6f64 656c  _and_round_model
+00024610: 5f72 6573 756c 7473 280a 2020 2020 2020  _results(.      
+00024620: 2020 2020 2020 6d6f 6465 6c5f 7265 7375        model_resu
+00024630: 6c74 732c 2072 6574 7572 6e5f 7472 6169  lts, return_trai
+00024640: 6e5f 7363 6f72 652c 2072 6f75 6e64 0a20  n_score, round. 
+00024650: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00024660: 2064 6973 706c 6179 2e64 6973 706c 6179   display.display
+00024670: 286d 6f64 656c 5f72 6573 756c 7473 290a  (model_results).
+00024680: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
+00024690: 6767 6572 2e69 6e66 6f28 0a20 2020 2020  gger.info(.     
+000246a0: 2020 2020 2020 2066 225f 6d61 7374 6572         f"_master
+000246b0: 5f6d 6f64 656c 5f63 6f6e 7461 696e 6572  _model_container
+000246c0: 3a20 7b6c 656e 2873 656c 662e 5f6d 6173  : {len(self._mas
+000246d0: 7465 725f 6d6f 6465 6c5f 636f 6e74 6169  ter_model_contai
+000246e0: 6e65 7229 7d22 0a20 2020 2020 2020 2029  ner)}".        )
+000246f0: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
+00024700: 6767 6572 2e69 6e66 6f28 6622 5f64 6973  gger.info(f"_dis
+00024710: 706c 6179 5f63 6f6e 7461 696e 6572 3a20  play_container: 
+00024720: 7b6c 656e 2873 656c 662e 5f64 6973 706c  {len(self._displ
+00024730: 6179 5f63 6f6e 7461 696e 6572 297d 2229  ay_container)}")
+00024740: 0a0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+00024750: 6f67 6765 722e 696e 666f 2873 7472 286d  ogger.info(str(m
+00024760: 6f64 656c 2929 0a20 2020 2020 2020 2073  odel)).        s
+00024770: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
+00024780: 0a20 2020 2020 2020 2020 2020 2022 7374  .            "st
+00024790: 6163 6b5f 6d6f 6465 6c73 2829 2073 7563  ack_models() suc
+000247a0: 6365 7373 6675 6c6c 7920 636f 6d70 6c65  cessfully comple
+000247b0: 7465 642e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ted.............
+000247c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000247d0: 2e2e 2e2e 2e2e 2e2e 2e22 0a20 2020 2020  .........".     
+000247e0: 2020 2029 0a0a 2020 2020 2020 2020 6763     )..        gc
+000247f0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00024800: 2020 2072 6574 7572 6e20 6d6f 6465 6c0a     return model.
+00024810: 0a20 2020 2064 6566 2069 6e74 6572 7072  .    def interpr
+00024820: 6574 5f6d 6f64 656c 280a 2020 2020 2020  et_model(.      
+00024830: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00024840: 6573 7469 6d61 746f 722c 0a20 2020 2020  estimator,.     
+00024850: 2020 2070 6c6f 743a 2073 7472 203d 2022     plot: str = "
+00024860: 7375 6d6d 6172 7922 2c0a 2020 2020 2020  summary",.      
+00024870: 2020 6665 6174 7572 653a 204f 7074 696f    feature: Optio
+00024880: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+00024890: 0a20 2020 2020 2020 206f 6273 6572 7661  .        observa
+000248a0: 7469 6f6e 3a20 4f70 7469 6f6e 616c 5b69  tion: Optional[i
+000248b0: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
+000248c0: 2020 2020 7573 655f 7472 6169 6e5f 6461      use_train_da
+000248d0: 7461 3a20 626f 6f6c 203d 2046 616c 7365  ta: bool = False
+000248e0: 2c0a 2020 2020 2020 2020 585f 6e65 775f  ,.        X_new_
+000248f0: 7361 6d70 6c65 3a20 4f70 7469 6f6e 616c  sample: Optional
+00024900: 5b70 642e 4461 7461 4672 616d 655d 203d  [pd.DataFrame] =
+00024910: 204e 6f6e 652c 0a20 2020 2020 2020 2079   None,.        y
+00024920: 5f6e 6577 5f73 616d 706c 653a 204f 7074  _new_sample: Opt
+00024930: 696f 6e61 6c5b 7064 2e44 6174 6146 7261  ional[pd.DataFra
+00024940: 6d65 5d20 3d20 4e6f 6e65 2c20 2023 2061  me] = None,  # a
+00024950: 6464 2066 6f72 2070 6669 2065 7870 6c61  dd for pfi expla
+00024960: 696e 6572 0a20 2020 2020 2020 2073 6176  iner.        sav
+00024970: 653a 2055 6e69 6f6e 5b73 7472 2c20 626f  e: Union[str, bo
+00024980: 6f6c 5d20 3d20 4661 6c73 652c 0a20 2020  ol] = False,.   
+00024990: 2020 2020 202a 2a6b 7761 7267 732c 2020       **kwargs,  
+000249a0: 2320 6164 6465 6420 696e 2070 7963 6172  # added in pycar
+000249b0: 6574 3d3d 322e 310a 2020 2020 293a 0a20  et==2.1.    ):. 
+000249c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000249d0: 2020 2054 6869 7320 6675 6e63 7469 6f6e     This function
+000249e0: 2074 616b 6573 2061 2074 7261 696e 6564   takes a trained
+000249f0: 206d 6f64 656c 206f 626a 6563 7420 616e   model object an
+00024a00: 6420 7265 7475 726e 7320 616e 2069 6e74  d returns an int
+00024a10: 6572 7072 6574 6174 696f 6e20 706c 6f74  erpretation plot
+00024a20: 0a20 2020 2020 2020 2062 6173 6564 206f  .        based o
+00024a30: 6e20 7468 6520 7465 7374 202f 2068 6f6c  n the test / hol
+00024a40: 642d 6f75 7420 7365 742e 2049 7420 6f6e  d-out set. It on
+00024a50: 6c79 2073 7570 706f 7274 7320 7472 6565  ly supports tree
+00024a60: 2062 6173 6564 2061 6c67 6f72 6974 686d   based algorithm
+00024a70: 732e 0a0a 2020 2020 2020 2020 5468 6973  s...        This
+00024a80: 2066 756e 6374 696f 6e20 6973 2069 6d70   function is imp
+00024a90: 6c65 6d65 6e74 6564 2062 6173 6564 206f  lemented based o
+00024aa0: 6e20 7468 6520 5348 4150 2028 5348 6170  n the SHAP (SHap
+00024ab0: 6c65 7920 4164 6469 7469 7665 2065 7850  ley Additive exP
+00024ac0: 6c61 6e61 7469 6f6e 7329 2c0a 2020 2020  lanations),.    
+00024ad0: 2020 2020 7768 6963 6820 6973 2061 2075      which is a u
+00024ae0: 6e69 6669 6564 2061 7070 726f 6163 6820  nified approach 
+00024af0: 746f 2065 7870 6c61 696e 2074 6865 206f  to explain the o
+00024b00: 7574 7075 7420 6f66 2061 6e79 206d 6163  utput of any mac
+00024b10: 6869 6e65 206c 6561 726e 696e 6720 6d6f  hine learning mo
+00024b20: 6465 6c2e 0a20 2020 2020 2020 2053 4841  del..        SHA
+00024b30: 5020 636f 6e6e 6563 7473 2067 616d 6520  P connects game 
+00024b40: 7468 656f 7279 2077 6974 6820 6c6f 6361  theory with loca
+00024b50: 6c20 6578 706c 616e 6174 696f 6e73 2e0a  l explanations..
+00024b60: 0a20 2020 2020 2020 2046 6f72 206d 6f72  .        For mor
+00024b70: 6520 696e 666f 726d 6174 696f 6e20 3a20  e information : 
+00024b80: 6874 7470 733a 2f2f 7368 6170 2e72 6561  https://shap.rea
+00024b90: 6474 6865 646f 6373 2e69 6f2f 656e 2f6c  dthedocs.io/en/l
+00024ba0: 6174 6573 742f 0a0a 2020 2020 2020 2020  atest/..        
+00024bb0: 466f 7220 5061 7274 6961 6c20 4465 7065  For Partial Depe
+00024bc0: 6e64 656e 6365 2050 6c6f 7420 3a20 6874  ndence Plot : ht
+00024bd0: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+00024be0: 2f53 6175 6365 4361 742f 5044 5062 6f78  /SauceCat/PDPbox
+00024bf0: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+00024c00: 650a 2020 2020 2020 2020 2d2d 2d2d 2d2d  e.        ------
+00024c10: 2d0a 2020 2020 2020 2020 3e3e 3e20 6672  -.        >>> fr
+00024c20: 6f6d 2070 7963 6172 6574 2e64 6174 6173  om pycaret.datas
+00024c30: 6574 7320 696d 706f 7274 2067 6574 5f64  ets import get_d
+00024c40: 6174 610a 2020 2020 2020 2020 3e3e 3e20  ata.        >>> 
+00024c50: 6a75 6963 6520 3d20 6765 745f 6461 7461  juice = get_data
+00024c60: 2827 6a75 6963 6527 290a 2020 2020 2020  ('juice').      
+00024c70: 2020 3e3e 3e20 6578 7065 7269 6d65 6e74    >>> experiment
+00024c80: 5f6e 616d 6520 3d20 7365 7475 7028 6461  _name = setup(da
+00024c90: 7461 203d 206a 7569 6365 2c20 2074 6172  ta = juice,  tar
+00024ca0: 6765 7420 3d20 2750 7572 6368 6173 6527  get = 'Purchase'
+00024cb0: 290a 2020 2020 2020 2020 3e3e 3e20 6474  ).        >>> dt
+00024cc0: 203d 2063 7265 6174 655f 6d6f 6465 6c28   = create_model(
+00024cd0: 2764 7427 290a 2020 2020 2020 2020 3e3e  'dt').        >>
+00024ce0: 3e20 696e 7465 7270 7265 745f 6d6f 6465  > interpret_mode
+00024cf0: 6c28 6474 290a 0a20 2020 2020 2020 2054  l(dt)..        T
+00024d00: 6869 7320 7769 6c6c 2072 6574 7572 6e20  his will return 
+00024d10: 6120 7375 6d6d 6172 7920 696e 7465 7270  a summary interp
+00024d20: 7265 7461 7469 6f6e 2070 6c6f 7420 6f66  retation plot of
+00024d30: 2044 6563 6973 696f 6e20 5472 6565 206d   Decision Tree m
+00024d40: 6f64 656c 2e0a 0a20 2020 2020 2020 2050  odel...        P
+00024d50: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00024d60: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00024d70: 2020 2020 2065 7374 696d 6174 6f72 203a       estimator :
+00024d80: 206f 626a 6563 742c 2064 6566 6175 6c74   object, default
+00024d90: 203d 206e 6f6e 650a 2020 2020 2020 2020   = none.        
+00024da0: 2020 2020 4120 7472 6169 6e65 6420 6d6f      A trained mo
+00024db0: 6465 6c20 6f62 6a65 6374 2074 6f20 6265  del object to be
+00024dc0: 2070 6173 7365 6420 6173 2061 6e20 6573   passed as an es
+00024dd0: 7469 6d61 746f 722e 204f 6e6c 7920 7472  timator. Only tr
+00024de0: 6565 2d62 6173 6564 0a20 2020 2020 2020  ee-based.       
+00024df0: 2020 2020 206d 6f64 656c 7320 6172 6520       models are 
+00024e00: 6163 6365 7074 6564 2077 6865 6e20 706c  accepted when pl
+00024e10: 6f74 2074 7970 6520 6973 2027 7375 6d6d  ot type is 'summ
+00024e20: 6172 7927 2c20 2763 6f72 7265 6c61 7469  ary', 'correlati
+00024e30: 6f6e 272c 206f 720a 2020 2020 2020 2020  on', or.        
+00024e40: 2020 2020 2772 6561 736f 6e27 2e20 2770      'reason'. 'p
+00024e50: 6470 2720 706c 6f74 2069 7320 6d6f 6465  dp' plot is mode
+00024e60: 6c20 6167 6e6f 7374 6963 2e0a 0a20 2020  l agnostic...   
+00024e70: 2020 2020 2070 6c6f 7420 3a20 7374 722c       plot : str,
+00024e80: 2064 6566 6175 6c74 203d 2027 7375 6d6d   default = 'summ
+00024e90: 6172 7927 0a20 2020 2020 2020 2020 2020  ary'.           
+00024ea0: 2041 6262 7265 7669 6174 696f 6e20 6f66   Abbreviation of
+00024eb0: 2074 7970 6520 6f66 2070 6c6f 742e 2054   type of plot. T
+00024ec0: 6865 2063 7572 7265 6e74 206c 6973 7420  he current list 
+00024ed0: 6f66 2070 6c6f 7473 2073 7570 706f 7274  of plots support
+00024ee0: 6564 0a20 2020 2020 2020 2020 2020 2061  ed.            a
+00024ef0: 7265 2028 506c 6f74 202d 204e 616d 6529  re (Plot - Name)
+00024f00: 3a0a 2020 2020 2020 2020 2020 2020 2a20  :.            * 
+00024f10: 2773 756d 6d61 7279 2720 2d20 5375 6d6d  'summary' - Summ
+00024f20: 6172 7920 506c 6f74 2075 7369 6e67 2053  ary Plot using S
+00024f30: 4841 500a 2020 2020 2020 2020 2020 2020  HAP.            
+00024f40: 2a20 2763 6f72 7265 6c61 7469 6f6e 2720  * 'correlation' 
+00024f50: 2d20 4465 7065 6e64 656e 6365 2050 6c6f  - Dependence Plo
+00024f60: 7420 7573 696e 6720 5348 4150 0a20 2020  t using SHAP.   
+00024f70: 2020 2020 2020 2020 202a 2027 7265 6173           * 'reas
+00024f80: 6f6e 2720 2d20 466f 7263 6520 506c 6f74  on' - Force Plot
+00024f90: 2075 7369 6e67 2053 4841 500a 2020 2020   using SHAP.    
+00024fa0: 2020 2020 2020 2020 2a20 2770 6470 2720          * 'pdp' 
+00024fb0: 2d20 5061 7274 6961 6c20 4465 7065 6e64  - Partial Depend
+00024fc0: 656e 6365 2050 6c6f 740a 2020 2020 2020  ence Plot.      
+00024fd0: 2020 2020 2020 2a20 276d 7361 2720 2d20        * 'msa' - 
+00024fe0: 4d6f 7272 6973 2053 656e 7369 7469 7669  Morris Sensitivi
+00024ff0: 7479 2041 6e61 6c79 7369 730a 2020 2020  ty Analysis.    
+00025000: 2020 2020 2020 2020 2a20 2770 6669 2720          * 'pfi' 
+00025010: 2d20 5065 726d 7574 6174 696f 6e20 4665  - Permutation Fe
+00025020: 6174 7572 6520 496d 706f 7274 616e 6365  ature Importance
+00025030: 0a0a 2020 2020 2020 2020 6665 6174 7572  ..        featur
+00025040: 653a 2073 7472 2c20 6465 6661 756c 7420  e: str, default 
+00025050: 3d20 4e6f 6e65 0a20 2020 2020 2020 2020  = None.         
+00025060: 2020 2054 6869 7320 7061 7261 6d65 7465     This paramete
+00025070: 7220 6973 206f 6e6c 7920 6e65 6564 6564  r is only needed
+00025080: 2077 6865 6e20 706c 6f74 203d 2027 636f   when plot = 'co
+00025090: 7272 656c 6174 696f 6e27 206f 7220 2770  rrelation' or 'p
+000250a0: 6470 272e 0a20 2020 2020 2020 2020 2020  dp'..           
+000250b0: 2042 7920 6465 6661 756c 7420 6665 6174   By default feat
+000250c0: 7572 6520 6973 2073 6574 2074 6f20 4e6f  ure is set to No
+000250d0: 6e65 2077 6869 6368 206d 6561 6e73 2074  ne which means t
+000250e0: 6865 2066 6972 7374 2063 6f6c 756d 6e20  he first column 
+000250f0: 6f66 2074 6865 0a20 2020 2020 2020 2020  of the.         
+00025100: 2020 2064 6174 6173 6574 2077 696c 6c20     dataset will 
+00025110: 6265 2075 7365 6420 6173 2061 2076 6172  be used as a var
+00025120: 6961 626c 652e 2041 2066 6561 7475 7265  iable. A feature
+00025130: 2070 6172 616d 6574 6572 206d 7573 7420   parameter must 
+00025140: 6265 2070 6173 7365 640a 2020 2020 2020  be passed.      
+00025150: 2020 2020 2020 746f 2063 6861 6e67 6520        to change 
+00025160: 7468 6973 2e0a 0a20 2020 2020 2020 206f  this...        o
+00025170: 6273 6572 7661 7469 6f6e 3a20 696e 7465  bservation: inte
+00025180: 6765 722c 2064 6566 6175 6c74 203d 204e  ger, default = N
+00025190: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+000251a0: 5468 6973 2070 6172 616d 6574 6572 206f  This parameter o
+000251b0: 6e6c 7920 636f 6d65 7320 696e 746f 2065  nly comes into e
+000251c0: 6666 6563 7420 7768 656e 2070 6c6f 7420  ffect when plot 
+000251d0: 6973 2073 6574 2074 6f20 2772 6561 736f  is set to 'reaso
+000251e0: 6e27 2e20 4966 206e 6f0a 2020 2020 2020  n'. If no.      
+000251f0: 2020 2020 2020 6f62 7365 7276 6174 696f        observatio
+00025200: 6e20 6e75 6d62 6572 2069 7320 7072 6f76  n number is prov
+00025210: 6964 6564 2c20 6974 2077 696c 6c20 7265  ided, it will re
+00025220: 7475 726e 2061 6e20 616e 616c 7973 6973  turn an analysis
+00025230: 206f 6620 616c 6c20 6f62 7365 7276 6174   of all observat
+00025240: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
+00025250: 2077 6974 6820 7468 6520 6f70 7469 6f6e   with the option
+00025260: 2074 6f20 7365 6c65 6374 2074 6865 2066   to select the f
+00025270: 6561 7475 7265 206f 6e20 7820 616e 6420  eature on x and 
+00025280: 7920 6178 6573 2074 6872 6f75 6768 2064  y axes through d
+00025290: 726f 7020 646f 776e 0a20 2020 2020 2020  rop down.       
+000252a0: 2020 2020 2069 6e74 6572 6163 7469 7669       interactivi
+000252b0: 7479 2e20 466f 7220 616e 616c 7973 6973  ty. For analysis
+000252c0: 2061 7420 7468 6520 7361 6d70 6c65 206c   at the sample l
+000252d0: 6576 656c 2c20 616e 206f 6273 6572 7661  evel, an observa
+000252e0: 7469 6f6e 2070 6172 616d 6574 6572 206d  tion parameter m
+000252f0: 7573 740a 2020 2020 2020 2020 2020 2020  ust.            
+00025300: 6265 2070 6173 7365 6420 7769 7468 2074  be passed with t
+00025310: 6865 2069 6e64 6578 2076 616c 7565 206f  he index value o
+00025320: 6620 7468 6520 6f62 7365 7276 6174 696f  f the observatio
+00025330: 6e20 696e 2074 6573 7420 2f20 686f 6c64  n in test / hold
+00025340: 2d6f 7574 2073 6574 2e0a 0a20 2020 2020  -out set...     
+00025350: 2020 2075 7365 5f74 7261 696e 5f64 6174     use_train_dat
+00025360: 613a 2062 6f6f 6c2c 2064 6566 6175 6c74  a: bool, default
+00025370: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00025380: 2020 2020 2057 6865 6e20 7365 7420 746f       When set to
+00025390: 2074 7275 652c 2074 7261 696e 2064 6174   true, train dat
+000253a0: 6120 7769 6c6c 2062 6520 7573 6564 2066  a will be used f
+000253b0: 6f72 2070 6c6f 7473 2c20 696e 7374 6561  or plots, instea
+000253c0: 640a 2020 2020 2020 2020 2020 2020 6f66  d.            of
+000253d0: 2074 6573 7420 6461 7461 2e0a 0a20 2020   test data...   
+000253e0: 2020 2020 2058 5f6e 6577 5f73 616d 706c       X_new_sampl
+000253f0: 653a 2070 642e 4461 7461 4672 616d 652c  e: pd.DataFrame,
+00025400: 2064 6566 6175 6c74 203d 204e 6f6e 650a   default = None.
+00025410: 2020 2020 2020 2020 2020 2020 526f 7720              Row 
+00025420: 6672 6f6d 2061 6e20 6f75 742d 6f66 2d73  from an out-of-s
+00025430: 616d 706c 6520 6461 7461 6672 616d 6520  ample dataframe 
+00025440: 286e 6569 7468 6572 2074 7261 696e 206e  (neither train n
+00025450: 6f72 2074 6573 7420 6461 7461 2920 746f  or test data) to
+00025460: 2062 6520 706c 6f74 7465 642e 0a20 2020   be plotted..   
+00025470: 2020 2020 2020 2020 2054 6865 2073 616d           The sam
+00025480: 706c 6520 6d75 7374 2068 6176 6520 7468  ple must have th
+00025490: 6520 7361 6d65 2063 6f6c 756d 6e73 2061  e same columns a
+000254a0: 7320 7468 6520 7261 7720 696e 7075 7420  s the raw input 
+000254b0: 7472 6169 6e20 6461 7461 2c20 616e 6420  train data, and 
+000254c0: 6974 2069 7320 7472 616e 7366 6f72 6d65  it is transforme
+000254d0: 640a 2020 2020 2020 2020 2020 2020 6279  d.            by
+000254e0: 2074 6865 2070 7265 7072 6f63 6573 7369   the preprocessi
+000254f0: 6e67 2070 6970 656c 696e 6520 6175 746f  ng pipeline auto
+00025500: 6d61 7469 6361 6c6c 7920 6265 666f 7265  matically before
+00025510: 2070 6c6f 7474 696e 672e 0a0a 2020 2020   plotting...    
+00025520: 2020 2020 795f 6e65 775f 7361 6d70 6c65      y_new_sample
+00025530: 3a20 7064 2e44 6174 6146 7261 6d65 2c20  : pd.DataFrame, 
+00025540: 6465 6661 756c 7420 3d20 4e6f 6e65 0a20  default = None. 
+00025550: 2020 2020 2020 2020 2020 2052 6f77 2066             Row f
+00025560: 726f 6d20 616e 206f 7574 2d6f 662d 7361  rom an out-of-sa
+00025570: 6d70 6c65 2064 6174 6166 7261 6d65 2028  mple dataframe (
+00025580: 6e65 6974 6865 7220 7472 6169 6e20 6e6f  neither train no
+00025590: 7220 7465 7374 2064 6174 6129 2074 6f20  r test data) to 
+000255a0: 6265 2070 6c6f 7474 6564 2e0a 2020 2020  be plotted..    
+000255b0: 2020 2020 2020 2020 5468 6520 7361 6d70          The samp
+000255c0: 6c65 206d 7573 7420 6861 7665 2074 6865  le must have the
+000255d0: 2073 616d 6520 636f 6c75 6d6e 7320 6173   same columns as
+000255e0: 2074 6865 2072 6177 2069 6e70 7574 206c   the raw input l
+000255f0: 6162 656c 2064 6174 612c 2061 6e64 2069  abel data, and i
+00025600: 7420 6973 2074 7261 6e73 666f 726d 6564  t is transformed
+00025610: 0a20 2020 2020 2020 2020 2020 2062 7920  .            by 
+00025620: 7468 6520 7072 6570 726f 6365 7373 696e  the preprocessin
+00025630: 6720 7069 7065 6c69 6e65 2061 7574 6f6d  g pipeline autom
+00025640: 6174 6963 616c 6c79 2062 6566 6f72 6520  atically before 
+00025650: 706c 6f74 7469 6e67 2e0a 0a20 2020 2020  plotting...     
+00025660: 2020 2073 6176 653a 2073 7472 696e 6720     save: string 
+00025670: 6f72 2062 6f6f 6c2c 2064 6566 6175 6c74  or bool, default
+00025680: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00025690: 2020 2020 2057 6865 6e20 7365 7420 746f       When set to
+000256a0: 2054 7275 652c 2050 6c6f 7420 6973 2073   True, Plot is s
+000256b0: 6176 6564 2061 7320 6120 2770 6e67 2720  aved as a 'png' 
+000256c0: 6669 6c65 2069 6e20 6375 7272 656e 7420  file in current 
+000256d0: 776f 726b 696e 6720 6469 7265 6374 6f72  working director
+000256e0: 792e 0a20 2020 2020 2020 2020 2020 2057  y..            W
+000256f0: 6865 6e20 6120 7061 7468 2064 6573 7469  hen a path desti
+00025700: 6e61 7469 6f6e 2069 7320 6769 7665 6e2c  nation is given,
+00025710: 2050 6c6f 7420 6973 2073 6176 6564 2061   Plot is saved a
+00025720: 7320 6120 2770 6e67 2720 6669 6c65 2074  s a 'png' file t
+00025730: 6865 2067 6976 656e 2070 6174 6820 746f  he given path to
+00025740: 2074 6865 2064 6972 6563 746f 7279 206f   the directory o
+00025750: 6620 6368 6f69 6365 2e0a 0a20 2020 2020  f choice...     
+00025760: 2020 202a 2a6b 7761 7267 733a 0a20 2020     **kwargs:.   
+00025770: 2020 2020 2020 2020 2041 6464 6974 696f           Additio
+00025780: 6e61 6c20 6b65 7977 6f72 6420 6172 6775  nal keyword argu
+00025790: 6d65 6e74 7320 746f 2070 6173 7320 746f  ments to pass to
+000257a0: 2074 6865 2070 6c6f 742e 0a0a 2020 2020   the plot...    
+000257b0: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+000257c0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+000257d0: 2020 2020 5669 7375 616c 5f50 6c6f 740a      Visual_Plot.
+000257e0: 2020 2020 2020 2020 2020 2020 5265 7475              Retu
+000257f0: 726e 7320 7468 6520 7669 7375 616c 2070  rns the visual p
+00025800: 6c6f 742e 0a20 2020 2020 2020 2020 2020  lot..           
+00025810: 2052 6574 7572 6e73 2074 6865 2069 6e74   Returns the int
+00025820: 6572 6163 7469 7665 204a 5320 706c 6f74  eractive JS plot
+00025830: 2077 6865 6e20 706c 6f74 203d 2027 7265   when plot = 're
+00025840: 6173 6f6e 272e 0a0a 2020 2020 2020 2020  ason'...        
+00025850: 5761 726e 696e 6773 0a20 2020 2020 2020  Warnings.       
+00025860: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00025870: 2020 2d20 696e 7465 7270 7265 745f 6d6f    - interpret_mo
+00025880: 6465 6c20 646f 6573 6e27 7420 7375 7070  del doesn't supp
+00025890: 6f72 7420 6d75 6c74 6963 6c61 7373 2070  ort multiclass p
+000258a0: 726f 626c 656d 732e 0a0a 2020 2020 2020  roblems...      
+000258b0: 2020 2222 220a 0a20 2020 2020 2020 2066    """..        f
+000258c0: 756e 6374 696f 6e5f 7061 7261 6d73 5f73  unction_params_s
+000258d0: 7472 203d 2022 2c20 222e 6a6f 696e 285b  tr = ", ".join([
+000258e0: 6622 7b6b 7d3d 7b76 7d22 2066 6f72 206b  f"{k}={v}" for k
+000258f0: 2c20 7620 696e 206c 6f63 616c 7328 292e  , v in locals().
+00025900: 6974 656d 7328 295d 290a 0a20 2020 2020  items()])..     
+00025910: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
+00025920: 6e66 6f28 2249 6e69 7469 616c 697a 696e  nfo("Initializin
+00025930: 6720 696e 7465 7270 7265 745f 6d6f 6465  g interpret_mode
+00025940: 6c28 2922 290a 2020 2020 2020 2020 7365  l()").        se
+00025950: 6c66 2e6c 6f67 6765 722e 696e 666f 2866  lf.logger.info(f
+00025960: 2269 6e74 6572 7072 6574 5f6d 6f64 656c  "interpret_model
+00025970: 287b 6675 6e63 7469 6f6e 5f70 6172 616d  ({function_param
+00025980: 735f 7374 727d 2922 290a 0a20 2020 2020  s_str})")..     
+00025990: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
+000259a0: 6e66 6f28 2243 6865 636b 696e 6720 6578  nfo("Checking ex
+000259b0: 6365 7074 696f 6e73 2229 0a0a 2020 2020  ceptions")..    
+000259c0: 2020 2020 2320 6368 6563 6b69 6e67 2069      # checking i
+000259d0: 6620 7368 6170 2061 7661 696c 6162 6c65  f shap available
+000259e0: 0a20 2020 2020 2020 2069 6620 706c 6f74  .        if plot
+000259f0: 2069 6e20 5b22 7375 6d6d 6172 7922 2c20   in ["summary", 
+00025a00: 2263 6f72 7265 6c61 7469 6f6e 222c 2022  "correlation", "
+00025a10: 7265 6173 6f6e 225d 3a0a 2020 2020 2020  reason"]:.      
+00025a20: 2020 2020 2020 5f63 6865 636b 5f73 6f66        _check_sof
+00025a30: 745f 6465 7065 6e64 656e 6369 6573 2822  t_dependencies("
+00025a40: 7368 6170 222c 2065 7874 7261 3d22 616e  shap", extra="an
+00025a50: 616c 7973 6973 222c 2073 6576 6572 6974  alysis", severit
+00025a60: 793d 2265 7272 6f72 2229 0a20 2020 2020  y="error").     
+00025a70: 2020 2020 2020 2069 6d70 6f72 7420 7368         import sh
+00025a80: 6170 0a0a 2020 2020 2020 2020 2320 6368  ap..        # ch
+00025a90: 6563 6b69 6e67 2069 6620 7064 7062 6f78  ecking if pdpbox
+00025aa0: 2069 7320 6176 6169 6c61 626c 650a 2020   is available.  
+00025ab0: 2020 2020 2020 6966 2070 6c6f 7420 3d3d        if plot ==
+00025ac0: 2022 7064 7022 3a0a 2020 2020 2020 2020   "pdp":.        
+00025ad0: 2020 2020 5f63 6865 636b 5f73 6f66 745f      _check_soft_
+00025ae0: 6465 7065 6e64 656e 6369 6573 2822 696e  dependencies("in
+00025af0: 7465 7270 7265 7422 2c20 6578 7472 613d  terpret", extra=
+00025b00: 2261 6e61 6c79 7369 7322 2c20 7365 7665  "analysis", seve
+00025b10: 7269 7479 3d22 6572 726f 7222 290a 0a20  rity="error").. 
+00025b20: 2020 2020 2020 2023 2063 6865 636b 696e         # checkin
+00025b30: 6720 696e 7465 7270 7265 7420 6973 2061  g interpret is a
+00025b40: 7661 696c 6162 6c65 0a20 2020 2020 2020  vailable.       
+00025b50: 2069 6620 706c 6f74 203d 3d20 226d 7361   if plot == "msa
+00025b60: 223a 0a20 2020 2020 2020 2020 2020 205f  ":.            _
+00025b70: 6368 6563 6b5f 736f 6674 5f64 6570 656e  check_soft_depen
+00025b80: 6465 6e63 6965 7328 2269 6e74 6572 7072  dencies("interpr
+00025b90: 6574 222c 2065 7874 7261 3d22 616e 616c  et", extra="anal
+00025ba0: 7973 6973 222c 2073 6576 6572 6974 793d  ysis", severity=
+00025bb0: 2265 7272 6f72 2229 0a0a 2020 2020 2020  "error")..      
+00025bc0: 2020 2320 6368 6563 6b69 6e67 2069 6e74    # checking int
+00025bd0: 6572 7072 6574 2d63 6f6d 6d75 6e69 7479  erpret-community
+00025be0: 2069 7320 6176 6169 6c61 626c 650a 2020   is available.  
+00025bf0: 2020 2020 2020 6966 2070 6c6f 7420 3d3d        if plot ==
+00025c00: 2022 7066 6922 3a0a 2020 2020 2020 2020   "pfi":.        
+00025c10: 2020 2020 5f63 6865 636b 5f73 6f66 745f      _check_soft_
+00025c20: 6465 7065 6e64 656e 6369 6573 280a 2020  dependencies(.  
+00025c30: 2020 2020 2020 2020 2020 2020 2020 2269                "i
+00025c40: 6e74 6572 7072 6574 5f63 6f6d 6d75 6e69  nterpret_communi
+00025c50: 7479 222c 0a20 2020 2020 2020 2020 2020  ty",.           
+00025c60: 2020 2020 2065 7874 7261 3d4e 6f6e 652c       extra=None,
+00025c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025c80: 2073 6576 6572 6974 793d 2265 7272 6f72   severity="error
+00025c90: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00025ca0: 2020 2069 6e73 7461 6c6c 5f6e 616d 653d     install_name=
+00025cb0: 2269 6e74 6572 7072 6574 2d63 6f6d 6d75  "interpret-commu
+00025cc0: 6e69 7479 222c 0a20 2020 2020 2020 2020  nity",.         
+00025cd0: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
+00025ce0: 6765 7420 6573 7469 6d61 746f 7220 6672  get estimator fr
+00025cf0: 6f6d 206d 6574 6120 6573 7469 6d61 746f  om meta estimato
+00025d00: 720a 2020 2020 2020 2020 6573 7469 6d61  r.        estima
+00025d10: 746f 7220 3d20 6765 745f 6573 7469 6d61  tor = get_estima
+00025d20: 746f 725f 6672 6f6d 5f6d 6574 615f 6573  tor_from_meta_es
+00025d30: 7469 6d61 746f 7228 6573 7469 6d61 746f  timator(estimato
+00025d40: 7229 0a0a 2020 2020 2020 2020 2320 616c  r)..        # al
+00025d50: 6c6f 7765 6420 6d6f 6465 6c73 0a20 2020  lowed models.   
+00025d60: 2020 2020 206d 6f64 656c 5f69 6420 3d20       model_id = 
+00025d70: 7365 6c66 2e5f 6765 745f 6d6f 6465 6c5f  self._get_model_
+00025d80: 6964 2865 7374 696d 6174 6f72 290a 0a20  id(estimator).. 
+00025d90: 2020 2020 2020 2073 6861 705f 6d6f 6465         shap_mode
+00025da0: 6c73 203d 207b 6b3a 2076 2066 6f72 206b  ls = {k: v for k
+00025db0: 2c20 7620 696e 2073 656c 662e 5f61 6c6c  , v in self._all
+00025dc0: 5f6d 6f64 656c 735f 696e 7465 726e 616c  _models_internal
+00025dd0: 2e69 7465 6d73 2829 2069 6620 762e 7368  .items() if v.sh
+00025de0: 6170 7d0a 2020 2020 2020 2020 7368 6170  ap}.        shap
+00025df0: 5f6d 6f64 656c 735f 6964 7320 3d20 7365  _models_ids = se
+00025e00: 7428 7368 6170 5f6d 6f64 656c 732e 6b65  t(shap_models.ke
+00025e10: 7973 2829 290a 0a20 2020 2020 2020 2069  ys())..        i
+00025e20: 6620 706c 6f74 2069 6e20 5b22 7375 6d6d  f plot in ["summ
+00025e30: 6172 7922 2c20 2263 6f72 7265 6c61 7469  ary", "correlati
+00025e40: 6f6e 222c 2022 7265 6173 6f6e 225d 2061  on", "reason"] a
+00025e50: 6e64 2028 0a20 2020 2020 2020 2020 2020  nd (.           
+00025e60: 206d 6f64 656c 5f69 6420 6e6f 7420 696e   model_id not in
+00025e70: 2073 6861 705f 6d6f 6465 6c73 5f69 6473   shap_models_ids
+00025e80: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
+00025e90: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00025ea0: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
+00025eb0: 2020 2020 2020 2020 2066 2254 6869 7320           f"This 
+00025ec0: 6675 6e63 7469 6f6e 206f 6e6c 7920 7375  function only su
+00025ed0: 7070 6f72 7473 2074 7265 6520 6261 7365  pports tree base
+00025ee0: 6420 6d6f 6465 6c73 2066 6f72 2062 696e  d models for bin
+00025ef0: 6172 7920 636c 6173 7369 6669 6361 7469  ary classificati
+00025f00: 6f6e 3a20 7b27 2c20 272e 6a6f 696e 2873  on: {', '.join(s
+00025f10: 6861 705f 6d6f 6465 6c73 5f69 6473 297d  hap_models_ids)}
+00025f20: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
+00025f30: 0a0a 2020 2020 2020 2020 2320 706c 6f74  ..        # plot
+00025f40: 2074 7970 650a 2020 2020 2020 2020 616c   type.        al
+00025f50: 6c6f 7765 645f 7479 7065 7320 3d20 5b22  lowed_types = ["
+00025f60: 7375 6d6d 6172 7922 2c20 2263 6f72 7265  summary", "corre
+00025f70: 6c61 7469 6f6e 222c 2022 7265 6173 6f6e  lation", "reason
+00025f80: 222c 2022 7064 7022 2c20 226d 7361 222c  ", "pdp", "msa",
+00025f90: 2022 7066 6922 5d0a 2020 2020 2020 2020   "pfi"].        
+00025fa0: 6966 2070 6c6f 7420 6e6f 7420 696e 2061  if plot not in a
+00025fb0: 6c6c 6f77 6564 5f74 7970 6573 3a0a 2020  llowed_types:.  
+00025fc0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00025fd0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+00025fe0: 2020 2020 2020 2020 2020 2020 6622 7479              f"ty
+00025ff0: 7065 2070 6172 616d 6574 6572 206f 6e6c  pe parameter onl
+00026000: 7920 6163 6365 7074 7320 7b27 2c20 272e  y accepts {', '.
+00026010: 6a6f 696e 286c 6973 7428 616c 6c6f 7765  join(list(allowe
+00026020: 645f 7479 7065 7329 202b 2073 7472 284e  d_types) + str(N
+00026030: 6f6e 6529 297d 2e22 0a20 2020 2020 2020  one))}.".       
+00026040: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00026050: 6966 2058 5f6e 6577 5f73 616d 706c 6520  if X_new_sample 
+00026060: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
+00026070: 286f 6273 6572 7661 7469 6f6e 2069 7320  (observation is 
+00026080: 6e6f 7420 4e6f 6e65 206f 7220 7573 655f  not None or use_
+00026090: 7472 6169 6e5f 6461 7461 293a 0a20 2020  train_data):.   
+000260a0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+000260b0: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+000260c0: 2020 2020 2020 2020 2020 2022 5370 6563             "Spec
+000260d0: 6966 7969 6e67 2027 585f 6e65 775f 7361  ifying 'X_new_sa
+000260e0: 6d70 6c65 2720 616e 6420 2827 6f62 7365  mple' and ('obse
+000260f0: 7276 6174 696f 6e27 206f 7220 2775 7365  rvation' or 'use
+00026100: 5f74 7261 696e 5f64 6174 6127 2920 6973  _train_data') is
+00026110: 2061 6d62 6967 756f 7573 2e22 0a20 2020   ambiguous.".   
+00026120: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00026130: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00026140: 4572 726f 7220 4368 6563 6b69 6e67 2045  Error Checking E
+00026150: 6e64 7320 6865 7265 0a0a 2020 2020 2020  nds here..      
+00026160: 2020 2222 220a 0a20 2020 2020 2020 2023    """..        #
+00026170: 2053 746f 7269 6e67 2058 5f74 7261 696e   Storing X_train
+00026180: 2061 6e64 2079 5f74 7261 696e 2069 6e20   and y_train in 
+00026190: 6461 7461 5f58 2061 6e64 2064 6174 615f  data_X and data_
+000261a0: 7920 7061 7261 6d65 7465 720a 2020 2020  y parameter.    
+000261b0: 2020 2020 6966 2058 5f6e 6577 5f73 616d      if X_new_sam
+000261c0: 706c 6520 6973 206e 6f74 204e 6f6e 653a  ple is not None:
+000261d0: 0a20 2020 2020 2020 2020 2020 2074 6573  .            tes
+000261e0: 745f 5820 3d20 7365 6c66 2e70 6970 656c  t_X = self.pipel
+000261f0: 696e 652e 7472 616e 7366 6f72 6d28 585f  ine.transform(X_
+00026200: 6e65 775f 7361 6d70 6c65 290a 2020 2020  new_sample).    
+00026210: 2020 2020 2020 2020 6966 2070 6c6f 7420          if plot 
+00026220: 3d3d 2022 7066 6922 3a0a 2020 2020 2020  == "pfi":.      
+00026230: 2020 2020 2020 2020 2020 7465 7374 5f79            test_y
+00026240: 203d 2073 656c 662e 7069 7065 6c69 6e65   = self.pipeline
+00026250: 2e74 7261 6e73 666f 726d 2879 5f6e 6577  .transform(y_new
+00026260: 5f73 616d 706c 6529 2020 2320 6164 6420  _sample)  # add 
+00026270: 666f 7220 7066 6920 6578 706c 6169 6e65  for pfi explaine
+00026280: 720a 2020 2020 2020 2020 656c 7365 3a0a  r.        else:.
+00026290: 2020 2020 2020 2020 2020 2020 2320 5374              # St
+000262a0: 6f72 696e 6720 585f 7472 6169 6e20 616e  oring X_train an
+000262b0: 6420 795f 7472 6169 6e20 696e 2064 6174  d y_train in dat
+000262c0: 615f 5820 616e 6420 6461 7461 5f79 2070  a_X and data_y p
+000262d0: 6172 616d 6574 6572 0a20 2020 2020 2020  arameter.       
+000262e0: 2020 2020 2069 6620 7573 655f 7472 6169       if use_trai
+000262f0: 6e5f 6461 7461 3a0a 2020 2020 2020 2020  n_data:.        
+00026300: 2020 2020 2020 2020 7465 7374 5f58 203d          test_X =
+00026310: 2073 656c 662e 585f 7472 6169 6e5f 7472   self.X_train_tr
+00026320: 616e 7366 6f72 6d65 640a 2020 2020 2020  ansformed.      
+00026330: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00026340: 2020 2020 2020 2020 2020 2020 7465 7374              test
+00026350: 5f58 203d 2073 656c 662e 585f 7465 7374  _X = self.X_test
+00026360: 5f74 7261 6e73 666f 726d 6564 0a20 2020  _transformed.   
+00026370: 2020 2020 2020 2020 2069 6620 706c 6f74           if plot
+00026380: 203d 3d20 2270 6669 223a 0a20 2020 2020   == "pfi":.     
+00026390: 2020 2020 2020 2020 2020 2069 6620 7573             if us
+000263a0: 655f 7472 6169 6e5f 6461 7461 3a0a 2020  e_train_data:.  
+000263b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000263c0: 2020 7465 7374 5f79 203d 2073 656c 662e    test_y = self.
+000263d0: 795f 7472 6169 6e5f 7472 616e 7366 6f72  y_train_transfor
+000263e0: 6d65 640a 2020 2020 2020 2020 2020 2020  med.            
+000263f0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00026400: 2020 2020 2020 2020 2020 2020 2020 7465                te
+00026410: 7374 5f79 203d 2073 656c 662e 795f 7465  st_y = self.y_te
+00026420: 7374 5f74 7261 6e73 666f 726d 6564 0a0a  st_transformed..
+00026430: 2020 2020 2020 2020 6e70 2e72 616e 646f          np.rando
+00026440: 6d2e 7365 6564 2873 656c 662e 7365 6564  m.seed(self.seed
+00026450: 290a 0a20 2020 2020 2020 2023 2073 746f  )..        # sto
+00026460: 7269 6e67 2065 7374 696d 6174 6f72 2069  ring estimator i
+00026470: 6e20 6d6f 6465 6c20 7661 7269 6162 6c65  n model variable
+00026480: 0a20 2020 2020 2020 206d 6f64 656c 203d  .        model =
+00026490: 2065 7374 696d 6174 6f72 0a0a 2020 2020   estimator..    
+000264a0: 2020 2020 2320 6465 6669 6e69 6e67 2074      # defining t
+000264b0: 7970 6520 6f66 2063 6c61 7373 6966 6965  ype of classifie
+000264c0: 720a 2020 2020 2020 2020 7368 6170 5f6d  r.        shap_m
+000264d0: 6f64 656c 735f 7479 7065 3120 3d20 7b6b  odels_type1 = {k
+000264e0: 2066 6f72 206b 2c20 7620 696e 2073 6861   for k, v in sha
+000264f0: 705f 6d6f 6465 6c73 2e69 7465 6d73 2829  p_models.items()
+00026500: 2069 6620 762e 7368 6170 203d 3d20 2274   if v.shap == "t
+00026510: 7970 6531 227d 0a20 2020 2020 2020 2073  ype1"}.        s
+00026520: 6861 705f 6d6f 6465 6c73 5f74 7970 6532  hap_models_type2
+00026530: 203d 207b 6b20 666f 7220 6b2c 2076 2069   = {k for k, v i
+00026540: 6e20 7368 6170 5f6d 6f64 656c 732e 6974  n shap_models.it
+00026550: 656d 7328 2920 6966 2076 2e73 6861 7020  ems() if v.shap 
+00026560: 3d3d 2022 7479 7065 3222 7d0a 0a20 2020  == "type2"}..   
+00026570: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
+00026580: 2e69 6e66 6f28 6622 706c 6f74 2074 7970  .info(f"plot typ
+00026590: 653a 207b 706c 6f74 7d22 290a 0a20 2020  e: {plot}")..   
+000265a0: 2020 2020 2073 6861 705f 706c 6f74 203d       shap_plot =
+000265b0: 204e 6f6e 650a 0a20 2020 2020 2020 2064   None..        d
+000265c0: 6566 2073 756d 6d61 7279 2873 686f 773a  ef summary(show:
+000265d0: 2062 6f6f 6c20 3d20 5472 7565 293a 0a20   bool = True):. 
+000265e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000265f0: 6c6f 6767 6572 2e69 6e66 6f28 2243 7265  logger.info("Cre
+00026600: 6174 696e 6720 5472 6565 4578 706c 6169  ating TreeExplai
+00026610: 6e65 7222 290a 2020 2020 2020 2020 2020  ner").          
+00026620: 2020 6578 706c 6169 6e65 7220 3d20 7368    explainer = sh
+00026630: 6170 2e54 7265 6545 7870 6c61 696e 6572  ap.TreeExplainer
+00026640: 286d 6f64 656c 290a 2020 2020 2020 2020  (model).        
+00026650: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
+00026660: 696e 666f 2822 436f 6d70 696c 696e 6720  info("Compiling 
+00026670: 7368 6170 2076 616c 7565 7322 290a 2020  shap values").  
+00026680: 2020 2020 2020 2020 2020 7368 6170 5f76            shap_v
+00026690: 616c 7565 7320 3d20 6578 706c 6169 6e65  alues = explaine
+000266a0: 722e 7368 6170 5f76 616c 7565 7328 7465  r.shap_values(te
+000266b0: 7374 5f58 290a 2020 2020 2020 2020 2020  st_X).          
+000266c0: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+000266d0: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+000266e0: 6e28 7368 6170 5f76 616c 7565 7329 203d  n(shap_values) =
+000266f0: 3d20 320a 2020 2020 2020 2020 2020 2020  = 2.            
+00026700: 2020 2020 7368 6170 5f70 6c6f 7420 3d20      shap_plot = 
+00026710: 7368 6170 2e73 756d 6d61 7279 5f70 6c6f  shap.summary_plo
+00026720: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+00026730: 2020 2020 2020 2073 6861 705f 7661 6c75         shap_valu
+00026740: 6573 5b31 5d2c 2074 6573 745f 582c 2073  es[1], test_X, s
+00026750: 686f 773d 7368 6f77 2c20 2a2a 6b77 6172  how=show, **kwar
+00026760: 6773 0a20 2020 2020 2020 2020 2020 2020  gs.             
+00026770: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00026780: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
+00026790: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
+000267a0: 2020 2073 6861 705f 706c 6f74 203d 2073     shap_plot = s
+000267b0: 6861 702e 7375 6d6d 6172 795f 706c 6f74  hap.summary_plot
+000267c0: 2873 6861 705f 7661 6c75 6573 2c20 7465  (shap_values, te
+000267d0: 7374 5f58 2c20 7368 6f77 3d73 686f 772c  st_X, show=show,
+000267e0: 202a 2a6b 7761 7267 7329 0a20 2020 2020   **kwargs).     
+000267f0: 2020 2020 2020 2069 6620 7361 7665 3a0a         if save:.
+00026800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026810: 706c 6f74 5f66 696c 656e 616d 6520 3d20  plot_filename = 
+00026820: 6622 5348 4150 207b 706c 6f74 7d2e 706e  f"SHAP {plot}.pn
+00026830: 6722 0a20 2020 2020 2020 2020 2020 2020  g".             
+00026840: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+00026850: 616e 6365 2873 6176 652c 2062 6f6f 6c29  ance(save, bool)
+00026860: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00026870: 2020 2020 2020 706c 6f74 5f66 696c 656e        plot_filen
+00026880: 616d 6520 3d20 6f73 2e70 6174 682e 6a6f  ame = os.path.jo
+00026890: 696e 2873 6176 652c 2070 6c6f 745f 6669  in(save, plot_fi
+000268a0: 6c65 6e61 6d65 290a 2020 2020 2020 2020  lename).        
+000268b0: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+000268c0: 6765 722e 696e 666f 2866 2253 6176 696e  ger.info(f"Savin
+000268d0: 6720 277b 706c 6f74 5f66 696c 656e 616d  g '{plot_filenam
+000268e0: 657d 2722 290a 2020 2020 2020 2020 2020  e}'").          
+000268f0: 2020 2020 2020 706c 742e 7361 7665 6669        plt.savefi
+00026900: 6728 706c 6f74 5f66 696c 656e 616d 652c  g(plot_filename,
+00026910: 2062 626f 785f 696e 6368 6573 3d22 7469   bbox_inches="ti
+00026920: 6768 7422 290a 2020 2020 2020 2020 2020  ght").          
+00026930: 2020 2020 2020 706c 742e 636c 6f73 6528        plt.close(
+00026940: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00026950: 7475 726e 2073 6861 705f 706c 6f74 0a0a  turn shap_plot..
+00026960: 2020 2020 2020 2020 6465 6620 636f 7272          def corr
+00026970: 656c 6174 696f 6e28 7368 6f77 3a20 626f  elation(show: bo
+00026980: 6f6c 203d 2054 7275 6529 3a0a 2020 2020  ol = True):.    
+00026990: 2020 2020 2020 2020 6966 2066 6561 7475          if featu
+000269a0: 7265 2069 7320 4e6f 6e65 3a0a 2020 2020  re is None:.    
+000269b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000269c0: 2e6c 6f67 6765 722e 7761 726e 696e 6728  .logger.warning(
+000269d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000269e0: 2020 2020 2066 224e 6f20 6665 6174 7572       f"No featur
+000269f0: 6520 7061 7373 6564 2e20 4465 6661 756c  e passed. Defaul
+00026a00: 7420 7661 6c75 6520 6f66 2066 6561 7475  t value of featu
+00026a10: 7265 2075 7365 6420 666f 7220 636f 7272  re used for corr
+00026a20: 656c 6174 696f 6e20 706c 6f74 3a20 7b74  elation plot: {t
+00026a30: 6573 745f 582e 636f 6c75 6d6e 735b 305d  est_X.columns[0]
+00026a40: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
+00026a50: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00026a60: 2020 2020 2064 6570 656e 6465 6e63 6520       dependence 
+00026a70: 3d20 7465 7374 5f58 2e63 6f6c 756d 6e73  = test_X.columns
+00026a80: 5b30 5d0a 0a20 2020 2020 2020 2020 2020  [0]..           
+00026a90: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00026aa0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+00026ab0: 6572 2e77 6172 6e69 6e67 280a 2020 2020  er.warning(.    
+00026ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026ad0: 6622 6665 6174 7572 6520 7661 6c75 6520  f"feature value 
+00026ae0: 7061 7373 6564 2e20 4665 6174 7572 6520  passed. Feature 
+00026af0: 7573 6564 2066 6f72 2063 6f72 7265 6c61  used for correla
+00026b00: 7469 6f6e 2070 6c6f 743a 207b 6665 6174  tion plot: {feat
+00026b10: 7572 657d 220a 2020 2020 2020 2020 2020  ure}".          
+00026b20: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00026b30: 2020 2020 2020 2020 6465 7065 6e64 656e          dependen
+00026b40: 6365 203d 2066 6561 7475 7265 0a0a 2020  ce = feature..  
+00026b50: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+00026b60: 6f67 6765 722e 696e 666f 2822 4372 6561  ogger.info("Crea
+00026b70: 7469 6e67 2054 7265 6545 7870 6c61 696e  ting TreeExplain
+00026b80: 6572 2229 0a20 2020 2020 2020 2020 2020  er").           
+00026b90: 2065 7870 6c61 696e 6572 203d 2073 6861   explainer = sha
+00026ba0: 702e 5472 6565 4578 706c 6169 6e65 7228  p.TreeExplainer(
+00026bb0: 6d6f 6465 6c29 0a20 2020 2020 2020 2020  model).         
+00026bc0: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
+00026bd0: 6e66 6f28 2243 6f6d 7069 6c69 6e67 2073  nfo("Compiling s
+00026be0: 6861 7020 7661 6c75 6573 2229 0a20 2020  hap values").   
+00026bf0: 2020 2020 2020 2020 2073 6861 705f 7661           shap_va
+00026c00: 6c75 6573 203d 2065 7870 6c61 696e 6572  lues = explainer
+00026c10: 2e73 6861 705f 7661 6c75 6573 2874 6573  .shap_values(tes
+00026c20: 745f 5829 0a0a 2020 2020 2020 2020 2020  t_X)..          
+00026c30: 2020 6966 206d 6f64 656c 5f69 6420 696e    if model_id in
+00026c40: 2073 6861 705f 6d6f 6465 6c73 5f74 7970   shap_models_typ
+00026c50: 6531 3a0a 2020 2020 2020 2020 2020 2020  e1:.            
+00026c60: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
+00026c70: 696e 666f 2822 6d6f 6465 6c20 7479 7065  info("model type
+00026c80: 2064 6574 6563 7465 643a 2074 7970 6520   detected: type 
+00026c90: 3122 290a 2020 2020 2020 2020 2020 2020  1").            
+00026ca0: 2020 2020 7368 6170 2e64 6570 656e 6465      shap.depende
+00026cb0: 6e63 655f 706c 6f74 280a 2020 2020 2020  nce_plot(.      
+00026cc0: 2020 2020 2020 2020 2020 2020 2020 6465                de
+00026cd0: 7065 6e64 656e 6365 2c20 7368 6170 5f76  pendence, shap_v
+00026ce0: 616c 7565 735b 315d 2c20 7465 7374 5f58  alues[1], test_X
+00026cf0: 2c20 7368 6f77 3d73 686f 772c 202a 2a6b  , show=show, **k
+00026d00: 7761 7267 730a 2020 2020 2020 2020 2020  wargs.          
+00026d10: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00026d20: 2020 2020 656c 6966 206d 6f64 656c 5f69      elif model_i
+00026d30: 6420 696e 2073 6861 705f 6d6f 6465 6c73  d in shap_models
+00026d40: 5f74 7970 6532 3a0a 2020 2020 2020 2020  _type2:.        
+00026d50: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+00026d60: 6765 722e 696e 666f 2822 6d6f 6465 6c20  ger.info("model 
+00026d70: 7479 7065 2064 6574 6563 7465 643a 2074  type detected: t
+00026d80: 7970 6520 3222 290a 2020 2020 2020 2020  ype 2").        
+00026d90: 2020 2020 2020 2020 7368 6170 2e64 6570          shap.dep
+00026da0: 656e 6465 6e63 655f 706c 6f74 280a 2020  endence_plot(.  
+00026db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026dc0: 2020 6465 7065 6e64 656e 6365 2c20 7368    dependence, sh
+00026dd0: 6170 5f76 616c 7565 732c 2074 6573 745f  ap_values, test_
+00026de0: 582c 2073 686f 773d 7368 6f77 2c20 2a2a  X, show=show, **
+00026df0: 6b77 6172 6773 0a20 2020 2020 2020 2020  kwargs.         
+00026e00: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00026e10: 2020 2020 2069 6620 7361 7665 3a0a 2020       if save:.  
+00026e20: 2020 2020 2020 2020 2020 2020 2020 706c                pl
+00026e30: 6f74 5f66 696c 656e 616d 6520 3d20 6622  ot_filename = f"
+00026e40: 5348 4150 207b 706c 6f74 7d2e 706e 6722  SHAP {plot}.png"
+00026e50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026e60: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+00026e70: 6365 2873 6176 652c 2062 6f6f 6c29 3a0a  ce(save, bool):.
+00026e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026e90: 2020 2020 706c 6f74 5f66 696c 656e 616d      plot_filenam
+00026ea0: 6520 3d20 6f73 2e70 6174 682e 6a6f 696e  e = os.path.join
+00026eb0: 2873 6176 652c 2070 6c6f 745f 6669 6c65  (save, plot_file
+00026ec0: 6e61 6d65 290a 2020 2020 2020 2020 2020  name).          
+00026ed0: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
+00026ee0: 722e 696e 666f 2866 2253 6176 696e 6720  r.info(f"Saving 
+00026ef0: 277b 706c 6f74 5f66 696c 656e 616d 657d  '{plot_filename}
+00026f00: 2722 290a 2020 2020 2020 2020 2020 2020  '").            
+00026f10: 2020 2020 706c 742e 7361 7665 6669 6728      plt.savefig(
+00026f20: 706c 6f74 5f66 696c 656e 616d 652c 2062  plot_filename, b
+00026f30: 626f 785f 696e 6368 6573 3d22 7469 6768  box_inches="tigh
+00026f40: 7422 290a 2020 2020 2020 2020 2020 2020  t").            
+00026f50: 2020 2020 706c 742e 636c 6f73 6528 290a      plt.close().
+00026f60: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00026f70: 726e 204e 6f6e 650a 0a20 2020 2020 2020  rn None..       
+00026f80: 2064 6566 2072 6561 736f 6e28 7368 6f77   def reason(show
+00026f90: 3a20 626f 6f6c 203d 2054 7275 6529 3a0a  : bool = True):.
+00026fa0: 2020 2020 2020 2020 2020 2020 7368 6170              shap
+00026fb0: 5f70 6c6f 7420 3d20 4e6f 6e65 0a20 2020  _plot = None.   
+00026fc0: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
+00026fd0: 6c5f 6964 2069 6e20 7368 6170 5f6d 6f64  l_id in shap_mod
+00026fe0: 656c 735f 7479 7065 313a 0a20 2020 2020  els_type1:.     
+00026ff0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00027000: 6c6f 6767 6572 2e69 6e66 6f28 226d 6f64  logger.info("mod
+00027010: 656c 2074 7970 6520 6465 7465 6374 6564  el type detected
+00027020: 3a20 7479 7065 2031 2229 0a0a 2020 2020  : type 1")..    
+00027030: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00027040: 2e6c 6f67 6765 722e 696e 666f 2822 4372  .logger.info("Cr
+00027050: 6561 7469 6e67 2054 7265 6545 7870 6c61  eating TreeExpla
+00027060: 696e 6572 2229 0a20 2020 2020 2020 2020  iner").         
+00027070: 2020 2020 2020 2065 7870 6c61 696e 6572         explainer
+00027080: 203d 2073 6861 702e 5472 6565 4578 706c   = shap.TreeExpl
+00027090: 6169 6e65 7228 6d6f 6465 6c29 0a20 2020  ainer(model).   
+000270a0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000270b0: 662e 6c6f 6767 6572 2e69 6e66 6f28 2243  f.logger.info("C
+000270c0: 6f6d 7069 6c69 6e67 2073 6861 7020 7661  ompiling shap va
+000270d0: 6c75 6573 2229 0a0a 2020 2020 2020 2020  lues")..        
+000270e0: 2020 2020 2020 2020 6966 206f 6273 6572          if obser
+000270f0: 7661 7469 6f6e 2069 7320 4e6f 6e65 3a0a  vation is None:.
+00027100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027110: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
+00027120: 7761 726e 696e 6728 0a20 2020 2020 2020  warning(.       
+00027130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027140: 2022 4f62 7365 7276 6174 696f 6e20 7365   "Observation se
+00027150: 7420 746f 204e 6f6e 652e 204d 6f64 656c  t to None. Model
+00027160: 2061 676e 6f73 7469 6320 706c 6f74 2077   agnostic plot w
+00027170: 696c 6c20 6265 2072 656e 6465 7265 642e  ill be rendered.
+00027180: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00027190: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000271a0: 2020 2020 2020 2020 2020 2020 7368 6170              shap
+000271b0: 5f76 616c 7565 7320 3d20 6578 706c 6169  _values = explai
+000271c0: 6e65 722e 7368 6170 5f76 616c 7565 7328  ner.shap_values(
+000271d0: 7465 7374 5f58 290a 2020 2020 2020 2020  test_X).        
+000271e0: 2020 2020 2020 2020 2020 2020 7368 6170              shap
+000271f0: 2e69 6e69 746a 7328 290a 2020 2020 2020  .initjs().      
+00027200: 2020 2020 2020 2020 2020 2020 2020 7368                sh
+00027210: 6170 5f70 6c6f 7420 3d20 7368 6170 2e66  ap_plot = shap.f
+00027220: 6f72 6365 5f70 6c6f 7428 0a20 2020 2020  orce_plot(.     
+00027230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027240: 2020 2065 7870 6c61 696e 6572 2e65 7870     explainer.exp
+00027250: 6563 7465 645f 7661 6c75 655b 315d 2c20  ected_value[1], 
+00027260: 7368 6170 5f76 616c 7565 735b 315d 2c20  shap_values[1], 
+00027270: 7465 7374 5f58 2c20 2a2a 6b77 6172 6773  test_X, **kwargs
+00027280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027290: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+000272a0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000272b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000272c0: 2020 726f 775f 746f 5f73 686f 7720 3d20    row_to_show = 
+000272d0: 6f62 7365 7276 6174 696f 6e0a 2020 2020  observation.    
+000272e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000272f0: 6461 7461 5f66 6f72 5f70 7265 6469 6374  data_for_predict
+00027300: 696f 6e20 3d20 7465 7374 5f58 2e69 6c6f  ion = test_X.ilo
+00027310: 635b 726f 775f 746f 5f73 686f 775d 0a0a  c[row_to_show]..
+00027320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027330: 2020 2020 6966 206d 6f64 656c 5f69 6420      if model_id 
+00027340: 3d3d 2022 6c69 6768 7467 626d 223a 0a20  == "lightgbm":. 
+00027350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027360: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+00027370: 6572 2e69 6e66 6f28 226d 6f64 656c 2074  er.info("model t
+00027380: 7970 6520 6465 7465 6374 6564 3a20 4c47  ype detected: LG
+00027390: 424d 436c 6173 7369 6669 6572 2229 0a20  BMClassifier"). 
 000273a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000273b0: 2020 6461 7461 5f66 6f72 5f70 7265 6469    data_for_predi
-000273c0: 6374 696f 6e2c 0a20 2020 2020 2020 2020  ction,.         
-000273d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000273e0: 2020 2073 686f 773d 7368 6f77 2c0a 2020     show=show,.  
-000273f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027400: 2020 2020 2020 2020 2020 2a2a 6b77 6172            **kwar
-00027410: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
-00027420: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00027430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027440: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00027450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027460: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
-00027470: 6f28 226d 6f64 656c 2074 7970 6520 6465  o("model type de
-00027480: 7465 6374 6564 3a20 556e 6b6e 6f77 6e22  tected: Unknown"
-00027490: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-000274a0: 2020 2020 2020 2020 2020 2073 6861 705f             shap_
-000274b0: 7661 6c75 6573 203d 2065 7870 6c61 696e  values = explain
-000274c0: 6572 2e73 6861 705f 7661 6c75 6573 2864  er.shap_values(d
-000274d0: 6174 615f 666f 725f 7072 6564 6963 7469  ata_for_predicti
-000274e0: 6f6e 290a 2020 2020 2020 2020 2020 2020  on).            
-000274f0: 2020 2020 2020 2020 2020 2020 7368 6170              shap
-00027500: 2e69 6e69 746a 7328 290a 2020 2020 2020  .initjs().      
+000273b0: 2020 2020 2020 2073 6861 705f 7661 6c75         shap_valu
+000273c0: 6573 203d 2065 7870 6c61 696e 6572 2e73  es = explainer.s
+000273d0: 6861 705f 7661 6c75 6573 2874 6573 745f  hap_values(test_
+000273e0: 5829 0a20 2020 2020 2020 2020 2020 2020  X).             
+000273f0: 2020 2020 2020 2020 2020 2073 6861 702e             shap.
+00027400: 696e 6974 6a73 2829 0a20 2020 2020 2020  initjs().       
+00027410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027420: 2073 6861 705f 706c 6f74 203d 2073 6861   shap_plot = sha
+00027430: 702e 666f 7263 655f 706c 6f74 280a 2020  p.force_plot(.  
+00027440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027450: 2020 2020 2020 2020 2020 6578 706c 6169            explai
+00027460: 6e65 722e 6578 7065 6374 6564 5f76 616c  ner.expected_val
+00027470: 7565 5b31 5d2c 0a20 2020 2020 2020 2020  ue[1],.         
+00027480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027490: 2020 2073 6861 705f 7661 6c75 6573 5b30     shap_values[0
+000274a0: 5d5b 726f 775f 746f 5f73 686f 775d 2c0a  ][row_to_show],.
+000274b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000274c0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+000274d0: 5f66 6f72 5f70 7265 6469 6374 696f 6e2c  _for_prediction,
+000274e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000274f0: 2020 2020 2020 2020 2020 2020 2073 686f               sho
+00027500: 773d 7368 6f77 2c0a 2020 2020 2020 2020  w=show,.        
 00027510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027520: 2020 7368 6170 5f70 6c6f 7420 3d20 7368    shap_plot = sh
-00027530: 6170 2e66 6f72 6365 5f70 6c6f 7428 0a20  ap.force_plot(. 
-00027540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027550: 2020 2020 2020 2020 2020 2065 7870 6c61             expla
-00027560: 696e 6572 2e65 7870 6563 7465 645f 7661  iner.expected_va
-00027570: 6c75 655b 315d 2c0a 2020 2020 2020 2020  lue[1],.        
-00027580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027590: 2020 2020 7368 6170 5f76 616c 7565 735b      shap_values[
-000275a0: 315d 2c0a 2020 2020 2020 2020 2020 2020  1],.            
+00027520: 2020 2020 2a2a 6b77 6172 6773 2c0a 2020      **kwargs,.  
+00027530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027540: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00027550: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00027560: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00027570: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00027580: 6c6f 6767 6572 2e69 6e66 6f28 226d 6f64  logger.info("mod
+00027590: 656c 2074 7970 6520 6465 7465 6374 6564  el type detected
+000275a0: 3a20 556e 6b6e 6f77 6e22 290a 0a20 2020  : Unknown")..   
 000275b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000275c0: 6461 7461 5f66 6f72 5f70 7265 6469 6374  data_for_predict
-000275d0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-000275e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000275f0: 2073 686f 773d 7368 6f77 2c0a 2020 2020   show=show,.    
+000275c0: 2020 2020 2073 6861 705f 7661 6c75 6573       shap_values
+000275d0: 203d 2065 7870 6c61 696e 6572 2e73 6861   = explainer.sha
+000275e0: 705f 7661 6c75 6573 2864 6174 615f 666f  p_values(data_fo
+000275f0: 725f 7072 6564 6963 7469 6f6e 290a 2020  r_prediction).  
 00027600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027610: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
-00027620: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00027630: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00027640: 2020 2020 2020 2020 2065 6c69 6620 6d6f           elif mo
-00027650: 6465 6c5f 6964 2069 6e20 7368 6170 5f6d  del_id in shap_m
-00027660: 6f64 656c 735f 7479 7065 323a 0a20 2020  odels_type2:.   
-00027670: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00027680: 662e 6c6f 6767 6572 2e69 6e66 6f28 226d  f.logger.info("m
-00027690: 6f64 656c 2074 7970 6520 6465 7465 6374  odel type detect
-000276a0: 6564 3a20 7479 7065 2032 2229 0a0a 2020  ed: type 2")..  
-000276b0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000276c0: 6c66 2e6c 6f67 6765 722e 696e 666f 2822  lf.logger.info("
-000276d0: 4372 6561 7469 6e67 2054 7265 6545 7870  Creating TreeExp
-000276e0: 6c61 696e 6572 2229 0a20 2020 2020 2020  lainer").       
-000276f0: 2020 2020 2020 2020 2065 7870 6c61 696e           explain
-00027700: 6572 203d 2073 6861 702e 5472 6565 4578  er = shap.TreeEx
-00027710: 706c 6169 6e65 7228 6d6f 6465 6c29 0a20  plainer(model). 
-00027720: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00027730: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
-00027740: 2243 6f6d 7069 6c69 6e67 2073 6861 7020  "Compiling shap 
-00027750: 7661 6c75 6573 2229 0a20 2020 2020 2020  values").       
-00027760: 2020 2020 2020 2020 2073 6861 705f 7661           shap_va
-00027770: 6c75 6573 203d 2065 7870 6c61 696e 6572  lues = explainer
-00027780: 2e73 6861 705f 7661 6c75 6573 2874 6573  .shap_values(tes
-00027790: 745f 5829 0a20 2020 2020 2020 2020 2020  t_X).           
-000277a0: 2020 2020 2073 6861 702e 696e 6974 6a73       shap.initjs
-000277b0: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
-000277c0: 2020 2020 6966 206f 6273 6572 7661 7469      if observati
-000277d0: 6f6e 2069 7320 4e6f 6e65 3a0a 2020 2020  on is None:.    
-000277e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000277f0: 7365 6c66 2e6c 6f67 6765 722e 7761 726e  self.logger.warn
-00027800: 696e 6728 0a20 2020 2020 2020 2020 2020  ing(.           
-00027810: 2020 2020 2020 2020 2020 2020 2022 4f62               "Ob
-00027820: 7365 7276 6174 696f 6e20 7365 7420 746f  servation set to
-00027830: 204e 6f6e 652e 204d 6f64 656c 2061 676e   None. Model agn
-00027840: 6f73 7469 6320 706c 6f74 2077 696c 6c20  ostic plot will 
-00027850: 6265 2072 656e 6465 7265 642e 220a 2020  be rendered.".  
-00027860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027870: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-00027880: 2020 2020 2020 2020 2073 6861 705f 706c           shap_pl
-00027890: 6f74 203d 2073 6861 702e 666f 7263 655f  ot = shap.force_
-000278a0: 706c 6f74 280a 2020 2020 2020 2020 2020  plot(.          
-000278b0: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-000278c0: 706c 6169 6e65 722e 6578 7065 6374 6564  plainer.expected
-000278d0: 5f76 616c 7565 2c0a 2020 2020 2020 2020  _value,.        
-000278e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000278f0: 7368 6170 5f76 616c 7565 732c 0a20 2020  shap_values,.   
-00027900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027910: 2020 2020 2074 6573 745f 582c 0a20 2020       test_X,.   
+00027610: 2020 2020 2020 7368 6170 2e69 6e69 746a        shap.initj
+00027620: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+00027630: 2020 2020 2020 2020 2020 2020 7368 6170              shap
+00027640: 5f70 6c6f 7420 3d20 7368 6170 2e66 6f72  _plot = shap.for
+00027650: 6365 5f70 6c6f 7428 0a20 2020 2020 2020  ce_plot(.       
+00027660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027670: 2020 2020 2065 7870 6c61 696e 6572 2e65       explainer.e
+00027680: 7870 6563 7465 645f 7661 6c75 655b 315d  xpected_value[1]
+00027690: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000276a0: 2020 2020 2020 2020 2020 2020 2020 7368                sh
+000276b0: 6170 5f76 616c 7565 735b 315d 2c0a 2020  ap_values[1],.  
+000276c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000276d0: 2020 2020 2020 2020 2020 6461 7461 5f66            data_f
+000276e0: 6f72 5f70 7265 6469 6374 696f 6e2c 0a20  or_prediction,. 
+000276f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027700: 2020 2020 2020 2020 2020 2073 686f 773d             show=
+00027710: 7368 6f77 2c0a 2020 2020 2020 2020 2020  show,.          
+00027720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027730: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
+00027740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027750: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00027760: 2020 2065 6c69 6620 6d6f 6465 6c5f 6964     elif model_id
+00027770: 2069 6e20 7368 6170 5f6d 6f64 656c 735f   in shap_models_
+00027780: 7479 7065 323a 0a20 2020 2020 2020 2020  type2:.         
+00027790: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+000277a0: 6572 2e69 6e66 6f28 226d 6f64 656c 2074  er.info("model t
+000277b0: 7970 6520 6465 7465 6374 6564 3a20 7479  ype detected: ty
+000277c0: 7065 2032 2229 0a0a 2020 2020 2020 2020  pe 2")..        
+000277d0: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+000277e0: 6765 722e 696e 666f 2822 4372 6561 7469  ger.info("Creati
+000277f0: 6e67 2054 7265 6545 7870 6c61 696e 6572  ng TreeExplainer
+00027800: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00027810: 2020 2065 7870 6c61 696e 6572 203d 2073     explainer = s
+00027820: 6861 702e 5472 6565 4578 706c 6169 6e65  hap.TreeExplaine
+00027830: 7228 6d6f 6465 6c29 0a20 2020 2020 2020  r(model).       
+00027840: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
+00027850: 6767 6572 2e69 6e66 6f28 2243 6f6d 7069  gger.info("Compi
+00027860: 6c69 6e67 2073 6861 7020 7661 6c75 6573  ling shap values
+00027870: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00027880: 2020 2073 6861 705f 7661 6c75 6573 203d     shap_values =
+00027890: 2065 7870 6c61 696e 6572 2e73 6861 705f   explainer.shap_
+000278a0: 7661 6c75 6573 2874 6573 745f 5829 0a20  values(test_X). 
+000278b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000278c0: 6861 702e 696e 6974 6a73 2829 0a0a 2020  hap.initjs()..  
+000278d0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000278e0: 206f 6273 6572 7661 7469 6f6e 2069 7320   observation is 
+000278f0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00027900: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+00027910: 6f67 6765 722e 7761 726e 696e 6728 0a20  ogger.warning(. 
 00027920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027930: 2020 2020 2073 686f 773d 7368 6f77 2c0a       show=show,.
-00027940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027950: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
-00027960: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00027970: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00027980: 2020 2020 2020 2020 2065 6c73 653a 0a0a           else:..
+00027930: 2020 2020 2020 2022 4f62 7365 7276 6174         "Observat
+00027940: 696f 6e20 7365 7420 746f 204e 6f6e 652e  ion set to None.
+00027950: 204d 6f64 656c 2061 676e 6f73 7469 6320   Model agnostic 
+00027960: 706c 6f74 2077 696c 6c20 6265 2072 656e  plot will be ren
+00027970: 6465 7265 642e 220a 2020 2020 2020 2020  dered.".        
+00027980: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
 00027990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000279a0: 2020 2020 726f 775f 746f 5f73 686f 7720      row_to_show 
-000279b0: 3d20 6f62 7365 7276 6174 696f 6e0a 2020  = observation.  
+000279a0: 2020 2073 6861 705f 706c 6f74 203d 2073     shap_plot = s
+000279b0: 6861 702e 666f 7263 655f 706c 6f74 280a  hap.force_plot(.
 000279c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000279d0: 2020 6461 7461 5f66 6f72 5f70 7265 6469    data_for_predi
-000279e0: 6374 696f 6e20 3d20 7465 7374 5f58 2e69  ction = test_X.i
-000279f0: 6c6f 635b 726f 775f 746f 5f73 686f 775d  loc[row_to_show]
-00027a00: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00027a10: 2020 2020 2020 7368 6170 5f70 6c6f 7420        shap_plot 
-00027a20: 3d20 7368 6170 2e66 6f72 6365 5f70 6c6f  = shap.force_plo
-00027a30: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00027a40: 2020 2020 2020 2020 2020 2065 7870 6c61             expla
-00027a50: 696e 6572 2e65 7870 6563 7465 645f 7661  iner.expected_va
-00027a60: 6c75 652c 0a20 2020 2020 2020 2020 2020  lue,.           
-00027a70: 2020 2020 2020 2020 2020 2020 2073 6861               sha
-00027a80: 705f 7661 6c75 6573 5b72 6f77 5f74 6f5f  p_values[row_to_
-00027a90: 7368 6f77 2c20 3a5d 2c0a 2020 2020 2020  show, :],.      
-00027aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027ab0: 2020 7465 7374 5f58 2e69 6c6f 635b 726f    test_X.iloc[ro
-00027ac0: 775f 746f 5f73 686f 772c 203a 5d2c 0a20  w_to_show, :],. 
-00027ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027ae0: 2020 2020 2020 2073 686f 773d 7368 6f77         show=show
-00027af0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00027b00: 2020 2020 2020 2020 2020 2a2a 6b77 6172            **kwar
-00027b10: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
-00027b20: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00027b30: 2020 2020 2020 6966 2073 6176 653a 0a20        if save:. 
-00027b40: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00027b50: 6c6f 745f 6669 6c65 6e61 6d65 203d 2066  lot_filename = f
-00027b60: 2253 4841 5020 7b70 6c6f 747d 2e68 746d  "SHAP {plot}.htm
-00027b70: 6c22 0a20 2020 2020 2020 2020 2020 2020  l".             
-00027b80: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-00027b90: 616e 6365 2873 6176 652c 2062 6f6f 6c29  ance(save, bool)
-00027ba0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00027bb0: 2020 2020 2020 706c 6f74 5f66 696c 656e        plot_filen
-00027bc0: 616d 6520 3d20 6f73 2e70 6174 682e 6a6f  ame = os.path.jo
-00027bd0: 696e 2873 6176 652c 2070 6c6f 745f 6669  in(save, plot_fi
-00027be0: 6c65 6e61 6d65 290a 2020 2020 2020 2020  lename).        
-00027bf0: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-00027c00: 6765 722e 696e 666f 2866 2253 6176 696e  ger.info(f"Savin
-00027c10: 6720 277b 706c 6f74 5f66 696c 656e 616d  g '{plot_filenam
-00027c20: 657d 2722 290a 2020 2020 2020 2020 2020  e}'").          
-00027c30: 2020 2020 2020 7368 6170 2e73 6176 655f        shap.save_
-00027c40: 6874 6d6c 2870 6c6f 745f 6669 6c65 6e61  html(plot_filena
-00027c50: 6d65 2c20 7368 6170 5f70 6c6f 7429 0a20  me, shap_plot). 
-00027c60: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00027c70: 6e20 7368 6170 5f70 6c6f 740a 0a20 2020  n shap_plot..   
-00027c80: 2020 2020 2064 6566 2070 6470 2873 686f       def pdp(sho
-00027c90: 773a 2062 6f6f 6c20 3d20 5472 7565 293a  w: bool = True):
-00027ca0: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00027cb0: 6c66 2e6c 6f67 6765 722e 696e 666f 2822  lf.logger.info("
-00027cc0: 4368 6563 6b69 6e67 2066 6561 7475 7265  Checking feature
-00027cd0: 2070 6172 616d 6574 6572 2070 6173 7365   parameter passe
-00027ce0: 6422 290a 2020 2020 2020 2020 2020 2020  d").            
-00027cf0: 6966 2066 6561 7475 7265 2069 7320 4e6f  if feature is No
-00027d00: 6e65 3a0a 0a20 2020 2020 2020 2020 2020  ne:..           
-00027d10: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
-00027d20: 2e77 6172 6e69 6e67 280a 2020 2020 2020  .warning(.      
-00027d30: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-00027d40: 4e6f 2066 6561 7475 7265 2070 6173 7365  No feature passe
-00027d50: 642e 2044 6566 6175 6c74 2076 616c 7565  d. Default value
-00027d60: 206f 6620 6665 6174 7572 6520 7573 6564   of feature used
-00027d70: 2066 6f72 2070 6470 203a 207b 7465 7374   for pdp : {test
-00027d80: 5f58 2e63 6f6c 756d 6e73 5b30 5d7d 220a  _X.columns[0]}".
-00027d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027da0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00027db0: 2020 7064 705f 6665 6174 7572 6520 3d20    pdp_feature = 
-00027dc0: 7465 7374 5f58 2e63 6f6c 756d 6e73 5b30  test_X.columns[0
-00027dd0: 5d0a 0a20 2020 2020 2020 2020 2020 2065  ]..            e
-00027de0: 6c73 653a 0a0a 2020 2020 2020 2020 2020  lse:..          
-00027df0: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
-00027e00: 722e 7761 726e 696e 6728 0a20 2020 2020  r.warning(.     
-00027e10: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00027e20: 2266 6561 7475 7265 2076 616c 7565 2070  "feature value p
-00027e30: 6173 7365 642e 2046 6561 7475 7265 2075  assed. Feature u
-00027e40: 7365 6420 666f 7220 636f 7272 656c 6174  sed for correlat
-00027e50: 696f 6e20 706c 6f74 3a20 7b66 6561 7475  ion plot: {featu
-00027e60: 7265 7d22 0a20 2020 2020 2020 2020 2020  re}".           
-00027e70: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00027e80: 2020 2020 2020 2070 6470 5f66 6561 7475         pdp_featu
-00027e90: 7265 203d 2066 6561 7475 7265 0a0a 2020  re = feature..  
-00027ea0: 2020 2020 2020 2020 2020 6672 6f6d 2069            from i
-00027eb0: 6e74 6572 7072 6574 2e62 6c61 636b 626f  nterpret.blackbo
-00027ec0: 7820 696d 706f 7274 2050 6172 7469 616c  x import Partial
-00027ed0: 4465 7065 6e64 656e 6365 0a0a 2020 2020  Dependence..    
-00027ee0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-00027ef0: 2020 2020 2020 2020 2020 2020 2070 6470               pdp
-00027f00: 203d 2050 6172 7469 616c 4465 7065 6e64   = PartialDepend
-00027f10: 656e 6365 280a 2020 2020 2020 2020 2020  ence(.          
-00027f20: 2020 2020 2020 2020 2020 7072 6564 6963            predic
-00027f30: 745f 666e 3d6d 6f64 656c 2e70 7265 6469  t_fn=model.predi
-00027f40: 6374 5f70 726f 6261 2c20 6461 7461 3d74  ct_proba, data=t
-00027f50: 6573 745f 580a 2020 2020 2020 2020 2020  est_X.          
-00027f60: 2020 2020 2020 2920 2023 2063 6c61 7373        )  # class
-00027f70: 6966 6963 6174 696f 6e0a 2020 2020 2020  ification.      
-00027f80: 2020 2020 2020 6578 6365 7074 2041 7474        except Att
-00027f90: 7269 6275 7465 4572 726f 723a 0a20 2020  ributeError:.   
-00027fa0: 2020 2020 2020 2020 2020 2020 2070 6470               pdp
-00027fb0: 203d 2050 6172 7469 616c 4465 7065 6e64   = PartialDepend
-00027fc0: 656e 6365 280a 2020 2020 2020 2020 2020  ence(.          
-00027fd0: 2020 2020 2020 2020 2020 7072 6564 6963            predic
-00027fe0: 745f 666e 3d6d 6f64 656c 2e70 7265 6469  t_fn=model.predi
-00027ff0: 6374 2c20 6461 7461 3d74 6573 745f 580a  ct, data=test_X.
-00028000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028010: 2920 2023 2072 6567 7265 7373 696f 6e0a  )  # regression.
-00028020: 0a20 2020 2020 2020 2020 2020 2070 6470  .            pdp
-00028030: 5f67 6c6f 6261 6c20 3d20 7064 702e 6578  _global = pdp.ex
-00028040: 706c 6169 6e5f 676c 6f62 616c 2829 0a20  plain_global(). 
-00028050: 2020 2020 2020 2020 2020 2070 6470 5f70             pdp_p
-00028060: 6c6f 7420 3d20 7064 705f 676c 6f62 616c  lot = pdp_global
-00028070: 2e76 6973 7561 6c69 7a65 286c 6973 7428  .visualize(list(
-00028080: 7465 7374 5f58 2e63 6f6c 756d 6e73 292e  test_X.columns).
-00028090: 696e 6465 7828 7064 705f 6665 6174 7572  index(pdp_featur
-000280a0: 6529 290a 2020 2020 2020 2020 2020 2020  e)).            
-000280b0: 6966 2073 6176 653a 0a20 2020 2020 2020  if save:.       
-000280c0: 2020 2020 2020 2020 2069 6d70 6f72 7420           import 
-000280d0: 706c 6f74 6c79 2e69 6f20 6173 2070 696f  plotly.io as pio
-000280e0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000280f0: 2020 706c 6f74 5f66 696c 656e 616d 6520    plot_filename 
-00028100: 3d20 6622 5044 5020 7b70 6c6f 747d 2e68  = f"PDP {plot}.h
-00028110: 746d 6c22 0a20 2020 2020 2020 2020 2020  tml".           
-00028120: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-00028130: 7374 616e 6365 2873 6176 652c 2062 6f6f  stance(save, boo
-00028140: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
-00028150: 2020 2020 2020 2020 706c 6f74 5f66 696c          plot_fil
-00028160: 656e 616d 6520 3d20 6f73 2e70 6174 682e  ename = os.path.
-00028170: 6a6f 696e 2873 6176 652c 2070 6c6f 745f  join(save, plot_
-00028180: 6669 6c65 6e61 6d65 290a 2020 2020 2020  filename).      
-00028190: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-000281a0: 6f67 6765 722e 696e 666f 2866 2253 6176  ogger.info(f"Sav
-000281b0: 696e 6720 277b 706c 6f74 5f66 696c 656e  ing '{plot_filen
-000281c0: 616d 657d 2722 290a 2020 2020 2020 2020  ame}'").        
-000281d0: 2020 2020 2020 2020 7069 6f2e 7772 6974          pio.writ
-000281e0: 655f 6874 6d6c 2870 6470 5f70 6c6f 742c  e_html(pdp_plot,
-000281f0: 2070 6c6f 745f 6669 6c65 6e61 6d65 290a   plot_filename).
-00028200: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00028210: 726e 2070 6470 5f70 6c6f 740a 0a20 2020  rn pdp_plot..   
-00028220: 2020 2020 2064 6566 206d 7361 2873 686f       def msa(sho
-00028230: 773a 2062 6f6f 6c20 3d20 5472 7565 293a  w: bool = True):
-00028240: 0a20 2020 2020 2020 2020 2020 2066 726f  .            fro
-00028250: 6d20 696e 7465 7270 7265 742e 626c 6163  m interpret.blac
-00028260: 6b62 6f78 2069 6d70 6f72 7420 4d6f 7272  kbox import Morr
-00028270: 6973 5365 6e73 6974 6976 6974 790a 0a20  isSensitivity.. 
-00028280: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-00028290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000282a0: 6d73 6120 3d20 4d6f 7272 6973 5365 6e73  msa = MorrisSens
-000282b0: 6974 6976 6974 7928 0a20 2020 2020 2020  itivity(.       
-000282c0: 2020 2020 2020 2020 2020 2020 2070 7265               pre
-000282d0: 6469 6374 5f66 6e3d 6d6f 6465 6c2e 7072  dict_fn=model.pr
-000282e0: 6564 6963 745f 7072 6f62 612c 2064 6174  edict_proba, dat
-000282f0: 613d 7465 7374 5f58 0a20 2020 2020 2020  a=test_X.       
-00028300: 2020 2020 2020 2020 2029 2020 2320 636c           )  # cl
-00028310: 6173 7369 6669 6361 7469 6f6e 0a20 2020  assification.   
-00028320: 2020 2020 2020 2020 2065 7863 6570 7420           except 
-00028330: 4174 7472 6962 7574 6545 7272 6f72 3a0a  AttributeError:.
-00028340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028350: 6d73 6120 3d20 4d6f 7272 6973 5365 6e73  msa = MorrisSens
-00028360: 6974 6976 6974 7928 0a20 2020 2020 2020  itivity(.       
-00028370: 2020 2020 2020 2020 2020 2020 2070 7265               pre
-00028380: 6469 6374 5f66 6e3d 6d6f 6465 6c2e 7072  dict_fn=model.pr
-00028390: 6564 6963 742c 2064 6174 613d 7465 7374  edict, data=test
-000283a0: 5f58 0a20 2020 2020 2020 2020 2020 2020  _X.             
-000283b0: 2020 2029 2020 2320 7265 6772 6573 7369     )  # regressi
-000283c0: 6f6e 0a20 2020 2020 2020 2020 2020 206d  on.            m
-000283d0: 7361 5f67 6c6f 6261 6c20 3d20 6d73 612e  sa_global = msa.
-000283e0: 6578 706c 6169 6e5f 676c 6f62 616c 2829  explain_global()
-000283f0: 0a20 2020 2020 2020 2020 2020 206d 7361  .            msa
-00028400: 5f70 6c6f 7420 3d20 6d73 615f 676c 6f62  _plot = msa_glob
-00028410: 616c 2e76 6973 7561 6c69 7a65 2829 0a20  al.visualize(). 
-00028420: 2020 2020 2020 2020 2020 2069 6620 7361             if sa
-00028430: 7665 3a0a 2020 2020 2020 2020 2020 2020  ve:.            
-00028440: 2020 2020 696d 706f 7274 2070 6c6f 746c      import plotl
-00028450: 792e 696f 2061 7320 7069 6f0a 0a20 2020  y.io as pio..   
-00028460: 2020 2020 2020 2020 2020 2020 2070 6c6f               plo
-00028470: 745f 6669 6c65 6e61 6d65 203d 2066 224d  t_filename = f"M
-00028480: 5341 207b 706c 6f74 7d2e 6874 6d6c 220a  SA {plot}.html".
-00028490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000284a0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-000284b0: 6528 7361 7665 2c20 626f 6f6c 293a 0a20  e(save, bool):. 
-000284c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000284d0: 2020 2070 6c6f 745f 6669 6c65 6e61 6d65     plot_filename
-000284e0: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
-000284f0: 7361 7665 2c20 706c 6f74 5f66 696c 656e  save, plot_filen
-00028500: 616d 6529 0a20 2020 2020 2020 2020 2020  ame).           
-00028510: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
-00028520: 2e69 6e66 6f28 6622 5361 7669 6e67 2027  .info(f"Saving '
-00028530: 7b70 6c6f 745f 6669 6c65 6e61 6d65 7d27  {plot_filename}'
-00028540: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-00028550: 2020 2070 696f 2e77 7269 7465 5f68 746d     pio.write_htm
-00028560: 6c28 6d73 615f 706c 6f74 2c20 706c 6f74  l(msa_plot, plot
-00028570: 5f66 696c 656e 616d 6529 0a20 2020 2020  _filename).     
-00028580: 2020 2020 2020 2072 6574 7572 6e20 6d73         return ms
-00028590: 615f 706c 6f74 0a0a 2020 2020 2020 2020  a_plot..        
-000285a0: 6465 6620 7066 6928 7368 6f77 3a20 626f  def pfi(show: bo
-000285b0: 6f6c 203d 2054 7275 6529 3a0a 2020 2020  ol = True):.    
-000285c0: 2020 2020 2020 2020 6672 6f6d 2069 6e74          from int
-000285d0: 6572 7072 6574 2e65 7874 2e62 6c61 636b  erpret.ext.black
-000285e0: 626f 7820 696d 706f 7274 2050 4649 4578  box import PFIEx
-000285f0: 706c 6169 6e65 720a 0a20 2020 2020 2020  plainer..       
-00028600: 2020 2020 2070 6669 203d 2050 4649 4578       pfi = PFIEx
-00028610: 706c 6169 6e65 7228 6d6f 6465 6c29 0a20  plainer(model). 
-00028620: 2020 2020 2020 2020 2020 2070 6669 5f67             pfi_g
-00028630: 6c6f 6261 6c20 3d20 7066 692e 6578 706c  lobal = pfi.expl
-00028640: 6169 6e5f 676c 6f62 616c 2874 6573 745f  ain_global(test_
-00028650: 582c 2074 7275 655f 6c61 6265 6c73 3d74  X, true_labels=t
-00028660: 6573 745f 7929 0a20 2020 2020 2020 2020  est_y).         
-00028670: 2020 2070 6669 5f70 6c6f 7420 3d20 7066     pfi_plot = pf
-00028680: 695f 676c 6f62 616c 2e76 6973 7561 6c69  i_global.visuali
-00028690: 7a65 2829 0a20 2020 2020 2020 2020 2020  ze().           
-000286a0: 2069 6620 7361 7665 3a0a 2020 2020 2020   if save:.      
-000286b0: 2020 2020 2020 2020 2020 696d 706f 7274            import
-000286c0: 2070 6c6f 746c 792e 696f 2061 7320 7069   plotly.io as pi
-000286d0: 6f0a 0a20 2020 2020 2020 2020 2020 2020  o..             
-000286e0: 2020 2070 6c6f 745f 6669 6c65 6e61 6d65     plot_filename
-000286f0: 203d 2066 2250 4649 207b 706c 6f74 7d2e   = f"PFI {plot}.
-00028700: 6874 6d6c 220a 2020 2020 2020 2020 2020  html".          
-00028710: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-00028720: 6e73 7461 6e63 6528 7361 7665 2c20 626f  nstance(save, bo
-00028730: 6f6c 293a 0a20 2020 2020 2020 2020 2020  ol):.           
-00028740: 2020 2020 2020 2020 2070 6c6f 745f 6669           plot_fi
-00028750: 6c65 6e61 6d65 203d 206f 732e 7061 7468  lename = os.path
-00028760: 2e6a 6f69 6e28 7361 7665 2c20 706c 6f74  .join(save, plot
-00028770: 5f66 696c 656e 616d 6529 0a20 2020 2020  _filename).     
-00028780: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00028790: 6c6f 6767 6572 2e69 6e66 6f28 6622 5361  logger.info(f"Sa
-000287a0: 7669 6e67 2027 7b70 6c6f 745f 6669 6c65  ving '{plot_file
-000287b0: 6e61 6d65 7d27 2229 0a20 2020 2020 2020  name}'").       
-000287c0: 2020 2020 2020 2020 2070 696f 2e77 7269           pio.wri
-000287d0: 7465 5f68 746d 6c28 7066 695f 706c 6f74  te_html(pfi_plot
-000287e0: 2c20 706c 6f74 5f66 696c 656e 616d 6529  , plot_filename)
-000287f0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00028800: 7572 6e20 7066 695f 706c 6f74 0a0a 2020  urn pfi_plot..  
-00028810: 2020 2020 2020 7368 6170 5f70 6c6f 7420        shap_plot 
-00028820: 3d20 6c6f 6361 6c73 2829 5b70 6c6f 745d  = locals()[plot]
-00028830: 2873 686f 773d 6e6f 7420 7361 7665 290a  (show=not save).
-00028840: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
-00028850: 6767 6572 2e69 6e66 6f28 2256 6973 7561  gger.info("Visua
-00028860: 6c20 5265 6e64 6572 6564 2053 7563 6365  l Rendered Succe
-00028870: 7373 6675 6c6c 7922 290a 0a20 2020 2020  ssfully")..     
-00028880: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
-00028890: 6e66 6f28 0a20 2020 2020 2020 2020 2020  nfo(.           
-000288a0: 2022 696e 7465 7270 7265 745f 6d6f 6465   "interpret_mode
-000288b0: 6c28 2920 7375 6363 6573 7366 756c 6c79  l() successfully
-000288c0: 2063 6f6d 706c 6574 6564 2e2e 2e2e 2e2e   completed......
-000288d0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000288e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000288f0: 220a 2020 2020 2020 2020 290a 0a20 2020  ".        )..   
-00028900: 2020 2020 2067 632e 636f 6c6c 6563 7428       gc.collect(
-00028910: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00028920: 2073 6861 705f 706c 6f74 0a0a 2020 2020   shap_plot..    
-00028930: 6465 6620 6d6f 6465 6c73 280a 2020 2020  def models(.    
-00028940: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00028950: 2020 7479 7065 3a20 4f70 7469 6f6e 616c    type: Optional
-00028960: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-00028970: 2020 2020 2020 696e 7465 726e 616c 3a20        internal: 
-00028980: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
-00028990: 2020 2020 2020 7261 6973 655f 6572 726f        raise_erro
-000289a0: 7273 3a20 626f 6f6c 203d 2054 7275 652c  rs: bool = True,
-000289b0: 0a20 2020 2029 202d 3e20 7064 2e44 6174  .    ) -> pd.Dat
-000289c0: 6146 7261 6d65 3a0a 0a20 2020 2020 2020  aFrame:..       
-000289d0: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-000289e0: 7572 6e73 2074 6162 6c65 206f 6620 6d6f  urns table of mo
-000289f0: 6465 6c73 2061 7661 696c 6162 6c65 2069  dels available i
-00028a00: 6e20 6d6f 6465 6c20 6c69 6272 6172 792e  n model library.
-00028a10: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00028a20: 650a 2020 2020 2020 2020 2d2d 2d2d 2d2d  e.        ------
-00028a30: 2d0a 2020 2020 2020 2020 3e3e 3e20 5f61  -.        >>> _a
-00028a40: 6c6c 5f6d 6f64 656c 7320 3d20 6d6f 6465  ll_models = mode
-00028a50: 6c73 2829 0a0a 2020 2020 2020 2020 5468  ls()..        Th
-00028a60: 6973 2077 696c 6c20 7265 7475 726e 2070  is will return p
-00028a70: 616e 6461 7320 6461 7461 6672 616d 6520  andas dataframe 
-00028a80: 7769 7468 2061 6c6c 2061 7661 696c 6162  with all availab
-00028a90: 6c65 0a20 2020 2020 2020 206d 6f64 656c  le.        model
-00028aa0: 7320 616e 6420 7468 6569 7220 6d65 7461  s and their meta
-00028ab0: 6461 7461 2e0a 0a20 2020 2020 2020 2050  data...        P
-00028ac0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00028ad0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00028ae0: 2020 2020 2074 7970 6520 3a20 7374 722c       type : str,
-00028af0: 2064 6566 6175 6c74 203d 204e 6f6e 650a   default = None.
-00028b00: 2020 2020 2020 2020 2020 2020 2d20 6c69              - li
-00028b10: 6e65 6172 203a 2066 696c 7465 7273 2061  near : filters a
-00028b20: 6e64 206f 6e6c 7920 7265 7475 726e 206c  nd only return l
-00028b30: 696e 6561 7220 6d6f 6465 6c73 0a20 2020  inear models.   
-00028b40: 2020 2020 2020 2020 202d 2074 7265 6520           - tree 
-00028b50: 3a20 6669 6c74 6572 7320 616e 6420 6f6e  : filters and on
-00028b60: 6c79 2072 6574 7572 6e20 7472 6565 2062  ly return tree b
-00028b70: 6173 6564 206d 6f64 656c 730a 2020 2020  ased models.    
-00028b80: 2020 2020 2020 2020 2d20 656e 7365 6d62          - ensemb
-00028b90: 6c65 203a 2066 696c 7465 7273 2061 6e64  le : filters and
-00028ba0: 206f 6e6c 7920 7265 7475 726e 2065 6e73   only return ens
-00028bb0: 656d 626c 6520 6d6f 6465 6c73 0a0a 2020  emble models..  
-00028bc0: 2020 2020 2020 696e 7465 726e 616c 3a20        internal: 
-00028bd0: 626f 6f6c 2c20 6465 6661 756c 7420 3d20  bool, default = 
-00028be0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-00028bf0: 2020 4966 2054 7275 652c 2077 696c 6c20    If True, will 
-00028c00: 7265 7475 726e 2065 7874 7261 2063 6f6c  return extra col
-00028c10: 756d 6e73 2061 6e64 2072 6f77 7320 7573  umns and rows us
-00028c20: 6564 2069 6e74 6572 6e61 6c6c 792e 0a0a  ed internally...
-00028c30: 2020 2020 2020 2020 7261 6973 655f 6572          raise_er
-00028c40: 726f 7273 3a20 626f 6f6c 2c20 6465 6661  rors: bool, defa
-00028c50: 756c 7420 3d20 5472 7565 0a20 2020 2020  ult = True.     
-00028c60: 2020 2020 2020 2049 6620 4661 6c73 652c         If False,
-00028c70: 2077 696c 6c20 7375 7070 7265 7373 2061   will suppress a
-00028c80: 6c6c 2065 7863 6570 7469 6f6e 732c 2069  ll exceptions, i
-00028c90: 676e 6f72 696e 6720 6d6f 6465 6c73 0a20  gnoring models. 
-00028ca0: 2020 2020 2020 2020 2020 2074 6861 7420             that 
-00028cb0: 636f 756c 646e 2774 2062 6520 6372 6561  couldn't be crea
-00028cc0: 7465 642e 0a0a 2020 2020 2020 2020 5265  ted...        Re
-00028cd0: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
-00028ce0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7061  -----.        pa
-00028cf0: 6e64 6173 2e44 6174 6146 7261 6d65 0a0a  ndas.DataFrame..
-00028d00: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00028d10: 2020 2020 206d 6f64 656c 5f74 7970 6520       model_type 
-00028d20: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-00028d30: 226c 696e 6561 7222 3a20 5b0a 2020 2020  "linear": [.    
-00028d40: 2020 2020 2020 2020 2020 2020 226c 7222              "lr"
-00028d50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00028d60: 2020 2272 6964 6765 222c 0a20 2020 2020    "ridge",.     
-00028d70: 2020 2020 2020 2020 2020 2022 7376 6d22             "svm"
-00028d80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00028d90: 2020 226c 6173 736f 222c 0a20 2020 2020    "lasso",.     
-00028da0: 2020 2020 2020 2020 2020 2022 656e 222c             "en",
-00028db0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028dc0: 2022 6c61 7222 2c0a 2020 2020 2020 2020   "lar",.        
-00028dd0: 2020 2020 2020 2020 226c 6c61 7222 2c0a          "llar",.
-00028de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028df0: 226f 6d70 222c 0a20 2020 2020 2020 2020  "omp",.         
-00028e00: 2020 2020 2020 2022 6272 222c 0a20 2020         "br",.   
-00028e10: 2020 2020 2020 2020 2020 2020 2022 6172               "ar
-00028e20: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
-00028e30: 2020 2020 2270 6172 222c 0a20 2020 2020      "par",.     
-00028e40: 2020 2020 2020 2020 2020 2022 7261 6e73             "rans
-00028e50: 6163 222c 0a20 2020 2020 2020 2020 2020  ac",.           
-00028e60: 2020 2020 2022 7472 222c 0a20 2020 2020       "tr",.     
-00028e70: 2020 2020 2020 2020 2020 2022 6875 6265             "hube
-00028e80: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
-00028e90: 2020 2020 226b 7222 2c0a 2020 2020 2020      "kr",.      
-00028ea0: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-00028eb0: 2020 2020 2022 7472 6565 223a 205b 2264       "tree": ["d
-00028ec0: 7422 5d2c 0a20 2020 2020 2020 2020 2020  t"],.           
-00028ed0: 2022 656e 7365 6d62 6c65 223a 205b 0a20   "ensemble": [. 
-00028ee0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00028ef0: 7266 222c 0a20 2020 2020 2020 2020 2020  rf",.           
-00028f00: 2020 2020 2022 6574 222c 0a20 2020 2020       "et",.     
-00028f10: 2020 2020 2020 2020 2020 2022 6762 6322             "gbc"
-00028f20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00028f30: 2020 2267 6272 222c 0a20 2020 2020 2020    "gbr",.       
-00028f40: 2020 2020 2020 2020 2022 7867 626f 6f73           "xgboos
-00028f50: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
-00028f60: 2020 2020 226c 6967 6874 6762 6d22 2c0a      "lightgbm",.
-00028f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028f80: 2263 6174 626f 6f73 7422 2c0a 2020 2020  "catboost",.    
-00028f90: 2020 2020 2020 2020 2020 2020 2261 6461              "ada
-00028fa0: 222c 0a20 2020 2020 2020 2020 2020 205d  ",.            ]
-00028fb0: 2c0a 2020 2020 2020 2020 7d0a 0a20 2020  ,.        }..   
-00028fc0: 2020 2020 2064 6566 2066 696c 7465 725f       def filter_
-00028fd0: 6d6f 6465 6c5f 6466 5f62 795f 7479 7065  model_df_by_type
-00028fe0: 2864 6629 3a0a 2020 2020 2020 2020 2020  (df):.          
-00028ff0: 2020 6966 206e 6f74 2074 7970 653a 0a20    if not type:. 
-00029000: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00029010: 6574 7572 6e20 6466 0a20 2020 2020 2020  eturn df.       
-00029020: 2020 2020 2072 6574 7572 6e20 6466 5b64       return df[d
-00029030: 662e 696e 6465 782e 6973 696e 286d 6f64  f.index.isin(mod
-00029040: 656c 5f74 7970 655b 7479 7065 5d29 5d0a  el_type[type])].
-00029050: 0a20 2020 2020 2020 2023 2043 6865 636b  .        # Check
-00029060: 2069 6620 7479 7065 2069 7320 7661 6c69   if type is vali
-00029070: 640a 2020 2020 2020 2020 6966 2074 7970  d.        if typ
-00029080: 6520 6e6f 7420 696e 206c 6973 7428 6d6f  e not in list(mo
-00029090: 6465 6c5f 7479 7065 2920 2b20 5b4e 6f6e  del_type) + [Non
-000290a0: 655d 3a0a 2020 2020 2020 2020 2020 2020  e]:.            
-000290b0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-000290c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000290d0: 2020 6622 7479 7065 2070 6172 616d 6574    f"type paramet
-000290e0: 6572 206f 6e6c 7920 6163 6365 7074 7320  er only accepts 
-000290f0: 7b27 2c20 272e 6a6f 696e 286c 6973 7428  {', '.join(list(
-00029100: 6d6f 6465 6c5f 7479 7065 2920 2b20 7374  model_type) + st
-00029110: 7228 4e6f 6e65 2929 7d2e 220a 2020 2020  r(None))}.".    
-00029120: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00029130: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
-00029140: 6e66 6f28 6622 6770 755f 7061 7261 6d20  nfo(f"gpu_param 
-00029150: 7365 7420 746f 207b 7365 6c66 2e67 7075  set to {self.gpu
-00029160: 5f70 6172 616d 7d22 290a 0a20 2020 2020  _param}")..     
-00029170: 2020 205f 2c20 6d6f 6465 6c5f 636f 6e74     _, model_cont
-00029180: 6169 6e65 7273 203d 2073 656c 662e 5f67  ainers = self._g
-00029190: 6574 5f6d 6f64 656c 7328 7261 6973 655f  et_models(raise_
-000291a0: 6572 726f 7273 290a 0a20 2020 2020 2020  errors)..       
-000291b0: 2072 6f77 7320 3d20 5b0a 2020 2020 2020   rows = [.      
-000291c0: 2020 2020 2020 762e 6765 745f 6469 6374        v.get_dict
-000291d0: 2869 6e74 6572 6e61 6c29 0a20 2020 2020  (internal).     
-000291e0: 2020 2020 2020 2066 6f72 206b 2c20 7620         for k, v 
-000291f0: 696e 206d 6f64 656c 5f63 6f6e 7461 696e  in model_contain
-00029200: 6572 732e 6974 656d 7328 290a 2020 2020  ers.items().    
-00029210: 2020 2020 2020 2020 6966 2028 696e 7465          if (inte
-00029220: 726e 616c 206f 7220 6e6f 7420 762e 6973  rnal or not v.is
-00029230: 5f73 7065 6369 616c 290a 2020 2020 2020  _special).      
-00029240: 2020 5d0a 0a20 2020 2020 2020 2064 6620    ]..        df 
-00029250: 3d20 7064 2e44 6174 6146 7261 6d65 2872  = pd.DataFrame(r
-00029260: 6f77 7329 0a20 2020 2020 2020 2064 662e  ows).        df.
-00029270: 7365 745f 696e 6465 7828 2249 4422 2c20  set_index("ID", 
-00029280: 696e 706c 6163 653d 5472 7565 2c20 6472  inplace=True, dr
-00029290: 6f70 3d54 7275 6529 0a0a 2020 2020 2020  op=True)..      
-000292a0: 2020 7265 7475 726e 2066 696c 7465 725f    return filter_
-000292b0: 6d6f 6465 6c5f 6466 5f62 795f 7479 7065  model_df_by_type
-000292c0: 2864 6629 0a0a 2020 2020 6465 6620 6765  (df)..    def ge
-000292d0: 745f 6d65 7472 6963 7328 0a20 2020 2020  t_metrics(.     
-000292e0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-000292f0: 2072 6573 6574 3a20 626f 6f6c 203d 2046   reset: bool = F
-00029300: 616c 7365 2c0a 2020 2020 2020 2020 696e  alse,.        in
-00029310: 636c 7564 655f 6375 7374 6f6d 3a20 626f  clude_custom: bo
-00029320: 6f6c 203d 2054 7275 652c 0a20 2020 2020  ol = True,.     
-00029330: 2020 2072 6169 7365 5f65 7272 6f72 733a     raise_errors:
-00029340: 2062 6f6f 6c20 3d20 5472 7565 2c0a 2020   bool = True,.  
-00029350: 2020 2920 2d3e 2070 642e 4461 7461 4672    ) -> pd.DataFr
-00029360: 616d 653a 0a20 2020 2020 2020 2022 2222  ame:.        """
-00029370: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00029380: 2074 6162 6c65 206f 6620 6d65 7472 6963   table of metric
-00029390: 7320 6176 6169 6c61 626c 652e 0a0a 2020  s available...  
-000293a0: 2020 2020 2020 4578 616d 706c 650a 2020        Example.  
-000293b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-000293c0: 2020 2020 2020 3e3e 3e20 6d65 7472 6963        >>> metric
-000293d0: 7320 3d20 6765 745f 6d65 7472 6963 7328  s = get_metrics(
-000293e0: 290a 0a20 2020 2020 2020 2054 6869 7320  )..        This 
-000293f0: 7769 6c6c 2072 6574 7572 6e20 7061 6e64  will return pand
-00029400: 6173 2064 6174 6166 7261 6d65 2077 6974  as dataframe wit
-00029410: 6820 616c 6c20 6176 6169 6c61 626c 650a  h all available.
-00029420: 2020 2020 2020 2020 6d65 7472 6963 7320          metrics 
-00029430: 616e 6420 7468 6569 7220 6d65 7461 6461  and their metada
-00029440: 7461 2e0a 0a20 2020 2020 2020 2050 6172  ta...        Par
-00029450: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-00029460: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00029470: 2020 2072 6573 6574 3a20 626f 6f6c 2c20     reset: bool, 
-00029480: 6465 6661 756c 7420 3d20 4661 6c73 650a  default = False.
-00029490: 2020 2020 2020 2020 2020 2020 4966 2054              If T
-000294a0: 7275 652c 2077 696c 6c20 7265 7365 7420  rue, will reset 
-000294b0: 616c 6c20 6368 616e 6765 7320 6d61 6465  all changes made
-000294c0: 2075 7369 6e67 2061 6464 5f6d 6574 7269   using add_metri
-000294d0: 6328 2920 616e 6420 6765 745f 6d65 7472  c() and get_metr
-000294e0: 6963 2829 2e0a 2020 2020 2020 2020 696e  ic()..        in
-000294f0: 636c 7564 655f 6375 7374 6f6d 3a20 626f  clude_custom: bo
-00029500: 6f6c 2c20 6465 6661 756c 7420 3d20 5472  ol, default = Tr
-00029510: 7565 0a20 2020 2020 2020 2020 2020 2057  ue.            W
-00029520: 6865 7468 6572 2074 6f20 696e 636c 7564  hether to includ
-00029530: 6520 7573 6572 2061 6464 6564 2028 6375  e user added (cu
-00029540: 7374 6f6d 2920 6d65 7472 6963 7320 6f72  stom) metrics or
-00029550: 206e 6f74 2e0a 2020 2020 2020 2020 7261   not..        ra
-00029560: 6973 655f 6572 726f 7273 3a20 626f 6f6c  ise_errors: bool
-00029570: 2c20 6465 6661 756c 7420 3d20 5472 7565  , default = True
-00029580: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00029590: 4661 6c73 652c 2077 696c 6c20 7375 7070  False, will supp
-000295a0: 7265 7373 2061 6c6c 2065 7863 6570 7469  ress all excepti
-000295b0: 6f6e 732c 2069 676e 6f72 696e 6720 6d6f  ons, ignoring mo
-000295c0: 6465 6c73 0a20 2020 2020 2020 2020 2020  dels.           
-000295d0: 2074 6861 7420 636f 756c 646e 2774 2062   that couldn't b
-000295e0: 6520 6372 6561 7465 642e 0a0a 2020 2020  e created...    
-000295f0: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-00029600: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00029610: 2020 2020 7061 6e64 6173 2e44 6174 6146      pandas.DataF
-00029620: 7261 6d65 0a0a 2020 2020 2020 2020 2222  rame..        ""
-00029630: 220a 0a20 2020 2020 2020 2069 6620 7265  "..        if re
-00029640: 7365 7420 616e 6420 6e6f 7420 7365 6c66  set and not self
-00029650: 2e5f 7365 7475 705f 7261 6e3a 0a20 2020  ._setup_ran:.   
-00029660: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00029670: 616c 7565 4572 726f 7228 2273 6574 7570  alueError("setup
-00029680: 2829 206e 6565 6473 2074 6f20 6265 2072  () needs to be r
-00029690: 616e 2066 6972 7374 2e22 290a 0a20 2020  an first.")..   
-000296a0: 2020 2020 206e 702e 7261 6e64 6f6d 2e73       np.random.s
-000296b0: 6565 6428 7365 6c66 2e73 6565 6429 0a0a  eed(self.seed)..
-000296c0: 2020 2020 2020 2020 6966 2072 6573 6574          if reset
-000296d0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-000296e0: 6c66 2e5f 616c 6c5f 6d65 7472 6963 7320  lf._all_metrics 
-000296f0: 3d20 7365 6c66 2e5f 6765 745f 6d65 7472  = self._get_metr
-00029700: 6963 7328 7261 6973 655f 6572 726f 7273  ics(raise_errors
-00029710: 3d72 6169 7365 5f65 7272 6f72 7329 0a0a  =raise_errors)..
-00029720: 2020 2020 2020 2020 6d65 7472 6963 5f63          metric_c
-00029730: 6f6e 7461 696e 6572 7320 3d20 7365 6c66  ontainers = self
-00029740: 2e5f 616c 6c5f 6d65 7472 6963 730a 2020  ._all_metrics.  
-00029750: 2020 2020 2020 726f 7773 203d 205b 762e        rows = [v.
-00029760: 6765 745f 6469 6374 2829 2066 6f72 206b  get_dict() for k
-00029770: 2c20 7620 696e 206d 6574 7269 635f 636f  , v in metric_co
-00029780: 6e74 6169 6e65 7273 2e69 7465 6d73 2829  ntainers.items()
-00029790: 5d0a 0a20 2020 2020 2020 2064 6620 3d20  ]..        df = 
-000297a0: 7064 2e44 6174 6146 7261 6d65 2872 6f77  pd.DataFrame(row
-000297b0: 7329 0a20 2020 2020 2020 2064 662e 7365  s).        df.se
-000297c0: 745f 696e 6465 7828 2249 4422 2c20 696e  t_index("ID", in
-000297d0: 706c 6163 653d 5472 7565 2c20 6472 6f70  place=True, drop
-000297e0: 3d54 7275 6529 0a0a 2020 2020 2020 2020  =True)..        
-000297f0: 6966 206e 6f74 2069 6e63 6c75 6465 5f63  if not include_c
-00029800: 7573 746f 6d3a 0a20 2020 2020 2020 2020  ustom:.         
-00029810: 2020 2064 6620 3d20 6466 5b64 665b 2243     df = df[df["C
-00029820: 7573 746f 6d22 5d20 6973 2046 616c 7365  ustom"] is False
-00029830: 5d0a 0a20 2020 2020 2020 2072 6574 7572  ]..        retur
-00029840: 6e20 6466 0a0a 2020 2020 6465 6620 6164  n df..    def ad
-00029850: 645f 6d65 7472 6963 280a 2020 2020 2020  d_metric(.      
-00029860: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00029870: 6964 3a20 7374 722c 0a20 2020 2020 2020  id: str,.       
-00029880: 206e 616d 653a 2073 7472 2c0a 2020 2020   name: str,.    
-00029890: 2020 2020 7363 6f72 655f 6675 6e63 3a20      score_func: 
-000298a0: 7479 7065 2c0a 2020 2020 2020 2020 7461  type,.        ta
-000298b0: 7267 6574 3a20 7374 7220 3d20 2270 7265  rget: str = "pre
-000298c0: 6422 2c0a 2020 2020 2020 2020 6772 6561  d",.        grea
-000298d0: 7465 725f 6973 5f62 6574 7465 723a 2062  ter_is_better: b
-000298e0: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
-000298f0: 2020 2020 6d75 6c74 6963 6c61 7373 3a20      multiclass: 
-00029900: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
-00029910: 2020 2020 202a 2a6b 7761 7267 732c 0a20       **kwargs,. 
-00029920: 2020 2029 202d 3e20 7064 2e53 6572 6965     ) -> pd.Serie
-00029930: 733a 0a20 2020 2020 2020 2022 2222 0a20  s:.        """. 
-00029940: 2020 2020 2020 2041 6464 7320 6120 6375         Adds a cu
-00029950: 7374 6f6d 206d 6574 7269 6320 746f 2062  stom metric to b
-00029960: 6520 7573 6564 2069 6e20 616c 6c20 6675  e used in all fu
-00029970: 6e63 7469 6f6e 732e 0a0a 2020 2020 2020  nctions...      
-00029980: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00029990: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-000299a0: 2020 2020 2020 2020 6964 3a20 7374 720a          id: str.
-000299b0: 2020 2020 2020 2020 2020 2020 556e 6971              Uniq
-000299c0: 7565 2069 6420 666f 7220 7468 6520 6d65  ue id for the me
-000299d0: 7472 6963 2e0a 0a20 2020 2020 2020 206e  tric...        n
-000299e0: 616d 653a 2073 7472 0a20 2020 2020 2020  ame: str.       
-000299f0: 2020 2020 2044 6973 706c 6179 206e 616d       Display nam
-00029a00: 6520 6f66 2074 6865 206d 6574 7269 632e  e of the metric.
-00029a10: 0a0a 2020 2020 2020 2020 7363 6f72 655f  ..        score_
-00029a20: 6675 6e63 3a20 7479 7065 0a20 2020 2020  func: type.     
-00029a30: 2020 2020 2020 2053 636f 7265 2066 756e         Score fun
-00029a40: 6374 696f 6e20 286f 7220 6c6f 7373 2066  ction (or loss f
-00029a50: 756e 6374 696f 6e29 2077 6974 6820 7369  unction) with si
-00029a60: 676e 6174 7572 6520 7363 6f72 655f 6675  gnature score_fu
-00029a70: 6e63 2879 2c20 795f 7072 6564 2c20 2a2a  nc(y, y_pred, **
-00029a80: 6b77 6172 6773 292e 0a0a 2020 2020 2020  kwargs)...      
-00029a90: 2020 7461 7267 6574 3a20 7374 722c 2064    target: str, d
-00029aa0: 6566 6175 6c74 203d 2027 7072 6564 270a  efault = 'pred'.
-00029ab0: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00029ac0: 7461 7267 6574 206f 6620 7468 6520 7363  target of the sc
-00029ad0: 6f72 6520 6675 6e63 7469 6f6e 2e0a 2020  ore function..  
-00029ae0: 2020 2020 2020 2020 2020 2d20 2770 7265            - 'pre
-00029af0: 6427 2066 6f72 2074 6865 2070 7265 6469  d' for the predi
-00029b00: 6374 696f 6e20 7461 626c 650a 2020 2020  ction table.    
-00029b10: 2020 2020 2020 2020 2d20 2770 7265 645f          - 'pred_
-00029b20: 7072 6f62 6127 2066 6f72 2070 7265 645f  proba' for pred_
-00029b30: 7072 6f62 610a 2020 2020 2020 2020 2020  proba.          
-00029b40: 2020 2d20 2774 6872 6573 686f 6c64 2720    - 'threshold' 
-00029b50: 666f 7220 6465 6369 7369 6f6e 5f66 756e  for decision_fun
-00029b60: 6374 696f 6e20 6f72 2070 7265 6469 6374  ction or predict
-00029b70: 5f70 726f 6261 0a0a 2020 2020 2020 2020  _proba..        
-00029b80: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
-00029b90: 723a 2062 6f6f 6c2c 2064 6566 6175 6c74  r: bool, default
-00029ba0: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
-00029bb0: 2020 2020 5768 6574 6865 7220 7363 6f72      Whether scor
-00029bc0: 655f 6675 6e63 2069 7320 6120 7363 6f72  e_func is a scor
-00029bd0: 6520 6675 6e63 7469 6f6e 2028 6465 6661  e function (defa
-00029be0: 756c 7429 2c20 6d65 616e 696e 6720 6869  ult), meaning hi
-00029bf0: 6768 2069 7320 676f 6f64 2c0a 2020 2020  gh is good,.    
-00029c00: 2020 2020 2020 2020 6f72 2061 206c 6f73          or a los
-00029c10: 7320 6675 6e63 7469 6f6e 2c20 6d65 616e  s function, mean
-00029c20: 696e 6720 6c6f 7720 6973 2067 6f6f 642e  ing low is good.
-00029c30: 2049 6e20 7468 6520 6c61 7474 6572 2063   In the latter c
-00029c40: 6173 652c 2074 6865 0a20 2020 2020 2020  ase, the.       
-00029c50: 2020 2020 2073 636f 7265 7220 6f62 6a65       scorer obje
-00029c60: 6374 2077 696c 6c20 7369 676e 2d66 6c69  ct will sign-fli
-00029c70: 7020 7468 6520 6f75 7463 6f6d 6520 6f66  p the outcome of
-00029c80: 2074 6865 2073 636f 7265 5f66 756e 632e   the score_func.
-00029c90: 0a0a 2020 2020 2020 2020 6d75 6c74 6963  ..        multic
-00029ca0: 6c61 7373 3a20 626f 6f6c 2c20 6465 6661  lass: bool, defa
-00029cb0: 756c 7420 3d20 5472 7565 0a20 2020 2020  ult = True.     
-00029cc0: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
-00029cd0: 6865 206d 6574 7269 6320 7375 7070 6f72  he metric suppor
-00029ce0: 7473 206d 756c 7469 636c 6173 7320 7072  ts multiclass pr
-00029cf0: 6f62 6c65 6d73 2e0a 0a20 2020 2020 2020  oblems...       
-00029d00: 202a 2a6b 7761 7267 733a 0a20 2020 2020   **kwargs:.     
-00029d10: 2020 2020 2020 2041 7267 756d 656e 7473         Arguments
-00029d20: 2074 6f20 6265 2070 6173 7365 6420 746f   to be passed to
-00029d30: 2073 636f 7265 2066 756e 6374 696f 6e2e   score function.
-00029d40: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00029d50: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00029d60: 2d0a 2020 2020 2020 2020 7061 6e64 6173  -.        pandas
-00029d70: 2e53 6572 6965 730a 2020 2020 2020 2020  .Series.        
-00029d80: 2020 2020 5468 6520 6372 6561 7465 6420      The created 
-00029d90: 726f 7720 6173 2053 6572 6965 732e 0a0a  row as Series...
-00029da0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00029db0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-00029dc0: 2e5f 7365 7475 705f 7261 6e3a 0a20 2020  ._setup_ran:.   
-00029dd0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00029de0: 616c 7565 4572 726f 7228 2273 6574 7570  alueError("setup
-00029df0: 2829 206e 6565 6473 2074 6f20 6265 2072  () needs to be r
-00029e00: 616e 2066 6972 7374 2e22 290a 0a20 2020  an first.")..   
-00029e10: 2020 2020 2069 6620 6964 2069 6e20 7365       if id in se
-00029e20: 6c66 2e5f 616c 6c5f 6d65 7472 6963 733a  lf._all_metrics:
-00029e30: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00029e40: 7365 2056 616c 7565 4572 726f 7228 2269  se ValueError("i
-00029e50: 6420 616c 7265 6164 7920 7072 6573 656e  d already presen
-00029e60: 7420 696e 206d 6574 7269 6373 2064 6174  t in metrics dat
-00029e70: 6166 7261 6d65 2e22 290a 0a20 2020 2020  aframe.")..     
-00029e80: 2020 2069 6620 7365 6c66 2e5f 6d6c 5f75     if self._ml_u
-00029e90: 7365 6361 7365 203d 3d20 4d4c 5573 6563  secase == MLUsec
-00029ea0: 6173 652e 434c 4153 5349 4649 4341 5449  ase.CLASSIFICATI
-00029eb0: 4f4e 3a0a 2020 2020 2020 2020 2020 2020  ON:.            
-00029ec0: 6e65 775f 6d65 7472 6963 203d 2028 0a20  new_metric = (. 
-00029ed0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00029ee0: 7963 6172 6574 2e63 6f6e 7461 696e 6572  ycaret.container
-00029ef0: 732e 6d65 7472 6963 732e 636c 6173 7369  s.metrics.classi
-00029f00: 6669 6361 7469 6f6e 2e43 6c61 7373 6966  fication.Classif
-00029f10: 6963 6174 696f 6e4d 6574 7269 6343 6f6e  icationMetricCon
-00029f20: 7461 696e 6572 280a 2020 2020 2020 2020  tainer(.        
-00029f30: 2020 2020 2020 2020 2020 2020 6964 3d69              id=i
-00029f40: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
-00029f50: 2020 2020 2020 206e 616d 653d 6e61 6d65         name=name
-00029f60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00029f70: 2020 2020 2020 7363 6f72 655f 6675 6e63        score_func
-00029f80: 3d73 636f 7265 5f66 756e 632c 0a20 2020  =score_func,.   
-00029f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029fa0: 2074 6172 6765 743d 7461 7267 6574 2c0a   target=target,.
-00029fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029fc0: 2020 2020 6172 6773 3d6b 7761 7267 732c      args=kwargs,
-00029fd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029fe0: 2020 2020 2064 6973 706c 6179 5f6e 616d       display_nam
-00029ff0: 653d 6e61 6d65 2c0a 2020 2020 2020 2020  e=name,.        
-0002a000: 2020 2020 2020 2020 2020 2020 6772 6561              grea
-0002a010: 7465 725f 6973 5f62 6574 7465 723d 6772  ter_is_better=gr
-0002a020: 6561 7465 725f 6973 5f62 6574 7465 722c  eater_is_better,
-0002a030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a040: 2020 2020 2069 735f 6d75 6c74 6963 6c61       is_multicla
-0002a050: 7373 3d62 6f6f 6c28 6d75 6c74 6963 6c61  ss=bool(multicla
-0002a060: 7373 292c 0a20 2020 2020 2020 2020 2020  ss),.           
-0002a070: 2020 2020 2020 2020 2069 735f 6375 7374           is_cust
-0002a080: 6f6d 3d54 7275 652c 0a20 2020 2020 2020  om=True,.       
-0002a090: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0002a0a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0002a0b0: 2065 6c69 6620 7365 6c66 2e5f 6d6c 5f75   elif self._ml_u
-0002a0c0: 7365 6361 7365 203d 3d20 4d4c 5573 6563  secase == MLUsec
-0002a0d0: 6173 652e 5449 4d45 5f53 4552 4945 533a  ase.TIME_SERIES:
-0002a0e0: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
-0002a0f0: 5f6d 6574 7269 6320 3d20 280a 2020 2020  _metric = (.    
-0002a100: 2020 2020 2020 2020 2020 2020 7079 6361              pyca
-0002a110: 7265 742e 636f 6e74 6169 6e65 7273 2e6d  ret.containers.m
-0002a120: 6574 7269 6373 2e74 696d 655f 7365 7269  etrics.time_seri
-0002a130: 6573 2e54 696d 6553 6572 6965 734d 6574  es.TimeSeriesMet
-0002a140: 7269 6343 6f6e 7461 696e 6572 280a 2020  ricContainer(.  
-0002a150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a160: 2020 6964 3d69 642c 0a20 2020 2020 2020    id=id,.       
-0002a170: 2020 2020 2020 2020 2020 2020 206e 616d               nam
-0002a180: 653d 6e61 6d65 2c0a 2020 2020 2020 2020  e=name,.        
-0002a190: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
-0002a1a0: 655f 6675 6e63 3d73 636f 7265 5f66 756e  e_func=score_fun
-0002a1b0: 632c 0a20 2020 2020 2020 2020 2020 2020  c,.             
-0002a1c0: 2020 2020 2020 2061 7267 733d 6b77 6172         args=kwar
-0002a1d0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
-0002a1e0: 2020 2020 2020 2020 6469 7370 6c61 795f          display_
-0002a1f0: 6e61 6d65 3d6e 616d 652c 0a20 2020 2020  name=name,.     
-0002a200: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-0002a210: 7265 6174 6572 5f69 735f 6265 7474 6572  reater_is_better
-0002a220: 3d67 7265 6174 6572 5f69 735f 6265 7474  =greater_is_bett
-0002a230: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
-0002a240: 2020 2020 2020 2020 6973 5f63 7573 746f          is_custo
-0002a250: 6d3d 5472 7565 2c0a 2020 2020 2020 2020  m=True,.        
-0002a260: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002a270: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0002a280: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0002a290: 2020 6e65 775f 6d65 7472 6963 203d 2028    new_metric = (
+000279d0: 2020 2020 2020 2020 6578 706c 6169 6e65          explaine
+000279e0: 722e 6578 7065 6374 6564 5f76 616c 7565  r.expected_value
+000279f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00027a00: 2020 2020 2020 2020 2020 7368 6170 5f76            shap_v
+00027a10: 616c 7565 732c 0a20 2020 2020 2020 2020  alues,.         
+00027a20: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00027a30: 6573 745f 582c 0a20 2020 2020 2020 2020  est_X,.         
+00027a40: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00027a50: 686f 773d 7368 6f77 2c0a 2020 2020 2020  how=show,.      
+00027a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027a70: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
+00027a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027a90: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00027aa0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00027ab0: 2020 2020 2020 2020 2020 2020 2072 6f77               row
+00027ac0: 5f74 6f5f 7368 6f77 203d 206f 6273 6572  _to_show = obser
+00027ad0: 7661 7469 6f6e 0a20 2020 2020 2020 2020  vation.         
+00027ae0: 2020 2020 2020 2020 2020 2064 6174 615f             data_
+00027af0: 666f 725f 7072 6564 6963 7469 6f6e 203d  for_prediction =
+00027b00: 2074 6573 745f 582e 696c 6f63 5b72 6f77   test_X.iloc[row
+00027b10: 5f74 6f5f 7368 6f77 5d0a 0a20 2020 2020  _to_show]..     
+00027b20: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00027b30: 6861 705f 706c 6f74 203d 2073 6861 702e  hap_plot = shap.
+00027b40: 666f 7263 655f 706c 6f74 280a 2020 2020  force_plot(.    
+00027b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027b60: 2020 2020 6578 706c 6169 6e65 722e 6578      explainer.ex
+00027b70: 7065 6374 6564 5f76 616c 7565 2c0a 2020  pected_value,.  
+00027b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027b90: 2020 2020 2020 7368 6170 5f76 616c 7565        shap_value
+00027ba0: 735b 726f 775f 746f 5f73 686f 772c 203a  s[row_to_show, :
+00027bb0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00027bc0: 2020 2020 2020 2020 2020 2074 6573 745f             test_
+00027bd0: 582e 696c 6f63 5b72 6f77 5f74 6f5f 7368  X.iloc[row_to_sh
+00027be0: 6f77 2c20 3a5d 2c0a 2020 2020 2020 2020  ow, :],.        
+00027bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027c00: 7368 6f77 3d73 686f 772c 0a20 2020 2020  show=show,.     
+00027c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027c20: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
+00027c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027c40: 2029 0a20 2020 2020 2020 2020 2020 2069   ).            i
+00027c50: 6620 7361 7665 3a0a 2020 2020 2020 2020  f save:.        
+00027c60: 2020 2020 2020 2020 706c 6f74 5f66 696c          plot_fil
+00027c70: 656e 616d 6520 3d20 6622 5348 4150 207b  ename = f"SHAP {
+00027c80: 706c 6f74 7d2e 6874 6d6c 220a 2020 2020  plot}.html".    
+00027c90: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00027ca0: 6f74 2069 7369 6e73 7461 6e63 6528 7361  ot isinstance(sa
+00027cb0: 7665 2c20 626f 6f6c 293a 0a20 2020 2020  ve, bool):.     
+00027cc0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00027cd0: 6c6f 745f 6669 6c65 6e61 6d65 203d 206f  lot_filename = o
+00027ce0: 732e 7061 7468 2e6a 6f69 6e28 7361 7665  s.path.join(save
+00027cf0: 2c20 706c 6f74 5f66 696c 656e 616d 6529  , plot_filename)
+00027d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027d10: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
+00027d20: 6f28 6622 5361 7669 6e67 2027 7b70 6c6f  o(f"Saving '{plo
+00027d30: 745f 6669 6c65 6e61 6d65 7d27 2229 0a20  t_filename}'"). 
+00027d40: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00027d50: 6861 702e 7361 7665 5f68 746d 6c28 706c  hap.save_html(pl
+00027d60: 6f74 5f66 696c 656e 616d 652c 2073 6861  ot_filename, sha
+00027d70: 705f 706c 6f74 290a 2020 2020 2020 2020  p_plot).        
+00027d80: 2020 2020 7265 7475 726e 2073 6861 705f      return shap_
+00027d90: 706c 6f74 0a0a 2020 2020 2020 2020 6465  plot..        de
+00027da0: 6620 7064 7028 7368 6f77 3a20 626f 6f6c  f pdp(show: bool
+00027db0: 203d 2054 7275 6529 3a0a 2020 2020 2020   = True):.      
+00027dc0: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
+00027dd0: 722e 696e 666f 2822 4368 6563 6b69 6e67  r.info("Checking
+00027de0: 2066 6561 7475 7265 2070 6172 616d 6574   feature paramet
+00027df0: 6572 2070 6173 7365 6422 290a 2020 2020  er passed").    
+00027e00: 2020 2020 2020 2020 6966 2066 6561 7475          if featu
+00027e10: 7265 2069 7320 4e6f 6e65 3a0a 2020 2020  re is None:.    
+00027e20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00027e30: 2e6c 6f67 6765 722e 7761 726e 696e 6728  .logger.warning(
+00027e40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027e50: 2020 2020 2066 224e 6f20 6665 6174 7572       f"No featur
+00027e60: 6520 7061 7373 6564 2e20 4465 6661 756c  e passed. Defaul
+00027e70: 7420 7661 6c75 6520 6f66 2066 6561 7475  t value of featu
+00027e80: 7265 2075 7365 6420 666f 7220 7064 7020  re used for pdp 
+00027e90: 3a20 7b74 6573 745f 582e 636f 6c75 6d6e  : {test_X.column
+00027ea0: 735b 305d 7d22 0a20 2020 2020 2020 2020  s[0]}".         
+00027eb0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00027ec0: 2020 2020 2020 2020 2070 6470 5f66 6561           pdp_fea
+00027ed0: 7475 7265 203d 2074 6573 745f 582e 636f  ture = test_X.co
+00027ee0: 6c75 6d6e 735b 305d 0a0a 2020 2020 2020  lumns[0]..      
+00027ef0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00027f00: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00027f10: 2e6c 6f67 6765 722e 7761 726e 696e 6728  .logger.warning(
+00027f20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027f30: 2020 2020 2066 2266 6561 7475 7265 2076       f"feature v
+00027f40: 616c 7565 2070 6173 7365 642e 2046 6561  alue passed. Fea
+00027f50: 7475 7265 2075 7365 6420 666f 7220 636f  ture used for co
+00027f60: 7272 656c 6174 696f 6e20 706c 6f74 3a20  rrelation plot: 
+00027f70: 7b66 6561 7475 7265 7d22 0a20 2020 2020  {feature}".     
+00027f80: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00027f90: 2020 2020 2020 2020 2020 2020 2070 6470               pdp
+00027fa0: 5f66 6561 7475 7265 203d 2066 6561 7475  _feature = featu
+00027fb0: 7265 0a0a 2020 2020 2020 2020 2020 2020  re..            
+00027fc0: 6672 6f6d 2069 6e74 6572 7072 6574 2e62  from interpret.b
+00027fd0: 6c61 636b 626f 7820 696d 706f 7274 2050  lackbox import P
+00027fe0: 6172 7469 616c 4465 7065 6e64 656e 6365  artialDependence
+00027ff0: 0a0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
+00028000: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00028010: 2020 2023 2069 6e74 6572 7072 6574 3e3d     # interpret>=
+00028020: 302e 332e 310a 2020 2020 2020 2020 2020  0.3.1.          
+00028030: 2020 2020 2020 7064 7020 3d20 5061 7274        pdp = Part
+00028040: 6961 6c44 6570 656e 6465 6e63 6528 0a20  ialDependence(. 
+00028050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028060: 2020 206d 6f64 656c 3d6d 6f64 656c 2c0a     model=model,.
+00028070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028080: 2020 2020 6461 7461 3d74 6573 745f 582e      data=test_X.
+00028090: 746f 5f6e 756d 7079 2829 2c0a 2020 2020  to_numpy(),.    
+000280a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000280b0: 6665 6174 7572 655f 6e61 6d65 733d 6c69  feature_names=li
+000280c0: 7374 2874 6573 745f 582e 636f 6c75 6d6e  st(test_X.column
+000280d0: 7329 2c0a 2020 2020 2020 2020 2020 2020  s),.            
+000280e0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000280f0: 2020 6578 6365 7074 2054 7970 6545 7272    except TypeErr
+00028100: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+00028110: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00028120: 2020 2020 2020 2020 2020 2020 2070 6470               pdp
+00028130: 203d 2050 6172 7469 616c 4465 7065 6e64   = PartialDepend
+00028140: 656e 6365 280a 2020 2020 2020 2020 2020  ence(.          
+00028150: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00028160: 6564 6963 745f 666e 3d6d 6f64 656c 2e70  edict_fn=model.p
+00028170: 7265 6469 6374 5f70 726f 6261 2c20 6461  redict_proba, da
+00028180: 7461 3d74 6573 745f 580a 2020 2020 2020  ta=test_X.      
+00028190: 2020 2020 2020 2020 2020 2020 2020 2920                ) 
+000281a0: 2023 2063 6c61 7373 6966 6963 6174 696f   # classificatio
+000281b0: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
+000281c0: 2020 6578 6365 7074 2041 7474 7269 6275    except Attribu
+000281d0: 7465 4572 726f 723a 0a20 2020 2020 2020  teError:.       
+000281e0: 2020 2020 2020 2020 2020 2020 2070 6470               pdp
+000281f0: 203d 2050 6172 7469 616c 4465 7065 6e64   = PartialDepend
+00028200: 656e 6365 280a 2020 2020 2020 2020 2020  ence(.          
+00028210: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00028220: 6564 6963 745f 666e 3d6d 6f64 656c 2e70  edict_fn=model.p
+00028230: 7265 6469 6374 2c20 6461 7461 3d74 6573  redict, data=tes
+00028240: 745f 580a 2020 2020 2020 2020 2020 2020  t_X.            
+00028250: 2020 2020 2020 2020 2920 2023 2072 6567          )  # reg
+00028260: 7265 7373 696f 6e0a 0a20 2020 2020 2020  ression..       
+00028270: 2020 2020 2070 6470 5f67 6c6f 6261 6c20       pdp_global 
+00028280: 3d20 7064 702e 6578 706c 6169 6e5f 676c  = pdp.explain_gl
+00028290: 6f62 616c 2829 0a20 2020 2020 2020 2020  obal().         
+000282a0: 2020 2070 6470 5f70 6c6f 7420 3d20 7064     pdp_plot = pd
+000282b0: 705f 676c 6f62 616c 2e76 6973 7561 6c69  p_global.visuali
+000282c0: 7a65 286c 6973 7428 7465 7374 5f58 2e63  ze(list(test_X.c
+000282d0: 6f6c 756d 6e73 292e 696e 6465 7828 7064  olumns).index(pd
+000282e0: 705f 6665 6174 7572 6529 290a 2020 2020  p_feature)).    
+000282f0: 2020 2020 2020 2020 6966 2073 6176 653a          if save:
+00028300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028310: 2069 6d70 6f72 7420 706c 6f74 6c79 2e69   import plotly.i
+00028320: 6f20 6173 2070 696f 0a0a 2020 2020 2020  o as pio..      
+00028330: 2020 2020 2020 2020 2020 706c 6f74 5f66            plot_f
+00028340: 696c 656e 616d 6520 3d20 6622 5044 5020  ilename = f"PDP 
+00028350: 7b70 6c6f 747d 2e68 746d 6c22 0a20 2020  {plot}.html".   
+00028360: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00028370: 6e6f 7420 6973 696e 7374 616e 6365 2873  not isinstance(s
+00028380: 6176 652c 2062 6f6f 6c29 3a0a 2020 2020  ave, bool):.    
+00028390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000283a0: 706c 6f74 5f66 696c 656e 616d 6520 3d20  plot_filename = 
+000283b0: 6f73 2e70 6174 682e 6a6f 696e 2873 6176  os.path.join(sav
+000283c0: 652c 2070 6c6f 745f 6669 6c65 6e61 6d65  e, plot_filename
+000283d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000283e0: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
+000283f0: 666f 2866 2253 6176 696e 6720 277b 706c  fo(f"Saving '{pl
+00028400: 6f74 5f66 696c 656e 616d 657d 2722 290a  ot_filename}'").
+00028410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028420: 7069 6f2e 7772 6974 655f 6874 6d6c 2870  pio.write_html(p
+00028430: 6470 5f70 6c6f 742c 2070 6c6f 745f 6669  dp_plot, plot_fi
+00028440: 6c65 6e61 6d65 290a 2020 2020 2020 2020  lename).        
+00028450: 2020 2020 7265 7475 726e 2070 6470 5f70      return pdp_p
+00028460: 6c6f 740a 0a20 2020 2020 2020 2064 6566  lot..        def
+00028470: 206d 7361 2873 686f 773a 2062 6f6f 6c20   msa(show: bool 
+00028480: 3d20 5472 7565 293a 0a20 2020 2020 2020  = True):.       
+00028490: 2020 2020 2066 726f 6d20 696e 7465 7270       from interp
+000284a0: 7265 742e 626c 6163 6b62 6f78 2069 6d70  ret.blackbox imp
+000284b0: 6f72 7420 4d6f 7272 6973 5365 6e73 6974  ort MorrisSensit
+000284c0: 6976 6974 790a 0a20 2020 2020 2020 2020  ivity..         
+000284d0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+000284e0: 2020 2020 2020 2020 2320 696e 7465 7270          # interp
+000284f0: 7265 743e 3d30 2e33 2e31 0a20 2020 2020  ret>=0.3.1.     
+00028500: 2020 2020 2020 2020 2020 206d 7361 203d             msa =
+00028510: 204d 6f72 7269 7353 656e 7369 7469 7669   MorrisSensitivi
+00028520: 7479 280a 2020 2020 2020 2020 2020 2020  ty(.            
+00028530: 2020 2020 2020 2020 6d6f 6465 6c3d 6d6f          model=mo
+00028540: 6465 6c2c 0a20 2020 2020 2020 2020 2020  del,.           
+00028550: 2020 2020 2020 2020 2064 6174 613d 7465           data=te
+00028560: 7374 5f58 2e74 6f5f 6e75 6d70 7928 292c  st_X.to_numpy(),
+00028570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028580: 2020 2020 2066 6561 7475 7265 5f6e 616d       feature_nam
+00028590: 6573 3d6c 6973 7428 7465 7374 5f58 2e63  es=list(test_X.c
+000285a0: 6f6c 756d 6e73 292c 0a20 2020 2020 2020  olumns),.       
+000285b0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000285c0: 2020 2020 2020 2065 7863 6570 7420 5479         except Ty
+000285d0: 7065 4572 726f 723a 0a20 2020 2020 2020  peError:.       
+000285e0: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
+000285f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028600: 2020 6d73 6120 3d20 4d6f 7272 6973 5365    msa = MorrisSe
+00028610: 6e73 6974 6976 6974 7928 0a20 2020 2020  nsitivity(.     
+00028620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028630: 2020 2070 7265 6469 6374 5f66 6e3d 6d6f     predict_fn=mo
+00028640: 6465 6c2e 7072 6564 6963 745f 7072 6f62  del.predict_prob
+00028650: 612c 2064 6174 613d 7465 7374 5f58 0a20  a, data=test_X. 
+00028660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028670: 2020 2029 2020 2320 636c 6173 7369 6669     )  # classifi
+00028680: 6361 7469 6f6e 0a20 2020 2020 2020 2020  cation.         
+00028690: 2020 2020 2020 2065 7863 6570 7420 4174         except At
+000286a0: 7472 6962 7574 6545 7272 6f72 3a0a 2020  tributeError:.  
+000286b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000286c0: 2020 6d73 6120 3d20 4d6f 7272 6973 5365    msa = MorrisSe
+000286d0: 6e73 6974 6976 6974 7928 0a20 2020 2020  nsitivity(.     
+000286e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000286f0: 2020 2070 7265 6469 6374 5f66 6e3d 6d6f     predict_fn=mo
+00028700: 6465 6c2e 7072 6564 6963 742c 2064 6174  del.predict, dat
+00028710: 613d 7465 7374 5f58 0a20 2020 2020 2020  a=test_X.       
+00028720: 2020 2020 2020 2020 2020 2020 2029 2020               )  
+00028730: 2320 7265 6772 6573 7369 6f6e 0a20 2020  # regression.   
+00028740: 2020 2020 2020 2020 206d 7361 5f67 6c6f           msa_glo
+00028750: 6261 6c20 3d20 6d73 612e 6578 706c 6169  bal = msa.explai
+00028760: 6e5f 676c 6f62 616c 2829 0a20 2020 2020  n_global().     
+00028770: 2020 2020 2020 206d 7361 5f70 6c6f 7420         msa_plot 
+00028780: 3d20 6d73 615f 676c 6f62 616c 2e76 6973  = msa_global.vis
+00028790: 7561 6c69 7a65 2829 0a20 2020 2020 2020  ualize().       
+000287a0: 2020 2020 2069 6620 7361 7665 3a0a 2020       if save:.  
+000287b0: 2020 2020 2020 2020 2020 2020 2020 696d                im
+000287c0: 706f 7274 2070 6c6f 746c 792e 696f 2061  port plotly.io a
+000287d0: 7320 7069 6f0a 0a20 2020 2020 2020 2020  s pio..         
+000287e0: 2020 2020 2020 2070 6c6f 745f 6669 6c65         plot_file
+000287f0: 6e61 6d65 203d 2066 224d 5341 207b 706c  name = f"MSA {pl
+00028800: 6f74 7d2e 6874 6d6c 220a 2020 2020 2020  ot}.html".      
+00028810: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+00028820: 2069 7369 6e73 7461 6e63 6528 7361 7665   isinstance(save
+00028830: 2c20 626f 6f6c 293a 0a20 2020 2020 2020  , bool):.       
+00028840: 2020 2020 2020 2020 2020 2020 2070 6c6f               plo
+00028850: 745f 6669 6c65 6e61 6d65 203d 206f 732e  t_filename = os.
+00028860: 7061 7468 2e6a 6f69 6e28 7361 7665 2c20  path.join(save, 
+00028870: 706c 6f74 5f66 696c 656e 616d 6529 0a20  plot_filename). 
+00028880: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00028890: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
+000288a0: 6622 5361 7669 6e67 2027 7b70 6c6f 745f  f"Saving '{plot_
+000288b0: 6669 6c65 6e61 6d65 7d27 2229 0a20 2020  filename}'").   
+000288c0: 2020 2020 2020 2020 2020 2020 2070 696f               pio
+000288d0: 2e77 7269 7465 5f68 746d 6c28 6d73 615f  .write_html(msa_
+000288e0: 706c 6f74 2c20 706c 6f74 5f66 696c 656e  plot, plot_filen
+000288f0: 616d 6529 0a20 2020 2020 2020 2020 2020  ame).           
+00028900: 2072 6574 7572 6e20 6d73 615f 706c 6f74   return msa_plot
+00028910: 0a0a 2020 2020 2020 2020 6465 6620 7066  ..        def pf
+00028920: 6928 7368 6f77 3a20 626f 6f6c 203d 2054  i(show: bool = T
+00028930: 7275 6529 3a0a 2020 2020 2020 2020 2020  rue):.          
+00028940: 2020 6672 6f6d 2069 6e74 6572 7072 6574    from interpret
+00028950: 2e65 7874 2e62 6c61 636b 626f 7820 696d  .ext.blackbox im
+00028960: 706f 7274 2050 4649 4578 706c 6169 6e65  port PFIExplaine
+00028970: 720a 0a20 2020 2020 2020 2020 2020 2070  r..            p
+00028980: 6669 203d 2050 4649 4578 706c 6169 6e65  fi = PFIExplaine
+00028990: 7228 6d6f 6465 6c29 0a20 2020 2020 2020  r(model).       
+000289a0: 2020 2020 2070 6669 5f67 6c6f 6261 6c20       pfi_global 
+000289b0: 3d20 7066 692e 6578 706c 6169 6e5f 676c  = pfi.explain_gl
+000289c0: 6f62 616c 2874 6573 745f 582c 2074 7275  obal(test_X, tru
+000289d0: 655f 6c61 6265 6c73 3d74 6573 745f 7929  e_labels=test_y)
+000289e0: 0a20 2020 2020 2020 2020 2020 2070 6669  .            pfi
+000289f0: 5f70 6c6f 7420 3d20 7066 695f 676c 6f62  _plot = pfi_glob
+00028a00: 616c 2e76 6973 7561 6c69 7a65 2829 0a20  al.visualize(). 
+00028a10: 2020 2020 2020 2020 2020 2069 6620 7361             if sa
+00028a20: 7665 3a0a 2020 2020 2020 2020 2020 2020  ve:.            
+00028a30: 2020 2020 696d 706f 7274 2070 6c6f 746c      import plotl
+00028a40: 792e 696f 2061 7320 7069 6f0a 0a20 2020  y.io as pio..   
+00028a50: 2020 2020 2020 2020 2020 2020 2070 6c6f               plo
+00028a60: 745f 6669 6c65 6e61 6d65 203d 2066 2250  t_filename = f"P
+00028a70: 4649 207b 706c 6f74 7d2e 6874 6d6c 220a  FI {plot}.html".
+00028a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028a90: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00028aa0: 6528 7361 7665 2c20 626f 6f6c 293a 0a20  e(save, bool):. 
+00028ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ac0: 2020 2070 6c6f 745f 6669 6c65 6e61 6d65     plot_filename
+00028ad0: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
+00028ae0: 7361 7665 2c20 706c 6f74 5f66 696c 656e  save, plot_filen
+00028af0: 616d 6529 0a20 2020 2020 2020 2020 2020  ame).           
+00028b00: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
+00028b10: 2e69 6e66 6f28 6622 5361 7669 6e67 2027  .info(f"Saving '
+00028b20: 7b70 6c6f 745f 6669 6c65 6e61 6d65 7d27  {plot_filename}'
+00028b30: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00028b40: 2020 2070 696f 2e77 7269 7465 5f68 746d     pio.write_htm
+00028b50: 6c28 7066 695f 706c 6f74 2c20 706c 6f74  l(pfi_plot, plot
+00028b60: 5f66 696c 656e 616d 6529 0a20 2020 2020  _filename).     
+00028b70: 2020 2020 2020 2072 6574 7572 6e20 7066         return pf
+00028b80: 695f 706c 6f74 0a0a 2020 2020 2020 2020  i_plot..        
+00028b90: 7368 6170 5f70 6c6f 7420 3d20 6c6f 6361  shap_plot = loca
+00028ba0: 6c73 2829 5b70 6c6f 745d 2873 686f 773d  ls()[plot](show=
+00028bb0: 6e6f 7420 7361 7665 290a 0a20 2020 2020  not save)..     
+00028bc0: 2020 2073 656c 662e 6c6f 6767 6572 2e69     self.logger.i
+00028bd0: 6e66 6f28 2256 6973 7561 6c20 5265 6e64  nfo("Visual Rend
+00028be0: 6572 6564 2053 7563 6365 7373 6675 6c6c  ered Successfull
+00028bf0: 7922 290a 0a20 2020 2020 2020 2073 656c  y")..        sel
+00028c00: 662e 6c6f 6767 6572 2e69 6e66 6f28 0a20  f.logger.info(. 
+00028c10: 2020 2020 2020 2020 2020 2022 696e 7465             "inte
+00028c20: 7270 7265 745f 6d6f 6465 6c28 2920 7375  rpret_model() su
+00028c30: 6363 6573 7366 756c 6c79 2063 6f6d 706c  ccessfully compl
+00028c40: 6574 6564 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  eted............
+00028c50: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00028c60: 2e2e 2e2e 2e2e 2e2e 2e2e 220a 2020 2020  ..........".    
+00028c70: 2020 2020 290a 0a20 2020 2020 2020 2067      )..        g
+00028c80: 632e 636f 6c6c 6563 7428 290a 2020 2020  c.collect().    
+00028c90: 2020 2020 7265 7475 726e 2073 6861 705f      return shap_
+00028ca0: 706c 6f74 0a0a 2020 2020 6465 6620 6d6f  plot..    def mo
+00028cb0: 6465 6c73 280a 2020 2020 2020 2020 7365  dels(.        se
+00028cc0: 6c66 2c0a 2020 2020 2020 2020 7479 7065  lf,.        type
+00028cd0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+00028ce0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00028cf0: 696e 7465 726e 616c 3a20 626f 6f6c 203d  internal: bool =
+00028d00: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+00028d10: 7261 6973 655f 6572 726f 7273 3a20 626f  raise_errors: bo
+00028d20: 6f6c 203d 2054 7275 652c 0a20 2020 2029  ol = True,.    )
+00028d30: 202d 3e20 7064 2e44 6174 6146 7261 6d65   -> pd.DataFrame
+00028d40: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00028d50: 2020 2020 2020 5265 7475 726e 7320 7461        Returns ta
+00028d60: 626c 6520 6f66 206d 6f64 656c 7320 6176  ble of models av
+00028d70: 6169 6c61 626c 6520 696e 206d 6f64 656c  ailable in model
+00028d80: 206c 6962 7261 7279 2e0a 0a20 2020 2020   library...     
+00028d90: 2020 2045 7861 6d70 6c65 0a20 2020 2020     Example.     
+00028da0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+00028db0: 2020 203e 3e3e 205f 616c 6c5f 6d6f 6465     >>> _all_mode
+00028dc0: 6c73 203d 206d 6f64 656c 7328 290a 0a20  ls = models().. 
+00028dd0: 2020 2020 2020 2054 6869 7320 7769 6c6c         This will
+00028de0: 2072 6574 7572 6e20 7061 6e64 6173 2064   return pandas d
+00028df0: 6174 6166 7261 6d65 2077 6974 6820 616c  ataframe with al
+00028e00: 6c20 6176 6169 6c61 626c 650a 2020 2020  l available.    
+00028e10: 2020 2020 6d6f 6465 6c73 2061 6e64 2074      models and t
+00028e20: 6865 6972 206d 6574 6164 6174 612e 0a0a  heir metadata...
+00028e30: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00028e40: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+00028e50: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7479  -----.        ty
+00028e60: 7065 203a 2073 7472 2c20 6465 6661 756c  pe : str, defaul
+00028e70: 7420 3d20 4e6f 6e65 0a20 2020 2020 2020  t = None.       
+00028e80: 2020 2020 202d 206c 696e 6561 7220 3a20       - linear : 
+00028e90: 6669 6c74 6572 7320 616e 6420 6f6e 6c79  filters and only
+00028ea0: 2072 6574 7572 6e20 6c69 6e65 6172 206d   return linear m
+00028eb0: 6f64 656c 730a 2020 2020 2020 2020 2020  odels.          
+00028ec0: 2020 2d20 7472 6565 203a 2066 696c 7465    - tree : filte
+00028ed0: 7273 2061 6e64 206f 6e6c 7920 7265 7475  rs and only retu
+00028ee0: 726e 2074 7265 6520 6261 7365 6420 6d6f  rn tree based mo
+00028ef0: 6465 6c73 0a20 2020 2020 2020 2020 2020  dels.           
+00028f00: 202d 2065 6e73 656d 626c 6520 3a20 6669   - ensemble : fi
+00028f10: 6c74 6572 7320 616e 6420 6f6e 6c79 2072  lters and only r
+00028f20: 6574 7572 6e20 656e 7365 6d62 6c65 206d  eturn ensemble m
+00028f30: 6f64 656c 730a 0a20 2020 2020 2020 2069  odels..        i
+00028f40: 6e74 6572 6e61 6c3a 2062 6f6f 6c2c 2064  nternal: bool, d
+00028f50: 6566 6175 6c74 203d 2046 616c 7365 0a20  efault = False. 
+00028f60: 2020 2020 2020 2020 2020 2049 6620 5472             If Tr
+00028f70: 7565 2c20 7769 6c6c 2072 6574 7572 6e20  ue, will return 
+00028f80: 6578 7472 6120 636f 6c75 6d6e 7320 616e  extra columns an
+00028f90: 6420 726f 7773 2075 7365 6420 696e 7465  d rows used inte
+00028fa0: 726e 616c 6c79 2e0a 0a20 2020 2020 2020  rnally...       
+00028fb0: 2072 6169 7365 5f65 7272 6f72 733a 2062   raise_errors: b
+00028fc0: 6f6f 6c2c 2064 6566 6175 6c74 203d 2054  ool, default = T
+00028fd0: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+00028fe0: 4966 2046 616c 7365 2c20 7769 6c6c 2073  If False, will s
+00028ff0: 7570 7072 6573 7320 616c 6c20 6578 6365  uppress all exce
+00029000: 7074 696f 6e73 2c20 6967 6e6f 7269 6e67  ptions, ignoring
+00029010: 206d 6f64 656c 730a 2020 2020 2020 2020   models.        
+00029020: 2020 2020 7468 6174 2063 6f75 6c64 6e27      that couldn'
+00029030: 7420 6265 2063 7265 6174 6564 2e0a 0a20  t be created... 
+00029040: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
+00029050: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+00029060: 2020 2020 2020 2070 616e 6461 732e 4461         pandas.Da
+00029070: 7461 4672 616d 650a 0a20 2020 2020 2020  taFrame..       
+00029080: 2022 2222 0a0a 2020 2020 2020 2020 6d6f   """..        mo
+00029090: 6465 6c5f 7479 7065 203d 207b 0a20 2020  del_type = {.   
+000290a0: 2020 2020 2020 2020 2022 6c69 6e65 6172           "linear
+000290b0: 223a 205b 0a20 2020 2020 2020 2020 2020  ": [.           
+000290c0: 2020 2020 2022 6c72 222c 0a20 2020 2020       "lr",.     
+000290d0: 2020 2020 2020 2020 2020 2022 7269 6467             "ridg
+000290e0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+000290f0: 2020 2020 2273 766d 222c 0a20 2020 2020      "svm",.     
+00029100: 2020 2020 2020 2020 2020 2022 6c61 7373             "lass
+00029110: 6f22 2c0a 2020 2020 2020 2020 2020 2020  o",.            
+00029120: 2020 2020 2265 6e22 2c0a 2020 2020 2020      "en",.      
+00029130: 2020 2020 2020 2020 2020 226c 6172 222c            "lar",
+00029140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029150: 2022 6c6c 6172 222c 0a20 2020 2020 2020   "llar",.       
+00029160: 2020 2020 2020 2020 2022 6f6d 7022 2c0a           "omp",.
+00029170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029180: 2262 7222 2c0a 2020 2020 2020 2020 2020  "br",.          
+00029190: 2020 2020 2020 2261 7264 222c 0a20 2020        "ard",.   
+000291a0: 2020 2020 2020 2020 2020 2020 2022 7061               "pa
+000291b0: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
+000291c0: 2020 2020 2272 616e 7361 6322 2c0a 2020      "ransac",.  
+000291d0: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+000291e0: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
+000291f0: 2020 2020 2268 7562 6572 222c 0a20 2020      "huber",.   
+00029200: 2020 2020 2020 2020 2020 2020 2022 6b72               "kr
+00029210: 222c 0a20 2020 2020 2020 2020 2020 205d  ",.            ]
+00029220: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+00029230: 7265 6522 3a20 5b22 6474 225d 2c0a 2020  ree": ["dt"],.  
+00029240: 2020 2020 2020 2020 2020 2265 6e73 656d            "ensem
+00029250: 626c 6522 3a20 5b0a 2020 2020 2020 2020  ble": [.        
+00029260: 2020 2020 2020 2020 2272 6622 2c0a 2020          "rf",.  
+00029270: 2020 2020 2020 2020 2020 2020 2020 2265                "e
+00029280: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
+00029290: 2020 2020 2267 6263 222c 0a20 2020 2020      "gbc",.     
+000292a0: 2020 2020 2020 2020 2020 2022 6762 7222             "gbr"
+000292b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000292c0: 2020 2278 6762 6f6f 7374 222c 0a20 2020    "xgboost",.   
+000292d0: 2020 2020 2020 2020 2020 2020 2022 6c69               "li
+000292e0: 6768 7467 626d 222c 0a20 2020 2020 2020  ghtgbm",.       
+000292f0: 2020 2020 2020 2020 2022 6361 7462 6f6f           "catboo
+00029300: 7374 222c 0a20 2020 2020 2020 2020 2020  st",.           
+00029310: 2020 2020 2022 6164 6122 2c0a 2020 2020       "ada",.    
+00029320: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
+00029330: 2020 207d 0a0a 2020 2020 2020 2020 6465     }..        de
+00029340: 6620 6669 6c74 6572 5f6d 6f64 656c 5f64  f filter_model_d
+00029350: 665f 6279 5f74 7970 6528 6466 293a 0a20  f_by_type(df):. 
+00029360: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00029370: 7420 7479 7065 3a0a 2020 2020 2020 2020  t type:.        
+00029380: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+00029390: 660a 2020 2020 2020 2020 2020 2020 7265  f.            re
+000293a0: 7475 726e 2064 665b 6466 2e69 6e64 6578  turn df[df.index
+000293b0: 2e69 7369 6e28 6d6f 6465 6c5f 7479 7065  .isin(model_type
+000293c0: 5b74 7970 655d 295d 0a0a 2020 2020 2020  [type])]..      
+000293d0: 2020 2320 4368 6563 6b20 6966 2074 7970    # Check if typ
+000293e0: 6520 6973 2076 616c 6964 0a20 2020 2020  e is valid.     
+000293f0: 2020 2069 6620 7479 7065 206e 6f74 2069     if type not i
+00029400: 6e20 6c69 7374 286d 6f64 656c 5f74 7970  n list(model_typ
+00029410: 6529 202b 205b 4e6f 6e65 5d3a 0a20 2020  e) + [None]:.   
+00029420: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00029430: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+00029440: 2020 2020 2020 2020 2020 2066 2274 7970             f"typ
+00029450: 6520 7061 7261 6d65 7465 7220 6f6e 6c79  e parameter only
+00029460: 2061 6363 6570 7473 207b 272c 2027 2e6a   accepts {', '.j
+00029470: 6f69 6e28 6c69 7374 286d 6f64 656c 5f74  oin(list(model_t
+00029480: 7970 6529 202b 2073 7472 284e 6f6e 6529  ype) + str(None)
+00029490: 297d 2e22 0a20 2020 2020 2020 2020 2020  )}.".           
+000294a0: 2029 0a0a 2020 2020 2020 2020 7365 6c66   )..        self
+000294b0: 2e6c 6f67 6765 722e 696e 666f 2866 2267  .logger.info(f"g
+000294c0: 7075 5f70 6172 616d 2073 6574 2074 6f20  pu_param set to 
+000294d0: 7b73 656c 662e 6770 755f 7061 7261 6d7d  {self.gpu_param}
+000294e0: 2229 0a0a 2020 2020 2020 2020 5f2c 206d  ")..        _, m
+000294f0: 6f64 656c 5f63 6f6e 7461 696e 6572 7320  odel_containers 
+00029500: 3d20 7365 6c66 2e5f 6765 745f 6d6f 6465  = self._get_mode
+00029510: 6c73 2872 6169 7365 5f65 7272 6f72 7329  ls(raise_errors)
+00029520: 0a0a 2020 2020 2020 2020 726f 7773 203d  ..        rows =
+00029530: 205b 0a20 2020 2020 2020 2020 2020 2076   [.            v
+00029540: 2e67 6574 5f64 6963 7428 696e 7465 726e  .get_dict(intern
+00029550: 616c 290a 2020 2020 2020 2020 2020 2020  al).            
+00029560: 666f 7220 6b2c 2076 2069 6e20 6d6f 6465  for k, v in mode
+00029570: 6c5f 636f 6e74 6169 6e65 7273 2e69 7465  l_containers.ite
+00029580: 6d73 2829 0a20 2020 2020 2020 2020 2020  ms().           
+00029590: 2069 6620 2869 6e74 6572 6e61 6c20 6f72   if (internal or
+000295a0: 206e 6f74 2076 2e69 735f 7370 6563 6961   not v.is_specia
+000295b0: 6c29 0a20 2020 2020 2020 205d 0a0a 2020  l).        ]..  
+000295c0: 2020 2020 2020 6466 203d 2070 642e 4461        df = pd.Da
+000295d0: 7461 4672 616d 6528 726f 7773 290a 2020  taFrame(rows).  
+000295e0: 2020 2020 2020 6466 2e73 6574 5f69 6e64        df.set_ind
+000295f0: 6578 2822 4944 222c 2069 6e70 6c61 6365  ex("ID", inplace
+00029600: 3d54 7275 652c 2064 726f 703d 5472 7565  =True, drop=True
+00029610: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00029620: 6e20 6669 6c74 6572 5f6d 6f64 656c 5f64  n filter_model_d
+00029630: 665f 6279 5f74 7970 6528 6466 290a 0a20  f_by_type(df).. 
+00029640: 2020 2064 6566 2067 6574 5f6d 6574 7269     def get_metri
+00029650: 6373 280a 2020 2020 2020 2020 7365 6c66  cs(.        self
+00029660: 2c0a 2020 2020 2020 2020 7265 7365 743a  ,.        reset:
+00029670: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
+00029680: 2020 2020 2020 2069 6e63 6c75 6465 5f63         include_c
+00029690: 7573 746f 6d3a 2062 6f6f 6c20 3d20 5472  ustom: bool = Tr
+000296a0: 7565 2c0a 2020 2020 2020 2020 7261 6973  ue,.        rais
+000296b0: 655f 6572 726f 7273 3a20 626f 6f6c 203d  e_errors: bool =
+000296c0: 2054 7275 652c 0a20 2020 2029 202d 3e20   True,.    ) -> 
+000296d0: 7064 2e44 6174 6146 7261 6d65 3a0a 2020  pd.DataFrame:.  
+000296e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000296f0: 2020 5265 7475 726e 7320 7461 626c 6520    Returns table 
+00029700: 6f66 206d 6574 7269 6373 2061 7661 696c  of metrics avail
+00029710: 6162 6c65 2e0a 0a20 2020 2020 2020 2045  able...        E
+00029720: 7861 6d70 6c65 0a20 2020 2020 2020 202d  xample.        -
+00029730: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
+00029740: 3e3e 206d 6574 7269 6373 203d 2067 6574  >> metrics = get
+00029750: 5f6d 6574 7269 6373 2829 0a0a 2020 2020  _metrics()..    
+00029760: 2020 2020 5468 6973 2077 696c 6c20 7265      This will re
+00029770: 7475 726e 2070 616e 6461 7320 6461 7461  turn pandas data
+00029780: 6672 616d 6520 7769 7468 2061 6c6c 2061  frame with all a
+00029790: 7661 696c 6162 6c65 0a20 2020 2020 2020  vailable.       
+000297a0: 206d 6574 7269 6373 2061 6e64 2074 6865   metrics and the
+000297b0: 6972 206d 6574 6164 6174 612e 0a0a 2020  ir metadata...  
+000297c0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+000297d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000297e0: 2d2d 2d0a 2020 2020 2020 2020 7265 7365  ---.        rese
+000297f0: 743a 2062 6f6f 6c2c 2064 6566 6175 6c74  t: bool, default
+00029800: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00029810: 2020 2020 2049 6620 5472 7565 2c20 7769       If True, wi
+00029820: 6c6c 2072 6573 6574 2061 6c6c 2063 6861  ll reset all cha
+00029830: 6e67 6573 206d 6164 6520 7573 696e 6720  nges made using 
+00029840: 6164 645f 6d65 7472 6963 2829 2061 6e64  add_metric() and
+00029850: 2067 6574 5f6d 6574 7269 6328 292e 0a20   get_metric().. 
+00029860: 2020 2020 2020 2069 6e63 6c75 6465 5f63         include_c
+00029870: 7573 746f 6d3a 2062 6f6f 6c2c 2064 6566  ustom: bool, def
+00029880: 6175 6c74 203d 2054 7275 650a 2020 2020  ault = True.    
+00029890: 2020 2020 2020 2020 5768 6574 6865 7220          Whether 
+000298a0: 746f 2069 6e63 6c75 6465 2075 7365 7220  to include user 
+000298b0: 6164 6465 6420 2863 7573 746f 6d29 206d  added (custom) m
+000298c0: 6574 7269 6373 206f 7220 6e6f 742e 0a20  etrics or not.. 
+000298d0: 2020 2020 2020 2072 6169 7365 5f65 7272         raise_err
+000298e0: 6f72 733a 2062 6f6f 6c2c 2064 6566 6175  ors: bool, defau
+000298f0: 6c74 203d 2054 7275 650a 2020 2020 2020  lt = True.      
+00029900: 2020 2020 2020 4966 2046 616c 7365 2c20        If False, 
+00029910: 7769 6c6c 2073 7570 7072 6573 7320 616c  will suppress al
+00029920: 6c20 6578 6365 7074 696f 6e73 2c20 6967  l exceptions, ig
+00029930: 6e6f 7269 6e67 206d 6f64 656c 730a 2020  noring models.  
+00029940: 2020 2020 2020 2020 2020 7468 6174 2063            that c
+00029950: 6f75 6c64 6e27 7420 6265 2063 7265 6174  ouldn't be creat
+00029960: 6564 2e0a 0a20 2020 2020 2020 2052 6574  ed...        Ret
+00029970: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+00029980: 2d2d 2d2d 0a20 2020 2020 2020 2070 616e  ----.        pan
+00029990: 6461 732e 4461 7461 4672 616d 650a 0a20  das.DataFrame.. 
+000299a0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+000299b0: 2020 2020 6966 2072 6573 6574 2061 6e64      if reset and
+000299c0: 206e 6f74 2073 656c 662e 5f73 6574 7570   not self._setup
+000299d0: 5f72 616e 3a0a 2020 2020 2020 2020 2020  _ran:.          
+000299e0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+000299f0: 6f72 2822 7365 7475 7028 2920 6e65 6564  or("setup() need
+00029a00: 7320 746f 2062 6520 7261 6e20 6669 7273  s to be ran firs
+00029a10: 742e 2229 0a0a 2020 2020 2020 2020 6e70  t.")..        np
+00029a20: 2e72 616e 646f 6d2e 7365 6564 2873 656c  .random.seed(sel
+00029a30: 662e 7365 6564 290a 0a20 2020 2020 2020  f.seed)..       
+00029a40: 2069 6620 7265 7365 743a 0a20 2020 2020   if reset:.     
+00029a50: 2020 2020 2020 2073 656c 662e 5f61 6c6c         self._all
+00029a60: 5f6d 6574 7269 6373 203d 2073 656c 662e  _metrics = self.
+00029a70: 5f67 6574 5f6d 6574 7269 6373 2872 6169  _get_metrics(rai
+00029a80: 7365 5f65 7272 6f72 733d 7261 6973 655f  se_errors=raise_
+00029a90: 6572 726f 7273 290a 0a20 2020 2020 2020  errors)..       
+00029aa0: 206d 6574 7269 635f 636f 6e74 6169 6e65   metric_containe
+00029ab0: 7273 203d 2073 656c 662e 5f61 6c6c 5f6d  rs = self._all_m
+00029ac0: 6574 7269 6373 0a20 2020 2020 2020 2072  etrics.        r
+00029ad0: 6f77 7320 3d20 5b76 2e67 6574 5f64 6963  ows = [v.get_dic
+00029ae0: 7428 2920 666f 7220 6b2c 2076 2069 6e20  t() for k, v in 
+00029af0: 6d65 7472 6963 5f63 6f6e 7461 696e 6572  metric_container
+00029b00: 732e 6974 656d 7328 295d 0a0a 2020 2020  s.items()]..    
+00029b10: 2020 2020 6466 203d 2070 642e 4461 7461      df = pd.Data
+00029b20: 4672 616d 6528 726f 7773 290a 2020 2020  Frame(rows).    
+00029b30: 2020 2020 6466 2e73 6574 5f69 6e64 6578      df.set_index
+00029b40: 2822 4944 222c 2069 6e70 6c61 6365 3d54  ("ID", inplace=T
+00029b50: 7275 652c 2064 726f 703d 5472 7565 290a  rue, drop=True).
+00029b60: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00029b70: 696e 636c 7564 655f 6375 7374 6f6d 3a0a  include_custom:.
+00029b80: 2020 2020 2020 2020 2020 2020 6466 203d              df =
+00029b90: 2064 665b 6466 5b22 4375 7374 6f6d 225d   df[df["Custom"]
+00029ba0: 2069 7320 4661 6c73 655d 0a0a 2020 2020   is False]..    
+00029bb0: 2020 2020 7265 7475 726e 2064 660a 0a20      return df.. 
+00029bc0: 2020 2064 6566 2061 6464 5f6d 6574 7269     def add_metri
+00029bd0: 6328 0a20 2020 2020 2020 2073 656c 662c  c(.        self,
+00029be0: 0a20 2020 2020 2020 2069 643a 2073 7472  .        id: str
+00029bf0: 2c0a 2020 2020 2020 2020 6e61 6d65 3a20  ,.        name: 
+00029c00: 7374 722c 0a20 2020 2020 2020 2073 636f  str,.        sco
+00029c10: 7265 5f66 756e 633a 2074 7970 652c 0a20  re_func: type,. 
+00029c20: 2020 2020 2020 2074 6172 6765 743a 2073         target: s
+00029c30: 7472 203d 2022 7072 6564 222c 0a20 2020  tr = "pred",.   
+00029c40: 2020 2020 2067 7265 6174 6572 5f69 735f       greater_is_
+00029c50: 6265 7474 6572 3a20 626f 6f6c 203d 2054  better: bool = T
+00029c60: 7275 652c 0a20 2020 2020 2020 206d 756c  rue,.        mul
+00029c70: 7469 636c 6173 733a 2062 6f6f 6c20 3d20  ticlass: bool = 
+00029c80: 5472 7565 2c0a 2020 2020 2020 2020 2a2a  True,.        **
+00029c90: 6b77 6172 6773 2c0a 2020 2020 2920 2d3e  kwargs,.    ) ->
+00029ca0: 2070 642e 5365 7269 6573 3a0a 2020 2020   pd.Series:.    
+00029cb0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00029cc0: 4164 6473 2061 2063 7573 746f 6d20 6d65  Adds a custom me
+00029cd0: 7472 6963 2074 6f20 6265 2075 7365 6420  tric to be used 
+00029ce0: 696e 2061 6c6c 2066 756e 6374 696f 6e73  in all functions
+00029cf0: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00029d00: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00029d10: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00029d20: 2069 643a 2073 7472 0a20 2020 2020 2020   id: str.       
+00029d30: 2020 2020 2055 6e69 7175 6520 6964 2066       Unique id f
+00029d40: 6f72 2074 6865 206d 6574 7269 632e 0a0a  or the metric...
+00029d50: 2020 2020 2020 2020 6e61 6d65 3a20 7374          name: st
+00029d60: 720a 2020 2020 2020 2020 2020 2020 4469  r.            Di
+00029d70: 7370 6c61 7920 6e61 6d65 206f 6620 7468  splay name of th
+00029d80: 6520 6d65 7472 6963 2e0a 0a20 2020 2020  e metric...     
+00029d90: 2020 2073 636f 7265 5f66 756e 633a 2074     score_func: t
+00029da0: 7970 650a 2020 2020 2020 2020 2020 2020  ype.            
+00029db0: 5363 6f72 6520 6675 6e63 7469 6f6e 2028  Score function (
+00029dc0: 6f72 206c 6f73 7320 6675 6e63 7469 6f6e  or loss function
+00029dd0: 2920 7769 7468 2073 6967 6e61 7475 7265  ) with signature
+00029de0: 2073 636f 7265 5f66 756e 6328 792c 2079   score_func(y, y
+00029df0: 5f70 7265 642c 202a 2a6b 7761 7267 7329  _pred, **kwargs)
+00029e00: 2e0a 0a20 2020 2020 2020 2074 6172 6765  ...        targe
+00029e10: 743a 2073 7472 2c20 6465 6661 756c 7420  t: str, default 
+00029e20: 3d20 2770 7265 6427 0a20 2020 2020 2020  = 'pred'.       
+00029e30: 2020 2020 2054 6865 2074 6172 6765 7420       The target 
+00029e40: 6f66 2074 6865 2073 636f 7265 2066 756e  of the score fun
+00029e50: 6374 696f 6e2e 0a20 2020 2020 2020 2020  ction..         
+00029e60: 2020 202d 2027 7072 6564 2720 666f 7220     - 'pred' for 
+00029e70: 7468 6520 7072 6564 6963 7469 6f6e 2074  the prediction t
+00029e80: 6162 6c65 0a20 2020 2020 2020 2020 2020  able.           
+00029e90: 202d 2027 7072 6564 5f70 726f 6261 2720   - 'pred_proba' 
+00029ea0: 666f 7220 7072 6564 5f70 726f 6261 0a20  for pred_proba. 
+00029eb0: 2020 2020 2020 2020 2020 202d 2027 7468             - 'th
+00029ec0: 7265 7368 6f6c 6427 2066 6f72 2064 6563  reshold' for dec
+00029ed0: 6973 696f 6e5f 6675 6e63 7469 6f6e 206f  ision_function o
+00029ee0: 7220 7072 6564 6963 745f 7072 6f62 610a  r predict_proba.
+00029ef0: 0a20 2020 2020 2020 2067 7265 6174 6572  .        greater
+00029f00: 5f69 735f 6265 7474 6572 3a20 626f 6f6c  _is_better: bool
+00029f10: 2c20 6465 6661 756c 7420 3d20 5472 7565  , default = True
+00029f20: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
+00029f30: 7468 6572 2073 636f 7265 5f66 756e 6320  ther score_func 
+00029f40: 6973 2061 2073 636f 7265 2066 756e 6374  is a score funct
+00029f50: 696f 6e20 2864 6566 6175 6c74 292c 206d  ion (default), m
+00029f60: 6561 6e69 6e67 2068 6967 6820 6973 2067  eaning high is g
+00029f70: 6f6f 642c 0a20 2020 2020 2020 2020 2020  ood,.           
+00029f80: 206f 7220 6120 6c6f 7373 2066 756e 6374   or a loss funct
+00029f90: 696f 6e2c 206d 6561 6e69 6e67 206c 6f77  ion, meaning low
+00029fa0: 2069 7320 676f 6f64 2e20 496e 2074 6865   is good. In the
+00029fb0: 206c 6174 7465 7220 6361 7365 2c20 7468   latter case, th
+00029fc0: 650a 2020 2020 2020 2020 2020 2020 7363  e.            sc
+00029fd0: 6f72 6572 206f 626a 6563 7420 7769 6c6c  orer object will
+00029fe0: 2073 6967 6e2d 666c 6970 2074 6865 206f   sign-flip the o
+00029ff0: 7574 636f 6d65 206f 6620 7468 6520 7363  utcome of the sc
+0002a000: 6f72 655f 6675 6e63 2e0a 0a20 2020 2020  ore_func...     
+0002a010: 2020 206d 756c 7469 636c 6173 733a 2062     multiclass: b
+0002a020: 6f6f 6c2c 2064 6566 6175 6c74 203d 2054  ool, default = T
+0002a030: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+0002a040: 5768 6574 6865 7220 7468 6520 6d65 7472  Whether the metr
+0002a050: 6963 2073 7570 706f 7274 7320 6d75 6c74  ic supports mult
+0002a060: 6963 6c61 7373 2070 726f 626c 656d 732e  iclass problems.
+0002a070: 0a0a 2020 2020 2020 2020 2a2a 6b77 6172  ..        **kwar
+0002a080: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+0002a090: 4172 6775 6d65 6e74 7320 746f 2062 6520  Arguments to be 
+0002a0a0: 7061 7373 6564 2074 6f20 7363 6f72 6520  passed to score 
+0002a0b0: 6675 6e63 7469 6f6e 2e0a 0a20 2020 2020  function...     
+0002a0c0: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
+0002a0d0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+0002a0e0: 2020 2070 616e 6461 732e 5365 7269 6573     pandas.Series
+0002a0f0: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+0002a100: 2063 7265 6174 6564 2072 6f77 2061 7320   created row as 
+0002a110: 5365 7269 6573 2e0a 0a20 2020 2020 2020  Series...       
+0002a120: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
+0002a130: 206e 6f74 2073 656c 662e 5f73 6574 7570   not self._setup
+0002a140: 5f72 616e 3a0a 2020 2020 2020 2020 2020  _ran:.          
+0002a150: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0002a160: 6f72 2822 7365 7475 7028 2920 6e65 6564  or("setup() need
+0002a170: 7320 746f 2062 6520 7261 6e20 6669 7273  s to be ran firs
+0002a180: 742e 2229 0a0a 2020 2020 2020 2020 6966  t.")..        if
+0002a190: 2069 6420 696e 2073 656c 662e 5f61 6c6c   id in self._all
+0002a1a0: 5f6d 6574 7269 6373 3a0a 2020 2020 2020  _metrics:.      
+0002a1b0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0002a1c0: 6545 7272 6f72 2822 6964 2061 6c72 6561  eError("id alrea
+0002a1d0: 6479 2070 7265 7365 6e74 2069 6e20 6d65  dy present in me
+0002a1e0: 7472 6963 7320 6461 7461 6672 616d 652e  trics dataframe.
+0002a1f0: 2229 0a0a 2020 2020 2020 2020 6966 2073  ")..        if s
+0002a200: 656c 662e 5f6d 6c5f 7573 6563 6173 6520  elf._ml_usecase 
+0002a210: 3d3d 204d 4c55 7365 6361 7365 2e43 4c41  == MLUsecase.CLA
+0002a220: 5353 4946 4943 4154 494f 4e3a 0a20 2020  SSIFICATION:.   
+0002a230: 2020 2020 2020 2020 206e 6577 5f6d 6574           new_met
+0002a240: 7269 6320 3d20 280a 2020 2020 2020 2020  ric = (.        
+0002a250: 2020 2020 2020 2020 7079 6361 7265 742e          pycaret.
+0002a260: 636f 6e74 6169 6e65 7273 2e6d 6574 7269  containers.metri
+0002a270: 6373 2e63 6c61 7373 6966 6963 6174 696f  cs.classificatio
+0002a280: 6e2e 436c 6173 7369 6669 6361 7469 6f6e  n.Classification
+0002a290: 4d65 7472 6963 436f 6e74 6169 6e65 7228  MetricContainer(
 0002a2a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a2b0: 2070 7963 6172 6574 2e63 6f6e 7461 696e   pycaret.contain
-0002a2c0: 6572 732e 6d65 7472 6963 732e 7265 6772  ers.metrics.regr
-0002a2d0: 6573 7369 6f6e 2e52 6567 7265 7373 696f  ession.Regressio
-0002a2e0: 6e4d 6574 7269 6343 6f6e 7461 696e 6572  nMetricContainer
-0002a2f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002a300: 2020 2020 2020 6964 3d69 642c 0a20 2020        id=id,.   
-0002a310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a320: 206e 616d 653d 6e61 6d65 2c0a 2020 2020   name=name,.    
-0002a330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a340: 7363 6f72 655f 6675 6e63 3d73 636f 7265  score_func=score
-0002a350: 5f66 756e 632c 0a20 2020 2020 2020 2020  _func,.         
-0002a360: 2020 2020 2020 2020 2020 2061 7267 733d             args=
-0002a370: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
-0002a380: 2020 2020 2020 2020 2020 2020 6469 7370              disp
-0002a390: 6c61 795f 6e61 6d65 3d6e 616d 652c 0a20  lay_name=name,. 
-0002a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a3b0: 2020 2067 7265 6174 6572 5f69 735f 6265     greater_is_be
-0002a3c0: 7474 6572 3d67 7265 6174 6572 5f69 735f  tter=greater_is_
-0002a3d0: 6265 7474 6572 2c0a 2020 2020 2020 2020  better,.        
-0002a3e0: 2020 2020 2020 2020 2020 2020 6973 5f63              is_c
-0002a3f0: 7573 746f 6d3d 5472 7565 2c0a 2020 2020  ustom=True,.    
-0002a400: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0002a410: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0002a420: 2020 2020 2073 656c 662e 5f61 6c6c 5f6d       self._all_m
-0002a430: 6574 7269 6373 5b69 645d 203d 206e 6577  etrics[id] = new
-0002a440: 5f6d 6574 7269 630a 0a20 2020 2020 2020  _metric..       
-0002a450: 206e 6577 5f6d 6574 7269 6320 3d20 6e65   new_metric = ne
-0002a460: 775f 6d65 7472 6963 2e67 6574 5f64 6963  w_metric.get_dic
-0002a470: 7428 290a 0a20 2020 2020 2020 206e 6577  t()..        new
-0002a480: 5f6d 6574 7269 6320 3d20 7064 2e53 6572  _metric = pd.Ser
-0002a490: 6965 7328 6e65 775f 6d65 7472 6963 2c20  ies(new_metric, 
-0002a4a0: 6e61 6d65 3d69 642e 7265 706c 6163 6528  name=id.replace(
-0002a4b0: 2220 222c 2022 5f22 2929 2e64 726f 7028  " ", "_")).drop(
-0002a4c0: 2249 4422 290a 0a20 2020 2020 2020 2072  "ID")..        r
-0002a4d0: 6574 7572 6e20 6e65 775f 6d65 7472 6963  eturn new_metric
-0002a4e0: 0a0a 2020 2020 6465 6620 7265 6d6f 7665  ..    def remove
-0002a4f0: 5f6d 6574 7269 6328 7365 6c66 2c20 6e61  _metric(self, na
-0002a500: 6d65 5f6f 725f 6964 3a20 7374 7229 3a0a  me_or_id: str):.
-0002a510: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0002a520: 2020 2020 5265 6d6f 7665 7320 6120 6d65      Removes a me
-0002a530: 7472 6963 2075 7365 6420 696e 2061 6c6c  tric used in all
-0002a540: 2066 756e 6374 696f 6e73 2e0a 0a20 2020   functions...   
-0002a550: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-0002a560: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0002a570: 2d2d 0a20 2020 2020 2020 206e 616d 655f  --.        name_
-0002a580: 6f72 5f69 643a 2073 7472 0a20 2020 2020  or_id: str.     
-0002a590: 2020 2020 2020 2044 6973 706c 6179 206e         Display n
-0002a5a0: 616d 6520 6f72 2049 4420 6f66 2074 6865  ame or ID of the
-0002a5b0: 206d 6574 7269 632e 0a0a 2020 2020 2020   metric...      
-0002a5c0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-0002a5d0: 206e 6f74 2073 656c 662e 5f73 6574 7570   not self._setup
-0002a5e0: 5f72 616e 3a0a 2020 2020 2020 2020 2020  _ran:.          
-0002a5f0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0002a600: 6f72 2822 7365 7475 7028 2920 6e65 6564  or("setup() need
-0002a610: 7320 746f 2062 6520 7261 6e20 6669 7273  s to be ran firs
-0002a620: 742e 2229 0a0a 2020 2020 2020 2020 7472  t.")..        tr
-0002a630: 793a 0a20 2020 2020 2020 2020 2020 2073  y:.            s
-0002a640: 656c 662e 5f61 6c6c 5f6d 6574 7269 6373  elf._all_metrics
-0002a650: 2e70 6f70 286e 616d 655f 6f72 5f69 6429  .pop(name_or_id)
-0002a660: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0002a670: 7572 6e0a 2020 2020 2020 2020 6578 6365  urn.        exce
-0002a680: 7074 2045 7863 6570 7469 6f6e 3a0a 2020  pt Exception:.  
-0002a690: 2020 2020 2020 2020 2020 7061 7373 0a0a            pass..
-0002a6a0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-0002a6b0: 2020 2020 2020 2020 206b 5f74 6f5f 7265           k_to_re
-0002a6c0: 6d6f 7665 203d 206e 6578 7428 0a20 2020  move = next(.   
-0002a6d0: 2020 2020 2020 2020 2020 2020 206b 2066               k f
-0002a6e0: 6f72 206b 2c20 7620 696e 2073 656c 662e  or k, v in self.
-0002a6f0: 5f61 6c6c 5f6d 6574 7269 6373 2e69 7465  _all_metrics.ite
-0002a700: 6d73 2829 2069 6620 762e 6e61 6d65 203d  ms() if v.name =
-0002a710: 3d20 6e61 6d65 5f6f 725f 6964 0a20 2020  = name_or_id.   
-0002a720: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0002a730: 2020 2020 2020 2073 656c 662e 5f61 6c6c         self._all
-0002a740: 5f6d 6574 7269 6373 2e70 6f70 286b 5f74  _metrics.pop(k_t
-0002a750: 6f5f 7265 6d6f 7665 290a 2020 2020 2020  o_remove).      
-0002a760: 2020 2020 2020 7265 7475 726e 0a20 2020        return.   
-0002a770: 2020 2020 2065 7863 6570 7420 4578 6365       except Exce
-0002a780: 7074 696f 6e3a 0a20 2020 2020 2020 2020  ption:.         
-0002a790: 2020 2070 6173 730a 0a20 2020 2020 2020     pass..       
-0002a7a0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0002a7b0: 7228 0a20 2020 2020 2020 2020 2020 2066  r(.            f
-0002a7c0: 224e 6f20 6d65 7472 6963 2027 4469 7370  "No metric 'Disp
-0002a7d0: 6c61 7920 4e61 6d65 2720 6f72 2027 4944  lay Name' or 'ID
-0002a7e0: 2720 2869 6e64 6578 2920 7b6e 616d 655f  ' (index) {name_
-0002a7f0: 6f72 5f69 647d 2070 7265 7365 6e74 2069  or_id} present i
-0002a800: 6e20 7468 6520 6d65 7472 6963 7320 7265  n the metrics re
-0002a810: 706f 7369 746f 7279 2e22 0a20 2020 2020  pository.".     
-0002a820: 2020 2029 0a0a 2020 2020 6465 6620 6669     )..    def fi
-0002a830: 6e61 6c69 7a65 5f6d 6f64 656c 280a 2020  nalize_model(.  
-0002a840: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0002a850: 2020 2020 6573 7469 6d61 746f 722c 0a20      estimator,. 
-0002a860: 2020 2020 2020 2066 6974 5f6b 7761 7267         fit_kwarg
-0002a870: 733a 204f 7074 696f 6e61 6c5b 6469 6374  s: Optional[dict
-0002a880: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-0002a890: 2020 6772 6f75 7073 3a20 4f70 7469 6f6e    groups: Option
-0002a8a0: 616c 5b55 6e69 6f6e 5b73 7472 2c20 416e  al[Union[str, An
-0002a8b0: 795d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  y]] = None,.    
-0002a8c0: 2020 2020 6d6f 6465 6c5f 6f6e 6c79 3a20      model_only: 
-0002a8d0: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
-0002a8e0: 2020 2020 2020 6578 7065 7269 6d65 6e74        experiment
-0002a8f0: 5f63 7573 746f 6d5f 7461 6773 3a20 4f70  _custom_tags: Op
-0002a900: 7469 6f6e 616c 5b44 6963 745b 7374 722c  tional[Dict[str,
-0002a910: 2041 6e79 5d5d 203d 204e 6f6e 652c 0a20   Any]] = None,. 
-0002a920: 2020 2029 202d 3e20 416e 793a 2020 2320     ) -> Any:  # 
-0002a930: 6164 6465 6420 696e 2070 7963 6172 6574  added in pycaret
-0002a940: 3d3d 322e 322e 300a 0a20 2020 2020 2020  ==2.2.0..       
-0002a950: 2022 2222 0a20 2020 2020 2020 2054 6869   """.        Thi
-0002a960: 7320 6675 6e63 7469 6f6e 2066 6974 7320  s function fits 
-0002a970: 7468 6520 636f 6d70 6c65 7465 2070 6970  the complete pip
-0002a980: 656c 696e 6520 7769 7468 2074 6865 2065  eline with the e
-0002a990: 7374 696d 6174 6f72 206f 6e20 7468 650a  stimator on the.
-0002a9a0: 2020 2020 2020 2020 636f 6d70 6c65 7465          complete
-0002a9b0: 2064 6174 6173 6574 2070 6173 7365 6420   dataset passed 
-0002a9c0: 6475 7269 6e67 2074 6865 2073 6574 7570  during the setup
-0002a9d0: 2829 2073 7461 6765 2e20 5468 6520 7075  () stage. The pu
-0002a9e0: 7270 6f73 6520 6f66 0a20 2020 2020 2020  rpose of.       
-0002a9f0: 2074 6869 7320 6675 6e63 7469 6f6e 2069   this function i
-0002aa00: 7320 746f 2070 7265 7061 7265 2066 6f72  s to prepare for
-0002aa10: 2066 696e 616c 206d 6f64 656c 2064 6570   final model dep
-0002aa20: 6c6f 796d 656e 7420 6166 7465 720a 2020  loyment after.  
-0002aa30: 2020 2020 2020 6578 7065 7269 6d65 6e74        experiment
-0002aa40: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
-0002aa50: 4578 616d 706c 650a 2020 2020 2020 2020  Example.        
-0002aa60: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0002aa70: 3e3e 3e20 6672 6f6d 2070 7963 6172 6574  >>> from pycaret
-0002aa80: 2e64 6174 6173 6574 7320 696d 706f 7274  .datasets import
-0002aa90: 2067 6574 5f64 6174 610a 2020 2020 2020   get_data.      
-0002aaa0: 2020 3e3e 3e20 6a75 6963 6520 3d20 6765    >>> juice = ge
-0002aab0: 745f 6461 7461 2827 6a75 6963 6527 290a  t_data('juice').
-0002aac0: 2020 2020 2020 2020 3e3e 3e20 6578 7065          >>> expe
-0002aad0: 7269 6d65 6e74 5f6e 616d 6520 3d20 7365  riment_name = se
-0002aae0: 7475 7028 6461 7461 203d 206a 7569 6365  tup(data = juice
-0002aaf0: 2c20 2074 6172 6765 7420 3d20 2750 7572  ,  target = 'Pur
-0002ab00: 6368 6173 6527 290a 2020 2020 2020 2020  chase').        
-0002ab10: 3e3e 3e20 6c72 203d 2063 7265 6174 655f  >>> lr = create_
-0002ab20: 6d6f 6465 6c28 276c 7227 290a 2020 2020  model('lr').    
-0002ab30: 2020 2020 3e3e 3e20 6669 6e61 6c5f 6c72      >>> final_lr
-0002ab40: 203d 2066 696e 616c 697a 655f 6d6f 6465   = finalize_mode
-0002ab50: 6c28 6c72 290a 0a20 2020 2020 2020 2054  l(lr)..        T
-0002ab60: 6869 7320 7769 6c6c 2072 6574 7572 6e20  his will return 
-0002ab70: 7468 6520 6669 6e61 6c20 6d6f 6465 6c20  the final model 
-0002ab80: 6f62 6a65 6374 2066 6974 7465 6420 746f  object fitted to
-0002ab90: 2063 6f6d 706c 6574 6520 6461 7461 7365   complete datase
-0002aba0: 742e 0a0a 2020 2020 2020 2020 5061 7261  t...        Para
-0002abb0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-0002abc0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0002abd0: 2020 6573 7469 6d61 746f 7220 3a20 6f62    estimator : ob
-0002abe0: 6a65 6374 2c20 6465 6661 756c 7420 3d20  ject, default = 
-0002abf0: 6e6f 6e65 0a20 2020 2020 2020 2020 2020  none.           
-0002ac00: 2041 2074 7261 696e 6564 206d 6f64 656c   A trained model
-0002ac10: 206f 626a 6563 7420 7368 6f75 6c64 2062   object should b
-0002ac20: 6520 7061 7373 6564 2061 7320 616e 2065  e passed as an e
-0002ac30: 7374 696d 6174 6f72 2e0a 0a20 2020 2020  stimator...     
-0002ac40: 2020 2066 6974 5f6b 7761 7267 733a 2064     fit_kwargs: d
-0002ac50: 6963 742c 2064 6566 6175 6c74 203d 207b  ict, default = {
-0002ac60: 7d20 2865 6d70 7479 2064 6963 7429 0a20  } (empty dict). 
-0002ac70: 2020 2020 2020 2020 2020 2044 6963 7469             Dicti
-0002ac80: 6f6e 6172 7920 6f66 2061 7267 756d 656e  onary of argumen
-0002ac90: 7473 2070 6173 7365 6420 746f 2074 6865  ts passed to the
-0002aca0: 2066 6974 206d 6574 686f 6420 6f66 2074   fit method of t
-0002acb0: 6865 206d 6f64 656c 2e0a 0a20 2020 2020  he model...     
-0002acc0: 2020 2067 726f 7570 733a 2073 7472 206f     groups: str o
-0002acd0: 7220 6172 7261 792d 6c69 6b65 2c20 7769  r array-like, wi
-0002ace0: 7468 2073 6861 7065 2028 6e5f 7361 6d70  th shape (n_samp
-0002acf0: 6c65 732c 292c 2064 6566 6175 6c74 203d  les,), default =
-0002ad00: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
-0002ad10: 2020 4f70 7469 6f6e 616c 2047 726f 7570    Optional Group
-0002ad20: 206c 6162 656c 7320 666f 7220 7468 6520   labels for the 
-0002ad30: 7361 6d70 6c65 7320 7573 6564 2077 6869  samples used whi
-0002ad40: 6c65 2073 706c 6974 7469 6e67 2074 6865  le splitting the
-0002ad50: 2064 6174 6173 6574 2069 6e74 6f20 7472   dataset into tr
-0002ad60: 6169 6e2f 7465 7374 2073 6574 2e0a 2020  ain/test set..  
-0002ad70: 2020 2020 2020 2020 2020 4966 2073 7472            If str
-0002ad80: 696e 6720 6973 2070 6173 7365 642c 2077  ing is passed, w
-0002ad90: 696c 6c20 7573 6520 7468 6520 6461 7461  ill use the data
-0002ada0: 2063 6f6c 756d 6e20 7769 7468 2074 6861   column with tha
-0002adb0: 7420 6e61 6d65 2061 7320 7468 6520 6772  t name as the gr
-0002adc0: 6f75 7073 2e0a 2020 2020 2020 2020 2020  oups..          
-0002add0: 2020 4f6e 6c79 2075 7365 6420 6966 2061    Only used if a
-0002ade0: 2067 726f 7570 2062 6173 6564 2063 726f   group based cro
-0002adf0: 7373 2d76 616c 6964 6174 696f 6e20 6765  ss-validation ge
-0002ae00: 6e65 7261 746f 7220 6973 2075 7365 6420  nerator is used 
-0002ae10: 2865 672e 2047 726f 7570 4b46 6f6c 6429  (eg. GroupKFold)
-0002ae20: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-0002ae30: 204e 6f6e 652c 2077 696c 6c20 7573 6520   None, will use 
-0002ae40: 7468 6520 7661 6c75 6520 7365 7420 696e  the value set in
-0002ae50: 2066 6f6c 645f 6772 6f75 7073 2070 6172   fold_groups par
-0002ae60: 616d 6574 6572 2069 6e20 7365 7475 7028  ameter in setup(
-0002ae70: 292e 0a0a 2020 2020 2020 2020 6d6f 6465  )...        mode
-0002ae80: 6c5f 6f6e 6c79 203a 2062 6f6f 6c2c 2064  l_only : bool, d
-0002ae90: 6566 6175 6c74 203d 2046 616c 7365 0a20  efault = False. 
-0002aea0: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
-0002aeb0: 6572 2074 6f20 7265 7475 726e 2074 6865  er to return the
-0002aec0: 2063 6f6d 706c 6574 6520 6669 7474 6564   complete fitted
-0002aed0: 2070 6970 656c 696e 6520 6f72 206f 6e6c   pipeline or onl
-0002aee0: 7920 7468 6520 6669 7474 6564 206d 6f64  y the fitted mod
-0002aef0: 656c 2e0a 0a20 2020 2020 2020 2065 7870  el...        exp
-0002af00: 6572 696d 656e 745f 6375 7374 6f6d 5f74  eriment_custom_t
-0002af10: 6167 733a 2064 6963 742c 2064 6566 6175  ags: dict, defau
-0002af20: 6c74 203d 204e 6f6e 650a 2020 2020 2020  lt = None.      
-0002af30: 2020 2020 2020 4469 6374 696f 6e61 7279        Dictionary
-0002af40: 206f 6620 7461 675f 6e61 6d65 3a20 5374   of tag_name: St
-0002af50: 7269 6e67 202d 3e20 7661 6c75 653a 2028  ring -> value: (
-0002af60: 5374 7269 6e67 2c20 6275 7420 7769 6c6c  String, but will
-0002af70: 2062 6520 7374 7269 6e67 2d69 6669 6564   be string-ified
-0002af80: 2069 660a 2020 2020 2020 2020 2020 2020   if.            
-0002af90: 6e6f 7429 2070 6173 7365 6420 746f 2074  not) passed to t
-0002afa0: 6865 206d 6c66 6c6f 772e 7365 745f 7461  he mlflow.set_ta
-0002afb0: 6773 2074 6f20 6164 6420 6e65 7720 6375  gs to add new cu
-0002afc0: 7374 6f6d 2074 6167 7320 666f 7220 7468  stom tags for th
-0002afd0: 6520 6578 7065 7269 6d65 6e74 2e0a 0a20  e experiment... 
-0002afe0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-0002aff0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-0002b000: 2020 2020 2020 2020 2020 2054 7261 696e             Train
-0002b010: 6564 2070 6970 656c 696e 6520 6f72 206d  ed pipeline or m
-0002b020: 6f64 656c 206f 626a 6563 7420 6669 7474  odel object fitt
-0002b030: 6564 206f 6e20 636f 6d70 6c65 7465 2064  ed on complete d
-0002b040: 6174 6173 6574 2e0a 0a20 2020 2020 2020  ataset...       
-0002b050: 2057 6172 6e69 6e67 730a 2020 2020 2020   Warnings.      
-0002b060: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-0002b070: 2020 202d 2049 6620 7468 6520 6d6f 6465     - If the mode
-0002b080: 6c20 7265 7475 726e 6564 2062 7920 6669  l returned by fi
-0002b090: 6e61 6c69 7a65 5f6d 6f64 656c 2829 2c20  nalize_model(), 
-0002b0a0: 6973 2075 7365 6420 6f6e 2070 7265 6469  is used on predi
-0002b0b0: 6374 5f6d 6f64 656c 2829 2077 6974 686f  ct_model() witho
-0002b0c0: 7574 0a20 2020 2020 2020 2070 6173 7369  ut.        passi
-0002b0d0: 6e67 2061 206e 6577 2075 6e73 6565 6e20  ng a new unseen 
-0002b0e0: 6461 7461 7365 742c 2074 6865 6e20 7468  dataset, then th
-0002b0f0: 6520 696e 666f 726d 6174 696f 6e20 6772  e information gr
-0002b100: 6964 2070 7269 6e74 6564 2069 7320 6d69  id printed is mi
-0002b110: 736c 6561 6469 6e67 0a20 2020 2020 2020  sleading.       
-0002b120: 2061 7320 7468 6520 6d6f 6465 6c20 6973   as the model is
-0002b130: 2074 7261 696e 6564 206f 6e20 7468 6520   trained on the 
-0002b140: 636f 6d70 6c65 7465 2064 6174 6173 6574  complete dataset
-0002b150: 2069 6e63 6c75 6469 6e67 2074 6573 7420   including test 
-0002b160: 2f20 686f 6c64 2d6f 7574 2073 616d 706c  / hold-out sampl
-0002b170: 652e 0a20 2020 2020 2020 204f 6e63 6520  e..        Once 
-0002b180: 6669 6e61 6c69 7a65 5f6d 6f64 656c 2829  finalize_model()
-0002b190: 2069 7320 7573 6564 2c20 7468 6520 6d6f   is used, the mo
-0002b1a0: 6465 6c20 6973 2063 6f6e 7369 6465 7265  del is considere
-0002b1b0: 6420 7265 6164 7920 666f 7220 6465 706c  d ready for depl
-0002b1c0: 6f79 6d65 6e74 2061 6e64 0a20 2020 2020  oyment and.     
-0002b1d0: 2020 2073 686f 756c 6420 6265 2075 7365     should be use
-0002b1e0: 6420 6f6e 206e 6577 2075 6e73 6565 6e20  d on new unseen 
-0002b1f0: 6461 7461 7365 7420 6f6e 6c79 2e0a 0a20  dataset only... 
-0002b200: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002b210: 2020 2073 656c 662e 5f63 6865 636b 5f73     self._check_s
-0002b220: 6574 7570 5f72 616e 2829 0a0a 2020 2020  etup_ran()..    
-0002b230: 2020 2020 6675 6e63 7469 6f6e 5f70 6172      function_par
-0002b240: 616d 735f 7374 7220 3d20 222c 2022 2e6a  ams_str = ", ".j
-0002b250: 6f69 6e28 5b66 227b 6b7d 3d7b 767d 2220  oin([f"{k}={v}" 
-0002b260: 666f 7220 6b2c 2076 2069 6e20 6c6f 6361  for k, v in loca
-0002b270: 6c73 2829 2e69 7465 6d73 2829 5d29 0a0a  ls().items()])..
-0002b280: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-0002b290: 6765 722e 696e 666f 2822 496e 6974 6961  ger.info("Initia
-0002b2a0: 6c69 7a69 6e67 2066 696e 616c 697a 655f  lizing finalize_
-0002b2b0: 6d6f 6465 6c28 2922 290a 2020 2020 2020  model()").      
-0002b2c0: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
-0002b2d0: 666f 2866 2266 696e 616c 697a 655f 6d6f  fo(f"finalize_mo
-0002b2e0: 6465 6c28 7b66 756e 6374 696f 6e5f 7061  del({function_pa
-0002b2f0: 7261 6d73 5f73 7472 7d29 2229 0a0a 2020  rams_str})")..  
-0002b300: 2020 2020 2020 7275 6e74 696d 655f 7374        runtime_st
-0002b310: 6172 7420 3d20 7469 6d65 2e74 696d 6528  art = time.time(
-0002b320: 290a 0a20 2020 2020 2020 2064 6973 706c  )..        displ
-0002b330: 6179 203d 2043 6f6d 6d6f 6e44 6973 706c  ay = CommonDispl
-0002b340: 6179 280a 2020 2020 2020 2020 2020 2020  ay(.            
-0002b350: 7665 7262 6f73 653d 4661 6c73 652c 0a20  verbose=False,. 
-0002b360: 2020 2020 2020 2020 2020 2068 746d 6c5f             html_
-0002b370: 7061 7261 6d3d 7365 6c66 2e68 746d 6c5f  param=self.html_
-0002b380: 7061 7261 6d2c 0a20 2020 2020 2020 2029  param,.        )
-0002b390: 0a0a 2020 2020 2020 2020 6e70 2e72 616e  ..        np.ran
-0002b3a0: 646f 6d2e 7365 6564 2873 656c 662e 7365  dom.seed(self.se
-0002b3b0: 6564 290a 0a20 2020 2020 2020 2073 656c  ed)..        sel
-0002b3c0: 662e 6c6f 6767 6572 2e69 6e66 6f28 6622  f.logger.info(f"
-0002b3d0: 4669 6e61 6c69 7a69 6e67 207b 6573 7469  Finalizing {esti
-0002b3e0: 6d61 746f 727d 2229 0a20 2020 2020 2020  mator}").       
-0002b3f0: 2070 6970 656c 696e 655f 6669 6e61 6c2c   pipeline_final,
-0002b400: 206d 6f64 656c 5f66 6974 5f74 696d 6520   model_fit_time 
-0002b410: 3d20 7365 6c66 2e5f 6372 6561 7465 5f6d  = self._create_m
-0002b420: 6f64 656c 280a 2020 2020 2020 2020 2020  odel(.          
-0002b430: 2020 6573 7469 6d61 746f 723d 6573 7469    estimator=esti
-0002b440: 6d61 746f 722c 0a20 2020 2020 2020 2020  mator,.         
-0002b450: 2020 2063 726f 7373 5f76 616c 6964 6174     cross_validat
-0002b460: 696f 6e3d 4661 6c73 652c 0a20 2020 2020  ion=False,.     
-0002b470: 2020 2020 2020 2076 6572 626f 7365 3d46         verbose=F
-0002b480: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-0002b490: 2020 7379 7374 656d 3d46 616c 7365 2c0a    system=False,.
-0002b4a0: 2020 2020 2020 2020 2020 2020 585f 7472              X_tr
-0002b4b0: 6169 6e5f 6461 7461 3d73 656c 662e 582c  ain_data=self.X,
-0002b4c0: 0a20 2020 2020 2020 2020 2020 2079 5f74  .            y_t
-0002b4d0: 7261 696e 5f64 6174 613d 7365 6c66 2e79  rain_data=self.y
-0002b4e0: 2c0a 2020 2020 2020 2020 2020 2020 6669  ,.            fi
-0002b4f0: 745f 6b77 6172 6773 3d66 6974 5f6b 7761  t_kwargs=fit_kwa
-0002b500: 7267 7320 6f72 207b 7d2c 0a20 2020 2020  rgs or {},.     
-0002b510: 2020 2020 2020 2070 7265 6469 6374 3d46         predict=F
-0002b520: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-0002b530: 2020 6772 6f75 7073 3d73 656c 662e 5f67    groups=self._g
-0002b540: 6574 5f67 726f 7570 7328 6772 6f75 7073  et_groups(groups
-0002b550: 2c20 6461 7461 3d73 656c 662e 5829 2c0a  , data=self.X),.
-0002b560: 2020 2020 2020 2020 2020 2020 6164 645f              add_
-0002b570: 746f 5f6d 6f64 656c 5f6c 6973 743d 4661  to_model_list=Fa
-0002b580: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-0002b590: 206d 6f64 656c 5f6f 6e6c 793d 4661 6c73   model_only=Fals
-0002b5a0: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
-0002b5b0: 2020 2020 2020 2320 6461 7368 626f 6172        # dashboar
-0002b5c0: 6420 6c6f 6767 696e 670a 2020 2020 2020  d logging.      
-0002b5d0: 2020 6966 2073 656c 662e 6c6f 6767 696e    if self.loggin
-0002b5e0: 675f 7061 7261 6d3a 0a20 2020 2020 2020  g_param:.       
-0002b5f0: 2020 2020 2073 656c 662e 5f6c 6f67 5f6d       self._log_m
-0002b600: 6f64 656c 280a 2020 2020 2020 2020 2020  odel(.          
-0002b610: 2020 2020 2020 6d6f 6465 6c3d 7069 7065        model=pipe
-0002b620: 6c69 6e65 5f66 696e 616c 2c0a 2020 2020  line_final,.    
-0002b630: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-0002b640: 6c5f 7265 7375 6c74 733d 4e6f 6e65 2c0a  l_results=None,.
-0002b650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b660: 7363 6f72 655f 6469 6374 3d7b 7d2c 0a20  score_dict={},. 
-0002b670: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0002b680: 6f75 7263 653d 2266 696e 616c 697a 655f  ource="finalize_
-0002b690: 6d6f 6465 6c22 2c0a 2020 2020 2020 2020  model",.        
-0002b6a0: 2020 2020 2020 2020 7275 6e74 696d 653d          runtime=
-0002b6b0: 6e70 2e61 7272 6179 2874 696d 652e 7469  np.array(time.ti
-0002b6c0: 6d65 2829 202d 2072 756e 7469 6d65 5f73  me() - runtime_s
-0002b6d0: 7461 7274 292e 726f 756e 6428 3229 2c0a  tart).round(2),.
-0002b6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b6f0: 6d6f 6465 6c5f 6669 745f 7469 6d65 3d6d  model_fit_time=m
-0002b700: 6f64 656c 5f66 6974 5f74 696d 652c 0a20  odel_fit_time,. 
-0002b710: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0002b720: 6970 656c 696e 653d 7365 6c66 2e70 6970  ipeline=self.pip
-0002b730: 656c 696e 652c 0a20 2020 2020 2020 2020  eline,.         
-0002b740: 2020 2020 2020 206c 6f67 5f70 6c6f 7473         log_plots
-0002b750: 3d73 656c 662e 6c6f 675f 706c 6f74 735f  =self.log_plots_
-0002b760: 7061 7261 6d2c 0a20 2020 2020 2020 2020  param,.         
-0002b770: 2020 2020 2020 2065 7870 6572 696d 656e         experimen
-0002b780: 745f 6375 7374 6f6d 5f74 6167 733d 6578  t_custom_tags=ex
-0002b790: 7065 7269 6d65 6e74 5f63 7573 746f 6d5f  periment_custom_
-0002b7a0: 7461 6773 2c0a 2020 2020 2020 2020 2020  tags,.          
-0002b7b0: 2020 2020 2020 6469 7370 6c61 793d 6469        display=di
-0002b7c0: 7370 6c61 792c 0a20 2020 2020 2020 2020  splay,.         
-0002b7d0: 2020 2029 0a0a 2020 2020 2020 2020 7365     )..        se
-0002b7e0: 6c66 2e6c 6f67 6765 722e 696e 666f 280a  lf.logger.info(.
-0002b7f0: 2020 2020 2020 2020 2020 2020 6622 5f6d              f"_m
-0002b800: 6173 7465 725f 6d6f 6465 6c5f 636f 6e74  aster_model_cont
-0002b810: 6169 6e65 723a 207b 6c65 6e28 7365 6c66  ainer: {len(self
-0002b820: 2e5f 6d61 7374 6572 5f6d 6f64 656c 5f63  ._master_model_c
-0002b830: 6f6e 7461 696e 6572 297d 220a 2020 2020  ontainer)}".    
-0002b840: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-0002b850: 6c66 2e6c 6f67 6765 722e 696e 666f 2866  lf.logger.info(f
-0002b860: 225f 6469 7370 6c61 795f 636f 6e74 6169  "_display_contai
-0002b870: 6e65 723a 207b 6c65 6e28 7365 6c66 2e5f  ner: {len(self._
-0002b880: 6469 7370 6c61 795f 636f 6e74 6169 6e65  display_containe
-0002b890: 7229 7d22 290a 0a20 2020 2020 2020 2073  r)}")..        s
-0002b8a0: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
-0002b8b0: 7374 7228 7069 7065 6c69 6e65 5f66 696e  str(pipeline_fin
-0002b8c0: 616c 2929 0a20 2020 2020 2020 2073 656c  al)).        sel
-0002b8d0: 662e 6c6f 6767 6572 2e69 6e66 6f28 0a20  f.logger.info(. 
-0002b8e0: 2020 2020 2020 2020 2020 2022 6669 6e61             "fina
-0002b8f0: 6c69 7a65 5f6d 6f64 656c 2829 2073 7563  lize_model() suc
-0002b900: 6365 7373 6675 6c6c 7920 636f 6d70 6c65  cessfully comple
-0002b910: 7465 642e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ted.............
-0002b920: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0002b930: 2e2e 2e2e 2e2e 2e2e 2e22 0a20 2020 2020  .........".     
-0002b940: 2020 2029 0a0a 2020 2020 2020 2020 6763     )..        gc
-0002b950: 2e63 6f6c 6c65 6374 2829 0a0a 2020 2020  .collect()..    
-0002b960: 2020 2020 6966 206d 6f64 656c 5f6f 6e6c      if model_onl
-0002b970: 793a 0a20 2020 2020 2020 2020 2020 2072  y:.            r
-0002b980: 6574 7572 6e20 7365 6c66 2e5f 6765 745f  eturn self._get_
-0002b990: 6669 6e61 6c5f 6d6f 6465 6c5f 6672 6f6d  final_model_from
-0002b9a0: 5f70 6970 656c 696e 6528 7069 7065 6c69  _pipeline(pipeli
-0002b9b0: 6e65 5f66 696e 616c 290a 0a20 2020 2020  ne_final)..     
-0002b9c0: 2020 2072 6574 7572 6e20 7069 7065 6c69     return pipeli
-0002b9d0: 6e65 5f66 696e 616c 0a0a 2020 2020 6465  ne_final..    de
-0002b9e0: 6620 7072 6564 6963 745f 6d6f 6465 6c28  f predict_model(
-0002b9f0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0002ba00: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
-0002ba10: 2c0a 2020 2020 2020 2020 6461 7461 3a20  ,.        data: 
-0002ba20: 4f70 7469 6f6e 616c 5b70 642e 4461 7461  Optional[pd.Data
-0002ba30: 4672 616d 655d 203d 204e 6f6e 652c 0a20  Frame] = None,. 
-0002ba40: 2020 2020 2020 2070 726f 6261 6269 6c69         probabili
-0002ba50: 7479 5f74 6872 6573 686f 6c64 3a20 4f70  ty_threshold: Op
-0002ba60: 7469 6f6e 616c 5b66 6c6f 6174 5d20 3d20  tional[float] = 
-0002ba70: 4e6f 6e65 2c0a 2020 2020 2020 2020 656e  None,.        en
-0002ba80: 636f 6465 645f 6c61 6265 6c73 3a20 626f  coded_labels: bo
-0002ba90: 6f6c 203d 2046 616c 7365 2c20 2023 2061  ol = False,  # a
-0002baa0: 6464 6564 2069 6e20 7079 6361 7265 743d  dded in pycaret=
-0002bab0: 3d32 2e31 2e30 0a20 2020 2020 2020 2072  =2.1.0.        r
-0002bac0: 6177 5f73 636f 7265 3a20 626f 6f6c 203d  aw_score: bool =
-0002bad0: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
-0002bae0: 726f 756e 643a 2069 6e74 203d 2034 2c20  round: int = 4, 
-0002baf0: 2023 2061 6464 6564 2069 6e20 7079 6361   # added in pyca
-0002bb00: 7265 743d 3d32 2e32 2e30 0a20 2020 2020  ret==2.2.0.     
-0002bb10: 2020 2076 6572 626f 7365 3a20 626f 6f6c     verbose: bool
-0002bb20: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
-0002bb30: 206d 6c5f 7573 6563 6173 653a 204f 7074   ml_usecase: Opt
-0002bb40: 696f 6e61 6c5b 4d4c 5573 6563 6173 655d  ional[MLUsecase]
-0002bb50: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0002bb60: 2070 7265 7072 6f63 6573 733a 2055 6e69   preprocess: Uni
-0002bb70: 6f6e 5b62 6f6f 6c2c 2073 7472 5d20 3d20  on[bool, str] = 
-0002bb80: 5472 7565 2c0a 2020 2020 2920 2d3e 2070  True,.    ) -> p
-0002bb90: 642e 4461 7461 4672 616d 653a 0a0a 2020  d.DataFrame:..  
-0002bba0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0002bbb0: 2020 5468 6973 2066 756e 6374 696f 6e20    This function 
-0002bbc0: 6973 2075 7365 6420 746f 2070 7265 6469  is used to predi
-0002bbd0: 6374 206c 6162 656c 2061 6e64 2070 726f  ct label and pro
-0002bbe0: 6261 6269 6c69 7479 2073 636f 7265 206f  bability score o
-0002bbf0: 6e20 7468 6520 6e65 7720 6461 7461 7365  n the new datase
-0002bc00: 740a 2020 2020 2020 2020 7573 696e 6720  t.        using 
-0002bc10: 6120 7472 6169 6e65 6420 6573 7469 6d61  a trained estima
-0002bc20: 746f 722e 204e 6577 2075 6e73 6565 6e20  tor. New unseen 
-0002bc30: 6461 7461 2063 616e 2062 6520 7061 7373  data can be pass
-0002bc40: 6564 2074 6f20 6461 7461 2070 6172 616d  ed to data param
-0002bc50: 6574 6572 2061 7320 7061 6e64 6173 0a20  eter as pandas. 
-0002bc60: 2020 2020 2020 2044 6174 6166 7261 6d65         Dataframe
-0002bc70: 2e20 4966 2064 6174 6120 6973 206e 6f74  . If data is not
-0002bc80: 2070 6173 7365 642c 2074 6865 2074 6573   passed, the tes
-0002bc90: 7420 2f20 686f 6c64 2d6f 7574 2073 6574  t / hold-out set
-0002bca0: 2073 6570 6172 6174 6564 2061 7420 7468   separated at th
-0002bcb0: 6520 7469 6d65 206f 660a 2020 2020 2020  e time of.      
-0002bcc0: 2020 7365 7475 7028 2920 6973 2075 7365    setup() is use
-0002bcd0: 6420 746f 2067 656e 6572 6174 6520 7072  d to generate pr
-0002bce0: 6564 6963 7469 6f6e 732e 0a0a 2020 2020  edictions...    
-0002bcf0: 2020 2020 4578 616d 706c 650a 2020 2020      Example.    
-0002bd00: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-0002bd10: 2020 2020 3e3e 3e20 6672 6f6d 2070 7963      >>> from pyc
-0002bd20: 6172 6574 2e64 6174 6173 6574 7320 696d  aret.datasets im
-0002bd30: 706f 7274 2067 6574 5f64 6174 610a 2020  port get_data.  
-0002bd40: 2020 2020 2020 3e3e 3e20 6a75 6963 6520        >>> juice 
-0002bd50: 3d20 6765 745f 6461 7461 2827 6a75 6963  = get_data('juic
-0002bd60: 6527 290a 2020 2020 2020 2020 3e3e 3e20  e').        >>> 
-0002bd70: 6578 7065 7269 6d65 6e74 5f6e 616d 6520  experiment_name 
-0002bd80: 3d20 7365 7475 7028 6461 7461 203d 206a  = setup(data = j
-0002bd90: 7569 6365 2c20 2074 6172 6765 7420 3d20  uice,  target = 
-0002bda0: 2750 7572 6368 6173 6527 290a 2020 2020  'Purchase').    
-0002bdb0: 2020 2020 3e3e 3e20 6c72 203d 2063 7265      >>> lr = cre
-0002bdc0: 6174 655f 6d6f 6465 6c28 276c 7227 290a  ate_model('lr').
-0002bdd0: 2020 2020 2020 2020 3e3e 3e20 6c72 5f70          >>> lr_p
-0002bde0: 7265 6469 6374 696f 6e73 5f68 6f6c 646f  redictions_holdo
-0002bdf0: 7574 203d 2070 7265 6469 6374 5f6d 6f64  ut = predict_mod
-0002be00: 656c 286c 7229 0a0a 2020 2020 2020 2020  el(lr)..        
-0002be10: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-0002be20: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-0002be30: 2020 2020 2020 6573 7469 6d61 746f 7220        estimator 
-0002be40: 3a20 6f62 6a65 6374 2c20 6465 6661 756c  : object, defaul
-0002be50: 7420 3d20 6e6f 6e65 0a20 2020 2020 2020  t = none.       
-0002be60: 2020 2020 2041 2074 7261 696e 6564 206d       A trained m
-0002be70: 6f64 656c 206f 626a 6563 7420 2f20 7069  odel object / pi
-0002be80: 7065 6c69 6e65 2073 686f 756c 6420 6265  peline should be
-0002be90: 2070 6173 7365 6420 6173 2061 6e20 6573   passed as an es
-0002bea0: 7469 6d61 746f 722e 0a0a 2020 2020 2020  timator...      
-0002beb0: 2020 6461 7461 203a 2070 616e 6461 732e    data : pandas.
-0002bec0: 4461 7461 4672 616d 650a 2020 2020 2020  DataFrame.      
-0002bed0: 2020 2020 2020 5368 6170 6520 286e 5f73        Shape (n_s
-0002bee0: 616d 706c 6573 2c20 6e5f 6665 6174 7572  amples, n_featur
-0002bef0: 6573 2920 7768 6572 6520 6e5f 7361 6d70  es) where n_samp
-0002bf00: 6c65 7320 6973 2074 6865 206e 756d 6265  les is the numbe
-0002bf10: 7220 6f66 2073 616d 706c 6573 0a20 2020  r of samples.   
-0002bf20: 2020 2020 2020 2020 2061 6e64 206e 5f66           and n_f
-0002bf30: 6561 7475 7265 7320 6973 2074 6865 206e  eatures is the n
-0002bf40: 756d 6265 7220 6f66 2066 6561 7475 7265  umber of feature
-0002bf50: 732e 2041 6c6c 2066 6561 7475 7265 7320  s. All features 
-0002bf60: 7573 6564 2064 7572 696e 6720 7472 6169  used during trai
-0002bf70: 6e69 6e67 0a20 2020 2020 2020 2020 2020  ning.           
-0002bf80: 206d 7573 7420 6265 2070 7265 7365 6e74   must be present
-0002bf90: 2069 6e20 7468 6520 6e65 7720 6461 7461   in the new data
-0002bfa0: 7365 742e 0a0a 2020 2020 2020 2020 7072  set...        pr
-0002bfb0: 6f62 6162 696c 6974 795f 7468 7265 7368  obability_thresh
-0002bfc0: 6f6c 6420 3a20 666c 6f61 742c 2064 6566  old : float, def
-0002bfd0: 6175 6c74 203d 204e 6f6e 650a 2020 2020  ault = None.    
-0002bfe0: 2020 2020 2020 2020 5468 7265 7368 6f6c          Threshol
-0002bff0: 6420 7573 6564 2074 6f20 636f 6e76 6572  d used to conver
-0002c000: 7420 7072 6f62 6162 696c 6974 7920 7661  t probability va
-0002c010: 6c75 6573 2069 6e74 6f20 6269 6e61 7279  lues into binary
-0002c020: 206f 7574 636f 6d65 2e20 4279 2064 6566   outcome. By def
-0002c030: 6175 6c74 0a20 2020 2020 2020 2020 2020  ault.           
-0002c040: 2074 6865 2070 726f 6261 6269 6c69 7479   the probability
-0002c050: 2074 6872 6573 686f 6c64 2066 6f72 2061   threshold for a
-0002c060: 6c6c 2062 696e 6172 7920 636c 6173 7369  ll binary classi
-0002c070: 6669 6572 7320 6973 2030 2e35 2028 3530  fiers is 0.5 (50
-0002c080: 2529 2e20 5468 6973 2063 616e 2062 650a  %). This can be.
-0002c090: 2020 2020 2020 2020 2020 2020 6368 616e              chan
-0002c0a0: 6765 6420 7573 696e 6720 7072 6f62 6162  ged using probab
-0002c0b0: 696c 6974 795f 7468 7265 7368 6f6c 6420  ility_threshold 
-0002c0c0: 7061 7261 6d2e 0a0a 2020 2020 2020 2020  param...        
-0002c0d0: 656e 636f 6465 645f 6c61 6265 6c73 3a20  encoded_labels: 
-0002c0e0: 426f 6f6c 6561 6e2c 2064 6566 6175 6c74  Boolean, default
-0002c0f0: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
-0002c100: 2020 2020 2049 6620 5472 7565 2c20 7769       If True, wi
-0002c110: 6c6c 2072 6574 7572 6e20 6c61 6265 6c73  ll return labels
-0002c120: 2065 6e63 6f64 6564 2061 7320 616e 2069   encoded as an i
-0002c130: 6e74 6567 6572 2e0a 0a20 2020 2020 2020  nteger...       
-0002c140: 2072 6177 5f73 636f 7265 3a20 626f 6f6c   raw_score: bool
-0002c150: 2c20 6465 6661 756c 7420 3d20 4661 6c73  , default = Fals
-0002c160: 650a 2020 2020 2020 2020 2020 2020 5768  e.            Wh
-0002c170: 656e 2073 6574 2074 6f20 5472 7565 2c20  en set to True, 
-0002c180: 7363 6f72 6573 2066 6f72 2061 6c6c 206c  scores for all l
-0002c190: 6162 656c 7320 7769 6c6c 2062 6520 7265  abels will be re
-0002c1a0: 7475 726e 6564 2e0a 0a20 2020 2020 2020  turned...       
-0002c1b0: 2072 6f75 6e64 3a20 696e 7465 6765 722c   round: integer,
-0002c1c0: 2064 6566 6175 6c74 203d 2034 0a20 2020   default = 4.   
-0002c1d0: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
-0002c1e0: 6f66 2064 6563 696d 616c 2070 6c61 6365  of decimal place
-0002c1f0: 7320 7468 6520 6d65 7472 6963 7320 696e  s the metrics in
-0002c200: 2074 6865 2073 636f 7265 2067 7269 6420   the score grid 
-0002c210: 7769 6c6c 2062 6520 726f 756e 6465 6420  will be rounded 
-0002c220: 746f 2e0a 0a20 2020 2020 2020 2076 6572  to...        ver
-0002c230: 626f 7365 3a20 626f 6f6c 2c20 6465 6661  bose: bool, defa
-0002c240: 756c 7420 3d20 5472 7565 0a20 2020 2020  ult = True.     
-0002c250: 2020 2020 2020 2048 6f6c 646f 7574 2073         Holdout s
-0002c260: 636f 7265 2067 7269 6420 6973 206e 6f74  core grid is not
-0002c270: 2070 7269 6e74 6564 2077 6865 6e20 7665   printed when ve
-0002c280: 7262 6f73 6520 6973 2073 6574 2074 6f20  rbose is set to 
-0002c290: 4661 6c73 652e 0a0a 2020 2020 2020 2020  False...        
-0002c2a0: 7072 6570 726f 6365 7373 3a20 626f 6f6c  preprocess: bool
-0002c2b0: 206f 7220 2766 6561 7475 7265 7327 2c20   or 'features', 
-0002c2c0: 6465 6661 756c 7420 3d20 5472 7565 0a20  default = True. 
-0002c2d0: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
-0002c2e0: 6572 2074 6f20 7072 6570 726f 6365 7373  er to preprocess
-0002c2f0: 2075 6e73 6565 6e20 6461 7461 2e20 4966   unseen data. If
-0002c300: 2027 6665 6174 7572 6573 272c 2077 696c   'features', wil
-0002c310: 6c20 6e6f 740a 2020 2020 2020 2020 2020  l not.          
-0002c320: 2020 7072 6570 726f 6365 7373 206c 6162    preprocess lab
-0002c330: 656c 732e 0a0a 2020 2020 2020 2020 5265  els...        Re
-0002c340: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
-0002c350: 2d2d 2d2d 2d0a 2020 2020 2020 2020 5072  -----.        Pr
-0002c360: 6564 6963 7469 6f6e 730a 2020 2020 2020  edictions.      
-0002c370: 2020 2020 2020 5072 6564 6963 7469 6f6e        Prediction
-0002c380: 7320 286c 6162 656c 2061 6e64 2073 636f  s (label and sco
-0002c390: 7265 2920 636f 6c75 6d6e 7320 6172 6520  re) columns are 
-0002c3a0: 6174 7461 6368 6564 2074 6f20 7468 6520  attached to the 
-0002c3b0: 6f72 6967 696e 616c 0a20 2020 2020 2020  original.       
-0002c3c0: 2020 2020 2064 6174 6173 6574 2061 6e64       dataset and
-0002c3d0: 2072 6574 7572 6e65 6420 6173 2070 616e   returned as pan
-0002c3e0: 6461 7320 6461 7461 6672 616d 652e 0a0a  das dataframe...
-0002c3f0: 2020 2020 2020 2020 7363 6f72 655f 6772          score_gr
-0002c400: 6964 0a20 2020 2020 2020 2020 2020 2041  id.            A
-0002c410: 2074 6162 6c65 2063 6f6e 7461 696e 696e   table containin
-0002c420: 6720 7468 6520 7363 6f72 696e 6720 6d65  g the scoring me
-0002c430: 7472 6963 7320 6f6e 2068 6f6c 642d 6f75  trics on hold-ou
-0002c440: 7420 2f20 7465 7374 2073 6574 2e0a 0a20  t / test set... 
-0002c450: 2020 2020 2020 2057 6172 6e69 6e67 730a         Warnings.
-0002c460: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0002c470: 0a20 2020 2020 2020 202d 2054 6865 2062  .        - The b
-0002c480: 6568 6176 696f 7220 6f66 2074 6865 2070  ehavior of the p
-0002c490: 7265 6469 6374 5f6d 6f64 656c 2069 7320  redict_model is 
-0002c4a0: 6368 616e 6765 6420 696e 2076 6572 7369  changed in versi
-0002c4b0: 6f6e 2032 2e31 2077 6974 686f 7574 2062  on 2.1 without b
-0002c4c0: 6163 6b77 6172 6420 636f 6d70 6174 6962  ackward compatib
-0002c4d0: 696c 6974 792e 0a20 2020 2020 2020 2041  ility..        A
-0002c4e0: 7320 7375 6368 2c20 7468 6520 7069 7065  s such, the pipe
-0002c4f0: 6c69 6e65 7320 7472 6169 6e65 6420 7573  lines trained us
-0002c500: 696e 6720 7468 6520 7665 7273 696f 6e20  ing the version 
-0002c510: 283c 3d20 322e 3029 2c20 6d61 7920 6e6f  (<= 2.0), may no
-0002c520: 7420 776f 726b 2066 6f72 2069 6e66 6572  t work for infer
-0002c530: 656e 6365 0a20 2020 2020 2020 2077 6974  ence.        wit
-0002c540: 6820 7665 7273 696f 6e20 3e3d 2032 2e31  h version >= 2.1
-0002c550: 2e20 596f 7520 6361 6e20 6569 7468 6572  . You can either
-0002c560: 2072 6574 7261 696e 2079 6f75 7220 6d6f   retrain your mo
-0002c570: 6465 6c73 2077 6974 6820 6120 6e65 7765  dels with a newe
-0002c580: 7220 7665 7273 696f 6e20 6f72 2064 6f77  r version or dow
-0002c590: 6e67 7261 6465 0a20 2020 2020 2020 2074  ngrade.        t
-0002c5a0: 6865 2076 6572 7369 6f6e 2066 6f72 2069  he version for i
-0002c5b0: 6e66 6572 656e 6365 2e0a 0a20 2020 2020  nference...     
-0002c5c0: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-0002c5d0: 6465 6620 7265 706c 6163 655f 6c61 6265  def replace_labe
-0002c5e0: 6c73 5f69 6e5f 636f 6c75 6d6e 2870 6970  ls_in_column(pip
-0002c5f0: 656c 696e 652c 206c 6162 656c 733a 2070  eline, labels: p
-0002c600: 642e 5365 7269 6573 2920 2d3e 2070 642e  d.Series) -> pd.
-0002c610: 5365 7269 6573 3a0a 2020 2020 2020 2020  Series:.        
-0002c620: 2020 2020 2320 4368 6563 6b20 6966 2074      # Check if t
-0002c630: 6865 7265 2069 7320 6120 4c61 6265 6c45  here is a LabelE
-0002c640: 6e63 6f64 6572 2069 6e20 7468 6520 7069  ncoder in the pi
-0002c650: 7065 6c69 6e65 0a20 2020 2020 2020 2020  peline.         
-0002c660: 2020 206c 6520 3d20 6765 745f 6c61 6265     le = get_labe
-0002c670: 6c5f 656e 636f 6465 7228 7069 7065 6c69  l_encoder(pipeli
-0002c680: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
-0002c690: 6966 206c 653a 0a20 2020 2020 2020 2020  if le:.         
-0002c6a0: 2020 2020 2020 2072 6574 7572 6e20 7064         return pd
-0002c6b0: 2e53 6572 6965 7328 0a20 2020 2020 2020  .Series(.       
-0002c6c0: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-0002c6d0: 613d 6c65 2e69 6e76 6572 7365 5f74 7261  a=le.inverse_tra
-0002c6e0: 6e73 666f 726d 286c 6162 656c 7329 2c0a  nsform(labels),.
-0002c6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c700: 2020 2020 6e61 6d65 3d6c 6162 656c 732e      name=labels.
-0002c710: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-0002c720: 2020 2020 2020 2020 2020 696e 6465 783d            index=
-0002c730: 6c61 6265 6c73 2e69 6e64 6578 2c0a 2020  labels.index,.  
-0002c740: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0002c750: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0002c760: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002c770: 2020 7265 7475 726e 206c 6162 656c 730a    return labels.
-0002c780: 0a20 2020 2020 2020 2066 756e 6374 696f  .        functio
-0002c790: 6e5f 7061 7261 6d73 5f73 7472 203d 2022  n_params_str = "
-0002c7a0: 2c20 222e 6a6f 696e 280a 2020 2020 2020  , ".join(.      
-0002c7b0: 2020 2020 2020 5b66 227b 6b7d 3d7b 767d        [f"{k}={v}
-0002c7c0: 2220 666f 7220 6b2c 2076 2069 6e20 6c6f  " for k, v in lo
-0002c7d0: 6361 6c73 2829 2e69 7465 6d73 2829 2069  cals().items() i
-0002c7e0: 6620 6b20 213d 2022 6461 7461 225d 0a20  f k != "data"]. 
-0002c7f0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0002c800: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
-0002c810: 666f 2822 496e 6974 6961 6c69 7a69 6e67  fo("Initializing
-0002c820: 2070 7265 6469 6374 5f6d 6f64 656c 2829   predict_model()
-0002c830: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
-0002c840: 6c6f 6767 6572 2e69 6e66 6f28 6622 7072  logger.info(f"pr
-0002c850: 6564 6963 745f 6d6f 6465 6c28 7b66 756e  edict_model({fun
-0002c860: 6374 696f 6e5f 7061 7261 6d73 5f73 7472  ction_params_str
-0002c870: 7d29 2229 0a0a 2020 2020 2020 2020 7365  })")..        se
-0002c880: 6c66 2e6c 6f67 6765 722e 696e 666f 2822  lf.logger.info("
-0002c890: 4368 6563 6b69 6e67 2065 7863 6570 7469  Checking excepti
-0002c8a0: 6f6e 7322 290a 0a20 2020 2020 2020 2022  ons")..        "
-0002c8b0: 2222 0a20 2020 2020 2020 2065 7863 6570  "".        excep
-0002c8c0: 7469 6f6e 2063 6865 636b 696e 6720 7374  tion checking st
-0002c8d0: 6172 7473 2068 6572 650a 2020 2020 2020  arts here.      
-0002c8e0: 2020 2222 220a 0a20 2020 2020 2020 2069    """..        i
-0002c8f0: 6620 6d6c 5f75 7365 6361 7365 2069 7320  f ml_usecase is 
-0002c900: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0002c910: 2020 6d6c 5f75 7365 6361 7365 203d 2073    ml_usecase = s
-0002c920: 656c 662e 5f6d 6c5f 7573 6563 6173 650a  elf._ml_usecase.
-0002c930: 0a20 2020 2020 2020 2069 6620 6461 7461  .        if data
-0002c940: 2069 7320 4e6f 6e65 2061 6e64 206e 6f74   is None and not
-0002c950: 2073 656c 662e 5f73 6574 7570 5f72 616e   self._setup_ran
-0002c960: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0002c970: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-0002c980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c990: 2264 6174 6120 7061 7261 6d65 7465 7220  "data parameter 
-0002c9a0: 6d61 7920 6e6f 7420 6265 204e 6f6e 6520  may not be None 
-0002c9b0: 7769 7468 6f75 7420 7275 6e6e 696e 6720  without running 
-0002c9c0: 7365 7475 7028 2920 6669 7273 742e 220a  setup() first.".
-0002c9d0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0002c9e0: 2020 2020 2020 2069 6620 7072 6f62 6162         if probab
-0002c9f0: 696c 6974 795f 7468 7265 7368 6f6c 6420  ility_threshold 
-0002ca00: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0002ca10: 2020 2020 2020 2020 2023 2070 726f 6261           # proba
-0002ca20: 6269 6c69 7479 5f74 6872 6573 686f 6c64  bility_threshold
-0002ca30: 2061 6c6c 6f77 6564 2074 7970 6573 0a20   allowed types. 
-0002ca40: 2020 2020 2020 2020 2020 2061 6c6c 6f77             allow
-0002ca50: 6564 5f74 7970 6573 203d 205b 696e 742c  ed_types = [int,
-0002ca60: 2066 6c6f 6174 5d0a 2020 2020 2020 2020   float].        
-0002ca70: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
-0002ca80: 2020 2020 2020 2020 2074 7970 6528 7072           type(pr
-0002ca90: 6f62 6162 696c 6974 795f 7468 7265 7368  obability_thresh
-0002caa0: 6f6c 6429 206e 6f74 2069 6e20 616c 6c6f  old) not in allo
-0002cab0: 7765 645f 7479 7065 730a 2020 2020 2020  wed_types.      
-0002cac0: 2020 2020 2020 2020 2020 6f72 2070 726f            or pro
-0002cad0: 6261 6269 6c69 7479 5f74 6872 6573 686f  bability_thresho
-0002cae0: 6c64 203e 2031 0a20 2020 2020 2020 2020  ld > 1.         
-0002caf0: 2020 2020 2020 206f 7220 7072 6f62 6162         or probab
-0002cb00: 696c 6974 795f 7468 7265 7368 6f6c 6420  ility_threshold 
-0002cb10: 3c20 300a 2020 2020 2020 2020 2020 2020  < 0.            
-0002cb20: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0002cb30: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-0002cb40: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0002cb50: 2020 2020 2020 2020 2270 726f 6261 6269          "probabi
-0002cb60: 6c69 7479 5f74 6872 6573 686f 6c64 2070  lity_threshold p
-0002cb70: 6172 616d 6574 6572 206f 6e6c 7920 6163  arameter only ac
-0002cb80: 6365 7074 7320 7661 6c75 6520 6265 7477  cepts value betw
-0002cb90: 6565 6e20 3020 746f 2031 2e22 0a20 2020  een 0 to 1.".   
-0002cba0: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
-0002cbb0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0002cbc0: 2020 2020 6578 6365 7074 696f 6e20 6368      exception ch
-0002cbd0: 6563 6b69 6e67 2065 6e64 7320 6865 7265  ecking ends here
-0002cbe0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-0002cbf0: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
-0002cc00: 722e 696e 666f 2822 5072 656c 6f61 6469  r.info("Preloadi
-0002cc10: 6e67 206c 6962 7261 7269 6573 2229 0a0a  ng libraries")..
-0002cc20: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-0002cc30: 2020 2020 2020 2020 206e 702e 7261 6e64           np.rand
-0002cc40: 6f6d 2e73 6565 6428 7365 6c66 2e73 6565  om.seed(self.see
-0002cc50: 6429 0a20 2020 2020 2020 2020 2020 2064  d).            d
-0002cc60: 6973 706c 6179 203d 2043 6f6d 6d6f 6e44  isplay = CommonD
-0002cc70: 6973 706c 6179 280a 2020 2020 2020 2020  isplay(.        
-0002cc80: 2020 2020 2020 2020 7665 7262 6f73 653d          verbose=
-0002cc90: 7665 7262 6f73 652c 0a20 2020 2020 2020  verbose,.       
-0002cca0: 2020 2020 2020 2020 2068 746d 6c5f 7061           html_pa
-0002ccb0: 7261 6d3d 7365 6c66 2e68 746d 6c5f 7061  ram=self.html_pa
-0002ccc0: 7261 6d2c 0a20 2020 2020 2020 2020 2020  ram,.           
-0002ccd0: 2029 0a20 2020 2020 2020 2065 7863 6570   ).        excep
-0002cce0: 7420 4578 6365 7074 696f 6e3a 0a20 2020  t Exception:.   
-0002ccf0: 2020 2020 2020 2020 2064 6973 706c 6179           display
-0002cd00: 203d 2043 6f6d 6d6f 6e44 6973 706c 6179   = CommonDisplay
-0002cd10: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002cd20: 2020 7665 7262 6f73 653d 4661 6c73 652c    verbose=False,
-0002cd30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002cd40: 2068 746d 6c5f 7061 7261 6d3d 4661 6c73   html_param=Fals
-0002cd50: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
-0002cd60: 0a0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
-0002cd70: 6e73 7461 6e63 6528 6573 7469 6d61 746f  nstance(estimato
-0002cd80: 722c 2073 6b50 6970 656c 696e 6529 3a0a  r, skPipeline):.
-0002cd90: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0002cda0: 6f74 2068 6173 6174 7472 2865 7374 696d  ot hasattr(estim
-0002cdb0: 6174 6f72 2c20 2266 6561 7475 7265 5f6e  ator, "feature_n
-0002cdc0: 616d 6573 5f69 6e5f 2229 3a0a 2020 2020  ames_in_"):.    
-0002cdd0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0002cde0: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
-0002cdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ce00: 2020 2249 6620 6573 7469 6d61 746f 7220    "If estimator 
-0002ce10: 6973 2061 2050 6970 656c 696e 652c 2069  is a Pipeline, i
-0002ce20: 7420 6d75 7374 2069 6d70 6c65 6d65 6e74  t must implement
-0002ce30: 2060 6665 6174 7572 655f 6e61 6d65 735f   `feature_names_
-0002ce40: 696e 5f60 2e22 0a20 2020 2020 2020 2020  in_`.".         
-0002ce50: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0002ce60: 2020 2020 2023 2057 6520 7573 6520 636f       # We use co
-0002ce70: 7079 2069 6e73 7465 6164 206f 6620 6465  py instead of de
-0002ce80: 6570 636f 7079 2062 6563 6175 7365 206f  epcopy because o
-0002ce90: 6620 6874 7470 733a 2f2f 6769 7468 7562  f https://github
-0002cea0: 2e63 6f6d 2f70 7963 6172 6574 2f70 7963  .com/pycaret/pyc
-0002ceb0: 6172 6574 2f69 7373 7565 732f 3237 3639  aret/issues/2769
-0002cec0: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
-0002ced0: 6174 626f 6f73 7420 6265 6861 7665 7320  atboost behaves 
-0002cee0: 7374 7261 6e67 6520 7768 656e 2064 6565  strange when dee
-0002cef0: 7020 636f 7069 6564 2e20 5573 696e 6720  p copied. Using 
-0002cf00: 636f 7079 2069 7320 6669 6e65 0a20 2020  copy is fine.   
-0002cf10: 2020 2020 2020 2020 2023 2073 696e 6365           # since
-0002cf20: 2074 6865 2075 6e64 6572 6c79 696e 6720   the underlying 
-0002cf30: 6573 7469 6d61 746f 7273 2061 7265 206f  estimators are o
-0002cf40: 6e6c 7920 7573 6564 2066 6f72 2074 7261  nly used for tra
-0002cf50: 6e73 666f 726d 0a20 2020 2020 2020 2020  nsform.         
-0002cf60: 2020 2070 6970 656c 696e 6520 3d20 636f     pipeline = co
-0002cf70: 7079 2865 7374 696d 6174 6f72 290a 0a20  py(estimator).. 
-0002cf80: 2020 2020 2020 2020 2020 2023 2054 656d             # Tem
-0002cf90: 706f 7261 7269 6c79 2072 656d 6f76 6520  porarily remove 
-0002cfa0: 6669 6e61 6c20 6573 7469 6d61 746f 7220  final estimator 
-0002cfb0: 736f 2069 7427 7320 6e6f 7420 7573 6564  so it's not used
-0002cfc0: 2066 6f72 2074 7261 6e73 666f 726d 0a20   for transform. 
-0002cfd0: 2020 2020 2020 2020 2020 2066 696e 616c             final
-0002cfe0: 5f73 7465 7020 3d20 7069 7065 6c69 6e65  _step = pipeline
-0002cff0: 2e73 7465 7073 5b2d 315d 0a20 2020 2020  .steps[-1].     
-0002d000: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
-0002d010: 203d 2066 696e 616c 5f73 7465 705b 2d31   = final_step[-1
-0002d020: 5d0a 2020 2020 2020 2020 2020 2020 7069  ].            pi
-0002d030: 7065 6c69 6e65 2e73 7465 7073 203d 2070  peline.steps = p
-0002d040: 6970 656c 696e 652e 7374 6570 735b 3a2d  ipeline.steps[:-
-0002d050: 315d 0a20 2020 2020 2020 2065 6c69 6620  1].        elif 
-0002d060: 6e6f 7420 7365 6c66 2e5f 7365 7475 705f  not self._setup_
-0002d070: 7261 6e3a 0a20 2020 2020 2020 2020 2020  ran:.           
-0002d080: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0002d090: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0002d0a0: 2020 2022 4966 2065 7374 696d 6174 6f72     "If estimator
-0002d0b0: 2069 7320 6e6f 7420 6120 5069 7065 6c69   is not a Pipeli
-0002d0c0: 6e65 2c20 796f 7520 6d75 7374 2072 756e  ne, you must run
-0002d0d0: 2073 6574 7570 2829 2066 6972 7374 2e22   setup() first."
-0002d0e0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0002d0f0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0002d100: 2020 2020 2020 2020 2070 6970 656c 696e           pipelin
-0002d110: 6520 3d20 7365 6c66 2e70 6970 656c 696e  e = self.pipelin
-0002d120: 650a 2020 2020 2020 2020 2020 2020 6669  e.            fi
-0002d130: 6e61 6c5f 7374 6570 203d 204e 6f6e 650a  nal_step = None.
-0002d140: 0a20 2020 2020 2020 2058 5f63 6f6c 756d  .        X_colum
-0002d150: 6e73 203d 2070 6970 656c 696e 652e 6665  ns = pipeline.fe
-0002d160: 6174 7572 655f 6e61 6d65 735f 696e 5f5b  ature_names_in_[
-0002d170: 3a2d 315d 0a20 2020 2020 2020 2079 5f6e  :-1].        y_n
-0002d180: 616d 6520 3d20 7069 7065 6c69 6e65 2e66  ame = pipeline.f
-0002d190: 6561 7475 7265 5f6e 616d 6573 5f69 6e5f  eature_names_in_
-0002d1a0: 5b2d 315d 0a20 2020 2020 2020 2079 5f74  [-1].        y_t
-0002d1b0: 6573 745f 203d 204e 6f6e 650a 2020 2020  est_ = None.    
-0002d1c0: 2020 2020 6966 2064 6174 6120 6973 204e      if data is N
-0002d1d0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0002d1e0: 2058 5f74 6573 745f 2c20 795f 7465 7374   X_test_, y_test
-0002d1f0: 5f20 3d20 7365 6c66 2e58 5f74 6573 745f  _ = self.X_test_
-0002d200: 7472 616e 7366 6f72 6d65 642c 2073 656c  transformed, sel
-0002d210: 662e 795f 7465 7374 5f74 7261 6e73 666f  f.y_test_transfo
-0002d220: 726d 6564 0a20 2020 2020 2020 2020 2020  rmed.           
-0002d230: 2058 5f74 6573 745f 756e 7472 616e 7366   X_test_untransf
-0002d240: 6f72 6d65 642c 2079 5f74 6573 745f 756e  ormed, y_test_un
-0002d250: 7472 616e 7366 6f72 6d65 6420 3d20 7365  transformed = se
-0002d260: 6c66 2e58 5f74 6573 742c 2073 656c 662e  lf.X_test, self.
-0002d270: 795f 7465 7374 0a20 2020 2020 2020 2065  y_test.        e
-0002d280: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0002d290: 2069 6620 795f 6e61 6d65 2069 6e20 6461   if y_name in da
-0002d2a0: 7461 2e63 6f6c 756d 6e73 3a0a 2020 2020  ta.columns:.    
-0002d2b0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0002d2c0: 203d 2073 656c 662e 5f73 6574 5f69 6e64   = self._set_ind
-0002d2d0: 6578 2873 656c 662e 5f70 7265 7061 7265  ex(self._prepare
-0002d2e0: 5f64 6174 6173 6574 2864 6174 612c 2079  _dataset(data, y
-0002d2f0: 5f6e 616d 6529 290a 2020 2020 2020 2020  _name)).        
-0002d300: 2020 2020 2020 2020 7461 7267 6574 203d          target =
-0002d310: 2064 6174 615b 795f 6e61 6d65 5d0a 2020   data[y_name].  
-0002d320: 2020 2020 2020 2020 2020 2020 2020 6461                da
-0002d330: 7461 203d 2064 6174 612e 6472 6f70 2879  ta = data.drop(y
-0002d340: 5f6e 616d 652c 2061 7869 733d 3129 0a20  _name, axis=1). 
-0002d350: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0002d360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d370: 2064 6174 6120 3d20 7365 6c66 2e5f 7365   data = self._se
-0002d380: 745f 696e 6465 7828 7365 6c66 2e5f 7072  t_index(self._pr
-0002d390: 6570 6172 655f 6461 7461 7365 7428 6461  epare_dataset(da
-0002d3a0: 7461 2929 0a20 2020 2020 2020 2020 2020  ta)).           
-0002d3b0: 2020 2020 2074 6172 6765 7420 3d20 4e6f       target = No
-0002d3c0: 6e65 0a20 2020 2020 2020 2020 2020 2058  ne.            X
-0002d3d0: 5f74 6573 745f 756e 7472 616e 7366 6f72  _test_untransfor
-0002d3e0: 6d65 6420 3d20 6461 7461 0a20 2020 2020  med = data.     
-0002d3f0: 2020 2020 2020 2079 5f74 6573 745f 756e         y_test_un
-0002d400: 7472 616e 7366 6f72 6d65 6420 3d20 7461  transformed = ta
-0002d410: 7267 6574 0a20 2020 2020 2020 2020 2020  rget.           
-0002d420: 2064 6174 6120 3d20 6461 7461 5b58 5f63   data = data[X_c
-0002d430: 6f6c 756d 6e73 5d20 2023 2049 676e 6f72  olumns]  # Ignor
-0002d440: 6520 616c 6c20 636f 6c75 6d6e 7320 6275  e all columns bu
-0002d450: 7420 7468 6520 6f72 6967 696e 616c 730a  t the originals.
-0002d460: 2020 2020 2020 2020 2020 2020 6966 2070              if p
-0002d470: 7265 7072 6f63 6573 733a 0a20 2020 2020  reprocess:.     
-0002d480: 2020 2020 2020 2020 2020 2058 5f74 6573             X_tes
-0002d490: 745f 203d 2070 6970 656c 696e 652e 7472  t_ = pipeline.tr
-0002d4a0: 616e 7366 6f72 6d28 0a20 2020 2020 2020  ansform(.       
-0002d4b0: 2020 2020 2020 2020 2020 2020 2058 3d64               X=d
-0002d4c0: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
-0002d4d0: 2020 2020 2020 2020 2079 3d28 7461 7267           y=(targ
-0002d4e0: 6574 2069 6620 7072 6570 726f 6365 7373  et if preprocess
-0002d4f0: 2021 3d20 2266 6561 7475 7265 7322 2065   != "features" e
-0002d500: 6c73 6520 4e6f 6e65 292c 0a20 2020 2020  lse None),.     
-0002d510: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0002d520: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0002d530: 6669 6e61 6c5f 7374 6570 3a0a 2020 2020  final_step:.    
-0002d540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d550: 7069 7065 6c69 6e65 2e73 7465 7073 2e61  pipeline.steps.a
-0002d560: 7070 656e 6428 6669 6e61 6c5f 7374 6570  ppend(final_step
-0002d570: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-0002d580: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0002d590: 2858 5f74 6573 745f 2c20 7475 706c 6529  (X_test_, tuple)
-0002d5a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002d5b0: 2020 2020 2020 585f 7465 7374 5f2c 2079        X_test_, y
-0002d5c0: 5f74 6573 745f 203d 2058 5f74 6573 745f  _test_ = X_test_
-0002d5d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d5e0: 2065 6c69 6620 7461 7267 6574 2069 7320   elif target is 
-0002d5f0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0002d600: 2020 2020 2020 2020 2020 2020 2020 795f                y_
-0002d610: 7465 7374 5f20 3d20 7461 7267 6574 0a20  test_ = target. 
-0002d620: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0002d630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d640: 2058 5f74 6573 745f 203d 2064 6174 610a   X_test_ = data.
-0002d650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d660: 795f 7465 7374 5f20 3d20 7461 7267 6574  y_test_ = target
-0002d670: 0a0a 2020 2020 2020 2020 2320 7072 6564  ..        # pred
-0002d680: 6963 7469 6f6e 2073 7461 7274 7320 6865  iction starts he
-0002d690: 7265 0a20 2020 2020 2020 2069 6620 6973  re.        if is
-0002d6a0: 696e 7374 616e 6365 2865 7374 696d 6174  instance(estimat
-0002d6b0: 6f72 2c20 4375 7374 6f6d 5072 6f62 6162  or, CustomProbab
-0002d6c0: 696c 6974 7954 6872 6573 686f 6c64 436c  ilityThresholdCl
-0002d6d0: 6173 7369 6669 6572 293a 0a20 2020 2020  assifier):.     
-0002d6e0: 2020 2020 2020 2069 6620 7072 6f62 6162         if probab
-0002d6f0: 696c 6974 795f 7468 7265 7368 6f6c 6420  ility_threshold 
-0002d700: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0002d710: 2020 2020 2020 2020 2070 726f 6261 6269           probabi
-0002d720: 6c69 7479 5f74 6872 6573 686f 6c64 203d  lity_threshold =
-0002d730: 2065 7374 696d 6174 6f72 2e70 726f 6261   estimator.proba
-0002d740: 6269 6c69 7479 5f74 6872 6573 686f 6c64  bility_threshold
-0002d750: 0a20 2020 2020 2020 2020 2020 2065 7374  .            est
-0002d760: 696d 6174 6f72 203d 2067 6574 5f65 7374  imator = get_est
-0002d770: 696d 6174 6f72 5f66 726f 6d5f 6d65 7461  imator_from_meta
-0002d780: 5f65 7374 696d 6174 6f72 2865 7374 696d  _estimator(estim
-0002d790: 6174 6f72 290a 0a20 2020 2020 2020 2070  ator)..        p
-0002d7a0: 7265 6420 3d20 6e70 2e6e 616e 5f74 6f5f  red = np.nan_to_
-0002d7b0: 6e75 6d28 6573 7469 6d61 746f 722e 7072  num(estimator.pr
-0002d7c0: 6564 6963 7428 585f 7465 7374 5f29 290a  edict(X_test_)).
-0002d7d0: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
-0002d7e0: 2020 2020 2020 2020 2020 7363 6f72 6520            score 
-0002d7f0: 3d20 6573 7469 6d61 746f 722e 7072 6564  = estimator.pred
-0002d800: 6963 745f 7072 6f62 6128 585f 7465 7374  ict_proba(X_test
-0002d810: 5f29 0a0a 2020 2020 2020 2020 2020 2020  _)..            
-0002d820: 6966 206c 656e 286e 702e 756e 6971 7565  if len(np.unique
-0002d830: 2870 7265 6429 2920 3c3d 2032 3a0a 2020  (pred)) <= 2:.  
-0002d840: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0002d850: 6564 5f70 726f 6220 3d20 7363 6f72 655b  ed_prob = score[
-0002d860: 3a2c 2031 5d0a 2020 2020 2020 2020 2020  :, 1].          
-0002d870: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0002d880: 2020 2020 2020 2020 7072 6564 5f70 726f          pred_pro
-0002d890: 6220 3d20 7363 6f72 650a 0a20 2020 2020  b = score..     
-0002d8a0: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
-0002d8b0: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
-0002d8c0: 2073 636f 7265 203d 204e 6f6e 650a 2020   score = None.  
-0002d8d0: 2020 2020 2020 2020 2020 7072 6564 5f70            pred_p
-0002d8e0: 726f 6220 3d20 4e6f 6e65 0a0a 2020 2020  rob = None..    
-0002d8f0: 2020 2020 6966 2070 726f 6261 6269 6c69      if probabili
-0002d900: 7479 5f74 6872 6573 686f 6c64 2069 7320  ty_threshold is 
-0002d910: 6e6f 7420 4e6f 6e65 2061 6e64 2070 7265  not None and pre
-0002d920: 645f 7072 6f62 2069 7320 6e6f 7420 4e6f  d_prob is not No
-0002d930: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0002d940: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-0002d950: 2020 2020 2070 7265 6420 3d20 2870 7265       pred = (pre
-0002d960: 645f 7072 6f62 203e 3d20 7072 6f62 6162  d_prob >= probab
-0002d970: 696c 6974 795f 7468 7265 7368 6f6c 6429  ility_threshold)
-0002d980: 2e61 7374 7970 6528 696e 7429 0a20 2020  .astype(int).   
-0002d990: 2020 2020 2020 2020 2065 7863 6570 7420           except 
-0002d9a0: 4578 6365 7074 696f 6e3a 0a20 2020 2020  Exception:.     
-0002d9b0: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
-0002d9c0: 0a20 2020 2020 2020 2069 6620 7072 6564  .        if pred
-0002d9d0: 5f70 726f 6220 6973 204e 6f6e 653a 0a20  _prob is None:. 
-0002d9e0: 2020 2020 2020 2020 2020 2070 7265 645f             pred_
-0002d9f0: 7072 6f62 203d 2070 7265 640a 0a20 2020  prob = pred..   
-0002da00: 2020 2020 2064 665f 7363 6f72 6520 3d20       df_score = 
-0002da10: 4e6f 6e65 0a20 2020 2020 2020 2069 6620  None.        if 
-0002da20: 795f 7465 7374 5f20 6973 206e 6f74 204e  y_test_ is not N
-0002da30: 6f6e 6520 616e 6420 7365 6c66 2e5f 7365  one and self._se
-0002da40: 7475 705f 7261 6e3a 0a20 2020 2020 2020  tup_ran:.       
-0002da50: 2020 2020 2023 206d 6f64 656c 206e 616d       # model nam
-0002da60: 650a 2020 2020 2020 2020 2020 2020 6675  e.            fu
-0002da70: 6c6c 5f6e 616d 6520 3d20 7365 6c66 2e5f  ll_name = self._
-0002da80: 6765 745f 6d6f 6465 6c5f 6e61 6d65 2865  get_model_name(e
-0002da90: 7374 696d 6174 6f72 290a 2020 2020 2020  stimator).      
-0002daa0: 2020 2020 2020 6d65 7472 6963 7320 3d20        metrics = 
-0002dab0: 7365 6c66 2e5f 6361 6c63 756c 6174 655f  self._calculate_
-0002dac0: 6d65 7472 6963 7328 795f 7465 7374 5f2c  metrics(y_test_,
-0002dad0: 2070 7265 642c 2070 7265 645f 7072 6f62   pred, pred_prob
-0002dae0: 2920 2023 2074 7970 653a 2069 676e 6f72  )  # type: ignor
-0002daf0: 650a 2020 2020 2020 2020 2020 2020 6466  e.            df
-0002db00: 5f73 636f 7265 203d 2070 642e 4461 7461  _score = pd.Data
-0002db10: 4672 616d 6528 6d65 7472 6963 732c 2069  Frame(metrics, i
-0002db20: 6e64 6578 3d5b 305d 290a 2020 2020 2020  ndex=[0]).      
-0002db30: 2020 2020 2020 6466 5f73 636f 7265 2e69        df_score.i
-0002db40: 6e73 6572 7428 302c 2022 4d6f 6465 6c22  nsert(0, "Model"
-0002db50: 2c20 6675 6c6c 5f6e 616d 6529 0a20 2020  , full_name).   
-0002db60: 2020 2020 2020 2020 2064 665f 7363 6f72           df_scor
-0002db70: 6520 3d20 6466 5f73 636f 7265 2e72 6f75  e = df_score.rou
-0002db80: 6e64 2872 6f75 6e64 290a 2020 2020 2020  nd(round).      
-0002db90: 2020 2020 2020 6469 7370 6c61 792e 6469        display.di
-0002dba0: 7370 6c61 7928 6466 5f73 636f 7265 2e73  splay(df_score.s
-0002dbb0: 7479 6c65 2e66 6f72 6d61 7428 7072 6563  tyle.format(prec
-0002dbc0: 6973 696f 6e3d 726f 756e 6429 290a 0a20  ision=round)).. 
-0002dbd0: 2020 2020 2020 206c 6162 656c 203d 2070         label = p
-0002dbe0: 642e 4461 7461 4672 616d 6528 0a20 2020  d.DataFrame(.   
-0002dbf0: 2020 2020 2020 2020 2070 7265 642c 2063           pred, c
-0002dc00: 6f6c 756d 6e73 3d5b 4c41 4245 4c5f 434f  olumns=[LABEL_CO
-0002dc10: 4c55 4d4e 5d2c 2069 6e64 6578 3d58 5f74  LUMN], index=X_t
-0002dc20: 6573 745f 756e 7472 616e 7366 6f72 6d65  est_untransforme
-0002dc30: 642e 696e 6465 780a 2020 2020 2020 2020  d.index.        
-0002dc40: 290a 2020 2020 2020 2020 6966 206d 6c5f  ).        if ml_
-0002dc50: 7573 6563 6173 6520 3d3d 204d 4c55 7365  usecase == MLUse
-0002dc60: 6361 7365 2e43 4c41 5353 4946 4943 4154  case.CLASSIFICAT
-0002dc70: 494f 4e3a 0a20 2020 2020 2020 2020 2020  ION:.           
-0002dc80: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-0002dc90: 2020 2020 2020 6c61 6265 6c5b 4c41 4245        label[LABE
-0002dca0: 4c5f 434f 4c55 4d4e 5d20 3d20 6c61 6265  L_COLUMN] = labe
-0002dcb0: 6c5b 4c41 4245 4c5f 434f 4c55 4d4e 5d2e  l[LABEL_COLUMN].
-0002dcc0: 6173 7479 7065 2869 6e74 290a 2020 2020  astype(int).    
-0002dcd0: 2020 2020 2020 2020 6578 6365 7074 2045          except E
-0002dce0: 7863 6570 7469 6f6e 3a0a 2020 2020 2020  xception:.      
-0002dcf0: 2020 2020 2020 2020 2020 7061 7373 0a0a            pass..
-0002dd00: 2020 2020 2020 2020 6966 206e 6f74 2065          if not e
-0002dd10: 6e63 6f64 6564 5f6c 6162 656c 733a 0a20  ncoded_labels:. 
-0002dd20: 2020 2020 2020 2020 2020 206c 6162 656c             label
-0002dd30: 5b4c 4142 454c 5f43 4f4c 554d 4e5d 203d  [LABEL_COLUMN] =
-0002dd40: 2072 6570 6c61 6365 5f6c 6162 656c 735f   replace_labels_
-0002dd50: 696e 5f63 6f6c 756d 6e28 0a20 2020 2020  in_column(.     
-0002dd60: 2020 2020 2020 2020 2020 2070 6970 656c             pipel
-0002dd70: 696e 652c 206c 6162 656c 5b4c 4142 454c  ine, label[LABEL
-0002dd80: 5f43 4f4c 554d 4e5d 0a20 2020 2020 2020  _COLUMN].       
-0002dd90: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
-0002dda0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0002ddb0: 2079 5f74 6573 745f 756e 7472 616e 7366   y_test_untransf
-0002ddc0: 6f72 6d65 6420 3d20 795f 7465 7374 5f0a  ormed = y_test_.
-0002ddd0: 2020 2020 2020 2020 6f6c 645f 696e 6465          old_inde
-0002dde0: 7820 3d20 585f 7465 7374 5f75 6e74 7261  x = X_test_untra
-0002ddf0: 6e73 666f 726d 6564 2e69 6e64 6578 0a20  nsformed.index. 
-0002de00: 2020 2020 2020 2058 5f74 6573 745f 203d         X_test_ =
-0002de10: 2070 642e 636f 6e63 6174 285b 585f 7465   pd.concat([X_te
-0002de20: 7374 5f75 6e74 7261 6e73 666f 726d 6564  st_untransformed
-0002de30: 2c20 795f 7465 7374 5f75 6e74 7261 6e73  , y_test_untrans
-0002de40: 666f 726d 6564 2c20 6c61 6265 6c5d 2c20  formed, label], 
-0002de50: 6178 6973 3d31 290a 2020 2020 2020 2020  axis=1).        
-0002de60: 585f 7465 7374 5f2e 696e 6465 7820 3d20  X_test_.index = 
-0002de70: 6f6c 645f 696e 6465 780a 0a20 2020 2020  old_index..     
-0002de80: 2020 2069 6620 7363 6f72 6520 6973 206e     if score is n
-0002de90: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0002dea0: 2020 2020 2070 7265 6420 3d20 7072 6564       pred = pred
-0002deb0: 2e61 7374 7970 6528 696e 7429 0a0a 2020  .astype(int)..  
-0002dec0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0002ded0: 2072 6177 5f73 636f 7265 3a0a 2020 2020   raw_score:.    
-0002dee0: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
-0002def0: 6520 3d20 7064 2e44 6174 6146 7261 6d65  e = pd.DataFrame
-0002df00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002df10: 2020 2020 2020 6461 7461 3d5b 735b 7072        data=[s[pr
-0002df20: 6564 5b69 5d5d 2066 6f72 2069 2c20 7320  ed[i]] for i, s 
-0002df30: 696e 2065 6e75 6d65 7261 7465 2873 636f  in enumerate(sco
-0002df40: 7265 295d 2c0a 2020 2020 2020 2020 2020  re)],.          
-0002df50: 2020 2020 2020 2020 2020 696e 6465 783d            index=
-0002df60: 585f 7465 7374 5f2e 696e 6465 782c 0a20  X_test_.index,. 
-0002df70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002df80: 2020 2063 6f6c 756d 6e73 3d5b 5343 4f52     columns=[SCOR
-0002df90: 455f 434f 4c55 4d4e 5d2c 0a20 2020 2020  E_COLUMN],.     
-0002dfa0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0002dfb0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0002dfc0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0002dfd0: 6620 6e6f 7420 656e 636f 6465 645f 6c61  f not encoded_la
-0002dfe0: 6265 6c73 3a0a 2020 2020 2020 2020 2020  bels:.          
-0002dff0: 2020 2020 2020 2020 2020 6c65 203d 2067            le = g
-0002e000: 6574 5f6c 6162 656c 5f65 6e63 6f64 6572  et_label_encoder
-0002e010: 2870 6970 656c 696e 6529 0a20 2020 2020  (pipeline).     
-0002e020: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0002e030: 6620 6c65 3a0a 2020 2020 2020 2020 2020  f le:.          
-0002e040: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0002e050: 6c75 6d6e 7320 3d20 6c65 2e63 6c61 7373  lumns = le.class
-0002e060: 6573 5f0a 2020 2020 2020 2020 2020 2020  es_.            
-0002e070: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0002e080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e090: 2020 2020 2020 636f 6c75 6d6e 7320 3d20        columns = 
-0002e0a0: 7261 6e67 6528 7363 6f72 652e 7368 6170  range(score.shap
-0002e0b0: 655b 315d 290a 2020 2020 2020 2020 2020  e[1]).          
-0002e0c0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0002e0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e0e0: 636f 6c75 6d6e 7320 3d20 7261 6e67 6528  columns = range(
-0002e0f0: 7363 6f72 652e 7368 6170 655b 315d 290a  score.shape[1]).
-0002e100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002e110: 2073 636f 7265 203d 2070 642e 4461 7461   score = pd.Data
-0002e120: 4672 616d 6528 0a20 2020 2020 2020 2020  Frame(.         
-0002e130: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-0002e140: 7363 6f72 652c 0a20 2020 2020 2020 2020  score,.         
-0002e150: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-0002e160: 3d58 5f74 6573 745f 2e69 6e64 6578 2c0a  =X_test_.index,.
-0002e170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e180: 2020 2020 636f 6c75 6d6e 733d 5b66 227b      columns=[f"{
-0002e190: 5343 4f52 455f 434f 4c55 4d4e 7d5f 7b63  SCORE_COLUMN}_{c
-0002e1a0: 6f6c 7d22 2066 6f72 2063 6f6c 2069 6e20  ol}" for col in 
-0002e1b0: 636f 6c75 6d6e 735d 2c0a 2020 2020 2020  columns],.      
-0002e1c0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0002e1d0: 2020 2020 2020 2020 2073 636f 7265 203d           score =
-0002e1e0: 2073 636f 7265 2e72 6f75 6e64 2872 6f75   score.round(rou
-0002e1f0: 6e64 290a 2020 2020 2020 2020 2020 2020  nd).            
-0002e200: 585f 7465 7374 5f20 3d20 7064 2e63 6f6e  X_test_ = pd.con
-0002e210: 6361 7428 2858 5f74 6573 745f 2c20 7363  cat((X_test_, sc
-0002e220: 6f72 6529 2c20 6178 6973 3d31 290a 0a20  ore), axis=1).. 
-0002e230: 2020 2020 2020 2023 2073 746f 7265 2070         # store p
-0002e240: 7265 6469 6374 696f 6e73 206f 6e20 686f  redictions on ho
-0002e250: 6c64 2d6f 7574 2069 6e20 5f64 6973 706c  ld-out in _displ
-0002e260: 6179 5f63 6f6e 7461 696e 6572 0a20 2020  ay_container.   
-0002e270: 2020 2020 2069 6620 6466 5f73 636f 7265       if df_score
-0002e280: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0002e290: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0002e2a0: 6469 7370 6c61 795f 636f 6e74 6169 6e65  display_containe
-0002e2b0: 722e 6170 7065 6e64 2864 665f 7363 6f72  r.append(df_scor
-0002e2c0: 6529 0a0a 2020 2020 2020 2020 6763 2e63  e)..        gc.c
-0002e2d0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-0002e2e0: 2072 6574 7572 6e20 585f 7465 7374 5f0a   return X_test_.
-0002e2f0: 0a20 2020 2064 6566 2067 6574 5f6c 6561  .    def get_lea
-0002e300: 6465 7262 6f61 7264 280a 2020 2020 2020  derboard(.      
-0002e310: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0002e320: 6669 6e61 6c69 7a65 5f6d 6f64 656c 733a  finalize_models:
-0002e330: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
-0002e340: 2020 2020 2020 206d 6f64 656c 5f6f 6e6c         model_onl
-0002e350: 793a 2062 6f6f 6c20 3d20 4661 6c73 652c  y: bool = False,
-0002e360: 0a20 2020 2020 2020 2066 6974 5f6b 7761  .        fit_kwa
-0002e370: 7267 733a 204f 7074 696f 6e61 6c5b 6469  rgs: Optional[di
-0002e380: 6374 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ct] = None,.    
-0002e390: 2020 2020 6772 6f75 7073 3a20 4f70 7469      groups: Opti
-0002e3a0: 6f6e 616c 5b55 6e69 6f6e 5b73 7472 2c20  onal[Union[str, 
-0002e3b0: 416e 795d 5d20 3d20 4e6f 6e65 2c0a 2020  Any]] = None,.  
-0002e3c0: 2020 2020 2020 7665 7262 6f73 653a 2062        verbose: b
-0002e3d0: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
-0002e3e0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0002e3f0: 2020 2020 2020 2067 656e 6572 6174 6573         generates
-0002e400: 206c 6561 6465 7262 6f61 7264 2066 6f72   leaderboard for
-0002e410: 2061 6c6c 206d 6f64 656c 7320 7275 6e20   all models run 
-0002e420: 696e 2063 7572 7265 6e74 2072 756e 2e0a  in current run..
-0002e430: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0002e440: 2020 2020 6d6f 6465 6c5f 636f 6e74 6169      model_contai
-0002e450: 6e65 7220 3d20 7365 6c66 2e5f 6d61 7374  ner = self._mast
-0002e460: 6572 5f6d 6f64 656c 5f63 6f6e 7461 696e  er_model_contain
-0002e470: 6572 0a0a 2020 2020 2020 2020 7072 6f67  er..        prog
-0002e480: 7265 7373 5f61 7267 7320 3d20 7b22 6d61  ress_args = {"ma
-0002e490: 7822 3a20 6c65 6e28 6d6f 6465 6c5f 636f  x": len(model_co
-0002e4a0: 6e74 6169 6e65 7229 202b 2031 7d0a 2020  ntainer) + 1}.  
-0002e4b0: 2020 2020 2020 7469 6d65 7374 616d 7053        timestampS
-0002e4c0: 7472 203d 2064 6174 6574 696d 652e 6461  tr = datetime.da
-0002e4d0: 7465 7469 6d65 2e6e 6f77 2829 2e73 7472  tetime.now().str
-0002e4e0: 6674 696d 6528 2225 483a 254d 3a25 5322  ftime("%H:%M:%S"
-0002e4f0: 290a 2020 2020 2020 2020 6d6f 6e69 746f  ).        monito
-0002e500: 725f 726f 7773 203d 205b 0a20 2020 2020  r_rows = [.     
-0002e510: 2020 2020 2020 205b 2249 6e69 7469 6174         ["Initiat
-0002e520: 6564 222c 2022 2e20 2e20 2e20 2e20 2e20  ed", ". . . . . 
-0002e530: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
-0002e540: 2e20 2e20 2e20 2e20 2e22 2c20 7469 6d65  . . . . .", time
-0002e550: 7374 616d 7053 7472 5d2c 0a20 2020 2020  stampStr],.     
-0002e560: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-0002e570: 2020 2020 2020 2020 2022 5374 6174 7573           "Status
-0002e580: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0002e590: 2020 2022 2e20 2e20 2e20 2e20 2e20 2e20     ". . . . . . 
-0002e5a0: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
-0002e5b0: 2e20 2e20 2e20 2e22 2c0a 2020 2020 2020  . . . .",.      
-0002e5c0: 2020 2020 2020 2020 2020 224c 6f61 6469            "Loadi
-0002e5d0: 6e67 2044 6570 656e 6465 6e63 6965 7322  ng Dependencies"
-0002e5e0: 2c0a 2020 2020 2020 2020 2020 2020 5d2c  ,.            ],
-0002e5f0: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
-0002e600: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002e610: 4573 7469 6d61 746f 7222 2c0a 2020 2020  Estimator",.    
-0002e620: 2020 2020 2020 2020 2020 2020 222e 202e              ". .
-0002e630: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
-0002e640: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
-0002e650: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0002e660: 2020 2022 436f 6d70 696c 696e 6720 4c69     "Compiling Li
-0002e670: 6272 6172 7922 2c0a 2020 2020 2020 2020  brary",.        
-0002e680: 2020 2020 5d2c 0a20 2020 2020 2020 205d      ],.        ]
-0002e690: 0a20 2020 2020 2020 2064 6973 706c 6179  .        display
-0002e6a0: 203d 2043 6f6d 6d6f 6e44 6973 706c 6179   = CommonDisplay
-0002e6b0: 280a 2020 2020 2020 2020 2020 2020 7665  (.            ve
-0002e6c0: 7262 6f73 653d 7665 7262 6f73 652c 0a20  rbose=verbose,. 
-0002e6d0: 2020 2020 2020 2020 2020 2068 746d 6c5f             html_
-0002e6e0: 7061 7261 6d3d 7365 6c66 2e68 746d 6c5f  param=self.html_
-0002e6f0: 7061 7261 6d2c 0a20 2020 2020 2020 2020  param,.         
-0002e700: 2020 2070 726f 6772 6573 735f 6172 6773     progress_args
-0002e710: 3d70 726f 6772 6573 735f 6172 6773 2c0a  =progress_args,.
-0002e720: 2020 2020 2020 2020 2020 2020 6d6f 6e69              moni
-0002e730: 746f 725f 726f 7773 3d6d 6f6e 6974 6f72  tor_rows=monitor
-0002e740: 5f72 6f77 732c 0a20 2020 2020 2020 2029  _rows,.        )
-0002e750: 0a0a 2020 2020 2020 2020 7265 7375 6c74  ..        result
-0002e760: 5f63 6f6e 7461 696e 6572 5f6d 6561 6e20  _container_mean 
-0002e770: 3d20 5b5d 0a20 2020 2020 2020 2066 696e  = [].        fin
-0002e780: 616c 697a 6564 5f6d 6f64 656c 7320 3d20  alized_models = 
-0002e790: 5b5d 0a0a 2020 2020 2020 2020 6469 7370  []..        disp
-0002e7a0: 6c61 792e 7570 6461 7465 5f6d 6f6e 6974  lay.update_monit
-0002e7b0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0002e7c0: 312c 2022 4669 6e61 6c69 7a69 6e67 206d  1, "Finalizing m
-0002e7d0: 6f64 656c 7322 2069 6620 6669 6e61 6c69  odels" if finali
-0002e7e0: 7a65 5f6d 6f64 656c 7320 656c 7365 2022  ze_models else "
-0002e7f0: 436f 6c6c 6563 7469 6e67 206d 6f64 656c  Collecting model
-0002e800: 7322 0a20 2020 2020 2020 2029 0a20 2020  s".        ).   
-0002e810: 2020 2020 2066 6f72 2069 2c20 6d6f 6465       for i, mode
-0002e820: 6c5f 7265 7375 6c74 735f 7475 706c 6520  l_results_tuple 
-0002e830: 696e 2065 6e75 6d65 7261 7465 286d 6f64  in enumerate(mod
-0002e840: 656c 5f63 6f6e 7461 696e 6572 293a 0a0a  el_container):..
-0002e850: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-0002e860: 6c5f 7265 7375 6c74 7320 3d20 6d6f 6465  l_results = mode
-0002e870: 6c5f 7265 7375 6c74 735f 7475 706c 655b  l_results_tuple[
-0002e880: 2273 636f 7265 7322 5d0a 2020 2020 2020  "scores"].      
-0002e890: 2020 2020 2020 6d6f 6465 6c20 3d20 6d6f        model = mo
-0002e8a0: 6465 6c5f 7265 7375 6c74 735f 7475 706c  del_results_tupl
-0002e8b0: 655b 226d 6f64 656c 225d 0a20 2020 2020  e["model"].     
-0002e8c0: 2020 2020 2020 206d 6561 6e5f 7363 6f72         mean_scor
-0002e8d0: 6573 203d 206d 6f64 656c 5f72 6573 756c  es = model_resul
-0002e8e0: 7473 5b2d 323a 2d31 5d0a 2020 2020 2020  ts[-2:-1].      
-0002e8f0: 2020 2020 2020 6d6f 6465 6c5f 6e61 6d65        model_name
-0002e900: 203d 2073 656c 662e 5f67 6574 5f6d 6f64   = self._get_mod
-0002e910: 656c 5f6e 616d 6528 6d6f 6465 6c29 0a20  el_name(model). 
-0002e920: 2020 2020 2020 2020 2020 206d 6561 6e5f             mean_
-0002e930: 7363 6f72 6573 5b22 496e 6465 7822 5d20  scores["Index"] 
-0002e940: 3d20 690a 2020 2020 2020 2020 2020 2020  = i.            
-0002e950: 6d65 616e 5f73 636f 7265 735b 224d 6f64  mean_scores["Mod
-0002e960: 656c 204e 616d 6522 5d20 3d20 6d6f 6465  el Name"] = mode
-0002e970: 6c5f 6e61 6d65 0a20 2020 2020 2020 2020  l_name.         
-0002e980: 2020 2064 6973 706c 6179 2e75 7064 6174     display.updat
-0002e990: 655f 6d6f 6e69 746f 7228 322c 206d 6f64  e_monitor(2, mod
-0002e9a0: 656c 5f6e 616d 6529 0a20 2020 2020 2020  el_name).       
-0002e9b0: 2020 2020 2069 6620 6669 6e61 6c69 7a65       if finalize
-0002e9c0: 5f6d 6f64 656c 733a 0a20 2020 2020 2020  _models:.       
-0002e9d0: 2020 2020 2020 2020 206d 6f64 656c 203d           model =
-0002e9e0: 2073 656c 662e 6669 6e61 6c69 7a65 5f6d   self.finalize_m
-0002e9f0: 6f64 656c 280a 2020 2020 2020 2020 2020  odel(.          
-0002ea00: 2020 2020 2020 2020 2020 6d6f 6465 6c2c            model,
-0002ea10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ea20: 2020 2020 2066 6974 5f6b 7761 7267 733d       fit_kwargs=
-0002ea30: 6669 745f 6b77 6172 6773 2c0a 2020 2020  fit_kwargs,.    
-0002ea40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ea50: 6772 6f75 7073 3d67 726f 7570 732c 0a20  groups=groups,. 
-0002ea60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ea70: 2020 206d 6f64 656c 5f6f 6e6c 793d 6d6f     model_only=mo
-0002ea80: 6465 6c5f 6f6e 6c79 2c0a 2020 2020 2020  del_only,.      
-0002ea90: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0002eaa0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0002eab0: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0002eac0: 6465 6c20 3d20 6465 6570 636f 7079 286d  del = deepcopy(m
-0002ead0: 6f64 656c 290a 2020 2020 2020 2020 2020  odel).          
-0002eae0: 2020 2020 2020 6966 206e 6f74 2069 735f        if not is_
-0002eaf0: 6669 7474 6564 286d 6f64 656c 293a 0a20  fitted(model):. 
-0002eb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002eb10: 2020 206d 6f64 656c 2c20 5f20 3d20 7365     model, _ = se
-0002eb20: 6c66 2e5f 6372 6561 7465 5f6d 6f64 656c  lf._create_model
-0002eb30: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002eb40: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-0002eb50: 746f 723d 6d6f 6465 6c2c 0a20 2020 2020  tor=model,.     
-0002eb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002eb70: 2020 2076 6572 626f 7365 3d46 616c 7365     verbose=False
-0002eb80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002eb90: 2020 2020 2020 2020 2020 7379 7374 656d            system
-0002eba0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-0002ebb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ebc0: 6669 745f 6b77 6172 6773 3d66 6974 5f6b  fit_kwargs=fit_k
-0002ebd0: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
-0002ebe0: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-0002ebf0: 726f 7570 733d 6772 6f75 7073 2c0a 2020  roups=groups,.  
-0002ec00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ec10: 2020 2020 2020 6164 645f 746f 5f6d 6f64        add_to_mod
-0002ec20: 656c 5f6c 6973 743d 4661 6c73 652c 0a20  el_list=False,. 
-0002ec30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ec40: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0002ec50: 2020 2020 2069 6620 6e6f 7420 6d6f 6465       if not mode
-0002ec60: 6c5f 6f6e 6c79 3a0a 2020 2020 2020 2020  l_only:.        
-0002ec70: 2020 2020 2020 2020 2020 2020 7069 7065              pipe
-0002ec80: 6c69 6e65 203d 2064 6565 7063 6f70 7928  line = deepcopy(
-0002ec90: 7365 6c66 2e70 6970 656c 696e 6529 0a20  self.pipeline). 
-0002eca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ecb0: 2020 2070 6970 656c 696e 652e 7374 6570     pipeline.step
-0002ecc0: 732e 6170 7065 6e64 285b 2274 7261 696e  s.append(["train
-0002ecd0: 6564 5f6d 6f64 656c 222c 206d 6f64 656c  ed_model", model
-0002ece0: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
-0002ecf0: 2020 2020 2020 206d 6f64 656c 203d 2070         model = p
-0002ed00: 6970 656c 696e 650a 2020 2020 2020 2020  ipeline.        
-0002ed10: 2020 2020 6469 7370 6c61 792e 6d6f 7665      display.move
-0002ed20: 5f70 726f 6772 6573 7328 290a 2020 2020  _progress().    
-0002ed30: 2020 2020 2020 2020 6669 6e61 6c69 7a65          finalize
-0002ed40: 645f 6d6f 6465 6c73 2e61 7070 656e 6428  d_models.append(
-0002ed50: 6d6f 6465 6c29 0a20 2020 2020 2020 2020  model).         
-0002ed60: 2020 2072 6573 756c 745f 636f 6e74 6169     result_contai
-0002ed70: 6e65 725f 6d65 616e 2e61 7070 656e 6428  ner_mean.append(
-0002ed80: 6d65 616e 5f73 636f 7265 7329 0a0a 2020  mean_scores)..  
-0002ed90: 2020 2020 2020 6469 7370 6c61 792e 7570        display.up
-0002eda0: 6461 7465 5f6d 6f6e 6974 6f72 2831 2c20  date_monitor(1, 
-0002edb0: 2243 7265 6174 696e 6720 6461 7461 6672  "Creating datafr
-0002edc0: 616d 6522 290a 2020 2020 2020 2020 7265  ame").        re
-0002edd0: 7375 6c74 7320 3d20 7064 2e63 6f6e 6361  sults = pd.conca
-0002ede0: 7428 7265 7375 6c74 5f63 6f6e 7461 696e  t(result_contain
-0002edf0: 6572 5f6d 6561 6e29 0a20 2020 2020 2020  er_mean).       
-0002ee00: 2072 6573 756c 7473 5b22 4d6f 6465 6c22   results["Model"
-0002ee10: 5d20 3d20 6c69 7374 2872 616e 6765 286c  ] = list(range(l
-0002ee20: 656e 2872 6573 756c 7473 2929 290a 2020  en(results))).  
-0002ee30: 2020 2020 2020 7265 7375 6c74 735b 224d        results["M
-0002ee40: 6f64 656c 225d 203d 2072 6573 756c 7473  odel"] = results
-0002ee50: 5b22 4d6f 6465 6c22 5d2e 6173 7479 7065  ["Model"].astype
-0002ee60: 2822 6f62 6a65 6374 2229 0a20 2020 2020  ("object").     
-0002ee70: 2020 206d 6f64 656c 5f6c 6f63 203d 2072     model_loc = r
-0002ee80: 6573 756c 7473 2e63 6f6c 756d 6e73 2e67  esults.columns.g
-0002ee90: 6574 5f6c 6f63 2822 4d6f 6465 6c22 290a  et_loc("Model").
-0002eea0: 2020 2020 2020 2020 666f 7220 7820 696e          for x in
-0002eeb0: 2072 616e 6765 286c 656e 2872 6573 756c   range(len(resul
-0002eec0: 7473 2929 3a0a 2020 2020 2020 2020 2020  ts)):.          
-0002eed0: 2020 7265 7375 6c74 732e 6961 745b 782c    results.iat[x,
-0002eee0: 206d 6f64 656c 5f6c 6f63 5d20 3d20 6669   model_loc] = fi
-0002eef0: 6e61 6c69 7a65 645f 6d6f 6465 6c73 5b78  nalized_models[x
-0002ef00: 5d0a 2020 2020 2020 2020 7265 6172 7261  ].        rearra
-0002ef10: 6e67 6564 5f63 6f6c 756d 6e73 203d 206c  nged_columns = l
-0002ef20: 6973 7428 7265 7375 6c74 732e 636f 6c75  ist(results.colu
-0002ef30: 6d6e 7329 0a20 2020 2020 2020 2072 6561  mns).        rea
-0002ef40: 7272 616e 6765 645f 636f 6c75 6d6e 732e  rranged_columns.
-0002ef50: 7265 6d6f 7665 2822 4d6f 6465 6c22 290a  remove("Model").
-0002ef60: 2020 2020 2020 2020 7265 6172 7261 6e67          rearrang
-0002ef70: 6564 5f63 6f6c 756d 6e73 2e72 656d 6f76  ed_columns.remov
-0002ef80: 6528 224d 6f64 656c 204e 616d 6522 290a  e("Model Name").
-0002ef90: 2020 2020 2020 2020 7265 6172 7261 6e67          rearrang
-0002efa0: 6564 5f63 6f6c 756d 6e73 203d 205b 224d  ed_columns = ["M
-0002efb0: 6f64 656c 204e 616d 6522 2c20 224d 6f64  odel Name", "Mod
-0002efc0: 656c 225d 202b 2072 6561 7272 616e 6765  el"] + rearrange
-0002efd0: 645f 636f 6c75 6d6e 730a 2020 2020 2020  d_columns.      
-0002efe0: 2020 7265 7375 6c74 7320 3d20 7265 7375    results = resu
-0002eff0: 6c74 735b 7265 6172 7261 6e67 6564 5f63  lts[rearranged_c
-0002f000: 6f6c 756d 6e73 5d0a 2020 2020 2020 2020  olumns].        
-0002f010: 7265 7375 6c74 732e 7365 745f 696e 6465  results.set_inde
-0002f020: 7828 2249 6e64 6578 222c 2069 6e70 6c61  x("Index", inpla
-0002f030: 6365 3d54 7275 652c 2064 726f 703d 5472  ce=True, drop=Tr
-0002f040: 7565 290a 2020 2020 2020 2020 6469 7370  ue).        disp
-0002f050: 6c61 792e 636c 6f73 6528 290a 2020 2020  lay.close().    
-0002f060: 2020 2020 2320 6469 7370 6c61 792e 636c      # display.cl
-0002f070: 6561 725f 6f75 7470 7574 2829 0a20 2020  ear_output().   
-0002f080: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
-0002f090: 6c74 730a 0a20 2020 2064 6566 2063 6865  lts..    def che
-0002f0a0: 636b 5f66 6169 726e 6573 7328 0a20 2020  ck_fairness(.   
-0002f0b0: 2020 2020 2073 656c 662c 2065 7374 696d       self, estim
-0002f0c0: 6174 6f72 2c20 7365 6e73 6974 6976 655f  ator, sensitive_
-0002f0d0: 6665 6174 7572 6573 3a20 6c69 7374 2c20  features: list, 
-0002f0e0: 706c 6f74 5f6b 7761 7267 733a 2064 6963  plot_kwargs: dic
-0002f0f0: 7420 3d20 7b7d 0a20 2020 2029 3a0a 0a20  t = {}.    ):.. 
-0002f100: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002f110: 2020 2054 6865 7265 2061 7265 206d 616e     There are man
-0002f120: 7920 6170 7072 6f61 6368 6573 2074 6f20  y approaches to 
-0002f130: 636f 6e63 6570 7475 616c 697a 696e 6720  conceptualizing 
-0002f140: 6661 6972 6e65 7373 2e20 5468 6973 2066  fairness. This f
-0002f150: 756e 6374 696f 6e20 666f 6c6c 6f77 730a  unction follows.
-0002f160: 2020 2020 2020 2020 7468 6520 6170 7072          the appr
-0002f170: 6f61 6368 206b 6e6f 776e 2061 7320 6772  oach known as gr
-0002f180: 6f75 7020 6661 6972 6e65 7373 2c20 7768  oup fairness, wh
-0002f190: 6963 6820 6173 6b73 3a20 5768 6963 6820  ich asks: Which 
-0002f1a0: 6772 6f75 7073 206f 6620 696e 6469 7669  groups of indivi
-0002f1b0: 6475 616c 730a 2020 2020 2020 2020 6172  duals.        ar
-0002f1c0: 6520 6174 2072 6973 6b20 666f 7220 6578  e at risk for ex
-0002f1d0: 7065 7269 656e 6369 6e67 2068 6172 6d73  periencing harms
-0002f1e0: 2e20 5468 6973 2066 756e 6374 696f 6e20  . This function 
-0002f1f0: 7072 6f76 6964 6573 2066 6169 726e 6573  provides fairnes
-0002f200: 732d 7265 6c61 7465 640a 2020 2020 2020  s-related.      
-0002f210: 2020 6d65 7472 6963 7320 6265 7477 6565    metrics betwee
-0002f220: 6e20 6469 6666 6572 656e 7420 6772 6f75  n different grou
-0002f230: 7073 2028 616c 736f 2063 616c 6c65 6420  ps (also called 
-0002f240: 7375 6270 6f70 756c 6174 696f 6e29 2e0a  subpopulation)..
-0002f250: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-0002f260: 650a 2020 2020 2020 2020 2d2d 2d2d 2d2d  e.        ------
-0002f270: 2d0a 2020 2020 2020 2020 3e3e 3e20 6672  -.        >>> fr
-0002f280: 6f6d 2070 7963 6172 6574 2e64 6174 6173  om pycaret.datas
-0002f290: 6574 7320 696d 706f 7274 2067 6574 5f64  ets import get_d
-0002f2a0: 6174 610a 2020 2020 2020 2020 3e3e 3e20  ata.        >>> 
-0002f2b0: 696e 636f 6d65 203d 2067 6574 5f64 6174  income = get_dat
-0002f2c0: 6128 2769 6e63 6f6d 6527 290a 2020 2020  a('income').    
-0002f2d0: 2020 2020 3e3e 3e20 6672 6f6d 2070 7963      >>> from pyc
-0002f2e0: 6172 6574 2e63 6c61 7373 6966 6963 6174  aret.classificat
-0002f2f0: 696f 6e20 696d 706f 7274 202a 0a20 2020  ion import *.   
-0002f300: 2020 2020 203e 3e3e 2065 7870 5f6e 616d       >>> exp_nam
-0002f310: 6520 3d20 7365 7475 7028 6461 7461 203d  e = setup(data =
-0002f320: 2069 6e63 6f6d 652c 2020 7461 7267 6574   income,  target
-0002f330: 203d 2027 696e 636f 6d65 203e 3530 4b27   = 'income >50K'
-0002f340: 290a 2020 2020 2020 2020 3e3e 3e20 6c72  ).        >>> lr
-0002f350: 203d 2063 7265 6174 655f 6d6f 6465 6c28   = create_model(
-0002f360: 276c 7227 290a 2020 2020 2020 2020 3e3e  'lr').        >>
-0002f370: 3e20 6c72 5f66 6169 726e 6573 7320 3d20  > lr_fairness = 
-0002f380: 6368 6563 6b5f 6661 6972 6e65 7373 286c  check_fairness(l
-0002f390: 722c 2073 656e 7369 7469 7665 5f66 6561  r, sensitive_fea
-0002f3a0: 7475 7265 7320 3d20 5b27 7365 7827 2c20  tures = ['sex', 
-0002f3b0: 2772 6163 6527 5d29 0a0a 0a20 2020 2020  'race'])...     
-0002f3c0: 2020 2065 7374 696d 6174 6f72 3a20 7363     estimator: sc
-0002f3d0: 696b 6974 2d6c 6561 726e 2063 6f6d 7061  ikit-learn compa
-0002f3e0: 7469 626c 6520 6f62 6a65 6374 0a20 2020  tible object.   
-0002f3f0: 2020 2020 2020 2020 2054 7261 696e 6564           Trained
-0002f400: 206d 6f64 656c 206f 626a 6563 740a 0a0a   model object...
-0002f410: 2020 2020 2020 2020 7365 6e73 6974 6976          sensitiv
-0002f420: 655f 6665 6174 7572 6573 3a20 6c69 7374  e_features: list
-0002f430: 0a20 2020 2020 2020 2020 2020 204c 6973  .            Lis
-0002f440: 7420 6f66 2063 6f6c 756d 6e20 6e61 6d65  t of column name
-0002f450: 7320 6173 2070 7265 7365 6e74 2069 6e20  s as present in 
-0002f460: 7468 6520 6f72 6967 696e 616c 2064 6174  the original dat
-0002f470: 6173 6574 2062 6566 6f72 6520 616e 790a  aset before any.
-0002f480: 2020 2020 2020 2020 2020 2020 7472 616e              tran
-0002f490: 7366 6f72 6d61 7469 6f6e 732e 0a0a 0a20  sformations.... 
-0002f4a0: 2020 2020 2020 2070 6c6f 745f 6b77 6172         plot_kwar
-0002f4b0: 6773 3a20 6469 6374 2c20 6465 6661 756c  gs: dict, defaul
-0002f4c0: 7420 3d20 7b7d 2028 656d 7074 7920 6469  t = {} (empty di
-0002f4d0: 6374 290a 2020 2020 2020 2020 2020 2020  ct).            
-0002f4e0: 4469 6374 696f 6e61 7279 206f 6620 6172  Dictionary of ar
-0002f4f0: 6775 6d65 6e74 7320 7061 7373 6564 2074  guments passed t
-0002f500: 6f20 7468 6520 6d61 7470 6c6f 746c 6962  o the matplotlib
-0002f510: 2070 6c6f 742e 0a0a 0a20 2020 2020 2020   plot....       
-0002f520: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
-0002f530: 2020 2020 2020 7061 6e64 6173 2e44 6174        pandas.Dat
-0002f540: 6146 7261 6d65 0a0a 2020 2020 2020 2020  aFrame..        
-0002f550: 2222 220a 0a20 2020 2020 2020 205f 6368  """..        _ch
-0002f560: 6563 6b5f 736f 6674 5f64 6570 656e 6465  eck_soft_depende
-0002f570: 6e63 6965 7328 2266 6169 726c 6561 726e  ncies("fairlearn
-0002f580: 222c 2065 7874 7261 3d22 616e 616c 7973  ", extra="analys
-0002f590: 6973 222c 2073 6576 6572 6974 793d 2265  is", severity="e
-0002f5a0: 7272 6f72 2229 0a20 2020 2020 2020 2066  rror").        f
-0002f5b0: 726f 6d20 6661 6972 6c65 6172 6e2e 6d65  rom fairlearn.me
-0002f5c0: 7472 6963 7320 696d 706f 7274 204d 6574  trics import Met
-0002f5d0: 7269 6346 7261 6d65 2c20 636f 756e 742c  ricFrame, count,
-0002f5e0: 2073 656c 6563 7469 6f6e 5f72 6174 650a   selection_rate.
-0002f5f0: 0a20 2020 2020 2020 2061 6c6c 5f6d 6574  .        all_met
-0002f600: 7269 6373 203d 2073 656c 662e 6765 745f  rics = self.get_
-0002f610: 6d65 7472 6963 7328 295b 5b22 4e61 6d65  metrics()[["Name
-0002f620: 222c 2022 5363 6f72 6520 4675 6e63 7469  ", "Score Functi
-0002f630: 6f6e 222c 2022 4172 6773 225d 5d2e 7365  on", "Args"]].se
-0002f640: 745f 696e 6465 7828 0a20 2020 2020 2020  t_index(.       
-0002f650: 2020 2020 2022 4e61 6d65 220a 2020 2020       "Name".    
-0002f660: 2020 2020 290a 2020 2020 2020 2020 6d65      ).        me
-0002f670: 7472 6963 5f64 6963 7420 3d20 7b7d 0a20  tric_dict = {}. 
-0002f680: 2020 2020 2020 206d 6574 7269 635f 6469         metric_di
-0002f690: 6374 5b22 5361 6d70 6c65 7322 5d20 3d20  ct["Samples"] = 
-0002f6a0: 636f 756e 740a 2020 2020 2020 2020 666f  count.        fo
-0002f6b0: 7220 6920 696e 2061 6c6c 5f6d 6574 7269  r i in all_metri
-0002f6c0: 6373 2e69 6e64 6578 3a0a 2020 2020 2020  cs.index:.      
-0002f6d0: 2020 2020 2020 6d65 7472 6963 5f64 6963        metric_dic
-0002f6e0: 745b 695d 203d 2070 6172 7469 616c 2861  t[i] = partial(a
-0002f6f0: 6c6c 5f6d 6574 7269 6373 2e6c 6f63 5b69  ll_metrics.loc[i
-0002f700: 5d5b 305d 2c20 2a2a 616c 6c5f 6d65 7472  ][0], **all_metr
-0002f710: 6963 732e 6c6f 635b 695d 5b31 5d29 0a0a  ics.loc[i][1])..
-0002f720: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0002f730: 5f6d 6c5f 7573 6563 6173 6520 3d3d 204d  _ml_usecase == M
-0002f740: 4c55 7365 6361 7365 2e43 4c41 5353 4946  LUsecase.CLASSIF
-0002f750: 4943 4154 494f 4e3a 0a20 2020 2020 2020  ICATION:.       
-0002f760: 2020 2020 206d 6574 7269 635f 6469 6374       metric_dict
-0002f770: 5b22 5365 6c65 6374 696f 6e20 5261 7465  ["Selection Rate
-0002f780: 225d 203d 2073 656c 6563 7469 6f6e 5f72  "] = selection_r
-0002f790: 6174 650a 0a20 2020 2020 2020 2079 5f70  ate..        y_p
-0002f7a0: 7265 6420 3d20 7365 6c66 2e70 7265 6469  red = self.predi
-0002f7b0: 6374 5f6d 6f64 656c 2865 7374 696d 6174  ct_model(estimat
-0002f7c0: 6f72 295b 4c41 4245 4c5f 434f 4c55 4d4e  or)[LABEL_COLUMN
-0002f7d0: 5d0a 2020 2020 2020 2020 795f 7472 7565  ].        y_true
-0002f7e0: 203d 2073 656c 662e 795f 7465 7374 0a0a   = self.y_test..
-0002f7f0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-0002f800: 2020 2020 2020 2020 206d 756c 7469 5f6d           multi_m
-0002f810: 6574 7269 6320 3d20 4d65 7472 6963 4672  etric = MetricFr
-0002f820: 616d 6528 0a20 2020 2020 2020 2020 2020  ame(.           
-0002f830: 2020 2020 206d 6574 7269 6373 3d6d 6574       metrics=met
-0002f840: 7269 635f 6469 6374 2c0a 2020 2020 2020  ric_dict,.      
-0002f850: 2020 2020 2020 2020 2020 795f 7472 7565            y_true
-0002f860: 3d79 5f74 7275 652c 0a20 2020 2020 2020  =y_true,.       
-0002f870: 2020 2020 2020 2020 2079 5f70 7265 643d           y_pred=
-0002f880: 795f 7072 6564 2c0a 2020 2020 2020 2020  y_pred,.        
-0002f890: 2020 2020 2020 2020 7365 6e73 6974 6976          sensitiv
-0002f8a0: 655f 6665 6174 7572 6573 3d73 656c 662e  e_features=self.
-0002f8b0: 585f 7465 7374 5b73 656e 7369 7469 7665  X_test[sensitive
-0002f8c0: 5f66 6561 7475 7265 735d 2c0a 2020 2020  _features],.    
-0002f8d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002f8e0: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
-0002f8f0: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-0002f900: 6966 204d 4c55 7365 6361 7365 2e43 4c41  if MLUsecase.CLA
-0002f910: 5353 4946 4943 4154 494f 4e3a 0a20 2020  SSIFICATION:.   
-0002f920: 2020 2020 2020 2020 2020 2020 206d 6574               met
-0002f930: 7269 635f 6469 6374 2e70 6f70 2822 4155  ric_dict.pop("AU
-0002f940: 4322 290a 2020 2020 2020 2020 2020 2020  C").            
-0002f950: 2020 2020 6d75 6c74 695f 6d65 7472 6963      multi_metric
-0002f960: 203d 204d 6574 7269 6346 7261 6d65 280a   = MetricFrame(.
-0002f970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f980: 2020 2020 6d65 7472 6963 733d 6d65 7472      metrics=metr
-0002f990: 6963 5f64 6963 742c 0a20 2020 2020 2020  ic_dict,.       
-0002f9a0: 2020 2020 2020 2020 2020 2020 2079 5f74               y_t
-0002f9b0: 7275 653d 795f 7472 7565 2c0a 2020 2020  rue=y_true,.    
-0002f9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f9d0: 795f 7072 6564 3d79 5f70 7265 642c 0a20  y_pred=y_pred,. 
-0002f9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f9f0: 2020 2073 656e 7369 7469 7665 5f66 6561     sensitive_fea
-0002fa00: 7475 7265 733d 7365 6c66 2e58 5f74 6573  tures=self.X_tes
-0002fa10: 745b 7365 6e73 6974 6976 655f 6665 6174  t[sensitive_feat
-0002fa20: 7572 6573 5d2c 0a20 2020 2020 2020 2020  ures],.         
-0002fa30: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0002fa40: 2020 6d75 6c74 695f 6d65 7472 6963 2e62    multi_metric.b
-0002fa50: 795f 6772 6f75 702e 706c 6f74 2e62 6172  y_group.plot.bar
-0002fa60: 280a 2020 2020 2020 2020 2020 2020 7375  (.            su
-0002fa70: 6270 6c6f 7473 3d54 7275 652c 0a20 2020  bplots=True,.   
-0002fa80: 2020 2020 2020 2020 206c 6179 6f75 743d           layout=
-0002fa90: 5b33 2c20 335d 2c0a 2020 2020 2020 2020  [3, 3],.        
-0002faa0: 2020 2020 6c65 6765 6e64 3d46 616c 7365      legend=False
-0002fab0: 2c0a 2020 2020 2020 2020 2020 2020 6669  ,.            fi
-0002fac0: 6773 697a 653d 5b31 362c 2038 5d2c 0a20  gsize=[16, 8],. 
-0002fad0: 2020 2020 2020 2020 2020 2074 6974 6c65             title
-0002fae0: 3d22 5065 7266 6f72 6d61 6e63 6520 4d65  ="Performance Me
-0002faf0: 7472 6963 7320 6279 2053 656e 7369 7469  trics by Sensiti
-0002fb00: 7665 2046 6561 7475 7265 7322 2c0a 2020  ve Features",.  
-0002fb10: 2020 2020 2020 2020 2020 2a2a 706c 6f74            **plot
-0002fb20: 5f6b 7761 7267 732c 0a20 2020 2020 2020  _kwargs,.       
-0002fb30: 2029 0a0a 2020 2020 2020 2020 7265 7475   )..        retu
-0002fb40: 726e 2070 642e 4461 7461 4672 616d 6528  rn pd.DataFrame(
-0002fb50: 6d75 6c74 695f 6d65 7472 6963 2e62 795f  multi_metric.by_
-0002fb60: 6772 6f75 7029 0a0a 2020 2020 6465 6620  group)..    def 
-0002fb70: 6175 746f 6d6c 280a 2020 2020 2020 2020  automl(.        
-0002fb80: 7365 6c66 2c0a 2020 2020 2020 2020 6f70  self,.        op
-0002fb90: 7469 6d69 7a65 3a20 7374 7220 3d20 2241  timize: str = "A
-0002fba0: 6363 7572 6163 7922 2c0a 2020 2020 2020  ccuracy",.      
-0002fbb0: 2020 7573 655f 686f 6c64 6f75 743a 2062    use_holdout: b
-0002fbc0: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-0002fbd0: 2020 2020 2074 7572 626f 3a20 626f 6f6c       turbo: bool
-0002fbe0: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
-0002fbf0: 2072 6574 7572 6e5f 7472 6169 6e5f 7363   return_train_sc
-0002fc00: 6f72 653a 2062 6f6f 6c20 3d20 4661 6c73  ore: bool = Fals
-0002fc10: 652c 0a20 2020 2029 202d 3e20 416e 793a  e,.    ) -> Any:
-0002fc20: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0002fc30: 2020 2020 2020 5468 6973 2066 756e 6374        This funct
-0002fc40: 696f 6e20 7265 7475 726e 7320 7468 6520  ion returns the 
-0002fc50: 6265 7374 206d 6f64 656c 206f 7574 206f  best model out o
-0002fc60: 6620 616c 6c20 6d6f 6465 6c73 2063 7265  f all models cre
-0002fc70: 6174 6564 2069 6e0a 2020 2020 2020 2020  ated in.        
-0002fc80: 6375 7272 656e 7420 6163 7469 7665 2065  current active e
-0002fc90: 6e76 6972 6f6e 6d65 6e74 2062 6173 6564  nvironment based
-0002fca0: 206f 6e20 6d65 7472 6963 2064 6566 696e   on metric defin
-0002fcb0: 6564 2069 6e20 6f70 7469 6d69 7a65 2070  ed in optimize p
-0002fcc0: 6172 616d 6574 6572 2e0a 0a20 2020 2020  arameter...     
-0002fcd0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-0002fce0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0002fcf0: 0a20 2020 2020 2020 206f 7074 696d 697a  .        optimiz
-0002fd00: 6520 3a20 7374 722c 2064 6566 6175 6c74  e : str, default
-0002fd10: 203d 2027 4163 6375 7261 6379 270a 2020   = 'Accuracy'.  
-0002fd20: 2020 2020 2020 2020 2020 4f74 6865 7220            Other 
-0002fd30: 7661 6c75 6573 2079 6f75 2063 616e 2070  values you can p
-0002fd40: 6173 7320 696e 206f 7074 696d 697a 6520  ass in optimize 
-0002fd50: 7061 7261 6d65 7465 7220 6172 6520 2741  parameter are 'A
-0002fd60: 5543 272c 2027 5265 6361 6c6c 272c 2027  UC', 'Recall', '
-0002fd70: 5072 6563 6973 696f 6e27 2c0a 2020 2020  Precision',.    
-0002fd80: 2020 2020 2020 2020 2746 3127 2c20 274b          'F1', 'K
-0002fd90: 6170 7061 272c 2061 6e64 2027 4d43 4327  appa', and 'MCC'
-0002fda0: 2e0a 0a20 2020 2020 2020 2075 7365 5f68  ...        use_h
-0002fdb0: 6f6c 646f 7574 3a20 626f 6f6c 2c20 6465  oldout: bool, de
-0002fdc0: 6661 756c 7420 3d20 4661 6c73 650a 2020  fault = False.  
-0002fdd0: 2020 2020 2020 2020 2020 5768 656e 2073            When s
-0002fde0: 6574 2074 6f20 5472 7565 2c20 6d65 7472  et to True, metr
-0002fdf0: 6963 7320 6172 6520 6576 616c 7561 7465  ics are evaluate
-0002fe00: 6420 6f6e 2068 6f6c 646f 7574 2073 6574  d on holdout set
-0002fe10: 2069 6e73 7465 6164 206f 6620 4356 2e0a   instead of CV..
-0002fe20: 0a20 2020 2020 2020 2074 7572 626f 3a20  .        turbo: 
-0002fe30: 626f 6f6c 2c20 6465 6661 756c 7420 3d20  bool, default = 
-0002fe40: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
-0002fe50: 2057 6865 6e20 7365 7420 746f 2054 7275   When set to Tru
-0002fe60: 6520 616e 6420 7573 655f 686f 6c64 6f75  e and use_holdou
-0002fe70: 7420 6973 2046 616c 7365 2c20 6f6e 6c79  t is False, only
-0002fe80: 206d 6f64 656c 7320 6372 6561 7465 6420   models created 
-0002fe90: 7769 7468 2064 6566 6175 6c74 2066 6f6c  with default fol
-0002fea0: 640a 2020 2020 2020 2020 2020 2020 7061  d.            pa
-0002feb0: 7261 6d65 7465 7220 7769 6c6c 2062 6520  rameter will be 
-0002fec0: 636f 6e73 6964 6572 6564 2e20 4966 2073  considered. If s
-0002fed0: 6574 2074 6f20 4661 6c73 652c 206d 6f64  et to False, mod
-0002fee0: 656c 7320 6372 6561 7465 6420 7769 7468  els created with
-0002fef0: 2061 206e 6f6e 2d64 6566 6175 6c74 0a20   a non-default. 
-0002ff00: 2020 2020 2020 2020 2020 2066 6f6c 6420             fold 
-0002ff10: 7061 7261 6d65 7465 7220 7769 6c6c 2062  parameter will b
-0002ff20: 6520 7363 6f72 6564 2061 6761 696e 2075  e scored again u
-0002ff30: 7369 6e67 2064 6566 6175 6c74 2066 6f6c  sing default fol
-0002ff40: 6420 7365 7474 696e 6773 2c20 736f 2074  d settings, so t
-0002ff50: 6861 7420 7468 6579 2063 616e 2062 650a  hat they can be.
-0002ff60: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-0002ff70: 6172 6564 2e0a 0a20 2020 2020 2020 2072  ared...        r
-0002ff80: 6574 7572 6e5f 7472 6169 6e5f 7363 6f72  eturn_train_scor
-0002ff90: 653a 2062 6f6f 6c2c 2064 6566 6175 6c74  e: bool, default
-0002ffa0: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
-0002ffb0: 2020 2020 2049 6620 4661 6c73 652c 2072       If False, r
-0002ffc0: 6574 7572 6e73 2074 6865 2043 5620 5661  eturns the CV Va
-0002ffd0: 6c69 6461 7469 6f6e 2073 636f 7265 7320  lidation scores 
-0002ffe0: 6f6e 6c79 2e0a 2020 2020 2020 2020 2020  only..          
-0002fff0: 2020 4966 2054 7275 652c 2072 6574 7572    If True, retur
-00030000: 6e73 2074 6865 2043 5620 7472 6169 6e69  ns the CV traini
-00030010: 6e67 2073 636f 7265 7320 616c 6f6e 6720  ng scores along 
-00030020: 7769 7468 2074 6865 2043 5620 7661 6c69  with the CV vali
-00030030: 6461 7469 6f6e 2073 636f 7265 732e 0a20  dation scores.. 
-00030040: 2020 2020 2020 2020 2020 2054 6869 7320             This 
-00030050: 6973 2075 7365 6675 6c20 7768 656e 2074  is useful when t
-00030060: 6865 2075 7365 7220 7761 6e74 7320 746f  he user wants to
-00030070: 2064 6f20 6269 6173 2d76 6172 6961 6e63   do bias-varianc
-00030080: 6520 7472 6164 656f 6666 2e20 4120 6869  e tradeoff. A hi
-00030090: 6768 2043 560a 2020 2020 2020 2020 2020  gh CV.          
-000300a0: 2020 7472 6169 6e69 6e67 2073 636f 7265    training score
-000300b0: 2077 6974 6820 6120 6c6f 7720 636f 7272   with a low corr
-000300c0: 6573 706f 6e64 696e 6720 4356 2076 616c  esponding CV val
-000300d0: 6964 6174 696f 6e20 7363 6f72 6520 696e  idation score in
-000300e0: 6469 6361 7465 7320 6f76 6572 6669 7474  dicates overfitt
-000300f0: 696e 672e 0a0a 2020 2020 2020 2020 5265  ing...        Re
-00030100: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
-00030110: 2020 2054 7261 696e 6564 204d 6f64 656c     Trained Model
-00030120: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00030130: 2020 2020 2020 6675 6e63 7469 6f6e 5f70        function_p
-00030140: 6172 616d 735f 7374 7220 3d20 222c 2022  arams_str = ", "
-00030150: 2e6a 6f69 6e28 5b66 227b 6b7d 3d7b 767d  .join([f"{k}={v}
-00030160: 2220 666f 7220 6b2c 2076 2069 6e20 6c6f  " for k, v in lo
-00030170: 6361 6c73 2829 2e69 7465 6d73 2829 5d29  cals().items()])
-00030180: 0a0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
-00030190: 6f67 6765 722e 696e 666f 2822 496e 6974  ogger.info("Init
-000301a0: 6961 6c69 7a69 6e67 2061 7574 6f6d 6c28  ializing automl(
-000301b0: 2922 290a 2020 2020 2020 2020 7365 6c66  )").        self
-000301c0: 2e6c 6f67 6765 722e 696e 666f 2866 2261  .logger.info(f"a
-000301d0: 7574 6f6d 6c28 7b66 756e 6374 696f 6e5f  utoml({function_
-000301e0: 7061 7261 6d73 5f73 7472 7d29 2229 0a0a  params_str})")..
-000301f0: 2020 2020 2020 2020 2320 6368 6563 6b69          # checki
-00030200: 6e67 206f 7074 696d 697a 6520 7061 7261  ng optimize para
-00030210: 6d65 7465 720a 2020 2020 2020 2020 6f70  meter.        op
-00030220: 7469 6d69 7a65 203d 2073 656c 662e 5f67  timize = self._g
-00030230: 6574 5f6d 6574 7269 635f 6279 5f6e 616d  et_metric_by_nam
-00030240: 655f 6f72 5f69 6428 6f70 7469 6d69 7a65  e_or_id(optimize
-00030250: 290a 2020 2020 2020 2020 6966 206f 7074  ).        if opt
-00030260: 696d 697a 6520 6973 204e 6f6e 653a 0a20  imize is None:. 
-00030270: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00030280: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-00030290: 2020 2020 2020 2020 2020 2020 2022 4f70               "Op
-000302a0: 7469 6d69 7a65 206d 6574 686f 6420 6e6f  timize method no
-000302b0: 7420 7375 7070 6f72 7465 642e 2053 6565  t supported. See
-000302c0: 2064 6f63 7374 7269 6e67 2066 6f72 206c   docstring for l
-000302d0: 6973 7420 6f66 2061 7661 696c 6162 6c65  ist of available
-000302e0: 2070 6172 616d 6574 6572 732e 220a 2020   parameters.".  
-000302f0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00030300: 2020 2020 2023 2063 6865 636b 696e 6720       # checking 
-00030310: 6f70 7469 6d69 7a65 2070 6172 616d 6574  optimize paramet
-00030320: 6572 2066 6f72 206d 756c 7469 636c 6173  er for multiclas
-00030330: 730a 2020 2020 2020 2020 6966 2073 656c  s.        if sel
-00030340: 662e 6973 5f6d 756c 7469 636c 6173 733a  f.is_multiclass:
-00030350: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00030360: 6e6f 7420 6f70 7469 6d69 7a65 2e69 735f  not optimize.is_
-00030370: 6d75 6c74 6963 6c61 7373 3a0a 2020 2020  multiclass:.    
-00030380: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00030390: 6520 5479 7065 4572 726f 7228 0a20 2020  e TypeError(.   
-000303a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000303b0: 2022 4f70 7469 6d69 7a61 7469 6f6e 206d   "Optimization m
-000303c0: 6574 7269 6320 6e6f 7420 7375 7070 6f72  etric not suppor
-000303d0: 7465 6420 666f 7220 6d75 6c74 6963 6c61  ted for multicla
-000303e0: 7373 2070 726f 626c 656d 732e 2053 6565  ss problems. See
-000303f0: 2064 6f63 7374 7269 6e67 2066 6f72 206c   docstring for l
-00030400: 6973 7420 6f66 206f 7468 6572 206f 7074  ist of other opt
-00030410: 696d 697a 6174 696f 6e20 7061 7261 6d65  imization parame
-00030420: 7465 7273 2e22 0a20 2020 2020 2020 2020  ters.".         
-00030430: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00030440: 2020 2320 6368 6563 6b69 6e67 2072 6574    # checking ret
-00030450: 7572 6e5f 7472 6169 6e5f 7363 6f72 6520  urn_train_score 
-00030460: 7061 7261 6d65 7465 720a 2020 2020 2020  parameter.      
-00030470: 2020 6966 2074 7970 6528 7265 7475 726e    if type(return
-00030480: 5f74 7261 696e 5f73 636f 7265 2920 6973  _train_score) is
-00030490: 206e 6f74 2062 6f6f 6c3a 0a20 2020 2020   not bool:.     
-000304a0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-000304b0: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-000304c0: 2020 2020 2020 2020 2272 6574 7572 6e5f          "return_
-000304d0: 7472 6169 6e5f 7363 6f72 6520 6361 6e20  train_score can 
-000304e0: 6f6e 6c79 2074 616b 6520 6172 6775 6d65  only take argume
-000304f0: 6e74 2061 7320 5472 7565 206f 7220 4661  nt as True or Fa
-00030500: 6c73 6522 0a20 2020 2020 2020 2020 2020  lse".           
-00030510: 2029 0a0a 2020 2020 2020 2020 636f 6d70   )..        comp
-00030520: 6172 655f 6469 6d65 6e73 696f 6e20 3d20  are_dimension = 
-00030530: 6f70 7469 6d69 7a65 2e64 6973 706c 6179  optimize.display
-00030540: 5f6e 616d 650a 2020 2020 2020 2020 6772  _name.        gr
-00030550: 6561 7465 725f 6973 5f62 6574 7465 7220  eater_is_better 
-00030560: 3d20 6f70 7469 6d69 7a65 2e67 7265 6174  = optimize.great
-00030570: 6572 5f69 735f 6265 7474 6572 0a20 2020  er_is_better.   
-00030580: 2020 2020 206f 7074 696d 697a 6520 3d20       optimize = 
-00030590: 6f70 7469 6d69 7a65 2e73 636f 7265 720a  optimize.scorer.
-000305a0: 0a20 2020 2020 2020 2062 6573 745f 6d6f  .        best_mo
-000305b0: 6465 6c20 3d20 4e6f 6e65 0a20 2020 2020  del = None.     
-000305c0: 2020 2062 6573 745f 7363 6f72 6520 3d20     best_score = 
-000305d0: 4e6f 6e65 0a0a 2020 2020 2020 2020 6465  None..        de
-000305e0: 6620 636f 6d70 6172 655f 7363 6f72 6528  f compare_score(
-000305f0: 6e65 772c 2062 6573 7429 3a0a 2020 2020  new, best):.    
-00030600: 2020 2020 2020 2020 6966 206e 6f74 2062          if not b
-00030610: 6573 743a 0a20 2020 2020 2020 2020 2020  est:.           
-00030620: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
-00030630: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00030640: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
-00030650: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
-00030660: 2020 2072 6574 7572 6e20 6e65 7720 3e20     return new > 
-00030670: 6265 7374 0a20 2020 2020 2020 2020 2020  best.           
-00030680: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00030690: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-000306a0: 7720 3c20 6265 7374 0a0a 2020 2020 2020  w < best..      
-000306b0: 2020 6966 2075 7365 5f68 6f6c 646f 7574    if use_holdout
-000306c0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-000306d0: 6c66 2e6c 6f67 6765 722e 696e 666f 2822  lf.logger.info("
-000306e0: 4d6f 6465 6c20 5365 6c65 6374 696f 6e20  Model Selection 
-000306f0: 4261 7369 7320 3a20 486f 6c64 6f75 7420  Basis : Holdout 
-00030700: 7365 7422 290a 2020 2020 2020 2020 2020  set").          
-00030710: 2020 666f 7220 6920 696e 2073 656c 662e    for i in self.
-00030720: 5f6d 6173 7465 725f 6d6f 6465 6c5f 636f  _master_model_co
-00030730: 6e74 6169 6e65 723a 0a20 2020 2020 2020  ntainer:.       
-00030740: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
-00030750: 6767 6572 2e69 6e66 6f28 6622 4368 6563  gger.info(f"Chec
-00030760: 6b69 6e67 206d 6f64 656c 207b 697d 2229  king model {i}")
-00030770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00030780: 206d 6f64 656c 203d 2069 5b22 6d6f 6465   model = i["mode
-00030790: 6c22 5d0a 2020 2020 2020 2020 2020 2020  l"].            
-000307a0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-000307b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000307c0: 662e 7072 6564 6963 745f 6d6f 6465 6c28  f.predict_model(
-000307d0: 6d6f 6465 6c2c 2076 6572 626f 7365 3d46  model, verbose=F
-000307e0: 616c 7365 2920 2023 2074 7970 653a 2069  alse)  # type: i
-000307f0: 676e 6f72 650a 2020 2020 2020 2020 2020  gnore.          
-00030800: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
-00030810: 6570 7469 6f6e 3a0a 2020 2020 2020 2020  eption:.        
-00030820: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00030830: 2e6c 6f67 6765 722e 7761 726e 696e 6728  .logger.warning(
-00030840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00030850: 2020 2020 2020 2020 2066 224d 6f64 656c           f"Model
-00030860: 207b 6d6f 6465 6c7d 2069 7320 6e6f 7420   {model} is not 
-00030870: 6669 7474 6564 2c20 7275 6e6e 696e 6720  fitted, running 
-00030880: 6372 6561 7465 5f6d 6f64 656c 220a 2020  create_model".  
-00030890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000308a0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-000308b0: 2020 2020 2020 2020 6d6f 6465 6c2c 205f          model, _
-000308c0: 203d 2073 656c 662e 5f63 7265 6174 655f   = self._create_
-000308d0: 6d6f 6465 6c28 2020 2320 7479 7065 3a20  model(  # type: 
-000308e0: 6967 6e6f 7265 0a20 2020 2020 2020 2020  ignore.         
-000308f0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00030900: 7374 696d 6174 6f72 3d6d 6f64 656c 2c0a  stimator=model,.
-00030910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030920: 2020 2020 2020 2020 7379 7374 656d 3d46          system=F
-00030930: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-00030940: 2020 2020 2020 2020 2020 2020 2020 7665                ve
-00030950: 7262 6f73 653d 4661 6c73 652c 0a20 2020  rbose=False,.   
-00030960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030970: 2020 2020 2063 726f 7373 5f76 616c 6964       cross_valid
-00030980: 6174 696f 6e3d 4661 6c73 652c 0a20 2020  ation=False,.   
-00030990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000309a0: 2020 2020 2070 7265 6469 6374 3d46 616c       predict=Fal
-000309b0: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-000309c0: 2020 2020 2020 2020 2020 2020 6772 6f75              grou
-000309d0: 7073 3d73 656c 662e 666f 6c64 5f67 726f  ps=self.fold_gro
-000309e0: 7570 735f 7061 7261 6d2c 0a20 2020 2020  ups_param,.     
-000309f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030a00: 2020 2072 6574 7572 6e5f 7472 6169 6e5f     return_train_
-00030a10: 7363 6f72 653d 7265 7475 726e 5f74 7261  score=return_tra
-00030a20: 696e 5f73 636f 7265 2c0a 2020 2020 2020  in_score,.      
-00030a30: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00030a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030a50: 2020 2020 7365 6c66 2e70 7265 6469 6374      self.predict
-00030a60: 5f6d 6f64 656c 286d 6f64 656c 2c20 7665  _model(model, ve
-00030a70: 7262 6f73 653d 4661 6c73 6529 2020 2320  rbose=False)  # 
-00030a80: 7479 7065 3a20 6967 6e6f 7265 0a0a 2020  type: ignore..  
-00030a90: 2020 2020 2020 2020 2020 2020 2020 7020                p 
-00030aa0: 3d20 7365 6c66 2e70 756c 6c28 706f 703d  = self.pull(pop=
-00030ab0: 5472 7565 290a 2020 2020 2020 2020 2020  True).          
-00030ac0: 2020 2020 2020 7020 3d20 705b 636f 6d70        p = p[comp
-00030ad0: 6172 655f 6469 6d65 6e73 696f 6e5d 5b30  are_dimension][0
-00030ae0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00030af0: 2020 6966 2063 6f6d 7061 7265 5f73 636f    if compare_sco
-00030b00: 7265 2870 2c20 6265 7374 5f73 636f 7265  re(p, best_score
-00030b10: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00030b20: 2020 2020 2020 2062 6573 745f 6d6f 6465         best_mode
-00030b30: 6c20 3d20 6d6f 6465 6c0a 2020 2020 2020  l = model.      
-00030b40: 2020 2020 2020 2020 2020 2020 2020 6265                be
-00030b50: 7374 5f73 636f 7265 203d 2070 0a0a 2020  st_score = p..  
-00030b60: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00030b70: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-00030b80: 6765 722e 696e 666f 2822 4d6f 6465 6c20  ger.info("Model 
-00030b90: 5365 6c65 6374 696f 6e20 4261 7369 7320  Selection Basis 
-00030ba0: 3a20 4356 2052 6573 756c 7473 206f 6e20  : CV Results on 
-00030bb0: 5472 6169 6e69 6e67 2073 6574 2229 0a20  Training set"). 
-00030bc0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-00030bd0: 2069 6e20 7261 6e67 6528 6c65 6e28 7365   in range(len(se
-00030be0: 6c66 2e5f 6d61 7374 6572 5f6d 6f64 656c  lf._master_model
-00030bf0: 5f63 6f6e 7461 696e 6572 2929 3a0a 2020  _container)):.  
-00030c00: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-00030c10: 6465 6c20 3d20 7365 6c66 2e5f 6d61 7374  del = self._mast
-00030c20: 6572 5f6d 6f64 656c 5f63 6f6e 7461 696e  er_model_contain
-00030c30: 6572 5b69 5d0a 2020 2020 2020 2020 2020  er[i].          
-00030c40: 2020 2020 2020 7363 6f72 6573 203d 204e        scores = N
-00030c50: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-00030c60: 2020 2020 6966 206d 6f64 656c 5b22 6376      if model["cv
-00030c70: 225d 2069 7320 6e6f 7420 7365 6c66 2e66  "] is not self.f
-00030c80: 6f6c 645f 6765 6e65 7261 746f 723a 0a20  old_generator:. 
-00030c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030ca0: 2020 2069 6620 7475 7262 6f20 6f72 2073     if turbo or s
-00030cb0: 656c 662e 5f69 735f 756e 7375 7065 7276  elf._is_unsuperv
-00030cc0: 6973 6564 2829 3a0a 2020 2020 2020 2020  ised():.        
-00030cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030ce0: 636f 6e74 696e 7565 0a20 2020 2020 2020  continue.       
-00030cf0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00030d00: 662e 5f63 7265 6174 655f 6d6f 6465 6c28  f._create_model(
-00030d10: 2020 2320 7479 7065 3a20 6967 6e6f 7265    # type: ignore
-00030d20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00030d30: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
-00030d40: 6f72 3d6d 6f64 656c 5b22 6d6f 6465 6c22  or=model["model"
-00030d50: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00030d60: 2020 2020 2020 2020 2020 2073 7973 7465             syste
-00030d70: 6d3d 4661 6c73 652c 0a20 2020 2020 2020  m=False,.       
+0002a2b0: 2020 2020 2069 643d 6964 2c0a 2020 2020       id=id,.    
+0002a2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a2d0: 6e61 6d65 3d6e 616d 652c 0a20 2020 2020  name=name,.     
+0002a2e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0002a2f0: 636f 7265 5f66 756e 633d 7363 6f72 655f  core_func=score_
+0002a300: 6675 6e63 2c0a 2020 2020 2020 2020 2020  func,.          
+0002a310: 2020 2020 2020 2020 2020 7461 7267 6574            target
+0002a320: 3d74 6172 6765 742c 0a20 2020 2020 2020  =target,.       
+0002a330: 2020 2020 2020 2020 2020 2020 2061 7267               arg
+0002a340: 733d 6b77 6172 6773 2c0a 2020 2020 2020  s=kwargs,.      
+0002a350: 2020 2020 2020 2020 2020 2020 2020 6469                di
+0002a360: 7370 6c61 795f 6e61 6d65 3d6e 616d 652c  splay_name=name,
+0002a370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a380: 2020 2020 2067 7265 6174 6572 5f69 735f       greater_is_
+0002a390: 6265 7474 6572 3d67 7265 6174 6572 5f69  better=greater_i
+0002a3a0: 735f 6265 7474 6572 2c0a 2020 2020 2020  s_better,.      
+0002a3b0: 2020 2020 2020 2020 2020 2020 2020 6973                is
+0002a3c0: 5f6d 756c 7469 636c 6173 733d 626f 6f6c  _multiclass=bool
+0002a3d0: 286d 756c 7469 636c 6173 7329 2c0a 2020  (multiclass),.  
+0002a3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a3f0: 2020 6973 5f63 7573 746f 6d3d 5472 7565    is_custom=True
+0002a400: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002a410: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0002a420: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
+0002a430: 656c 662e 5f6d 6c5f 7573 6563 6173 6520  elf._ml_usecase 
+0002a440: 3d3d 204d 4c55 7365 6361 7365 2e54 494d  == MLUsecase.TIM
+0002a450: 455f 5345 5249 4553 3a0a 2020 2020 2020  E_SERIES:.      
+0002a460: 2020 2020 2020 6e65 775f 6d65 7472 6963        new_metric
+0002a470: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+0002a480: 2020 2020 2070 7963 6172 6574 2e63 6f6e       pycaret.con
+0002a490: 7461 696e 6572 732e 6d65 7472 6963 732e  tainers.metrics.
+0002a4a0: 7469 6d65 5f73 6572 6965 732e 5469 6d65  time_series.Time
+0002a4b0: 5365 7269 6573 4d65 7472 6963 436f 6e74  SeriesMetricCont
+0002a4c0: 6169 6e65 7228 0a20 2020 2020 2020 2020  ainer(.         
+0002a4d0: 2020 2020 2020 2020 2020 2069 643d 6964             id=id
+0002a4e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002a4f0: 2020 2020 2020 6e61 6d65 3d6e 616d 652c        name=name,
+0002a500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a510: 2020 2020 2073 636f 7265 5f66 756e 633d       score_func=
+0002a520: 7363 6f72 655f 6675 6e63 2c0a 2020 2020  score_func,.    
+0002a530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a540: 6172 6773 3d6b 7761 7267 732c 0a20 2020  args=kwargs,.   
+0002a550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a560: 2064 6973 706c 6179 5f6e 616d 653d 6e61   display_name=na
+0002a570: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+0002a580: 2020 2020 2020 2020 6772 6561 7465 725f          greater_
+0002a590: 6973 5f62 6574 7465 723d 6772 6561 7465  is_better=greate
+0002a5a0: 725f 6973 5f62 6574 7465 722c 0a20 2020  r_is_better,.   
+0002a5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a5c0: 2069 735f 6375 7374 6f6d 3d54 7275 652c   is_custom=True,
+0002a5d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a5e0: 2029 0a20 2020 2020 2020 2020 2020 2029   ).            )
+0002a5f0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0002a600: 2020 2020 2020 2020 2020 206e 6577 5f6d             new_m
+0002a610: 6574 7269 6320 3d20 280a 2020 2020 2020  etric = (.      
+0002a620: 2020 2020 2020 2020 2020 7079 6361 7265            pycare
+0002a630: 742e 636f 6e74 6169 6e65 7273 2e6d 6574  t.containers.met
+0002a640: 7269 6373 2e72 6567 7265 7373 696f 6e2e  rics.regression.
+0002a650: 5265 6772 6573 7369 6f6e 4d65 7472 6963  RegressionMetric
+0002a660: 436f 6e74 6169 6e65 7228 0a20 2020 2020  Container(.     
+0002a670: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002a680: 643d 6964 2c0a 2020 2020 2020 2020 2020  d=id,.          
+0002a690: 2020 2020 2020 2020 2020 6e61 6d65 3d6e            name=n
+0002a6a0: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+0002a6b0: 2020 2020 2020 2020 2073 636f 7265 5f66           score_f
+0002a6c0: 756e 633d 7363 6f72 655f 6675 6e63 2c0a  unc=score_func,.
+0002a6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a6e0: 2020 2020 6172 6773 3d6b 7761 7267 732c      args=kwargs,
+0002a6f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a700: 2020 2020 2064 6973 706c 6179 5f6e 616d       display_nam
+0002a710: 653d 6e61 6d65 2c0a 2020 2020 2020 2020  e=name,.        
+0002a720: 2020 2020 2020 2020 2020 2020 6772 6561              grea
+0002a730: 7465 725f 6973 5f62 6574 7465 723d 6772  ter_is_better=gr
+0002a740: 6561 7465 725f 6973 5f62 6574 7465 722c  eater_is_better,
+0002a750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a760: 2020 2020 2069 735f 6375 7374 6f6d 3d54       is_custom=T
+0002a770: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+0002a780: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0002a790: 2020 2029 0a0a 2020 2020 2020 2020 7365     )..        se
+0002a7a0: 6c66 2e5f 616c 6c5f 6d65 7472 6963 735b  lf._all_metrics[
+0002a7b0: 6964 5d20 3d20 6e65 775f 6d65 7472 6963  id] = new_metric
+0002a7c0: 0a0a 2020 2020 2020 2020 6e65 775f 6d65  ..        new_me
+0002a7d0: 7472 6963 203d 206e 6577 5f6d 6574 7269  tric = new_metri
+0002a7e0: 632e 6765 745f 6469 6374 2829 0a0a 2020  c.get_dict()..  
+0002a7f0: 2020 2020 2020 6e65 775f 6d65 7472 6963        new_metric
+0002a800: 203d 2070 642e 5365 7269 6573 286e 6577   = pd.Series(new
+0002a810: 5f6d 6574 7269 632c 206e 616d 653d 6964  _metric, name=id
+0002a820: 2e72 6570 6c61 6365 2822 2022 2c20 225f  .replace(" ", "_
+0002a830: 2229 292e 6472 6f70 2822 4944 2229 0a0a  ")).drop("ID")..
+0002a840: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+0002a850: 6577 5f6d 6574 7269 630a 0a20 2020 2064  ew_metric..    d
+0002a860: 6566 2072 656d 6f76 655f 6d65 7472 6963  ef remove_metric
+0002a870: 2873 656c 662c 206e 616d 655f 6f72 5f69  (self, name_or_i
+0002a880: 643a 2073 7472 293a 0a20 2020 2020 2020  d: str):.       
+0002a890: 2022 2222 0a20 2020 2020 2020 2052 656d   """.        Rem
+0002a8a0: 6f76 6573 2061 206d 6574 7269 6320 7573  oves a metric us
+0002a8b0: 6564 2069 6e20 616c 6c20 6675 6e63 7469  ed in all functi
+0002a8c0: 6f6e 732e 0a0a 2020 2020 2020 2020 5061  ons...        Pa
+0002a8d0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+0002a8e0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+0002a8f0: 2020 2020 6e61 6d65 5f6f 725f 6964 3a20      name_or_id: 
+0002a900: 7374 720a 2020 2020 2020 2020 2020 2020  str.            
+0002a910: 4469 7370 6c61 7920 6e61 6d65 206f 7220  Display name or 
+0002a920: 4944 206f 6620 7468 6520 6d65 7472 6963  ID of the metric
+0002a930: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
+0002a940: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
+0002a950: 6c66 2e5f 7365 7475 705f 7261 6e3a 0a20  lf._setup_ran:. 
+0002a960: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0002a970: 2056 616c 7565 4572 726f 7228 2273 6574   ValueError("set
+0002a980: 7570 2829 206e 6565 6473 2074 6f20 6265  up() needs to be
+0002a990: 2072 616e 2066 6972 7374 2e22 290a 0a20   ran first.").. 
+0002a9a0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0002a9b0: 2020 2020 2020 2020 7365 6c66 2e5f 616c          self._al
+0002a9c0: 6c5f 6d65 7472 6963 732e 706f 7028 6e61  l_metrics.pop(na
+0002a9d0: 6d65 5f6f 725f 6964 290a 2020 2020 2020  me_or_id).      
+0002a9e0: 2020 2020 2020 7265 7475 726e 0a20 2020        return.   
+0002a9f0: 2020 2020 2065 7863 6570 7420 4578 6365       except Exce
+0002aa00: 7074 696f 6e3a 0a20 2020 2020 2020 2020  ption:.         
+0002aa10: 2020 2070 6173 730a 0a20 2020 2020 2020     pass..       
+0002aa20: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0002aa30: 2020 6b5f 746f 5f72 656d 6f76 6520 3d20    k_to_remove = 
+0002aa40: 6e65 7874 280a 2020 2020 2020 2020 2020  next(.          
+0002aa50: 2020 2020 2020 6b20 666f 7220 6b2c 2076        k for k, v
+0002aa60: 2069 6e20 7365 6c66 2e5f 616c 6c5f 6d65   in self._all_me
+0002aa70: 7472 6963 732e 6974 656d 7328 2920 6966  trics.items() if
+0002aa80: 2076 2e6e 616d 6520 3d3d 206e 616d 655f   v.name == name_
+0002aa90: 6f72 5f69 640a 2020 2020 2020 2020 2020  or_id.          
+0002aaa0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0002aab0: 7365 6c66 2e5f 616c 6c5f 6d65 7472 6963  self._all_metric
+0002aac0: 732e 706f 7028 6b5f 746f 5f72 656d 6f76  s.pop(k_to_remov
+0002aad0: 6529 0a20 2020 2020 2020 2020 2020 2072  e).            r
+0002aae0: 6574 7572 6e0a 2020 2020 2020 2020 6578  eturn.        ex
+0002aaf0: 6365 7074 2045 7863 6570 7469 6f6e 3a0a  cept Exception:.
+0002ab00: 2020 2020 2020 2020 2020 2020 7061 7373              pass
+0002ab10: 0a0a 2020 2020 2020 2020 7261 6973 6520  ..        raise 
+0002ab20: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+0002ab30: 2020 2020 2020 2020 6622 4e6f 206d 6574          f"No met
+0002ab40: 7269 6320 2744 6973 706c 6179 204e 616d  ric 'Display Nam
+0002ab50: 6527 206f 7220 2749 4427 2028 696e 6465  e' or 'ID' (inde
+0002ab60: 7829 207b 6e61 6d65 5f6f 725f 6964 7d20  x) {name_or_id} 
+0002ab70: 7072 6573 656e 7420 696e 2074 6865 206d  present in the m
+0002ab80: 6574 7269 6373 2072 6570 6f73 6974 6f72  etrics repositor
+0002ab90: 792e 220a 2020 2020 2020 2020 290a 0a20  y.".        ).. 
+0002aba0: 2020 2064 6566 2066 696e 616c 697a 655f     def finalize_
+0002abb0: 6d6f 6465 6c28 0a20 2020 2020 2020 2073  model(.        s
+0002abc0: 656c 662c 0a20 2020 2020 2020 2065 7374  elf,.        est
+0002abd0: 696d 6174 6f72 2c0a 2020 2020 2020 2020  imator,.        
+0002abe0: 6669 745f 6b77 6172 6773 3a20 4f70 7469  fit_kwargs: Opti
+0002abf0: 6f6e 616c 5b64 6963 745d 203d 204e 6f6e  onal[dict] = Non
+0002ac00: 652c 0a20 2020 2020 2020 2067 726f 7570  e,.        group
+0002ac10: 733a 204f 7074 696f 6e61 6c5b 556e 696f  s: Optional[Unio
+0002ac20: 6e5b 7374 722c 2041 6e79 5d5d 203d 204e  n[str, Any]] = N
+0002ac30: 6f6e 652c 0a20 2020 2020 2020 206d 6f64  one,.        mod
+0002ac40: 656c 5f6f 6e6c 793a 2062 6f6f 6c20 3d20  el_only: bool = 
+0002ac50: 4661 6c73 652c 0a20 2020 2020 2020 2065  False,.        e
+0002ac60: 7870 6572 696d 656e 745f 6375 7374 6f6d  xperiment_custom
+0002ac70: 5f74 6167 733a 204f 7074 696f 6e61 6c5b  _tags: Optional[
+0002ac80: 4469 6374 5b73 7472 2c20 416e 795d 5d20  Dict[str, Any]] 
+0002ac90: 3d20 4e6f 6e65 2c0a 2020 2020 2920 2d3e  = None,.    ) ->
+0002aca0: 2041 6e79 3a20 2023 2061 6464 6564 2069   Any:  # added i
+0002acb0: 6e20 7079 6361 7265 743d 3d32 2e32 2e30  n pycaret==2.2.0
+0002acc0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0002acd0: 2020 2020 2054 6869 7320 6675 6e63 7469       This functi
+0002ace0: 6f6e 2066 6974 7320 7468 6520 636f 6d70  on fits the comp
+0002acf0: 6c65 7465 2070 6970 656c 696e 6520 7769  lete pipeline wi
+0002ad00: 7468 2074 6865 2065 7374 696d 6174 6f72  th the estimator
+0002ad10: 206f 6e20 7468 650a 2020 2020 2020 2020   on the.        
+0002ad20: 636f 6d70 6c65 7465 2064 6174 6173 6574  complete dataset
+0002ad30: 2070 6173 7365 6420 6475 7269 6e67 2074   passed during t
+0002ad40: 6865 2073 6574 7570 2829 2073 7461 6765  he setup() stage
+0002ad50: 2e20 5468 6520 7075 7270 6f73 6520 6f66  . The purpose of
+0002ad60: 0a20 2020 2020 2020 2074 6869 7320 6675  .        this fu
+0002ad70: 6e63 7469 6f6e 2069 7320 746f 2070 7265  nction is to pre
+0002ad80: 7061 7265 2066 6f72 2066 696e 616c 206d  pare for final m
+0002ad90: 6f64 656c 2064 6570 6c6f 796d 656e 7420  odel deployment 
+0002ada0: 6166 7465 720a 2020 2020 2020 2020 6578  after.        ex
+0002adb0: 7065 7269 6d65 6e74 6174 696f 6e2e 0a0a  perimentation...
+0002adc0: 2020 2020 2020 2020 4578 616d 706c 650a          Example.
+0002add0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+0002ade0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+0002adf0: 2070 7963 6172 6574 2e64 6174 6173 6574   pycaret.dataset
+0002ae00: 7320 696d 706f 7274 2067 6574 5f64 6174  s import get_dat
+0002ae10: 610a 2020 2020 2020 2020 3e3e 3e20 6a75  a.        >>> ju
+0002ae20: 6963 6520 3d20 6765 745f 6461 7461 2827  ice = get_data('
+0002ae30: 6a75 6963 6527 290a 2020 2020 2020 2020  juice').        
+0002ae40: 3e3e 3e20 6578 7065 7269 6d65 6e74 5f6e  >>> experiment_n
+0002ae50: 616d 6520 3d20 7365 7475 7028 6461 7461  ame = setup(data
+0002ae60: 203d 206a 7569 6365 2c20 2074 6172 6765   = juice,  targe
+0002ae70: 7420 3d20 2750 7572 6368 6173 6527 290a  t = 'Purchase').
+0002ae80: 2020 2020 2020 2020 3e3e 3e20 6c72 203d          >>> lr =
+0002ae90: 2063 7265 6174 655f 6d6f 6465 6c28 276c   create_model('l
+0002aea0: 7227 290a 2020 2020 2020 2020 3e3e 3e20  r').        >>> 
+0002aeb0: 6669 6e61 6c5f 6c72 203d 2066 696e 616c  final_lr = final
+0002aec0: 697a 655f 6d6f 6465 6c28 6c72 290a 0a20  ize_model(lr).. 
+0002aed0: 2020 2020 2020 2054 6869 7320 7769 6c6c         This will
+0002aee0: 2072 6574 7572 6e20 7468 6520 6669 6e61   return the fina
+0002aef0: 6c20 6d6f 6465 6c20 6f62 6a65 6374 2066  l model object f
+0002af00: 6974 7465 6420 746f 2063 6f6d 706c 6574  itted to complet
+0002af10: 6520 6461 7461 7365 742e 0a0a 2020 2020  e dataset...    
+0002af20: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+0002af30: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0002af40: 2d0a 2020 2020 2020 2020 6573 7469 6d61  -.        estima
+0002af50: 746f 7220 3a20 6f62 6a65 6374 2c20 6465  tor : object, de
+0002af60: 6661 756c 7420 3d20 6e6f 6e65 0a20 2020  fault = none.   
+0002af70: 2020 2020 2020 2020 2041 2074 7261 696e           A train
+0002af80: 6564 206d 6f64 656c 206f 626a 6563 7420  ed model object 
+0002af90: 7368 6f75 6c64 2062 6520 7061 7373 6564  should be passed
+0002afa0: 2061 7320 616e 2065 7374 696d 6174 6f72   as an estimator
+0002afb0: 2e0a 0a20 2020 2020 2020 2066 6974 5f6b  ...        fit_k
+0002afc0: 7761 7267 733a 2064 6963 742c 2064 6566  wargs: dict, def
+0002afd0: 6175 6c74 203d 207b 7d20 2865 6d70 7479  ault = {} (empty
+0002afe0: 2064 6963 7429 0a20 2020 2020 2020 2020   dict).         
+0002aff0: 2020 2044 6963 7469 6f6e 6172 7920 6f66     Dictionary of
+0002b000: 2061 7267 756d 656e 7473 2070 6173 7365   arguments passe
+0002b010: 6420 746f 2074 6865 2066 6974 206d 6574  d to the fit met
+0002b020: 686f 6420 6f66 2074 6865 206d 6f64 656c  hod of the model
+0002b030: 2e0a 0a20 2020 2020 2020 2067 726f 7570  ...        group
+0002b040: 733a 2073 7472 206f 7220 6172 7261 792d  s: str or array-
+0002b050: 6c69 6b65 2c20 7769 7468 2073 6861 7065  like, with shape
+0002b060: 2028 6e5f 7361 6d70 6c65 732c 292c 2064   (n_samples,), d
+0002b070: 6566 6175 6c74 203d 204e 6f6e 650a 2020  efault = None.  
+0002b080: 2020 2020 2020 2020 2020 4f70 7469 6f6e            Option
+0002b090: 616c 2047 726f 7570 206c 6162 656c 7320  al Group labels 
+0002b0a0: 666f 7220 7468 6520 7361 6d70 6c65 7320  for the samples 
+0002b0b0: 7573 6564 2077 6869 6c65 2073 706c 6974  used while split
+0002b0c0: 7469 6e67 2074 6865 2064 6174 6173 6574  ting the dataset
+0002b0d0: 2069 6e74 6f20 7472 6169 6e2f 7465 7374   into train/test
+0002b0e0: 2073 6574 2e0a 2020 2020 2020 2020 2020   set..          
+0002b0f0: 2020 4966 2073 7472 696e 6720 6973 2070    If string is p
+0002b100: 6173 7365 642c 2077 696c 6c20 7573 6520  assed, will use 
+0002b110: 7468 6520 6461 7461 2063 6f6c 756d 6e20  the data column 
+0002b120: 7769 7468 2074 6861 7420 6e61 6d65 2061  with that name a
+0002b130: 7320 7468 6520 6772 6f75 7073 2e0a 2020  s the groups..  
+0002b140: 2020 2020 2020 2020 2020 4f6e 6c79 2075            Only u
+0002b150: 7365 6420 6966 2061 2067 726f 7570 2062  sed if a group b
+0002b160: 6173 6564 2063 726f 7373 2d76 616c 6964  ased cross-valid
+0002b170: 6174 696f 6e20 6765 6e65 7261 746f 7220  ation generator 
+0002b180: 6973 2075 7365 6420 2865 672e 2047 726f  is used (eg. Gro
+0002b190: 7570 4b46 6f6c 6429 2e0a 2020 2020 2020  upKFold)..      
+0002b1a0: 2020 2020 2020 4966 204e 6f6e 652c 2077        If None, w
+0002b1b0: 696c 6c20 7573 6520 7468 6520 7661 6c75  ill use the valu
+0002b1c0: 6520 7365 7420 696e 2066 6f6c 645f 6772  e set in fold_gr
+0002b1d0: 6f75 7073 2070 6172 616d 6574 6572 2069  oups parameter i
+0002b1e0: 6e20 7365 7475 7028 292e 0a0a 2020 2020  n setup()...    
+0002b1f0: 2020 2020 6d6f 6465 6c5f 6f6e 6c79 203a      model_only :
+0002b200: 2062 6f6f 6c2c 2064 6566 6175 6c74 203d   bool, default =
+0002b210: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+0002b220: 2020 2057 6865 7468 6572 2074 6f20 7265     Whether to re
+0002b230: 7475 726e 2074 6865 2063 6f6d 706c 6574  turn the complet
+0002b240: 6520 6669 7474 6564 2070 6970 656c 696e  e fitted pipelin
+0002b250: 6520 6f72 206f 6e6c 7920 7468 6520 6669  e or only the fi
+0002b260: 7474 6564 206d 6f64 656c 2e0a 0a20 2020  tted model...   
+0002b270: 2020 2020 2065 7870 6572 696d 656e 745f       experiment_
+0002b280: 6375 7374 6f6d 5f74 6167 733a 2064 6963  custom_tags: dic
+0002b290: 742c 2064 6566 6175 6c74 203d 204e 6f6e  t, default = Non
+0002b2a0: 650a 2020 2020 2020 2020 2020 2020 4469  e.            Di
+0002b2b0: 6374 696f 6e61 7279 206f 6620 7461 675f  ctionary of tag_
+0002b2c0: 6e61 6d65 3a20 5374 7269 6e67 202d 3e20  name: String -> 
+0002b2d0: 7661 6c75 653a 2028 5374 7269 6e67 2c20  value: (String, 
+0002b2e0: 6275 7420 7769 6c6c 2062 6520 7374 7269  but will be stri
+0002b2f0: 6e67 2d69 6669 6564 2069 660a 2020 2020  ng-ified if.    
+0002b300: 2020 2020 2020 2020 6e6f 7429 2070 6173          not) pas
+0002b310: 7365 6420 746f 2074 6865 206d 6c66 6c6f  sed to the mlflo
+0002b320: 772e 7365 745f 7461 6773 2074 6f20 6164  w.set_tags to ad
+0002b330: 6420 6e65 7720 6375 7374 6f6d 2074 6167  d new custom tag
+0002b340: 7320 666f 7220 7468 6520 6578 7065 7269  s for the experi
+0002b350: 6d65 6e74 2e0a 0a20 2020 2020 2020 2052  ment...        R
+0002b360: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+0002b370: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2020  ------.         
+0002b380: 2020 2054 7261 696e 6564 2070 6970 656c     Trained pipel
+0002b390: 696e 6520 6f72 206d 6f64 656c 206f 626a  ine or model obj
+0002b3a0: 6563 7420 6669 7474 6564 206f 6e20 636f  ect fitted on co
+0002b3b0: 6d70 6c65 7465 2064 6174 6173 6574 2e0a  mplete dataset..
+0002b3c0: 0a20 2020 2020 2020 2057 6172 6e69 6e67  .        Warning
+0002b3d0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0002b3e0: 2d2d 0a20 2020 2020 2020 202d 2049 6620  --.        - If 
+0002b3f0: 7468 6520 6d6f 6465 6c20 7265 7475 726e  the model return
+0002b400: 6564 2062 7920 6669 6e61 6c69 7a65 5f6d  ed by finalize_m
+0002b410: 6f64 656c 2829 2c20 6973 2075 7365 6420  odel(), is used 
+0002b420: 6f6e 2070 7265 6469 6374 5f6d 6f64 656c  on predict_model
+0002b430: 2829 2077 6974 686f 7574 0a20 2020 2020  () without.     
+0002b440: 2020 2070 6173 7369 6e67 2061 206e 6577     passing a new
+0002b450: 2075 6e73 6565 6e20 6461 7461 7365 742c   unseen dataset,
+0002b460: 2074 6865 6e20 7468 6520 696e 666f 726d   then the inform
+0002b470: 6174 696f 6e20 6772 6964 2070 7269 6e74  ation grid print
+0002b480: 6564 2069 7320 6d69 736c 6561 6469 6e67  ed is misleading
+0002b490: 0a20 2020 2020 2020 2061 7320 7468 6520  .        as the 
+0002b4a0: 6d6f 6465 6c20 6973 2074 7261 696e 6564  model is trained
+0002b4b0: 206f 6e20 7468 6520 636f 6d70 6c65 7465   on the complete
+0002b4c0: 2064 6174 6173 6574 2069 6e63 6c75 6469   dataset includi
+0002b4d0: 6e67 2074 6573 7420 2f20 686f 6c64 2d6f  ng test / hold-o
+0002b4e0: 7574 2073 616d 706c 652e 0a20 2020 2020  ut sample..     
+0002b4f0: 2020 204f 6e63 6520 6669 6e61 6c69 7a65     Once finalize
+0002b500: 5f6d 6f64 656c 2829 2069 7320 7573 6564  _model() is used
+0002b510: 2c20 7468 6520 6d6f 6465 6c20 6973 2063  , the model is c
+0002b520: 6f6e 7369 6465 7265 6420 7265 6164 7920  onsidered ready 
+0002b530: 666f 7220 6465 706c 6f79 6d65 6e74 2061  for deployment a
+0002b540: 6e64 0a20 2020 2020 2020 2073 686f 756c  nd.        shoul
+0002b550: 6420 6265 2075 7365 6420 6f6e 206e 6577  d be used on new
+0002b560: 2075 6e73 6565 6e20 6461 7461 7365 7420   unseen dataset 
+0002b570: 6f6e 6c79 2e0a 0a20 2020 2020 2020 2022  only...        "
+0002b580: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
+0002b590: 5f63 6865 636b 5f73 6574 7570 5f72 616e  _check_setup_ran
+0002b5a0: 2829 0a0a 2020 2020 2020 2020 6675 6e63  ()..        func
+0002b5b0: 7469 6f6e 5f70 6172 616d 735f 7374 7220  tion_params_str 
+0002b5c0: 3d20 222c 2022 2e6a 6f69 6e28 5b66 227b  = ", ".join([f"{
+0002b5d0: 6b7d 3d7b 767d 2220 666f 7220 6b2c 2076  k}={v}" for k, v
+0002b5e0: 2069 6e20 6c6f 6361 6c73 2829 2e69 7465   in locals().ite
+0002b5f0: 6d73 2829 5d29 0a0a 2020 2020 2020 2020  ms()])..        
+0002b600: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
+0002b610: 2822 496e 6974 6961 6c69 7a69 6e67 2066  ("Initializing f
+0002b620: 696e 616c 697a 655f 6d6f 6465 6c28 2922  inalize_model()"
+0002b630: 290a 2020 2020 2020 2020 7365 6c66 2e6c  ).        self.l
+0002b640: 6f67 6765 722e 696e 666f 2866 2266 696e  ogger.info(f"fin
+0002b650: 616c 697a 655f 6d6f 6465 6c28 7b66 756e  alize_model({fun
+0002b660: 6374 696f 6e5f 7061 7261 6d73 5f73 7472  ction_params_str
+0002b670: 7d29 2229 0a0a 2020 2020 2020 2020 7275  })")..        ru
+0002b680: 6e74 696d 655f 7374 6172 7420 3d20 7469  ntime_start = ti
+0002b690: 6d65 2e74 696d 6528 290a 0a20 2020 2020  me.time()..     
+0002b6a0: 2020 2064 6973 706c 6179 203d 2043 6f6d     display = Com
+0002b6b0: 6d6f 6e44 6973 706c 6179 280a 2020 2020  monDisplay(.    
+0002b6c0: 2020 2020 2020 2020 7665 7262 6f73 653d          verbose=
+0002b6d0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+0002b6e0: 2020 2068 746d 6c5f 7061 7261 6d3d 7365     html_param=se
+0002b6f0: 6c66 2e68 746d 6c5f 7061 7261 6d2c 0a20  lf.html_param,. 
+0002b700: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0002b710: 2020 6e70 2e72 616e 646f 6d2e 7365 6564    np.random.seed
+0002b720: 2873 656c 662e 7365 6564 290a 0a20 2020  (self.seed)..   
+0002b730: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
+0002b740: 2e69 6e66 6f28 6622 4669 6e61 6c69 7a69  .info(f"Finalizi
+0002b750: 6e67 207b 6573 7469 6d61 746f 727d 2229  ng {estimator}")
+0002b760: 0a20 2020 2020 2020 2070 6970 656c 696e  .        pipelin
+0002b770: 655f 6669 6e61 6c2c 206d 6f64 656c 5f66  e_final, model_f
+0002b780: 6974 5f74 696d 6520 3d20 7365 6c66 2e5f  it_time = self._
+0002b790: 6372 6561 7465 5f6d 6f64 656c 280a 2020  create_model(.  
+0002b7a0: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
+0002b7b0: 746f 723d 6573 7469 6d61 746f 722c 0a20  tor=estimator,. 
+0002b7c0: 2020 2020 2020 2020 2020 2063 726f 7373             cross
+0002b7d0: 5f76 616c 6964 6174 696f 6e3d 4661 6c73  _validation=Fals
+0002b7e0: 652c 0a20 2020 2020 2020 2020 2020 2076  e,.            v
+0002b7f0: 6572 626f 7365 3d46 616c 7365 2c0a 2020  erbose=False,.  
+0002b800: 2020 2020 2020 2020 2020 7379 7374 656d            system
+0002b810: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+0002b820: 2020 2020 585f 7472 6169 6e5f 6461 7461      X_train_data
+0002b830: 3d73 656c 662e 582c 0a20 2020 2020 2020  =self.X,.       
+0002b840: 2020 2020 2079 5f74 7261 696e 5f64 6174       y_train_dat
+0002b850: 613d 7365 6c66 2e79 2c0a 2020 2020 2020  a=self.y,.      
+0002b860: 2020 2020 2020 6669 745f 6b77 6172 6773        fit_kwargs
+0002b870: 3d66 6974 5f6b 7761 7267 7320 6f72 207b  =fit_kwargs or {
+0002b880: 7d2c 0a20 2020 2020 2020 2020 2020 2070  },.            p
+0002b890: 7265 6469 6374 3d46 616c 7365 2c0a 2020  redict=False,.  
+0002b8a0: 2020 2020 2020 2020 2020 6772 6f75 7073            groups
+0002b8b0: 3d73 656c 662e 5f67 6574 5f67 726f 7570  =self._get_group
+0002b8c0: 7328 6772 6f75 7073 2c20 6461 7461 3d73  s(groups, data=s
+0002b8d0: 656c 662e 5829 2c0a 2020 2020 2020 2020  elf.X),.        
+0002b8e0: 2020 2020 6164 645f 746f 5f6d 6f64 656c      add_to_model
+0002b8f0: 5f6c 6973 743d 4661 6c73 652c 0a20 2020  _list=False,.   
+0002b900: 2020 2020 2020 2020 206d 6f64 656c 5f6f           model_o
+0002b910: 6e6c 793d 4661 6c73 652c 0a20 2020 2020  nly=False,.     
+0002b920: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
+0002b930: 6461 7368 626f 6172 6420 6c6f 6767 696e  dashboard loggin
+0002b940: 670a 2020 2020 2020 2020 6966 2073 656c  g.        if sel
+0002b950: 662e 6c6f 6767 696e 675f 7061 7261 6d3a  f.logging_param:
+0002b960: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002b970: 662e 5f6c 6f67 5f6d 6f64 656c 280a 2020  f._log_model(.  
+0002b980: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+0002b990: 6465 6c3d 7069 7065 6c69 6e65 5f66 696e  del=pipeline_fin
+0002b9a0: 616c 2c0a 2020 2020 2020 2020 2020 2020  al,.            
+0002b9b0: 2020 2020 6d6f 6465 6c5f 7265 7375 6c74      model_result
+0002b9c0: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
+0002b9d0: 2020 2020 2020 2020 7363 6f72 655f 6469          score_di
+0002b9e0: 6374 3d7b 7d2c 0a20 2020 2020 2020 2020  ct={},.         
+0002b9f0: 2020 2020 2020 2073 6f75 7263 653d 2266         source="f
+0002ba00: 696e 616c 697a 655f 6d6f 6465 6c22 2c0a  inalize_model",.
+0002ba10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ba20: 7275 6e74 696d 653d 6e70 2e61 7272 6179  runtime=np.array
+0002ba30: 2874 696d 652e 7469 6d65 2829 202d 2072  (time.time() - r
+0002ba40: 756e 7469 6d65 5f73 7461 7274 292e 726f  untime_start).ro
+0002ba50: 756e 6428 3229 2c0a 2020 2020 2020 2020  und(2),.        
+0002ba60: 2020 2020 2020 2020 6d6f 6465 6c5f 6669          model_fi
+0002ba70: 745f 7469 6d65 3d6d 6f64 656c 5f66 6974  t_time=model_fit
+0002ba80: 5f74 696d 652c 0a20 2020 2020 2020 2020  _time,.         
+0002ba90: 2020 2020 2020 2070 6970 656c 696e 653d         pipeline=
+0002baa0: 7365 6c66 2e70 6970 656c 696e 652c 0a20  self.pipeline,. 
+0002bab0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0002bac0: 6f67 5f70 6c6f 7473 3d73 656c 662e 6c6f  og_plots=self.lo
+0002bad0: 675f 706c 6f74 735f 7061 7261 6d2c 0a20  g_plots_param,. 
+0002bae0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002baf0: 7870 6572 696d 656e 745f 6375 7374 6f6d  xperiment_custom
+0002bb00: 5f74 6167 733d 6578 7065 7269 6d65 6e74  _tags=experiment
+0002bb10: 5f63 7573 746f 6d5f 7461 6773 2c0a 2020  _custom_tags,.  
+0002bb20: 2020 2020 2020 2020 2020 2020 2020 6469                di
+0002bb30: 7370 6c61 793d 6469 7370 6c61 792c 0a20  splay=display,. 
+0002bb40: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0002bb50: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
+0002bb60: 722e 696e 666f 280a 2020 2020 2020 2020  r.info(.        
+0002bb70: 2020 2020 6622 5f6d 6173 7465 725f 6d6f      f"_master_mo
+0002bb80: 6465 6c5f 636f 6e74 6169 6e65 723a 207b  del_container: {
+0002bb90: 6c65 6e28 7365 6c66 2e5f 6d61 7374 6572  len(self._master
+0002bba0: 5f6d 6f64 656c 5f63 6f6e 7461 696e 6572  _model_container
+0002bbb0: 297d 220a 2020 2020 2020 2020 290a 2020  )}".        ).  
+0002bbc0: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
+0002bbd0: 722e 696e 666f 2866 225f 6469 7370 6c61  r.info(f"_displa
+0002bbe0: 795f 636f 6e74 6169 6e65 723a 207b 6c65  y_container: {le
+0002bbf0: 6e28 7365 6c66 2e5f 6469 7370 6c61 795f  n(self._display_
+0002bc00: 636f 6e74 6169 6e65 7229 7d22 290a 0a20  container)}").. 
+0002bc10: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+0002bc20: 6572 2e69 6e66 6f28 7374 7228 7069 7065  er.info(str(pipe
+0002bc30: 6c69 6e65 5f66 696e 616c 2929 0a20 2020  line_final)).   
+0002bc40: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
+0002bc50: 2e69 6e66 6f28 0a20 2020 2020 2020 2020  .info(.         
+0002bc60: 2020 2022 6669 6e61 6c69 7a65 5f6d 6f64     "finalize_mod
+0002bc70: 656c 2829 2073 7563 6365 7373 6675 6c6c  el() successfull
+0002bc80: 7920 636f 6d70 6c65 7465 642e 2e2e 2e2e  y completed.....
+0002bc90: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0002bca0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0002bcb0: 2e22 0a20 2020 2020 2020 2029 0a0a 2020  .".        )..  
+0002bcc0: 2020 2020 2020 6763 2e63 6f6c 6c65 6374        gc.collect
+0002bcd0: 2829 0a0a 2020 2020 2020 2020 6966 206d  ()..        if m
+0002bce0: 6f64 656c 5f6f 6e6c 793a 0a20 2020 2020  odel_only:.     
+0002bcf0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0002bd00: 6c66 2e5f 6765 745f 6669 6e61 6c5f 6d6f  lf._get_final_mo
+0002bd10: 6465 6c5f 6672 6f6d 5f70 6970 656c 696e  del_from_pipelin
+0002bd20: 6528 7069 7065 6c69 6e65 5f66 696e 616c  e(pipeline_final
+0002bd30: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+0002bd40: 6e20 7069 7065 6c69 6e65 5f66 696e 616c  n pipeline_final
+0002bd50: 0a0a 2020 2020 6465 6620 7072 6564 6963  ..    def predic
+0002bd60: 745f 6d6f 6465 6c28 0a20 2020 2020 2020  t_model(.       
+0002bd70: 2073 656c 662c 0a20 2020 2020 2020 2065   self,.        e
+0002bd80: 7374 696d 6174 6f72 2c0a 2020 2020 2020  stimator,.      
+0002bd90: 2020 6461 7461 3a20 4f70 7469 6f6e 616c    data: Optional
+0002bda0: 5b70 642e 4461 7461 4672 616d 655d 203d  [pd.DataFrame] =
+0002bdb0: 204e 6f6e 652c 0a20 2020 2020 2020 2070   None,.        p
+0002bdc0: 726f 6261 6269 6c69 7479 5f74 6872 6573  robability_thres
+0002bdd0: 686f 6c64 3a20 4f70 7469 6f6e 616c 5b66  hold: Optional[f
+0002bde0: 6c6f 6174 5d20 3d20 4e6f 6e65 2c0a 2020  loat] = None,.  
+0002bdf0: 2020 2020 2020 656e 636f 6465 645f 6c61        encoded_la
+0002be00: 6265 6c73 3a20 626f 6f6c 203d 2046 616c  bels: bool = Fal
+0002be10: 7365 2c20 2023 2061 6464 6564 2069 6e20  se,  # added in 
+0002be20: 7079 6361 7265 743d 3d32 2e31 2e30 0a20  pycaret==2.1.0. 
+0002be30: 2020 2020 2020 2072 6177 5f73 636f 7265         raw_score
+0002be40: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+0002be50: 2020 2020 2020 2020 726f 756e 643a 2069          round: i
+0002be60: 6e74 203d 2034 2c20 2023 2061 6464 6564  nt = 4,  # added
+0002be70: 2069 6e20 7079 6361 7265 743d 3d32 2e32   in pycaret==2.2
+0002be80: 2e30 0a20 2020 2020 2020 2076 6572 626f  .0.        verbo
+0002be90: 7365 3a20 626f 6f6c 203d 2054 7275 652c  se: bool = True,
+0002bea0: 0a20 2020 2020 2020 206d 6c5f 7573 6563  .        ml_usec
+0002beb0: 6173 653a 204f 7074 696f 6e61 6c5b 4d4c  ase: Optional[ML
+0002bec0: 5573 6563 6173 655d 203d 204e 6f6e 652c  Usecase] = None,
+0002bed0: 0a20 2020 2020 2020 2070 7265 7072 6f63  .        preproc
+0002bee0: 6573 733a 2055 6e69 6f6e 5b62 6f6f 6c2c  ess: Union[bool,
+0002bef0: 2073 7472 5d20 3d20 5472 7565 2c0a 2020   str] = True,.  
+0002bf00: 2020 2920 2d3e 2070 642e 4461 7461 4672    ) -> pd.DataFr
+0002bf10: 616d 653a 0a20 2020 2020 2020 2022 2222  ame:.        """
+0002bf20: 0a20 2020 2020 2020 2054 6869 7320 6675  .        This fu
+0002bf30: 6e63 7469 6f6e 2069 7320 7573 6564 2074  nction is used t
+0002bf40: 6f20 7072 6564 6963 7420 6c61 6265 6c20  o predict label 
+0002bf50: 616e 6420 7072 6f62 6162 696c 6974 7920  and probability 
+0002bf60: 7363 6f72 6520 6f6e 2074 6865 206e 6577  score on the new
+0002bf70: 2064 6174 6173 6574 0a20 2020 2020 2020   dataset.       
+0002bf80: 2075 7369 6e67 2061 2074 7261 696e 6564   using a trained
+0002bf90: 2065 7374 696d 6174 6f72 2e20 4e65 7720   estimator. New 
+0002bfa0: 756e 7365 656e 2064 6174 6120 6361 6e20  unseen data can 
+0002bfb0: 6265 2070 6173 7365 6420 746f 2064 6174  be passed to dat
+0002bfc0: 6120 7061 7261 6d65 7465 7220 6173 2070  a parameter as p
+0002bfd0: 616e 6461 730a 2020 2020 2020 2020 4461  andas.        Da
+0002bfe0: 7461 6672 616d 652e 2049 6620 6461 7461  taframe. If data
+0002bff0: 2069 7320 6e6f 7420 7061 7373 6564 2c20   is not passed, 
+0002c000: 7468 6520 7465 7374 202f 2068 6f6c 642d  the test / hold-
+0002c010: 6f75 7420 7365 7420 7365 7061 7261 7465  out set separate
+0002c020: 6420 6174 2074 6865 2074 696d 6520 6f66  d at the time of
+0002c030: 0a20 2020 2020 2020 2073 6574 7570 2829  .        setup()
+0002c040: 2069 7320 7573 6564 2074 6f20 6765 6e65   is used to gene
+0002c050: 7261 7465 2070 7265 6469 6374 696f 6e73  rate predictions
+0002c060: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
+0002c070: 6c65 0a20 2020 2020 2020 202d 2d2d 2d2d  le.        -----
+0002c080: 2d2d 0a20 2020 2020 2020 203e 3e3e 2066  --.        >>> f
+0002c090: 726f 6d20 7079 6361 7265 742e 6461 7461  rom pycaret.data
+0002c0a0: 7365 7473 2069 6d70 6f72 7420 6765 745f  sets import get_
+0002c0b0: 6461 7461 0a20 2020 2020 2020 203e 3e3e  data.        >>>
+0002c0c0: 206a 7569 6365 203d 2067 6574 5f64 6174   juice = get_dat
+0002c0d0: 6128 276a 7569 6365 2729 0a20 2020 2020  a('juice').     
+0002c0e0: 2020 203e 3e3e 2065 7870 6572 696d 656e     >>> experimen
+0002c0f0: 745f 6e61 6d65 203d 2073 6574 7570 2864  t_name = setup(d
+0002c100: 6174 6120 3d20 6a75 6963 652c 2020 7461  ata = juice,  ta
+0002c110: 7267 6574 203d 2027 5075 7263 6861 7365  rget = 'Purchase
+0002c120: 2729 0a20 2020 2020 2020 203e 3e3e 206c  ').        >>> l
+0002c130: 7220 3d20 6372 6561 7465 5f6d 6f64 656c  r = create_model
+0002c140: 2827 6c72 2729 0a20 2020 2020 2020 203e  ('lr').        >
+0002c150: 3e3e 206c 725f 7072 6564 6963 7469 6f6e  >> lr_prediction
+0002c160: 735f 686f 6c64 6f75 7420 3d20 7072 6564  s_holdout = pred
+0002c170: 6963 745f 6d6f 6465 6c28 6c72 290a 0a20  ict_model(lr).. 
+0002c180: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0002c190: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0002c1a0: 2d2d 2d2d 0a20 2020 2020 2020 2065 7374  ----.        est
+0002c1b0: 696d 6174 6f72 203a 206f 626a 6563 742c  imator : object,
+0002c1c0: 2064 6566 6175 6c74 203d 206e 6f6e 650a   default = none.
+0002c1d0: 2020 2020 2020 2020 2020 2020 4120 7472              A tr
+0002c1e0: 6169 6e65 6420 6d6f 6465 6c20 6f62 6a65  ained model obje
+0002c1f0: 6374 202f 2070 6970 656c 696e 6520 7368  ct / pipeline sh
+0002c200: 6f75 6c64 2062 6520 7061 7373 6564 2061  ould be passed a
+0002c210: 7320 616e 2065 7374 696d 6174 6f72 2e0a  s an estimator..
+0002c220: 0a20 2020 2020 2020 2064 6174 6120 3a20  .        data : 
+0002c230: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
+0002c240: 0a20 2020 2020 2020 2020 2020 2053 6861  .            Sha
+0002c250: 7065 2028 6e5f 7361 6d70 6c65 732c 206e  pe (n_samples, n
+0002c260: 5f66 6561 7475 7265 7329 2077 6865 7265  _features) where
+0002c270: 206e 5f73 616d 706c 6573 2069 7320 7468   n_samples is th
+0002c280: 6520 6e75 6d62 6572 206f 6620 7361 6d70  e number of samp
+0002c290: 6c65 730a 2020 2020 2020 2020 2020 2020  les.            
+0002c2a0: 616e 6420 6e5f 6665 6174 7572 6573 2069  and n_features i
+0002c2b0: 7320 7468 6520 6e75 6d62 6572 206f 6620  s the number of 
+0002c2c0: 6665 6174 7572 6573 2e20 416c 6c20 6665  features. All fe
+0002c2d0: 6174 7572 6573 2075 7365 6420 6475 7269  atures used duri
+0002c2e0: 6e67 2074 7261 696e 696e 670a 2020 2020  ng training.    
+0002c2f0: 2020 2020 2020 2020 6d75 7374 2062 6520          must be 
+0002c300: 7072 6573 656e 7420 696e 2074 6865 206e  present in the n
+0002c310: 6577 2064 6174 6173 6574 2e0a 0a20 2020  ew dataset...   
+0002c320: 2020 2020 2070 726f 6261 6269 6c69 7479       probability
+0002c330: 5f74 6872 6573 686f 6c64 203a 2066 6c6f  _threshold : flo
+0002c340: 6174 2c20 6465 6661 756c 7420 3d20 4e6f  at, default = No
+0002c350: 6e65 0a20 2020 2020 2020 2020 2020 2054  ne.            T
+0002c360: 6872 6573 686f 6c64 2075 7365 6420 746f  hreshold used to
+0002c370: 2063 6f6e 7665 7274 2070 726f 6261 6269   convert probabi
+0002c380: 6c69 7479 2076 616c 7565 7320 696e 746f  lity values into
+0002c390: 2062 696e 6172 7920 6f75 7463 6f6d 652e   binary outcome.
+0002c3a0: 2042 7920 6465 6661 756c 740a 2020 2020   By default.    
+0002c3b0: 2020 2020 2020 2020 7468 6520 7072 6f62          the prob
+0002c3c0: 6162 696c 6974 7920 7468 7265 7368 6f6c  ability threshol
+0002c3d0: 6420 666f 7220 616c 6c20 6269 6e61 7279  d for all binary
+0002c3e0: 2063 6c61 7373 6966 6965 7273 2069 7320   classifiers is 
+0002c3f0: 302e 3520 2835 3025 292e 2054 6869 7320  0.5 (50%). This 
+0002c400: 6361 6e20 6265 0a20 2020 2020 2020 2020  can be.         
+0002c410: 2020 2063 6861 6e67 6564 2075 7369 6e67     changed using
+0002c420: 2070 726f 6261 6269 6c69 7479 5f74 6872   probability_thr
+0002c430: 6573 686f 6c64 2070 6172 616d 2e0a 0a20  eshold param... 
+0002c440: 2020 2020 2020 2065 6e63 6f64 6564 5f6c         encoded_l
+0002c450: 6162 656c 733a 2042 6f6f 6c65 616e 2c20  abels: Boolean, 
+0002c460: 6465 6661 756c 7420 3d20 4661 6c73 650a  default = False.
+0002c470: 2020 2020 2020 2020 2020 2020 4966 2054              If T
+0002c480: 7275 652c 2077 696c 6c20 7265 7475 726e  rue, will return
+0002c490: 206c 6162 656c 7320 656e 636f 6465 6420   labels encoded 
+0002c4a0: 6173 2061 6e20 696e 7465 6765 722e 0a0a  as an integer...
+0002c4b0: 2020 2020 2020 2020 7261 775f 7363 6f72          raw_scor
+0002c4c0: 653a 2062 6f6f 6c2c 2064 6566 6175 6c74  e: bool, default
+0002c4d0: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+0002c4e0: 2020 2020 2057 6865 6e20 7365 7420 746f       When set to
+0002c4f0: 2054 7275 652c 2073 636f 7265 7320 666f   True, scores fo
+0002c500: 7220 616c 6c20 6c61 6265 6c73 2077 696c  r all labels wil
+0002c510: 6c20 6265 2072 6574 7572 6e65 642e 0a0a  l be returned...
+0002c520: 2020 2020 2020 2020 726f 756e 643a 2069          round: i
+0002c530: 6e74 6567 6572 2c20 6465 6661 756c 7420  nteger, default 
+0002c540: 3d20 340a 2020 2020 2020 2020 2020 2020  = 4.            
+0002c550: 4e75 6d62 6572 206f 6620 6465 6369 6d61  Number of decima
+0002c560: 6c20 706c 6163 6573 2074 6865 206d 6574  l places the met
+0002c570: 7269 6373 2069 6e20 7468 6520 7363 6f72  rics in the scor
+0002c580: 6520 6772 6964 2077 696c 6c20 6265 2072  e grid will be r
+0002c590: 6f75 6e64 6564 2074 6f2e 0a0a 2020 2020  ounded to...    
+0002c5a0: 2020 2020 7665 7262 6f73 653a 2062 6f6f      verbose: boo
+0002c5b0: 6c2c 2064 6566 6175 6c74 203d 2054 7275  l, default = Tru
+0002c5c0: 650a 2020 2020 2020 2020 2020 2020 486f  e.            Ho
+0002c5d0: 6c64 6f75 7420 7363 6f72 6520 6772 6964  ldout score grid
+0002c5e0: 2069 7320 6e6f 7420 7072 696e 7465 6420   is not printed 
+0002c5f0: 7768 656e 2076 6572 626f 7365 2069 7320  when verbose is 
+0002c600: 7365 7420 746f 2046 616c 7365 2e0a 0a20  set to False... 
+0002c610: 2020 2020 2020 2070 7265 7072 6f63 6573         preproces
+0002c620: 733a 2062 6f6f 6c20 6f72 2027 6665 6174  s: bool or 'feat
+0002c630: 7572 6573 272c 2064 6566 6175 6c74 203d  ures', default =
+0002c640: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+0002c650: 2020 5768 6574 6865 7220 746f 2070 7265    Whether to pre
+0002c660: 7072 6f63 6573 7320 756e 7365 656e 2064  process unseen d
+0002c670: 6174 612e 2049 6620 2766 6561 7475 7265  ata. If 'feature
+0002c680: 7327 2c20 7769 6c6c 206e 6f74 0a20 2020  s', will not.   
+0002c690: 2020 2020 2020 2020 2070 7265 7072 6f63           preproc
+0002c6a0: 6573 7320 6c61 6265 6c73 2e0a 0a20 2020  ess labels...   
+0002c6b0: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
+0002c6c0: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+0002c6d0: 2020 2020 2050 7265 6469 6374 696f 6e73       Predictions
+0002c6e0: 0a20 2020 2020 2020 2020 2020 2050 7265  .            Pre
+0002c6f0: 6469 6374 696f 6e73 2028 6c61 6265 6c20  dictions (label 
+0002c700: 616e 6420 7363 6f72 6529 2063 6f6c 756d  and score) colum
+0002c710: 6e73 2061 7265 2061 7474 6163 6865 6420  ns are attached 
+0002c720: 746f 2074 6865 206f 7269 6769 6e61 6c0a  to the original.
+0002c730: 2020 2020 2020 2020 2020 2020 6461 7461              data
+0002c740: 7365 7420 616e 6420 7265 7475 726e 6564  set and returned
+0002c750: 2061 7320 7061 6e64 6173 2064 6174 6166   as pandas dataf
+0002c760: 7261 6d65 2e0a 0a20 2020 2020 2020 2073  rame...        s
+0002c770: 636f 7265 5f67 7269 640a 2020 2020 2020  core_grid.      
+0002c780: 2020 2020 2020 4120 7461 626c 6520 636f        A table co
+0002c790: 6e74 6169 6e69 6e67 2074 6865 2073 636f  ntaining the sco
+0002c7a0: 7269 6e67 206d 6574 7269 6373 206f 6e20  ring metrics on 
+0002c7b0: 686f 6c64 2d6f 7574 202f 2074 6573 7420  hold-out / test 
+0002c7c0: 7365 742e 0a0a 2020 2020 2020 2020 5761  set...        Wa
+0002c7d0: 726e 696e 6773 0a20 2020 2020 2020 202d  rnings.        -
+0002c7e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0002c7f0: 2d20 5468 6520 6265 6861 7669 6f72 206f  - The behavior o
+0002c800: 6620 7468 6520 7072 6564 6963 745f 6d6f  f the predict_mo
+0002c810: 6465 6c20 6973 2063 6861 6e67 6564 2069  del is changed i
+0002c820: 6e20 7665 7273 696f 6e20 322e 3120 7769  n version 2.1 wi
+0002c830: 7468 6f75 7420 6261 636b 7761 7264 2063  thout backward c
+0002c840: 6f6d 7061 7469 6269 6c69 7479 2e0a 2020  ompatibility..  
+0002c850: 2020 2020 2020 4173 2073 7563 682c 2074        As such, t
+0002c860: 6865 2070 6970 656c 696e 6573 2074 7261  he pipelines tra
+0002c870: 696e 6564 2075 7369 6e67 2074 6865 2076  ined using the v
+0002c880: 6572 7369 6f6e 2028 3c3d 2032 2e30 292c  ersion (<= 2.0),
+0002c890: 206d 6179 206e 6f74 2077 6f72 6b20 666f   may not work fo
+0002c8a0: 7220 696e 6665 7265 6e63 650a 2020 2020  r inference.    
+0002c8b0: 2020 2020 7769 7468 2076 6572 7369 6f6e      with version
+0002c8c0: 203e 3d20 322e 312e 2059 6f75 2063 616e   >= 2.1. You can
+0002c8d0: 2065 6974 6865 7220 7265 7472 6169 6e20   either retrain 
+0002c8e0: 796f 7572 206d 6f64 656c 7320 7769 7468  your models with
+0002c8f0: 2061 206e 6577 6572 2076 6572 7369 6f6e   a newer version
+0002c900: 206f 7220 646f 776e 6772 6164 650a 2020   or downgrade.  
+0002c910: 2020 2020 2020 7468 6520 7665 7273 696f        the versio
+0002c920: 6e20 666f 7220 696e 6665 7265 6e63 652e  n for inference.
+0002c930: 0a0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+0002c940: 2020 2020 2020 2064 6566 2065 6e63 6f64         def encod
+0002c950: 655f 6c61 6265 6c73 286c 6162 656c 5f65  e_labels(label_e
+0002c960: 6e63 6f64 6572 2c20 6c61 6265 6c73 3a20  ncoder, labels: 
+0002c970: 7064 2e53 6572 6965 7329 202d 3e20 7064  pd.Series) -> pd
+0002c980: 2e53 6572 6965 733a 0a20 2020 2020 2020  .Series:.       
+0002c990: 2020 2020 2023 2043 6865 636b 2069 6620       # Check if 
+0002c9a0: 7468 6572 6520 6973 2061 204c 6162 656c  there is a Label
+0002c9b0: 456e 636f 6465 7220 696e 2074 6865 2070  Encoder in the p
+0002c9c0: 6970 656c 696e 650a 2020 2020 2020 2020  ipeline.        
+0002c9d0: 2020 2020 6966 206c 6162 656c 5f65 6e63      if label_enc
+0002c9e0: 6f64 6572 3a0a 2020 2020 2020 2020 2020  oder:.          
+0002c9f0: 2020 2020 2020 7265 7475 726e 2070 642e        return pd.
+0002ca00: 5365 7269 6573 280a 2020 2020 2020 2020  Series(.        
+0002ca10: 2020 2020 2020 2020 2020 2020 6461 7461              data
+0002ca20: 3d6c 6162 656c 5f65 6e63 6f64 6572 2e74  =label_encoder.t
+0002ca30: 7261 6e73 666f 726d 286c 6162 656c 7329  ransform(labels)
+0002ca40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002ca50: 2020 2020 2020 6e61 6d65 3d6c 6162 656c        name=label
+0002ca60: 732e 6e61 6d65 2c0a 2020 2020 2020 2020  s.name,.        
+0002ca70: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+0002ca80: 783d 6c61 6265 6c73 2e69 6e64 6578 2c0a  x=labels.index,.
+0002ca90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002caa0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+0002cab0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0002cac0: 2020 2020 7265 7475 726e 206c 6162 656c      return label
+0002cad0: 730a 0a20 2020 2020 2020 2066 756e 6374  s..        funct
+0002cae0: 696f 6e5f 7061 7261 6d73 5f73 7472 203d  ion_params_str =
+0002caf0: 2022 2c20 222e 6a6f 696e 280a 2020 2020   ", ".join(.    
+0002cb00: 2020 2020 2020 2020 5b66 227b 6b7d 3d7b          [f"{k}={
+0002cb10: 767d 2220 666f 7220 6b2c 2076 2069 6e20  v}" for k, v in 
+0002cb20: 6c6f 6361 6c73 2829 2e69 7465 6d73 2829  locals().items()
+0002cb30: 2069 6620 6b20 213d 2022 6461 7461 225d   if k != "data"]
+0002cb40: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0002cb50: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
+0002cb60: 696e 666f 2822 496e 6974 6961 6c69 7a69  info("Initializi
+0002cb70: 6e67 2070 7265 6469 6374 5f6d 6f64 656c  ng predict_model
+0002cb80: 2829 2229 0a20 2020 2020 2020 2073 656c  ()").        sel
+0002cb90: 662e 6c6f 6767 6572 2e69 6e66 6f28 6622  f.logger.info(f"
+0002cba0: 7072 6564 6963 745f 6d6f 6465 6c28 7b66  predict_model({f
+0002cbb0: 756e 6374 696f 6e5f 7061 7261 6d73 5f73  unction_params_s
+0002cbc0: 7472 7d29 2229 0a0a 2020 2020 2020 2020  tr})")..        
+0002cbd0: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
+0002cbe0: 2822 4368 6563 6b69 6e67 2065 7863 6570  ("Checking excep
+0002cbf0: 7469 6f6e 7322 290a 0a20 2020 2020 2020  tions")..       
+0002cc00: 2022 2222 0a20 2020 2020 2020 2065 7863   """.        exc
+0002cc10: 6570 7469 6f6e 2063 6865 636b 696e 6720  eption checking 
+0002cc20: 7374 6172 7473 2068 6572 650a 2020 2020  starts here.    
+0002cc30: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+0002cc40: 2069 6620 6d6c 5f75 7365 6361 7365 2069   if ml_usecase i
+0002cc50: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0002cc60: 2020 2020 6d6c 5f75 7365 6361 7365 203d      ml_usecase =
+0002cc70: 2073 656c 662e 5f6d 6c5f 7573 6563 6173   self._ml_usecas
+0002cc80: 650a 0a20 2020 2020 2020 2069 6620 6461  e..        if da
+0002cc90: 7461 2069 7320 4e6f 6e65 2061 6e64 206e  ta is None and n
+0002cca0: 6f74 2073 656c 662e 5f73 6574 7570 5f72  ot self._setup_r
+0002ccb0: 616e 3a0a 2020 2020 2020 2020 2020 2020  an:.            
+0002ccc0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0002ccd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002cce0: 2020 2264 6174 6120 7061 7261 6d65 7465    "data paramete
+0002ccf0: 7220 6d61 7920 6e6f 7420 6265 204e 6f6e  r may not be Non
+0002cd00: 6520 7769 7468 6f75 7420 7275 6e6e 696e  e without runnin
+0002cd10: 6720 7365 7475 7028 2920 6669 7273 742e  g setup() first.
+0002cd20: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+0002cd30: 0a20 2020 2020 2020 2069 6620 7072 6f62  .        if prob
+0002cd40: 6162 696c 6974 795f 7468 7265 7368 6f6c  ability_threshol
+0002cd50: 6420 6973 206e 6f74 204e 6f6e 653a 0a20  d is not None:. 
+0002cd60: 2020 2020 2020 2020 2020 2023 2070 726f             # pro
+0002cd70: 6261 6269 6c69 7479 5f74 6872 6573 686f  bability_thresho
+0002cd80: 6c64 2061 6c6c 6f77 6564 2074 7970 6573  ld allowed types
+0002cd90: 0a20 2020 2020 2020 2020 2020 2061 6c6c  .            all
+0002cda0: 6f77 6564 5f74 7970 6573 203d 205b 696e  owed_types = [in
+0002cdb0: 742c 2066 6c6f 6174 5d0a 2020 2020 2020  t, float].      
+0002cdc0: 2020 2020 2020 6966 2028 0a20 2020 2020        if (.     
+0002cdd0: 2020 2020 2020 2020 2020 2074 7970 6528             type(
+0002cde0: 7072 6f62 6162 696c 6974 795f 7468 7265  probability_thre
+0002cdf0: 7368 6f6c 6429 206e 6f74 2069 6e20 616c  shold) not in al
+0002ce00: 6c6f 7765 645f 7479 7065 730a 2020 2020  lowed_types.    
+0002ce10: 2020 2020 2020 2020 2020 2020 6f72 2070              or p
+0002ce20: 726f 6261 6269 6c69 7479 5f74 6872 6573  robability_thres
+0002ce30: 686f 6c64 203e 2031 0a20 2020 2020 2020  hold > 1.       
+0002ce40: 2020 2020 2020 2020 206f 7220 7072 6f62           or prob
+0002ce50: 6162 696c 6974 795f 7468 7265 7368 6f6c  ability_threshol
+0002ce60: 6420 3c20 300a 2020 2020 2020 2020 2020  d < 0.          
+0002ce70: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+0002ce80: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+0002ce90: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0002cea0: 2020 2020 2020 2020 2020 2270 726f 6261            "proba
+0002ceb0: 6269 6c69 7479 5f74 6872 6573 686f 6c64  bility_threshold
+0002cec0: 2070 6172 616d 6574 6572 206f 6e6c 7920   parameter only 
+0002ced0: 6163 6365 7074 7320 7661 6c75 6520 6265  accepts value be
+0002cee0: 7477 6565 6e20 3020 746f 2031 2e22 0a20  tween 0 to 1.". 
+0002cef0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0002cf00: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0002cf10: 2020 2020 2020 6578 6365 7074 696f 6e20        exception 
+0002cf20: 6368 6563 6b69 6e67 2065 6e64 7320 6865  checking ends he
+0002cf30: 7265 0a20 2020 2020 2020 2022 2222 0a0a  re.        """..
+0002cf40: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+0002cf50: 6765 722e 696e 666f 2822 5072 656c 6f61  ger.info("Preloa
+0002cf60: 6469 6e67 206c 6962 7261 7269 6573 2229  ding libraries")
+0002cf70: 0a0a 2020 2020 2020 2020 7472 793a 0a20  ..        try:. 
+0002cf80: 2020 2020 2020 2020 2020 206e 702e 7261             np.ra
+0002cf90: 6e64 6f6d 2e73 6565 6428 7365 6c66 2e73  ndom.seed(self.s
+0002cfa0: 6565 6429 0a20 2020 2020 2020 2020 2020  eed).           
+0002cfb0: 2064 6973 706c 6179 203d 2043 6f6d 6d6f   display = Commo
+0002cfc0: 6e44 6973 706c 6179 280a 2020 2020 2020  nDisplay(.      
+0002cfd0: 2020 2020 2020 2020 2020 7665 7262 6f73            verbos
+0002cfe0: 653d 7665 7262 6f73 652c 0a20 2020 2020  e=verbose,.     
+0002cff0: 2020 2020 2020 2020 2020 2068 746d 6c5f             html_
+0002d000: 7061 7261 6d3d 7365 6c66 2e68 746d 6c5f  param=self.html_
+0002d010: 7061 7261 6d2c 0a20 2020 2020 2020 2020  param,.         
+0002d020: 2020 2029 0a20 2020 2020 2020 2065 7863     ).        exc
+0002d030: 6570 7420 4578 6365 7074 696f 6e3a 0a20  ept Exception:. 
+0002d040: 2020 2020 2020 2020 2020 2064 6973 706c             displ
+0002d050: 6179 203d 2043 6f6d 6d6f 6e44 6973 706c  ay = CommonDispl
+0002d060: 6179 280a 2020 2020 2020 2020 2020 2020  ay(.            
+0002d070: 2020 2020 7665 7262 6f73 653d 4661 6c73      verbose=Fals
+0002d080: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0002d090: 2020 2068 746d 6c5f 7061 7261 6d3d 4661     html_param=Fa
+0002d0a0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+0002d0b0: 2029 0a0a 2020 2020 2020 2020 6966 2069   )..        if i
+0002d0c0: 7369 6e73 7461 6e63 6528 6573 7469 6d61  sinstance(estima
+0002d0d0: 746f 722c 2073 6b50 6970 656c 696e 6529  tor, skPipeline)
+0002d0e0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0002d0f0: 206e 6f74 2068 6173 6174 7472 2865 7374   not hasattr(est
+0002d100: 696d 6174 6f72 2c20 2266 6561 7475 7265  imator, "feature
+0002d110: 5f6e 616d 6573 5f69 6e5f 2229 3a0a 2020  _names_in_"):.  
+0002d120: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0002d130: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+0002d140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d150: 2020 2020 2249 6620 6573 7469 6d61 746f      "If estimato
+0002d160: 7220 6973 2061 2050 6970 656c 696e 652c  r is a Pipeline,
+0002d170: 2069 7420 6d75 7374 2069 6d70 6c65 6d65   it must impleme
+0002d180: 6e74 2060 6665 6174 7572 655f 6e61 6d65  nt `feature_name
+0002d190: 735f 696e 5f60 2e22 0a20 2020 2020 2020  s_in_`.".       
+0002d1a0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0002d1b0: 2020 2020 2020 2023 2057 6520 7573 6520         # We use 
+0002d1c0: 636f 7079 2069 6e73 7465 6164 206f 6620  copy instead of 
+0002d1d0: 6465 6570 636f 7079 2062 6563 6175 7365  deepcopy because
+0002d1e0: 206f 6620 6874 7470 733a 2f2f 6769 7468   of https://gith
+0002d1f0: 7562 2e63 6f6d 2f70 7963 6172 6574 2f70  ub.com/pycaret/p
+0002d200: 7963 6172 6574 2f69 7373 7565 732f 3237  ycaret/issues/27
+0002d210: 3639 0a20 2020 2020 2020 2020 2020 2023  69.            #
+0002d220: 2043 6174 626f 6f73 7420 6265 6861 7665   Catboost behave
+0002d230: 7320 7374 7261 6e67 6520 7768 656e 2064  s strange when d
+0002d240: 6565 7020 636f 7069 6564 2e20 5573 696e  eep copied. Usin
+0002d250: 6720 636f 7079 2069 7320 6669 6e65 0a20  g copy is fine. 
+0002d260: 2020 2020 2020 2020 2020 2023 2073 696e             # sin
+0002d270: 6365 2074 6865 2075 6e64 6572 6c79 696e  ce the underlyin
+0002d280: 6720 6573 7469 6d61 746f 7273 2061 7265  g estimators are
+0002d290: 206f 6e6c 7920 7573 6564 2066 6f72 2074   only used for t
+0002d2a0: 7261 6e73 666f 726d 0a20 2020 2020 2020  ransform.       
+0002d2b0: 2020 2020 2070 6970 656c 696e 6520 3d20       pipeline = 
+0002d2c0: 636f 7079 2865 7374 696d 6174 6f72 290a  copy(estimator).
+0002d2d0: 0a20 2020 2020 2020 2020 2020 2023 2054  .            # T
+0002d2e0: 656d 706f 7261 7269 6c79 2072 656d 6f76  emporarily remov
+0002d2f0: 6520 6669 6e61 6c20 6573 7469 6d61 746f  e final estimato
+0002d300: 7220 736f 2069 7427 7320 6e6f 7420 7573  r so it's not us
+0002d310: 6564 2066 6f72 2074 7261 6e73 666f 726d  ed for transform
+0002d320: 0a20 2020 2020 2020 2020 2020 2066 696e  .            fin
+0002d330: 616c 5f73 7465 7020 3d20 7069 7065 6c69  al_step = pipeli
+0002d340: 6e65 2e73 7465 7073 5b2d 315d 0a20 2020  ne.steps[-1].   
+0002d350: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
+0002d360: 6f72 203d 2066 696e 616c 5f73 7465 705b  or = final_step[
+0002d370: 2d31 5d0a 2020 2020 2020 2020 2020 2020  -1].            
+0002d380: 7069 7065 6c69 6e65 2e73 7465 7073 203d  pipeline.steps =
+0002d390: 2070 6970 656c 696e 652e 7374 6570 735b   pipeline.steps[
+0002d3a0: 3a2d 315d 0a20 2020 2020 2020 2065 6c69  :-1].        eli
+0002d3b0: 6620 6e6f 7420 7365 6c66 2e5f 7365 7475  f not self._setu
+0002d3c0: 705f 7261 6e3a 0a20 2020 2020 2020 2020  p_ran:.         
+0002d3d0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0002d3e0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+0002d3f0: 2020 2020 2022 4966 2065 7374 696d 6174       "If estimat
+0002d400: 6f72 2069 7320 6e6f 7420 6120 5069 7065  or is not a Pipe
+0002d410: 6c69 6e65 2c20 796f 7520 6d75 7374 2072  line, you must r
+0002d420: 756e 2073 6574 7570 2829 2066 6972 7374  un setup() first
+0002d430: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
+0002d440: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0002d450: 2020 2020 2020 2020 2020 2070 6970 656c             pipel
+0002d460: 696e 6520 3d20 7365 6c66 2e70 6970 656c  ine = self.pipel
+0002d470: 696e 650a 2020 2020 2020 2020 2020 2020  ine.            
+0002d480: 6669 6e61 6c5f 7374 6570 203d 204e 6f6e  final_step = Non
+0002d490: 650a 0a20 2020 2020 2020 2058 5f63 6f6c  e..        X_col
+0002d4a0: 756d 6e73 203d 2070 6970 656c 696e 652e  umns = pipeline.
+0002d4b0: 6665 6174 7572 655f 6e61 6d65 735f 696e  feature_names_in
+0002d4c0: 5f5b 3a2d 315d 0a20 2020 2020 2020 2079  _[:-1].        y
+0002d4d0: 5f6e 616d 6520 3d20 7069 7065 6c69 6e65  _name = pipeline
+0002d4e0: 2e66 6561 7475 7265 5f6e 616d 6573 5f69  .feature_names_i
+0002d4f0: 6e5f 5b2d 315d 0a20 2020 2020 2020 2079  n_[-1].        y
+0002d500: 5f74 6573 745f 203d 204e 6f6e 650a 2020  _test_ = None.  
+0002d510: 2020 2020 2020 6966 2064 6174 6120 6973        if data is
+0002d520: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0002d530: 2020 2058 5f74 6573 745f 2c20 795f 7465     X_test_, y_te
+0002d540: 7374 5f20 3d20 7365 6c66 2e58 5f74 6573  st_ = self.X_tes
+0002d550: 745f 7472 616e 7366 6f72 6d65 642c 2073  t_transformed, s
+0002d560: 656c 662e 795f 7465 7374 5f74 7261 6e73  elf.y_test_trans
+0002d570: 666f 726d 6564 0a20 2020 2020 2020 2020  formed.         
+0002d580: 2020 2058 5f74 6573 745f 756e 7472 616e     X_test_untran
+0002d590: 7366 6f72 6d65 642c 2079 5f74 6573 745f  sformed, y_test_
+0002d5a0: 756e 7472 616e 7366 6f72 6d65 6420 3d20  untransformed = 
+0002d5b0: 7365 6c66 2e58 5f74 6573 742c 2073 656c  self.X_test, sel
+0002d5c0: 662e 795f 7465 7374 0a20 2020 2020 2020  f.y_test.       
+0002d5d0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0002d5e0: 2020 2069 6620 795f 6e61 6d65 2069 6e20     if y_name in 
+0002d5f0: 6461 7461 2e63 6f6c 756d 6e73 3a0a 2020  data.columns:.  
+0002d600: 2020 2020 2020 2020 2020 2020 2020 6461                da
+0002d610: 7461 203d 2073 656c 662e 5f73 6574 5f69  ta = self._set_i
+0002d620: 6e64 6578 2873 656c 662e 5f70 7265 7061  ndex(self._prepa
+0002d630: 7265 5f64 6174 6173 6574 2864 6174 612c  re_dataset(data,
+0002d640: 2079 5f6e 616d 6529 290a 2020 2020 2020   y_name)).      
+0002d650: 2020 2020 2020 2020 2020 7461 7267 6574            target
+0002d660: 203d 2064 6174 615b 795f 6e61 6d65 5d0a   = data[y_name].
+0002d670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d680: 6461 7461 203d 2064 6174 612e 6472 6f70  data = data.drop
+0002d690: 2879 5f6e 616d 652c 2061 7869 733d 3129  (y_name, axis=1)
+0002d6a0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0002d6b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0002d6c0: 2020 2064 6174 6120 3d20 7365 6c66 2e5f     data = self._
+0002d6d0: 7365 745f 696e 6465 7828 7365 6c66 2e5f  set_index(self._
+0002d6e0: 7072 6570 6172 655f 6461 7461 7365 7428  prepare_dataset(
+0002d6f0: 6461 7461 2929 0a20 2020 2020 2020 2020  data)).         
+0002d700: 2020 2020 2020 2074 6172 6765 7420 3d20         target = 
+0002d710: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+0002d720: 2058 5f74 6573 745f 756e 7472 616e 7366   X_test_untransf
+0002d730: 6f72 6d65 6420 3d20 6461 7461 0a20 2020  ormed = data.   
+0002d740: 2020 2020 2020 2020 2079 5f74 6573 745f           y_test_
+0002d750: 756e 7472 616e 7366 6f72 6d65 6420 3d20  untransformed = 
+0002d760: 7461 7267 6574 0a20 2020 2020 2020 2020  target.         
+0002d770: 2020 2064 6174 6120 3d20 6461 7461 5b58     data = data[X
+0002d780: 5f63 6f6c 756d 6e73 5d20 2023 2049 676e  _columns]  # Ign
+0002d790: 6f72 6520 616c 6c20 636f 6c75 6d6e 7320  ore all columns 
+0002d7a0: 6275 7420 7468 6520 6f72 6967 696e 616c  but the original
+0002d7b0: 730a 2020 2020 2020 2020 2020 2020 6966  s.            if
+0002d7c0: 2070 7265 7072 6f63 6573 733a 0a20 2020   preprocess:.   
+0002d7d0: 2020 2020 2020 2020 2020 2020 2058 5f74               X_t
+0002d7e0: 6573 745f 203d 2070 6970 656c 696e 652e  est_ = pipeline.
+0002d7f0: 7472 616e 7366 6f72 6d28 0a20 2020 2020  transform(.     
+0002d800: 2020 2020 2020 2020 2020 2020 2020 2058                 X
+0002d810: 3d64 6174 612c 0a20 2020 2020 2020 2020  =data,.         
+0002d820: 2020 2020 2020 2020 2020 2079 3d28 7461             y=(ta
+0002d830: 7267 6574 2069 6620 7072 6570 726f 6365  rget if preproce
+0002d840: 7373 2021 3d20 2266 6561 7475 7265 7322  ss != "features"
+0002d850: 2065 6c73 6520 4e6f 6e65 292c 0a20 2020   else None),.   
+0002d860: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+0002d870: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002d880: 6620 6669 6e61 6c5f 7374 6570 3a0a 2020  f final_step:.  
+0002d890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d8a0: 2020 7069 7065 6c69 6e65 2e73 7465 7073    pipeline.steps
+0002d8b0: 2e61 7070 656e 6428 6669 6e61 6c5f 7374  .append(final_st
+0002d8c0: 6570 290a 0a20 2020 2020 2020 2020 2020  ep)..           
+0002d8d0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0002d8e0: 6365 2858 5f74 6573 745f 2c20 7475 706c  ce(X_test_, tupl
+0002d8f0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+0002d900: 2020 2020 2020 2020 585f 7465 7374 5f2c          X_test_,
+0002d910: 2079 5f74 6573 745f 203d 2058 5f74 6573   y_test_ = X_tes
+0002d920: 745f 0a20 2020 2020 2020 2020 2020 2020  t_.             
+0002d930: 2020 2065 6c69 6620 7461 7267 6574 2069     elif target i
+0002d940: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0002d950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d960: 795f 7465 7374 5f20 3d20 7461 7267 6574  y_test_ = target
+0002d970: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0002d980: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0002d990: 2020 2058 5f74 6573 745f 203d 2064 6174     X_test_ = dat
+0002d9a0: 610a 2020 2020 2020 2020 2020 2020 2020  a.              
+0002d9b0: 2020 795f 7465 7374 5f20 3d20 7461 7267    y_test_ = targ
+0002d9c0: 6574 0a0a 2020 2020 2020 2020 2320 7072  et..        # pr
+0002d9d0: 6564 6963 7469 6f6e 2073 7461 7274 7320  ediction starts 
+0002d9e0: 6865 7265 0a20 2020 2020 2020 2069 6620  here.        if 
+0002d9f0: 6973 696e 7374 616e 6365 2865 7374 696d  isinstance(estim
+0002da00: 6174 6f72 2c20 4375 7374 6f6d 5072 6f62  ator, CustomProb
+0002da10: 6162 696c 6974 7954 6872 6573 686f 6c64  abilityThreshold
+0002da20: 436c 6173 7369 6669 6572 293a 0a20 2020  Classifier):.   
+0002da30: 2020 2020 2020 2020 2069 6620 7072 6f62           if prob
+0002da40: 6162 696c 6974 795f 7468 7265 7368 6f6c  ability_threshol
+0002da50: 6420 6973 204e 6f6e 653a 0a20 2020 2020  d is None:.     
+0002da60: 2020 2020 2020 2020 2020 2070 726f 6261             proba
+0002da70: 6269 6c69 7479 5f74 6872 6573 686f 6c64  bility_threshold
+0002da80: 203d 2065 7374 696d 6174 6f72 2e70 726f   = estimator.pro
+0002da90: 6261 6269 6c69 7479 5f74 6872 6573 686f  bability_thresho
+0002daa0: 6c64 0a20 2020 2020 2020 2020 2020 2065  ld.            e
+0002dab0: 7374 696d 6174 6f72 203d 2067 6574 5f65  stimator = get_e
+0002dac0: 7374 696d 6174 6f72 5f66 726f 6d5f 6d65  stimator_from_me
+0002dad0: 7461 5f65 7374 696d 6174 6f72 2865 7374  ta_estimator(est
+0002dae0: 696d 6174 6f72 290a 0a20 2020 2020 2020  imator)..       
+0002daf0: 2070 7265 6420 3d20 6e70 2e6e 616e 5f74   pred = np.nan_t
+0002db00: 6f5f 6e75 6d28 6573 7469 6d61 746f 722e  o_num(estimator.
+0002db10: 7072 6564 6963 7428 585f 7465 7374 5f29  predict(X_test_)
+0002db20: 290a 2020 2020 2020 2020 7072 6564 203d  ).        pred =
+0002db30: 2070 6970 656c 696e 652e 696e 7665 7273   pipeline.invers
+0002db40: 655f 7472 616e 7366 6f72 6d28 7072 6564  e_transform(pred
+0002db50: 290a 2020 2020 2020 2020 2320 4e65 6564  ).        # Need
+0002db60: 2074 6f20 636f 6e76 6572 7420 6c61 6265   to convert labe
+0002db70: 6c73 2062 6163 6b20 746f 206e 756d 6265  ls back to numbe
+0002db80: 7273 0a20 2020 2020 2020 2023 2054 4f44  rs.        # TOD
+0002db90: 4f20 6f70 7469 6d69 7a65 0a20 2020 2020  O optimize.     
+0002dba0: 2020 206c 6162 656c 5f65 6e63 6f64 6572     label_encoder
+0002dbb0: 203d 2067 6574 5f6c 6162 656c 5f65 6e63   = get_label_enc
+0002dbc0: 6f64 6572 2870 6970 656c 696e 6529 0a20  oder(pipeline). 
+0002dbd0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0002dbe0: 616e 6365 2870 7265 642c 2070 642e 5365  ance(pred, pd.Se
+0002dbf0: 7269 6573 293a 0a20 2020 2020 2020 2020  ries):.         
+0002dc00: 2020 2070 7265 6420 3d20 7072 6564 2e76     pred = pred.v
+0002dc10: 616c 7565 730a 0a20 2020 2020 2020 2074  alues..        t
+0002dc20: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+0002dc30: 2320 5468 6973 2069 7320 6120 636c 6173  # This is a clas
+0002dc40: 7369 6669 6572 0a20 2020 2020 2020 2020  sifier.         
+0002dc50: 2020 2073 636f 7265 203d 2065 7374 696d     score = estim
+0002dc60: 6174 6f72 2e70 7265 6469 6374 5f70 726f  ator.predict_pro
+0002dc70: 6261 2858 5f74 6573 745f 290a 0a20 2020  ba(X_test_)..   
+0002dc80: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+0002dc90: 6e70 2e75 6e69 7175 6528 7072 6564 2929  np.unique(pred))
+0002dca0: 203c 3d20 323a 0a20 2020 2020 2020 2020   <= 2:.         
+0002dcb0: 2020 2020 2020 2070 7265 645f 7072 6f62         pred_prob
+0002dcc0: 203d 2073 636f 7265 5b3a 2c20 315d 0a20   = score[:, 1]. 
+0002dcd0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0002dce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002dcf0: 2070 7265 645f 7072 6f62 203d 2073 636f   pred_prob = sco
+0002dd00: 7265 0a0a 2020 2020 2020 2020 6578 6365  re..        exce
+0002dd10: 7074 2045 7863 6570 7469 6f6e 3a0a 2020  pt Exception:.  
+0002dd20: 2020 2020 2020 2020 2020 2320 5468 6973            # This
+0002dd30: 2069 7320 6e6f 7420 6120 636c 6173 7369   is not a classi
+0002dd40: 6669 6572 0a20 2020 2020 2020 2020 2020  fier.           
+0002dd50: 2073 636f 7265 203d 204e 6f6e 650a 2020   score = None.  
+0002dd60: 2020 2020 2020 2020 2020 7072 6564 5f70            pred_p
+0002dd70: 726f 6220 3d20 4e6f 6e65 0a0a 2020 2020  rob = None..    
+0002dd80: 2020 2020 795f 7465 7374 5f6d 6574 7269      y_test_metri
+0002dd90: 6373 203d 2079 5f74 6573 745f 756e 7472  cs = y_test_untr
+0002dda0: 616e 7366 6f72 6d65 640a 0a20 2020 2020  ansformed..     
+0002ddb0: 2020 2069 6620 7072 6f62 6162 696c 6974     if probabilit
+0002ddc0: 795f 7468 7265 7368 6f6c 6420 6973 206e  y_threshold is n
+0002ddd0: 6f74 204e 6f6e 6520 616e 6420 7072 6564  ot None and pred
+0002dde0: 5f70 726f 6220 6973 206e 6f74 204e 6f6e  _prob is not Non
+0002ddf0: 653a 0a20 2020 2020 2020 2020 2020 2074  e:.            t
+0002de00: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+0002de10: 2020 2020 7072 6564 203d 2028 7072 6564      pred = (pred
+0002de20: 5f70 726f 6220 3e3d 2070 726f 6261 6269  _prob >= probabi
+0002de30: 6c69 7479 5f74 6872 6573 686f 6c64 292e  lity_threshold).
+0002de40: 6173 7479 7065 2869 6e74 290a 2020 2020  astype(int).    
+0002de50: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+0002de60: 6162 656c 5f65 6e63 6f64 6572 3a0a 2020  abel_encoder:.  
+0002de70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002de80: 2020 7072 6564 203d 206c 6162 656c 5f65    pred = label_e
+0002de90: 6e63 6f64 6572 2e69 6e76 6572 7365 5f74  ncoder.inverse_t
+0002dea0: 7261 6e73 666f 726d 2870 7265 6429 0a20  ransform(pred). 
+0002deb0: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+0002dec0: 7420 4578 6365 7074 696f 6e3a 0a20 2020  t Exception:.   
+0002ded0: 2020 2020 2020 2020 2020 2020 2070 6173               pas
+0002dee0: 730a 0a20 2020 2020 2020 2069 6620 7072  s..        if pr
+0002def0: 6564 5f70 726f 6220 6973 204e 6f6e 653a  ed_prob is None:
+0002df00: 0a20 2020 2020 2020 2020 2020 2070 7265  .            pre
+0002df10: 645f 7072 6f62 203d 2070 7265 640a 0a20  d_prob = pred.. 
+0002df20: 2020 2020 2020 2064 665f 7363 6f72 6520         df_score 
+0002df30: 3d20 4e6f 6e65 0a20 2020 2020 2020 2069  = None.        i
+0002df40: 6620 795f 7465 7374 5f20 6973 206e 6f74  f y_test_ is not
+0002df50: 204e 6f6e 6520 616e 6420 7365 6c66 2e5f   None and self._
+0002df60: 7365 7475 705f 7261 6e3a 0a20 2020 2020  setup_ran:.     
+0002df70: 2020 2020 2020 2023 206d 6f64 656c 206e         # model n
+0002df80: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
+0002df90: 6675 6c6c 5f6e 616d 6520 3d20 7365 6c66  full_name = self
+0002dfa0: 2e5f 6765 745f 6d6f 6465 6c5f 6e61 6d65  ._get_model_name
+0002dfb0: 2865 7374 696d 6174 6f72 290a 2020 2020  (estimator).    
+0002dfc0: 2020 2020 2020 2020 6d65 7472 6963 7320          metrics 
+0002dfd0: 3d20 7365 6c66 2e5f 6361 6c63 756c 6174  = self._calculat
+0002dfe0: 655f 6d65 7472 6963 7328 795f 7465 7374  e_metrics(y_test
+0002dff0: 5f6d 6574 7269 6373 2c20 7072 6564 2c20  _metrics, pred, 
+0002e000: 7072 6564 5f70 726f 6229 2020 2320 7479  pred_prob)  # ty
+0002e010: 7065 3a20 6967 6e6f 7265 0a20 2020 2020  pe: ignore.     
+0002e020: 2020 2020 2020 2064 665f 7363 6f72 6520         df_score 
+0002e030: 3d20 7064 2e44 6174 6146 7261 6d65 286d  = pd.DataFrame(m
+0002e040: 6574 7269 6373 2c20 696e 6465 783d 5b30  etrics, index=[0
+0002e050: 5d29 0a20 2020 2020 2020 2020 2020 2064  ]).            d
+0002e060: 665f 7363 6f72 652e 696e 7365 7274 2830  f_score.insert(0
+0002e070: 2c20 224d 6f64 656c 222c 2066 756c 6c5f  , "Model", full_
+0002e080: 6e61 6d65 290a 2020 2020 2020 2020 2020  name).          
+0002e090: 2020 6466 5f73 636f 7265 203d 2064 665f    df_score = df_
+0002e0a0: 7363 6f72 652e 726f 756e 6428 726f 756e  score.round(roun
+0002e0b0: 6429 0a20 2020 2020 2020 2020 2020 2064  d).            d
+0002e0c0: 6973 706c 6179 2e64 6973 706c 6179 2864  isplay.display(d
+0002e0d0: 665f 7363 6f72 652e 7374 796c 652e 666f  f_score.style.fo
+0002e0e0: 726d 6174 2870 7265 6369 7369 6f6e 3d72  rmat(precision=r
+0002e0f0: 6f75 6e64 2929 0a0a 2020 2020 2020 2020  ound))..        
+0002e100: 6c61 6265 6c20 3d20 7064 2e44 6174 6146  label = pd.DataF
+0002e110: 7261 6d65 280a 2020 2020 2020 2020 2020  rame(.          
+0002e120: 2020 7072 6564 2c20 636f 6c75 6d6e 733d    pred, columns=
+0002e130: 5b4c 4142 454c 5f43 4f4c 554d 4e5d 2c20  [LABEL_COLUMN], 
+0002e140: 696e 6465 783d 585f 7465 7374 5f75 6e74  index=X_test_unt
+0002e150: 7261 6e73 666f 726d 6564 2e69 6e64 6578  ransformed.index
+0002e160: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0002e170: 2020 2069 6620 6d6c 5f75 7365 6361 7365     if ml_usecase
+0002e180: 203d 3d20 4d4c 5573 6563 6173 652e 434c   == MLUsecase.CL
+0002e190: 4153 5349 4649 4341 5449 4f4e 3a0a 2020  ASSIFICATION:.  
+0002e1a0: 2020 2020 2020 2020 2020 7472 793a 0a20            try:. 
+0002e1b0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0002e1c0: 6162 656c 5b4c 4142 454c 5f43 4f4c 554d  abel[LABEL_COLUM
+0002e1d0: 4e5d 203d 206c 6162 656c 5b4c 4142 454c  N] = label[LABEL
+0002e1e0: 5f43 4f4c 554d 4e5d 2e61 7374 7970 6528  _COLUMN].astype(
+0002e1f0: 696e 7429 0a20 2020 2020 2020 2020 2020  int).           
+0002e200: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
+0002e210: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
+0002e220: 2020 2070 6173 730a 0a20 2020 2020 2020     pass..       
+0002e230: 2069 6620 656e 636f 6465 645f 6c61 6265   if encoded_labe
+0002e240: 6c73 3a0a 2020 2020 2020 2020 2020 2020  ls:.            
+0002e250: 6c61 6265 6c5b 4c41 4245 4c5f 434f 4c55  label[LABEL_COLU
+0002e260: 4d4e 5d20 3d20 656e 636f 6465 5f6c 6162  MN] = encode_lab
+0002e270: 656c 7328 6c61 6265 6c5f 656e 636f 6465  els(label_encode
+0002e280: 722c 206c 6162 656c 5b4c 4142 454c 5f43  r, label[LABEL_C
+0002e290: 4f4c 554d 4e5d 290a 2020 2020 2020 2020  OLUMN]).        
+0002e2a0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0002e2b0: 2020 795f 7465 7374 5f75 6e74 7261 6e73    y_test_untrans
+0002e2c0: 666f 726d 6564 203d 2079 5f74 6573 745f  formed = y_test_
+0002e2d0: 0a20 2020 2020 2020 206f 6c64 5f69 6e64  .        old_ind
+0002e2e0: 6578 203d 2058 5f74 6573 745f 756e 7472  ex = X_test_untr
+0002e2f0: 616e 7366 6f72 6d65 642e 696e 6465 780a  ansformed.index.
+0002e300: 2020 2020 2020 2020 585f 7465 7374 5f20          X_test_ 
+0002e310: 3d20 7064 2e63 6f6e 6361 7428 5b58 5f74  = pd.concat([X_t
+0002e320: 6573 745f 756e 7472 616e 7366 6f72 6d65  est_untransforme
+0002e330: 642c 2079 5f74 6573 745f 756e 7472 616e  d, y_test_untran
+0002e340: 7366 6f72 6d65 642c 206c 6162 656c 5d2c  sformed, label],
+0002e350: 2061 7869 733d 3129 0a20 2020 2020 2020   axis=1).       
+0002e360: 2058 5f74 6573 745f 2e69 6e64 6578 203d   X_test_.index =
+0002e370: 206f 6c64 5f69 6e64 6578 0a0a 2020 2020   old_index..    
+0002e380: 2020 2020 6966 2073 636f 7265 2069 7320      if score is 
+0002e390: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0002e3a0: 2020 2020 2020 6966 206e 6f74 2072 6177        if not raw
+0002e3b0: 5f73 636f 7265 3a0a 2020 2020 2020 2020  _score:.        
+0002e3c0: 2020 2020 2020 2020 6966 206c 6162 656c          if label
+0002e3d0: 5f65 6e63 6f64 6572 3a0a 2020 2020 2020  _encoder:.      
+0002e3e0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0002e3f0: 6564 203d 206c 6162 656c 5f65 6e63 6f64  ed = label_encod
+0002e400: 6572 2e74 7261 6e73 666f 726d 2870 7265  er.transform(pre
+0002e410: 6429 0a0a 2020 2020 2020 2020 2020 2020  d)..            
+0002e420: 2020 2020 7363 6f72 6520 3d20 7064 2e44      score = pd.D
+0002e430: 6174 6146 7261 6d65 280a 2020 2020 2020  ataFrame(.      
+0002e440: 2020 2020 2020 2020 2020 2020 2020 6461                da
+0002e450: 7461 3d5b 735b 7072 6564 5b69 5d5d 2066  ta=[s[pred[i]] f
+0002e460: 6f72 2069 2c20 7320 696e 2065 6e75 6d65  or i, s in enume
+0002e470: 7261 7465 2873 636f 7265 295d 2c0a 2020  rate(score)],.  
+0002e480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e490: 2020 696e 6465 783d 585f 7465 7374 5f2e    index=X_test_.
+0002e4a0: 696e 6465 782c 0a20 2020 2020 2020 2020  index,.         
+0002e4b0: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+0002e4c0: 6e73 3d5b 5343 4f52 455f 434f 4c55 4d4e  ns=[SCORE_COLUMN
+0002e4d0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0002e4e0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0002e4f0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0002e500: 2020 2020 2020 2069 6620 6e6f 7420 656e         if not en
+0002e510: 636f 6465 645f 6c61 6265 6c73 3a0a 2020  coded_labels:.  
+0002e520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e530: 2020 6966 206c 6162 656c 5f65 6e63 6f64    if label_encod
+0002e540: 6572 3a0a 2020 2020 2020 2020 2020 2020  er:.            
+0002e550: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+0002e560: 6d6e 7320 3d20 6c61 6265 6c5f 656e 636f  mns = label_enco
+0002e570: 6465 722e 636c 6173 7365 735f 0a20 2020  der.classes_.   
+0002e580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e590: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0002e5a0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0002e5b0: 6f6c 756d 6e73 203d 2072 616e 6765 2873  olumns = range(s
+0002e5c0: 636f 7265 2e73 6861 7065 5b31 5d29 0a20  core.shape[1]). 
+0002e5d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002e5e0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0002e5f0: 2020 2020 2020 2020 2063 6f6c 756d 6e73           columns
+0002e600: 203d 2072 616e 6765 2873 636f 7265 2e73   = range(score.s
+0002e610: 6861 7065 5b31 5d29 0a0a 2020 2020 2020  hape[1])..      
+0002e620: 2020 2020 2020 2020 2020 7363 6f72 6520            score 
+0002e630: 3d20 7064 2e44 6174 6146 7261 6d65 280a  = pd.DataFrame(.
+0002e640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e650: 2020 2020 6461 7461 3d73 636f 7265 2c0a      data=score,.
+0002e660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e670: 2020 2020 696e 6465 783d 585f 7465 7374      index=X_test
+0002e680: 5f2e 696e 6465 782c 0a20 2020 2020 2020  _.index,.       
+0002e690: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+0002e6a0: 756d 6e73 3d5b 6622 7b53 434f 5245 5f43  umns=[f"{SCORE_C
+0002e6b0: 4f4c 554d 4e7d 5f7b 636f 6c7d 2220 666f  OLUMN}_{col}" fo
+0002e6c0: 7220 636f 6c20 696e 2063 6f6c 756d 6e73  r col in columns
+0002e6d0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0002e6e0: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
+0002e6f0: 2020 7363 6f72 6520 3d20 7363 6f72 652e    score = score.
+0002e700: 726f 756e 6428 726f 756e 6429 0a20 2020  round(round).   
+0002e710: 2020 2020 2020 2020 2058 5f74 6573 745f           X_test_
+0002e720: 203d 2070 642e 636f 6e63 6174 2828 585f   = pd.concat((X_
+0002e730: 7465 7374 5f2c 2073 636f 7265 292c 2061  test_, score), a
+0002e740: 7869 733d 3129 0a0a 2020 2020 2020 2020  xis=1)..        
+0002e750: 2320 7374 6f72 6520 7072 6564 6963 7469  # store predicti
+0002e760: 6f6e 7320 6f6e 2068 6f6c 642d 6f75 7420  ons on hold-out 
+0002e770: 696e 205f 6469 7370 6c61 795f 636f 6e74  in _display_cont
+0002e780: 6169 6e65 720a 2020 2020 2020 2020 6966  ainer.        if
+0002e790: 2064 665f 7363 6f72 6520 6973 206e 6f74   df_score is not
+0002e7a0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0002e7b0: 2020 2073 656c 662e 5f64 6973 706c 6179     self._display
+0002e7c0: 5f63 6f6e 7461 696e 6572 2e61 7070 656e  _container.appen
+0002e7d0: 6428 6466 5f73 636f 7265 290a 0a20 2020  d(df_score)..   
+0002e7e0: 2020 2020 2067 632e 636f 6c6c 6563 7428       gc.collect(
+0002e7f0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0002e800: 2058 5f74 6573 745f 0a0a 2020 2020 6465   X_test_..    de
+0002e810: 6620 6765 745f 6c65 6164 6572 626f 6172  f get_leaderboar
+0002e820: 6428 0a20 2020 2020 2020 2073 656c 662c  d(.        self,
+0002e830: 0a20 2020 2020 2020 2066 696e 616c 697a  .        finaliz
+0002e840: 655f 6d6f 6465 6c73 3a20 626f 6f6c 203d  e_models: bool =
+0002e850: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+0002e860: 6d6f 6465 6c5f 6f6e 6c79 3a20 626f 6f6c  model_only: bool
+0002e870: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+0002e880: 2020 6669 745f 6b77 6172 6773 3a20 4f70    fit_kwargs: Op
+0002e890: 7469 6f6e 616c 5b64 6963 745d 203d 204e  tional[dict] = N
+0002e8a0: 6f6e 652c 0a20 2020 2020 2020 2067 726f  one,.        gro
+0002e8b0: 7570 733a 204f 7074 696f 6e61 6c5b 556e  ups: Optional[Un
+0002e8c0: 696f 6e5b 7374 722c 2041 6e79 5d5d 203d  ion[str, Any]] =
+0002e8d0: 204e 6f6e 652c 0a20 2020 2020 2020 2076   None,.        v
+0002e8e0: 6572 626f 7365 3a20 626f 6f6c 203d 2054  erbose: bool = T
+0002e8f0: 7275 652c 0a20 2020 2029 3a0a 2020 2020  rue,.    ):.    
+0002e900: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0002e910: 6765 6e65 7261 7465 7320 6c65 6164 6572  generates leader
+0002e920: 626f 6172 6420 666f 7220 616c 6c20 6d6f  board for all mo
+0002e930: 6465 6c73 2072 756e 2069 6e20 6375 7272  dels run in curr
+0002e940: 656e 7420 7275 6e2e 0a20 2020 2020 2020  ent run..       
+0002e950: 2022 2222 0a20 2020 2020 2020 206d 6f64   """.        mod
+0002e960: 656c 5f63 6f6e 7461 696e 6572 203d 2073  el_container = s
+0002e970: 656c 662e 5f6d 6173 7465 725f 6d6f 6465  elf._master_mode
+0002e980: 6c5f 636f 6e74 6169 6e65 720a 0a20 2020  l_container..   
+0002e990: 2020 2020 2070 726f 6772 6573 735f 6172       progress_ar
+0002e9a0: 6773 203d 207b 226d 6178 223a 206c 656e  gs = {"max": len
+0002e9b0: 286d 6f64 656c 5f63 6f6e 7461 696e 6572  (model_container
+0002e9c0: 2920 2b20 317d 0a20 2020 2020 2020 2074  ) + 1}.        t
+0002e9d0: 696d 6573 7461 6d70 5374 7220 3d20 6461  imestampStr = da
+0002e9e0: 7465 7469 6d65 2e64 6174 6574 696d 652e  tetime.datetime.
+0002e9f0: 6e6f 7728 292e 7374 7266 7469 6d65 2822  now().strftime("
+0002ea00: 2548 3a25 4d3a 2553 2229 0a20 2020 2020  %H:%M:%S").     
+0002ea10: 2020 206d 6f6e 6974 6f72 5f72 6f77 7320     monitor_rows 
+0002ea20: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
+0002ea30: 5b22 496e 6974 6961 7465 6422 2c20 222e  ["Initiated", ".
+0002ea40: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
+0002ea50: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
+0002ea60: 202e 222c 2074 696d 6573 7461 6d70 5374   .", timestampSt
+0002ea70: 725d 2c0a 2020 2020 2020 2020 2020 2020  r],.            
+0002ea80: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+0002ea90: 2020 2253 7461 7475 7322 2c0a 2020 2020    "Status",.    
+0002eaa0: 2020 2020 2020 2020 2020 2020 222e 202e              ". .
+0002eab0: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
+0002eac0: 202e 202e 202e 202e 202e 202e 202e 202e   . . . . . . . .
+0002ead0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0002eae0: 2020 2022 4c6f 6164 696e 6720 4465 7065     "Loading Depe
+0002eaf0: 6e64 656e 6369 6573 222c 0a20 2020 2020  ndencies",.     
+0002eb00: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
+0002eb10: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+0002eb20: 2020 2020 2020 2020 2245 7374 696d 6174          "Estimat
+0002eb30: 6f72 222c 0a20 2020 2020 2020 2020 2020  or",.           
+0002eb40: 2020 2020 2022 2e20 2e20 2e20 2e20 2e20       ". . . . . 
+0002eb50: 2e20 2e20 2e20 2e20 2e20 2e20 2e20 2e20  . . . . . . . . 
+0002eb60: 2e20 2e20 2e20 2e20 2e22 2c0a 2020 2020  . . . . .",.    
+0002eb70: 2020 2020 2020 2020 2020 2020 2243 6f6d              "Com
+0002eb80: 7069 6c69 6e67 204c 6962 7261 7279 222c  piling Library",
+0002eb90: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
+0002eba0: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+0002ebb0: 2020 6469 7370 6c61 7920 3d20 436f 6d6d    display = Comm
+0002ebc0: 6f6e 4469 7370 6c61 7928 0a20 2020 2020  onDisplay(.     
+0002ebd0: 2020 2020 2020 2076 6572 626f 7365 3d76         verbose=v
+0002ebe0: 6572 626f 7365 2c0a 2020 2020 2020 2020  erbose,.        
+0002ebf0: 2020 2020 6874 6d6c 5f70 6172 616d 3d73      html_param=s
+0002ec00: 656c 662e 6874 6d6c 5f70 6172 616d 2c0a  elf.html_param,.
+0002ec10: 2020 2020 2020 2020 2020 2020 7072 6f67              prog
+0002ec20: 7265 7373 5f61 7267 733d 7072 6f67 7265  ress_args=progre
+0002ec30: 7373 5f61 7267 732c 0a20 2020 2020 2020  ss_args,.       
+0002ec40: 2020 2020 206d 6f6e 6974 6f72 5f72 6f77       monitor_row
+0002ec50: 733d 6d6f 6e69 746f 725f 726f 7773 2c0a  s=monitor_rows,.
+0002ec60: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0002ec70: 2020 2072 6573 756c 745f 636f 6e74 6169     result_contai
+0002ec80: 6e65 725f 6d65 616e 203d 205b 5d0a 2020  ner_mean = [].  
+0002ec90: 2020 2020 2020 6669 6e61 6c69 7a65 645f        finalized_
+0002eca0: 6d6f 6465 6c73 203d 205b 5d0a 0a20 2020  models = []..   
+0002ecb0: 2020 2020 2064 6973 706c 6179 2e75 7064       display.upd
+0002ecc0: 6174 655f 6d6f 6e69 746f 7228 0a20 2020  ate_monitor(.   
+0002ecd0: 2020 2020 2020 2020 2031 2c20 2246 696e           1, "Fin
+0002ece0: 616c 697a 696e 6720 6d6f 6465 6c73 2220  alizing models" 
+0002ecf0: 6966 2066 696e 616c 697a 655f 6d6f 6465  if finalize_mode
+0002ed00: 6c73 2065 6c73 6520 2243 6f6c 6c65 6374  ls else "Collect
+0002ed10: 696e 6720 6d6f 6465 6c73 220a 2020 2020  ing models".    
+0002ed20: 2020 2020 290a 2020 2020 2020 2020 666f      ).        fo
+0002ed30: 7220 692c 206d 6f64 656c 5f72 6573 756c  r i, model_resul
+0002ed40: 7473 5f74 7570 6c65 2069 6e20 656e 756d  ts_tuple in enum
+0002ed50: 6572 6174 6528 6d6f 6465 6c5f 636f 6e74  erate(model_cont
+0002ed60: 6169 6e65 7229 3a0a 2020 2020 2020 2020  ainer):.        
+0002ed70: 2020 2020 6d6f 6465 6c5f 7265 7375 6c74      model_result
+0002ed80: 7320 3d20 6d6f 6465 6c5f 7265 7375 6c74  s = model_result
+0002ed90: 735f 7475 706c 655b 2273 636f 7265 7322  s_tuple["scores"
+0002eda0: 5d0a 2020 2020 2020 2020 2020 2020 6d6f  ].            mo
+0002edb0: 6465 6c20 3d20 6d6f 6465 6c5f 7265 7375  del = model_resu
+0002edc0: 6c74 735f 7475 706c 655b 226d 6f64 656c  lts_tuple["model
+0002edd0: 225d 0a20 2020 2020 2020 2020 2020 2074  "].            t
+0002ede0: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+0002edf0: 2020 2020 6d65 616e 5f73 636f 7265 7320      mean_scores 
+0002ee00: 3d20 6d6f 6465 6c5f 7265 7375 6c74 732e  = model_results.
+0002ee10: 6c6f 635b 5b22 4d65 616e 225d 5d0a 2020  loc[["Mean"]].  
+0002ee20: 2020 2020 2020 2020 2020 6578 6365 7074            except
+0002ee30: 204b 6579 4572 726f 723a 0a20 2020 2020   KeyError:.     
+0002ee40: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+0002ee50: 6e75 650a 2020 2020 2020 2020 2020 2020  nue.            
+0002ee60: 6d6f 6465 6c5f 6e61 6d65 203d 2073 656c  model_name = sel
+0002ee70: 662e 5f67 6574 5f6d 6f64 656c 5f6e 616d  f._get_model_nam
+0002ee80: 6528 6d6f 6465 6c29 0a20 2020 2020 2020  e(model).       
+0002ee90: 2020 2020 206d 6561 6e5f 7363 6f72 6573       mean_scores
+0002eea0: 5b22 496e 6465 7822 5d20 3d20 690a 2020  ["Index"] = i.  
+0002eeb0: 2020 2020 2020 2020 2020 6d65 616e 5f73            mean_s
+0002eec0: 636f 7265 735b 224d 6f64 656c 204e 616d  cores["Model Nam
+0002eed0: 6522 5d20 3d20 6d6f 6465 6c5f 6e61 6d65  e"] = model_name
+0002eee0: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
+0002eef0: 706c 6179 2e75 7064 6174 655f 6d6f 6e69  play.update_moni
+0002ef00: 746f 7228 322c 206d 6f64 656c 5f6e 616d  tor(2, model_nam
+0002ef10: 6529 0a20 2020 2020 2020 2020 2020 2069  e).            i
+0002ef20: 6620 6669 6e61 6c69 7a65 5f6d 6f64 656c  f finalize_model
+0002ef30: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+0002ef40: 2020 206d 6f64 656c 203d 2073 656c 662e     model = self.
+0002ef50: 6669 6e61 6c69 7a65 5f6d 6f64 656c 280a  finalize_model(.
+0002ef60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ef70: 2020 2020 6d6f 6465 6c2c 0a20 2020 2020      model,.     
+0002ef80: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002ef90: 6974 5f6b 7761 7267 733d 6669 745f 6b77  it_kwargs=fit_kw
+0002efa0: 6172 6773 2c0a 2020 2020 2020 2020 2020  args,.          
+0002efb0: 2020 2020 2020 2020 2020 6772 6f75 7073            groups
+0002efc0: 3d67 726f 7570 732c 0a20 2020 2020 2020  =groups,.       
+0002efd0: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+0002efe0: 656c 5f6f 6e6c 793d 6d6f 6465 6c5f 6f6e  el_only=model_on
+0002eff0: 6c79 2c0a 2020 2020 2020 2020 2020 2020  ly,.            
+0002f000: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0002f010: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0002f020: 2020 2020 2020 2020 6d6f 6465 6c20 3d20          model = 
+0002f030: 6465 6570 636f 7079 286d 6f64 656c 290a  deepcopy(model).
+0002f040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f050: 6966 206e 6f74 2069 735f 6669 7474 6564  if not is_fitted
+0002f060: 286d 6f64 656c 293a 0a20 2020 2020 2020  (model):.       
+0002f070: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+0002f080: 656c 2c20 5f20 3d20 7365 6c66 2e5f 6372  el, _ = self._cr
+0002f090: 6561 7465 5f6d 6f64 656c 280a 2020 2020  eate_model(.    
+0002f0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f0b0: 2020 2020 6573 7469 6d61 746f 723d 6d6f      estimator=mo
+0002f0c0: 6465 6c2c 0a20 2020 2020 2020 2020 2020  del,.           
+0002f0d0: 2020 2020 2020 2020 2020 2020 2076 6572               ver
+0002f0e0: 626f 7365 3d46 616c 7365 2c0a 2020 2020  bose=False,.    
+0002f0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f100: 2020 2020 7379 7374 656d 3d46 616c 7365      system=False
+0002f110: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002f120: 2020 2020 2020 2020 2020 6669 745f 6b77            fit_kw
+0002f130: 6172 6773 3d66 6974 5f6b 7761 7267 732c  args=fit_kwargs,
+0002f140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f150: 2020 2020 2020 2020 2067 726f 7570 733d           groups=
+0002f160: 6772 6f75 7073 2c0a 2020 2020 2020 2020  groups,.        
+0002f170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f180: 6164 645f 746f 5f6d 6f64 656c 5f6c 6973  add_to_model_lis
+0002f190: 743d 4661 6c73 652c 0a20 2020 2020 2020  t=False,.       
+0002f1a0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+0002f1b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002f1c0: 6620 6e6f 7420 6d6f 6465 6c5f 6f6e 6c79  f not model_only
+0002f1d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002f1e0: 2020 2020 2020 7069 7065 6c69 6e65 203d        pipeline =
+0002f1f0: 2064 6565 7063 6f70 7928 7365 6c66 2e70   deepcopy(self.p
+0002f200: 6970 656c 696e 6529 0a20 2020 2020 2020  ipeline).       
+0002f210: 2020 2020 2020 2020 2020 2020 2070 6970               pip
+0002f220: 656c 696e 652e 7374 6570 732e 6170 7065  eline.steps.appe
+0002f230: 6e64 285b 2274 7261 696e 6564 5f6d 6f64  nd(["trained_mod
+0002f240: 656c 222c 206d 6f64 656c 5d29 0a20 2020  el", model]).   
+0002f250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f260: 206d 6f64 656c 203d 2070 6970 656c 696e   model = pipelin
+0002f270: 650a 2020 2020 2020 2020 2020 2020 6469  e.            di
+0002f280: 7370 6c61 792e 6d6f 7665 5f70 726f 6772  splay.move_progr
+0002f290: 6573 7328 290a 2020 2020 2020 2020 2020  ess().          
+0002f2a0: 2020 6669 6e61 6c69 7a65 645f 6d6f 6465    finalized_mode
+0002f2b0: 6c73 2e61 7070 656e 6428 6d6f 6465 6c29  ls.append(model)
+0002f2c0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+0002f2d0: 756c 745f 636f 6e74 6169 6e65 725f 6d65  ult_container_me
+0002f2e0: 616e 2e61 7070 656e 6428 6d65 616e 5f73  an.append(mean_s
+0002f2f0: 636f 7265 7329 0a0a 2020 2020 2020 2020  cores)..        
+0002f300: 6469 7370 6c61 792e 7570 6461 7465 5f6d  display.update_m
+0002f310: 6f6e 6974 6f72 2831 2c20 2243 7265 6174  onitor(1, "Creat
+0002f320: 696e 6720 6461 7461 6672 616d 6522 290a  ing dataframe").
+0002f330: 2020 2020 2020 2020 7265 7375 6c74 7320          results 
+0002f340: 3d20 7064 2e63 6f6e 6361 7428 7265 7375  = pd.concat(resu
+0002f350: 6c74 5f63 6f6e 7461 696e 6572 5f6d 6561  lt_container_mea
+0002f360: 6e29 0a20 2020 2020 2020 2072 6573 756c  n).        resul
+0002f370: 7473 5b22 4d6f 6465 6c22 5d20 3d20 6c69  ts["Model"] = li
+0002f380: 7374 2872 616e 6765 286c 656e 2872 6573  st(range(len(res
+0002f390: 756c 7473 2929 290a 2020 2020 2020 2020  ults))).        
+0002f3a0: 7265 7375 6c74 735b 224d 6f64 656c 225d  results["Model"]
+0002f3b0: 203d 2072 6573 756c 7473 5b22 4d6f 6465   = results["Mode
+0002f3c0: 6c22 5d2e 6173 7479 7065 2822 6f62 6a65  l"].astype("obje
+0002f3d0: 6374 2229 0a20 2020 2020 2020 206d 6f64  ct").        mod
+0002f3e0: 656c 5f6c 6f63 203d 2072 6573 756c 7473  el_loc = results
+0002f3f0: 2e63 6f6c 756d 6e73 2e67 6574 5f6c 6f63  .columns.get_loc
+0002f400: 2822 4d6f 6465 6c22 290a 2020 2020 2020  ("Model").      
+0002f410: 2020 666f 7220 7820 696e 2072 616e 6765    for x in range
+0002f420: 286c 656e 2872 6573 756c 7473 2929 3a0a  (len(results)):.
+0002f430: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+0002f440: 6c74 732e 6961 745b 782c 206d 6f64 656c  lts.iat[x, model
+0002f450: 5f6c 6f63 5d20 3d20 6669 6e61 6c69 7a65  _loc] = finalize
+0002f460: 645f 6d6f 6465 6c73 5b78 5d0a 2020 2020  d_models[x].    
+0002f470: 2020 2020 7265 6172 7261 6e67 6564 5f63      rearranged_c
+0002f480: 6f6c 756d 6e73 203d 206c 6973 7428 7265  olumns = list(re
+0002f490: 7375 6c74 732e 636f 6c75 6d6e 7329 0a20  sults.columns). 
+0002f4a0: 2020 2020 2020 2072 6561 7272 616e 6765         rearrange
+0002f4b0: 645f 636f 6c75 6d6e 732e 7265 6d6f 7665  d_columns.remove
+0002f4c0: 2822 4d6f 6465 6c22 290a 2020 2020 2020  ("Model").      
+0002f4d0: 2020 7265 6172 7261 6e67 6564 5f63 6f6c    rearranged_col
+0002f4e0: 756d 6e73 2e72 656d 6f76 6528 224d 6f64  umns.remove("Mod
+0002f4f0: 656c 204e 616d 6522 290a 2020 2020 2020  el Name").      
+0002f500: 2020 7265 6172 7261 6e67 6564 5f63 6f6c    rearranged_col
+0002f510: 756d 6e73 203d 205b 224d 6f64 656c 204e  umns = ["Model N
+0002f520: 616d 6522 2c20 224d 6f64 656c 225d 202b  ame", "Model"] +
+0002f530: 2072 6561 7272 616e 6765 645f 636f 6c75   rearranged_colu
+0002f540: 6d6e 730a 2020 2020 2020 2020 7265 7375  mns.        resu
+0002f550: 6c74 7320 3d20 7265 7375 6c74 735b 7265  lts = results[re
+0002f560: 6172 7261 6e67 6564 5f63 6f6c 756d 6e73  arranged_columns
+0002f570: 5d0a 2020 2020 2020 2020 7265 7375 6c74  ].        result
+0002f580: 732e 7365 745f 696e 6465 7828 2249 6e64  s.set_index("Ind
+0002f590: 6578 222c 2069 6e70 6c61 6365 3d54 7275  ex", inplace=Tru
+0002f5a0: 652c 2064 726f 703d 5472 7565 290a 2020  e, drop=True).  
+0002f5b0: 2020 2020 2020 6469 7370 6c61 792e 636c        display.cl
+0002f5c0: 6f73 6528 290a 2020 2020 2020 2020 2320  ose().        # 
+0002f5d0: 6469 7370 6c61 792e 636c 6561 725f 6f75  display.clear_ou
+0002f5e0: 7470 7574 2829 0a20 2020 2020 2020 2072  tput().        r
+0002f5f0: 6574 7572 6e20 7265 7375 6c74 730a 0a20  eturn results.. 
+0002f600: 2020 2064 6566 2063 6865 636b 5f66 6169     def check_fai
+0002f610: 726e 6573 7328 0a20 2020 2020 2020 2073  rness(.        s
+0002f620: 656c 662c 2065 7374 696d 6174 6f72 2c20  elf, estimator, 
+0002f630: 7365 6e73 6974 6976 655f 6665 6174 7572  sensitive_featur
+0002f640: 6573 3a20 6c69 7374 2c20 706c 6f74 5f6b  es: list, plot_k
+0002f650: 7761 7267 733a 2064 6963 7420 3d20 7b7d  wargs: dict = {}
+0002f660: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+0002f670: 2222 220a 2020 2020 2020 2020 5468 6572  """.        Ther
+0002f680: 6520 6172 6520 6d61 6e79 2061 7070 726f  e are many appro
+0002f690: 6163 6865 7320 746f 2063 6f6e 6365 7074  aches to concept
+0002f6a0: 7561 6c69 7a69 6e67 2066 6169 726e 6573  ualizing fairnes
+0002f6b0: 732e 2054 6869 7320 6675 6e63 7469 6f6e  s. This function
+0002f6c0: 2066 6f6c 6c6f 7773 0a20 2020 2020 2020   follows.       
+0002f6d0: 2074 6865 2061 7070 726f 6163 6820 6b6e   the approach kn
+0002f6e0: 6f77 6e20 6173 2067 726f 7570 2066 6169  own as group fai
+0002f6f0: 726e 6573 732c 2077 6869 6368 2061 736b  rness, which ask
+0002f700: 733a 2057 6869 6368 2067 726f 7570 7320  s: Which groups 
+0002f710: 6f66 2069 6e64 6976 6964 7561 6c73 0a20  of individuals. 
+0002f720: 2020 2020 2020 2061 7265 2061 7420 7269         are at ri
+0002f730: 736b 2066 6f72 2065 7870 6572 6965 6e63  sk for experienc
+0002f740: 696e 6720 6861 726d 732e 2054 6869 7320  ing harms. This 
+0002f750: 6675 6e63 7469 6f6e 2070 726f 7669 6465  function provide
+0002f760: 7320 6661 6972 6e65 7373 2d72 656c 6174  s fairness-relat
+0002f770: 6564 0a20 2020 2020 2020 206d 6574 7269  ed.        metri
+0002f780: 6373 2062 6574 7765 656e 2064 6966 6665  cs between diffe
+0002f790: 7265 6e74 2067 726f 7570 7320 2861 6c73  rent groups (als
+0002f7a0: 6f20 6361 6c6c 6564 2073 7562 706f 7075  o called subpopu
+0002f7b0: 6c61 7469 6f6e 292e 0a0a 0a20 2020 2020  lation)....     
+0002f7c0: 2020 2045 7861 6d70 6c65 0a20 2020 2020     Example.     
+0002f7d0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+0002f7e0: 2020 203e 3e3e 2066 726f 6d20 7079 6361     >>> from pyca
+0002f7f0: 7265 742e 6461 7461 7365 7473 2069 6d70  ret.datasets imp
+0002f800: 6f72 7420 6765 745f 6461 7461 0a20 2020  ort get_data.   
+0002f810: 2020 2020 203e 3e3e 2069 6e63 6f6d 6520       >>> income 
+0002f820: 3d20 6765 745f 6461 7461 2827 696e 636f  = get_data('inco
+0002f830: 6d65 2729 0a20 2020 2020 2020 203e 3e3e  me').        >>>
+0002f840: 2066 726f 6d20 7079 6361 7265 742e 636c   from pycaret.cl
+0002f850: 6173 7369 6669 6361 7469 6f6e 2069 6d70  assification imp
+0002f860: 6f72 7420 2a0a 2020 2020 2020 2020 3e3e  ort *.        >>
+0002f870: 3e20 6578 705f 6e61 6d65 203d 2073 6574  > exp_name = set
+0002f880: 7570 2864 6174 6120 3d20 696e 636f 6d65  up(data = income
+0002f890: 2c20 2074 6172 6765 7420 3d20 2769 6e63  ,  target = 'inc
+0002f8a0: 6f6d 6520 3e35 304b 2729 0a20 2020 2020  ome >50K').     
+0002f8b0: 2020 203e 3e3e 206c 7220 3d20 6372 6561     >>> lr = crea
+0002f8c0: 7465 5f6d 6f64 656c 2827 6c72 2729 0a20  te_model('lr'). 
+0002f8d0: 2020 2020 2020 203e 3e3e 206c 725f 6661         >>> lr_fa
+0002f8e0: 6972 6e65 7373 203d 2063 6865 636b 5f66  irness = check_f
+0002f8f0: 6169 726e 6573 7328 6c72 2c20 7365 6e73  airness(lr, sens
+0002f900: 6974 6976 655f 6665 6174 7572 6573 203d  itive_features =
+0002f910: 205b 2773 6578 272c 2027 7261 6365 275d   ['sex', 'race']
+0002f920: 290a 0a0a 2020 2020 2020 2020 6573 7469  )...        esti
+0002f930: 6d61 746f 723a 2073 6369 6b69 742d 6c65  mator: scikit-le
+0002f940: 6172 6e20 636f 6d70 6174 6962 6c65 206f  arn compatible o
+0002f950: 626a 6563 740a 2020 2020 2020 2020 2020  bject.          
+0002f960: 2020 5472 6169 6e65 6420 6d6f 6465 6c20    Trained model 
+0002f970: 6f62 6a65 6374 0a0a 0a20 2020 2020 2020  object...       
+0002f980: 2073 656e 7369 7469 7665 5f66 6561 7475   sensitive_featu
+0002f990: 7265 733a 206c 6973 740a 2020 2020 2020  res: list.      
+0002f9a0: 2020 2020 2020 4c69 7374 206f 6620 636f        List of co
+0002f9b0: 6c75 6d6e 206e 616d 6573 2061 7320 7072  lumn names as pr
+0002f9c0: 6573 656e 7420 696e 2074 6865 206f 7269  esent in the ori
+0002f9d0: 6769 6e61 6c20 6461 7461 7365 7420 6265  ginal dataset be
+0002f9e0: 666f 7265 2061 6e79 0a20 2020 2020 2020  fore any.       
+0002f9f0: 2020 2020 2074 7261 6e73 666f 726d 6174       transformat
+0002fa00: 696f 6e73 2e0a 0a0a 2020 2020 2020 2020  ions....        
+0002fa10: 706c 6f74 5f6b 7761 7267 733a 2064 6963  plot_kwargs: dic
+0002fa20: 742c 2064 6566 6175 6c74 203d 207b 7d20  t, default = {} 
+0002fa30: 2865 6d70 7479 2064 6963 7429 0a20 2020  (empty dict).   
+0002fa40: 2020 2020 2020 2020 2044 6963 7469 6f6e           Diction
+0002fa50: 6172 7920 6f66 2061 7267 756d 656e 7473  ary of arguments
+0002fa60: 2070 6173 7365 6420 746f 2074 6865 206d   passed to the m
+0002fa70: 6174 706c 6f74 6c69 6220 706c 6f74 2e0a  atplotlib plot..
+0002fa80: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0002fa90: 733a 0a20 2020 2020 2020 2020 2020 2070  s:.            p
+0002faa0: 616e 6461 732e 4461 7461 4672 616d 650a  andas.DataFrame.
+0002fab0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+0002fac0: 2020 2020 2020 5f63 6865 636b 5f73 6f66        _check_sof
+0002fad0: 745f 6465 7065 6e64 656e 6369 6573 2822  t_dependencies("
+0002fae0: 6661 6972 6c65 6172 6e22 2c20 6578 7472  fairlearn", extr
+0002faf0: 613d 2261 6e61 6c79 7369 7322 2c20 7365  a="analysis", se
+0002fb00: 7665 7269 7479 3d22 6572 726f 7222 290a  verity="error").
+0002fb10: 2020 2020 2020 2020 6672 6f6d 2066 6169          from fai
+0002fb20: 726c 6561 726e 2e6d 6574 7269 6373 2069  rlearn.metrics i
+0002fb30: 6d70 6f72 7420 4d65 7472 6963 4672 616d  mport MetricFram
+0002fb40: 652c 2063 6f75 6e74 2c20 7365 6c65 6374  e, count, select
+0002fb50: 696f 6e5f 7261 7465 0a0a 2020 2020 2020  ion_rate..      
+0002fb60: 2020 616c 6c5f 6d65 7472 6963 7320 3d20    all_metrics = 
+0002fb70: 7365 6c66 2e67 6574 5f6d 6574 7269 6373  self.get_metrics
+0002fb80: 2829 5b5b 224e 616d 6522 2c20 2253 636f  ()[["Name", "Sco
+0002fb90: 7265 2046 756e 6374 696f 6e22 2c20 2241  re Function", "A
+0002fba0: 7267 7322 5d5d 2e73 6574 5f69 6e64 6578  rgs"]].set_index
+0002fbb0: 280a 2020 2020 2020 2020 2020 2020 224e  (.            "N
+0002fbc0: 616d 6522 0a20 2020 2020 2020 2029 0a20  ame".        ). 
+0002fbd0: 2020 2020 2020 206d 6574 7269 635f 6469         metric_di
+0002fbe0: 6374 203d 207b 7d0a 2020 2020 2020 2020  ct = {}.        
+0002fbf0: 6d65 7472 6963 5f64 6963 745b 2253 616d  metric_dict["Sam
+0002fc00: 706c 6573 225d 203d 2063 6f75 6e74 0a20  ples"] = count. 
+0002fc10: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+0002fc20: 616c 6c5f 6d65 7472 6963 732e 696e 6465  all_metrics.inde
+0002fc30: 783a 0a20 2020 2020 2020 2020 2020 206d  x:.            m
+0002fc40: 6574 7269 635f 6469 6374 5b69 5d20 3d20  etric_dict[i] = 
+0002fc50: 7061 7274 6961 6c28 616c 6c5f 6d65 7472  partial(all_metr
+0002fc60: 6963 732e 6c6f 635b 695d 5b30 5d2c 202a  ics.loc[i][0], *
+0002fc70: 2a61 6c6c 5f6d 6574 7269 6373 2e6c 6f63  *all_metrics.loc
+0002fc80: 5b69 5d5b 315d 290a 0a20 2020 2020 2020  [i][1])..       
+0002fc90: 2069 6620 7365 6c66 2e5f 6d6c 5f75 7365   if self._ml_use
+0002fca0: 6361 7365 203d 3d20 4d4c 5573 6563 6173  case == MLUsecas
+0002fcb0: 652e 434c 4153 5349 4649 4341 5449 4f4e  e.CLASSIFICATION
+0002fcc0: 3a0a 2020 2020 2020 2020 2020 2020 6d65  :.            me
+0002fcd0: 7472 6963 5f64 6963 745b 2253 656c 6563  tric_dict["Selec
+0002fce0: 7469 6f6e 2052 6174 6522 5d20 3d20 7365  tion Rate"] = se
+0002fcf0: 6c65 6374 696f 6e5f 7261 7465 0a0a 2020  lection_rate..  
+0002fd00: 2020 2020 2020 795f 7072 6564 203d 2073        y_pred = s
+0002fd10: 656c 662e 7072 6564 6963 745f 6d6f 6465  elf.predict_mode
+0002fd20: 6c28 6573 7469 6d61 746f 7229 5b4c 4142  l(estimator)[LAB
+0002fd30: 454c 5f43 4f4c 554d 4e5d 0a20 2020 2020  EL_COLUMN].     
+0002fd40: 2020 2079 5f74 7275 6520 3d20 7365 6c66     y_true = self
+0002fd50: 2e79 5f74 6573 740a 0a20 2020 2020 2020  .y_test..       
+0002fd60: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0002fd70: 2020 6d75 6c74 695f 6d65 7472 6963 203d    multi_metric =
+0002fd80: 204d 6574 7269 6346 7261 6d65 280a 2020   MetricFrame(.  
+0002fd90: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+0002fda0: 7472 6963 733d 6d65 7472 6963 5f64 6963  trics=metric_dic
+0002fdb0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+0002fdc0: 2020 2079 5f74 7275 653d 795f 7472 7565     y_true=y_true
+0002fdd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002fde0: 2020 795f 7072 6564 3d79 5f70 7265 642c    y_pred=y_pred,
+0002fdf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002fe00: 2073 656e 7369 7469 7665 5f66 6561 7475   sensitive_featu
+0002fe10: 7265 733d 7365 6c66 2e58 5f74 6573 745b  res=self.X_test[
+0002fe20: 7365 6e73 6974 6976 655f 6665 6174 7572  sensitive_featur
+0002fe30: 6573 5d2c 0a20 2020 2020 2020 2020 2020  es],.           
+0002fe40: 2029 0a20 2020 2020 2020 2065 7863 6570   ).        excep
+0002fe50: 7420 4578 6365 7074 696f 6e3a 0a20 2020  t Exception:.   
+0002fe60: 2020 2020 2020 2020 2069 6620 4d4c 5573           if MLUs
+0002fe70: 6563 6173 652e 434c 4153 5349 4649 4341  ecase.CLASSIFICA
+0002fe80: 5449 4f4e 3a0a 2020 2020 2020 2020 2020  TION:.          
+0002fe90: 2020 2020 2020 6d65 7472 6963 5f64 6963        metric_dic
+0002fea0: 742e 706f 7028 2241 5543 2229 0a20 2020  t.pop("AUC").   
+0002feb0: 2020 2020 2020 2020 2020 2020 206d 756c               mul
+0002fec0: 7469 5f6d 6574 7269 6320 3d20 4d65 7472  ti_metric = Metr
+0002fed0: 6963 4672 616d 6528 0a20 2020 2020 2020  icFrame(.       
+0002fee0: 2020 2020 2020 2020 2020 2020 206d 6574               met
+0002fef0: 7269 6373 3d6d 6574 7269 635f 6469 6374  rics=metric_dict
+0002ff00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002ff10: 2020 2020 2020 795f 7472 7565 3d79 5f74        y_true=y_t
+0002ff20: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+0002ff30: 2020 2020 2020 2020 2079 5f70 7265 643d           y_pred=
+0002ff40: 795f 7072 6564 2c0a 2020 2020 2020 2020  y_pred,.        
+0002ff50: 2020 2020 2020 2020 2020 2020 7365 6e73              sens
+0002ff60: 6974 6976 655f 6665 6174 7572 6573 3d73  itive_features=s
+0002ff70: 656c 662e 585f 7465 7374 5b73 656e 7369  elf.X_test[sensi
+0002ff80: 7469 7665 5f66 6561 7475 7265 735d 2c0a  tive_features],.
+0002ff90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ffa0: 290a 0a20 2020 2020 2020 206d 756c 7469  )..        multi
+0002ffb0: 5f6d 6574 7269 632e 6279 5f67 726f 7570  _metric.by_group
+0002ffc0: 2e70 6c6f 742e 6261 7228 0a20 2020 2020  .plot.bar(.     
+0002ffd0: 2020 2020 2020 2073 7562 706c 6f74 733d         subplots=
+0002ffe0: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+0002fff0: 2020 6c61 796f 7574 3d5b 332c 2033 5d2c    layout=[3, 3],
+00030000: 0a20 2020 2020 2020 2020 2020 206c 6567  .            leg
+00030010: 656e 643d 4661 6c73 652c 0a20 2020 2020  end=False,.     
+00030020: 2020 2020 2020 2066 6967 7369 7a65 3d5b         figsize=[
+00030030: 3136 2c20 385d 2c0a 2020 2020 2020 2020  16, 8],.        
+00030040: 2020 2020 7469 746c 653d 2250 6572 666f      title="Perfo
+00030050: 726d 616e 6365 204d 6574 7269 6373 2062  rmance Metrics b
+00030060: 7920 5365 6e73 6974 6976 6520 4665 6174  y Sensitive Feat
+00030070: 7572 6573 222c 0a20 2020 2020 2020 2020  ures",.         
+00030080: 2020 202a 2a70 6c6f 745f 6b77 6172 6773     **plot_kwargs
+00030090: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+000300a0: 2020 2020 2072 6574 7572 6e20 7064 2e44       return pd.D
+000300b0: 6174 6146 7261 6d65 286d 756c 7469 5f6d  ataFrame(multi_m
+000300c0: 6574 7269 632e 6279 5f67 726f 7570 290a  etric.by_group).
+000300d0: 0a20 2020 2064 6566 2061 7574 6f6d 6c28  .    def automl(
+000300e0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+000300f0: 2020 2020 2020 206f 7074 696d 697a 653a         optimize:
+00030100: 2073 7472 203d 2022 4163 6375 7261 6379   str = "Accuracy
+00030110: 222c 0a20 2020 2020 2020 2075 7365 5f68  ",.        use_h
+00030120: 6f6c 646f 7574 3a20 626f 6f6c 203d 2046  oldout: bool = F
+00030130: 616c 7365 2c0a 2020 2020 2020 2020 7475  alse,.        tu
+00030140: 7262 6f3a 2062 6f6f 6c20 3d20 5472 7565  rbo: bool = True
+00030150: 2c0a 2020 2020 2020 2020 7265 7475 726e  ,.        return
+00030160: 5f74 7261 696e 5f73 636f 7265 3a20 626f  _train_score: bo
+00030170: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+00030180: 2920 2d3e 2041 6e79 3a0a 2020 2020 2020  ) -> Any:.      
+00030190: 2020 2222 220a 2020 2020 2020 2020 5468    """.        Th
+000301a0: 6973 2066 756e 6374 696f 6e20 7265 7475  is function retu
+000301b0: 726e 7320 7468 6520 6265 7374 206d 6f64  rns the best mod
+000301c0: 656c 206f 7574 206f 6620 616c 6c20 6d6f  el out of all mo
+000301d0: 6465 6c73 2063 7265 6174 6564 2069 6e0a  dels created in.
+000301e0: 2020 2020 2020 2020 6375 7272 656e 7420          current 
+000301f0: 6163 7469 7665 2065 6e76 6972 6f6e 6d65  active environme
+00030200: 6e74 2062 6173 6564 206f 6e20 6d65 7472  nt based on metr
+00030210: 6963 2064 6566 696e 6564 2069 6e20 6f70  ic defined in op
+00030220: 7469 6d69 7a65 2070 6172 616d 6574 6572  timize parameter
+00030230: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00030240: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00030250: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00030260: 206f 7074 696d 697a 6520 3a20 7374 722c   optimize : str,
+00030270: 2064 6566 6175 6c74 203d 2027 4163 6375   default = 'Accu
+00030280: 7261 6379 270a 2020 2020 2020 2020 2020  racy'.          
+00030290: 2020 4f74 6865 7220 7661 6c75 6573 2079    Other values y
+000302a0: 6f75 2063 616e 2070 6173 7320 696e 206f  ou can pass in o
+000302b0: 7074 696d 697a 6520 7061 7261 6d65 7465  ptimize paramete
+000302c0: 7220 6172 6520 2741 5543 272c 2027 5265  r are 'AUC', 'Re
+000302d0: 6361 6c6c 272c 2027 5072 6563 6973 696f  call', 'Precisio
+000302e0: 6e27 2c0a 2020 2020 2020 2020 2020 2020  n',.            
+000302f0: 2746 3127 2c20 274b 6170 7061 272c 2061  'F1', 'Kappa', a
+00030300: 6e64 2027 4d43 4327 2e0a 0a20 2020 2020  nd 'MCC'...     
+00030310: 2020 2075 7365 5f68 6f6c 646f 7574 3a20     use_holdout: 
+00030320: 626f 6f6c 2c20 6465 6661 756c 7420 3d20  bool, default = 
+00030330: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+00030340: 2020 5768 656e 2073 6574 2074 6f20 5472    When set to Tr
+00030350: 7565 2c20 6d65 7472 6963 7320 6172 6520  ue, metrics are 
+00030360: 6576 616c 7561 7465 6420 6f6e 2068 6f6c  evaluated on hol
+00030370: 646f 7574 2073 6574 2069 6e73 7465 6164  dout set instead
+00030380: 206f 6620 4356 2e0a 0a20 2020 2020 2020   of CV...       
+00030390: 2074 7572 626f 3a20 626f 6f6c 2c20 6465   turbo: bool, de
+000303a0: 6661 756c 7420 3d20 5472 7565 0a20 2020  fault = True.   
+000303b0: 2020 2020 2020 2020 2057 6865 6e20 7365           When se
+000303c0: 7420 746f 2054 7275 6520 616e 6420 7573  t to True and us
+000303d0: 655f 686f 6c64 6f75 7420 6973 2046 616c  e_holdout is Fal
+000303e0: 7365 2c20 6f6e 6c79 206d 6f64 656c 7320  se, only models 
+000303f0: 6372 6561 7465 6420 7769 7468 2064 6566  created with def
+00030400: 6175 6c74 2066 6f6c 640a 2020 2020 2020  ault fold.      
+00030410: 2020 2020 2020 7061 7261 6d65 7465 7220        parameter 
+00030420: 7769 6c6c 2062 6520 636f 6e73 6964 6572  will be consider
+00030430: 6564 2e20 4966 2073 6574 2074 6f20 4661  ed. If set to Fa
+00030440: 6c73 652c 206d 6f64 656c 7320 6372 6561  lse, models crea
+00030450: 7465 6420 7769 7468 2061 206e 6f6e 2d64  ted with a non-d
+00030460: 6566 6175 6c74 0a20 2020 2020 2020 2020  efault.         
+00030470: 2020 2066 6f6c 6420 7061 7261 6d65 7465     fold paramete
+00030480: 7220 7769 6c6c 2062 6520 7363 6f72 6564  r will be scored
+00030490: 2061 6761 696e 2075 7369 6e67 2064 6566   again using def
+000304a0: 6175 6c74 2066 6f6c 6420 7365 7474 696e  ault fold settin
+000304b0: 6773 2c20 736f 2074 6861 7420 7468 6579  gs, so that they
+000304c0: 2063 616e 2062 650a 2020 2020 2020 2020   can be.        
+000304d0: 2020 2020 636f 6d70 6172 6564 2e0a 0a20      compared... 
+000304e0: 2020 2020 2020 2072 6574 7572 6e5f 7472         return_tr
+000304f0: 6169 6e5f 7363 6f72 653a 2062 6f6f 6c2c  ain_score: bool,
+00030500: 2064 6566 6175 6c74 203d 2046 616c 7365   default = False
+00030510: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00030520: 4661 6c73 652c 2072 6574 7572 6e73 2074  False, returns t
+00030530: 6865 2043 5620 5661 6c69 6461 7469 6f6e  he CV Validation
+00030540: 2073 636f 7265 7320 6f6e 6c79 2e0a 2020   scores only..  
+00030550: 2020 2020 2020 2020 2020 4966 2054 7275            If Tru
+00030560: 652c 2072 6574 7572 6e73 2074 6865 2043  e, returns the C
+00030570: 5620 7472 6169 6e69 6e67 2073 636f 7265  V training score
+00030580: 7320 616c 6f6e 6720 7769 7468 2074 6865  s along with the
+00030590: 2043 5620 7661 6c69 6461 7469 6f6e 2073   CV validation s
+000305a0: 636f 7265 732e 0a20 2020 2020 2020 2020  cores..         
+000305b0: 2020 2054 6869 7320 6973 2075 7365 6675     This is usefu
+000305c0: 6c20 7768 656e 2074 6865 2075 7365 7220  l when the user 
+000305d0: 7761 6e74 7320 746f 2064 6f20 6269 6173  wants to do bias
+000305e0: 2d76 6172 6961 6e63 6520 7472 6164 656f  -variance tradeo
+000305f0: 6666 2e20 4120 6869 6768 2043 560a 2020  ff. A high CV.  
+00030600: 2020 2020 2020 2020 2020 7472 6169 6e69            traini
+00030610: 6e67 2073 636f 7265 2077 6974 6820 6120  ng score with a 
+00030620: 6c6f 7720 636f 7272 6573 706f 6e64 696e  low correspondin
+00030630: 6720 4356 2076 616c 6964 6174 696f 6e20  g CV validation 
+00030640: 7363 6f72 6520 696e 6469 6361 7465 7320  score indicates 
+00030650: 6f76 6572 6669 7474 696e 672e 0a0a 2020  overfitting...  
+00030660: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
+00030670: 2020 2020 2020 2020 2020 2054 7261 696e             Train
+00030680: 6564 204d 6f64 656c 0a20 2020 2020 2020  ed Model.       
+00030690: 2022 2222 0a0a 2020 2020 2020 2020 6675   """..        fu
+000306a0: 6e63 7469 6f6e 5f70 6172 616d 735f 7374  nction_params_st
+000306b0: 7220 3d20 222c 2022 2e6a 6f69 6e28 5b66  r = ", ".join([f
+000306c0: 227b 6b7d 3d7b 767d 2220 666f 7220 6b2c  "{k}={v}" for k,
+000306d0: 2076 2069 6e20 6c6f 6361 6c73 2829 2e69   v in locals().i
+000306e0: 7465 6d73 2829 5d29 0a0a 2020 2020 2020  tems()])..      
+000306f0: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
+00030700: 666f 2822 496e 6974 6961 6c69 7a69 6e67  fo("Initializing
+00030710: 2061 7574 6f6d 6c28 2922 290a 2020 2020   automl()").    
+00030720: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
+00030730: 696e 666f 2866 2261 7574 6f6d 6c28 7b66  info(f"automl({f
+00030740: 756e 6374 696f 6e5f 7061 7261 6d73 5f73  unction_params_s
+00030750: 7472 7d29 2229 0a0a 2020 2020 2020 2020  tr})")..        
+00030760: 2320 6368 6563 6b69 6e67 206f 7074 696d  # checking optim
+00030770: 697a 6520 7061 7261 6d65 7465 720a 2020  ize parameter.  
+00030780: 2020 2020 2020 6f70 7469 6d69 7a65 203d        optimize =
+00030790: 2073 656c 662e 5f67 6574 5f6d 6574 7269   self._get_metri
+000307a0: 635f 6279 5f6e 616d 655f 6f72 5f69 6428  c_by_name_or_id(
+000307b0: 6f70 7469 6d69 7a65 290a 2020 2020 2020  optimize).      
+000307c0: 2020 6966 206f 7074 696d 697a 6520 6973    if optimize is
+000307d0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000307e0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+000307f0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+00030800: 2020 2020 2022 4f70 7469 6d69 7a65 206d       "Optimize m
+00030810: 6574 686f 6420 6e6f 7420 7375 7070 6f72  ethod not suppor
+00030820: 7465 642e 2053 6565 2064 6f63 7374 7269  ted. See docstri
+00030830: 6e67 2066 6f72 206c 6973 7420 6f66 2061  ng for list of a
+00030840: 7661 696c 6162 6c65 2070 6172 616d 6574  vailable paramet
+00030850: 6572 732e 220a 2020 2020 2020 2020 2020  ers.".          
+00030860: 2020 290a 0a20 2020 2020 2020 2023 2063    )..        # c
+00030870: 6865 636b 696e 6720 6f70 7469 6d69 7a65  hecking optimize
+00030880: 2070 6172 616d 6574 6572 2066 6f72 206d   parameter for m
+00030890: 756c 7469 636c 6173 730a 2020 2020 2020  ulticlass.      
+000308a0: 2020 6966 2073 656c 662e 6973 5f6d 756c    if self.is_mul
+000308b0: 7469 636c 6173 733a 0a20 2020 2020 2020  ticlass:.       
+000308c0: 2020 2020 2069 6620 6e6f 7420 6f70 7469       if not opti
+000308d0: 6d69 7a65 2e69 735f 6d75 6c74 6963 6c61  mize.is_multicla
+000308e0: 7373 3a0a 2020 2020 2020 2020 2020 2020  ss:.            
+000308f0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+00030900: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+00030910: 2020 2020 2020 2020 2022 4f70 7469 6d69           "Optimi
+00030920: 7a61 7469 6f6e 206d 6574 7269 6320 6e6f  zation metric no
+00030930: 7420 7375 7070 6f72 7465 6420 666f 7220  t supported for 
+00030940: 6d75 6c74 6963 6c61 7373 2070 726f 626c  multiclass probl
+00030950: 656d 732e 2053 6565 2064 6f63 7374 7269  ems. See docstri
+00030960: 6e67 2066 6f72 206c 6973 7420 6f66 206f  ng for list of o
+00030970: 7468 6572 206f 7074 696d 697a 6174 696f  ther optimizatio
+00030980: 6e20 7061 7261 6d65 7465 7273 2e22 0a20  n parameters.". 
+00030990: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000309a0: 0a0a 2020 2020 2020 2020 2320 6368 6563  ..        # chec
+000309b0: 6b69 6e67 2072 6574 7572 6e5f 7472 6169  king return_trai
+000309c0: 6e5f 7363 6f72 6520 7061 7261 6d65 7465  n_score paramete
+000309d0: 720a 2020 2020 2020 2020 6966 2074 7970  r.        if typ
+000309e0: 6528 7265 7475 726e 5f74 7261 696e 5f73  e(return_train_s
+000309f0: 636f 7265 2920 6973 206e 6f74 2062 6f6f  core) is not boo
+00030a00: 6c3a 0a20 2020 2020 2020 2020 2020 2072  l:.            r
+00030a10: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
+00030a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030a30: 2272 6574 7572 6e5f 7472 6169 6e5f 7363  "return_train_sc
+00030a40: 6f72 6520 6361 6e20 6f6e 6c79 2074 616b  ore can only tak
+00030a50: 6520 6172 6775 6d65 6e74 2061 7320 5472  e argument as Tr
+00030a60: 7565 206f 7220 4661 6c73 6522 0a20 2020  ue or False".   
+00030a70: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00030a80: 2020 2020 636f 6d70 6172 655f 6469 6d65      compare_dime
+00030a90: 6e73 696f 6e20 3d20 6f70 7469 6d69 7a65  nsion = optimize
+00030aa0: 2e64 6973 706c 6179 5f6e 616d 650a 2020  .display_name.  
+00030ab0: 2020 2020 2020 6772 6561 7465 725f 6973        greater_is
+00030ac0: 5f62 6574 7465 7220 3d20 6f70 7469 6d69  _better = optimi
+00030ad0: 7a65 2e67 7265 6174 6572 5f69 735f 6265  ze.greater_is_be
+00030ae0: 7474 6572 0a20 2020 2020 2020 206f 7074  tter.        opt
+00030af0: 696d 697a 6520 3d20 6f70 7469 6d69 7a65  imize = optimize
+00030b00: 2e73 636f 7265 720a 0a20 2020 2020 2020  .scorer..       
+00030b10: 2062 6573 745f 6d6f 6465 6c20 3d20 4e6f   best_model = No
+00030b20: 6e65 0a20 2020 2020 2020 2062 6573 745f  ne.        best_
+00030b30: 7363 6f72 6520 3d20 4e6f 6e65 0a0a 2020  score = None..  
+00030b40: 2020 2020 2020 6465 6620 636f 6d70 6172        def compar
+00030b50: 655f 7363 6f72 6528 6e65 772c 2062 6573  e_score(new, bes
+00030b60: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+00030b70: 6966 206e 6f74 2062 6573 743a 0a20 2020  if not best:.   
+00030b80: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00030b90: 7572 6e20 5472 7565 0a20 2020 2020 2020  urn True.       
+00030ba0: 2020 2020 2069 6620 6772 6561 7465 725f       if greater_
+00030bb0: 6973 5f62 6574 7465 723a 0a20 2020 2020  is_better:.     
+00030bc0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00030bd0: 6e20 6e65 7720 3e20 6265 7374 0a20 2020  n new > best.   
+00030be0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00030bf0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00030c00: 6574 7572 6e20 6e65 7720 3c20 6265 7374  eturn new < best
+00030c10: 0a0a 2020 2020 2020 2020 6966 2075 7365  ..        if use
+00030c20: 5f68 6f6c 646f 7574 3a0a 2020 2020 2020  _holdout:.      
+00030c30: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
+00030c40: 722e 696e 666f 2822 4d6f 6465 6c20 5365  r.info("Model Se
+00030c50: 6c65 6374 696f 6e20 4261 7369 7320 3a20  lection Basis : 
+00030c60: 486f 6c64 6f75 7420 7365 7422 290a 2020  Holdout set").  
+00030c70: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
+00030c80: 696e 2073 656c 662e 5f6d 6173 7465 725f  in self._master_
+00030c90: 6d6f 6465 6c5f 636f 6e74 6169 6e65 723a  model_container:
+00030ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030cb0: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
+00030cc0: 6f28 6622 4368 6563 6b69 6e67 206d 6f64  o(f"Checking mod
+00030cd0: 656c 207b 697d 2229 0a20 2020 2020 2020  el {i}").       
+00030ce0: 2020 2020 2020 2020 206d 6f64 656c 203d           model =
+00030cf0: 2069 5b22 6d6f 6465 6c22 5d0a 2020 2020   i["model"].    
+00030d00: 2020 2020 2020 2020 2020 2020 7472 793a              try:
+00030d10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030d20: 2020 2020 2073 656c 662e 7072 6564 6963       self.predic
+00030d30: 745f 6d6f 6465 6c28 6d6f 6465 6c2c 2076  t_model(model, v
+00030d40: 6572 626f 7365 3d46 616c 7365 2920 2023  erbose=False)  #
+00030d50: 2074 7970 653a 2069 676e 6f72 650a 2020   type: ignore.  
+00030d60: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00030d70: 6365 7074 2045 7863 6570 7469 6f6e 3a0a  cept Exception:.
 00030d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030d90: 2076 6572 626f 7365 3d46 616c 7365 2c0a   verbose=False,.
-00030da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030db0: 2020 2020 2020 2020 6372 6f73 735f 7661          cross_va
-00030dc0: 6c69 6461 7469 6f6e 3d54 7275 652c 0a20  lidation=True,. 
-00030dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030de0: 2020 2020 2020 2070 7265 6469 6374 3d46         predict=F
-00030df0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-00030e00: 2020 2020 2020 2020 2020 2020 2020 6772                gr
-00030e10: 6f75 7073 3d73 656c 662e 666f 6c64 5f67  oups=self.fold_g
-00030e20: 726f 7570 735f 7061 7261 6d2c 0a20 2020  roups_param,.   
-00030e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030e40: 2020 2020 2072 6574 7572 6e5f 7472 6169       return_trai
-00030e50: 6e5f 7363 6f72 653d 7265 7475 726e 5f74  n_score=return_t
-00030e60: 7261 696e 5f73 636f 7265 2c0a 2020 2020  rain_score,.    
-00030e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030e80: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00030e90: 2020 2020 2020 7363 6f72 6573 203d 2073        scores = s
-00030ea0: 656c 662e 7075 6c6c 2870 6f70 3d54 7275  elf.pull(pop=Tru
-00030eb0: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-00030ec0: 2020 2020 2020 2073 656c 662e 5f6d 6173         self._mas
-00030ed0: 7465 725f 6d6f 6465 6c5f 636f 6e74 6169  ter_model_contai
-00030ee0: 6e65 722e 706f 7028 290a 2020 2020 2020  ner.pop().      
-00030ef0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-00030f00: 6f67 6765 722e 696e 666f 2866 2243 6865  ogger.info(f"Che
-00030f10: 636b 696e 6720 6d6f 6465 6c20 7b69 7d22  cking model {i}"
-00030f20: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00030f30: 2020 6966 2073 636f 7265 7320 6973 204e    if scores is N
-00030f40: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00030f50: 2020 2020 2020 2020 2073 636f 7265 7320           scores 
-00030f60: 3d20 6d6f 6465 6c5b 2273 636f 7265 7322  = model["scores"
-00030f70: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00030f80: 2020 7220 3d20 7363 6f72 6573 5b63 6f6d    r = scores[com
-00030f90: 7061 7265 5f64 696d 656e 7369 6f6e 5d5b  pare_dimension][
-00030fa0: 2d32 3a5d 5b30 5d0a 2020 2020 2020 2020  -2:][0].        
-00030fb0: 2020 2020 2020 2020 6966 2063 6f6d 7061          if compa
-00030fc0: 7265 5f73 636f 7265 2872 2c20 6265 7374  re_score(r, best
-00030fd0: 5f73 636f 7265 293a 0a20 2020 2020 2020  _score):.       
-00030fe0: 2020 2020 2020 2020 2020 2020 2062 6573               bes
-00030ff0: 745f 6d6f 6465 6c20 3d20 6d6f 6465 6c5b  t_model = model[
-00031000: 226d 6f64 656c 225d 0a20 2020 2020 2020  "model"].       
-00031010: 2020 2020 2020 2020 2020 2020 2062 6573               bes
-00031020: 745f 7363 6f72 6520 3d20 720a 0a20 2020  t_score = r..   
-00031030: 2020 2020 2061 7574 6f6d 6c5f 6d6f 6465       automl_mode
-00031040: 6c2c 205f 203d 2073 656c 662e 5f63 7265  l, _ = self._cre
-00031050: 6174 655f 6d6f 6465 6c28 2020 2320 7479  ate_model(  # ty
-00031060: 7065 3a20 6967 6e6f 7265 0a20 2020 2020  pe: ignore.     
-00031070: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
-00031080: 3d62 6573 745f 6d6f 6465 6c2c 0a20 2020  =best_model,.   
-00031090: 2020 2020 2020 2020 2073 7973 7465 6d3d           system=
-000310a0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-000310b0: 2020 2076 6572 626f 7365 3d46 616c 7365     verbose=False
-000310c0: 2c0a 2020 2020 2020 2020 2020 2020 6372  ,.            cr
-000310d0: 6f73 735f 7661 6c69 6461 7469 6f6e 3d46  oss_validation=F
-000310e0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-000310f0: 2020 7072 6564 6963 743d 4661 6c73 652c    predict=False,
-00031100: 0a20 2020 2020 2020 2020 2020 2067 726f  .            gro
-00031110: 7570 733d 7365 6c66 2e66 6f6c 645f 6772  ups=self.fold_gr
-00031120: 6f75 7073 5f70 6172 616d 2c0a 2020 2020  oups_param,.    
-00031130: 2020 2020 2020 2020 7265 7475 726e 5f74          return_t
-00031140: 7261 696e 5f73 636f 7265 3d72 6574 7572  rain_score=retur
-00031150: 6e5f 7472 6169 6e5f 7363 6f72 652c 0a20  n_train_score,. 
-00031160: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00031170: 2020 6763 2e63 6f6c 6c65 6374 2829 0a0a    gc.collect()..
-00031180: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-00031190: 6765 722e 696e 666f 2873 7472 2861 7574  ger.info(str(aut
-000311a0: 6f6d 6c5f 6d6f 6465 6c29 290a 2020 2020  oml_model)).    
-000311b0: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
-000311c0: 696e 666f 280a 2020 2020 2020 2020 2020  info(.          
-000311d0: 2020 2261 7574 6f6d 6c28 2920 7375 6363    "automl() succ
-000311e0: 6573 7366 756c 6c79 2063 6f6d 706c 6574  essfully complet
-000311f0: 6564 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ed..............
-00031200: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00031210: 2e2e 2e2e 2e2e 2e2e 220a 2020 2020 2020  ........".      
-00031220: 2020 290a 0a20 2020 2020 2020 2072 6574    )..        ret
-00031230: 7572 6e20 6175 746f 6d6c 5f6d 6f64 656c  urn automl_model
-00031240: 0a0a 2020 2020 6465 6620 6372 6561 7465  ..    def create
-00031250: 5f61 7070 2873 656c 662c 2065 7374 696d  _app(self, estim
-00031260: 6174 6f72 2c20 6170 705f 6b77 6172 6773  ator, app_kwargs
-00031270: 3a20 4f70 7469 6f6e 616c 5b64 6963 745d  : Optional[dict]
-00031280: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00031290: 2020 2020 2020 2054 6869 7320 6675 6e63         This func
-000312a0: 7469 6f6e 2063 7265 6174 6573 2061 2062  tion creates a b
-000312b0: 6173 6963 2067 7261 6469 6f20 6170 7020  asic gradio app 
-000312c0: 666f 7220 696e 6665 7265 6e63 652e 0a20  for inference.. 
-000312d0: 2020 2020 2020 2049 7420 7769 6c6c 206c         It will l
-000312e0: 6174 6572 2062 6520 6578 7061 6e64 6564  ater be expanded
-000312f0: 2066 6f72 206f 7468 6572 2061 7070 2074   for other app t
-00031300: 7970 6573 2073 7563 6820 6173 0a20 2020  ypes such as.   
-00031310: 2020 2020 2053 7472 6561 6d6c 6974 2e0a       Streamlit..
-00031320: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00031330: 650a 2020 2020 2020 2020 2d2d 2d2d 2d2d  e.        ------
-00031340: 2d0a 2020 2020 2020 2020 3e3e 3e20 6672  -.        >>> fr
-00031350: 6f6d 2070 7963 6172 6574 2e64 6174 6173  om pycaret.datas
-00031360: 6574 7320 696d 706f 7274 2067 6574 5f64  ets import get_d
-00031370: 6174 610a 2020 2020 2020 2020 3e3e 3e20  ata.        >>> 
-00031380: 6a75 6963 6520 3d20 6765 745f 6461 7461  juice = get_data
-00031390: 2827 6a75 6963 6527 290a 2020 2020 2020  ('juice').      
-000313a0: 2020 3e3e 3e20 6672 6f6d 2070 7963 6172    >>> from pycar
-000313b0: 6574 2e63 6c61 7373 6966 6963 6174 696f  et.classificatio
-000313c0: 6e20 696d 706f 7274 202a 0a20 2020 2020  n import *.     
-000313d0: 2020 203e 3e3e 2065 7870 5f6e 616d 6520     >>> exp_name 
-000313e0: 3d20 7365 7475 7028 6461 7461 203d 206a  = setup(data = j
-000313f0: 7569 6365 2c20 2074 6172 6765 7420 3d20  uice,  target = 
-00031400: 2750 7572 6368 6173 6527 290a 2020 2020  'Purchase').    
-00031410: 2020 2020 3e3e 3e20 6c72 203d 2063 7265      >>> lr = cre
-00031420: 6174 655f 6d6f 6465 6c28 276c 7227 290a  ate_model('lr').
-00031430: 2020 2020 2020 2020 3e3e 3e20 6372 6561          >>> crea
-00031440: 7465 5f61 7070 286c 7229 0a0a 0a20 2020  te_app(lr)...   
-00031450: 2020 2020 2065 7374 696d 6174 6f72 3a20       estimator: 
-00031460: 7363 696b 6974 2d6c 6561 726e 2063 6f6d  scikit-learn com
-00031470: 7061 7469 626c 6520 6f62 6a65 6374 0a20  patible object. 
-00031480: 2020 2020 2020 2020 2020 2054 7261 696e             Train
-00031490: 6564 206d 6f64 656c 206f 626a 6563 740a  ed model object.
-000314a0: 0a0a 2020 2020 2020 2020 6170 705f 6b77  ..        app_kw
-000314b0: 6172 6773 3a20 6469 6374 2c20 6465 6661  args: dict, defa
-000314c0: 756c 7420 3d20 7b7d 2028 656d 7074 7920  ult = {} (empty 
-000314d0: 6469 6374 290a 2020 2020 2020 2020 2020  dict).          
-000314e0: 2020 6172 6775 6d65 6e74 7320 746f 2062    arguments to b
-000314f0: 6520 7061 7373 6564 2074 6f20 6170 7020  e passed to app 
-00031500: 636c 6173 732e 0a0a 0a20 2020 2020 2020  class....       
-00031510: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
-00031520: 2020 2020 2020 4e6f 6e65 0a20 2020 2020        None.     
-00031530: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-00031540: 5f63 6865 636b 5f73 6f66 745f 6465 7065  _check_soft_depe
-00031550: 6e64 656e 6369 6573 2822 6772 6164 696f  ndencies("gradio
-00031560: 222c 2065 7874 7261 3d22 6d6c 6f70 7322  ", extra="mlops"
-00031570: 2c20 7365 7665 7269 7479 3d22 6572 726f  , severity="erro
-00031580: 7222 290a 2020 2020 2020 2020 696d 706f  r").        impo
-00031590: 7274 2067 7261 6469 6f20 6173 2067 720a  rt gradio as gr.
-000315a0: 0a20 2020 2020 2020 2061 6c6c 5f69 6e70  .        all_inp
-000315b0: 7574 7320 3d20 5b5d 0a20 2020 2020 2020  uts = [].       
-000315c0: 2061 7070 5f6b 7761 7267 7320 3d20 6170   app_kwargs = ap
-000315d0: 705f 6b77 6172 6773 206f 7220 7b7d 0a0a  p_kwargs or {}..
-000315e0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-000315f0: 2073 656c 662e 582e 636f 6c75 6d6e 733a   self.X.columns:
-00031600: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00031610: 6920 696e 2073 656c 662e 5f66 7873 5b22  i in self._fxs["
-00031620: 4361 7465 676f 7269 6361 6c22 5d20 6f72  Categorical"] or
-00031630: 2069 2069 6e20 7365 6c66 2e5f 6678 735b   i in self._fxs[
-00031640: 224f 7264 696e 616c 225d 3a0a 2020 2020  "Ordinal"]:.    
-00031650: 2020 2020 2020 2020 2020 2020 616c 6c5f              all_
-00031660: 696e 7075 7473 2e61 7070 656e 6428 6772  inputs.append(gr
-00031670: 2e69 6e70 7574 732e 4472 6f70 646f 776e  .inputs.Dropdown
-00031680: 286c 6973 7428 7365 6c66 2e58 5b69 5d2e  (list(self.X[i].
-00031690: 756e 6971 7565 2829 292c 206c 6162 656c  unique()), label
-000316a0: 3d69 2929 0a20 2020 2020 2020 2020 2020  =i)).           
-000316b0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000316c0: 2020 2020 2020 2061 6c6c 5f69 6e70 7574         all_input
-000316d0: 732e 6170 7065 6e64 2867 722e 696e 7075  s.append(gr.inpu
-000316e0: 7473 2e54 6578 7462 6f78 286c 6162 656c  ts.Textbox(label
-000316f0: 3d69 2929 0a0a 2020 2020 2020 2020 6465  =i))..        de
-00031700: 6620 7072 6564 6963 7428 2a64 6963 745f  f predict(*dict_
-00031710: 696e 7075 7429 3a0a 0a20 2020 2020 2020  input):..       
-00031720: 2020 2020 2069 6e70 7574 5f64 6620 3d20       input_df = 
-00031730: 7064 2e44 6174 6146 7261 6d65 2e66 726f  pd.DataFrame.fro
-00031740: 6d5f 6469 6374 285b 6469 6374 5f69 6e70  m_dict([dict_inp
-00031750: 7574 5d29 0a20 2020 2020 2020 2020 2020  ut]).           
-00031760: 2069 6e70 7574 5f64 662e 636f 6c75 6d6e   input_df.column
-00031770: 7320 3d20 6c69 7374 2873 656c 662e 582e  s = list(self.X.
-00031780: 636f 6c75 6d6e 7329 0a20 2020 2020 2020  columns).       
-00031790: 2020 2020 2072 6574 7572 6e20 280a 2020       return (.  
-000317a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000317b0: 6c66 2e70 7265 6469 6374 5f6d 6f64 656c  lf.predict_model
-000317c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000317d0: 2020 2020 2020 6573 7469 6d61 746f 722c        estimator,
-000317e0: 2064 6174 613d 696e 7075 745f 6466 2c20   data=input_df, 
-000317f0: 2a2a 7365 6c66 2e5f 6372 6561 7465 5f61  **self._create_a
-00031800: 7070 5f70 7265 6469 6374 5f6b 7761 7267  pp_predict_kwarg
-00031810: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-00031820: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00031830: 2020 2020 2e69 6c6f 635b 305d 0a20 2020      .iloc[0].   
-00031840: 2020 2020 2020 2020 2020 2020 202e 746f               .to
-00031850: 5f64 6963 7428 290a 2020 2020 2020 2020  _dict().        
-00031860: 2020 2020 290a 0a20 2020 2020 2020 2072      )..        r
-00031870: 6574 7572 6e20 6772 2e49 6e74 6572 6661  eturn gr.Interfa
-00031880: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
-00031890: 666e 3d70 7265 6469 6374 2c0a 2020 2020  fn=predict,.    
-000318a0: 2020 2020 2020 2020 696e 7075 7473 3d61          inputs=a
-000318b0: 6c6c 5f69 6e70 7574 732c 0a20 2020 2020  ll_inputs,.     
-000318c0: 2020 2020 2020 206f 7574 7075 7473 3d22         outputs="
-000318d0: 7465 7874 222c 0a20 2020 2020 2020 2020  text",.         
-000318e0: 2020 206c 6976 653d 4661 6c73 652c 0a20     live=False,. 
-000318f0: 2020 2020 2020 2020 2020 202a 2a61 7070             **app
-00031900: 5f6b 7761 7267 732c 0a20 2020 2020 2020  _kwargs,.       
-00031910: 2029 2e6c 6175 6e63 6828 290a 0a20 2020   ).launch()..   
-00031920: 2064 6566 2064 6173 6862 6f61 7264 280a   def dashboard(.
-00031930: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00031940: 2020 2020 2020 6573 7469 6d61 746f 722c        estimator,
-00031950: 0a20 2020 2020 2020 2064 6973 706c 6179  .        display
-00031960: 5f66 6f72 6d61 743a 2073 7472 203d 2022  _format: str = "
-00031970: 6461 7368 222c 0a20 2020 2020 2020 2064  dash",.        d
-00031980: 6173 6862 6f61 7264 5f6b 7761 7267 733a  ashboard_kwargs:
-00031990: 204f 7074 696f 6e61 6c5b 4469 6374 5b73   Optional[Dict[s
-000319a0: 7472 2c20 416e 795d 5d20 3d20 4e6f 6e65  tr, Any]] = None
-000319b0: 2c0a 2020 2020 2020 2020 7275 6e5f 6b77  ,.        run_kw
-000319c0: 6172 6773 3a20 4f70 7469 6f6e 616c 5b44  args: Optional[D
-000319d0: 6963 745b 7374 722c 2041 6e79 5d5d 203d  ict[str, Any]] =
-000319e0: 204e 6f6e 652c 0a20 2020 2020 2020 202a   None,.        *
-000319f0: 2a6b 7761 7267 732c 0a20 2020 2029 3a0a  *kwargs,.    ):.
-00031a00: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00031a10: 2020 2020 5468 6973 2066 756e 6374 696f      This functio
-00031a20: 6e20 6765 6e65 7261 7465 7320 7468 6520  n generates the 
-00031a30: 696e 7465 7261 6374 6976 6520 6461 7368  interactive dash
-00031a40: 626f 6172 6420 666f 7220 6120 7472 6169  board for a trai
-00031a50: 6e65 6420 6d6f 6465 6c2e 2054 6865 0a20  ned model. The. 
-00031a60: 2020 2020 2020 2064 6173 6862 6f61 7264         dashboard
-00031a70: 2069 7320 696d 706c 656d 656e 7465 6420   is implemented 
-00031a80: 7573 696e 6720 4578 706c 6169 6e65 7244  using ExplainerD
-00031a90: 6173 6862 6f61 7264 2028 6578 706c 6169  ashboard (explai
-00031aa0: 6e65 7264 6173 6862 6f61 7264 2e72 6561  nerdashboard.rea
-00031ab0: 6474 6865 646f 6373 2e69 6f29 0a0a 0a20  dthedocs.io)... 
-00031ac0: 2020 2020 2020 2045 7861 6d70 6c65 0a20         Example. 
-00031ad0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-00031ae0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-00031af0: 7079 6361 7265 742e 6461 7461 7365 7473  pycaret.datasets
-00031b00: 2069 6d70 6f72 7420 6765 745f 6461 7461   import get_data
-00031b10: 0a20 2020 2020 2020 203e 3e3e 206a 7569  .        >>> jui
-00031b20: 6365 203d 2067 6574 5f64 6174 6128 276a  ce = get_data('j
-00031b30: 7569 6365 2729 0a20 2020 2020 2020 203e  uice').        >
-00031b40: 3e3e 2066 726f 6d20 7079 6361 7265 742e  >> from pycaret.
-00031b50: 636c 6173 7369 6669 6361 7469 6f6e 2069  classification i
-00031b60: 6d70 6f72 7420 2a0a 2020 2020 2020 2020  mport *.        
-00031b70: 3e3e 3e20 6578 705f 6e61 6d65 203d 2073  >>> exp_name = s
-00031b80: 6574 7570 2864 6174 6120 3d20 6a75 6963  etup(data = juic
-00031b90: 652c 2020 7461 7267 6574 203d 2027 5075  e,  target = 'Pu
-00031ba0: 7263 6861 7365 2729 0a20 2020 2020 2020  rchase').       
-00031bb0: 203e 3e3e 206c 7220 3d20 6372 6561 7465   >>> lr = create
-00031bc0: 5f6d 6f64 656c 2827 6c72 2729 0a20 2020  _model('lr').   
-00031bd0: 2020 2020 203e 3e3e 2064 6173 6862 6f61       >>> dashboa
-00031be0: 7264 286c 7229 0a0a 0a20 2020 2020 2020  rd(lr)...       
-00031bf0: 2065 7374 696d 6174 6f72 3a20 7363 696b   estimator: scik
-00031c00: 6974 2d6c 6561 726e 2063 6f6d 7061 7469  it-learn compati
-00031c10: 626c 6520 6f62 6a65 6374 0a20 2020 2020  ble object.     
-00031c20: 2020 2020 2020 2054 7261 696e 6564 206d         Trained m
-00031c30: 6f64 656c 206f 626a 6563 740a 0a0a 2020  odel object...  
-00031c40: 2020 2020 2020 6469 7370 6c61 795f 666f        display_fo
-00031c50: 726d 6174 3a20 7374 722c 2064 6566 6175  rmat: str, defau
-00031c60: 6c74 203d 2027 6461 7368 270a 2020 2020  lt = 'dash'.    
-00031c70: 2020 2020 2020 2020 5265 6e64 6572 206d          Render m
-00031c80: 6f64 6520 666f 7220 7468 6520 6461 7368  ode for the dash
-00031c90: 626f 6172 642e 2054 6865 2064 6566 6175  board. The defau
-00031ca0: 6c74 2069 7320 7365 7420 746f 2060 6064  lt is set to ``d
-00031cb0: 6173 6860 6020 7768 6963 6820 7769 6c6c  ash`` which will
-00031cc0: 0a20 2020 2020 2020 2020 2020 2072 656e  .            ren
-00031cd0: 6465 7220 6120 6461 7368 626f 6172 6420  der a dashboard 
-00031ce0: 696e 2062 726f 7773 6572 2e20 5468 6572  in browser. Ther
-00031cf0: 6520 6172 6520 666f 7572 2070 6f73 7369  e are four possi
-00031d00: 626c 6520 6f70 7469 6f6e 733a 0a0a 2020  ble options:..  
-00031d10: 2020 2020 2020 2020 2020 2d20 2764 6173            - 'das
-00031d20: 6827 202d 2064 6973 706c 6179 7320 7468  h' - displays th
-00031d30: 6520 6461 7368 626f 6172 6420 696e 2062  e dashboard in b
-00031d40: 726f 7773 6572 0a20 2020 2020 2020 2020  rowser.         
-00031d50: 2020 202d 2027 696e 6c69 6e65 2720 2d20     - 'inline' - 
-00031d60: 6469 7370 6c61 7973 2074 6865 2064 6173  displays the das
-00031d70: 6862 6f61 7264 2069 6e20 7468 6520 6a75  hboard in the ju
-00031d80: 7079 7465 7220 6e6f 7465 626f 6f6b 2063  pyter notebook c
-00031d90: 656c 6c2e 0a20 2020 2020 2020 2020 2020  ell..           
-00031da0: 202d 2027 6a75 7079 7465 726c 6162 2720   - 'jupyterlab' 
-00031db0: 2d20 6469 7370 6c61 7973 2074 6865 2064  - displays the d
-00031dc0: 6173 6862 6f61 7264 2069 6e20 6a75 7079  ashboard in jupy
-00031dd0: 7465 726c 6162 2070 616e 652e 0a20 2020  terlab pane..   
-00031de0: 2020 2020 2020 2020 202d 2027 6578 7465           - 'exte
-00031df0: 726e 616c 2720 2d20 6469 7370 6c61 7973  rnal' - displays
-00031e00: 2074 6865 2064 6173 6862 6f61 7264 2069   the dashboard i
-00031e10: 6e20 6120 7365 7061 7261 7465 2074 6162  n a separate tab
-00031e20: 2e20 2875 7365 2069 6e20 436f 6c61 6229  . (use in Colab)
-00031e30: 0a0a 0a20 2020 2020 2020 2064 6173 6862  ...        dashb
-00031e40: 6f61 7264 5f6b 7761 7267 733a 2064 6963  oard_kwargs: dic
-00031e50: 742c 2064 6566 6175 6c74 203d 207b 7d20  t, default = {} 
-00031e60: 2865 6d70 7479 2064 6963 7429 0a20 2020  (empty dict).   
-00031e70: 2020 2020 2020 2020 2044 6963 7469 6f6e           Diction
-00031e80: 6172 7920 6f66 2061 7267 756d 656e 7473  ary of arguments
-00031e90: 2070 6173 7365 6420 746f 2074 6865 2060   passed to the `
-00031ea0: 6045 7870 6c61 696e 6572 4461 7368 626f  `ExplainerDashbo
-00031eb0: 6172 6460 6020 636c 6173 732e 0a0a 0a20  ard`` class.... 
-00031ec0: 2020 2020 2020 2072 756e 5f6b 7761 7267         run_kwarg
-00031ed0: 733a 2064 6963 742c 2064 6566 6175 6c74  s: dict, default
-00031ee0: 203d 207b 7d20 2865 6d70 7479 2064 6963   = {} (empty dic
-00031ef0: 7429 0a20 2020 2020 2020 2020 2020 2044  t).            D
-00031f00: 6963 7469 6f6e 6172 7920 6f66 2061 7267  ictionary of arg
-00031f10: 756d 656e 7473 2070 6173 7365 6420 746f  uments passed to
-00031f20: 2074 6865 2060 6072 756e 6060 206d 6574   the ``run`` met
-00031f30: 686f 6420 6f66 2060 6045 7870 6c61 696e  hod of ``Explain
-00031f40: 6572 4461 7368 626f 6172 6460 602e 0a0a  erDashboard``...
-00031f50: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
-00031f60: 733a 0a20 2020 2020 2020 2020 2020 2041  s:.            A
-00031f70: 6464 6974 696f 6e61 6c20 6b65 7977 6f72  dditional keywor
-00031f80: 6420 6172 6775 6d65 6e74 7320 746f 2070  d arguments to p
-00031f90: 6173 7320 746f 2074 6865 2060 6043 6c61  ass to the ``Cla
-00031fa0: 7373 6966 6965 7245 7870 6c61 696e 6572  ssifierExplainer
-00031fb0: 6060 206f 720a 2020 2020 2020 2020 2020  `` or.          
-00031fc0: 2020 6060 5265 6772 6573 7369 6f6e 4578    ``RegressionEx
-00031fd0: 706c 6169 6e65 7260 6020 636c 6173 732e  plainer`` class.
-00031fe0: 0a0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-00031ff0: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
-00032000: 4e6f 6e65 0a20 2020 2020 2020 2022 2222  None.        """
-00032010: 0a0a 2020 2020 2020 2020 5f63 6865 636b  ..        _check
-00032020: 5f73 6f66 745f 6465 7065 6e64 656e 6369  _soft_dependenci
-00032030: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
-00032040: 2265 7870 6c61 696e 6572 6461 7368 626f  "explainerdashbo
-00032050: 6172 6422 2c20 6578 7472 613d 2261 6e61  ard", extra="ana
-00032060: 6c79 7369 7322 2c20 7365 7665 7269 7479  lysis", severity
-00032070: 3d22 6572 726f 7222 0a20 2020 2020 2020  ="error".       
-00032080: 2029 0a0a 2020 2020 6465 6620 6465 6570   )..    def deep
-00032090: 5f63 6865 636b 2873 656c 662c 2065 7374  _check(self, est
-000320a0: 696d 6174 6f72 2c20 6368 6563 6b5f 6b77  imator, check_kw
-000320b0: 6172 6773 3a20 4f70 7469 6f6e 616c 5b64  args: Optional[d
-000320c0: 6963 745d 293a 0a20 2020 2020 2020 2022  ict]):.        "
-000320d0: 2222 0a20 2020 2020 2020 2054 6869 7320  "".        This 
-000320e0: 6675 6e63 7469 6f6e 2072 756e 7320 6120  function runs a 
-000320f0: 6675 6c6c 2073 7569 7465 2063 6865 636b  full suite check
-00032100: 206f 7665 7220 6120 7472 6169 6e65 6420   over a trained 
-00032110: 6d6f 6465 6c0a 2020 2020 2020 2020 7573  model.        us
-00032120: 696e 6720 6465 6570 6368 6563 6b73 206c  ing deepchecks l
-00032130: 6962 7261 7279 2e0a 0a0a 2020 2020 2020  ibrary....      
-00032140: 2020 4578 616d 706c 650a 2020 2020 2020    Example.      
-00032150: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-00032160: 2020 3e3e 3e20 6672 6f6d 2070 7963 6172    >>> from pycar
-00032170: 6574 2e64 6174 6173 6574 7320 696d 706f  et.datasets impo
-00032180: 7274 2067 6574 5f64 6174 610a 2020 2020  rt get_data.    
-00032190: 2020 2020 3e3e 3e20 6a75 6963 6520 3d20      >>> juice = 
-000321a0: 6765 745f 6461 7461 2827 6a75 6963 6527  get_data('juice'
-000321b0: 290a 2020 2020 2020 2020 3e3e 3e20 6672  ).        >>> fr
-000321c0: 6f6d 2070 7963 6172 6574 2e63 6c61 7373  om pycaret.class
-000321d0: 6966 6963 6174 696f 6e20 696d 706f 7274  ification import
-000321e0: 202a 0a20 2020 2020 2020 203e 3e3e 2065   *.        >>> e
-000321f0: 7870 5f6e 616d 6520 3d20 7365 7475 7028  xp_name = setup(
-00032200: 6461 7461 203d 206a 7569 6365 2c20 2074  data = juice,  t
-00032210: 6172 6765 7420 3d20 2750 7572 6368 6173  arget = 'Purchas
-00032220: 6527 290a 2020 2020 2020 2020 3e3e 3e20  e').        >>> 
-00032230: 6c72 203d 2063 7265 6174 655f 6d6f 6465  lr = create_mode
-00032240: 6c28 276c 7227 290a 2020 2020 2020 2020  l('lr').        
-00032250: 3e3e 3e20 6465 6570 5f63 6865 636b 286c  >>> deep_check(l
-00032260: 7229 0a0a 0a20 2020 2020 2020 2065 7374  r)...        est
-00032270: 696d 6174 6f72 3a20 7363 696b 6974 2d6c  imator: scikit-l
-00032280: 6561 726e 2063 6f6d 7061 7469 626c 6520  earn compatible 
-00032290: 6f62 6a65 6374 0a20 2020 2020 2020 2020  object.         
-000322a0: 2020 2054 7261 696e 6564 206d 6f64 656c     Trained model
-000322b0: 206f 626a 6563 740a 0a0a 2020 2020 2020   object...      
-000322c0: 2020 6368 6563 6b5f 6b77 6172 6773 3a20    check_kwargs: 
-000322d0: 6469 6374 2c20 6465 6661 756c 7420 3d20  dict, default = 
-000322e0: 7b7d 2028 656d 7074 7920 6469 6374 290a  {} (empty dict).
-000322f0: 2020 2020 2020 2020 2020 2020 6172 6775              argu
-00032300: 6d65 6e74 7320 746f 2062 6520 7061 7373  ments to be pass
-00032310: 6564 2074 6f20 6465 6570 6368 6563 6b73  ed to deepchecks
-00032320: 2066 756c 6c5f 7375 6974 6520 636c 6173   full_suite clas
-00032330: 732e 0a0a 0a20 2020 2020 2020 2052 6574  s....        Ret
-00032340: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
-00032350: 2020 5265 7375 6c74 7320 6f66 2064 6565    Results of dee
-00032360: 7063 6865 636b 732e 7375 6974 6573 2e66  pchecks.suites.f
-00032370: 756c 6c5f 7375 6974 652e 7275 6e0a 2020  ull_suite.run.  
-00032380: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00032390: 2020 205f 6368 6563 6b5f 736f 6674 5f64     _check_soft_d
-000323a0: 6570 656e 6465 6e63 6965 7328 2264 6565  ependencies("dee
-000323b0: 7063 6865 636b 7322 2c20 6578 7472 613d  pchecks", extra=
-000323c0: 2261 6e61 6c79 7369 7322 2c20 7365 7665  "analysis", seve
-000323d0: 7269 7479 3d22 6572 726f 7222 290a 2020  rity="error").  
-000323e0: 2020 2020 2020 6368 6563 6b5f 6b77 6172        check_kwar
-000323f0: 6773 203d 2063 6865 636b 5f6b 7761 7267  gs = check_kwarg
-00032400: 7320 6f72 207b 7d0a 0a20 2020 2020 2020  s or {}..       
-00032410: 2066 726f 6d20 6465 6570 6368 6563 6b73   from deepchecks
-00032420: 2069 6d70 6f72 7420 4461 7461 7365 740a   import Dataset.
-00032430: 0a20 2020 2020 2020 2064 735f 7472 6169  .        ds_trai
-00032440: 6e20 3d20 4461 7461 7365 7428 0a20 2020  n = Dataset(.   
-00032450: 2020 2020 2020 2020 2073 656c 662e 585f           self.X_
-00032460: 7472 6169 6e5f 7472 616e 7366 6f72 6d65  train_transforme
-00032470: 642c 206c 6162 656c 3d73 656c 662e 795f  d, label=self.y_
-00032480: 7472 6169 6e5f 7472 616e 7366 6f72 6d65  train_transforme
-00032490: 642c 2063 6174 5f66 6561 7475 7265 733d  d, cat_features=
-000324a0: 5b5d 0a20 2020 2020 2020 2029 0a20 2020  [].        ).   
-000324b0: 2020 2020 2064 735f 7465 7374 203d 2044       ds_test = D
-000324c0: 6174 6173 6574 280a 2020 2020 2020 2020  ataset(.        
-000324d0: 2020 2020 7365 6c66 2e58 5f74 6573 745f      self.X_test_
-000324e0: 7472 616e 7366 6f72 6d65 642c 206c 6162  transformed, lab
-000324f0: 656c 3d73 656c 662e 795f 7465 7374 5f74  el=self.y_test_t
-00032500: 7261 6e73 666f 726d 6564 2c20 6361 745f  ransformed, cat_
-00032510: 6665 6174 7572 6573 3d5b 5d0a 2020 2020  features=[].    
-00032520: 2020 2020 290a 0a20 2020 2020 2020 2066      )..        f
-00032530: 726f 6d20 6465 6570 6368 6563 6b73 2e74  rom deepchecks.t
-00032540: 6162 756c 6172 2e73 7569 7465 7320 696d  abular.suites im
-00032550: 706f 7274 2066 756c 6c5f 7375 6974 650a  port full_suite.
-00032560: 0a20 2020 2020 2020 2073 7569 7465 203d  .        suite =
-00032570: 2066 756c 6c5f 7375 6974 6528 2a2a 6368   full_suite(**ch
-00032580: 6563 6b5f 6b77 6172 6773 290a 2020 2020  eck_kwargs).    
-00032590: 2020 2020 7265 7475 726e 2073 7569 7465      return suite
-000325a0: 2e72 756e 2874 7261 696e 5f64 6174 6173  .run(train_datas
-000325b0: 6574 3d64 735f 7472 6169 6e2c 2074 6573  et=ds_train, tes
-000325c0: 745f 6461 7461 7365 743d 6473 5f74 6573  t_dataset=ds_tes
-000325d0: 742c 206d 6f64 656c 3d65 7374 696d 6174  t, model=estimat
-000325e0: 6f72 290a 0a20 2020 2064 6566 2063 6865  or)..    def che
-000325f0: 636b 5f64 7269 6674 280a 2020 2020 2020  ck_drift(.      
-00032600: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00032610: 7265 6665 7265 6e63 655f 6461 7461 3a20  reference_data: 
-00032620: 4f70 7469 6f6e 616c 5b70 642e 4461 7461  Optional[pd.Data
-00032630: 4672 616d 655d 203d 204e 6f6e 652c 0a20  Frame] = None,. 
-00032640: 2020 2020 2020 2063 7572 7265 6e74 5f64         current_d
-00032650: 6174 613a 204f 7074 696f 6e61 6c5b 7064  ata: Optional[pd
-00032660: 2e44 6174 6146 7261 6d65 5d20 3d20 4e6f  .DataFrame] = No
-00032670: 6e65 2c0a 2020 2020 2020 2020 7461 7267  ne,.        targ
-00032680: 6574 3a20 4f70 7469 6f6e 616c 5b73 7472  et: Optional[str
-00032690: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-000326a0: 2020 6e75 6d65 7269 635f 6665 6174 7572    numeric_featur
-000326b0: 6573 3a20 4f70 7469 6f6e 616c 5b4c 6973  es: Optional[Lis
-000326c0: 745b 7374 725d 5d20 3d20 4e6f 6e65 2c0a  t[str]] = None,.
-000326d0: 2020 2020 2020 2020 6361 7465 676f 7269          categori
-000326e0: 6361 6c5f 6665 6174 7572 6573 3a20 4f70  cal_features: Op
-000326f0: 7469 6f6e 616c 5b4c 6973 745b 7374 725d  tional[List[str]
-00032700: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00032710: 2020 6461 7465 5f66 6561 7475 7265 733a    date_features:
-00032720: 204f 7074 696f 6e61 6c5b 4c69 7374 5b73   Optional[List[s
-00032730: 7472 5d5d 203d 204e 6f6e 652c 0a20 2020  tr]] = None,.   
-00032740: 2020 2020 2066 696c 656e 616d 653a 204f       filename: O
-00032750: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
-00032760: 6f6e 652c 0a20 2020 2029 202d 3e20 7374  one,.    ) -> st
-00032770: 723a 0a20 2020 2020 2020 2022 2222 0a20  r:.        """. 
-00032780: 2020 2020 2020 2054 6869 7320 6675 6e63         This func
-00032790: 7469 6f6e 2067 656e 6572 6174 6573 2061  tion generates a
-000327a0: 2064 7269 6674 2072 6570 6f72 7420 6669   drift report fi
-000327b0: 6c65 2075 7369 6e67 2074 6865 0a20 2020  le using the.   
-000327c0: 2020 2020 2065 7669 6465 6e74 6c79 206c       evidently l
-000327d0: 6962 7261 7279 2e0a 0a0a 2020 2020 2020  ibrary....      
-000327e0: 2020 4578 616d 706c 650a 2020 2020 2020    Example.      
-000327f0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-00032800: 2020 3e3e 3e20 6672 6f6d 2070 7963 6172    >>> from pycar
-00032810: 6574 2e64 6174 6173 6574 7320 696d 706f  et.datasets impo
-00032820: 7274 2067 6574 5f64 6174 610a 2020 2020  rt get_data.    
-00032830: 2020 2020 3e3e 3e20 6a75 6963 6520 3d20      >>> juice = 
-00032840: 6765 745f 6461 7461 2827 6a75 6963 6527  get_data('juice'
-00032850: 290a 2020 2020 2020 2020 3e3e 3e20 6672  ).        >>> fr
-00032860: 6f6d 2070 7963 6172 6574 2e63 6c61 7373  om pycaret.class
-00032870: 6966 6963 6174 696f 6e20 696d 706f 7274  ification import
-00032880: 202a 0a20 2020 2020 2020 203e 3e3e 2065   *.        >>> e
-00032890: 7870 5f6e 616d 6520 3d20 7365 7475 7028  xp_name = setup(
-000328a0: 6461 7461 203d 206a 7569 6365 2c20 2074  data = juice,  t
-000328b0: 6172 6765 7420 3d20 2750 7572 6368 6173  arget = 'Purchas
-000328c0: 6527 290a 2020 2020 2020 2020 3e3e 3e20  e').        >>> 
-000328d0: 6368 6563 6b5f 6472 6966 7428 290a 0a0a  check_drift()...
-000328e0: 2020 2020 2020 2020 7265 6665 7265 6e63          referenc
-000328f0: 655f 6461 7461 3a20 4f70 7469 6f6e 616c  e_data: Optional
-00032900: 5b70 642e 4461 7461 4672 616d 655d 203d  [pd.DataFrame] =
-00032910: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
-00032920: 2020 5265 6665 7265 6e63 6520 6461 7461    Reference data
-00032930: 2e20 4966 206e 6f74 2073 7065 6369 6669  . If not specifi
-00032940: 6564 2c20 7769 6c6c 2075 7365 2074 7261  ed, will use tra
-00032950: 696e 696e 6720 6461 7461 2e0a 2020 2020  ining data..    
-00032960: 2020 2020 2020 2020 4d75 7374 2062 6520          Must be 
-00032970: 7370 6563 6966 6965 6420 6966 2060 6073  specified if ``s
-00032980: 6574 7570 2829 6060 2068 6173 206e 6f74  etup()`` has not
-00032990: 2062 6565 6e20 7275 6e2e 0a0a 0a20 2020   been run....   
-000329a0: 2020 2020 2063 7572 7265 6e74 5f64 6174       current_dat
-000329b0: 613a 204f 7074 696f 6e61 6c5b 7064 2e44  a: Optional[pd.D
-000329c0: 6174 6146 7261 6d65 5d20 3d20 4e6f 6e65  ataFrame] = None
-000329d0: 0a20 2020 2020 2020 2020 2020 2043 7572  .            Cur
-000329e0: 7265 6e74 2064 6174 612e 2049 6620 6e6f  rent data. If no
-000329f0: 7420 7370 6563 6966 6965 642c 2077 696c  t specified, wil
-00032a00: 6c20 7573 6520 7465 7374 2064 6174 612e  l use test data.
-00032a10: 0a20 2020 2020 2020 2020 2020 204d 7573  .            Mus
-00032a20: 7420 6265 2073 7065 6369 6669 6564 2069  t be specified i
-00032a30: 6620 6060 7365 7475 7028 2960 6020 6861  f ``setup()`` ha
-00032a40: 7320 6e6f 7420 6265 656e 2072 756e 2e0a  s not been run..
-00032a50: 0a0a 2020 2020 2020 2020 7461 7267 6574  ..        target
-00032a60: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-00032a70: 3d20 4e6f 6e65 0a20 2020 2020 2020 2020  = None.         
-00032a80: 2020 204e 616d 6520 6f66 2074 6865 2074     Name of the t
-00032a90: 6172 6765 7420 636f 6c75 6d6e 2e20 4966  arget column. If
-00032aa0: 206e 6f74 2073 7065 6369 6669 6564 2c20   not specified, 
-00032ab0: 7769 6c6c 2075 7365 0a20 2020 2020 2020  will use.       
-00032ac0: 2020 2020 2074 6865 2063 6f6c 756d 6e20       the column 
-00032ad0: 7370 6563 6966 6965 6420 696e 2060 6073  specified in ``s
-00032ae0: 6574 7570 2829 6060 2e0a 2020 2020 2020  etup()``..      
-00032af0: 2020 2020 2020 4d75 7374 2062 6520 7370        Must be sp
-00032b00: 6563 6966 6965 6420 6966 2060 6073 6574  ecified if ``set
-00032b10: 7570 2829 6060 2068 6173 206e 6f74 2062  up()`` has not b
-00032b20: 6565 6e20 7275 6e2e 0a0a 0a20 2020 2020  een run....     
-00032b30: 2020 206e 756d 6572 6963 5f66 6561 7475     numeric_featu
-00032b40: 7265 733a 204f 7074 696f 6e61 6c5b 4c69  res: Optional[Li
-00032b50: 7374 5b73 7472 5d5d 203d 204e 6f6e 650a  st[str]] = None.
-00032b60: 2020 2020 2020 2020 2020 2020 4e61 6d65              Name
-00032b70: 7320 6f66 206e 756d 6572 6963 2063 6f6c  s of numeric col
-00032b80: 756d 6e73 2e20 4966 206e 6f74 2073 7065  umns. If not spe
-00032b90: 6369 6669 6564 2c20 7769 6c6c 2075 7365  cified, will use
-00032ba0: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
-00032bb0: 2063 6f6c 756d 6e73 2073 7065 6369 6669   columns specifi
-00032bc0: 6564 2f69 6e66 6572 7265 6420 696e 2060  ed/inferred in `
-00032bd0: 6073 6574 7570 2829 6060 2c20 6f72 0a20  `setup()``, or. 
-00032be0: 2020 2020 2020 2020 2020 2061 6c6c 206e             all n
-00032bf0: 6f6e 2d63 6174 6567 6f72 6963 616c 2061  on-categorical a
-00032c00: 6e64 206e 6f6e 2d64 6174 6520 636f 6c75  nd non-date colu
-00032c10: 6d6e 7320 6f74 6865 7277 6973 652e 0a0a  mns otherwise...
-00032c20: 0a20 2020 2020 2020 2063 6174 6567 6f72  .        categor
-00032c30: 6963 616c 5f66 6561 7475 7265 733a 204f  ical_features: O
-00032c40: 7074 696f 6e61 6c5b 4c69 7374 5b73 7472  ptional[List[str
-00032c50: 5d5d 203d 204e 6f6e 650a 2020 2020 2020  ]] = None.      
-00032c60: 2020 2020 2020 4e61 6d65 7320 6f66 2063        Names of c
-00032c70: 6174 6567 6f72 6963 616c 2063 6f6c 756d  ategorical colum
-00032c80: 6e73 2e20 4966 206e 6f74 2073 7065 6369  ns. If not speci
-00032c90: 6669 6564 2c20 7769 6c6c 2075 7365 0a20  fied, will use. 
-00032ca0: 2020 2020 2020 2020 2020 2074 6865 2063             the c
-00032cb0: 6f6c 756d 6e73 2073 7065 6369 6669 6564  olumns specified
-00032cc0: 2f69 6e66 6572 7265 6420 696e 2060 6073  /inferred in ``s
-00032cd0: 6574 7570 2829 6060 2e0a 0a0a 2020 2020  etup()``....    
-00032ce0: 2020 2020 6461 7465 5f66 6561 7475 7265      date_feature
-00032cf0: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
-00032d00: 5b73 7472 5d5d 203d 204e 6f6e 650a 2020  [str]] = None.  
-00032d10: 2020 2020 2020 2020 2020 4e61 6d65 7320            Names 
-00032d20: 6f66 2064 6174 6520 636f 6c75 6d6e 732e  of date columns.
-00032d30: 2049 6620 6e6f 7420 7370 6563 6966 6965   If not specifie
-00032d40: 642c 2077 696c 6c20 7573 650a 2020 2020  d, will use.    
-00032d50: 2020 2020 2020 2020 7468 6520 636f 6c75          the colu
-00032d60: 6d6e 7320 7370 6563 6966 6965 642f 696e  mns specified/in
-00032d70: 6665 7272 6564 2069 6e20 6060 7365 7475  ferred in ``setu
-00032d80: 7028 2960 602e 0a0a 0a20 2020 2020 2020  p()``....       
-00032d90: 2066 696c 656e 616d 653a 204f 7074 696f   filename: Optio
-00032da0: 6e61 6c5b 7374 725d 203d 204e 6f6e 650a  nal[str] = None.
-00032db0: 2020 2020 2020 2020 2020 2020 5061 7468              Path
-00032dc0: 2074 6f20 7361 7665 2074 6865 2067 656e   to save the gen
-00032dd0: 6572 6174 6564 2048 544d 4c20 6669 6c65  erated HTML file
-00032de0: 2074 6f2e 2049 6620 6e6f 7420 7370 6563   to. If not spec
-00032df0: 6966 6965 642c 0a20 2020 2020 2020 2020  ified,.         
-00032e00: 2020 2077 696c 6c20 6465 6661 756c 7420     will default 
-00032e10: 746f 2027 5b45 5850 4552 494d 454e 545f  to '[EXPERIMENT_
-00032e20: 4e41 4d45 5d5f 5b54 494d 4553 5441 4d50  NAME]_[TIMESTAMP
-00032e30: 5d5f 4472 6966 745f 5265 706f 7274 2e68  ]_Drift_Report.h
-00032e40: 746d 6c27 2e0a 0a0a 2020 2020 2020 2020  tml'....        
-00032e50: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
-00032e60: 2020 2020 2050 6174 6820 7468 6520 6765       Path the ge
-00032e70: 6e65 7261 7465 6420 4854 4d4c 2066 696c  nerated HTML fil
-00032e80: 6520 7761 7320 7361 7665 6420 746f 2e0a  e was saved to..
-00032e90: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00032ea0: 2020 2020 5f63 6865 636b 5f73 6f66 745f      _check_soft_
-00032eb0: 6465 7065 6e64 656e 6369 6573 2822 6576  dependencies("ev
-00032ec0: 6964 656e 746c 7922 2c20 6578 7472 613d  idently", extra=
-00032ed0: 226d 6c6f 7073 222c 2073 6576 6572 6974  "mlops", severit
-00032ee0: 793d 2265 7272 6f72 2229 0a0a 2020 2020  y="error")..    
-00032ef0: 2020 2020 6966 2073 656c 662e 5f73 6574      if self._set
-00032f00: 7570 5f72 616e 3a0a 2020 2020 2020 2020  up_ran:.        
-00032f10: 2020 2020 7265 6665 7265 6e63 655f 6461      reference_da
-00032f20: 7461 203d 2073 656c 662e 7472 6169 6e20  ta = self.train 
-00032f30: 6966 2072 6566 6572 656e 6365 5f64 6174  if reference_dat
-00032f40: 6120 6973 204e 6f6e 6520 656c 7365 2072  a is None else r
-00032f50: 6566 6572 656e 6365 5f64 6174 610a 2020  eference_data.  
-00032f60: 2020 2020 2020 2020 2020 6375 7272 656e            curren
-00032f70: 745f 6461 7461 203d 2073 656c 662e 7465  t_data = self.te
-00032f80: 7374 2069 6620 6375 7272 656e 745f 6461  st if current_da
-00032f90: 7461 2069 7320 4e6f 6e65 2065 6c73 6520  ta is None else 
-00032fa0: 6375 7272 656e 745f 6461 7461 0a20 2020  current_data.   
-00032fb0: 2020 2020 2020 2020 2074 6172 6765 7420           target 
-00032fc0: 3d20 7365 6c66 2e74 6172 6765 745f 7061  = self.target_pa
-00032fd0: 7261 6d20 6966 2074 6172 6765 7420 6973  ram if target is
-00032fe0: 204e 6f6e 6520 656c 7365 2074 6172 6765   None else targe
-00032ff0: 740a 2020 2020 2020 2020 2020 2020 6e75  t.            nu
-00033000: 6d65 7269 635f 6665 6174 7572 6573 203d  meric_features =
-00033010: 206e 756d 6572 6963 5f66 6561 7475 7265   numeric_feature
-00033020: 7320 6f72 2073 656c 662e 5f66 7873 5b22  s or self._fxs["
-00033030: 4e75 6d65 7269 6322 5d0a 2020 2020 2020  Numeric"].      
-00033040: 2020 2020 2020 6361 7465 676f 7269 6361        categorica
-00033050: 6c5f 6665 6174 7572 6573 203d 2063 6174  l_features = cat
-00033060: 6567 6f72 6963 616c 5f66 6561 7475 7265  egorical_feature
-00033070: 7320 6f72 2073 656c 662e 5f66 7873 5b22  s or self._fxs["
-00033080: 4361 7465 676f 7269 6361 6c22 5d0a 2020  Categorical"].  
-00033090: 2020 2020 2020 2020 2020 6461 7465 5f66            date_f
-000330a0: 6561 7475 7265 7320 3d20 6461 7465 5f66  eatures = date_f
-000330b0: 6561 7475 7265 7320 6f72 2073 656c 662e  eatures or self.
-000330c0: 5f66 7873 5b22 4461 7465 225d 0a20 2020  _fxs["Date"].   
-000330d0: 2020 2020 206e 6f6e 655f 7661 7273 203d       none_vars =
-000330e0: 205b 0a20 2020 2020 2020 2020 2020 206b   [.            k
-000330f0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00033100: 206b 2c20 7620 696e 207b 0a20 2020 2020   k, v in {.     
-00033110: 2020 2020 2020 2020 2020 2022 7265 6665             "refe
-00033120: 7265 6e63 655f 6461 7461 223a 2072 6566  rence_data": ref
-00033130: 6572 656e 6365 5f64 6174 612c 0a20 2020  erence_data,.   
-00033140: 2020 2020 2020 2020 2020 2020 2022 6375               "cu
-00033150: 7272 656e 745f 6461 7461 223a 2063 7572  rrent_data": cur
-00033160: 7265 6e74 5f64 6174 612c 0a20 2020 2020  rent_data,.     
-00033170: 2020 2020 2020 2020 2020 2022 7461 7267             "targ
-00033180: 6574 223a 2074 6172 6765 742c 0a20 2020  et": target,.   
-00033190: 2020 2020 2020 2020 207d 2e69 7465 6d73           }.items
-000331a0: 2829 0a20 2020 2020 2020 2020 2020 2069  ().            i
-000331b0: 6620 7620 6973 204e 6f6e 650a 2020 2020  f v is None.    
-000331c0: 2020 2020 5d0a 2020 2020 2020 2020 6966      ].        if
-000331d0: 206e 6f6e 655f 7661 7273 3a0a 2020 2020   none_vars:.    
-000331e0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-000331f0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-00033200: 2020 2020 2020 2020 2020 2254 6865 2066            "The f
-00033210: 6f6c 6c6f 7769 6e67 2076 6172 6961 626c  ollowing variabl
-00033220: 6573 2063 6f75 6c64 6e27 7420 6861 7665  es couldn't have
-00033230: 2062 6565 6e20 696e 6665 7272 6564 2022   been inferred "
-00033240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033250: 2066 2266 726f 6d20 7468 6520 6578 7065   f"from the expe
-00033260: 7269 6d65 6e74 2073 7461 7465 3a20 7b6e  riment state: {n
-00033270: 6f6e 655f 7661 7273 7d2e 220a 2020 2020  one_vars}.".    
-00033280: 2020 2020 2020 2020 2020 2020 2249 6620              "If 
-00033290: 796f 7520 6861 7665 206e 6f74 2072 616e  you have not ran
-000332a0: 2060 7365 7475 7028 2960 2c20 796f 7520   `setup()`, you 
-000332b0: 6d75 7374 2070 6173 7320 616c 6c20 6f66  must pass all of
-000332c0: 2074 6865 2061 7267 756d 656e 7473 220a   the arguments".
-000332d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000332e0: 2261 626f 7665 2e22 0a20 2020 2020 2020  "above.".       
-000332f0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00033300: 6461 7465 5f66 6561 7475 7265 7320 3d20  date_features = 
-00033310: 6461 7465 5f66 6561 7475 7265 7320 6f72  date_features or
-00033320: 205b 5d0a 2020 2020 2020 2020 6361 7465   [].        cate
-00033330: 676f 7269 6361 6c5f 6665 6174 7572 6573  gorical_features
-00033340: 203d 2063 6174 6567 6f72 6963 616c 5f66   = categorical_f
-00033350: 6561 7475 7265 7320 6f72 205b 5d0a 0a20  eatures or [].. 
-00033360: 2020 2020 2020 2069 6620 6e75 6d65 7269         if numeri
-00033370: 635f 6665 6174 7572 6573 2069 7320 4e6f  c_features is No
-00033380: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00033390: 6e75 6d65 7269 635f 6665 6174 7572 6573  numeric_features
-000333a0: 203d 206c 6973 7428 0a20 2020 2020 2020   = list(.       
-000333b0: 2020 2020 2020 2020 2073 6574 2872 6566           set(ref
-000333c0: 6572 656e 6365 5f64 6174 612e 636f 6c75  erence_data.colu
-000333d0: 6d6e 7329 0a20 2020 2020 2020 2020 2020  mns).           
-000333e0: 2020 2020 202e 6469 6666 6572 656e 6365       .difference
-000333f0: 2863 6174 6567 6f72 6963 616c 5f66 6561  (categorical_fea
-00033400: 7475 7265 7329 0a20 2020 2020 2020 2020  tures).         
-00033410: 2020 2020 2020 202e 6469 6666 6572 656e         .differen
-00033420: 6365 2864 6174 655f 6665 6174 7572 6573  ce(date_features
-00033430: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
-00033440: 0a20 2020 2020 2020 2066 726f 6d20 6576  .        from ev
-00033450: 6964 656e 746c 792e 6461 7368 626f 6172  idently.dashboar
-00033460: 6420 696d 706f 7274 2044 6173 6862 6f61  d import Dashboa
-00033470: 7264 0a20 2020 2020 2020 2066 726f 6d20  rd.        from 
-00033480: 6576 6964 656e 746c 792e 7069 7065 6c69  evidently.pipeli
-00033490: 6e65 2e63 6f6c 756d 6e5f 6d61 7070 696e  ne.column_mappin
-000334a0: 6720 696d 706f 7274 2043 6f6c 756d 6e4d  g import ColumnM
-000334b0: 6170 7069 6e67 0a20 2020 2020 2020 2066  apping.        f
-000334c0: 726f 6d20 6576 6964 656e 746c 792e 7461  rom evidently.ta
-000334d0: 6273 2069 6d70 6f72 7420 4361 7454 6172  bs import CatTar
-000334e0: 6765 7444 7269 6674 5461 622c 2044 6174  getDriftTab, Dat
-000334f0: 6144 7269 6674 5461 620a 0a20 2020 2020  aDriftTab..     
-00033500: 2020 2063 6f6c 756d 6e5f 6d61 7070 696e     column_mappin
-00033510: 6720 3d20 436f 6c75 6d6e 4d61 7070 696e  g = ColumnMappin
-00033520: 6728 290a 2020 2020 2020 2020 636f 6c75  g().        colu
-00033530: 6d6e 5f6d 6170 7069 6e67 2e74 6172 6765  mn_mapping.targe
-00033540: 7420 3d20 7461 7267 6574 0a20 2020 2020  t = target.     
-00033550: 2020 2063 6f6c 756d 6e5f 6d61 7070 696e     column_mappin
-00033560: 672e 7072 6564 6963 7469 6f6e 203d 204e  g.prediction = N
-00033570: 6f6e 650a 2020 2020 2020 2020 636f 6c75  one.        colu
-00033580: 6d6e 5f6d 6170 7069 6e67 2e64 6174 6574  mn_mapping.datet
-00033590: 696d 6520 3d20 4e6f 6e65 0a20 2020 2020  ime = None.     
-000335a0: 2020 2063 6f6c 756d 6e5f 6d61 7070 696e     column_mappin
-000335b0: 672e 6e75 6d65 7269 6361 6c5f 6665 6174  g.numerical_feat
-000335c0: 7572 6573 203d 206e 756d 6572 6963 5f66  ures = numeric_f
-000335d0: 6561 7475 7265 730a 2020 2020 2020 2020  eatures.        
-000335e0: 636f 6c75 6d6e 5f6d 6170 7069 6e67 2e63  column_mapping.c
-000335f0: 6174 6567 6f72 6963 616c 5f66 6561 7475  ategorical_featu
-00033600: 7265 7320 3d20 6361 7465 676f 7269 6361  res = categorica
-00033610: 6c5f 6665 6174 7572 6573 0a20 2020 2020  l_features.     
-00033620: 2020 2063 6f6c 756d 6e5f 6d61 7070 696e     column_mappin
-00033630: 672e 6461 7465 7469 6d65 5f66 6561 7475  g.datetime_featu
-00033640: 7265 7320 3d20 6461 7465 5f66 6561 7475  res = date_featu
-00033650: 7265 730a 0a20 2020 2020 2020 2069 6620  res..        if 
-00033660: 7461 7267 6574 206e 6f74 2069 6e20 7265  target not in re
-00033670: 6665 7265 6e63 655f 6461 7461 2e63 6f6c  ference_data.col
-00033680: 756d 6e73 206f 7220 7461 7267 6574 206e  umns or target n
-00033690: 6f74 2069 6e20 6375 7272 656e 745f 6461  ot in current_da
-000336a0: 7461 2e63 6f6c 756d 6e73 3a0a 2020 2020  ta.columns:.    
-000336b0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-000336c0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-000336d0: 2020 2020 2020 2020 2020 6622 426f 7468            f"Both
-000336e0: 2064 6174 6173 6574 206d 7573 7420 636f   dataset must co
-000336f0: 6e74 6169 6e20 6120 6c61 6265 6c20 636f  ntain a label co
-00033700: 6c75 6d6e 207b 7461 7267 6574 7d20 220a  lumn {target} ".
-00033710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033720: 2269 6e20 6f72 6465 7220 746f 2063 7265  "in order to cre
-00033730: 6174 6520 6120 6472 6966 7420 7265 706f  ate a drift repo
-00033740: 7274 2e22 0a20 2020 2020 2020 2020 2020  rt.".           
-00033750: 2029 0a0a 2020 2020 2020 2020 6461 7368   )..        dash
-00033760: 626f 6172 6420 3d20 4461 7368 626f 6172  board = Dashboar
-00033770: 6428 7461 6273 3d5b 4461 7461 4472 6966  d(tabs=[DataDrif
-00033780: 7454 6162 2829 2c20 4361 7454 6172 6765  tTab(), CatTarge
-00033790: 7444 7269 6674 5461 6228 295d 290a 2020  tDriftTab()]).  
-000337a0: 2020 2020 2020 6461 7368 626f 6172 642e        dashboard.
-000337b0: 6361 6c63 756c 6174 6528 7265 6665 7265  calculate(refere
-000337c0: 6e63 655f 6461 7461 2c20 6375 7272 656e  nce_data, curren
-000337d0: 745f 6461 7461 2c20 636f 6c75 6d6e 5f6d  t_data, column_m
-000337e0: 6170 7069 6e67 3d63 6f6c 756d 6e5f 6d61  apping=column_ma
-000337f0: 7070 696e 6729 0a20 2020 2020 2020 2066  pping).        f
-00033800: 696c 656e 616d 6520 3d20 280a 2020 2020  ilename = (.    
-00033810: 2020 2020 2020 2020 6669 6c65 6e61 6d65          filename
-00033820: 206f 7220 6622 7b73 656c 662e 6578 705f   or f"{self.exp_
-00033830: 6e61 6d65 5f6c 6f67 7d5f 7b69 6e74 2874  name_log}_{int(t
-00033840: 696d 652e 7469 6d65 2829 297d 5f44 7269  ime.time())}_Dri
-00033850: 6674 5f52 6570 6f72 742e 6874 6d6c 220a  ft_Report.html".
-00033860: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00033870: 2020 6461 7368 626f 6172 642e 7361 7665    dashboard.save
-00033880: 2866 696c 656e 616d 6529 0a20 2020 2020  (filename).     
-00033890: 2020 2072 6574 7572 6e20 6669 6c65 6e61     return filena
-000338a0: 6d65 0a0a 2020 2020 4063 6c61 7373 6d65  me..    @classme
-000338b0: 7468 6f64 0a20 2020 2064 6566 206c 6f61  thod.    def loa
-000338c0: 645f 6578 7065 7269 6d65 6e74 280a 2020  d_experiment(.  
-000338d0: 2020 2020 2020 636c 732c 0a20 2020 2020        cls,.     
-000338e0: 2020 2070 6174 685f 6f72 5f66 696c 653a     path_or_file:
-000338f0: 2055 6e69 6f6e 5b73 7472 2c20 6f73 2e50   Union[str, os.P
-00033900: 6174 684c 696b 652c 2042 696e 6172 7949  athLike, BinaryI
-00033910: 4f5d 2c0a 2020 2020 2020 2020 6461 7461  O],.        data
-00033920: 3a20 4f70 7469 6f6e 616c 5b44 4154 4146  : Optional[DATAF
-00033930: 5241 4d45 5f4c 494b 455d 203d 204e 6f6e  RAME_LIKE] = Non
-00033940: 652c 0a20 2020 2020 2020 2064 6174 615f  e,.        data_
-00033950: 6675 6e63 3a20 4f70 7469 6f6e 616c 5b43  func: Optional[C
-00033960: 616c 6c61 626c 655b 5b5d 2c20 4441 5441  allable[[], DATA
-00033970: 4652 414d 455f 4c49 4b45 5d5d 203d 204e  FRAME_LIKE]] = N
-00033980: 6f6e 652c 0a20 2020 2020 2020 2074 6573  one,.        tes
-00033990: 745f 6461 7461 3a20 4f70 7469 6f6e 616c  t_data: Optional
-000339a0: 5b44 4154 4146 5241 4d45 5f4c 494b 455d  [DATAFRAME_LIKE]
-000339b0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-000339c0: 2070 7265 7072 6f63 6573 735f 6461 7461   preprocess_data
-000339d0: 3a20 626f 6f6c 203d 2054 7275 652c 0a20  : bool = True,. 
-000339e0: 2020 2020 2020 202a 2a63 6c6f 7564 7069         **cloudpi
-000339f0: 636b 6c65 5f6b 7761 7267 732c 0a20 2020  ckle_kwargs,.   
-00033a00: 2029 202d 3e20 225f 5375 7065 7276 6973   ) -> "_Supervis
-00033a10: 6564 4578 7065 7269 6d65 6e74 223a 0a20  edExperiment":. 
-00033a20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00033a30: 2020 204c 6f61 6420 616e 2065 7870 6572     Load an exper
-00033a40: 696d 656e 7420 7361 7665 6420 7769 7468  iment saved with
-00033a50: 2060 6073 6176 655f 6578 7065 7269 6d65   ``save_experime
-00033a60: 6e74 6060 2066 726f 6d20 7061 7468 0a20  nt`` from path. 
-00033a70: 2020 2020 2020 206f 7220 6669 6c65 2e0a         or file..
-00033a80: 0a20 2020 2020 2020 2054 6865 2064 6174  .        The dat
-00033a90: 6120 2861 6e64 2074 6573 7420 6461 7461  a (and test data
-00033aa0: 2920 6973 204e 4f54 2073 6176 6564 2077  ) is NOT saved w
-00033ab0: 6974 6820 7468 6520 6578 7065 7269 6d65  ith the experime
-00033ac0: 6e74 0a20 2020 2020 2020 2061 6e64 2077  nt.        and w
-00033ad0: 696c 6c20 6e65 6564 2074 6f20 6265 2073  ill need to be s
-00033ae0: 7065 6369 6669 6564 2061 6761 696e 2e0a  pecified again..
-00033af0: 0a0a 2020 2020 2020 2020 7061 7468 5f6f  ..        path_o
-00033b00: 725f 6669 6c65 3a20 7374 7220 6f72 2042  r_file: str or B
-00033b10: 696e 6172 7949 4f20 2866 696c 6520 706f  inaryIO (file po
-00033b20: 696e 7465 7229 0a20 2020 2020 2020 2020  inter).         
-00033b30: 2020 2054 6865 2070 6174 682f 6669 6c65     The path/file
-00033b40: 2070 6f69 6e74 6572 2074 6f20 6c6f 6164   pointer to load
-00033b50: 2074 6865 2065 7870 6572 696d 656e 7420   the experiment 
-00033b60: 6672 6f6d 2e0a 2020 2020 2020 2020 2020  from..          
-00033b70: 2020 5468 6520 7069 636b 6c65 2066 696c    The pickle fil
-00033b80: 6520 6d75 7374 2062 6520 6372 6561 7465  e must be create
-00033b90: 6420 7468 726f 7567 6820 6060 7361 7665  d through ``save
-00033ba0: 5f65 7870 6572 696d 656e 7460 602e 0a0a  _experiment``...
-00033bb0: 0a20 2020 2020 2020 2064 6174 613a 2064  .        data: d
-00033bc0: 6174 6166 7261 6d65 2d6c 696b 650a 2020  ataframe-like.  
-00033bd0: 2020 2020 2020 2020 2020 4461 7461 2073            Data s
-00033be0: 6574 2077 6974 6820 7368 6170 6520 286e  et with shape (n
-00033bf0: 5f73 616d 706c 6573 2c20 6e5f 6665 6174  _samples, n_feat
-00033c00: 7572 6573 292c 2077 6865 7265 206e 5f73  ures), where n_s
-00033c10: 616d 706c 6573 2069 7320 7468 650a 2020  amples is the.  
-00033c20: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
-00033c30: 206f 6620 7361 6d70 6c65 7320 616e 6420   of samples and 
-00033c40: 6e5f 6665 6174 7572 6573 2069 7320 7468  n_features is th
-00033c50: 6520 6e75 6d62 6572 206f 6620 6665 6174  e number of feat
-00033c60: 7572 6573 2e20 4966 2064 6174 610a 2020  ures. If data.  
-00033c70: 2020 2020 2020 2020 2020 6973 206e 6f74            is not
-00033c80: 2061 2070 616e 6461 7320 6461 7461 6672   a pandas datafr
-00033c90: 616d 652c 2069 7427 7320 636f 6e76 6572  ame, it's conver
-00033ca0: 7465 6420 746f 206f 6e65 2075 7369 6e67  ted to one using
-00033cb0: 2064 6566 6175 6c74 2063 6f6c 756d 6e0a   default column.
-00033cc0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00033cd0: 732e 0a0a 0a20 2020 2020 2020 2064 6174  s....        dat
-00033ce0: 615f 6675 6e63 3a20 4361 6c6c 6162 6c65  a_func: Callable
-00033cf0: 5b5b 5d2c 2044 4154 4146 5241 4d45 5f4c  [[], DATAFRAME_L
-00033d00: 494b 455d 203d 204e 6f6e 650a 2020 2020  IKE] = None.    
-00033d10: 2020 2020 2020 2020 5468 6520 6675 6e63          The func
-00033d20: 7469 6f6e 2074 6861 7420 6765 6e65 7261  tion that genera
-00033d30: 7465 2060 6064 6174 6160 6020 2874 6865  te ``data`` (the
-00033d40: 2064 6174 6166 7261 6d65 2d6c 696b 6520   dataframe-like 
-00033d50: 696e 7075 7429 2e20 5468 6973 0a20 2020  input). This.   
-00033d60: 2020 2020 2020 2020 2069 7320 7573 6566           is usef
-00033d70: 756c 2077 6865 6e20 7468 6520 6461 7461  ul when the data
-00033d80: 7365 7420 6973 206c 6172 6765 2c20 616e  set is large, an
-00033d90: 6420 796f 7520 6e65 6564 2070 6172 616c  d you need paral
-00033da0: 6c65 6c20 6f70 6572 6174 696f 6e73 0a20  lel operations. 
-00033db0: 2020 2020 2020 2020 2020 2073 7563 6820             such 
-00033dc0: 6173 2060 6063 6f6d 7061 7265 5f6d 6f64  as ``compare_mod
-00033dd0: 656c 7360 602e 2049 7420 6361 6e20 6176  els``. It can av
-00033de0: 6f69 6420 6272 6f61 6463 6173 7469 6e67  oid broadcasting
-00033df0: 206c 6172 6765 2064 6174 6173 6574 0a20   large dataset. 
-00033e00: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
-00033e10: 6472 6976 6572 2074 6f20 776f 726b 6572  driver to worker
-00033e20: 732e 204e 6f74 6963 6520 6f6e 6520 616e  s. Notice one an
-00033e30: 6420 6f6e 6c79 206f 6e65 206f 6620 6060  d only one of ``
-00033e40: 6461 7461 6060 2061 6e64 0a20 2020 2020  data`` and.     
-00033e50: 2020 2020 2020 2060 6064 6174 615f 6675         ``data_fu
-00033e60: 6e63 6060 206d 7573 7420 6265 2073 6574  nc`` must be set
-00033e70: 2e0a 0a0a 2020 2020 2020 2020 7465 7374  ....        test
-00033e80: 5f64 6174 613a 2064 6174 6166 7261 6d65  _data: dataframe
-00033e90: 2d6c 696b 6520 6f72 204e 6f6e 652c 2064  -like or None, d
-00033ea0: 6566 6175 6c74 203d 204e 6f6e 650a 2020  efault = None.  
-00033eb0: 2020 2020 2020 2020 2020 4966 206e 6f74            If not
-00033ec0: 204e 6f6e 652c 2074 6573 745f 6461 7461   None, test_data
-00033ed0: 2069 7320 7573 6564 2061 7320 6120 686f   is used as a ho
-00033ee0: 6c64 2d6f 7574 2073 6574 2061 6e64 2060  ld-out set and `
-00033ef0: 7472 6169 6e5f 7369 7a65 6020 7061 7261  train_size` para
-00033f00: 6d65 7465 720a 2020 2020 2020 2020 2020  meter.          
-00033f10: 2020 6973 2069 676e 6f72 6564 2e20 5468    is ignored. Th
-00033f20: 6520 636f 6c75 6d6e 7320 6f66 2064 6174  e columns of dat
-00033f30: 6120 616e 6420 7465 7374 5f64 6174 6120  a and test_data 
-00033f40: 6d75 7374 206d 6174 6368 2e0a 0a0a 2020  must match....  
-00033f50: 2020 2020 2020 7072 6570 726f 6365 7373        preprocess
-00033f60: 5f64 6174 613a 2062 6f6f 6c2c 2064 6566  _data: bool, def
-00033f70: 6175 6c74 203d 2054 7275 650a 2020 2020  ault = True.    
-00033f80: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
-00033f90: 2074 6865 2064 6174 6120 7769 6c6c 2062   the data will b
-00033fa0: 6520 7072 6570 726f 6365 7373 6564 2061  e preprocessed a
-00033fb0: 6761 696e 2028 7468 726f 7567 6820 7275  gain (through ru
-00033fc0: 6e6e 696e 6720 6060 7365 7475 7060 600a  nning ``setup``.
-00033fd0: 2020 2020 2020 2020 2020 2020 696e 7465              inte
-00033fe0: 726e 616c 6c79 292e 2049 6620 4661 6c73  rnally). If Fals
-00033ff0: 652c 2074 6865 2064 6174 6120 7769 6c6c  e, the data will
-00034000: 206e 6f74 2062 6520 7072 6570 726f 6365   not be preproce
-00034010: 7373 6564 2e20 5468 6973 206d 6561 6e73  ssed. This means
-00034020: 0a20 2020 2020 2020 2020 2020 2079 6f75  .            you
-00034030: 2063 616e 2073 6176 6520 7468 6520 7661   can save the va
-00034040: 6c75 6520 6f66 2074 6865 2060 6064 6174  lue of the ``dat
-00034050: 6160 6020 6174 7472 6962 7574 6520 6f66  a`` attribute of
-00034060: 2061 6e20 6578 7065 7269 6d65 6e74 0a20   an experiment. 
-00034070: 2020 2020 2020 2020 2020 2073 6570 6172             separ
-00034080: 6174 656c 792c 2061 6e64 2074 6865 6e20  ately, and then 
-00034090: 6c6f 6164 2069 7420 7365 7061 7261 7465  load it separate
-000340a0: 6c79 2061 6e64 2070 6173 7320 6974 2068  ly and pass it h
-000340b0: 6572 6520 7769 7468 0a20 2020 2020 2020  ere with.       
-000340c0: 2020 2020 2060 6070 7265 7072 6f63 6573       ``preproces
-000340d0: 735f 6461 7461 6060 2073 6574 2074 6f20  s_data`` set to 
-000340e0: 4661 6c73 652e 2054 6869 7320 6973 2061  False. This is a
-000340f0: 6e20 6164 7661 6e63 6564 2066 6561 7475  n advanced featu
-00034100: 7265 2e0a 2020 2020 2020 2020 2020 2020  re..            
-00034110: 5765 2072 6563 6f6d 6d65 6e64 206c 6561  We recommend lea
-00034120: 7669 6e67 2069 7420 7365 7420 746f 2054  ving it set to T
-00034130: 7275 6520 616e 6420 7061 7373 696e 6720  rue and passing 
-00034140: 7468 6520 7361 6d65 2064 6174 610a 2020  the same data.  
-00034150: 2020 2020 2020 2020 2020 6173 2070 6173            as pas
-00034160: 7365 6420 746f 2074 6865 2069 6e69 7469  sed to the initi
-00034170: 616c 2060 6073 6574 7570 6060 2063 616c  al ``setup`` cal
-00034180: 6c2e 0a0a 0a20 2020 2020 2020 202a 2a63  l....        **c
-00034190: 6c6f 7564 7069 636b 6c65 5f6b 7761 7267  loudpickle_kwarg
-000341a0: 733a 0a20 2020 2020 2020 2020 2020 204b  s:.            K
-000341b0: 7761 7267 7320 746f 2070 6173 7320 746f  wargs to pass to
-000341c0: 2074 6865 2060 6063 6c6f 7564 7069 636b   the ``cloudpick
-000341d0: 6c65 2e6c 6f61 6460 6020 6361 6c6c 2e0a  le.load`` call..
-000341e0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-000341f0: 733a 0a20 2020 2020 2020 2020 2020 206c  s:.            l
-00034200: 6f61 6465 6420 6578 7065 7269 6d65 6e74  oaded experiment
-00034210: 0a0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-00034220: 2020 2020 2020 2072 6574 7572 6e20 636c         return cl
-00034230: 732e 5f6c 6f61 645f 6578 7065 7269 6d65  s._load_experime
-00034240: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
-00034250: 7061 7468 5f6f 725f 6669 6c65 2c0a 2020  path_or_file,.  
-00034260: 2020 2020 2020 2020 2020 636c 6f75 6470            cloudp
-00034270: 6963 6b6c 655f 6b77 6172 6773 3d63 6c6f  ickle_kwargs=clo
-00034280: 7564 7069 636b 6c65 5f6b 7761 7267 732c  udpickle_kwargs,
-00034290: 0a20 2020 2020 2020 2020 2020 2070 7265  .            pre
-000342a0: 7072 6f63 6573 735f 6461 7461 3d70 7265  process_data=pre
-000342b0: 7072 6f63 6573 735f 6461 7461 2c0a 2020  process_data,.  
-000342c0: 2020 2020 2020 2020 2020 6461 7461 3d64            data=d
-000342d0: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
-000342e0: 2064 6174 615f 6675 6e63 3d64 6174 615f   data_func=data_
-000342f0: 6675 6e63 2c0a 2020 2020 2020 2020 2020  func,.          
-00034300: 2020 7465 7374 5f64 6174 613d 7465 7374    test_data=test
-00034310: 5f64 6174 612c 0a20 2020 2020 2020 2029  _data,.        )
-00034320: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00034330: 2020 2020 4061 6273 7472 6163 746d 6574      @abstractmet
-00034340: 686f 640a 2020 2020 6465 6620 5828 7365  hod.    def X(se
-00034350: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00034360: 4665 6174 7572 6520 7365 742e 2222 220a  Feature set.""".
-00034370: 2020 2020 2020 2020 7061 7373 0a0a 2020          pass..  
-00034380: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00034390: 4061 6273 7472 6163 746d 6574 686f 640a  @abstractmethod.
-000343a0: 2020 2020 6465 6620 6461 7461 7365 745f      def dataset_
-000343b0: 7472 616e 7366 6f72 6d65 6428 7365 6c66  transformed(self
-000343c0: 293a 0a20 2020 2020 2020 2022 2222 5472  ):.        """Tr
-000343d0: 616e 7366 6f72 6d65 6420 6461 7461 7365  ansformed datase
-000343e0: 742e 2222 220a 2020 2020 2020 2020 7061  t.""".        pa
-000343f0: 7373 0a0a 2020 2020 4070 726f 7065 7274  ss..    @propert
-00034400: 790a 2020 2020 4061 6273 7472 6163 746d  y.    @abstractm
-00034410: 6574 686f 640a 2020 2020 6465 6620 585f  ethod.    def X_
-00034420: 7472 6169 6e5f 7472 616e 7366 6f72 6d65  train_transforme
-00034430: 6428 7365 6c66 293a 0a20 2020 2020 2020  d(self):.       
-00034440: 2022 2222 5472 616e 7366 6f72 6d65 6420   """Transformed 
-00034450: 6665 6174 7572 6520 7365 7420 6f66 2074  feature set of t
-00034460: 6865 2074 7261 696e 696e 6720 7365 742e  he training set.
-00034470: 2222 220a 2020 2020 2020 2020 7061 7373  """.        pass
-00034480: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00034490: 2020 2020 4061 6273 7472 6163 746d 6574      @abstractmet
-000344a0: 686f 640a 2020 2020 6465 6620 7472 6169  hod.    def trai
-000344b0: 6e5f 7472 616e 7366 6f72 6d65 6428 7365  n_transformed(se
-000344c0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-000344d0: 5472 616e 7366 6f72 6d65 6420 7472 6169  Transformed trai
-000344e0: 6e69 6e67 2073 6574 2e22 2222 0a20 2020  ning set.""".   
-000344f0: 2020 2020 2070 6173 730a 0a20 2020 2040       pass..    @
-00034500: 7072 6f70 6572 7479 0a20 2020 2040 6162  property.    @ab
-00034510: 7374 7261 6374 6d65 7468 6f64 0a20 2020  stractmethod.   
-00034520: 2064 6566 2058 5f74 7261 6e73 666f 726d   def X_transform
-00034530: 6564 2873 656c 6629 3a0a 2020 2020 2020  ed(self):.      
-00034540: 2020 2222 2254 7261 6e73 666f 726d 6564    """Transformed
-00034550: 2066 6561 7475 7265 2073 6574 2e22 2222   feature set."""
-00034560: 0a20 2020 2020 2020 2070 6173 730a 0a20  .        pass.. 
-00034570: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00034580: 2064 6566 2079 2873 656c 6629 3a0a 2020   def y(self):.  
-00034590: 2020 2020 2020 2222 2254 6172 6765 7420        """Target 
-000345a0: 636f 6c75 6d6e 2e22 2222 0a20 2020 2020  column.""".     
-000345b0: 2020 2072 6574 7572 6e20 7365 6c66 2e64     return self.d
-000345c0: 6174 6173 6574 5b73 656c 662e 7461 7267  ataset[self.targ
-000345d0: 6574 5f70 6172 616d 5d0a 0a20 2020 2040  et_param]..    @
-000345e0: 7072 6f70 6572 7479 0a20 2020 2040 6162  property.    @ab
-000345f0: 7374 7261 6374 6d65 7468 6f64 0a20 2020  stractmethod.   
-00034600: 2064 6566 2058 5f74 7261 696e 2873 656c   def X_train(sel
-00034610: 6629 3a0a 2020 2020 2020 2020 2222 2246  f):.        """F
-00034620: 6561 7475 7265 2073 6574 206f 6620 7468  eature set of th
-00034630: 6520 7472 6169 6e69 6e67 2073 6574 2e22  e training set."
-00034640: 2222 0a20 2020 2020 2020 2070 6173 730a  "".        pass.
-00034650: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00034660: 2020 2040 6162 7374 7261 6374 6d65 7468     @abstractmeth
-00034670: 6f64 0a20 2020 2064 6566 2058 5f74 6573  od.    def X_tes
-00034680: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
-00034690: 2022 2222 4665 6174 7572 6520 7365 7420   """Feature set 
-000346a0: 6f66 2074 6865 2074 6573 7420 7365 742e  of the test set.
-000346b0: 2222 220a 2020 2020 2020 2020 7061 7373  """.        pass
-000346c0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-000346d0: 2020 2020 6465 6620 7472 6169 6e28 7365      def train(se
-000346e0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-000346f0: 5472 6169 6e69 6e67 2073 6574 2e22 2222  Training set."""
-00034700: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00034710: 7365 6c66 2e64 6174 6173 6574 2e6c 6f63  self.dataset.loc
-00034720: 5b73 656c 662e 6964 785b 305d 2c20 3a5d  [self.idx[0], :]
-00034730: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00034740: 2020 2020 4061 6273 7472 6163 746d 6574      @abstractmet
-00034750: 686f 640a 2020 2020 6465 6620 7465 7374  hod.    def test
-00034760: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00034770: 2222 2254 6573 7420 7365 742e 2222 220a  """Test set.""".
-00034780: 2020 2020 2020 2020 7061 7373 0a0a 2020          pass..  
-00034790: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-000347a0: 6465 6620 795f 7472 6169 6e28 7365 6c66  def y_train(self
-000347b0: 293a 0a20 2020 2020 2020 2022 2222 5461  ):.        """Ta
-000347c0: 7267 6574 2063 6f6c 756d 6e20 6f66 2074  rget column of t
-000347d0: 6865 2074 7261 696e 696e 6720 7365 742e  he training set.
-000347e0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-000347f0: 726e 2073 656c 662e 7472 6169 6e5b 7365  rn self.train[se
-00034800: 6c66 2e74 6172 6765 745f 7061 7261 6d5d  lf.target_param]
-00034810: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00034820: 2020 2020 6465 6620 795f 7465 7374 2873      def y_test(s
-00034830: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00034840: 2254 6172 6765 7420 636f 6c75 6d6e 206f  "Target column o
-00034850: 6620 7468 6520 7465 7374 2073 6574 2e22  f the test set."
-00034860: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00034870: 6e20 7365 6c66 2e74 6573 745b 7365 6c66  n self.test[self
-00034880: 2e74 6172 6765 745f 7061 7261 6d5d 0a0a  .target_param]..
-00034890: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-000348a0: 2020 4061 6273 7472 6163 746d 6574 686f    @abstractmetho
-000348b0: 640a 2020 2020 6465 6620 7465 7374 5f74  d.    def test_t
-000348c0: 7261 6e73 666f 726d 6564 2873 656c 6629  ransformed(self)
-000348d0: 3a0a 2020 2020 2020 2020 2222 2254 7261  :.        """Tra
-000348e0: 6e73 666f 726d 6564 2074 6573 7420 7365  nsformed test se
-000348f0: 742e 2222 220a 2020 2020 2020 2020 7061  t.""".        pa
-00034900: 7373 0a0a 2020 2020 4070 726f 7065 7274  ss..    @propert
-00034910: 790a 2020 2020 4061 6273 7472 6163 746d  y.    @abstractm
-00034920: 6574 686f 640a 2020 2020 6465 6620 795f  ethod.    def y_
-00034930: 7472 616e 7366 6f72 6d65 6428 7365 6c66  transformed(self
-00034940: 293a 0a20 2020 2020 2020 2022 2222 5472  ):.        """Tr
-00034950: 616e 7366 6f72 6d65 6420 7461 7267 6574  ansformed target
-00034960: 2063 6f6c 756d 6e2e 2222 220a 2020 2020   column.""".    
-00034970: 2020 2020 7061 7373 0a0a 2020 2020 4070      pass..    @p
-00034980: 726f 7065 7274 790a 2020 2020 4061 6273  roperty.    @abs
-00034990: 7472 6163 746d 6574 686f 640a 2020 2020  tractmethod.    
-000349a0: 6465 6620 585f 7465 7374 5f74 7261 6e73  def X_test_trans
-000349b0: 666f 726d 6564 2873 656c 6629 3a0a 2020  formed(self):.  
-000349c0: 2020 2020 2020 2222 2254 7261 6e73 666f        """Transfo
-000349d0: 726d 6564 2066 6561 7475 7265 2073 6574  rmed feature set
-000349e0: 206f 6620 7468 6520 7465 7374 2073 6574   of the test set
-000349f0: 2e22 2222 0a20 2020 2020 2020 2070 6173  .""".        pas
-00034a00: 730a 0a20 2020 2040 7072 6f70 6572 7479  s..    @property
-00034a10: 0a20 2020 2040 6162 7374 7261 6374 6d65  .    @abstractme
-00034a20: 7468 6f64 0a20 2020 2064 6566 2079 5f74  thod.    def y_t
-00034a30: 7261 696e 5f74 7261 6e73 666f 726d 6564  rain_transformed
-00034a40: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00034a50: 2222 2254 7261 6e73 666f 726d 6564 2074  """Transformed t
-00034a60: 6172 6765 7420 636f 6c75 6d6e 206f 6620  arget column of 
-00034a70: 7468 6520 7472 6169 6e69 6e67 2073 6574  the training set
-00034a80: 2e22 2222 0a20 2020 2020 2020 2070 6173  .""".        pas
-00034a90: 730a 0a20 2020 2040 7072 6f70 6572 7479  s..    @property
-00034aa0: 0a20 2020 2040 6162 7374 7261 6374 6d65  .    @abstractme
-00034ab0: 7468 6f64 0a20 2020 2064 6566 2079 5f74  thod.    def y_t
-00034ac0: 6573 745f 7472 616e 7366 6f72 6d65 6428  est_transformed(
-00034ad0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00034ae0: 2222 5472 616e 7366 6f72 6d65 6420 7461  ""Transformed ta
-00034af0: 7267 6574 2063 6f6c 756d 6e20 6f66 2074  rget column of t
-00034b00: 6865 2074 6573 7420 7365 742e 2222 220a  he test set.""".
-00034b10: 2020 2020 2020 2020 7061 7373 0a                 pass.
+00030d90: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
+00030da0: 7761 726e 696e 6728 0a20 2020 2020 2020  warning(.       
+00030db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030dc0: 2066 224d 6f64 656c 207b 6d6f 6465 6c7d   f"Model {model}
+00030dd0: 2069 7320 6e6f 7420 6669 7474 6564 2c20   is not fitted, 
+00030de0: 7275 6e6e 696e 6720 6372 6561 7465 5f6d  running create_m
+00030df0: 6f64 656c 220a 2020 2020 2020 2020 2020  odel".          
+00030e00: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00030e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030e20: 6d6f 6465 6c2c 205f 203d 2073 656c 662e  model, _ = self.
+00030e30: 5f63 7265 6174 655f 6d6f 6465 6c28 2020  _create_model(  
+00030e40: 2320 7479 7065 3a20 6967 6e6f 7265 0a20  # type: ignore. 
+00030e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030e60: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
+00030e70: 3d6d 6f64 656c 2c0a 2020 2020 2020 2020  =model,.        
+00030e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030e90: 7379 7374 656d 3d46 616c 7365 2c0a 2020  system=False,.  
+00030ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030eb0: 2020 2020 2020 7665 7262 6f73 653d 4661        verbose=Fa
+00030ec0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00030ed0: 2020 2020 2020 2020 2020 2020 2063 726f               cro
+00030ee0: 7373 5f76 616c 6964 6174 696f 6e3d 4661  ss_validation=Fa
+00030ef0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00030f00: 2020 2020 2020 2020 2020 2020 2070 7265               pre
+00030f10: 6469 6374 3d46 616c 7365 2c0a 2020 2020  dict=False,.    
+00030f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030f30: 2020 2020 6772 6f75 7073 3d73 656c 662e      groups=self.
+00030f40: 666f 6c64 5f67 726f 7570 735f 7061 7261  fold_groups_para
+00030f50: 6d2c 0a20 2020 2020 2020 2020 2020 2020  m,.             
+00030f60: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00030f70: 6e5f 7472 6169 6e5f 7363 6f72 653d 7265  n_train_score=re
+00030f80: 7475 726e 5f74 7261 696e 5f73 636f 7265  turn_train_score
+00030f90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00030fa0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00030fb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00030fc0: 2e70 7265 6469 6374 5f6d 6f64 656c 286d  .predict_model(m
+00030fd0: 6f64 656c 2c20 7665 7262 6f73 653d 4661  odel, verbose=Fa
+00030fe0: 6c73 6529 2020 2320 7479 7065 3a20 6967  lse)  # type: ig
+00030ff0: 6e6f 7265 0a0a 2020 2020 2020 2020 2020  nore..          
+00031000: 2020 2020 2020 7020 3d20 7365 6c66 2e70        p = self.p
+00031010: 756c 6c28 706f 703d 5472 7565 290a 2020  ull(pop=True).  
+00031020: 2020 2020 2020 2020 2020 2020 2020 7020                p 
+00031030: 3d20 705b 636f 6d70 6172 655f 6469 6d65  = p[compare_dime
+00031040: 6e73 696f 6e5d 5b30 5d0a 2020 2020 2020  nsion][0].      
+00031050: 2020 2020 2020 2020 2020 6966 2063 6f6d            if com
+00031060: 7061 7265 5f73 636f 7265 2870 2c20 6265  pare_score(p, be
+00031070: 7374 5f73 636f 7265 293a 0a20 2020 2020  st_score):.     
+00031080: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00031090: 6573 745f 6d6f 6465 6c20 3d20 6d6f 6465  est_model = mode
+000310a0: 6c0a 2020 2020 2020 2020 2020 2020 2020  l.              
+000310b0: 2020 2020 2020 6265 7374 5f73 636f 7265        best_score
+000310c0: 203d 2070 0a0a 2020 2020 2020 2020 656c   = p..        el
+000310d0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+000310e0: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
+000310f0: 2822 4d6f 6465 6c20 5365 6c65 6374 696f  ("Model Selectio
+00031100: 6e20 4261 7369 7320 3a20 4356 2052 6573  n Basis : CV Res
+00031110: 756c 7473 206f 6e20 5472 6169 6e69 6e67  ults on Training
+00031120: 2073 6574 2229 0a20 2020 2020 2020 2020   set").         
+00031130: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+00031140: 6528 6c65 6e28 7365 6c66 2e5f 6d61 7374  e(len(self._mast
+00031150: 6572 5f6d 6f64 656c 5f63 6f6e 7461 696e  er_model_contain
+00031160: 6572 2929 3a0a 2020 2020 2020 2020 2020  er)):.          
+00031170: 2020 2020 2020 6d6f 6465 6c20 3d20 7365        model = se
+00031180: 6c66 2e5f 6d61 7374 6572 5f6d 6f64 656c  lf._master_model
+00031190: 5f63 6f6e 7461 696e 6572 5b69 5d0a 2020  _container[i].  
+000311a0: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+000311b0: 6f72 6573 203d 204e 6f6e 650a 2020 2020  ores = None.    
+000311c0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+000311d0: 6f64 656c 5b22 6376 225d 2069 7320 6e6f  odel["cv"] is no
+000311e0: 7420 7365 6c66 2e66 6f6c 645f 6765 6e65  t self.fold_gene
+000311f0: 7261 746f 723a 0a20 2020 2020 2020 2020  rator:.         
+00031200: 2020 2020 2020 2020 2020 2069 6620 7475             if tu
+00031210: 7262 6f20 6f72 2073 656c 662e 5f69 735f  rbo or self._is_
+00031220: 756e 7375 7065 7276 6973 6564 2829 3a0a  unsupervised():.
+00031230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031240: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
+00031250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031260: 2020 2020 2073 656c 662e 5f63 7265 6174       self._creat
+00031270: 655f 6d6f 6465 6c28 2020 2320 7479 7065  e_model(  # type
+00031280: 3a20 6967 6e6f 7265 0a20 2020 2020 2020  : ignore.       
+00031290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000312a0: 2065 7374 696d 6174 6f72 3d6d 6f64 656c   estimator=model
+000312b0: 5b22 6d6f 6465 6c22 5d2c 0a20 2020 2020  ["model"],.     
+000312c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000312d0: 2020 2073 7973 7465 6d3d 4661 6c73 652c     system=False,
+000312e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000312f0: 2020 2020 2020 2020 2076 6572 626f 7365           verbose
+00031300: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00031310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031320: 6372 6f73 735f 7661 6c69 6461 7469 6f6e  cross_validation
+00031330: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
+00031340: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00031350: 7265 6469 6374 3d46 616c 7365 2c0a 2020  redict=False,.  
+00031360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031370: 2020 2020 2020 6772 6f75 7073 3d73 656c        groups=sel
+00031380: 662e 666f 6c64 5f67 726f 7570 735f 7061  f.fold_groups_pa
+00031390: 7261 6d2c 0a20 2020 2020 2020 2020 2020  ram,.           
+000313a0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+000313b0: 7572 6e5f 7472 6169 6e5f 7363 6f72 653d  urn_train_score=
+000313c0: 7265 7475 726e 5f74 7261 696e 5f73 636f  return_train_sco
+000313d0: 7265 2c0a 2020 2020 2020 2020 2020 2020  re,.            
+000313e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000313f0: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+00031400: 6f72 6573 203d 2073 656c 662e 7075 6c6c  ores = self.pull
+00031410: 2870 6f70 3d54 7275 6529 0a20 2020 2020  (pop=True).     
+00031420: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00031430: 656c 662e 5f6d 6173 7465 725f 6d6f 6465  elf._master_mode
+00031440: 6c5f 636f 6e74 6169 6e65 722e 706f 7028  l_container.pop(
+00031450: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00031460: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
+00031470: 666f 2866 2243 6865 636b 696e 6720 6d6f  fo(f"Checking mo
+00031480: 6465 6c20 7b69 7d22 290a 2020 2020 2020  del {i}").      
+00031490: 2020 2020 2020 2020 2020 6966 2073 636f            if sco
+000314a0: 7265 7320 6973 204e 6f6e 653a 0a20 2020  res is None:.   
+000314b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000314c0: 2073 636f 7265 7320 3d20 6d6f 6465 6c5b   scores = model[
+000314d0: 2273 636f 7265 7322 5d0a 2020 2020 2020  "scores"].      
+000314e0: 2020 2020 2020 2020 2020 7220 3d20 7363            r = sc
+000314f0: 6f72 6573 5b63 6f6d 7061 7265 5f64 696d  ores[compare_dim
+00031500: 656e 7369 6f6e 5d5b 2d32 3a5d 5b30 5d0a  ension][-2:][0].
+00031510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031520: 6966 2063 6f6d 7061 7265 5f73 636f 7265  if compare_score
+00031530: 2872 2c20 6265 7374 5f73 636f 7265 293a  (r, best_score):
+00031540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031550: 2020 2020 2062 6573 745f 6d6f 6465 6c20       best_model 
+00031560: 3d20 6d6f 6465 6c5b 226d 6f64 656c 225d  = model["model"]
+00031570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031580: 2020 2020 2062 6573 745f 7363 6f72 6520       best_score 
+00031590: 3d20 720a 0a20 2020 2020 2020 2061 7574  = r..        aut
+000315a0: 6f6d 6c5f 6d6f 6465 6c2c 205f 203d 2073  oml_model, _ = s
+000315b0: 656c 662e 5f63 7265 6174 655f 6d6f 6465  elf._create_mode
+000315c0: 6c28 2020 2320 7479 7065 3a20 6967 6e6f  l(  # type: igno
+000315d0: 7265 0a20 2020 2020 2020 2020 2020 2065  re.            e
+000315e0: 7374 696d 6174 6f72 3d62 6573 745f 6d6f  stimator=best_mo
+000315f0: 6465 6c2c 0a20 2020 2020 2020 2020 2020  del,.           
+00031600: 2073 7973 7465 6d3d 4661 6c73 652c 0a20   system=False,. 
+00031610: 2020 2020 2020 2020 2020 2076 6572 626f             verbo
+00031620: 7365 3d46 616c 7365 2c0a 2020 2020 2020  se=False,.      
+00031630: 2020 2020 2020 6372 6f73 735f 7661 6c69        cross_vali
+00031640: 6461 7469 6f6e 3d46 616c 7365 2c0a 2020  dation=False,.  
+00031650: 2020 2020 2020 2020 2020 7072 6564 6963            predic
+00031660: 743d 4661 6c73 652c 0a20 2020 2020 2020  t=False,.       
+00031670: 2020 2020 2067 726f 7570 733d 7365 6c66       groups=self
+00031680: 2e66 6f6c 645f 6772 6f75 7073 5f70 6172  .fold_groups_par
+00031690: 616d 2c0a 2020 2020 2020 2020 2020 2020  am,.            
+000316a0: 7265 7475 726e 5f74 7261 696e 5f73 636f  return_train_sco
+000316b0: 7265 3d72 6574 7572 6e5f 7472 6169 6e5f  re=return_train_
+000316c0: 7363 6f72 652c 0a20 2020 2020 2020 2029  score,.        )
+000316d0: 0a0a 2020 2020 2020 2020 6763 2e63 6f6c  ..        gc.col
+000316e0: 6c65 6374 2829 0a0a 2020 2020 2020 2020  lect()..        
+000316f0: 7365 6c66 2e6c 6f67 6765 722e 696e 666f  self.logger.info
+00031700: 2873 7472 2861 7574 6f6d 6c5f 6d6f 6465  (str(automl_mode
+00031710: 6c29 290a 2020 2020 2020 2020 7365 6c66  l)).        self
+00031720: 2e6c 6f67 6765 722e 696e 666f 280a 2020  .logger.info(.  
+00031730: 2020 2020 2020 2020 2020 2261 7574 6f6d            "autom
+00031740: 6c28 2920 7375 6363 6573 7366 756c 6c79  l() successfully
+00031750: 2063 6f6d 706c 6574 6564 2e2e 2e2e 2e2e   completed......
+00031760: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00031770: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00031780: 220a 2020 2020 2020 2020 290a 0a20 2020  ".        )..   
+00031790: 2020 2020 2072 6574 7572 6e20 6175 746f       return auto
+000317a0: 6d6c 5f6d 6f64 656c 0a0a 2020 2020 6465  ml_model..    de
+000317b0: 6620 6372 6561 7465 5f61 7070 2873 656c  f create_app(sel
+000317c0: 662c 2065 7374 696d 6174 6f72 2c20 6170  f, estimator, ap
+000317d0: 705f 6b77 6172 6773 3a20 4f70 7469 6f6e  p_kwargs: Option
+000317e0: 616c 5b64 6963 745d 293a 0a20 2020 2020  al[dict]):.     
+000317f0: 2020 2022 2222 0a20 2020 2020 2020 2054     """.        T
+00031800: 6869 7320 6675 6e63 7469 6f6e 2063 7265  his function cre
+00031810: 6174 6573 2061 2062 6173 6963 2067 7261  ates a basic gra
+00031820: 6469 6f20 6170 7020 666f 7220 696e 6665  dio app for infe
+00031830: 7265 6e63 652e 0a20 2020 2020 2020 2049  rence..        I
+00031840: 7420 7769 6c6c 206c 6174 6572 2062 6520  t will later be 
+00031850: 6578 7061 6e64 6564 2066 6f72 206f 7468  expanded for oth
+00031860: 6572 2061 7070 2074 7970 6573 2073 7563  er app types suc
+00031870: 6820 6173 0a20 2020 2020 2020 2053 7472  h as.        Str
+00031880: 6561 6d6c 6974 2e0a 0a0a 2020 2020 2020  eamlit....      
+00031890: 2020 4578 616d 706c 650a 2020 2020 2020    Example.      
+000318a0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+000318b0: 2020 3e3e 3e20 6672 6f6d 2070 7963 6172    >>> from pycar
+000318c0: 6574 2e64 6174 6173 6574 7320 696d 706f  et.datasets impo
+000318d0: 7274 2067 6574 5f64 6174 610a 2020 2020  rt get_data.    
+000318e0: 2020 2020 3e3e 3e20 6a75 6963 6520 3d20      >>> juice = 
+000318f0: 6765 745f 6461 7461 2827 6a75 6963 6527  get_data('juice'
+00031900: 290a 2020 2020 2020 2020 3e3e 3e20 6672  ).        >>> fr
+00031910: 6f6d 2070 7963 6172 6574 2e63 6c61 7373  om pycaret.class
+00031920: 6966 6963 6174 696f 6e20 696d 706f 7274  ification import
+00031930: 202a 0a20 2020 2020 2020 203e 3e3e 2065   *.        >>> e
+00031940: 7870 5f6e 616d 6520 3d20 7365 7475 7028  xp_name = setup(
+00031950: 6461 7461 203d 206a 7569 6365 2c20 2074  data = juice,  t
+00031960: 6172 6765 7420 3d20 2750 7572 6368 6173  arget = 'Purchas
+00031970: 6527 290a 2020 2020 2020 2020 3e3e 3e20  e').        >>> 
+00031980: 6c72 203d 2063 7265 6174 655f 6d6f 6465  lr = create_mode
+00031990: 6c28 276c 7227 290a 2020 2020 2020 2020  l('lr').        
+000319a0: 3e3e 3e20 6372 6561 7465 5f61 7070 286c  >>> create_app(l
+000319b0: 7229 0a0a 0a20 2020 2020 2020 2065 7374  r)...        est
+000319c0: 696d 6174 6f72 3a20 7363 696b 6974 2d6c  imator: scikit-l
+000319d0: 6561 726e 2063 6f6d 7061 7469 626c 6520  earn compatible 
+000319e0: 6f62 6a65 6374 0a20 2020 2020 2020 2020  object.         
+000319f0: 2020 2054 7261 696e 6564 206d 6f64 656c     Trained model
+00031a00: 206f 626a 6563 740a 0a0a 2020 2020 2020   object...      
+00031a10: 2020 6170 705f 6b77 6172 6773 3a20 6469    app_kwargs: di
+00031a20: 6374 2c20 6465 6661 756c 7420 3d20 7b7d  ct, default = {}
+00031a30: 2028 656d 7074 7920 6469 6374 290a 2020   (empty dict).  
+00031a40: 2020 2020 2020 2020 2020 6172 6775 6d65            argume
+00031a50: 6e74 7320 746f 2062 6520 7061 7373 6564  nts to be passed
+00031a60: 2074 6f20 6170 7020 636c 6173 732e 0a0a   to app class...
+00031a70: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00031a80: 3a0a 2020 2020 2020 2020 2020 2020 4e6f  :.            No
+00031a90: 6e65 0a20 2020 2020 2020 2022 2222 0a0a  ne.        """..
+00031aa0: 2020 2020 2020 2020 5f63 6865 636b 5f73          _check_s
+00031ab0: 6f66 745f 6465 7065 6e64 656e 6369 6573  oft_dependencies
+00031ac0: 2822 6772 6164 696f 222c 2065 7874 7261  ("gradio", extra
+00031ad0: 3d22 6d6c 6f70 7322 2c20 7365 7665 7269  ="mlops", severi
+00031ae0: 7479 3d22 6572 726f 7222 290a 2020 2020  ty="error").    
+00031af0: 2020 2020 696d 706f 7274 2067 7261 6469      import gradi
+00031b00: 6f20 6173 2067 720a 0a20 2020 2020 2020  o as gr..       
+00031b10: 2061 6c6c 5f69 6e70 7574 7320 3d20 5b5d   all_inputs = []
+00031b20: 0a20 2020 2020 2020 2061 7070 5f6b 7761  .        app_kwa
+00031b30: 7267 7320 3d20 6170 705f 6b77 6172 6773  rgs = app_kwargs
+00031b40: 206f 7220 7b7d 0a0a 2020 2020 2020 2020   or {}..        
+00031b50: 666f 7220 6920 696e 2073 656c 662e 582e  for i in self.X.
+00031b60: 636f 6c75 6d6e 733a 0a20 2020 2020 2020  columns:.       
+00031b70: 2020 2020 2069 6620 6920 696e 2073 656c       if i in sel
+00031b80: 662e 5f66 7873 5b22 4361 7465 676f 7269  f._fxs["Categori
+00031b90: 6361 6c22 5d20 6f72 2069 2069 6e20 7365  cal"] or i in se
+00031ba0: 6c66 2e5f 6678 735b 224f 7264 696e 616c  lf._fxs["Ordinal
+00031bb0: 225d 3a0a 2020 2020 2020 2020 2020 2020  "]:.            
+00031bc0: 2020 2020 616c 6c5f 696e 7075 7473 2e61      all_inputs.a
+00031bd0: 7070 656e 6428 6772 2e69 6e70 7574 732e  ppend(gr.inputs.
+00031be0: 4472 6f70 646f 776e 286c 6973 7428 7365  Dropdown(list(se
+00031bf0: 6c66 2e58 5b69 5d2e 756e 6971 7565 2829  lf.X[i].unique()
+00031c00: 292c 206c 6162 656c 3d69 2929 0a20 2020  ), label=i)).   
+00031c10: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00031c20: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00031c30: 6c6c 5f69 6e70 7574 732e 6170 7065 6e64  ll_inputs.append
+00031c40: 2867 722e 696e 7075 7473 2e54 6578 7462  (gr.inputs.Textb
+00031c50: 6f78 286c 6162 656c 3d69 2929 0a0a 2020  ox(label=i))..  
+00031c60: 2020 2020 2020 6465 6620 7072 6564 6963        def predic
+00031c70: 7428 2a64 6963 745f 696e 7075 7429 3a0a  t(*dict_input):.
+00031c80: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
+00031c90: 745f 6466 203d 2070 642e 4461 7461 4672  t_df = pd.DataFr
+00031ca0: 616d 652e 6672 6f6d 5f64 6963 7428 5b64  ame.from_dict([d
+00031cb0: 6963 745f 696e 7075 745d 290a 2020 2020  ict_input]).    
+00031cc0: 2020 2020 2020 2020 696e 7075 745f 6466          input_df
+00031cd0: 2e63 6f6c 756d 6e73 203d 206c 6973 7428  .columns = list(
+00031ce0: 7365 6c66 2e58 2e63 6f6c 756d 6e73 290a  self.X.columns).
+00031cf0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00031d00: 726e 2028 0a20 2020 2020 2020 2020 2020  rn (.           
+00031d10: 2020 2020 2073 656c 662e 7072 6564 6963       self.predic
+00031d20: 745f 6d6f 6465 6c28 0a20 2020 2020 2020  t_model(.       
+00031d30: 2020 2020 2020 2020 2020 2020 2065 7374               est
+00031d40: 696d 6174 6f72 2c20 6461 7461 3d69 6e70  imator, data=inp
+00031d50: 7574 5f64 662c 202a 2a73 656c 662e 5f63  ut_df, **self._c
+00031d60: 7265 6174 655f 6170 705f 7072 6564 6963  reate_app_predic
+00031d70: 745f 6b77 6172 6773 0a20 2020 2020 2020  t_kwargs.       
+00031d80: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00031d90: 2020 2020 2020 2020 2020 202e 696c 6f63             .iloc
+00031da0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
+00031db0: 2020 2020 2e74 6f5f 6469 6374 2829 0a20      .to_dict(). 
+00031dc0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00031dd0: 2020 2020 2020 7265 7475 726e 2067 722e        return gr.
+00031de0: 496e 7465 7266 6163 6528 0a20 2020 2020  Interface(.     
+00031df0: 2020 2020 2020 2066 6e3d 7072 6564 6963         fn=predic
+00031e00: 742c 0a20 2020 2020 2020 2020 2020 2069  t,.            i
+00031e10: 6e70 7574 733d 616c 6c5f 696e 7075 7473  nputs=all_inputs
+00031e20: 2c0a 2020 2020 2020 2020 2020 2020 6f75  ,.            ou
+00031e30: 7470 7574 733d 2274 6578 7422 2c0a 2020  tputs="text",.  
+00031e40: 2020 2020 2020 2020 2020 6c69 7665 3d46            live=F
+00031e50: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+00031e60: 2020 2a2a 6170 705f 6b77 6172 6773 2c0a    **app_kwargs,.
+00031e70: 2020 2020 2020 2020 292e 6c61 756e 6368          ).launch
+00031e80: 2829 0a0a 2020 2020 6465 6620 6461 7368  ()..    def dash
+00031e90: 626f 6172 6428 0a20 2020 2020 2020 2073  board(.        s
+00031ea0: 656c 662c 0a20 2020 2020 2020 2065 7374  elf,.        est
+00031eb0: 696d 6174 6f72 2c0a 2020 2020 2020 2020  imator,.        
+00031ec0: 6469 7370 6c61 795f 666f 726d 6174 3a20  display_format: 
+00031ed0: 7374 7220 3d20 2264 6173 6822 2c0a 2020  str = "dash",.  
+00031ee0: 2020 2020 2020 6461 7368 626f 6172 645f        dashboard_
+00031ef0: 6b77 6172 6773 3a20 4f70 7469 6f6e 616c  kwargs: Optional
+00031f00: 5b44 6963 745b 7374 722c 2041 6e79 5d5d  [Dict[str, Any]]
+00031f10: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00031f20: 2072 756e 5f6b 7761 7267 733a 204f 7074   run_kwargs: Opt
+00031f30: 696f 6e61 6c5b 4469 6374 5b73 7472 2c20  ional[Dict[str, 
+00031f40: 416e 795d 5d20 3d20 4e6f 6e65 2c0a 2020  Any]] = None,.  
+00031f50: 2020 2020 2020 2a2a 6b77 6172 6773 2c0a        **kwargs,.
+00031f60: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+00031f70: 2222 0a20 2020 2020 2020 2054 6869 7320  "".        This 
+00031f80: 6675 6e63 7469 6f6e 2067 656e 6572 6174  function generat
+00031f90: 6573 2074 6865 2069 6e74 6572 6163 7469  es the interacti
+00031fa0: 7665 2064 6173 6862 6f61 7264 2066 6f72  ve dashboard for
+00031fb0: 2061 2074 7261 696e 6564 206d 6f64 656c   a trained model
+00031fc0: 2e20 5468 650a 2020 2020 2020 2020 6461  . The.        da
+00031fd0: 7368 626f 6172 6420 6973 2069 6d70 6c65  shboard is imple
+00031fe0: 6d65 6e74 6564 2075 7369 6e67 2045 7870  mented using Exp
+00031ff0: 6c61 696e 6572 4461 7368 626f 6172 6420  lainerDashboard 
+00032000: 2865 7870 6c61 696e 6572 6461 7368 626f  (explainerdashbo
+00032010: 6172 642e 7265 6164 7468 6564 6f63 732e  ard.readthedocs.
+00032020: 696f 290a 0a0a 2020 2020 2020 2020 4578  io)...        Ex
+00032030: 616d 706c 650a 2020 2020 2020 2020 2d2d  ample.        --
+00032040: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
+00032050: 3e20 6672 6f6d 2070 7963 6172 6574 2e64  > from pycaret.d
+00032060: 6174 6173 6574 7320 696d 706f 7274 2067  atasets import g
+00032070: 6574 5f64 6174 610a 2020 2020 2020 2020  et_data.        
+00032080: 3e3e 3e20 6a75 6963 6520 3d20 6765 745f  >>> juice = get_
+00032090: 6461 7461 2827 6a75 6963 6527 290a 2020  data('juice').  
+000320a0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2070        >>> from p
+000320b0: 7963 6172 6574 2e63 6c61 7373 6966 6963  ycaret.classific
+000320c0: 6174 696f 6e20 696d 706f 7274 202a 0a20  ation import *. 
+000320d0: 2020 2020 2020 203e 3e3e 2065 7870 5f6e         >>> exp_n
+000320e0: 616d 6520 3d20 7365 7475 7028 6461 7461  ame = setup(data
+000320f0: 203d 206a 7569 6365 2c20 2074 6172 6765   = juice,  targe
+00032100: 7420 3d20 2750 7572 6368 6173 6527 290a  t = 'Purchase').
+00032110: 2020 2020 2020 2020 3e3e 3e20 6c72 203d          >>> lr =
+00032120: 2063 7265 6174 655f 6d6f 6465 6c28 276c   create_model('l
+00032130: 7227 290a 2020 2020 2020 2020 3e3e 3e20  r').        >>> 
+00032140: 6461 7368 626f 6172 6428 6c72 290a 0a0a  dashboard(lr)...
+00032150: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
+00032160: 723a 2073 6369 6b69 742d 6c65 6172 6e20  r: scikit-learn 
+00032170: 636f 6d70 6174 6962 6c65 206f 626a 6563  compatible objec
+00032180: 740a 2020 2020 2020 2020 2020 2020 5472  t.            Tr
+00032190: 6169 6e65 6420 6d6f 6465 6c20 6f62 6a65  ained model obje
+000321a0: 6374 0a0a 0a20 2020 2020 2020 2064 6973  ct...        dis
+000321b0: 706c 6179 5f66 6f72 6d61 743a 2073 7472  play_format: str
+000321c0: 2c20 6465 6661 756c 7420 3d20 2764 6173  , default = 'das
+000321d0: 6827 0a20 2020 2020 2020 2020 2020 2052  h'.            R
+000321e0: 656e 6465 7220 6d6f 6465 2066 6f72 2074  ender mode for t
+000321f0: 6865 2064 6173 6862 6f61 7264 2e20 5468  he dashboard. Th
+00032200: 6520 6465 6661 756c 7420 6973 2073 6574  e default is set
+00032210: 2074 6f20 6060 6461 7368 6060 2077 6869   to ``dash`` whi
+00032220: 6368 2077 696c 6c0a 2020 2020 2020 2020  ch will.        
+00032230: 2020 2020 7265 6e64 6572 2061 2064 6173      render a das
+00032240: 6862 6f61 7264 2069 6e20 6272 6f77 7365  hboard in browse
+00032250: 722e 2054 6865 7265 2061 7265 2066 6f75  r. There are fou
+00032260: 7220 706f 7373 6962 6c65 206f 7074 696f  r possible optio
+00032270: 6e73 3a0a 0a20 2020 2020 2020 2020 2020  ns:..           
+00032280: 202d 2027 6461 7368 2720 2d20 6469 7370   - 'dash' - disp
+00032290: 6c61 7973 2074 6865 2064 6173 6862 6f61  lays the dashboa
+000322a0: 7264 2069 6e20 6272 6f77 7365 720a 2020  rd in browser.  
+000322b0: 2020 2020 2020 2020 2020 2d20 2769 6e6c            - 'inl
+000322c0: 696e 6527 202d 2064 6973 706c 6179 7320  ine' - displays 
+000322d0: 7468 6520 6461 7368 626f 6172 6420 696e  the dashboard in
+000322e0: 2074 6865 206a 7570 7974 6572 206e 6f74   the jupyter not
+000322f0: 6562 6f6f 6b20 6365 6c6c 2e0a 2020 2020  ebook cell..    
+00032300: 2020 2020 2020 2020 2d20 276a 7570 7974          - 'jupyt
+00032310: 6572 6c61 6227 202d 2064 6973 706c 6179  erlab' - display
+00032320: 7320 7468 6520 6461 7368 626f 6172 6420  s the dashboard 
+00032330: 696e 206a 7570 7974 6572 6c61 6220 7061  in jupyterlab pa
+00032340: 6e65 2e0a 2020 2020 2020 2020 2020 2020  ne..            
+00032350: 2d20 2765 7874 6572 6e61 6c27 202d 2064  - 'external' - d
+00032360: 6973 706c 6179 7320 7468 6520 6461 7368  isplays the dash
+00032370: 626f 6172 6420 696e 2061 2073 6570 6172  board in a separ
+00032380: 6174 6520 7461 622e 2028 7573 6520 696e  ate tab. (use in
+00032390: 2043 6f6c 6162 290a 0a0a 2020 2020 2020   Colab)...      
+000323a0: 2020 6461 7368 626f 6172 645f 6b77 6172    dashboard_kwar
+000323b0: 6773 3a20 6469 6374 2c20 6465 6661 756c  gs: dict, defaul
+000323c0: 7420 3d20 7b7d 2028 656d 7074 7920 6469  t = {} (empty di
+000323d0: 6374 290a 2020 2020 2020 2020 2020 2020  ct).            
+000323e0: 4469 6374 696f 6e61 7279 206f 6620 6172  Dictionary of ar
+000323f0: 6775 6d65 6e74 7320 7061 7373 6564 2074  guments passed t
+00032400: 6f20 7468 6520 6060 4578 706c 6169 6e65  o the ``Explaine
+00032410: 7244 6173 6862 6f61 7264 6060 2063 6c61  rDashboard`` cla
+00032420: 7373 2e0a 0a0a 2020 2020 2020 2020 7275  ss....        ru
+00032430: 6e5f 6b77 6172 6773 3a20 6469 6374 2c20  n_kwargs: dict, 
+00032440: 6465 6661 756c 7420 3d20 7b7d 2028 656d  default = {} (em
+00032450: 7074 7920 6469 6374 290a 2020 2020 2020  pty dict).      
+00032460: 2020 2020 2020 4469 6374 696f 6e61 7279        Dictionary
+00032470: 206f 6620 6172 6775 6d65 6e74 7320 7061   of arguments pa
+00032480: 7373 6564 2074 6f20 7468 6520 6060 7275  ssed to the ``ru
+00032490: 6e60 6020 6d65 7468 6f64 206f 6620 6060  n`` method of ``
+000324a0: 4578 706c 6169 6e65 7244 6173 6862 6f61  ExplainerDashboa
+000324b0: 7264 6060 2e0a 0a0a 2020 2020 2020 2020  rd``....        
+000324c0: 2a2a 6b77 6172 6773 3a0a 2020 2020 2020  **kwargs:.      
+000324d0: 2020 2020 2020 4164 6469 7469 6f6e 616c        Additional
+000324e0: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
+000324f0: 7473 2074 6f20 7061 7373 2074 6f20 7468  ts to pass to th
+00032500: 6520 6060 436c 6173 7369 6669 6572 4578  e ``ClassifierEx
+00032510: 706c 6169 6e65 7260 6020 6f72 0a20 2020  plainer`` or.   
+00032520: 2020 2020 2020 2020 2060 6052 6567 7265           ``Regre
+00032530: 7373 696f 6e45 7870 6c61 696e 6572 6060  ssionExplainer``
+00032540: 2063 6c61 7373 2e0a 0a0a 2020 2020 2020   class....      
+00032550: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
+00032560: 2020 2020 2020 204e 6f6e 650a 2020 2020         None.    
+00032570: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+00032580: 205f 6368 6563 6b5f 736f 6674 5f64 6570   _check_soft_dep
+00032590: 656e 6465 6e63 6965 7328 0a20 2020 2020  endencies(.     
+000325a0: 2020 2020 2020 2022 6578 706c 6169 6e65         "explaine
+000325b0: 7264 6173 6862 6f61 7264 222c 2065 7874  rdashboard", ext
+000325c0: 7261 3d22 616e 616c 7973 6973 222c 2073  ra="analysis", s
+000325d0: 6576 6572 6974 793d 2265 7272 6f72 220a  everity="error".
+000325e0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+000325f0: 6566 2064 6565 705f 6368 6563 6b28 7365  ef deep_check(se
+00032600: 6c66 2c20 6573 7469 6d61 746f 722c 2063  lf, estimator, c
+00032610: 6865 636b 5f6b 7761 7267 733a 204f 7074  heck_kwargs: Opt
+00032620: 696f 6e61 6c5b 6469 6374 5d29 3a0a 2020  ional[dict]):.  
+00032630: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00032640: 2020 5468 6973 2066 756e 6374 696f 6e20    This function 
+00032650: 7275 6e73 2061 2066 756c 6c20 7375 6974  runs a full suit
+00032660: 6520 6368 6563 6b20 6f76 6572 2061 2074  e check over a t
+00032670: 7261 696e 6564 206d 6f64 656c 0a20 2020  rained model.   
+00032680: 2020 2020 2075 7369 6e67 2064 6565 7063       using deepc
+00032690: 6865 636b 7320 6c69 6272 6172 792e 0a0a  hecks library...
+000326a0: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+000326b0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000326c0: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+000326d0: 6d20 7079 6361 7265 742e 6461 7461 7365  m pycaret.datase
+000326e0: 7473 2069 6d70 6f72 7420 6765 745f 6461  ts import get_da
+000326f0: 7461 0a20 2020 2020 2020 203e 3e3e 206a  ta.        >>> j
+00032700: 7569 6365 203d 2067 6574 5f64 6174 6128  uice = get_data(
+00032710: 276a 7569 6365 2729 0a20 2020 2020 2020  'juice').       
+00032720: 203e 3e3e 2066 726f 6d20 7079 6361 7265   >>> from pycare
+00032730: 742e 636c 6173 7369 6669 6361 7469 6f6e  t.classification
+00032740: 2069 6d70 6f72 7420 2a0a 2020 2020 2020   import *.      
+00032750: 2020 3e3e 3e20 6578 705f 6e61 6d65 203d    >>> exp_name =
+00032760: 2073 6574 7570 2864 6174 6120 3d20 6a75   setup(data = ju
+00032770: 6963 652c 2020 7461 7267 6574 203d 2027  ice,  target = '
+00032780: 5075 7263 6861 7365 2729 0a20 2020 2020  Purchase').     
+00032790: 2020 203e 3e3e 206c 7220 3d20 6372 6561     >>> lr = crea
+000327a0: 7465 5f6d 6f64 656c 2827 6c72 2729 0a20  te_model('lr'). 
+000327b0: 2020 2020 2020 203e 3e3e 2064 6565 705f         >>> deep_
+000327c0: 6368 6563 6b28 6c72 290a 0a0a 2020 2020  check(lr)...    
+000327d0: 2020 2020 6573 7469 6d61 746f 723a 2073      estimator: s
+000327e0: 6369 6b69 742d 6c65 6172 6e20 636f 6d70  cikit-learn comp
+000327f0: 6174 6962 6c65 206f 626a 6563 740a 2020  atible object.  
+00032800: 2020 2020 2020 2020 2020 5472 6169 6e65            Traine
+00032810: 6420 6d6f 6465 6c20 6f62 6a65 6374 0a0a  d model object..
+00032820: 0a20 2020 2020 2020 2063 6865 636b 5f6b  .        check_k
+00032830: 7761 7267 733a 2064 6963 742c 2064 6566  wargs: dict, def
+00032840: 6175 6c74 203d 207b 7d20 2865 6d70 7479  ault = {} (empty
+00032850: 2064 6963 7429 0a20 2020 2020 2020 2020   dict).         
+00032860: 2020 2061 7267 756d 656e 7473 2074 6f20     arguments to 
+00032870: 6265 2070 6173 7365 6420 746f 2064 6565  be passed to dee
+00032880: 7063 6865 636b 7320 6675 6c6c 5f73 7569  pchecks full_sui
+00032890: 7465 2063 6c61 7373 2e0a 0a0a 2020 2020  te class....    
+000328a0: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
+000328b0: 2020 2020 2020 2020 2052 6573 756c 7473           Results
+000328c0: 206f 6620 6465 6570 6368 6563 6b73 2e73   of deepchecks.s
+000328d0: 7569 7465 732e 6675 6c6c 5f73 7569 7465  uites.full_suite
+000328e0: 2e72 756e 0a20 2020 2020 2020 2022 2222  .run.        """
+000328f0: 0a0a 2020 2020 2020 2020 5f63 6865 636b  ..        _check
+00032900: 5f73 6f66 745f 6465 7065 6e64 656e 6369  _soft_dependenci
+00032910: 6573 2822 6465 6570 6368 6563 6b73 222c  es("deepchecks",
+00032920: 2065 7874 7261 3d22 616e 616c 7973 6973   extra="analysis
+00032930: 222c 2073 6576 6572 6974 793d 2265 7272  ", severity="err
+00032940: 6f72 2229 0a20 2020 2020 2020 2063 6865  or").        che
+00032950: 636b 5f6b 7761 7267 7320 3d20 6368 6563  ck_kwargs = chec
+00032960: 6b5f 6b77 6172 6773 206f 7220 7b7d 0a0a  k_kwargs or {}..
+00032970: 2020 2020 2020 2020 6672 6f6d 2064 6565          from dee
+00032980: 7063 6865 636b 7320 696d 706f 7274 2044  pchecks import D
+00032990: 6174 6173 6574 0a0a 2020 2020 2020 2020  ataset..        
+000329a0: 6473 5f74 7261 696e 203d 2044 6174 6173  ds_train = Datas
+000329b0: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
+000329c0: 7365 6c66 2e58 5f74 7261 696e 5f74 7261  self.X_train_tra
+000329d0: 6e73 666f 726d 6564 2c20 6c61 6265 6c3d  nsformed, label=
+000329e0: 7365 6c66 2e79 5f74 7261 696e 5f74 7261  self.y_train_tra
+000329f0: 6e73 666f 726d 6564 2c20 6361 745f 6665  nsformed, cat_fe
+00032a00: 6174 7572 6573 3d5b 5d0a 2020 2020 2020  atures=[].      
+00032a10: 2020 290a 2020 2020 2020 2020 6473 5f74    ).        ds_t
+00032a20: 6573 7420 3d20 4461 7461 7365 7428 0a20  est = Dataset(. 
+00032a30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00032a40: 585f 7465 7374 5f74 7261 6e73 666f 726d  X_test_transform
+00032a50: 6564 2c20 6c61 6265 6c3d 7365 6c66 2e79  ed, label=self.y
+00032a60: 5f74 6573 745f 7472 616e 7366 6f72 6d65  _test_transforme
+00032a70: 642c 2063 6174 5f66 6561 7475 7265 733d  d, cat_features=
+00032a80: 5b5d 0a20 2020 2020 2020 2029 0a0a 2020  [].        )..  
+00032a90: 2020 2020 2020 6672 6f6d 2064 6565 7063        from deepc
+00032aa0: 6865 636b 732e 7461 6275 6c61 722e 7375  hecks.tabular.su
+00032ab0: 6974 6573 2069 6d70 6f72 7420 6675 6c6c  ites import full
+00032ac0: 5f73 7569 7465 0a0a 2020 2020 2020 2020  _suite..        
+00032ad0: 7375 6974 6520 3d20 6675 6c6c 5f73 7569  suite = full_sui
+00032ae0: 7465 282a 2a63 6865 636b 5f6b 7761 7267  te(**check_kwarg
+00032af0: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
+00032b00: 6e20 7375 6974 652e 7275 6e28 7472 6169  n suite.run(trai
+00032b10: 6e5f 6461 7461 7365 743d 6473 5f74 7261  n_dataset=ds_tra
+00032b20: 696e 2c20 7465 7374 5f64 6174 6173 6574  in, test_dataset
+00032b30: 3d64 735f 7465 7374 2c20 6d6f 6465 6c3d  =ds_test, model=
+00032b40: 6573 7469 6d61 746f 7229 0a0a 2020 2020  estimator)..    
+00032b50: 6465 6620 6368 6563 6b5f 6472 6966 7428  def check_drift(
+00032b60: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00032b70: 2020 2020 2020 2072 6566 6572 656e 6365         reference
+00032b80: 5f64 6174 613a 204f 7074 696f 6e61 6c5b  _data: Optional[
+00032b90: 7064 2e44 6174 6146 7261 6d65 5d20 3d20  pd.DataFrame] = 
+00032ba0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6375  None,.        cu
+00032bb0: 7272 656e 745f 6461 7461 3a20 4f70 7469  rrent_data: Opti
+00032bc0: 6f6e 616c 5b70 642e 4461 7461 4672 616d  onal[pd.DataFram
+00032bd0: 655d 203d 204e 6f6e 652c 0a20 2020 2020  e] = None,.     
+00032be0: 2020 2074 6172 6765 743a 204f 7074 696f     target: Optio
+00032bf0: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+00032c00: 0a20 2020 2020 2020 206e 756d 6572 6963  .        numeric
+00032c10: 5f66 6561 7475 7265 733a 204f 7074 696f  _features: Optio
+00032c20: 6e61 6c5b 4c69 7374 5b73 7472 5d5d 203d  nal[List[str]] =
+00032c30: 204e 6f6e 652c 0a20 2020 2020 2020 2063   None,.        c
+00032c40: 6174 6567 6f72 6963 616c 5f66 6561 7475  ategorical_featu
+00032c50: 7265 733a 204f 7074 696f 6e61 6c5b 4c69  res: Optional[Li
+00032c60: 7374 5b73 7472 5d5d 203d 204e 6f6e 652c  st[str]] = None,
+00032c70: 0a20 2020 2020 2020 2064 6174 655f 6665  .        date_fe
+00032c80: 6174 7572 6573 3a20 4f70 7469 6f6e 616c  atures: Optional
+00032c90: 5b4c 6973 745b 7374 725d 5d20 3d20 4e6f  [List[str]] = No
+00032ca0: 6e65 2c0a 2020 2020 2020 2020 6669 6c65  ne,.        file
+00032cb0: 6e61 6d65 3a20 4f70 7469 6f6e 616c 5b73  name: Optional[s
+00032cc0: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
+00032cd0: 2920 2d3e 2073 7472 3a0a 2020 2020 2020  ) -> str:.      
+00032ce0: 2020 2222 220a 2020 2020 2020 2020 5468    """.        Th
+00032cf0: 6973 2066 756e 6374 696f 6e20 6765 6e65  is function gene
+00032d00: 7261 7465 7320 6120 6472 6966 7420 7265  rates a drift re
+00032d10: 706f 7274 2066 696c 6520 7573 696e 6720  port file using 
+00032d20: 7468 650a 2020 2020 2020 2020 6576 6964  the.        evid
+00032d30: 656e 746c 7920 6c69 6272 6172 792e 0a0a  ently library...
+00032d40: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+00032d50: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00032d60: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+00032d70: 6d20 7079 6361 7265 742e 6461 7461 7365  m pycaret.datase
+00032d80: 7473 2069 6d70 6f72 7420 6765 745f 6461  ts import get_da
+00032d90: 7461 0a20 2020 2020 2020 203e 3e3e 206a  ta.        >>> j
+00032da0: 7569 6365 203d 2067 6574 5f64 6174 6128  uice = get_data(
+00032db0: 276a 7569 6365 2729 0a20 2020 2020 2020  'juice').       
+00032dc0: 203e 3e3e 2066 726f 6d20 7079 6361 7265   >>> from pycare
+00032dd0: 742e 636c 6173 7369 6669 6361 7469 6f6e  t.classification
+00032de0: 2069 6d70 6f72 7420 2a0a 2020 2020 2020   import *.      
+00032df0: 2020 3e3e 3e20 6578 705f 6e61 6d65 203d    >>> exp_name =
+00032e00: 2073 6574 7570 2864 6174 6120 3d20 6a75   setup(data = ju
+00032e10: 6963 652c 2020 7461 7267 6574 203d 2027  ice,  target = '
+00032e20: 5075 7263 6861 7365 2729 0a20 2020 2020  Purchase').     
+00032e30: 2020 203e 3e3e 2063 6865 636b 5f64 7269     >>> check_dri
+00032e40: 6674 2829 0a0a 0a20 2020 2020 2020 2072  ft()...        r
+00032e50: 6566 6572 656e 6365 5f64 6174 613a 204f  eference_data: O
+00032e60: 7074 696f 6e61 6c5b 7064 2e44 6174 6146  ptional[pd.DataF
+00032e70: 7261 6d65 5d20 3d20 4e6f 6e65 0a20 2020  rame] = None.   
+00032e80: 2020 2020 2020 2020 2052 6566 6572 656e           Referen
+00032e90: 6365 2064 6174 612e 2049 6620 6e6f 7420  ce data. If not 
+00032ea0: 7370 6563 6966 6965 642c 2077 696c 6c20  specified, will 
+00032eb0: 7573 6520 7472 6169 6e69 6e67 2064 6174  use training dat
+00032ec0: 612e 0a20 2020 2020 2020 2020 2020 204d  a..            M
+00032ed0: 7573 7420 6265 2073 7065 6369 6669 6564  ust be specified
+00032ee0: 2069 6620 6060 7365 7475 7028 2960 6020   if ``setup()`` 
+00032ef0: 6861 7320 6e6f 7420 6265 656e 2072 756e  has not been run
+00032f00: 2e0a 0a0a 2020 2020 2020 2020 6375 7272  ....        curr
+00032f10: 656e 745f 6461 7461 3a20 4f70 7469 6f6e  ent_data: Option
+00032f20: 616c 5b70 642e 4461 7461 4672 616d 655d  al[pd.DataFrame]
+00032f30: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+00032f40: 2020 2020 4375 7272 656e 7420 6461 7461      Current data
+00032f50: 2e20 4966 206e 6f74 2073 7065 6369 6669  . If not specifi
+00032f60: 6564 2c20 7769 6c6c 2075 7365 2074 6573  ed, will use tes
+00032f70: 7420 6461 7461 2e0a 2020 2020 2020 2020  t data..        
+00032f80: 2020 2020 4d75 7374 2062 6520 7370 6563      Must be spec
+00032f90: 6966 6965 6420 6966 2060 6073 6574 7570  ified if ``setup
+00032fa0: 2829 6060 2068 6173 206e 6f74 2062 6565  ()`` has not bee
+00032fb0: 6e20 7275 6e2e 0a0a 0a20 2020 2020 2020  n run....       
+00032fc0: 2074 6172 6765 743a 204f 7074 696f 6e61   target: Optiona
+00032fd0: 6c5b 7374 725d 203d 204e 6f6e 650a 2020  l[str] = None.  
+00032fe0: 2020 2020 2020 2020 2020 4e61 6d65 206f            Name o
+00032ff0: 6620 7468 6520 7461 7267 6574 2063 6f6c  f the target col
+00033000: 756d 6e2e 2049 6620 6e6f 7420 7370 6563  umn. If not spec
+00033010: 6966 6965 642c 2077 696c 6c20 7573 650a  ified, will use.
+00033020: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+00033030: 636f 6c75 6d6e 2073 7065 6369 6669 6564  column specified
+00033040: 2069 6e20 6060 7365 7475 7028 2960 602e   in ``setup()``.
+00033050: 0a20 2020 2020 2020 2020 2020 204d 7573  .            Mus
+00033060: 7420 6265 2073 7065 6369 6669 6564 2069  t be specified i
+00033070: 6620 6060 7365 7475 7028 2960 6020 6861  f ``setup()`` ha
+00033080: 7320 6e6f 7420 6265 656e 2072 756e 2e0a  s not been run..
+00033090: 0a0a 2020 2020 2020 2020 6e75 6d65 7269  ..        numeri
+000330a0: 635f 6665 6174 7572 6573 3a20 4f70 7469  c_features: Opti
+000330b0: 6f6e 616c 5b4c 6973 745b 7374 725d 5d20  onal[List[str]] 
+000330c0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2020  = None.         
+000330d0: 2020 204e 616d 6573 206f 6620 6e75 6d65     Names of nume
+000330e0: 7269 6320 636f 6c75 6d6e 732e 2049 6620  ric columns. If 
+000330f0: 6e6f 7420 7370 6563 6966 6965 642c 2077  not specified, w
+00033100: 696c 6c20 7573 650a 2020 2020 2020 2020  ill use.        
+00033110: 2020 2020 7468 6520 636f 6c75 6d6e 7320      the columns 
+00033120: 7370 6563 6966 6965 642f 696e 6665 7272  specified/inferr
+00033130: 6564 2069 6e20 6060 7365 7475 7028 2960  ed in ``setup()`
+00033140: 602c 206f 720a 2020 2020 2020 2020 2020  `, or.          
+00033150: 2020 616c 6c20 6e6f 6e2d 6361 7465 676f    all non-catego
+00033160: 7269 6361 6c20 616e 6420 6e6f 6e2d 6461  rical and non-da
+00033170: 7465 2063 6f6c 756d 6e73 206f 7468 6572  te columns other
+00033180: 7769 7365 2e0a 0a0a 2020 2020 2020 2020  wise....        
+00033190: 6361 7465 676f 7269 6361 6c5f 6665 6174  categorical_feat
+000331a0: 7572 6573 3a20 4f70 7469 6f6e 616c 5b4c  ures: Optional[L
+000331b0: 6973 745b 7374 725d 5d20 3d20 4e6f 6e65  ist[str]] = None
+000331c0: 0a20 2020 2020 2020 2020 2020 204e 616d  .            Nam
+000331d0: 6573 206f 6620 6361 7465 676f 7269 6361  es of categorica
+000331e0: 6c20 636f 6c75 6d6e 732e 2049 6620 6e6f  l columns. If no
+000331f0: 7420 7370 6563 6966 6965 642c 2077 696c  t specified, wil
+00033200: 6c20 7573 650a 2020 2020 2020 2020 2020  l use.          
+00033210: 2020 7468 6520 636f 6c75 6d6e 7320 7370    the columns sp
+00033220: 6563 6966 6965 642f 696e 6665 7272 6564  ecified/inferred
+00033230: 2069 6e20 6060 7365 7475 7028 2960 602e   in ``setup()``.
+00033240: 0a0a 0a20 2020 2020 2020 2064 6174 655f  ...        date_
+00033250: 6665 6174 7572 6573 3a20 4f70 7469 6f6e  features: Option
+00033260: 616c 5b4c 6973 745b 7374 725d 5d20 3d20  al[List[str]] = 
+00033270: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+00033280: 204e 616d 6573 206f 6620 6461 7465 2063   Names of date c
+00033290: 6f6c 756d 6e73 2e20 4966 206e 6f74 2073  olumns. If not s
+000332a0: 7065 6369 6669 6564 2c20 7769 6c6c 2075  pecified, will u
+000332b0: 7365 0a20 2020 2020 2020 2020 2020 2074  se.            t
+000332c0: 6865 2063 6f6c 756d 6e73 2073 7065 6369  he columns speci
+000332d0: 6669 6564 2f69 6e66 6572 7265 6420 696e  fied/inferred in
+000332e0: 2060 6073 6574 7570 2829 6060 2e0a 0a0a   ``setup()``....
+000332f0: 2020 2020 2020 2020 6669 6c65 6e61 6d65          filename
+00033300: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+00033310: 3d20 4e6f 6e65 0a20 2020 2020 2020 2020  = None.         
+00033320: 2020 2050 6174 6820 746f 2073 6176 6520     Path to save 
+00033330: 7468 6520 6765 6e65 7261 7465 6420 4854  the generated HT
+00033340: 4d4c 2066 696c 6520 746f 2e20 4966 206e  ML file to. If n
+00033350: 6f74 2073 7065 6369 6669 6564 2c0a 2020  ot specified,.  
+00033360: 2020 2020 2020 2020 2020 7769 6c6c 2064            will d
+00033370: 6566 6175 6c74 2074 6f20 275b 4558 5045  efault to '[EXPE
+00033380: 5249 4d45 4e54 5f4e 414d 455d 5f5b 5449  RIMENT_NAME]_[TI
+00033390: 4d45 5354 414d 505d 5f44 7269 6674 5f52  MESTAMP]_Drift_R
+000333a0: 6570 6f72 742e 6874 6d6c 272e 0a0a 0a20  eport.html'.... 
+000333b0: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
+000333c0: 2020 2020 2020 2020 2020 2020 5061 7468              Path
+000333d0: 2074 6865 2067 656e 6572 6174 6564 2048   the generated H
+000333e0: 544d 4c20 6669 6c65 2077 6173 2073 6176  TML file was sav
+000333f0: 6564 2074 6f2e 0a20 2020 2020 2020 2022  ed to..        "
+00033400: 2222 0a20 2020 2020 2020 205f 6368 6563  "".        _chec
+00033410: 6b5f 736f 6674 5f64 6570 656e 6465 6e63  k_soft_dependenc
+00033420: 6965 7328 2265 7669 6465 6e74 6c79 222c  ies("evidently",
+00033430: 2065 7874 7261 3d22 6d6c 6f70 7322 2c20   extra="mlops", 
+00033440: 7365 7665 7269 7479 3d22 6572 726f 7222  severity="error"
+00033450: 290a 0a20 2020 2020 2020 2069 6620 7365  )..        if se
+00033460: 6c66 2e5f 7365 7475 705f 7261 6e3a 0a20  lf._setup_ran:. 
+00033470: 2020 2020 2020 2020 2020 2072 6566 6572             refer
+00033480: 656e 6365 5f64 6174 6120 3d20 7365 6c66  ence_data = self
+00033490: 2e74 7261 696e 2069 6620 7265 6665 7265  .train if refere
+000334a0: 6e63 655f 6461 7461 2069 7320 4e6f 6e65  nce_data is None
+000334b0: 2065 6c73 6520 7265 6665 7265 6e63 655f   else reference_
+000334c0: 6461 7461 0a20 2020 2020 2020 2020 2020  data.           
+000334d0: 2063 7572 7265 6e74 5f64 6174 6120 3d20   current_data = 
+000334e0: 7365 6c66 2e74 6573 7420 6966 2063 7572  self.test if cur
+000334f0: 7265 6e74 5f64 6174 6120 6973 204e 6f6e  rent_data is Non
+00033500: 6520 656c 7365 2063 7572 7265 6e74 5f64  e else current_d
+00033510: 6174 610a 2020 2020 2020 2020 2020 2020  ata.            
+00033520: 7461 7267 6574 203d 2073 656c 662e 7461  target = self.ta
+00033530: 7267 6574 5f70 6172 616d 2069 6620 7461  rget_param if ta
+00033540: 7267 6574 2069 7320 4e6f 6e65 2065 6c73  rget is None els
+00033550: 6520 7461 7267 6574 0a20 2020 2020 2020  e target.       
+00033560: 2020 2020 206e 756d 6572 6963 5f66 6561       numeric_fea
+00033570: 7475 7265 7320 3d20 6e75 6d65 7269 635f  tures = numeric_
+00033580: 6665 6174 7572 6573 206f 7220 7365 6c66  features or self
+00033590: 2e5f 6678 735b 224e 756d 6572 6963 225d  ._fxs["Numeric"]
+000335a0: 0a20 2020 2020 2020 2020 2020 2063 6174  .            cat
+000335b0: 6567 6f72 6963 616c 5f66 6561 7475 7265  egorical_feature
+000335c0: 7320 3d20 6361 7465 676f 7269 6361 6c5f  s = categorical_
+000335d0: 6665 6174 7572 6573 206f 7220 7365 6c66  features or self
+000335e0: 2e5f 6678 735b 2243 6174 6567 6f72 6963  ._fxs["Categoric
+000335f0: 616c 225d 0a20 2020 2020 2020 2020 2020  al"].           
+00033600: 2064 6174 655f 6665 6174 7572 6573 203d   date_features =
+00033610: 2064 6174 655f 6665 6174 7572 6573 206f   date_features o
+00033620: 7220 7365 6c66 2e5f 6678 735b 2244 6174  r self._fxs["Dat
+00033630: 6522 5d0a 2020 2020 2020 2020 6e6f 6e65  e"].        none
+00033640: 5f76 6172 7320 3d20 5b0a 2020 2020 2020  _vars = [.      
+00033650: 2020 2020 2020 6b0a 2020 2020 2020 2020        k.        
+00033660: 2020 2020 666f 7220 6b2c 2076 2069 6e20      for k, v in 
+00033670: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00033680: 2020 2272 6566 6572 656e 6365 5f64 6174    "reference_dat
+00033690: 6122 3a20 7265 6665 7265 6e63 655f 6461  a": reference_da
+000336a0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+000336b0: 2020 2020 2263 7572 7265 6e74 5f64 6174      "current_dat
+000336c0: 6122 3a20 6375 7272 656e 745f 6461 7461  a": current_data
+000336d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000336e0: 2020 2274 6172 6765 7422 3a20 7461 7267    "target": targ
+000336f0: 6574 2c0a 2020 2020 2020 2020 2020 2020  et,.            
+00033700: 7d2e 6974 656d 7328 290a 2020 2020 2020  }.items().      
+00033710: 2020 2020 2020 6966 2076 2069 7320 4e6f        if v is No
+00033720: 6e65 0a20 2020 2020 2020 205d 0a20 2020  ne.        ].   
+00033730: 2020 2020 2069 6620 6e6f 6e65 5f76 6172       if none_var
+00033740: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+00033750: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00033760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033770: 2022 5468 6520 666f 6c6c 6f77 696e 6720   "The following 
+00033780: 7661 7269 6162 6c65 7320 636f 756c 646e  variables couldn
+00033790: 2774 2068 6176 6520 6265 656e 2069 6e66  't have been inf
+000337a0: 6572 7265 6420 220a 2020 2020 2020 2020  erred ".        
+000337b0: 2020 2020 2020 2020 6622 6672 6f6d 2074          f"from t
+000337c0: 6865 2065 7870 6572 696d 656e 7420 7374  he experiment st
+000337d0: 6174 653a 207b 6e6f 6e65 5f76 6172 737d  ate: {none_vars}
+000337e0: 2e22 0a20 2020 2020 2020 2020 2020 2020  .".             
+000337f0: 2020 2022 4966 2079 6f75 2068 6176 6520     "If you have 
+00033800: 6e6f 7420 7261 6e20 6073 6574 7570 2829  not ran `setup()
+00033810: 602c 2079 6f75 206d 7573 7420 7061 7373  `, you must pass
+00033820: 2061 6c6c 206f 6620 7468 6520 6172 6775   all of the argu
+00033830: 6d65 6e74 7322 0a20 2020 2020 2020 2020  ments".         
+00033840: 2020 2020 2020 2022 6162 6f76 652e 220a         "above.".
+00033850: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00033860: 2020 2020 2020 2064 6174 655f 6665 6174         date_feat
+00033870: 7572 6573 203d 2064 6174 655f 6665 6174  ures = date_feat
+00033880: 7572 6573 206f 7220 5b5d 0a20 2020 2020  ures or [].     
+00033890: 2020 2063 6174 6567 6f72 6963 616c 5f66     categorical_f
+000338a0: 6561 7475 7265 7320 3d20 6361 7465 676f  eatures = catego
+000338b0: 7269 6361 6c5f 6665 6174 7572 6573 206f  rical_features o
+000338c0: 7220 5b5d 0a0a 2020 2020 2020 2020 6966  r []..        if
+000338d0: 206e 756d 6572 6963 5f66 6561 7475 7265   numeric_feature
+000338e0: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
+000338f0: 2020 2020 2020 206e 756d 6572 6963 5f66         numeric_f
+00033900: 6561 7475 7265 7320 3d20 6c69 7374 280a  eatures = list(.
+00033910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033920: 7365 7428 7265 6665 7265 6e63 655f 6461  set(reference_da
+00033930: 7461 2e63 6f6c 756d 6e73 290a 2020 2020  ta.columns).    
+00033940: 2020 2020 2020 2020 2020 2020 2e64 6966              .dif
+00033950: 6665 7265 6e63 6528 6361 7465 676f 7269  ference(categori
+00033960: 6361 6c5f 6665 6174 7572 6573 290a 2020  cal_features).  
+00033970: 2020 2020 2020 2020 2020 2020 2020 2e64                .d
+00033980: 6966 6665 7265 6e63 6528 6461 7465 5f66  ifference(date_f
+00033990: 6561 7475 7265 7329 0a20 2020 2020 2020  eatures).       
+000339a0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+000339b0: 6672 6f6d 2065 7669 6465 6e74 6c79 2e64  from evidently.d
+000339c0: 6173 6862 6f61 7264 2069 6d70 6f72 7420  ashboard import 
+000339d0: 4461 7368 626f 6172 640a 2020 2020 2020  Dashboard.      
+000339e0: 2020 6672 6f6d 2065 7669 6465 6e74 6c79    from evidently
+000339f0: 2e70 6970 656c 696e 652e 636f 6c75 6d6e  .pipeline.column
+00033a00: 5f6d 6170 7069 6e67 2069 6d70 6f72 7420  _mapping import 
+00033a10: 436f 6c75 6d6e 4d61 7070 696e 670a 2020  ColumnMapping.  
+00033a20: 2020 2020 2020 6672 6f6d 2065 7669 6465        from evide
+00033a30: 6e74 6c79 2e74 6162 7320 696d 706f 7274  ntly.tabs import
+00033a40: 2043 6174 5461 7267 6574 4472 6966 7454   CatTargetDriftT
+00033a50: 6162 2c20 4461 7461 4472 6966 7454 6162  ab, DataDriftTab
+00033a60: 0a0a 2020 2020 2020 2020 636f 6c75 6d6e  ..        column
+00033a70: 5f6d 6170 7069 6e67 203d 2043 6f6c 756d  _mapping = Colum
+00033a80: 6e4d 6170 7069 6e67 2829 0a20 2020 2020  nMapping().     
+00033a90: 2020 2063 6f6c 756d 6e5f 6d61 7070 696e     column_mappin
+00033aa0: 672e 7461 7267 6574 203d 2074 6172 6765  g.target = targe
+00033ab0: 740a 2020 2020 2020 2020 636f 6c75 6d6e  t.        column
+00033ac0: 5f6d 6170 7069 6e67 2e70 7265 6469 6374  _mapping.predict
+00033ad0: 696f 6e20 3d20 4e6f 6e65 0a20 2020 2020  ion = None.     
+00033ae0: 2020 2063 6f6c 756d 6e5f 6d61 7070 696e     column_mappin
+00033af0: 672e 6461 7465 7469 6d65 203d 204e 6f6e  g.datetime = Non
+00033b00: 650a 2020 2020 2020 2020 636f 6c75 6d6e  e.        column
+00033b10: 5f6d 6170 7069 6e67 2e6e 756d 6572 6963  _mapping.numeric
+00033b20: 616c 5f66 6561 7475 7265 7320 3d20 6e75  al_features = nu
+00033b30: 6d65 7269 635f 6665 6174 7572 6573 0a20  meric_features. 
+00033b40: 2020 2020 2020 2063 6f6c 756d 6e5f 6d61         column_ma
+00033b50: 7070 696e 672e 6361 7465 676f 7269 6361  pping.categorica
+00033b60: 6c5f 6665 6174 7572 6573 203d 2063 6174  l_features = cat
+00033b70: 6567 6f72 6963 616c 5f66 6561 7475 7265  egorical_feature
+00033b80: 730a 2020 2020 2020 2020 636f 6c75 6d6e  s.        column
+00033b90: 5f6d 6170 7069 6e67 2e64 6174 6574 696d  _mapping.datetim
+00033ba0: 655f 6665 6174 7572 6573 203d 2064 6174  e_features = dat
+00033bb0: 655f 6665 6174 7572 6573 0a0a 2020 2020  e_features..    
+00033bc0: 2020 2020 6966 2074 6172 6765 7420 6e6f      if target no
+00033bd0: 7420 696e 2072 6566 6572 656e 6365 5f64  t in reference_d
+00033be0: 6174 612e 636f 6c75 6d6e 7320 6f72 2074  ata.columns or t
+00033bf0: 6172 6765 7420 6e6f 7420 696e 2063 7572  arget not in cur
+00033c00: 7265 6e74 5f64 6174 612e 636f 6c75 6d6e  rent_data.column
+00033c10: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+00033c20: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00033c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033c40: 2066 2242 6f74 6820 6461 7461 7365 7420   f"Both dataset 
+00033c50: 6d75 7374 2063 6f6e 7461 696e 2061 206c  must contain a l
+00033c60: 6162 656c 2063 6f6c 756d 6e20 7b74 6172  abel column {tar
+00033c70: 6765 747d 2022 0a20 2020 2020 2020 2020  get} ".         
+00033c80: 2020 2020 2020 2022 696e 206f 7264 6572         "in order
+00033c90: 2074 6f20 6372 6561 7465 2061 2064 7269   to create a dri
+00033ca0: 6674 2072 6570 6f72 742e 220a 2020 2020  ft report.".    
+00033cb0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00033cc0: 2020 2064 6173 6862 6f61 7264 203d 2044     dashboard = D
+00033cd0: 6173 6862 6f61 7264 2874 6162 733d 5b44  ashboard(tabs=[D
+00033ce0: 6174 6144 7269 6674 5461 6228 292c 2043  ataDriftTab(), C
+00033cf0: 6174 5461 7267 6574 4472 6966 7454 6162  atTargetDriftTab
+00033d00: 2829 5d29 0a20 2020 2020 2020 2064 6173  ()]).        das
+00033d10: 6862 6f61 7264 2e63 616c 6375 6c61 7465  hboard.calculate
+00033d20: 2872 6566 6572 656e 6365 5f64 6174 612c  (reference_data,
+00033d30: 2063 7572 7265 6e74 5f64 6174 612c 2063   current_data, c
+00033d40: 6f6c 756d 6e5f 6d61 7070 696e 673d 636f  olumn_mapping=co
+00033d50: 6c75 6d6e 5f6d 6170 7069 6e67 290a 2020  lumn_mapping).  
+00033d60: 2020 2020 2020 6669 6c65 6e61 6d65 203d        filename =
+00033d70: 2028 0a20 2020 2020 2020 2020 2020 2066   (.            f
+00033d80: 696c 656e 616d 6520 6f72 2066 227b 7365  ilename or f"{se
+00033d90: 6c66 2e65 7870 5f6e 616d 655f 6c6f 677d  lf.exp_name_log}
+00033da0: 5f7b 696e 7428 7469 6d65 2e74 696d 6528  _{int(time.time(
+00033db0: 2929 7d5f 4472 6966 745f 5265 706f 7274  ))}_Drift_Report
+00033dc0: 2e68 746d 6c22 0a20 2020 2020 2020 2029  .html".        )
+00033dd0: 0a20 2020 2020 2020 2064 6173 6862 6f61  .        dashboa
+00033de0: 7264 2e73 6176 6528 6669 6c65 6e61 6d65  rd.save(filename
+00033df0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00033e00: 2066 696c 656e 616d 650a 0a20 2020 2040   filename..    @
+00033e10: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
+00033e20: 6465 6620 6c6f 6164 5f65 7870 6572 696d  def load_experim
+00033e30: 656e 7428 0a20 2020 2020 2020 2063 6c73  ent(.        cls
+00033e40: 2c0a 2020 2020 2020 2020 7061 7468 5f6f  ,.        path_o
+00033e50: 725f 6669 6c65 3a20 556e 696f 6e5b 7374  r_file: Union[st
+00033e60: 722c 206f 732e 5061 7468 4c69 6b65 2c20  r, os.PathLike, 
+00033e70: 4269 6e61 7279 494f 5d2c 0a20 2020 2020  BinaryIO],.     
+00033e80: 2020 2064 6174 613a 204f 7074 696f 6e61     data: Optiona
+00033e90: 6c5b 4441 5441 4652 414d 455f 4c49 4b45  l[DATAFRAME_LIKE
+00033ea0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+00033eb0: 2020 6461 7461 5f66 756e 633a 204f 7074    data_func: Opt
+00033ec0: 696f 6e61 6c5b 4361 6c6c 6162 6c65 5b5b  ional[Callable[[
+00033ed0: 5d2c 2044 4154 4146 5241 4d45 5f4c 494b  ], DATAFRAME_LIK
+00033ee0: 455d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  E]] = None,.    
+00033ef0: 2020 2020 7465 7374 5f64 6174 613a 204f      test_data: O
+00033f00: 7074 696f 6e61 6c5b 4441 5441 4652 414d  ptional[DATAFRAM
+00033f10: 455f 4c49 4b45 5d20 3d20 4e6f 6e65 2c0a  E_LIKE] = None,.
+00033f20: 2020 2020 2020 2020 7072 6570 726f 6365          preproce
+00033f30: 7373 5f64 6174 613a 2062 6f6f 6c20 3d20  ss_data: bool = 
+00033f40: 5472 7565 2c0a 2020 2020 2020 2020 2a2a  True,.        **
+00033f50: 636c 6f75 6470 6963 6b6c 655f 6b77 6172  cloudpickle_kwar
+00033f60: 6773 2c0a 2020 2020 2920 2d3e 2022 5f53  gs,.    ) -> "_S
+00033f70: 7570 6572 7669 7365 6445 7870 6572 696d  upervisedExperim
+00033f80: 656e 7422 3a0a 2020 2020 2020 2020 2222  ent":.        ""
+00033f90: 220a 2020 2020 2020 2020 4c6f 6164 2061  ".        Load a
+00033fa0: 6e20 6578 7065 7269 6d65 6e74 2073 6176  n experiment sav
+00033fb0: 6564 2077 6974 6820 6060 7361 7665 5f65  ed with ``save_e
+00033fc0: 7870 6572 696d 656e 7460 6020 6672 6f6d  xperiment`` from
+00033fd0: 2070 6174 680a 2020 2020 2020 2020 6f72   path.        or
+00033fe0: 2066 696c 652e 0a0a 2020 2020 2020 2020   file...        
+00033ff0: 5468 6520 6461 7461 2028 616e 6420 7465  The data (and te
+00034000: 7374 2064 6174 6129 2069 7320 4e4f 5420  st data) is NOT 
+00034010: 7361 7665 6420 7769 7468 2074 6865 2065  saved with the e
+00034020: 7870 6572 696d 656e 740a 2020 2020 2020  xperiment.      
+00034030: 2020 616e 6420 7769 6c6c 206e 6565 6420    and will need 
+00034040: 746f 2062 6520 7370 6563 6966 6965 6420  to be specified 
+00034050: 6167 6169 6e2e 0a0a 0a20 2020 2020 2020  again....       
+00034060: 2070 6174 685f 6f72 5f66 696c 653a 2073   path_or_file: s
+00034070: 7472 206f 7220 4269 6e61 7279 494f 2028  tr or BinaryIO (
+00034080: 6669 6c65 2070 6f69 6e74 6572 290a 2020  file pointer).  
+00034090: 2020 2020 2020 2020 2020 5468 6520 7061            The pa
+000340a0: 7468 2f66 696c 6520 706f 696e 7465 7220  th/file pointer 
+000340b0: 746f 206c 6f61 6420 7468 6520 6578 7065  to load the expe
+000340c0: 7269 6d65 6e74 2066 726f 6d2e 0a20 2020  riment from..   
+000340d0: 2020 2020 2020 2020 2054 6865 2070 6963           The pic
+000340e0: 6b6c 6520 6669 6c65 206d 7573 7420 6265  kle file must be
+000340f0: 2063 7265 6174 6564 2074 6872 6f75 6768   created through
+00034100: 2060 6073 6176 655f 6578 7065 7269 6d65   ``save_experime
+00034110: 6e74 6060 2e0a 0a0a 2020 2020 2020 2020  nt``....        
+00034120: 6461 7461 3a20 6461 7461 6672 616d 652d  data: dataframe-
+00034130: 6c69 6b65 0a20 2020 2020 2020 2020 2020  like.           
+00034140: 2044 6174 6120 7365 7420 7769 7468 2073   Data set with s
+00034150: 6861 7065 2028 6e5f 7361 6d70 6c65 732c  hape (n_samples,
+00034160: 206e 5f66 6561 7475 7265 7329 2c20 7768   n_features), wh
+00034170: 6572 6520 6e5f 7361 6d70 6c65 7320 6973  ere n_samples is
+00034180: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
+00034190: 206e 756d 6265 7220 6f66 2073 616d 706c   number of sampl
+000341a0: 6573 2061 6e64 206e 5f66 6561 7475 7265  es and n_feature
+000341b0: 7320 6973 2074 6865 206e 756d 6265 7220  s is the number 
+000341c0: 6f66 2066 6561 7475 7265 732e 2049 6620  of features. If 
+000341d0: 6461 7461 0a20 2020 2020 2020 2020 2020  data.           
+000341e0: 2069 7320 6e6f 7420 6120 7061 6e64 6173   is not a pandas
+000341f0: 2064 6174 6166 7261 6d65 2c20 6974 2773   dataframe, it's
+00034200: 2063 6f6e 7665 7274 6564 2074 6f20 6f6e   converted to on
+00034210: 6520 7573 696e 6720 6465 6661 756c 7420  e using default 
+00034220: 636f 6c75 6d6e 0a20 2020 2020 2020 2020  column.         
+00034230: 2020 206e 616d 6573 2e0a 0a0a 2020 2020     names....    
+00034240: 2020 2020 6461 7461 5f66 756e 633a 2043      data_func: C
+00034250: 616c 6c61 626c 655b 5b5d 2c20 4441 5441  allable[[], DATA
+00034260: 4652 414d 455f 4c49 4b45 5d20 3d20 4e6f  FRAME_LIKE] = No
+00034270: 6e65 0a20 2020 2020 2020 2020 2020 2054  ne.            T
+00034280: 6865 2066 756e 6374 696f 6e20 7468 6174  he function that
+00034290: 2067 656e 6572 6174 6520 6060 6461 7461   generate ``data
+000342a0: 6060 2028 7468 6520 6461 7461 6672 616d  `` (the datafram
+000342b0: 652d 6c69 6b65 2069 6e70 7574 292e 2054  e-like input). T
+000342c0: 6869 730a 2020 2020 2020 2020 2020 2020  his.            
+000342d0: 6973 2075 7365 6675 6c20 7768 656e 2074  is useful when t
+000342e0: 6865 2064 6174 6173 6574 2069 7320 6c61  he dataset is la
+000342f0: 7267 652c 2061 6e64 2079 6f75 206e 6565  rge, and you nee
+00034300: 6420 7061 7261 6c6c 656c 206f 7065 7261  d parallel opera
+00034310: 7469 6f6e 730a 2020 2020 2020 2020 2020  tions.          
+00034320: 2020 7375 6368 2061 7320 6060 636f 6d70    such as ``comp
+00034330: 6172 655f 6d6f 6465 6c73 6060 2e20 4974  are_models``. It
+00034340: 2063 616e 2061 766f 6964 2062 726f 6164   can avoid broad
+00034350: 6361 7374 696e 6720 6c61 7267 6520 6461  casting large da
+00034360: 7461 7365 740a 2020 2020 2020 2020 2020  taset.          
+00034370: 2020 6672 6f6d 2064 7269 7665 7220 746f    from driver to
+00034380: 2077 6f72 6b65 7273 2e20 4e6f 7469 6365   workers. Notice
+00034390: 206f 6e65 2061 6e64 206f 6e6c 7920 6f6e   one and only on
+000343a0: 6520 6f66 2060 6064 6174 6160 6020 616e  e of ``data`` an
+000343b0: 640a 2020 2020 2020 2020 2020 2020 6060  d.            ``
+000343c0: 6461 7461 5f66 756e 6360 6020 6d75 7374  data_func`` must
+000343d0: 2062 6520 7365 742e 0a0a 0a20 2020 2020   be set....     
+000343e0: 2020 2074 6573 745f 6461 7461 3a20 6461     test_data: da
+000343f0: 7461 6672 616d 652d 6c69 6b65 206f 7220  taframe-like or 
+00034400: 4e6f 6e65 2c20 6465 6661 756c 7420 3d20  None, default = 
+00034410: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+00034420: 2049 6620 6e6f 7420 4e6f 6e65 2c20 7465   If not None, te
+00034430: 7374 5f64 6174 6120 6973 2075 7365 6420  st_data is used 
+00034440: 6173 2061 2068 6f6c 642d 6f75 7420 7365  as a hold-out se
+00034450: 7420 616e 6420 6074 7261 696e 5f73 697a  t and `train_siz
+00034460: 6560 2070 6172 616d 6574 6572 0a20 2020  e` parameter.   
+00034470: 2020 2020 2020 2020 2069 7320 6967 6e6f           is igno
+00034480: 7265 642e 2054 6865 2063 6f6c 756d 6e73  red. The columns
+00034490: 206f 6620 6461 7461 2061 6e64 2074 6573   of data and tes
+000344a0: 745f 6461 7461 206d 7573 7420 6d61 7463  t_data must matc
+000344b0: 682e 0a0a 0a20 2020 2020 2020 2070 7265  h....        pre
+000344c0: 7072 6f63 6573 735f 6461 7461 3a20 626f  process_data: bo
+000344d0: 6f6c 2c20 6465 6661 756c 7420 3d20 5472  ol, default = Tr
+000344e0: 7565 0a20 2020 2020 2020 2020 2020 2049  ue.            I
+000344f0: 6620 5472 7565 2c20 7468 6520 6461 7461  f True, the data
+00034500: 2077 696c 6c20 6265 2070 7265 7072 6f63   will be preproc
+00034510: 6573 7365 6420 6167 6169 6e20 2874 6872  essed again (thr
+00034520: 6f75 6768 2072 756e 6e69 6e67 2060 6073  ough running ``s
+00034530: 6574 7570 6060 0a20 2020 2020 2020 2020  etup``.         
+00034540: 2020 2069 6e74 6572 6e61 6c6c 7929 2e20     internally). 
+00034550: 4966 2046 616c 7365 2c20 7468 6520 6461  If False, the da
+00034560: 7461 2077 696c 6c20 6e6f 7420 6265 2070  ta will not be p
+00034570: 7265 7072 6f63 6573 7365 642e 2054 6869  reprocessed. Thi
+00034580: 7320 6d65 616e 730a 2020 2020 2020 2020  s means.        
+00034590: 2020 2020 796f 7520 6361 6e20 7361 7665      you can save
+000345a0: 2074 6865 2076 616c 7565 206f 6620 7468   the value of th
+000345b0: 6520 6060 6461 7461 6060 2061 7474 7269  e ``data`` attri
+000345c0: 6275 7465 206f 6620 616e 2065 7870 6572  bute of an exper
+000345d0: 696d 656e 740a 2020 2020 2020 2020 2020  iment.          
+000345e0: 2020 7365 7061 7261 7465 6c79 2c20 616e    separately, an
+000345f0: 6420 7468 656e 206c 6f61 6420 6974 2073  d then load it s
+00034600: 6570 6172 6174 656c 7920 616e 6420 7061  eparately and pa
+00034610: 7373 2069 7420 6865 7265 2077 6974 680a  ss it here with.
+00034620: 2020 2020 2020 2020 2020 2020 6060 7072              ``pr
+00034630: 6570 726f 6365 7373 5f64 6174 6160 6020  eprocess_data`` 
+00034640: 7365 7420 746f 2046 616c 7365 2e20 5468  set to False. Th
+00034650: 6973 2069 7320 616e 2061 6476 616e 6365  is is an advance
+00034660: 6420 6665 6174 7572 652e 0a20 2020 2020  d feature..     
+00034670: 2020 2020 2020 2057 6520 7265 636f 6d6d         We recomm
+00034680: 656e 6420 6c65 6176 696e 6720 6974 2073  end leaving it s
+00034690: 6574 2074 6f20 5472 7565 2061 6e64 2070  et to True and p
+000346a0: 6173 7369 6e67 2074 6865 2073 616d 6520  assing the same 
+000346b0: 6461 7461 0a20 2020 2020 2020 2020 2020  data.           
+000346c0: 2061 7320 7061 7373 6564 2074 6f20 7468   as passed to th
+000346d0: 6520 696e 6974 6961 6c20 6060 7365 7475  e initial ``setu
+000346e0: 7060 6020 6361 6c6c 2e0a 0a0a 2020 2020  p`` call....    
+000346f0: 2020 2020 2a2a 636c 6f75 6470 6963 6b6c      **cloudpickl
+00034700: 655f 6b77 6172 6773 3a0a 2020 2020 2020  e_kwargs:.      
+00034710: 2020 2020 2020 4b77 6172 6773 2074 6f20        Kwargs to 
+00034720: 7061 7373 2074 6f20 7468 6520 6060 636c  pass to the ``cl
+00034730: 6f75 6470 6963 6b6c 652e 6c6f 6164 6060  oudpickle.load``
+00034740: 2063 616c 6c2e 0a0a 0a20 2020 2020 2020   call....       
+00034750: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
+00034760: 2020 2020 2020 6c6f 6164 6564 2065 7870        loaded exp
+00034770: 6572 696d 656e 740a 0a20 2020 2020 2020  eriment..       
+00034780: 2022 2222 0a0a 2020 2020 2020 2020 7265   """..        re
+00034790: 7475 726e 2063 6c73 2e5f 6c6f 6164 5f65  turn cls._load_e
+000347a0: 7870 6572 696d 656e 7428 0a20 2020 2020  xperiment(.     
+000347b0: 2020 2020 2020 2070 6174 685f 6f72 5f66         path_or_f
+000347c0: 696c 652c 0a20 2020 2020 2020 2020 2020  ile,.           
+000347d0: 2063 6c6f 7564 7069 636b 6c65 5f6b 7761   cloudpickle_kwa
+000347e0: 7267 733d 636c 6f75 6470 6963 6b6c 655f  rgs=cloudpickle_
+000347f0: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+00034800: 2020 2020 7072 6570 726f 6365 7373 5f64      preprocess_d
+00034810: 6174 613d 7072 6570 726f 6365 7373 5f64  ata=preprocess_d
+00034820: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
+00034830: 2064 6174 613d 6461 7461 2c0a 2020 2020   data=data,.    
+00034840: 2020 2020 2020 2020 6461 7461 5f66 756e          data_fun
+00034850: 633d 6461 7461 5f66 756e 632c 0a20 2020  c=data_func,.   
+00034860: 2020 2020 2020 2020 2074 6573 745f 6461           test_da
+00034870: 7461 3d74 6573 745f 6461 7461 2c0a 2020  ta=test_data,.  
+00034880: 2020 2020 2020 290a 0a20 2020 2040 7072        )..    @pr
+00034890: 6f70 6572 7479 0a20 2020 2040 6162 7374  operty.    @abst
+000348a0: 7261 6374 6d65 7468 6f64 0a20 2020 2064  ractmethod.    d
+000348b0: 6566 2058 2873 656c 6629 3a0a 2020 2020  ef X(self):.    
+000348c0: 2020 2020 2222 2246 6561 7475 7265 2073      """Feature s
+000348d0: 6574 2e22 2222 0a20 2020 2020 2020 2070  et.""".        p
+000348e0: 6173 730a 0a20 2020 2040 7072 6f70 6572  ass..    @proper
+000348f0: 7479 0a20 2020 2040 6162 7374 7261 6374  ty.    @abstract
+00034900: 6d65 7468 6f64 0a20 2020 2064 6566 2064  method.    def d
+00034910: 6174 6173 6574 5f74 7261 6e73 666f 726d  ataset_transform
+00034920: 6564 2873 656c 6629 3a0a 2020 2020 2020  ed(self):.      
+00034930: 2020 2222 2254 7261 6e73 666f 726d 6564    """Transformed
+00034940: 2064 6174 6173 6574 2e22 2222 0a20 2020   dataset.""".   
+00034950: 2020 2020 2070 6173 730a 0a20 2020 2040       pass..    @
+00034960: 7072 6f70 6572 7479 0a20 2020 2040 6162  property.    @ab
+00034970: 7374 7261 6374 6d65 7468 6f64 0a20 2020  stractmethod.   
+00034980: 2064 6566 2058 5f74 7261 696e 5f74 7261   def X_train_tra
+00034990: 6e73 666f 726d 6564 2873 656c 6629 3a0a  nsformed(self):.
+000349a0: 2020 2020 2020 2020 2222 2254 7261 6e73          """Trans
+000349b0: 666f 726d 6564 2066 6561 7475 7265 2073  formed feature s
+000349c0: 6574 206f 6620 7468 6520 7472 6169 6e69  et of the traini
+000349d0: 6e67 2073 6574 2e22 2222 0a20 2020 2020  ng set.""".     
+000349e0: 2020 2070 6173 730a 0a20 2020 2040 7072     pass..    @pr
+000349f0: 6f70 6572 7479 0a20 2020 2040 6162 7374  operty.    @abst
+00034a00: 7261 6374 6d65 7468 6f64 0a20 2020 2064  ractmethod.    d
+00034a10: 6566 2074 7261 696e 5f74 7261 6e73 666f  ef train_transfo
+00034a20: 726d 6564 2873 656c 6629 3a0a 2020 2020  rmed(self):.    
+00034a30: 2020 2020 2222 2254 7261 6e73 666f 726d      """Transform
+00034a40: 6564 2074 7261 696e 696e 6720 7365 742e  ed training set.
+00034a50: 2222 220a 2020 2020 2020 2020 7061 7373  """.        pass
+00034a60: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00034a70: 2020 2020 4061 6273 7472 6163 746d 6574      @abstractmet
+00034a80: 686f 640a 2020 2020 6465 6620 585f 7472  hod.    def X_tr
+00034a90: 616e 7366 6f72 6d65 6428 7365 6c66 293a  ansformed(self):
+00034aa0: 0a20 2020 2020 2020 2022 2222 5472 616e  .        """Tran
+00034ab0: 7366 6f72 6d65 6420 6665 6174 7572 6520  sformed feature 
+00034ac0: 7365 742e 2222 220a 2020 2020 2020 2020  set.""".        
+00034ad0: 7061 7373 0a0a 2020 2020 4070 726f 7065  pass..    @prope
+00034ae0: 7274 790a 2020 2020 6465 6620 7928 7365  rty.    def y(se
+00034af0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00034b00: 5461 7267 6574 2063 6f6c 756d 6e2e 2222  Target column.""
+00034b10: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00034b20: 2073 656c 662e 6461 7461 7365 745b 7365   self.dataset[se
+00034b30: 6c66 2e74 6172 6765 745f 7061 7261 6d5d  lf.target_param]
+00034b40: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00034b50: 2020 2020 4061 6273 7472 6163 746d 6574      @abstractmet
+00034b60: 686f 640a 2020 2020 6465 6620 585f 7472  hod.    def X_tr
+00034b70: 6169 6e28 7365 6c66 293a 0a20 2020 2020  ain(self):.     
+00034b80: 2020 2022 2222 4665 6174 7572 6520 7365     """Feature se
+00034b90: 7420 6f66 2074 6865 2074 7261 696e 696e  t of the trainin
+00034ba0: 6720 7365 742e 2222 220a 2020 2020 2020  g set.""".      
+00034bb0: 2020 7061 7373 0a0a 2020 2020 4070 726f    pass..    @pro
+00034bc0: 7065 7274 790a 2020 2020 4061 6273 7472  perty.    @abstr
+00034bd0: 6163 746d 6574 686f 640a 2020 2020 6465  actmethod.    de
+00034be0: 6620 585f 7465 7374 2873 656c 6629 3a0a  f X_test(self):.
+00034bf0: 2020 2020 2020 2020 2222 2246 6561 7475          """Featu
+00034c00: 7265 2073 6574 206f 6620 7468 6520 7465  re set of the te
+00034c10: 7374 2073 6574 2e22 2222 0a20 2020 2020  st set.""".     
+00034c20: 2020 2070 6173 730a 0a20 2020 2040 7072     pass..    @pr
+00034c30: 6f70 6572 7479 0a20 2020 2064 6566 2074  operty.    def t
+00034c40: 7261 696e 2873 656c 6629 3a0a 2020 2020  rain(self):.    
+00034c50: 2020 2020 2222 2254 7261 696e 696e 6720      """Training 
+00034c60: 7365 742e 2222 220a 2020 2020 2020 2020  set.""".        
+00034c70: 7265 7475 726e 2073 656c 662e 6461 7461  return self.data
+00034c80: 7365 742e 6c6f 635b 7365 6c66 2e69 6478  set.loc[self.idx
+00034c90: 5b30 5d2c 203a 5d0a 0a20 2020 2040 7072  [0], :]..    @pr
+00034ca0: 6f70 6572 7479 0a20 2020 2040 6162 7374  operty.    @abst
+00034cb0: 7261 6374 6d65 7468 6f64 0a20 2020 2064  ractmethod.    d
+00034cc0: 6566 2074 6573 7428 7365 6c66 293a 0a20  ef test(self):. 
+00034cd0: 2020 2020 2020 2022 2222 5465 7374 2073         """Test s
+00034ce0: 6574 2e22 2222 0a20 2020 2020 2020 2070  et.""".        p
+00034cf0: 6173 730a 0a20 2020 2040 7072 6f70 6572  ass..    @proper
+00034d00: 7479 0a20 2020 2064 6566 2079 5f74 7261  ty.    def y_tra
+00034d10: 696e 2873 656c 6629 3a0a 2020 2020 2020  in(self):.      
+00034d20: 2020 2222 2254 6172 6765 7420 636f 6c75    """Target colu
+00034d30: 6d6e 206f 6620 7468 6520 7472 6169 6e69  mn of the traini
+00034d40: 6e67 2073 6574 2e22 2222 0a20 2020 2020  ng set.""".     
+00034d50: 2020 2072 6574 7572 6e20 7365 6c66 2e74     return self.t
+00034d60: 7261 696e 5b73 656c 662e 7461 7267 6574  rain[self.target
+00034d70: 5f70 6172 616d 5d0a 0a20 2020 2040 7072  _param]..    @pr
+00034d80: 6f70 6572 7479 0a20 2020 2064 6566 2079  operty.    def y
+00034d90: 5f74 6573 7428 7365 6c66 293a 0a20 2020  _test(self):.   
+00034da0: 2020 2020 2022 2222 5461 7267 6574 2063       """Target c
+00034db0: 6f6c 756d 6e20 6f66 2074 6865 2074 6573  olumn of the tes
+00034dc0: 7420 7365 742e 2222 220a 2020 2020 2020  t set.""".      
+00034dd0: 2020 7265 7475 726e 2073 656c 662e 7465    return self.te
+00034de0: 7374 5b73 656c 662e 7461 7267 6574 5f70  st[self.target_p
+00034df0: 6172 616d 5d0a 0a20 2020 2040 7072 6f70  aram]..    @prop
+00034e00: 6572 7479 0a20 2020 2040 6162 7374 7261  erty.    @abstra
+00034e10: 6374 6d65 7468 6f64 0a20 2020 2064 6566  ctmethod.    def
+00034e20: 2074 6573 745f 7472 616e 7366 6f72 6d65   test_transforme
+00034e30: 6428 7365 6c66 293a 0a20 2020 2020 2020  d(self):.       
+00034e40: 2022 2222 5472 616e 7366 6f72 6d65 6420   """Transformed 
+00034e50: 7465 7374 2073 6574 2e22 2222 0a20 2020  test set.""".   
+00034e60: 2020 2020 2070 6173 730a 0a20 2020 2040       pass..    @
+00034e70: 7072 6f70 6572 7479 0a20 2020 2040 6162  property.    @ab
+00034e80: 7374 7261 6374 6d65 7468 6f64 0a20 2020  stractmethod.   
+00034e90: 2064 6566 2079 5f74 7261 6e73 666f 726d   def y_transform
+00034ea0: 6564 2873 656c 6629 3a0a 2020 2020 2020  ed(self):.      
+00034eb0: 2020 2222 2254 7261 6e73 666f 726d 6564    """Transformed
+00034ec0: 2074 6172 6765 7420 636f 6c75 6d6e 2e22   target column."
+00034ed0: 2222 0a20 2020 2020 2020 2070 6173 730a  "".        pass.
+00034ee0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00034ef0: 2020 2040 6162 7374 7261 6374 6d65 7468     @abstractmeth
+00034f00: 6f64 0a20 2020 2064 6566 2058 5f74 6573  od.    def X_tes
+00034f10: 745f 7472 616e 7366 6f72 6d65 6428 7365  t_transformed(se
+00034f20: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00034f30: 5472 616e 7366 6f72 6d65 6420 6665 6174  Transformed feat
+00034f40: 7572 6520 7365 7420 6f66 2074 6865 2074  ure set of the t
+00034f50: 6573 7420 7365 742e 2222 220a 2020 2020  est set.""".    
+00034f60: 2020 2020 7061 7373 0a0a 2020 2020 4070      pass..    @p
+00034f70: 726f 7065 7274 790a 2020 2020 4061 6273  roperty.    @abs
+00034f80: 7472 6163 746d 6574 686f 640a 2020 2020  tractmethod.    
+00034f90: 6465 6620 795f 7472 6169 6e5f 7472 616e  def y_train_tran
+00034fa0: 7366 6f72 6d65 6428 7365 6c66 293a 0a20  sformed(self):. 
+00034fb0: 2020 2020 2020 2022 2222 5472 616e 7366         """Transf
+00034fc0: 6f72 6d65 6420 7461 7267 6574 2063 6f6c  ormed target col
+00034fd0: 756d 6e20 6f66 2074 6865 2074 7261 696e  umn of the train
+00034fe0: 696e 6720 7365 742e 2222 220a 2020 2020  ing set.""".    
+00034ff0: 2020 2020 7061 7373 0a0a 2020 2020 4070      pass..    @p
+00035000: 726f 7065 7274 790a 2020 2020 4061 6273  roperty.    @abs
+00035010: 7472 6163 746d 6574 686f 640a 2020 2020  tractmethod.    
+00035020: 6465 6620 795f 7465 7374 5f74 7261 6e73  def y_test_trans
+00035030: 666f 726d 6564 2873 656c 6629 3a0a 2020  formed(self):.  
+00035040: 2020 2020 2020 2222 2254 7261 6e73 666f        """Transfo
+00035050: 726d 6564 2074 6172 6765 7420 636f 6c75  rmed target colu
+00035060: 6d6e 206f 6620 7468 6520 7465 7374 2073  mn of the test s
+00035070: 6574 2e22 2222 0a20 2020 2020 2020 2070  et.""".        p
+00035080: 6173 730a                                ass.
```

## pycaret/internal/pycaret_experiment/tabular_experiment.py

```diff
@@ -353,15 +353,16 @@
                     cuml.common.memory_utils.set_global_output_type("numpy")
                 except Exception:
                     self.logger.exception("Couldn't set cuML global output type")
 
             if cuml_version is None or not version.parse(cuml_version) >= version.parse(
                 "22.10"
             ):
-                message = f"cuML is outdated or not found. Required version is >=22.10, got {__version__}"
+                message = """cuML is outdated or not found. Required version is >=22.10.
+                Please visit https://rapids.ai/ for installation instructions."""
                 if use_gpu == "force":
                     raise ImportError(message)
                 else:
                     self.logger.warning(message)
 
         return self
 
@@ -387,15 +388,14 @@
         label: bool = False,
         use_train_data: bool = False,
         verbose: bool = True,
         system: bool = True,
         display: Optional[CommonDisplay] = None,  # added in pycaret==2.2.0
         display_format: Optional[str] = None,
     ) -> str:
-
         """Internal version of ``plot_model`` with ``system`` arg."""
         self._check_setup_ran()
 
         function_params_str = ", ".join([f"{k}={v}" for k, v in locals().items()])
 
         self.logger.info("Initializing plot_model()")
         self.logger.info(f"plot_model({function_params_str})")
@@ -542,15 +542,14 @@
             with patch(
                 "yellowbrick.utils.helpers.is_estimator",
                 pycaret.internal.patches.yellowbrick.is_estimator,
             ):
                 _base_dpi = 100
 
                 def pipeline():
-
                     from schemdraw import Drawing
                     from schemdraw.flow import Arrow, Data, RoundBox, Subroutine
 
                     # Create schematic drawing
                     d = Drawing(backend="matplotlib")
                     d.config(fontsize=plot_kwargs.get("fontsize", 14))
                     d += Subroutine(w=10, h=5, s=1).label("Raw data").drop("E")
@@ -922,15 +921,14 @@
                     df = X_embedded
 
                     # display.clear_output()
 
                     self.logger.info("Rendering Visual")
 
                     if label:
-
                         fig = px.scatter_3d(
                             df,
                             x=0,
                             y=1,
                             z=2,
                             color="Cluster",
                             title="3d TSNE Plot for Clusters",
@@ -1120,15 +1118,14 @@
                         )
                     except Exception:
                         self.logger.error("Distance plot failed. Exception:")
                         self.logger.error(traceback.format_exc())
                         raise TypeError("Plot Type not supported for this model.")
 
                 def residuals():
-
                     from yellowbrick.regressor import ResidualsPlot
 
                     visualizer = ResidualsPlot(estimator, **plot_kwargs)
                     return show_yellowbrick_plot(
                         visualizer=visualizer,
                         X_train=self.X_train_transformed,
                         y_train=self.y_train_transformed,
@@ -1138,15 +1135,14 @@
                         scale=scale,
                         save=save,
                         fit_kwargs=fit_kwargs,
                         display_format=display_format,
                     )
 
                 def auc():
-
                     from yellowbrick.classifier import ROCAUC
 
                     visualizer = ROCAUC(estimator, **plot_kwargs)
                     return show_yellowbrick_plot(
                         visualizer=visualizer,
                         X_train=self.X_train_transformed,
                         y_train=self.y_train_transformed,
@@ -1156,15 +1152,14 @@
                         scale=scale,
                         save=save,
                         fit_kwargs=fit_kwargs,
                         display_format=display_format,
                     )
 
                 def threshold():
-
                     from yellowbrick.classifier import DiscriminationThreshold
 
                     visualizer = DiscriminationThreshold(
                         estimator, random_state=self.seed, **plot_kwargs
                     )
                     return show_yellowbrick_plot(
                         visualizer=visualizer,
@@ -1176,15 +1171,14 @@
                         scale=scale,
                         save=save,
                         fit_kwargs=fit_kwargs,
                         display_format=display_format,
                     )
 
                 def pr():
-
                     from yellowbrick.classifier import PrecisionRecallCurve
 
                     visualizer = PrecisionRecallCurve(
                         estimator, random_state=self.seed, **plot_kwargs
                     )
                     return show_yellowbrick_plot(
                         visualizer=visualizer,
@@ -1196,15 +1190,14 @@
                         scale=scale,
                         save=save,
                         fit_kwargs=fit_kwargs,
                         display_format=display_format,
                     )
 
                 def confusion_matrix():
-
                     from yellowbrick.classifier import ConfusionMatrix
 
                     plot_kwargs.setdefault("fontsize", 15)
                     plot_kwargs.setdefault("cmap", "Greens")
 
                     visualizer = ConfusionMatrix(
                         estimator, random_state=self.seed, **plot_kwargs
@@ -1219,15 +1212,14 @@
                         scale=scale,
                         save=save,
                         fit_kwargs=fit_kwargs,
                         display_format=display_format,
                     )
 
                 def error():
-
                     if self._ml_usecase == MLUsecase.CLASSIFICATION:
                         from yellowbrick.classifier import ClassPredictionError
 
                         visualizer = ClassPredictionError(
                             estimator, random_state=self.seed, **plot_kwargs
                         )
 
@@ -1248,15 +1240,14 @@
                         scale=scale,
                         save=save,
                         fit_kwargs=fit_kwargs,
                         display_format=display_format,
                     )
 
                 def cooks():
-
                     from yellowbrick.regressor import CooksDistance
 
                     visualizer = CooksDistance()
                     return show_yellowbrick_plot(
                         visualizer=visualizer,
                         X_train=self.X_train_transformed,
                         y_train=self.y_train_transformed,
@@ -1267,15 +1258,14 @@
                         save=save,
                         fit_kwargs=fit_kwargs,
                         handle_test="",
                         display_format=display_format,
                     )
 
                 def class_report():
-
                     from yellowbrick.classifier import ClassificationReport
 
                     visualizer = ClassificationReport(
                         estimator, random_state=self.seed, support=True, **plot_kwargs
                     )
                     return show_yellowbrick_plot(
                         visualizer=visualizer,
@@ -1287,15 +1277,14 @@
                         scale=scale,
                         save=save,
                         fit_kwargs=fit_kwargs,
                         display_format=display_format,
                     )
 
                 def boundary():
-
                     from sklearn.decomposition import PCA
                     from sklearn.preprocessing import StandardScaler
                     from yellowbrick.contrib.classifier import DecisionViz
 
                     data_X_transformed = self.X_train_transformed.select_dtypes(
                         include="number"
                     )
@@ -1328,15 +1317,14 @@
                         fit_kwargs=fit_kwargs,
                         features=["Feature One", "Feature Two"],
                         classes=["A", "B"],
                         display_format=display_format,
                     )
 
                 def rfe():
-
                     from yellowbrick.model_selection import RFECV
 
                     visualizer = RFECV(estimator, cv=cv, groups=groups, **plot_kwargs)
                     return show_yellowbrick_plot(
                         visualizer=visualizer,
                         X_train=self.X_train_transformed,
                         y_train=self.y_train_transformed,
@@ -1347,15 +1335,14 @@
                         scale=scale,
                         save=save,
                         fit_kwargs=fit_kwargs,
                         display_format=display_format,
                     )
 
                 def learning():
-
                     from yellowbrick.model_selection import LearningCurve
 
                     sizes = np.linspace(0.3, 1.0, 10)
                     visualizer = LearningCurve(
                         estimator,
                         cv=cv,
                         train_sizes=sizes,
@@ -1374,15 +1361,14 @@
                         scale=scale,
                         save=save,
                         fit_kwargs=fit_kwargs,
                         display_format=display_format,
                     )
 
                 def lift():
-
                     self.logger.info("Generating predictions / predict_proba on X_test")
                     y_test__ = self.y_test_transformed
                     predict_proba__ = estimator.predict_proba(self.X_test_transformed)
                     # display.clear_output()
                     with MatplotlibDefaultDPI(base_dpi=_base_dpi, scale_to_set=scale):
                         skplt.metrics.plot_lift_curve(
                             y_test__, predict_proba__, figsize=(10, 6)
@@ -1399,15 +1385,14 @@
                             plt.show()
                         plt.close()
 
                     self.logger.info("Visual Rendered Successfully")
                     return plot_filename
 
                 def gain():
-
                     self.logger.info("Generating predictions / predict_proba on X_test")
                     y_test__ = self.y_test_transformed
                     predict_proba__ = estimator.predict_proba(self.X_test_transformed)
                     # display.clear_output()
                     with MatplotlibDefaultDPI(base_dpi=_base_dpi, scale_to_set=scale):
                         skplt.metrics.plot_cumulative_gain(
                             y_test__, predict_proba__, figsize=(10, 6)
@@ -1424,15 +1409,14 @@
                             plt.show()
                         plt.close()
 
                     self.logger.info("Visual Rendered Successfully")
                     return plot_filename
 
                 def manifold():
-
                     from yellowbrick.features import Manifold
 
                     data_X_transformed = self.X_train_transformed.select_dtypes(
                         include="number"
                     )
                     visualizer = Manifold(
                         manifold="tsne", random_state=self.seed, **plot_kwargs
@@ -1449,15 +1433,14 @@
                         scale=scale,
                         save=save,
                         fit_kwargs=fit_kwargs,
                         display_format=display_format,
                     )
 
                 def tree():
-
                     from sklearn.tree import plot_tree
 
                     is_stacked_model = False
                     is_ensemble_of_forests = False
 
                     if isinstance(estimator, Pipeline):
                         fitted_estimator = estimator._final_estimator
@@ -1500,23 +1483,22 @@
                     axes = list(axes.flatten())
 
                     fig.suptitle("Decision Trees")
 
                     self.logger.info("Plotting decision trees")
                     trees = []
                     feature_names = list(self.X_train_transformed.columns)
+                    class_names = None
                     if self._ml_usecase == MLUsecase.CLASSIFICATION:
-                        class_names = {
-                            i: class_name
-                            for i, class_name in enumerate(
-                                get_label_encoder(self.pipeline).classes_
-                            )
-                        }
-                    else:
-                        class_names = None
+                        label_encoder = get_label_encoder(self.pipeline)
+                        if label_encoder:
+                            class_names = {
+                                i: class_name
+                                for i, class_name in enumerate(label_encoder.classes_)
+                            }
                     fitted_estimator = tree_estimator
                     if is_stacked_model:
                         stacked_feature_names = []
                         if self._ml_usecase == MLUsecase.CLASSIFICATION:
                             classes = list(self.y_train_transformed.unique())
                             if len(classes) == 2:
                                 classes.pop()
@@ -1574,15 +1556,14 @@
                         plt.show()
                     plt.close()
 
                     self.logger.info("Visual Rendered Successfully")
                     return plot_filename
 
                 def calibration():
-
                     from sklearn.calibration import calibration_curve
 
                     plt.figure(figsize=(7, 6), dpi=_base_dpi * scale)
                     ax1 = plt.subplot2grid((3, 1), (0, 0), rowspan=2)
 
                     ax1.plot([0, 1], [0, 1], "k:", label="Perfectly calibrated")
                     self.logger.info("Scoring test/hold-out set")
@@ -1622,15 +1603,14 @@
                         plt.show()
                     plt.close()
 
                     self.logger.info("Visual Rendered Successfully")
                     return plot_filename
 
                 def vc():
-
                     self.logger.info("Determining param_name")
 
                     try:
                         try:
                             # catboost special case
                             model_params = estimator.get_all_params()
                         except Exception:
@@ -1643,15 +1623,14 @@
                             "Plot not supported for this estimator. Try different estimator."
                         )
 
                     param_name = ""
                     param_range = None
 
                     if self._ml_usecase == MLUsecase.CLASSIFICATION:
-
                         # Catboost
                         if "depth" in model_params:
                             param_name = "depth"
                             param_range = np.arange(1, 8 if self.gpu_param else 11)
 
                         # SGD Classifier
                         elif "l1_ratio" in model_params:
@@ -1701,15 +1680,14 @@
                         else:
                             # display.clear_output()
                             raise TypeError(
                                 "Plot not supported for this estimator. Try different estimator."
                             )
 
                     elif self._ml_usecase == MLUsecase.REGRESSION:
-
                         # Catboost
                         if "depth" in model_params:
                             param_name = "depth"
                             param_range = np.arange(1, 8 if self.gpu_param else 11)
 
                         # lasso/ridge/en/llar/huber/kr/mlp/br/ard
                         elif "alpha" in model_params:
@@ -1792,15 +1770,14 @@
                         scale=scale,
                         save=save,
                         fit_kwargs=fit_kwargs,
                         display_format=display_format,
                     )
 
                 def dimension():
-
                     from sklearn.decomposition import PCA
                     from sklearn.preprocessing import StandardScaler
                     from yellowbrick.features import RadViz
 
                     data_X_transformed = self.X_train_transformed.select_dtypes(
                         include="number"
                     )
@@ -1896,15 +1873,14 @@
                         plt.show()
                     plt.close()
 
                     self.logger.info("Visual Rendered Successfully")
                     return plot_filename
 
                 def parameter():
-
                     try:
                         params = estimator.get_all_params()
                     except Exception:
                         params = estimator.get_params(deep=False)
 
                     param_df = pd.DataFrame.from_dict(
                         {str(k): str(v) for k, v in params.items()},
@@ -1912,15 +1888,14 @@
                         columns=["Parameters"],
                     )
                     # use ipython directly to show it in the widget
                     ipython_display(param_df)
                     self.logger.info("Visual Rendered Successfully")
 
                 def ks():
-
                     self.logger.info("Generating predictions / predict_proba on X_test")
                     predict_proba__ = estimator.predict_proba(self.X_train_transformed)
                     # display.clear_output()
                     with MatplotlibDefaultDPI(base_dpi=_base_dpi, scale_to_set=scale):
                         skplt.metrics.plot_ks_statistic(
                             self.y_train_transformed, predict_proba__, figsize=(10, 6)
                         )
@@ -1973,15 +1948,14 @@
         groups: Optional[Union[str, Any]] = None,
         feature_name: Optional[str] = None,
         label: bool = False,
         use_train_data: bool = False,
         verbose: bool = True,
         display_format: Optional[str] = None,
     ) -> Optional[str]:
-
         """
         This function takes a trained model object and returns a plot based on the
         test / hold-out set. The process may require the model to be re-trained in
         certain cases. See list of plots supported below.
 
         Model must be created using create_model() or tune_model().
 
@@ -2097,15 +2071,14 @@
         fold: Optional[Union[int, Any]] = None,
         fit_kwargs: Optional[dict] = None,
         plot_kwargs: Optional[dict] = None,
         feature_name: Optional[str] = None,
         groups: Optional[Union[str, Any]] = None,
         use_train_data: bool = False,
     ):
-
         """
         This function displays a user interface for all of the available plots for
         a given estimator. It internally uses the plot_model() function.
 
         Example
         -------
         >>> from pycaret.datasets import get_data
@@ -2199,15 +2172,14 @@
 
     def models(
         self,
         type: Optional[str] = None,
         internal: bool = False,
         raise_errors: bool = True,
     ) -> pd.DataFrame:
-
         """
         Returns table of models available in model library.
 
         Example
         -------
         >>> _all_models = models()
 
@@ -2252,15 +2224,14 @@
     def deploy_model(
         self,
         model,
         model_name: str,
         authentication: dict,
         platform: str = "aws",  # added gcp and azure support in pycaret==2.1
     ):
-
         """
         (In Preview)
 
         This function deploys the transformation pipeline and trained model object for
         production use. The platform of deployment can be defined under the platform
         parameter along with the applicable authentication tokens which are passed as a
         dictionary to the authentication param.
@@ -2423,15 +2394,14 @@
     def load_model(
         self,
         model_name: str,
         platform: Optional[str] = None,
         authentication: Optional[Dict[str, str]] = None,
         verbose: bool = True,
     ):
-
         """
         This function loads a previously saved transformation pipeline and model
         from the current active directory into the current python environment.
         Load object must be a pickle file.
 
         Example
         -------
@@ -2558,15 +2528,14 @@
         else:
             raise ValueError(
                 f"Wrong language {language}. Expected one of 'python', 'java', 'c', 'c#', 'dart', "
                 "'f#', 'go', 'haskell', 'javascript', 'php', 'powershell', 'r', 'ruby', 'vb'."
             )
 
     def create_api(self, estimator, api_name, host="127.0.0.1", port=8000):
-
         """
         This function takes an input ``estimator`` and creates a POST API for
         inference. It only creates the API and doesn't run it automatically.
         To run the API, you must run the Python file using ``!python``.
 
 
         Example
@@ -2600,15 +2569,15 @@
             None
         """
         _check_soft_dependencies("fastapi", extra="mlops", severity="error")
         _check_soft_dependencies("uvicorn", extra="mlops", severity="error")
         _check_soft_dependencies("pydantic", extra="mlops", severity="error")
 
         self.save_model(estimator, model_name=api_name, verbose=False)
-        target = f"{self.target_param}_prediction"
+        target = "prediction"
 
         query = f"""# -*- coding: utf-8 -*-
 
 import pandas as pd
 from pycaret.{self._ml_usecase.name.lower()} import load_model, predict_model
 from fastapi import FastAPI
 import uvicorn
```

## pycaret/internal/pycaret_experiment/unsupervised_experiment.py

```diff
@@ -77,15 +77,15 @@
                 runtime,
             )
 
     def setup(
         self,
         data: Optional[DATAFRAME_LIKE] = None,
         data_func: Optional[Callable[[], Union[pd.Series, pd.DataFrame]]] = None,
-        index: Union[bool, int, str, SEQUENCE_LIKE] = False,
+        index: Union[bool, int, str, SEQUENCE_LIKE] = True,
         ordinal_features: Optional[Dict[str, list]] = None,
         numeric_features: Optional[List[str]] = None,
         categorical_features: Optional[List[str]] = None,
         date_features: Optional[List[str]] = None,
         text_features: Optional[List[str]] = None,
         ignore_features: Optional[List[str]] = None,
         keep_features: Optional[List[str]] = None,
@@ -100,14 +100,15 @@
         rare_to_value: Optional[float] = None,
         rare_value: str = "rare",
         polynomial_features: bool = False,
         polynomial_degree: int = 2,
         low_variance_threshold: Optional[float] = None,
         group_features: Optional[list] = None,
         group_names: Optional[Union[str, list]] = None,
+        drop_groups: bool = False,
         remove_multicollinearity: bool = False,
         multicollinearity_threshold: float = 0.9,
         bin_numeric_features: Optional[List[str]] = None,
         remove_outliers: bool = False,
         outliers_method: str = "iforest",
         outliers_threshold: float = 0.05,
         transformation: bool = False,
@@ -163,15 +164,15 @@
         data_func: Callable[[], DATAFRAME_LIKE] = None
             The function that generate ``data`` (the dataframe-like input). This
             is useful when the dataset is large, and you need parallel operations
             such as ``compare_models``. It can avoid broadcasting large dataset
             from driver to workers. Notice one and only one of ``data`` and
             ``data_func`` must be set.
 
-        index: bool, int, str or sequence, default = False
+        index: bool, int, str or sequence, default = True
             Handle indices in the `data` dataframe.
                 - If False: Reset to RangeIndex.
                 - If True: Keep the provided index.
                 - If int: Position of the column to use as index.
                 - If str: Name of the column to use as index.
                 - If sequence: Array with shape=(n_samples,) to use as index.
 
@@ -297,26 +298,30 @@
             threshold. If 0, keep all features with non-zero variance, i.e. remove
             the features that have the same value in all samples. If None, skip
             this transformation step.
 
 
         group_features: list, list of lists or None, default = None
             When the dataset contains features with related characteristics,
-            replace those fetaures with the following statistical properties
-            of that group: min, max, mean, std, median and mode. The parameter
-            takes a list of feature names or a list of lists of feature names
-            to specify multiple groups.
+            add new fetaures with the following statistical properties of that
+            group: min, max, mean, std, median and mode. The parameter takes a
+            list of feature names or a list of lists of feature names to specify
+            multiple groups.
 
 
         group_names: str, list, or None, default = None
             Group names to be used when naming the new features. The length
             should match with the number of groups specified in ``group_features``.
             If None, new features are named using the default form, e.g. group_1,
             group_2, etc... Ignored when ``group_features`` is None.
 
+        drop_groups: bool, default=False
+            Whether to drop the original features in the group. Ignored when
+            ``group_features`` is None.
+
 
         remove_multicollinearity: bool, default = False
             When set to True, features with the inter-correlations higher than
             the defined threshold are removed. For each group, it removes all
             except the first feature.
 
 
@@ -612,15 +617,15 @@
 
             # Drop features with too low variance
             if low_variance_threshold is not None:
                 self._low_variance(low_variance_threshold)
 
             # Get statistical properties of a group of features
             if group_features:
-                self._group_features(group_features, group_names)
+                self._group_features(group_features, group_names, drop_groups)
 
             # Drop features that are collinear with other features
             if remove_multicollinearity:
                 self._remove_multicollinearity(multicollinearity_threshold)
 
             # Bin numerical features to 5 clusters
             if bin_numeric_features:
```

## pycaret/internal/tests/stats.py

```diff
@@ -43,28 +43,28 @@
     )
 
     # Step 2: Test all data ----
     results_list = []
     for data_, name_ in zip(diff_list, name_list):
         # Step 2A: Get Test Results ----
         distinct_counts = dict(data_.value_counts(normalize=True))
-        results = {
+        results_dict = {
             "Length": len(data_),
             "# Missing Values": data_.isna().sum(),
             "Mean": data_.mean(),
             "Median": data_.median(),
             "Standard Deviation": data_.std(),
             "Variance": data_.var(),
             "Kurtosis": data_.kurt(),
             "Skewness": data_.skew(),
             "# Distinct Values": len(distinct_counts),
         }
 
         # Step 2B: Create Result DataFrame ----
-        results = pd.DataFrame(results, index=["Value"]).T.reset_index()
+        results = pd.DataFrame(results_dict, index=["Value"]).T.reset_index()
         results["Data"] = name_
 
         # Step 2C: Update list of all results ----
         results_list.append(results)
 
     # Step 3: Combine all results ----
     results = pd.concat(results_list)
@@ -133,19 +133,19 @@
             continue
 
         # Step 2B: Get Test Results ----
         p_value = shapiro(data_.values.squeeze())[1]
         is_gaussian = True if p_value > alpha else False
 
         # Step 2C: Create Result DataFrame ----
-        results = {
+        results_dict = {
             "Normality": is_gaussian,
             "p-value": p_value,
         }
-        results = pd.DataFrame(results, index=["Value"]).T.reset_index()
+        results = pd.DataFrame(results_dict, index=["Value"]).T.reset_index()
         results["Data"] = name_
 
         # Step 2D: Update list of all results ----
         results_list.append(results)
         is_gaussian_list.append(is_gaussian)
 
     # Step 3: Combine all results ----
```

## pycaret/internal/tests/time_series.py

```diff
@@ -291,24 +291,24 @@
 
         test_statistic = results_[0]
         critical_values = results_[4]
         p_value = results_[1]
         is_stationary = True if p_value < alpha else False
 
         # Step 2C: Create Result DataFrame ----
-        results = {
+        results_dict = {
             "Stationarity": is_stationary,
             "p-value": p_value,
             "Test Statistic": test_statistic,
         }
         critical_values = {
             f"Critical Value {key}": value for key, value in critical_values.items()
         }
-        results.update(critical_values)
-        results = pd.DataFrame(results, index=["Value"]).T.reset_index()
+        results_dict.update(critical_values)
+        results = pd.DataFrame(results_dict, index=["Value"]).T.reset_index()
         results["Data"] = name_
 
         # Step 2D: Update list of all results ----
         results_list.append(results)
         is_stationary_list.append(is_stationary)
 
     # Step 3: Combine all results ----
@@ -405,24 +405,24 @@
                 raise ValueError()
         test_statistic = results_[0]
         p_value = results_[1]
         critical_values = results_[3]
         is_stationary = False if p_value < alpha else True
 
         # Step 2C: Create Result DataFrame ----
-        results = {
+        results_dict = {
             "Trend Stationarity": is_stationary,
             "p-value": p_value,
             "Test Statistic": test_statistic,
         }
         critical_values = {
             f"Critical Value {key}": value for key, value in critical_values.items()
         }
-        results.update(critical_values)
-        results = pd.DataFrame(results, index=["Value"]).T.reset_index()
+        results_dict.update(critical_values)
+        results = pd.DataFrame(results_dict, index=["Value"]).T.reset_index()
         results["Data"] = name_
 
         # Step 2D: Update list of all results ----
         results_list.append(results)
         is_stationary_list.append(is_stationary)
 
     # Step 3: Combine all results ----
```

## pycaret/loggers/base_logger.py

```diff
@@ -1,14 +1,17 @@
 from abc import ABC
+from copy import deepcopy
+
+from sklearn.pipeline import Pipeline
 
 SETUP_TAG = "Session Initialized"
 
 
 class BaseLogger(ABC):
-    def init_logger():
+    def init_logger(self):
         pass
 
     def __del__(self):
         try:
             self.finish_experiment()
         except Exception:
             pass
@@ -21,14 +24,23 @@
 
     def init_experiment(self, exp_name_log, full_name=None, setup=True, **kwargs):
         pass
 
     def set_tags(self, source, experiment_custom_tags, runtime):
         pass
 
+    def _construct_pipeline_if_needed(model, prep_pipe: Pipeline) -> Pipeline:
+        """If model is a pipeline, return it, else append model to copy of prep_pipe."""
+        if not isinstance(model, Pipeline):
+            prep_pipe_temp = deepcopy(prep_pipe)
+            prep_pipe_temp.steps.append(["trained_model", model])
+        else:
+            prep_pipe_temp = model
+        return prep_pipe_temp
+
     def log_sklearn_pipeline(self, experiment, prep_pipe, model, path=None):
         pass
 
     def log_model_comparison(self, model_result, source):
         pass
 
     def log_metrics(self, metrics, source=None):
```

## pycaret/loggers/comet_logger.py

```diff
@@ -1,30 +1,33 @@
 from copy import deepcopy
 from pathlib import Path
 
 import joblib
 
 from pycaret.loggers.base_logger import BaseLogger
 
-try:
-    import comet_ml
-except ImportError:
-    comet_ml = None
-
 
 class CometLogger(BaseLogger):
     def __init__(self) -> None:
+        # lazy import to avoid comet logging
+        try:
+            import comet_ml
+        except ImportError:
+            comet_ml = None
+
         if comet_ml is None:
             raise ImportError(
                 "CometLogger requires Comet. Install using `pip install comet_ml`"
             )
         super().__init__()
         self.run = None
 
     def init_experiment(self, exp_name_log, full_name=None, setup=True, **kwargs):
+        import comet_ml
+
         self.run = comet_ml.Experiment(project_name=exp_name_log, **kwargs)
         self.run.set_name(full_name)
         self.run.log_other("Created from", "pycaret")
         return self.run
 
     def log_params(self, params, model_name=None):
         self.run.log_parameters(params, prefix=model_name)
@@ -32,26 +35,25 @@
     def set_tags(self, source, experiment_custom_tags, runtime):
         tags = [source, runtime]
         self.run.add_tags(tags)
         if experiment_custom_tags:
             self.run.log_others(experiment_custom_tags)
 
     def log_sklearn_pipeline(self, experiment, prep_pipe, model, path=None):
-        pipeline = deepcopy(prep_pipe)
-        pipeline.steps.append(["trained_model", model])
+        pipeline = self._construct_pipeline_if_needed(model, prep_pipe)
         joblib.dump(pipeline, "pipeline.pkl")
         self.run.log_model(name="model", file_or_folder="pipeline.pkl")
 
     def log_model_comparison(self, model_result, source):
         result_copy = deepcopy(model_result)
         if "Object" in result_copy:
             result_copy["Object"] = result_copy["Object"].apply(
                 lambda obj: str(type(obj).__name__)
             )
-        self.run.log_metrics({source: result_copy})
+        self.run.log_table("compare.csv", result_copy)
 
     def log_metrics(self, metrics, source=None):
         self.run.log_metrics(metrics)
 
     def log_plot(self, plot, title):
         self.run.log_figure(figure=plot, figure_name=title)
```

## pycaret/loggers/mlflow_logger.py

```diff
@@ -1,12 +1,10 @@
 import secrets
 from contextlib import contextmanager
-from copy import deepcopy
 
-from pycaret import __version__
 from pycaret.loggers.base_logger import BaseLogger
 from pycaret.utils.generic import mlflow_remove_bad_chars
 
 try:
     import mlflow
     import mlflow.sklearn
     from mlflow.tracking.fluent import _active_run_stack
@@ -126,14 +124,16 @@
     def log_hpram_grid(self, html_file, title="hpram_grid"):
         self.log_artifact(html_file)
 
     def log_sklearn_pipeline(self, experiment, prep_pipe, model, path=None):
         # get default conda env
         from mlflow.sklearn import get_default_conda_env
 
+        from pycaret import __version__
+
         default_conda_env = get_default_conda_env()
         default_conda_env["name"] = f"{experiment.exp_name_log}-env"
         default_conda_env.get("dependencies").pop(-3)
         dependencies = default_conda_env.get("dependencies")[-1]
 
         dep = f"pycaret=={__version__}"
         dependencies["pip"] = [dep]
@@ -152,17 +152,15 @@
         #     input_example = (
         #         data_before_preprocess.drop([target_param], axis=1).iloc[0].to_dict()
         #     )
         # else:
         #     input_example = data_before_preprocess.iloc[0].to_dict()
 
         # log model as sklearn flavor
-        prep_pipe_temp = deepcopy(prep_pipe)
-        prep_pipe_temp.steps.append(["trained_model", model])
         with set_active_mlflow_run(self.active_run):
             mlflow.sklearn.log_model(
-                prep_pipe_temp,
+                self._construct_pipeline_if_needed(model, prep_pipe),
                 "model",
                 conda_env=default_conda_env,
                 # signature=signature,
                 # input_example=input_example,
             )
```

## pycaret/loggers/wandb_logger.py

```diff
@@ -56,16 +56,15 @@
         if extension == "html":
             self.run.log({file_name: wandb.Html(file)})
         elif extension == "csv":
             self.run.log({file_name: pd.read_csv(file)})
 
     def log_sklearn_pipeline(self, experiment, prep_pipe, model, path=None):
         path = path or ""
-        pipeline = deepcopy(prep_pipe)
-        pipeline.steps.append(["trained_model", model])
+        pipeline = self._construct_pipeline_if_needed(model, prep_pipe)
         art = wandb.Artifact("pipeline", type="model")
         with art.new_file(os.path.join(path, "pipeline.pkl")) as f:
             f.write(pipeline)
         self.run.log_artifact(art)
 
     def log_model_comparison(self, model_result, source):
         result_copy = deepcopy(model_result)
```

## pycaret/parallel/fugue_backend.py

```diff
@@ -118,15 +118,16 @@
         self._display_remote = display_remote
         self._top_only = top_only
         self._func: Optional[Callable] = None
         self._params: Optional[Dict[str, Any]] = None
 
     def __getstate__(self) -> Dict[str, Any]:
         res = dict(self.__dict__)
-        del res["_engine"]
+        if "_engine" in res:
+            del res["_engine"]
         return res
 
     def compare_models(
         self, instance: Any, params: Dict[str, Any]
     ) -> Union[Any, List[Any]]:
         self._params = dict(params)
         assert "include" in self._params
```

## pycaret/regression/functional.py

```diff
@@ -21,15 +21,15 @@
 }
 
 
 def setup(
     data: Optional[DATAFRAME_LIKE] = None,
     data_func: Optional[Callable[[], DATAFRAME_LIKE]] = None,
     target: TARGET_LIKE = -1,
-    index: Union[bool, int, str, SEQUENCE_LIKE] = False,
+    index: Union[bool, int, str, SEQUENCE_LIKE] = True,
     train_size: float = 0.7,
     test_data: Optional[DATAFRAME_LIKE] = None,
     ordinal_features: Optional[Dict[str, list]] = None,
     numeric_features: Optional[List[str]] = None,
     categorical_features: Optional[List[str]] = None,
     date_features: Optional[List[str]] = None,
     text_features: Optional[List[str]] = None,
@@ -49,14 +49,15 @@
     rare_to_value: Optional[float] = None,
     rare_value: str = "rare",
     polynomial_features: bool = False,
     polynomial_degree: int = 2,
     low_variance_threshold: Optional[float] = None,
     group_features: Optional[list] = None,
     group_names: Optional[Union[str, list]] = None,
+    drop_groups: bool = False,
     remove_multicollinearity: bool = False,
     multicollinearity_threshold: float = 0.9,
     bin_numeric_features: Optional[List[str]] = None,
     remove_outliers: bool = False,
     outliers_method: str = "iforest",
     outliers_threshold: float = 0.05,
     transformation: bool = False,
@@ -128,15 +129,15 @@
     target: int, str or sequence, default = -1
         If int or str, respectivcely index or name of the target column in data.
         The default value selects the last column in the dataset. If sequence,
         it should have shape (n_samples,). The target can be either binary or
         multiclass.
 
 
-    index: bool, int, str or sequence, default = False
+    index: bool, int, str or sequence, default = True
         Handle indices in the `data` dataframe.
             - If False: Reset to RangeIndex.
             - If True: Keep the provided index.
             - If int: Position of the column to use as index.
             - If str: Name of the column to use as index.
             - If sequence: Array with shape=(n_samples,) to use as index.
 
@@ -260,15 +261,15 @@
         is used. Note that columns with exactly two classes are always encoded
         ordinally. Set to below 0 to always use OneHotEncoding.
 
 
     encoding_method: category-encoders estimator, default = None
         A `category-encoders` estimator to encode the categorical columns
         with more than `max_encoding_ohe` unique values. If None,
-        `category_encoders.leave_one_out.LeaveOneOutEncoder` is used.
+        `category_encoders.target_encoder.TargetEncoder` is used.
 
 
     rare_to_value: float or None, default=None
         Minimum fraction of category occurrences in a categorical column.
         If a category is less frequent than `rare_to_value * len(X)`, it is
         replaced with the string in `rare_value`. Use this parameter to group
         rare categories before encoding the column. If None, ignores this step.
@@ -294,27 +295,31 @@
         threshold. If 0, keep all features with non-zero variance, i.e. remove
         the features that have the same value in all samples. If None, skip
         this transformation step.
 
 
     group_features: list, list of lists or None, default = None
         When the dataset contains features with related characteristics,
-        replace those fetaures with the following statistical properties
-        of that group: min, max, mean, std, median and mode. The parameter
-        takes a list of feature names or a list of lists of feature names
-        to specify multiple groups.
-
+        add new fetaures with the following statistical properties of that
+        group: min, max, mean, std, median and mode. The parameter takes a
+        list of feature names or a list of lists of feature names to specify
+        multiple groups.
 
     group_names: str, list, or None, default = None
         Group names to be used when naming the new features. The length
         should match with the number of groups specified in ``group_features``.
         If None, new features are named using the default form, e.g. group_1,
         group_2, etc... Ignored when ``group_features`` is None.
 
 
+    drop_groups: bool, default=False
+        Whether to drop the original features in the group. Ignored when
+        ``group_features`` is None.
+
+
     remove_multicollinearity: bool, default = False
         When set to True, features with the inter-correlations higher than
         the defined threshold are removed. For each group, it removes all
         except the feature with the highest correlation to `y`.
 
 
     multicollinearity_threshold: float, default = 0.9
@@ -620,14 +625,15 @@
         rare_to_value=rare_to_value,
         rare_value=rare_value,
         polynomial_features=polynomial_features,
         polynomial_degree=polynomial_degree,
         low_variance_threshold=low_variance_threshold,
         group_features=group_features,
         group_names=group_names,
+        drop_groups=drop_groups,
         remove_multicollinearity=remove_multicollinearity,
         multicollinearity_threshold=multicollinearity_threshold,
         bin_numeric_features=bin_numeric_features,
         remove_outliers=remove_outliers,
         outliers_method=outliers_method,
         outliers_threshold=outliers_threshold,
         transformation=transformation,
@@ -684,15 +690,14 @@
     fit_kwargs: Optional[dict] = None,
     groups: Optional[Union[str, Any]] = None,
     experiment_custom_tags: Optional[Dict[str, Any]] = None,
     engine: Optional[Dict[str, str]] = None,
     verbose: bool = True,
     parallel: Optional[ParallelBackend] = None,
 ):
-
     """
     This function trains and evaluates performance of all estimators available in the
     model library using cross validation. The output of this function is a score grid
     with average cross validated scores. Metrics evaluated during CV can be accessed
     using the ``get_metrics`` function. Custom metrics can be added or removed using
     ``add_metric`` and ``remove_metric`` function.
 
@@ -872,15 +877,14 @@
     groups: Optional[Union[str, Any]] = None,
     experiment_custom_tags: Optional[Dict[str, Any]] = None,
     engine: Optional[str] = None,
     verbose: bool = True,
     return_train_score: bool = False,
     **kwargs,
 ):
-
     """
     This function trains and evaluates the performance of a given estimator
     using cross validation. The output of this function is a score grid with
     CV scores by fold. Metrics evaluated during CV can be accessed using the
     ``get_metrics`` function. Custom metrics can be added or removed using
     ``add_metric`` and ``remove_metric`` function. All the available models
     can be accessed using the ``models`` function.
@@ -1024,15 +1028,14 @@
     groups: Optional[Union[str, Any]] = None,
     return_tuner: bool = False,
     verbose: bool = True,
     tuner_verbose: Union[int, bool] = True,
     return_train_score: bool = False,
     **kwargs,
 ):
-
     """
     This function tunes the hyperparameters of a given estimator. The output of
     this function is a score grid with CV scores by fold of the best selected
     model based on ``optimize`` parameter. Metrics evaluated during CV can be
     accessed using the ``get_metrics`` function. Custom metrics can be added
     or removed using ``add_metric`` and ``remove_metric`` function.
 
@@ -1232,15 +1235,14 @@
     choose_better: bool = False,
     optimize: str = "R2",
     fit_kwargs: Optional[dict] = None,
     groups: Optional[Union[str, Any]] = None,
     verbose: bool = True,
     return_train_score: bool = False,
 ) -> Any:
-
     """
     This function ensembles a given estimator. The output of this function is
     a score grid with CV scores by fold. Metrics evaluated during CV can be
     accessed using the ``get_metrics`` function. Custom metrics can be added
     or removed using ``add_metric`` and ``remove_metric`` function.
 
 
@@ -1338,15 +1340,14 @@
     optimize: str = "R2",
     weights: Optional[List[float]] = None,
     fit_kwargs: Optional[dict] = None,
     groups: Optional[Union[str, Any]] = None,
     verbose: bool = True,
     return_train_score: bool = False,
 ):
-
     """
     This function trains a Voting Regressor for select models passed in the
     ``estimator_list`` param. The output of this function is a score grid with
     CV scores by fold. Metrics evaluated during CV can be accessed using the
     ``get_metrics`` function. Custom metrics can be added or removed using
     ``add_metric`` and ``remove_metric`` function.
 
@@ -1444,15 +1445,14 @@
     choose_better: bool = False,
     optimize: str = "R2",
     fit_kwargs: Optional[dict] = None,
     groups: Optional[Union[str, Any]] = None,
     verbose: bool = True,
     return_train_score: bool = False,
 ):
-
     """
     This function trains a meta model over select estimators passed in
     the ``estimator_list`` parameter. The output of this function is a
     score grid with CV scores by fold. Metrics evaluated during CV can
     be accessed using the ``get_metrics`` function. Custom metrics
     can be added or removed using ``add_metric`` and ``remove_metric``
     function.
@@ -1561,15 +1561,14 @@
     fit_kwargs: Optional[dict] = None,
     plot_kwargs: Optional[dict] = None,
     groups: Optional[Union[str, Any]] = None,
     use_train_data: bool = False,
     verbose: bool = True,
     display_format: Optional[str] = None,
 ) -> Optional[str]:
-
     """
     This function analyzes the performance of a trained model on holdout set.
     It may require re-training the model in certain cases.
 
 
     Example
     --------
@@ -1678,15 +1677,14 @@
     estimator,
     fold: Optional[Union[int, Any]] = None,
     fit_kwargs: Optional[dict] = None,
     plot_kwargs: Optional[dict] = None,
     groups: Optional[Union[str, Any]] = None,
     use_train_data: bool = False,
 ):
-
     """
     This function displays a user interface for analyzing performance of a trained
     model. It calls the ``plot_model`` function internally.
 
     Example
     --------
     >>> from pycaret.datasets import get_data
@@ -1756,15 +1754,14 @@
     observation: Optional[int] = None,
     use_train_data: bool = False,
     X_new_sample: Optional[pd.DataFrame] = None,
     y_new_sample: Optional[pd.DataFrame] = None,  # add for pfi explainer
     save: Union[str, bool] = False,
     **kwargs,
 ):
-
     """
     This function takes a trained model object and returns an interpretation plot
     based on the test / hold-out set.
 
     This function is implemented based on the SHAP (SHapley Additive exPlanations),
     which is a unified approach to explain the output of any machine learning model.
     SHAP connects game theory with local explanations.
@@ -1862,15 +1859,14 @@
 # not using check_if_global_is_not_none on purpose
 def predict_model(
     estimator,
     data: Optional[pd.DataFrame] = None,
     round: int = 4,
     verbose: bool = True,
 ) -> pd.DataFrame:
-
     """
     This function predicts ``Label`` using a trained model. When ``data`` is
     None, it predicts label on the holdout set.
 
 
     Example
     -------
@@ -1930,15 +1926,14 @@
 def finalize_model(
     estimator,
     fit_kwargs: Optional[dict] = None,
     groups: Optional[Union[str, Any]] = None,
     model_only: bool = False,
     experiment_custom_tags: Optional[Dict[str, Any]] = None,
 ) -> Any:
-
     """
     This function trains a given estimator on the entire dataset including the
     holdout set.
 
 
     Example
     --------
@@ -2082,15 +2077,14 @@
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def save_model(
     model, model_name: str, model_only: bool = False, verbose: bool = True, **kwargs
 ):
-
     """
     This function saves the transformation pipeline and trained model object
     into the current working directory as a pickle file for later use.
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -2139,15 +2133,14 @@
 # not using check_if_global_is_not_none on purpose
 def load_model(
     model_name: str,
     platform: Optional[str] = None,
     authentication: Optional[Dict[str, str]] = None,
     verbose: bool = True,
 ):
-
     """
     This function loads a previously saved pipeline.
 
     Example
     -------
     >>> from pycaret.regression import load_model
     >>> saved_lr = load_model('saved_lr_model')
@@ -2199,15 +2192,14 @@
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def automl(
     optimize: str = "R2",
     use_holdout: bool = False,
     turbo: bool = True,
     return_train_score: bool = False,
 ) -> Any:
-
     """
     This function returns the best model out of all trained models in
     current session based on the ``optimize`` parameter. Metrics
     evaluated can be accessed using the ``get_metrics`` function.
 
 
     Example
@@ -2481,15 +2473,14 @@
     """
 
     return _CURRENT_EXPERIMENT.get_logs(experiment_name=experiment_name, save=save)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def get_config(variable: Optional[str] = None):
-
     """
     This function is used to access global environment variables.
 
     Example
     -------
     >>> X_train = get_config('X_train')
 
@@ -2508,15 +2499,14 @@
     """
 
     return _CURRENT_EXPERIMENT.get_config(variable=variable)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def set_config(variable: str, value):
-
     """
     This function is used to reset global environment variables.
 
     Example
     -------
     >>> set_config('seed', 123)
 
@@ -2561,15 +2551,14 @@
     path_or_file: Union[str, os.PathLike, BinaryIO],
     data: Optional[DATAFRAME_LIKE] = None,
     data_func: Optional[Callable[[], DATAFRAME_LIKE]] = None,
     test_data: Optional[DATAFRAME_LIKE] = None,
     preprocess_data: bool = True,
     **cloudpickle_kwargs,
 ) -> RegressionExperiment:
-
     """
     Load an experiment saved with ``save_experiment`` from path
     or file.
 
     The data (and test data) is NOT saved with the experiment
     and will need to be specified again.
 
@@ -2633,15 +2622,14 @@
 def get_leaderboard(
     finalize_models: bool = False,
     model_only: bool = False,
     fit_kwargs: Optional[dict] = None,
     groups: Optional[Union[str, Any]] = None,
     verbose: bool = True,
 ) -> pd.DataFrame:
-
     """
     This function returns the leaderboard of all models trained in the
     current setup.
 
 
     Example
     -------
@@ -2745,15 +2733,14 @@
     return _CURRENT_EXPERIMENT.dashboard(
         estimator, display_format, dashboard_kwargs, run_kwargs, **kwargs
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def create_app(estimator, app_kwargs: Optional[dict] = None) -> None:
-
     """
     This function creates a basic gradio app for inference.
     It will later be expanded for other app types such as
     Streamlit.
 
 
     Example
@@ -2778,15 +2765,14 @@
         None
     """
     return _CURRENT_EXPERIMENT.create_app(estimator=estimator, app_kwargs=app_kwargs)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def convert_model(estimator, language: str = "python") -> str:
-
     """
     This function transpiles trained machine learning models into native
     inference script in different programming languages (Python, C, Java,
     Go, JavaScript, Visual Basic, C#, PowerShell, R, PHP, Dart, Haskell,
     Ruby, F#). This functionality is very useful if you want to deploy models
     into environments where you can't install your normal Python stack to
     support model inference.
@@ -2831,15 +2817,14 @@
 
     """
     return _CURRENT_EXPERIMENT.convert_model(estimator, language)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def eda(display_format: str = "bokeh", **kwargs):
-
     """
     This function generates AutoEDA using AutoVIZ library. You must
     install Autoviz separately ``pip install autoviz`` to use this
     function.
 
 
     Example
@@ -2864,15 +2849,14 @@
         None
     """
     return _CURRENT_EXPERIMENT.eda(display_format=display_format, **kwargs)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def check_fairness(estimator, sensitive_features: list, plot_kwargs: dict = {}):
-
     """
     There are many approaches to conceptualizing fairness. This function follows
     the approach known as group fairness, which asks: Which groups of individuals
     are at risk for experiencing harms. This function provides fairness-related
     metrics between different groups (also called subpopulation).
 
 
@@ -2911,15 +2895,14 @@
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def create_api(
     estimator, api_name: str, host: str = "127.0.0.1", port: int = 8000
 ) -> None:
-
     """
     This function takes an input ``estimator`` and creates a POST API for
     inference. It only creates the API and doesn't run it automatically.
     To run the API, you must run the Python file using ``!python``.
 
 
     Example
@@ -2958,15 +2941,14 @@
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def create_docker(
     api_name: str, base_image: str = "python:3.8-slim", expose_port: int = 8000
 ) -> None:
-
     """
     This function creates a ``Dockerfile`` and ``requirements.txt`` for
     productionalizing API end-point.
 
 
     Example
     -------
```

## pycaret/regression/oop.py

```diff
@@ -76,15 +76,15 @@
         return ["residuals", "error", "feature"]
 
     def setup(
         self,
         data: Optional[DATAFRAME_LIKE] = None,
         data_func: Optional[Callable[[], DATAFRAME_LIKE]] = None,
         target: TARGET_LIKE = -1,
-        index: Union[bool, int, str, SEQUENCE_LIKE] = False,
+        index: Union[bool, int, str, SEQUENCE_LIKE] = True,
         train_size: float = 0.7,
         test_data: Optional[DATAFRAME_LIKE] = None,
         ordinal_features: Optional[Dict[str, list]] = None,
         numeric_features: Optional[List[str]] = None,
         categorical_features: Optional[List[str]] = None,
         date_features: Optional[List[str]] = None,
         text_features: Optional[List[str]] = None,
@@ -104,14 +104,15 @@
         rare_to_value: Optional[float] = None,
         rare_value: str = "rare",
         polynomial_features: bool = False,
         polynomial_degree: int = 2,
         low_variance_threshold: Optional[float] = None,
         group_features: Optional[list] = None,
         group_names: Optional[Union[str, list]] = None,
+        drop_groups: bool = False,
         remove_multicollinearity: bool = False,
         multicollinearity_threshold: float = 0.9,
         bin_numeric_features: Optional[List[str]] = None,
         remove_outliers: bool = False,
         outliers_method: str = "iforest",
         outliers_threshold: float = 0.05,
         transformation: bool = False,
@@ -150,15 +151,14 @@
         log_data: bool = False,
         engine: Optional[Dict[str, str]] = None,
         verbose: bool = True,
         memory: Union[bool, str, Memory] = True,
         profile: bool = False,
         profile_kwargs: Optional[Dict[str, Any]] = None,
     ):
-
         """
         This function initializes the training environment and creates the transformation
         pipeline. Setup function must be called before executing any other function. It takes
         two mandatory parameters: ``data`` and ``target``. All the other parameters are
         optional.
 
         Example
@@ -187,15 +187,15 @@
         target: int, str or sequence, default = -1
             If int or str, respectivcely index or name of the target column in data.
             The default value selects the last column in the dataset. If sequence,
             it should have shape (n_samples,). The target can be either binary or
             multiclass.
 
 
-        index: bool, int, str or sequence, default = False
+        index: bool, int, str or sequence, default = True
             Handle indices in the `data` dataframe.
                 - If False: Reset to RangeIndex.
                 - If True: Keep the provided index.
                 - If int: Position of the column to use as index.
                 - If str: Name of the column to use as index.
                 - If sequence: Array with shape=(n_samples,) to use as index.
 
@@ -319,15 +319,15 @@
             is used. Note that columns with exactly two classes are always encoded
             ordinally. Set to below 0 to always use OneHotEncoding.
 
 
         encoding_method: category-encoders estimator, default = None
             A `category-encoders` estimator to encode the categorical columns
             with more than `max_encoding_ohe` unique values. If None,
-            `category_encoders.leave_one_out.LeaveOneOutEncoder` is used.
+            `category_encoders.target_encoder.TargetEncoder` is used.
 
 
         rare_to_value: float or None, default=None
             Minimum fraction of category occurrences in a categorical column.
             If a category is less frequent than `rare_to_value * len(X)`, it is
             replaced with the string in `rare_value`. Use this parameter to group
             rare categories before encoding the column. If None, ignores this step.
@@ -353,26 +353,30 @@
             threshold. If 0, keep all features with non-zero variance, i.e. remove
             the features that have the same value in all samples. If None, skip
             this transformation step.
 
 
         group_features: list, list of lists or None, default = None
             When the dataset contains features with related characteristics,
-            replace those fetaures with the following statistical properties
-            of that group: min, max, mean, std, median and mode. The parameter
-            takes a list of feature names or a list of lists of feature names
-            to specify multiple groups.
+            add new fetaures with the following statistical properties of that
+            group: min, max, mean, std, median and mode. The parameter takes a
+            list of feature names or a list of lists of feature names to specify
+            multiple groups.
 
 
         group_names: str, list, or None, default = None
             Group names to be used when naming the new features. The length
             should match with the number of groups specified in ``group_features``.
             If None, new features are named using the default form, e.g. group_1,
             group_2, etc... Ignored when ``group_features`` is None.
 
+        drop_groups: bool, default=False
+            Whether to drop the original features in the group. Ignored when
+            ``group_features`` is None.
+
         remove_multicollinearity: bool, default = False
             When set to True, features with the inter-correlations higher than
             the defined threshold are removed. For each group, it removes all
             except the feature with the highest correlation to `y`.
 
 
         multicollinearity_threshold: float, default = 0.9
@@ -755,18 +759,14 @@
             steps=[("placeholder", None)],
             memory=self.memory,
         )
 
         if preprocess:
             self.logger.info("Preparing preprocessing pipeline...")
 
-            # Remove weird characters from column names
-            if any(re.search("[^A-Za-z0-9_]", col) for col in self.dataset):
-                self._clean_column_names()
-
             # Power transform the target to be more Gaussian-like
             if transform_target:
                 self._target_transformation(transform_target_method)
 
             # Convert date feature to numerical values
             if self._fxs["Date"]:
                 self._date_feature_engineering(create_date_columns)
@@ -805,15 +805,15 @@
 
             # Drop features with too low variance
             if low_variance_threshold is not None:
                 self._low_variance(low_variance_threshold)
 
             # Get statistical properties of a group of features
             if group_features:
-                self._group_features(group_features, group_names)
+                self._group_features(group_features, group_names, drop_groups)
 
             # Drop features that are collinear with other features
             if remove_multicollinearity:
                 self._remove_multicollinearity(multicollinearity_threshold)
 
             # Bin numerical features to 5 clusters
             if bin_numeric_features:
@@ -843,15 +843,21 @@
                     n_features_to_select=n_features_to_select,
                 )
 
         # Add custom transformers to the pipeline
         if custom_pipeline:
             self._add_custom_pipeline(custom_pipeline, custom_pipeline_position)
 
-            # Remove placeholder step
+        # Remove weird characters from column names
+        # This has to be done right before the estimator, as modifying column
+        # names early messes self._fxs up
+        if any(re.search("[^A-Za-z0-9_]", col) for col in self.dataset):
+            self._clean_column_names()
+
+        # Remove placeholder step
         if ("placeholder", None) in self.pipeline.steps and len(self.pipeline) > 1:
             self.pipeline.steps.remove(("placeholder", None))
 
         self.pipeline.fit(self.X_train, self.y_train)
 
         self.logger.info("Finished creating preprocessing pipeline.")
         self.logger.info(f"Pipeline: {self.pipeline}")
@@ -996,15 +1002,14 @@
         fit_kwargs: Optional[dict] = None,
         groups: Optional[Union[str, Any]] = None,
         experiment_custom_tags: Optional[Dict[str, Any]] = None,
         engine: Optional[Dict[str, str]] = None,
         verbose: bool = True,
         parallel: Optional[ParallelBackend] = None,
     ):
-
         """
         This function trains and evaluates performance of all estimators available in the
         model library using cross validation. The output of this function is a score grid
         with average cross validated scores. Metrics evaluated during CV can be accessed
         using the ``get_metrics`` function. Custom metrics can be added or removed using
         ``add_metric`` and ``remove_metric`` function.
 
@@ -1161,15 +1166,14 @@
         groups: Optional[Union[str, Any]] = None,
         experiment_custom_tags: Optional[Dict[str, Any]] = None,
         engine: Optional[str] = None,
         verbose: bool = True,
         return_train_score: bool = False,
         **kwargs,
     ):
-
         """
         This function trains and evaluates the performance of a given estimator
         using cross validation. The output of this function is a score grid with
         CV scores by fold. Metrics evaluated during CV can be accessed using the
         ``get_metrics`` function. Custom metrics can be added or removed using
         ``add_metric`` and ``remove_metric`` function. All the available models
         can be accessed using the ``models`` function.
@@ -1326,15 +1330,14 @@
         groups: Optional[Union[str, Any]] = None,
         return_tuner: bool = False,
         verbose: bool = True,
         tuner_verbose: Union[int, bool] = True,
         return_train_score: bool = False,
         **kwargs,
     ):
-
         """
         This function tunes the hyperparameters of a given estimator. The output of
         this function is a score grid with CV scores by fold of the best selected
         model based on ``optimize`` parameter. Metrics evaluated during CV can be
         accessed using the ``get_metrics`` function. Custom metrics can be added
         or removed using ``add_metric`` and ``remove_metric`` function.
 
@@ -1533,15 +1536,14 @@
         choose_better: bool = False,
         optimize: str = "R2",
         fit_kwargs: Optional[dict] = None,
         groups: Optional[Union[str, Any]] = None,
         verbose: bool = True,
         return_train_score: bool = False,
     ) -> Any:
-
         """
         This function ensembles a given estimator. The output of this function is
         a score grid with CV scores by fold. Metrics evaluated during CV can be
         accessed using the ``get_metrics`` function. Custom metrics can be added
         or removed using ``add_metric`` and ``remove_metric`` function.
 
 
@@ -1638,15 +1640,14 @@
         optimize: str = "R2",
         weights: Optional[List[float]] = None,
         fit_kwargs: Optional[dict] = None,
         groups: Optional[Union[str, Any]] = None,
         verbose: bool = True,
         return_train_score: bool = False,
     ):
-
         """
         This function trains a Voting Regressor for select models passed in the
         ``estimator_list`` param. The output of this function is a score grid with
         CV scores by fold. Metrics evaluated during CV can be accessed using the
         ``get_metrics`` function. Custom metrics can be added or removed using
         ``add_metric`` and ``remove_metric`` function.
 
@@ -1744,15 +1745,14 @@
         choose_better: bool = False,
         optimize: str = "R2",
         fit_kwargs: Optional[dict] = None,
         groups: Optional[Union[str, Any]] = None,
         verbose: bool = True,
         return_train_score: bool = False,
     ):
-
         """
         This function trains a meta model over select estimators passed in
         the ``estimator_list`` parameter. The output of this function is a
         score grid with CV scores by fold. Metrics evaluated during CV can
         be accessed using the ``get_metrics`` function. Custom metrics
         can be added or removed using ``add_metric`` and ``remove_metric``
         function.
@@ -1861,15 +1861,14 @@
         fit_kwargs: Optional[dict] = None,
         plot_kwargs: Optional[dict] = None,
         groups: Optional[Union[str, Any]] = None,
         use_train_data: bool = False,
         verbose: bool = True,
         display_format: Optional[str] = None,
     ) -> Optional[str]:
-
         """
         This function analyzes the performance of a trained model on holdout set.
         It may require re-training the model in certain cases.
 
 
         Example
         --------
@@ -1977,15 +1976,14 @@
         estimator,
         fold: Optional[Union[int, Any]] = None,
         fit_kwargs: Optional[dict] = None,
         plot_kwargs: Optional[dict] = None,
         groups: Optional[Union[str, Any]] = None,
         use_train_data: bool = False,
     ):
-
         """
         This function displays a user interface for analyzing performance of a trained
         model. It calls the ``plot_model`` function internally.
 
         Example
         --------
         >>> from pycaret.datasets import get_data
@@ -2054,15 +2052,14 @@
         observation: Optional[int] = None,
         use_train_data: bool = False,
         X_new_sample: Optional[pd.DataFrame] = None,
         y_new_sample: Optional[pd.DataFrame] = None,  # add for pfi explainer
         save: Union[str, bool] = False,
         **kwargs,
     ):
-
         """
         This function takes a trained model object and returns an interpretation plot
         based on the test / hold-out set.
 
         This function is implemented based on the SHAP (SHapley Additive exPlanations),
         which is a unified approach to explain the output of any machine learning model.
         SHAP connects game theory with local explanations.
@@ -2159,15 +2156,14 @@
     def predict_model(
         self,
         estimator,
         data: Optional[pd.DataFrame] = None,
         round: int = 4,
         verbose: bool = True,
     ) -> pd.DataFrame:
-
         """
         This function predicts ``Label`` using a trained model. When ``data`` is
         None, it predicts label on the holdout set.
 
 
         Example
         -------
@@ -2224,15 +2220,14 @@
         self,
         estimator,
         fit_kwargs: Optional[dict] = None,
         groups: Optional[Union[str, Any]] = None,
         model_only: bool = False,
         experiment_custom_tags: Optional[Dict[str, Any]] = None,
     ) -> Any:
-
         """
         This function trains a given estimator on the entire dataset including the
         holdout set.
 
 
         Example
         --------
@@ -2283,15 +2278,14 @@
     def deploy_model(
         self,
         model,
         model_name: str,
         authentication: dict,
         platform: str = "aws",
     ):
-
         """
         This function deploys the transformation pipeline and trained model on cloud.
 
 
         Example
         -------
         >>> from pycaret.datasets import get_data
@@ -2377,15 +2371,14 @@
         self,
         model,
         model_name: str,
         model_only: bool = False,
         verbose: bool = True,
         **kwargs,
     ):
-
         """
         This function saves the transformation pipeline and trained model object
         into the current working directory as a pickle file for later use.
 
         Example
         -------
         >>> from pycaret.datasets import get_data
@@ -2433,15 +2426,14 @@
     def load_model(
         self,
         model_name: str,
         platform: Optional[str] = None,
         authentication: Optional[Dict[str, str]] = None,
         verbose: bool = True,
     ):
-
         """
         This function loads a previously saved pipeline.
 
         Example
         -------
         >>> from pycaret.regression import load_model
         >>> saved_lr = load_model('saved_lr_model')
@@ -2488,15 +2480,14 @@
     def automl(
         self,
         optimize: str = "Accuracy",
         use_holdout: bool = False,
         turbo: bool = True,
         return_train_score: bool = False,
     ) -> Any:
-
         """
         This function returns the best model out of all trained models in
         current session based on the ``optimize`` parameter. Metrics
         evaluated can be accessed using the ``get_metrics`` function.
 
 
         Example
@@ -2550,15 +2541,14 @@
 
     def models(
         self,
         type: Optional[str] = None,
         internal: bool = False,
         raise_errors: bool = True,
     ) -> pd.DataFrame:
-
         """
         Returns table of models available in the model library.
 
         Example
         -------
         >>> from pycaret.datasets import get_data
         >>> boston = get_data('boston')
@@ -2591,15 +2581,14 @@
 
     def get_metrics(
         self,
         reset: bool = False,
         include_custom: bool = True,
         raise_errors: bool = True,
     ) -> pd.DataFrame:
-
         """
         Returns table of available metrics used in the experiment.
 
 
         Example
         -------
         >>> from pycaret.datasets import get_data
@@ -2638,15 +2627,14 @@
         self,
         id: str,
         name: str,
         score_func: type,
         greater_is_better: bool = True,
         **kwargs,
     ) -> pd.Series:
-
         """
         Adds a custom metric to be used in the experiment.
 
 
         Example
         -------
         >>> from pycaret.datasets import get_data
@@ -2688,15 +2676,14 @@
             score_func=score_func,
             target="pred",
             greater_is_better=greater_is_better,
             **kwargs,
         )
 
     def remove_metric(self, name_or_id: str):
-
         """
         Removes a metric from experiment.
 
 
         Example
         -------
         >>> from pycaret.datasets import get_data
@@ -2716,15 +2703,14 @@
         """
 
         return super().remove_metric(name_or_id=name_or_id)
 
     def get_logs(
         self, experiment_name: Optional[str] = None, save: bool = False
     ) -> pd.DataFrame:
-
         """
         Returns a table of experiment logs. Only works when ``log_experiment``
         is True when initializing the ``setup`` function.
 
 
         Example
         -------
```

## pycaret/time_series/forecasting/functional.py

```diff
@@ -50,19 +50,21 @@
     scale_target: Optional[str] = None,
     scale_exogenous: Optional[str] = None,
     fold_strategy: Union[str, Any] = "expanding",
     fold: int = 3,
     fh: Optional[Union[List[int], int, np.ndarray, "ForecastingHorizon"]] = 1,
     hyperparameter_split: str = "all",
     seasonal_period: Optional[Union[List[Union[int, str]], int, str]] = None,
+    ignore_seasonality_test: bool = False,
     sp_detection: str = "auto",
     max_sp_to_consider: Optional[int] = 60,
     remove_harmonics: bool = False,
     harmonic_order_method: str = "harmonic_max",
     num_sps_to_use: int = 1,
+    seasonality_type: str = "mul",
     point_alpha: Optional[float] = None,
     coverage: Union[float, List[float]] = 0.9,
     enforce_exogenous: bool = True,
     n_jobs: Optional[int] = -1,
     use_gpu: bool = False,
     custom_pipeline: Optional[Any] = None,
     html: bool = True,
@@ -296,16 +298,15 @@
         whether the data is white noise or not, the values of non-seasonal difference
         "d" and seasonal difference "D" to use in certain models.
         Allowed values are: ["all", "train"].
         Refer for more details: https://github.com/pycaret/pycaret/issues/3202
 
 
     seasonal_period: list or int or str, default = None
-        Seasonal periods to check when performing seasonality checks (i.e. candidates).
-        If not provided, then candidates are detected per the sp_detection setting.
+        Seasonal periods to use when performing seasonality checks (i.e. candidates).
 
         Users can provide `seasonal_period` by passing it as an integer or a
         string corresponding to the keys below (e.g. 'W' for weekly data,
         'M' for monthly data, etc.).
             * B, C = 5
             * D = 7
             * W = 52
@@ -318,14 +319,29 @@
             * S = 60
 
         Users can also provide a list of such values to use in models that
         accept multiple seasonal values (currently TBATS). For models that
         don't accept multiple seasonal values, the first value of the list
         will be used as the seasonal period.
 
+        NOTE:
+        (1) If seasonal_period is provided, whether the seasonality check is
+        performed or not depends on the ignore_seasonality_test setting.
+        (2) If seasonal_period is not provided, then the candidates are detected
+        per the sp_detection setting. If seasonal_period is provided,
+        sp_detection setting is ignored.
+
+
+    ignore_seasonality_test: bool = False
+        Whether to ignore the seasonality test or not. Applicable when seasonal_period
+        is provided. If False, then a seasonality tests is performed to determine
+        if the provided seasonal_period is valid or not. If it is found to be not
+        valid, no seasonal period is used for modeling. If True, then the the
+        provided seasonal_period is used as is.
+
 
     sp_detection: str, default = "auto"
         If seasonal_period is None, then this parameter determines the algorithm
         to use to detect the seasonal periods to use in the models.
 
         Allowed values are ["auto" or "index"].
 
@@ -367,14 +383,34 @@
         It determines the maximum number of seasonal periods to use in the models.
         Set to -1 to use all detected seasonal periods (in models that allow
         multiple seasonalities). If a model only allows one seasonal period
         and num_sps_to_use > 1, then the most dominant (primary) seasonal
         that is detected is used.
 
 
+    seasonality_type : str, default = "mul"
+        The type of seasonality to use. Allowed values are ["add", "mul" or "auto"]
+
+        The detection flow sequence is as follows:
+        (1) If seasonality is not detected, then seasonality type is set to None.
+        (2) If seasonality is detected but data is not strictly positive, then
+        seasonality type is set to "add".
+        (3) If seasonality_type is "auto", then the type of seasonality is
+        determined using an internal algorithm as follows
+            - If seasonality is detected, then data is decomposed using
+            additive and multiplicative seasonal decomposition. Then
+            seasonality type is selected based on seasonality strength
+            per FPP (https://otexts.com/fpp2/seasonal-strength.html). NOTE:
+            For Multiplicative, the denominator multiplies the seasonal and
+            residual components instead of adding them. Rest of the
+            calculations remain the same. If seasonal decompositon fails for
+            any reason, then defaults to multiplicative seasonality.
+        (4) Otherwise, seasonality_type is set to the user provided value.
+
+
     point_alpha: Optional[float], default = None
         The alpha (quantile) value to use for the point predictions. By default
         this is set to None which uses sktime's predict() method to get the
         point prediction (the mean or the median of the forecast distribution).
         If this is set to a floating point value, then it switches to using the
         predict_quantiles() method to get the point prediction at the user
         specified quantile.
@@ -566,19 +602,21 @@
         fe_target_rr=fe_target_rr,
         fe_exogenous=fe_exogenous,
         fold_strategy=fold_strategy,
         fold=fold,
         fh=fh,
         hyperparameter_split=hyperparameter_split,
         seasonal_period=seasonal_period,
+        ignore_seasonality_test=ignore_seasonality_test,
         sp_detection=sp_detection,
         max_sp_to_consider=max_sp_to_consider,
         remove_harmonics=remove_harmonics,
         harmonic_order_method=harmonic_order_method,
         num_sps_to_use=num_sps_to_use,
+        seasonality_type=seasonality_type,
         point_alpha=point_alpha,
         coverage=coverage,
         enforce_exogenous=enforce_exogenous,
         n_jobs=n_jobs,
         use_gpu=use_gpu,
         custom_pipeline=custom_pipeline,
         html=html,
@@ -609,15 +647,14 @@
     turbo: bool = True,
     errors: str = "ignore",
     fit_kwargs: Optional[dict] = None,
     engine: Optional[Dict[str, str]] = None,
     verbose: bool = True,
     parallel: Optional[ParallelBackend] = None,
 ):
-
     """
     This function trains and evaluates performance of all estimators available in the
     model library using cross validation. The output of this function is a score grid
     with average cross validated scores. Metrics evaluated during CV can be accessed
     using the ``get_metrics`` function. Custom metrics can be added or removed using
     ``add_metric`` and ``remove_metric`` function.
 
@@ -783,15 +820,14 @@
     round: int = 4,
     cross_validation: bool = True,
     fit_kwargs: Optional[dict] = None,
     engine: Optional[str] = None,
     verbose: bool = True,
     **kwargs,
 ):
-
     """
     This function trains and evaluates the performance of a given estimator
     using cross validation. The output of this function is a score grid with
     CV scores by fold. Metrics evaluated during CV can be accessed using the
     ``get_metrics`` function. Custom metrics can be added or removed using
     ``add_metric`` and ``remove_metric`` function. All the available models
     can be accessed using the ``models`` function.
@@ -818,29 +854,28 @@
         * 'naive' - Naive Forecaster
         * 'grand_means' - Grand Means Forecaster
         * 'snaive' - Seasonal Naive Forecaster (disabled when seasonal_period = 1)
         * 'polytrend' - Polynomial Trend Forecaster
         * 'arima' - ARIMA family of models (ARIMA, SARIMA, SARIMAX)
         * 'auto_arima' - Auto ARIMA
         * 'exp_smooth' - Exponential Smoothing
+        * 'stlf' - STL Forecaster
         * 'croston' - Croston Forecaster
         * 'ets' - ETS
         * 'theta' - Theta Forecaster
         * 'tbats' - TBATS
         * 'bats' - BATS
         * 'prophet' - Prophet Forecaster
         * 'lr_cds_dt' - Linear w/ Cond. Deseasonalize & Detrending
         * 'en_cds_dt' - Elastic Net w/ Cond. Deseasonalize & Detrending
         * 'ridge_cds_dt' - Ridge w/ Cond. Deseasonalize & Detrending
         * 'lasso_cds_dt' - Lasso w/ Cond. Deseasonalize & Detrending
-        * 'lar_cds_dt' -   Least Angular Regressor w/ Cond. Deseasonalize & Detrending
         * 'llar_cds_dt' - Lasso Least Angular Regressor w/ Cond. Deseasonalize & Detrending
         * 'br_cds_dt' - Bayesian Ridge w/ Cond. Deseasonalize & Deseasonalize & Detrending
         * 'huber_cds_dt' - Huber w/ Cond. Deseasonalize & Detrending
-        * 'par_cds_dt' - Passive Aggressive w/ Cond. Deseasonalize & Detrending
         * 'omp_cds_dt' - Orthogonal Matching Pursuit w/ Cond. Deseasonalize & Detrending
         * 'knn_cds_dt' - K Neighbors w/ Cond. Deseasonalize & Detrending
         * 'dt_cds_dt' - Decision Tree w/ Cond. Deseasonalize & Detrending
         * 'rf_cds_dt' - Random Forest w/ Cond. Deseasonalize & Detrending
         * 'et_cds_dt' - Extra Trees w/ Cond. Deseasonalize & Detrending
         * 'gbr_cds_dt' - Gradient Boosting w/ Cond. Deseasonalize & Detrending
         * 'ada_cds_dt' - AdaBoost w/ Cond. Deseasonalize & Detrending
@@ -918,15 +953,14 @@
     choose_better: bool = True,
     fit_kwargs: Optional[dict] = None,
     return_tuner: bool = False,
     verbose: bool = True,
     tuner_verbose: Union[int, bool] = True,
     **kwargs,
 ):
-
     """
     This function tunes the hyperparameters of a given estimator. The output of
     this function is a score grid with CV scores by fold of the best selected
     model based on ``optimize`` parameter. Metrics evaluated during CV can be
     accessed using the ``get_metrics`` function. Custom metrics can be added
     or removed using ``add_metric`` and ``remove_metric`` function.
 
@@ -1041,21 +1075,18 @@
     round: int = 4,
     choose_better: bool = False,
     optimize: str = "MASE",
     weights: Optional[List[float]] = None,
     fit_kwargs: Optional[dict] = None,
     verbose: bool = True,
 ):
-
     """
     This function trains a EnsembleForecaster for select models passed in the
-    ``estimator_list`` param. The output of this function is a score grid with
-    CV scores by fold. Metrics evaluated during CV can be accessed using the
-    ``get_metrics`` function. Custom metrics can be added or removed using
-    ``add_metric`` and ``remove_metric`` function.
+    ``estimator_list`` param. Trains a sktime EnsembleForecaster under the hood.
+    Refer to it's documentation for more details.
 
 
     Example
     --------
     >>> from pycaret.datasets import get_data
     >>> airline = get_data('airline')
     >>> from pycaret.time_series import *
@@ -1069,16 +1100,18 @@
 
 
     method: str, default = 'mean'
         Method to average the individual predictions to form a final prediction.
         Available Methods:
 
         * 'mean' - Mean of individual predictions
+        * 'gmean' - Geometric Mean of individual predictions
         * 'median' - Median of individual predictions
-        * 'voting' - Vote individual predictions based on the provided weights.
+        * 'min' - Minimum of individual predictions
+        * 'max' - Maximum of individual predictions
 
 
     fold: int or scikit-learn compatible CV generator, default = None
         Controls cross-validation. If None, the CV generator in the ``fold_strategy``
         parameter of the ``setup`` function is used. When an integer is passed,
         it is interpreted as the 'n_splits' parameter of the CV generator in the
         ``setup`` function.
@@ -1094,33 +1127,30 @@
 
 
     optimize: str, default = 'MASE'
         Metric to compare for model selection when ``choose_better`` is True.
 
 
     weights: list, default = None
-        Sequence of weights (float or int) to weight the occurrences of predicted class
-        labels (hard voting) or class probabilities before averaging (soft voting). Uses
-        uniform weights when None.
+        Sequence of weights (float or int) to apply to the individual model
+        predictons. Uses uniform weights when None. Note that weights only
+        apply 'mean', 'gmean' and 'median' methods.
 
 
     fit_kwargs: dict, default = {} (empty dict)
         Dictionary of arguments passed to the fit method of the model.
 
 
     verbose: bool, default = True
         Score grid is not printed when verbose is set to False.
 
 
     Returns:
         Trained Model
-
-
     """
-
     return _CURRENT_EXPERIMENT.blend_models(
         estimator_list=estimator_list,
         fold=fold,
         round=round,
         choose_better=choose_better,
         optimize=optimize,
         method=method,
@@ -1138,15 +1168,14 @@
     return_data: bool = False,
     verbose: bool = False,
     display_format: Optional[str] = None,
     data_kwargs: Optional[Dict] = None,
     fig_kwargs: Optional[Dict] = None,
     save: Union[str, bool] = False,
 ) -> Optional[Tuple[str, list]]:
-
     """
     This function analyzes the performance of a trained model on holdout set.
     When used without any estimator, this function generates plots on the
     original data set. When used with an estimator, it will generate plots on
     the model residuals.
 
 
@@ -1386,15 +1415,14 @@
     X=None,
     return_pred_int=False,
     alpha: Optional[float] = None,
     coverage: Union[float, List[float]] = 0.9,
     round: int = 4,
     verbose: bool = True,
 ) -> pd.DataFrame:
-
     """
     This function forecast using a trained model. When ``fh`` is None,
     it forecasts using the same forecast horizon used during the
     training.
 
 
     Example
@@ -1472,15 +1500,14 @@
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def finalize_model(
     estimator, fit_kwargs: Optional[dict] = None, model_only: bool = False
 ) -> Any:
-
     """
     This function trains a given estimator on the entire dataset including the
     holdout set.
 
 
     Example
     --------
@@ -1513,15 +1540,14 @@
     return _CURRENT_EXPERIMENT.finalize_model(
         estimator=estimator, fit_kwargs=fit_kwargs, model_only=model_only
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def deploy_model(model, model_name: str, authentication: dict, platform: str = "aws"):
-
     """
     This function deploys the transformation pipeline and trained model on cloud.
 
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -1600,16 +1626,15 @@
         model_name=model_name,
         authentication=authentication,
         platform=platform,
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
-def save_model(model, model_name: str, model_only: bool = True, verbose: bool = True):
-
+def save_model(model, model_name: str, model_only: bool = False, verbose: bool = True):
     """
     This function saves the transformation pipeline and trained model object
     into the current working directory as a pickle file for later use.
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -1624,16 +1649,17 @@
         Trained model object
 
 
     model_name: str
         Name of the model.
 
 
-    model_only: bool, default = True
-        Parameter not in use for now. Behavior may change in future.
+    model_only: bool, default = False
+        When set to True, only trained model object is saved instead of the
+        entire pipeline.
 
 
     verbose: bool, default = True
         Success message is not printed when verbose is set to False.
 
 
     Returns:
@@ -1649,15 +1675,14 @@
 # not using check_if_global_is_not_none on purpose
 def load_model(
     model_name: str,
     platform: Optional[str] = None,
     authentication: Optional[Dict[str, str]] = None,
     verbose: bool = True,
 ):
-
     """
     This function loads a previously saved pipeline/model.
 
     Example
     -------
     >>> from pycaret.time_series import load_model
     >>> saved_arima = load_model('saved_arima_model')
@@ -1725,15 +1750,14 @@
     return _CURRENT_EXPERIMENT.pull(pop=pop)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def models(
     type: Optional[str] = None, internal: bool = False, raise_errors: bool = True
 ) -> pd.DataFrame:
-
     """
     Returns table of models available in the model library.
 
     Example
     -------
     >>> from pycaret.datasets import get_data
     >>> data = get_data('airline')
@@ -1768,15 +1792,14 @@
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def get_metrics(
     reset: bool = False, include_custom: bool = True, raise_errors: bool = True
 ) -> pd.DataFrame:
-
     """
     Returns table of available metrics used for CV.
 
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -1810,15 +1833,14 @@
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def add_metric(
     id: str, name: str, score_func: type, greater_is_better: bool = True, **kwargs
 ) -> pd.Series:
-
     """
     Adds a custom metric to be used for CV.
 
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -1861,15 +1883,14 @@
         greater_is_better=greater_is_better,
         **kwargs,
     )
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def remove_metric(name_or_id: str):
-
     """
     Removes a metric from CV.
 
 
     Example
     -------
     >>> from pycaret.datasets import get_data
@@ -1888,15 +1909,14 @@
 
     """
     return _CURRENT_EXPERIMENT.remove_metric(name_or_id=name_or_id)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def get_logs(experiment_name: Optional[str] = None, save: bool = False) -> pd.DataFrame:
-
     """
     Returns a table of experiment logs. Only works when ``log_experiment``
     is True when initializing the ``setup`` function.
 
 
     Example
     -------
@@ -1922,15 +1942,14 @@
     """
 
     return _CURRENT_EXPERIMENT.get_logs(experiment_name=experiment_name, save=save)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def get_config(variable: Optional[str] = None):
-
     """
     This function retrieves the global variables created when initializing the
     ``setup`` function. Following variables are accessible:
 
     - X: Period/Index of X
     - y: Time Series as pd.Series
     - X_train: Period/Index of X_train
@@ -1978,15 +1997,14 @@
     """
 
     return _CURRENT_EXPERIMENT.get_config(variable=variable)
 
 
 @check_if_global_is_not_none(globals(), _CURRENT_EXPERIMENT_DECORATOR_DICT)
 def set_config(variable: str, value):
-
     """
     This function resets the global variables. Following variables are
     accessible:
 
     - X: Period/Index of X
     - y: Time Series as pd.Series
     - X_train: Period/Index of X_train
@@ -2065,15 +2083,14 @@
     path_or_file: Union[str, os.PathLike, BinaryIO],
     data: Optional[Union[pd.Series, pd.DataFrame]] = None,
     data_func: Optional[Callable[[], Union[pd.Series, pd.DataFrame]]] = None,
     test_data: Optional[Union[pd.Series, pd.DataFrame]] = None,
     preprocess_data: bool = True,
     **cloudpickle_kwargs,
 ) -> TSForecastingExperiment:
-
     """
     Load an experiment saved with ``save_experiment`` from path
     or file.
 
     The data (and test data) is NOT saved with the experiment
     and will need to be specified again.
```

## pycaret/time_series/forecasting/oop.py

```diff
@@ -21,14 +21,15 @@
     ExpandingWindowSplitter,
     SlidingWindowSplitter,
     temporal_train_test_split,
 )
 from sktime.transformations.compose import TransformerPipeline
 from sktime.transformations.series.impute import Imputer
 from sktime.utils.seasonality import autocorrelation_seasonality_test
+from statsmodels.tsa.seasonal import seasonal_decompose
 
 from pycaret.containers.metrics import get_all_ts_metric_containers
 from pycaret.containers.models import get_all_ts_model_containers
 from pycaret.containers.models.time_series import (
     ALL_ALLOWED_ENGINES,
     get_container_default_engines,
 )
@@ -182,28 +183,31 @@
             ["Transformed train set shape", self.train_transformed.shape],
             ["Transformed test set shape", self.test_transformed.shape],
             ["Rows with missing values", f"{round(n_nans, 1)}%"],
             ["Fold Generator", type(self.fold_generator).__name__],
             ["Fold Number", self.fold_param],
             ["Enforce Prediction Interval", self.enforce_pi],
             ["Splits used for hyperparameters", self.hyperparameter_split],
+            ["User Defined Seasonal Period(s)", self.seasonal_period],
+            ["Ignore Seasonality Test", self.ignore_seasonality_test],
             ["Seasonality Detection Algo", self.sp_detection],
             ["Max Period to Consider", self.max_sp_to_consider],
             ["Seasonal Period(s) Tested", self.candidate_sps],
             ["Significant Seasonal Period(s)", self.significant_sps],
             [
                 "Significant Seasonal Period(s) without Harmonics",
                 self.significant_sps_no_harmonics,
             ],
             ["Remove Harmonics", self.remove_harmonics],
             ["Harmonics Order Method", self.harmonic_order_method],
             ["Num Seasonalities to Use", self.num_sps_to_use],
             ["All Seasonalities to Use", self.all_sps_to_use],
             ["Primary Seasonality", self.primary_sp_to_use],
             ["Seasonality Present", self.seasonality_present],
+            ["Seasonality Type", self.seasonality_type],
             ["Target Strictly Positive", self.strictly_positive],
             ["Target White Noise", self.white_noise],
             ["Recommended d", self.lowercase_d],
             ["Recommended Seasonal D", self.uppercase_d],
             ["Preprocess", self.preprocess],
         ]
 
@@ -573,14 +577,18 @@
                     "\nPlease add missing indices to data before passing to pycaret."
                     "\nYou can do that by using the following code snippet & then enabling imputation of missing "
                     "values in `setup`"
                     "\n\n# Assuming `data` is a pandas dataframe"
                     "\n>>> import numpy as np"
                     "\n>>> idx = pd.period_range(min(data.index), max(data.index))"
                     "\n>>> data = data.reindex(idx, fill_value=np.nan)"
+                    "\n\nAlternately, you can use this utility function:"
+                    "\n>>> from pycaret.utils.time_series import clean_time_index"
+                    ">>> # Provide the right frequency argument and index column name if necessary"
+                    ">>> cleaned = clean_time_index(data=data, index_col=index_col, freq=freq)"
                 )
 
         # Save index type so that we can disable certain models ----
         # E.g. Prophet when index if of type RangeIndex
         self.index_type = type(self.data.index)
 
         return self
@@ -694,15 +702,15 @@
         Raises
         ------
         ValueError
             If seasonal period is provided but its values are not of type int or string
         """
         self.logger.info("Set up Seasonal Period.")
 
-        skip_autocorrelation_test = False
+        skip_autocorrelation_test = False or self.ignore_seasonality_test
 
         # We use the transformed dataset here instead of y for 2 reasons:
         # (1) Missing values in y will cause issues with this test (seasonality
         #     will not be detected properly).
         # (2) The actual forecaster will see transformed values of y for training.
         #     Hence, these transformed values should be used to determine seasonality.
         data_to_use = self._get_y_data(
@@ -1134,32 +1142,113 @@
         self._check_transformations()
 
         self.logger.info("Finished creating preprocessing pipeline.")
         self.logger.info(f"Pipeline: {self.pipeline}")
 
         return self
 
-    def _set_multiplicative_components(self) -> "TSForecastingExperiment":
-        """Should multiplicative components be allowed in certain models?
-        These only work if the data is strictly positive.
+    def _set_strictly_positive(self) -> "TSForecastingExperiment":
+        """Sets parameter to indicate whether the data is strictly positive or not.
+        Useful for determining wherher multiplicative components should be allowed
+        in certain models or not.
 
         Returns
         -------
         TSForecastingExperiment
             The experiment object to allow chaining of methods
         """
-        self.logger.info("Set up whether Multiplicative components allowed.")
+        self.logger.info("Checking if data is strictly positive.")
         # Should multiplicative components be allowed in models that support it
         # NOTE: This can still use all the data to determine if multiplicative
         # components should be potentially allowed, but when eventually deciding
         # they type of seasonality (multiplicative or additive), we should respect
         # the users choice in hyperparameter_split.
         self.strictly_positive = np.all(self.y_transformed > 0)
         return self
 
+    def _set_seasonal_type(self, seasonality_type: str) -> "TSForecastingExperiment":
+        """Sets the seasonal type to be used in the models.
+
+        The detection flow sequence is as follows:
+        (1) If seasonality is not detected, then seasonality type is set to None.
+        (2) If seasonality is detected but data is not strictly positive, then
+        seasonality type is set to "add".
+        (3) If seasonality_type is "auto", then the type of seasonality is
+        determined using an internal algorithm as follows
+            - If seasonality is detected, then data is decomposed using additive
+            and multiplicative seasonal decomposition. Then seasonality type is
+            selected based on seasonality strength per FPP
+            (https://otexts.com/fpp2/seasonal-strength.html).
+            NOTE: For Multiplicative, the denominator multiplies the seasonal and
+            residual components instead of adding them. Rest of the calculations
+            remain the same. If seasonal decompositon fails for any reason, then
+            defaults to multiplicative seasonality.
+        (4) Otherwise, seasonality_type is set to the user provided value.
+
+        Parameters
+        ----------
+        seasonality_type : str
+            The type of seasonality to use. Allowed values are ["add", "mul" or "auto"]
+
+        Returns
+        -------
+        TSForecastingExperiment
+            The experiment object to allow chaining of methods
+        """
+        self.logger.info("Setting the seasonal component type - 'add' or 'mul'.")
+        self._set_strictly_positive()
+
+        # ---------------------------------------------------------------------#
+        # Override seasonality_type depending on various conditons
+        # ---------------------------------------------------------------------#
+        if not self.seasonality_present:
+            seasonality_type = None
+        elif self.seasonality_present and not self.strictly_positive:
+            # Multiplicative components not allowed with non-strictly positive data
+            seasonality_type = "add"
+        elif seasonality_type == "auto":
+            if self.seasonality_present and self.strictly_positive:
+                # Try out additive and multiplicative seasonal decompostion
+                # Check residuals and select the one with the least amount of variance
+                data_to_use = pd.DataFrame(
+                    self._get_y_data(
+                        split=self.hyperparameter_split, data_type="transformed"
+                    )
+                )
+
+                decomp_add = seasonal_decompose(
+                    data_to_use, period=self.primary_sp_to_use, model="additive"
+                )
+                decomp_mult = seasonal_decompose(
+                    data_to_use, period=self.primary_sp_to_use, model="multiplicative"
+                )
+
+                if decomp_add is None or decomp_mult is None:
+                    # None is returned when decomposition fails
+                    # Default to "mul" since it gives better results in benchmarks
+                    seasonality_type = "mul"
+                else:
+                    var_r_add = (np.std(decomp_add.resid)) ** 2
+                    var_rs_add = (np.std(decomp_add.resid + decomp_add.seasonal)) ** 2
+                    var_r_mult = (np.std(decomp_mult.resid)) ** 2
+                    var_rs_mult = (
+                        np.std(decomp_mult.resid * decomp_mult.seasonal)
+                    ) ** 2
+
+                    Fs_add = np.maximum(1 - var_r_add / var_rs_add, 0)
+                    Fs_mult = np.maximum(1 - var_r_mult / var_rs_mult, 0)
+
+                    if Fs_mult > Fs_add:
+                        seasonality_type = "mul"
+                    else:
+                        seasonality_type = "add"
+
+        self.seasonality_type = seasonality_type
+        return self
+
     def _set_is_white_noise(self) -> "TSForecastingExperiment":
         """Is the data being modeled white noise?
 
         Returns
         -------
         TSForecastingExperiment
             The experiment object to allow chaining of methods
@@ -1371,19 +1460,21 @@
         fe_target_rr: Optional[list] = None,
         fe_exogenous: Optional[list] = None,
         fold_strategy: Union[str, Any] = "expanding",
         fold: int = 3,
         fh: Optional[Union[List[int], int, np.ndarray, ForecastingHorizon]] = 1,
         hyperparameter_split: str = "all",
         seasonal_period: Optional[Union[List[Union[int, str]], int, str]] = None,
+        ignore_seasonality_test: bool = False,
         sp_detection: str = "auto",
         max_sp_to_consider: Optional[int] = 60,
         remove_harmonics: bool = False,
         harmonic_order_method: str = "harmonic_max",
         num_sps_to_use: int = 1,
+        seasonality_type: str = "mul",
         point_alpha: Optional[float] = None,
         coverage: Union[float, List[float]] = 0.9,
         enforce_exogenous: bool = True,
         n_jobs: Optional[int] = -1,
         use_gpu: bool = False,
         custom_pipeline: Optional[Any] = None,
         html: bool = True,
@@ -1621,16 +1712,15 @@
             whether the data is white noise or not, the values of non-seasonal difference
             "d" and seasonal difference "D" to use in certain models.
             Allowed values are: ["all", "train"].
             Refer for more details: https://github.com/pycaret/pycaret/issues/3202
 
 
         seasonal_period: list or int or str, default = None
-            Seasonal periods to check when performing seasonality checks (i.e. candidates).
-            If not provided, then candidates are detected per the sp_detection setting.
+            Seasonal periods to use when performing seasonality checks (i.e. candidates).
 
             Users can provide `seasonal_period` by passing it as an integer or a
             string corresponding to the keys below (e.g. 'W' for weekly data,
             'M' for monthly data, etc.).
                 * B, C = 5
                 * D = 7
                 * W = 52
@@ -1643,14 +1733,29 @@
                 * S = 60
 
             Users can also provide a list of such values to use in models that
             accept multiple seasonal values (currently TBATS). For models that
             don't accept multiple seasonal values, the first value of the list
             will be used as the seasonal period.
 
+            NOTE:
+            (1) If seasonal_period is provided, whether the seasonality check is
+            performed or not depends on the ignore_seasonality_test setting.
+            (2) If seasonal_period is not provided, then the candidates are detected
+            per the sp_detection setting. If seasonal_period is provided,
+            sp_detection setting is ignored.
+
+
+        ignore_seasonality_test: bool = False
+            Whether to ignore the seasonality test or not. Applicable when seasonal_period
+            is provided. If False, then a seasonality tests is performed to determine
+            if the provided seasonal_period is valid or not. If it is found to be not
+            valid, no seasonal period is used for modeling. If True, then the the
+            provided seasonal_period is used as is.
+
 
         sp_detection: str, default = "auto"
             If seasonal_period is None, then this parameter determines the algorithm
             to use to detect the seasonal periods to use in the models.
 
             Allowed values are ["auto" or "index"].
 
@@ -1692,14 +1797,34 @@
             It determines the maximum number of seasonal periods to use in the models.
             Set to -1 to use all detected seasonal periods (in models that allow
             multiple seasonalities). If a model only allows one seasonal period
             and num_sps_to_use > 1, then the most dominant (primary) seasonal
             that is detected is used.
 
 
+        seasonality_type : str, default = "mul"
+            The type of seasonality to use. Allowed values are ["add", "mul" or "auto"]
+
+            The detection flow sequence is as follows:
+            (1) If seasonality is not detected, then seasonality type is set to None.
+            (2) If seasonality is detected but data is not strictly positive, then
+            seasonality type is set to "add".
+            (3) If seasonality_type is "auto", then the type of seasonality is
+            determined using an internal algorithm as follows
+                - If seasonality is detected, then data is decomposed using
+                additive and multiplicative seasonal decomposition. Then
+                seasonality type is selected based on seasonality strength
+                per FPP (https://otexts.com/fpp2/seasonal-strength.html). NOTE:
+                For Multiplicative, the denominator multiplies the seasonal and
+                residual components instead of adding them. Rest of the
+                calculations remain the same. If seasonal decompositon fails for
+                any reason, then defaults to multiplicative seasonality.
+            (4) Otherwise, seasonality_type is set to the user provided value.
+
+
         point_alpha: Optional[float], default = None
             The alpha (quantile) value to use for the point predictions. By default
             this is set to None which uses sktime's predict() method to get the
             point prediction (the mean or the median of the forecast distribution).
             If this is set to a floating point value, then it switches to using the
             predict_quantiles() method to get the point prediction at the user
             specified quantile.
@@ -1922,33 +2047,42 @@
                 f"hyperparameters_using must be one of '{', '.join(allowed_hyperparameter_splits)}'. "
                 f"You provided {hyperparameter_split}."
             )
         self.hyperparameter_split = hyperparameter_split
 
         # Variables related to seasonal period and detection ----
         self.seasonal_period = seasonal_period
+        self.ignore_seasonality_test = ignore_seasonality_test
         if sp_detection not in ["auto", "index"]:
             raise ValueError(
                 "sp_detection must be either 'auto' or 'index'. "
                 f"You provided {sp_detection}."
             )
-        self.sp_detection = sp_detection
+        if self.seasonal_period is not None:
+            self.sp_detection = "user_defined"
+        else:
+            self.sp_detection = sp_detection
         self.max_sp_to_consider = max_sp_to_consider
         self.remove_harmonics = remove_harmonics
         if harmonic_order_method not in [
             "harmonic_strength",
             "harmonic_max",
             "raw_strength",
         ]:
             raise ValueError(
                 "harmonic_order_method must be either 'harmonic_strength', 'harmonic_max' "
                 f"or 'raw_strength'. You provided {harmonic_order_method}."
             )
         self.harmonic_order_method = harmonic_order_method
         self.num_sps_to_use = num_sps_to_use
+        if seasonality_type not in ["mul", "add", "auto"]:
+            raise ValueError(
+                "seasonality_type must be either 'mul', 'add' or 'auto'. "
+                f"You provided {seasonality_type}."
+            )
 
         self.log_plots_param = log_plots
         if self.log_plots_param is True:
             self.log_plots_param = self._get_default_plots_to_log()
 
         # Needed for compatibility with Regression and Classification.
         # Not used in Time Series
@@ -1987,15 +2121,15 @@
             ._initialize_pipeline()
             ##################################################################
             # Do these after the preprocessing pipeline has been setup.
             # Since the model will see transformed data, these parameters
             # should also be derived from the transformed data.
             ##################################################################
             ._check_and_set_seasonal_period()
-            ._set_multiplicative_components()
+            ._set_seasonal_type(seasonality_type=seasonality_type)
             ._perform_setup_eda()
             ._setup_display_container()
             ._profile(profile, profile_kwargs)
             ._set_exp_model_engines(
                 container_default_engines=get_container_default_engines(),
                 engine=engine,
             )
@@ -2062,15 +2196,14 @@
         errors: str = "ignore",
         fit_kwargs: Optional[dict] = None,
         experiment_custom_tags: Optional[Dict[str, Any]] = None,
         engine: Optional[Dict[str, str]] = None,
         verbose: bool = True,
         parallel: Optional[ParallelBackend] = None,
     ):
-
         """
         This function trains and evaluates performance of all estimators available in the
         model library using cross validation. The output of this function is a score grid
         with average cross validated scores. Metrics evaluated during CV can be accessed
         using the ``get_metrics`` function. Custom metrics can be added or removed using
         ``add_metric`` and ``remove_metric`` function.
 
@@ -2216,15 +2349,14 @@
         cross_validation: bool = True,
         fit_kwargs: Optional[dict] = None,
         experiment_custom_tags: Optional[Dict[str, Any]] = None,
         engine: Optional[str] = None,
         verbose: bool = True,
         **kwargs,
     ):
-
         """
         This function trains and evaluates the performance of a given estimator
         using cross validation. The output of this function is a score grid with
         CV scores by fold. Metrics evaluated during CV can be accessed using the
         ``get_metrics`` function. Custom metrics can be added or removed using
         ``add_metric`` and ``remove_metric`` function. All the available models
         can be accessed using the ``models`` function.
@@ -2251,29 +2383,28 @@
             * 'naive' - Naive Forecaster
             * 'grand_means' - Grand Means Forecaster
             * 'snaive' - Seasonal Naive Forecaster (disabled when seasonal_period = 1)
             * 'polytrend' - Polynomial Trend Forecaster
             * 'arima' - ARIMA family of models (ARIMA, SARIMA, SARIMAX)
             * 'auto_arima' - Auto ARIMA
             * 'exp_smooth' - Exponential Smoothing
+            * 'stlf' - STL Forecaster
             * 'croston' - Croston Forecaster
             * 'ets' - ETS
             * 'theta' - Theta Forecaster
             * 'tbats' - TBATS
             * 'bats' - BATS
             * 'prophet' - Prophet Forecaster
             * 'lr_cds_dt' - Linear w/ Cond. Deseasonalize & Detrending
             * 'en_cds_dt' - Elastic Net w/ Cond. Deseasonalize & Detrending
             * 'ridge_cds_dt' - Ridge w/ Cond. Deseasonalize & Detrending
             * 'lasso_cds_dt' - Lasso w/ Cond. Deseasonalize & Detrending
-            * 'lar_cds_dt' -   Least Angular Regressor w/ Cond. Deseasonalize & Detrending
             * 'llar_cds_dt' - Lasso Least Angular Regressor w/ Cond. Deseasonalize & Detrending
             * 'br_cds_dt' - Bayesian Ridge w/ Cond. Deseasonalize & Deseasonalize & Detrending
             * 'huber_cds_dt' - Huber w/ Cond. Deseasonalize & Detrending
-            * 'par_cds_dt' - Passive Aggressive w/ Cond. Deseasonalize & Detrending
             * 'omp_cds_dt' - Orthogonal Matching Pursuit w/ Cond. Deseasonalize & Detrending
             * 'knn_cds_dt' - K Neighbors w/ Cond. Deseasonalize & Detrending
             * 'dt_cds_dt' - Decision Tree w/ Cond. Deseasonalize & Detrending
             * 'rf_cds_dt' - Random Forest w/ Cond. Deseasonalize & Detrending
             * 'et_cds_dt' - Extra Trees w/ Cond. Deseasonalize & Detrending
             * 'gbr_cds_dt' - Gradient Boosting w/ Cond. Deseasonalize & Detrending
             * 'ada_cds_dt' - AdaBoost w/ Cond. Deseasonalize & Detrending
@@ -2599,15 +2730,14 @@
         choose_better: bool = True,
         fit_kwargs: Optional[dict] = None,
         return_tuner: bool = False,
         verbose: bool = True,
         tuner_verbose: Union[int, bool] = True,
         **kwargs,
     ):
-
         """
         This function tunes the hyperparameters of a given estimator. The output of
         this function is a score grid with CV scores by fold of the best selected
         model based on ``optimize`` parameter. Metrics evaluated during CV can be
         accessed using the ``get_metrics`` function. Custom metrics can be added
         or removed using ``add_metric`` and ``remove_metric`` function.
 
@@ -2947,15 +3077,14 @@
             )
             suffixes.append("final_estimator")
 
         gc.collect()
 
         # with estimator_pipeline(self.pipeline, model) as pipeline_with_model:
         if True:
-
             ###############################################
             # Add the correct model to the pipeline ####
             ###############################################
             # Since we are always fitting the model here, we can just append the pipeline
             # irrespective of whether the data is the training data (y_train, X_train), or
             # the full data (y, X), The fitting process will take care of this appropriately.
             pipeline_with_model = _add_model_to_pipeline(
@@ -3110,15 +3239,14 @@
 
         # end runtime
         runtime_end = time.time()
         runtime = np.array(runtime_end - runtime_start).round(2)
 
         # mlflow logging
         if self.logging_param:
-
             avgs_dict_log = {
                 k: v
                 for k, v in model_results.loc[
                     self._get_return_train_score_indices_for_logging(
                         return_train_score=False
                     )
                 ].items()
@@ -3165,21 +3293,18 @@
         round: int = 4,
         choose_better: bool = False,
         optimize: str = "MASE",
         weights: Optional[List[float]] = None,
         fit_kwargs: Optional[dict] = None,
         verbose: bool = True,
     ):
-
         """
         This function trains a EnsembleForecaster for select models passed in the
-        ``estimator_list`` param. The output of this function is a score grid with
-        CV scores by fold. Metrics evaluated during CV can be accessed using the
-        ``get_metrics`` function. Custom metrics can be added or removed using
-        ``add_metric`` and ``remove_metric`` function.
+        ``estimator_list`` param. Trains a sktime EnsembleForecaster under the hood.
+        Refer to it's documentation for more details.
 
 
         Example
         --------
         >>> from pycaret.datasets import get_data
         >>> airline = get_data('airline')
         >>> from pycaret.time_series import *
@@ -3193,16 +3318,18 @@
 
 
         method: str, default = 'mean'
             Method to average the individual predictions to form a final prediction.
             Available Methods:
 
             * 'mean' - Mean of individual predictions
+            * 'gmean' - Geometric Mean of individual predictions
             * 'median' - Median of individual predictions
-            * 'voting' - Vote individual predictions based on the provided weights.
+            * 'min' - Minimum of individual predictions
+            * 'max' - Maximum of individual predictions
 
 
         fold: int or scikit-learn compatible CV generator, default = None
             Controls cross-validation. If None, the CV generator in the ``fold_strategy``
             parameter of the ``setup`` function is used. When an integer is passed,
             it is interpreted as the 'n_splits' parameter of the CV generator in the
             ``setup`` function.
@@ -3218,32 +3345,37 @@
 
 
         optimize: str, default = 'MASE'
             Metric to compare for model selection when ``choose_better`` is True.
 
 
         weights: list, default = None
-            Sequence of weights (float or int) to weight the occurrences of predicted class
-            labels (hard voting) or class probabilities before averaging (soft voting). Uses
-            uniform weights when None.
+            Sequence of weights (float or int) to apply to the individual model
+            predictons. Uses uniform weights when None. Note that weights only
+            apply 'mean', 'gmean' and 'median' methods.
 
 
         fit_kwargs: dict, default = {} (empty dict)
             Dictionary of arguments passed to the fit method of the model.
 
 
         verbose: bool, default = True
             Score grid is not printed when verbose is set to False.
 
 
         Returns:
             Trained Model
-
-
         """
+        msg = (
+            "method 'voting' is not supported from pycaret 3.0.1 onwards. "
+            "Please use method = 'mean' and pass the weights to mimic the "
+            "functionality of 'voting' blender from prior releases."
+        )
+        if method == "voting":
+            raise ValueError(msg)
 
         return super().blend_models(
             estimator_list=estimator_list,
             fold=fold,
             round=round,
             choose_better=choose_better,
             optimize=optimize,
@@ -3810,15 +3942,14 @@
         return_data: bool = False,
         verbose: bool = False,
         display_format: Optional[str] = None,
         data_kwargs: Optional[Dict] = None,
         fig_kwargs: Optional[Dict] = None,
         save: Union[str, bool] = False,
     ) -> Optional[Tuple[str, list]]:
-
         """
         This function analyzes the performance of a trained model on holdout set.
         When used without any estimator, this function generates plots on the
         original data set. When used with an estimator, it will generate plots on
         the model residuals.
 
 
@@ -4350,15 +4481,14 @@
         X: Optional[pd.DataFrame] = None,
         return_pred_int: bool = False,
         alpha: Optional[float] = None,
         coverage: Union[float, List[float]] = 0.9,
         round: int = 4,
         verbose: bool = True,
     ) -> pd.DataFrame:
-
         """
         This function forecast using a trained model. When ``fh`` is None,
         it forecasts using the same forecast horizon used during the
         training.
 
 
         Example
@@ -4469,15 +4599,14 @@
     def finalize_model(
         self,
         estimator,
         fit_kwargs: Optional[dict] = None,
         model_only: bool = False,
         experiment_custom_tags: Optional[Dict[str, Any]] = None,
     ) -> Any:
-
         """
         This function trains a given estimator on the entire dataset including the
         holdout set.
 
 
         Example
         --------
@@ -4517,15 +4646,14 @@
     def deploy_model(
         self,
         model,
         model_name: str,
         authentication: dict,
         platform: str = "aws",
     ):
-
         """
         This function deploys the transformation pipeline and trained model on cloud.
 
 
         Example
         -------
         >>> from pycaret.datasets import get_data
@@ -4605,15 +4733,14 @@
             authentication=authentication,
             platform=platform,
         )
 
     def save_model(
         self, model, model_name: str, model_only: bool = False, verbose: bool = True
     ):
-
         """
         This function saves the transformation pipeline and trained model object
         into the current working directory as a pickle file for later use.
 
         Example
         -------
         >>> from pycaret.datasets import get_data
@@ -4653,15 +4780,14 @@
     def load_model(
         self,
         model_name: str,
         platform: Optional[str] = None,
         authentication: Optional[Dict[str, str]] = None,
         verbose: bool = True,
     ):
-
         """
         This function loads a previously saved pipeline/model.
 
         Example
         -------
         >>> from pycaret.time_series import load_model
         >>> saved_arima = load_model('saved_arima_model')
@@ -4759,15 +4885,14 @@
 
     def models(
         self,
         type: Optional[str] = None,
         internal: bool = False,
         raise_errors: bool = True,
     ) -> pd.DataFrame:
-
         """
         Returns table of models available in the model library.
 
         Example
         -------
         >>> from pycaret.datasets import get_data
         >>> data = get_data('airline')
@@ -4830,15 +4955,14 @@
 
     def get_metrics(
         self,
         reset: bool = False,
         include_custom: bool = True,
         raise_errors: bool = True,
     ) -> pd.DataFrame:
-
         """
         Returns table of available metrics used for CV.
 
 
         Example
         -------
         >>> from pycaret.datasets import get_data
@@ -4875,15 +4999,14 @@
         self,
         id: str,
         name: str,
         score_func: type,
         greater_is_better: bool = True,
         **kwargs,
     ) -> pd.Series:
-
         """
         Adds a custom metric to be used for CV.
 
 
         Example
         -------
         >>> from pycaret.datasets import get_data
@@ -4925,15 +5048,14 @@
             score_func=score_func,
             target="pred",
             greater_is_better=greater_is_better,
             **kwargs,
         )
 
     def remove_metric(self, name_or_id: str):
-
         """
         Removes a metric from CV.
 
 
         Example
         -------
         >>> from pycaret.datasets import get_data
@@ -4952,15 +5074,14 @@
 
         """
         return super().remove_metric(name_or_id=name_or_id)
 
     def get_logs(
         self, experiment_name: Optional[str] = None, save: bool = False
     ) -> pd.DataFrame:
-
         """
         Returns a table of experiment logs. Only works when ``log_experiment``
         is True when initializing the ``setup`` function.
 
 
         Example
         -------
@@ -4988,15 +5109,14 @@
         return super().get_logs(experiment_name=experiment_name, save=save)
 
     def get_fold_generator(
         self,
         fold: Optional[Union[int, Any]] = None,
         fold_strategy: Optional[str] = None,
     ) -> Union[ExpandingWindowSplitter, SlidingWindowSplitter]:
-
         """Returns the cv object based on number of folds and fold_strategy
 
         Parameters
         ----------
         fold : Optional[Union[int, Any]]
             The number of folds (int), by default None which returns the fold generator
             (cv object) defined during setup. Could also be a sktime cross-validation object.
```

## pycaret/utils/__init__.py

```diff
@@ -1,20 +1,12 @@
 def version():
     from pycaret import version_
 
     return version_
 
 
-def nightly_version():
-    from pycaret import nightly_version_
-
-    return nightly_version_
-
-
 # Hack to lazy import __version__ from `pycaret`.
 # Needed to avoid a circular dependency.
 def __getattr__(name):
     if name in ("__version__", "version_"):
         return version()
-    if name in ("nightly_version_"):
-        return nightly_version()
     raise AttributeError(f"module '{__name__}' has no attribute '{name}'")
```

## pycaret/utils/datetime.py

```diff
@@ -55,14 +55,16 @@
 
         if not inplace:
             return data_
 
     elif not inplace:
         return data
 
+    return None
+
 
 def coerce_datetime_to_period_index(
     data: Optional[Union[pd.Series, pd.DataFrame, Any]],
     freq: Optional[str] = None,
     inplace: bool = False,
 ) -> Optional[Union[pd.Series, pd.DataFrame, Any]]:
     """Converts a dataframe or series index from DatetimeIndex to PeriodIndex
@@ -101,7 +103,9 @@
                 data_.index = data_.index.to_period(freq=freq)
 
         if not inplace:
             return data_
 
     elif not inplace:
         return data
+
+    return None
```

## pycaret/utils/generic.py

```diff
@@ -1,9 +1,10 @@
 import functools
 import inspect
+import traceback
 import warnings
 from collections.abc import Mapping
 from copy import deepcopy
 from enum import Enum, auto
 from typing import TYPE_CHECKING, Any, Callable, Dict, List, Optional, Set, Tuple, Union
 
 import numpy as np
@@ -106,34 +107,35 @@
 
         # Convert all column names to str
         data = data.rename(columns=lambda col: str(col))
 
     return data
 
 
-def to_series(data, index=None, name="target"):
+def to_series(data, index=None, name=None):
     """Convert a column to pd.Series.
 
     Parameters
     ----------
     data: sequence or None
         Data to convert. If None, return unchanged.
 
     index: sequence or Index, optional (default=None)
         Values for the indices.
 
-    name: string, optional (default="target")
-        Name of the target column.
+    name: string, optional (default=None)
+        Name of the target column. If None, defaults to "target".
 
     Returns
     -------
     series: pd.Series or None
         Transformed series.
 
     """
+    name = name or "target"
     if data is not None and not isinstance(data, pd.Series):
         if isinstance(data, pd.DataFrame):
             try:
                 data = data[name]
             except Exception:
                 data = data.squeeze()
         elif isinstance(data, np.ndarray) and data.ndim > 1:
@@ -193,15 +195,14 @@
     elif X is None:
         return y
     else:
         return X, y
 
 
 def get_config(variable: str, globals_d: dict):
-
     """
     This function is used to access global environment variables.
 
     Example
     -------
     >>> X_train = get_config('X_train')
 
@@ -234,15 +235,14 @@
         "get_config() successfully completed......................................"
     )
 
     return global_var
 
 
 def set_config(variable: str, value, globals_d: dict):
-
     """
     This function is used to reset global environment variables.
 
     Example
     -------
     >>> set_config('seed', 123)
 
@@ -491,15 +491,14 @@
 def calculate_unsupervised_metrics(
     metrics: Dict[str, "pycaret.containers.metrics.MetricContainer"],
     X,
     labels,
     ground_truth: Optional[Any] = None,
     score_dict: Optional[Dict[str, np.array]] = None,
 ) -> Dict[str, np.array]:
-
     score_dict = []
 
     for k, v in metrics.items():
         score_dict.append(
             _calculate_unsupervised_metric(
                 v, v.score_func, v.display_name, X, labels, ground_truth
             )
@@ -522,14 +521,15 @@
     target = ground_truth if container.needs_ground_truth else X
     if target is None:
         calculated_metric = 0
     else:
         try:
             calculated_metric = score_func(target, labels, **container.args)
         except Exception:
+            warnings.warn(traceback.format_exc())
             calculated_metric = 0
 
     return (display_name, calculated_metric)
 
 
 def get_function_params(function: Callable) -> Set[str]:
     return inspect.signature(function).parameters
@@ -540,15 +540,14 @@
     y_test,
     pred,
     pred_proba: Optional[float] = None,
     score_dict: Optional[Dict[str, np.array]] = None,
     weights: Optional[list] = None,
     **additional_kwargs,
 ) -> Dict[str, np.array]:
-
     score_dict = []
 
     for k, v in metrics.items():
         score_dict.append(
             _calculate_metric(
                 v,
                 v.score_func,
@@ -576,17 +575,19 @@
         **{k: v for k, v in kwargs.items() if k in get_function_params(score_func)},
         **container.args,
     }
     target = pred_proba if container.target == "pred_proba" else pred_
     try:
         calculated_metric = score_func(y_test, target, sample_weight=weights, **kwargs)
     except Exception:
+
         try:
             calculated_metric = score_func(y_test, target, **kwargs)
         except Exception:
+            warnings.warn(traceback.format_exc())
             calculated_metric = 0
 
     return display_name, calculated_metric
 
 
 def normalize_custom_transformers(
     transformers: Union[Any, Tuple[str, Any], List[Any], List[Tuple[str, Any]]]
@@ -1066,15 +1067,14 @@
 def check_metric(
     actual: pd.Series,
     prediction: pd.Series,
     metric: str,
     round: int = 4,
     train: Optional[pd.Series] = None,
 ):
-
     """
     Function to evaluate classification, regression and timeseries metrics.
 
 
     actual : pandas.Series
         Actual values of the target variable.
 
@@ -1169,15 +1169,14 @@
         "This function is no longer necessary in pycaret>=3.0 "
         "and will be removed with release 3.2.0",
         DeprecationWarning,
     )
 
 
 def get_system_logs():
-
     """
     Read and print 'logs.log' file from current active directory
     """
 
     with open("logs.log", "r") as file:
         lines = file.read().splitlines()
```

## pycaret/utils/time_series/__init__.py

```diff
@@ -204,15 +204,14 @@
             return seasonal_period
         else:
             raise ValueError(
                 f"Unsupported Period frequency: {str_freq}, valid Period frequency "
                 f"suffixes are: {', '.join(SeasonalPeriod.__members__.keys())}"
             )
     else:
-
         if str_freq in SeasonalPeriod.__members__:
             seasonal_period = SeasonalPeriod[str_freq].value
             return seasonal_period
         else:
             raise ValueError(
                 f"Unsupported Period frequency: {str_freq}, valid Period frequency "
                 f"suffixes are: {', '.join(SeasonalPeriod.__members__.keys())}"
@@ -255,17 +254,15 @@
 
     nobs = len(yt)
     # Increasing lags otherwise high sp values are not detected since they are
     # limited by internal nlags calculation in SeasonalityACF
     # lags_to_use = min(10 * np.log10(nobs), nobs - 1)
     # lags_to_use = max(lags_to_use, nobs/3)
     lags_to_use = int((nobs - 1) / 2)
-    # +1 added since SeasonalityACF uses uses upto nlags-1
-    # TODO: Remove after https://github.com/sktime/sktime/issues/4169 is fixed
-    sp_est = SeasonalityACF(nlags=lags_to_use + 1)
+    sp_est = SeasonalityACF(nlags=lags_to_use)
     sp_est.fit(yt)
 
     primary_sp = sp_est.get_fitted_params().get("sp")
     significant_sps = sp_est.get_fitted_params().get("sp_significant")
     if isinstance(significant_sps, np.ndarray):
         significant_sps = significant_sps.tolist()
 
@@ -358,14 +355,79 @@
                 final_filtered_sps.append(sp_iter)
         # Replacement for ordered set: https://stackoverflow.com/a/53657523/8925915
         final_filtered_sps = list(dict.fromkeys(final_filtered_sps))
 
     return final_filtered_sps
 
 
+def clean_time_index(
+    data: pd.DataFrame, freq: str, index_col: Optional[str] = None
+) -> pd.DataFrame:
+    """Cleans and sets the index of the dataframe in a pycaret compliant format.
+
+    Allowed index in pycaret can be of type Int64Index, DatetimeIndex, or PeriodIndex.
+    Steps followed by this function (in order) are as follows:
+    1. If column is provided and is of type string, it is converted to PerodIndex.
+    2. If column is provided, it is set as index
+    3. If Index is DataTimeIndex, it is converted to PeriodIndex (IntIndex is left as is)
+    2. If Index is PeriodIndex, then missing index values are added and filled with np.nan.
+
+    Parameters
+    ----------
+    data : pd.DataFrame
+        Data that needs to have its index cleaned
+    freq : str
+        The frequency of the data. Valid values are the ones that can be provided
+        to pd.period_range, pd.PeriodIndex, pd.to_period. Examples: "H", "D", "M".
+    index_col : Optional[str], optional
+        If index values are in a column, then this argument is the column name,
+        by default None which assumes that the index has already been set.
+
+    Returns
+    -------
+    pd.DataFrame
+        Cleaned data with index = PeriodIndex or IntIndex and with missing index
+        values filled with np.nan (if PeriodIndex only).
+    """
+    data_ = data.copy()
+
+    # Step 1: Set the index if not already set
+    if index_col is not None:
+        # If column has string values, convert to PeriodIndex since pycaret
+        # works best with PeriodIndex. For all other index types (DatetimeIndex,
+        # PeriodIndex, Int64Index), leave as is.
+        if isinstance(data_[index_col][0], str):
+            data_[index_col] = pd.PeriodIndex(data_[index_col], freq=freq)
+        data_.set_index(index_col, inplace=True)
+
+    # Step 2: Convert DateTimeIndex to PeriodIndex (IntIndex is left as is)
+    if isinstance(data_.index, pd.DatetimeIndex):
+        try:
+            data_.index = data_.index.to_period(freq=freq)
+        except AttributeError:
+            raise AttributeError(
+                f"You are using a frequency of '{freq}' along with a DatetimeIndex. "
+                "PyCaret internally converts DateTimeIndex to PeriodIndex and this "
+                "frequency is not supported by PeriodIndex.\nAs an alternative, you "
+                "can convert the index to Int64Index by using the following code "
+                "and pass to pycaret:\n"
+                ">>> data.index = data.index.astype('int64') "
+                "\nLater, when you get the results back from "
+                "pycaret, you can convert them back to DatetimeIndex by using:\n"
+                ">>> data.index = pd.to_datetime(data.index)"
+            )
+
+    # Step 3: Fill missing index values (only if index is PeriodIndex, not for IntIndex)
+    if isinstance(data_.index, pd.PeriodIndex):
+        idx = pd.period_range(min(data_.index), max(data_.index), freq=freq)
+        data_ = data_.reindex(idx, fill_value=np.nan)
+
+    return data_
+
+
 class SeasonalPeriod(IntEnum):
     """ENUM corresponding to Seasonal Periods
 
     Currently supports a subset of these. Eventually try to support all.
     https://stackoverflow.com/questions/35339139/what-values-are-valid-in-pandas-freq-tags/35339226#35339226
     B        business day frequency
     C        custom business day frequency
```

## pycaret/utils/time_series/forecasting/model_selection.py

```diff
@@ -165,15 +165,15 @@
         if error_score == "raise":
             raise
 
     fit_time = time.time() - start
 
     # Determine Cutoff ----
     # NOTE: Cutoff is available irrespective of whether fit passed or failed
-    cutoff = pipeline.cutoff
+    cutoff = pipeline.cutoff[0]
 
     # Score the model ----
     lower = pd.Series(dtype="float64")
     upper = pd.Series(dtype="float64")
     if pipeline.is_fitted:
         y_pred, lower, upper = get_predictions_with_intervals(
             forecaster=pipeline, alpha=alpha, coverage=coverage, X=X_test
```

## Comparing `pycaret-3.0.0rc9.dist-info/LICENSE` & `pycaret-3.0.1.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `pycaret-3.0.0rc9.dist-info/METADATA` & `pycaret-3.0.1.dist-info/METADATA`

 * *Files 21% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: pycaret
-Version: 3.0.0rc9
+Version: 3.0.1
 Summary: PyCaret - An open source, low-code machine learning library in Python.
 Home-page: https://github.com/pycaret/pycaret
 Author: Moez Ali
 Author-email: moez.ali@queensu.ca
 License: MIT
 Platform: UNKNOWN
 Classifier: License :: OSI Approved :: MIT License
@@ -17,21 +17,21 @@
 Classifier: Operating System :: OS Independent
 Requires-Python: >=3.7
 Description-Content-Type: text/markdown
 License-File: LICENSE
 Requires-Dist: ipython (>=5.5.0)
 Requires-Dist: ipywidgets (>=7.6.5)
 Requires-Dist: tqdm (>=4.62.0)
-Requires-Dist: numpy (<1.25,>=1.21)
-Requires-Dist: pandas (<1.6.0,>=1.3.0)
+Requires-Dist: numpy (<1.24,>=1.21)
+Requires-Dist: pandas (<2.0.0,>=1.3.0)
 Requires-Dist: jinja2 (>=1.2)
 Requires-Dist: scipy (<2.0.0)
 Requires-Dist: joblib (>=1.2.0)
 Requires-Dist: scikit-learn (>=1.0)
-Requires-Dist: pyod (>=0.9.8)
+Requires-Dist: pyod (>=1.0.8)
 Requires-Dist: imbalanced-learn (>=0.8.1)
 Requires-Dist: category-encoders (>=2.4.0)
 Requires-Dist: lightgbm (>=3.0.0)
 Requires-Dist: numba (>=0.55.0)
 Requires-Dist: requests (>=2.27.1)
 Requires-Dist: psutil (>=5.9.0)
 Requires-Dist: markupsafe (>=2.0.1)
@@ -41,242 +41,349 @@
 Requires-Dist: deprecation (>=2.1.0)
 Requires-Dist: xxhash
 Requires-Dist: matplotlib (>=3.3.0)
 Requires-Dist: scikit-plot (>=0.3.7)
 Requires-Dist: yellowbrick (>=1.4)
 Requires-Dist: plotly (>=5.0.0)
 Requires-Dist: kaleido (>=0.2.1)
-Requires-Dist: schemdraw (>=0.14)
-Requires-Dist: plotly-resampler (>=0.7.2.2)
+Requires-Dist: schemdraw (==0.15)
+Requires-Dist: plotly-resampler (>=0.8.3.1)
 Requires-Dist: statsmodels (>=0.12.1)
-Requires-Dist: sktime (>=0.15.0)
-Requires-Dist: tbats (>=1.1.0)
+Requires-Dist: sktime (!=0.17.1,<0.17.2,>=0.16.1)
+Requires-Dist: tbats (>=1.1.3)
 Requires-Dist: pmdarima (!=1.8.1,<3.0.0,>=1.8.0)
+Requires-Dist: wurlitzer ; platform_system != "Windows"
 Requires-Dist: pickle5 ; python_version < "3.8"
 Provides-Extra: analysis
 Requires-Dist: shap (>=0.38.0) ; extra == 'analysis'
 Requires-Dist: interpret (>=0.2.7) ; extra == 'analysis'
 Requires-Dist: umap-learn (>=0.5.2) ; extra == 'analysis'
 Requires-Dist: pandas-profiling (>=3.1.0) ; extra == 'analysis'
 Requires-Dist: explainerdashboard (>=0.3.8) ; extra == 'analysis'
+Requires-Dist: Flask (==2.2.3) ; extra == 'analysis'
 Requires-Dist: autoviz (>=0.1.36) ; extra == 'analysis'
+Requires-Dist: holoviews (<=1.14.9) ; extra == 'analysis'
 Requires-Dist: fairlearn (==0.7.0) ; extra == 'analysis'
 Requires-Dist: deepchecks (>=0.9.2) ; extra == 'analysis'
 Provides-Extra: full
 Requires-Dist: shap (>=0.38.0) ; extra == 'full'
 Requires-Dist: interpret (>=0.2.7) ; extra == 'full'
 Requires-Dist: umap-learn (>=0.5.2) ; extra == 'full'
 Requires-Dist: pandas-profiling (>=3.1.0) ; extra == 'full'
 Requires-Dist: explainerdashboard (>=0.3.8) ; extra == 'full'
+Requires-Dist: Flask (==2.2.3) ; extra == 'full'
 Requires-Dist: autoviz (>=0.1.36) ; extra == 'full'
+Requires-Dist: holoviews (<=1.14.9) ; extra == 'full'
 Requires-Dist: fairlearn (==0.7.0) ; extra == 'full'
 Requires-Dist: deepchecks (>=0.9.2) ; extra == 'full'
 Requires-Dist: xgboost (>=1.1.0) ; extra == 'full'
 Requires-Dist: catboost (>=0.23.2) ; extra == 'full'
 Requires-Dist: kmodes (>=0.11.1) ; extra == 'full'
 Requires-Dist: mlxtend (>=0.19.0) ; extra == 'full'
 Requires-Dist: statsforecast (>=0.5.5) ; extra == 'full'
+Requires-Dist: tune-sklearn (>=0.2.1) ; extra == 'full'
+Requires-Dist: ray[tune] (>=1.0.0) ; extra == 'full'
 Requires-Dist: hyperopt (>=0.2.7) ; extra == 'full'
 Requires-Dist: optuna (>=3.0.0) ; extra == 'full'
 Requires-Dist: scikit-optimize (>=0.9.0) ; extra == 'full'
 Requires-Dist: mlflow (<2.0.0,>=1.24.0) ; extra == 'full'
 Requires-Dist: gradio (>=2.8.10) ; extra == 'full'
 Requires-Dist: boto3 (>=1.24.56) ; extra == 'full'
 Requires-Dist: fastapi (>=0.75.0) ; extra == 'full'
 Requires-Dist: uvicorn (>=0.17.6) ; extra == 'full'
 Requires-Dist: m2cgen (>=0.9.0) ; extra == 'full'
-Requires-Dist: evidently (>=0.1.45.dev0) ; extra == 'full'
-Requires-Dist: comet-ml (>=3.31.22) ; extra == 'full'
+Requires-Dist: evidently (<0.3,>=0.1.45.dev0) ; extra == 'full'
 Requires-Dist: fugue (>=0.8.0) ; extra == 'full'
 Requires-Dist: flask (>=2.0.3) ; extra == 'full'
 Requires-Dist: pytest (>=7.0.1) ; extra == 'full'
 Requires-Dist: moto (>=3.0.7) ; extra == 'full'
-Requires-Dist: codecov (>=2.1.12) ; extra == 'full'
 Requires-Dist: fugue[dask] (>=0.8.0) ; extra == 'full'
 Requires-Dist: dash[testing] ; extra == 'full'
 Requires-Dist: scikit-learn-intelex (>=2023.0.1) ; (platform_machine == "x86_64" or platform_machine == "AMD64") and extra == 'full'
-Requires-Dist: tune-sklearn (>=0.2.1) ; (platform_system != "Windows") and extra == 'full'
-Requires-Dist: ray[tune] (>=1.0.0) ; (platform_system != "Windows") and extra == 'full'
 Provides-Extra: mlops
 Requires-Dist: mlflow (<2.0.0,>=1.24.0) ; extra == 'mlops'
 Requires-Dist: gradio (>=2.8.10) ; extra == 'mlops'
 Requires-Dist: boto3 (>=1.24.56) ; extra == 'mlops'
 Requires-Dist: fastapi (>=0.75.0) ; extra == 'mlops'
 Requires-Dist: uvicorn (>=0.17.6) ; extra == 'mlops'
 Requires-Dist: m2cgen (>=0.9.0) ; extra == 'mlops'
-Requires-Dist: evidently (>=0.1.45.dev0) ; extra == 'mlops'
-Requires-Dist: comet-ml (>=3.31.22) ; extra == 'mlops'
+Requires-Dist: evidently (<0.3,>=0.1.45.dev0) ; extra == 'mlops'
 Provides-Extra: models
 Requires-Dist: xgboost (>=1.1.0) ; extra == 'models'
 Requires-Dist: catboost (>=0.23.2) ; extra == 'models'
 Requires-Dist: kmodes (>=0.11.1) ; extra == 'models'
 Requires-Dist: mlxtend (>=0.19.0) ; extra == 'models'
 Requires-Dist: statsforecast (>=0.5.5) ; extra == 'models'
 Requires-Dist: scikit-learn-intelex (>=2023.0.1) ; (platform_machine == "x86_64" or platform_machine == "AMD64") and extra == 'models'
 Provides-Extra: parallel
 Requires-Dist: fugue (>=0.8.0) ; extra == 'parallel'
 Requires-Dist: flask (>=2.0.3) ; extra == 'parallel'
 Provides-Extra: test
 Requires-Dist: pytest (>=7.0.1) ; extra == 'test'
 Requires-Dist: moto (>=3.0.7) ; extra == 'test'
-Requires-Dist: codecov (>=2.1.12) ; extra == 'test'
 Requires-Dist: fugue[dask] (>=0.8.0) ; extra == 'test'
 Requires-Dist: dash[testing] ; extra == 'test'
 Provides-Extra: tuners
+Requires-Dist: tune-sklearn (>=0.2.1) ; extra == 'tuners'
+Requires-Dist: ray[tune] (>=1.0.0) ; extra == 'tuners'
 Requires-Dist: hyperopt (>=0.2.7) ; extra == 'tuners'
 Requires-Dist: optuna (>=3.0.0) ; extra == 'tuners'
 Requires-Dist: scikit-optimize (>=0.9.0) ; extra == 'tuners'
-Requires-Dist: tune-sklearn (>=0.2.1) ; (platform_system != "Windows") and extra == 'tuners'
-Requires-Dist: ray[tune] (>=1.0.0) ; (platform_system != "Windows") and extra == 'tuners'
 
 <div align="center">
-  
+
 <img src="docs/images/logo.png" alt="drawing" width="200"/>
 
-**An open-source, low-code machine learning library in Python** </br>
-:rocket: **PyCaret 3.0-rc is now out. `pip install --pre pycaret`**
-  
+## **An open-source, low-code machine learning library in Python**
+## 🎉🎉🎉 **PyCaret 3.0 is now available. 🎉🎉🎉**
+## `pip install --upgrade pycaret` </br>
+
 <p align="center">
-  <a href="https://www.pycaret.org">Official</a> •
+<h3>
   <a href="https://pycaret.gitbook.io/">Docs</a> •
-  <a href="https://pycaret.gitbook.io/docs/get-started/installation">Install</a> •
   <a href="https://pycaret.gitbook.io/docs/get-started/tutorials">Tutorials</a> •
-  <a href="https://pycaret.gitbook.io/docs/learn-pycaret/faqs">FAQs</a> •
-  <a href="https://pycaret.gitbook.io/docs/learn-pycaret/cheat-sheet">Cheat sheet</a> •
-  <a href="https://github.com/pycaret/pycaret/discussions">Discussions</a> •
-  <a href="https://pycaret.readthedocs.io/en/latest/contribute.html">Contribute</a> •
-  <a href="https://github.com/pycaret/pycaret/tree/master/resources">Resources</a> •
   <a href="https://pycaret.gitbook.io/docs/learn-pycaret/official-blog">Blog</a> •
-  <a href="https://www.linkedin.com/company/pycaret/">LinkedIn</a> • 
-  <a href="https://www.youtube.com/channel/UCxA1YTYJ9BEeo50lxyI_B3g">YouTube</a> • 
-  <a href="https://join.slack.com/t/pycaret/shared_invite/zt-row9phbm-BoJdEVPYnGf7_NxNBP307w">Slack</a>
-
+  <a href="https://www.linkedin.com/company/pycaret/">LinkedIn</a> •
+  <a href="https://www.youtube.com/channel/UCxA1YTYJ9BEeo50lxyI_B3g">YouTube</a> •
+    <a href="https://join.slack.com/t/pycaret/shared_invite/zt-row9phbm-BoJdEVPYnGf7_NxNBP307w">Slack</a>
+</h3>
 </p>
 
-[![Python](https://img.shields.io/badge/Python-3.7%20%7C%203.8%20%7C%203.9-blue)](https://badge.fury.io/py/pycaret) 
-![pytest on push](https://github.com/pycaret/pycaret/workflows/pytest%20on%20push/badge.svg) 
-[![Documentation Status](https://readthedocs.org/projects/pip/badge/?version=stable)](http://pip.pypa.io/en/stable/?badge=stable) 
-[![PyPI version](https://badge.fury.io/py/pycaret.svg)](https://badge.fury.io/py/pycaret) 
-[![License](https://img.shields.io/pypi/l/ansicolortags.svg)](https://img.shields.io/pypi/l/ansicolortags.svg) 
-<!-- [![Git count](http://hits.dwyl.com/pycaret/pycaret/pycaret.svg)](http://hits.dwyl.com/pycaret/pycaret/pycaret) -->
-[![Slack](https://img.shields.io/badge/slack-chat-green.svg?logo=slack)](https://join.slack.com/t/pycaret/shared_invite/zt-row9phbm-BoJdEVPYnGf7_NxNBP307w)
+| Overview | |
+|---|---|
+| **CI/CD** | ![pytest on push](https://github.com/pycaret/pycaret/workflows/pytest%20on%20push/badge.svg) [![Documentation Status](https://readthedocs.org/projects/pip/badge/?version=stable)](http://pip.pypa.io/en/stable/?badge=stable) |
+| **Code** |  [![!pypi](https://img.shields.io/pypi/v/pycaret?color=orange)](https://pypi.org/project/pycaret/) [![!python-versions](https://img.shields.io/badge/Python-3.7%20%7C%203.8%20%7C%203.9%20%7C%203.10-blue)](https://badge.fury.io/py/pycaret) [![!black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)
+| **Downloads**| [![Downloads](https://static.pepy.tech/personalized-badge/pycaret?period=week&units=international_system&left_color=grey&right_color=blue&left_text=weekly%20(pypi))](https://pepy.tech/project/pycaret) [![Downloads](https://static.pepy.tech/personalized-badge/pycaret?period=month&units=international_system&left_color=grey&right_color=blue&left_text=monthly%20(pypi))](https://pepy.tech/project/pycaret) [![Downloads](https://static.pepy.tech/personalized-badge/pycaret?period=total&units=international_system&left_color=grey&right_color=blue&left_text=cumulative%20(pypi))](https://pepy.tech/project/pycaret) |
+| **License** | [![License](https://img.shields.io/pypi/l/ansicolortags.svg)](https://img.shields.io/pypi/l/ansicolortags.svg)
+| **Community** | [![Slack](https://img.shields.io/badge/slack-chat-green.svg?logo=slack)](https://join.slack.com/t/pycaret/shared_invite/zt-row9phbm-BoJdEVPYnGf7_NxNBP307w) |
+
+
 
 ![alt text](docs/images/quick_start.gif)
 
 <div align="left">
-  
+
 # Welcome to PyCaret
 PyCaret is an open-source, low-code machine learning library in Python that automates machine learning workflows. It is an end-to-end machine learning and model management tool that speeds up the experiment cycle exponentially and makes you more productive.
 
 In comparison with the other open-source machine learning libraries, PyCaret is an alternate low-code library that can be used to replace hundreds of lines of code with few lines only. This makes experiments exponentially fast and efficient. PyCaret is essentially a Python wrapper around several machine learning libraries and frameworks such as scikit-learn, XGBoost, LightGBM, CatBoost, Optuna, Hyperopt, Ray, and few more.
 
 The design and simplicity of PyCaret are inspired by the emerging role of citizen data scientists, a term first used by Gartner. Citizen Data Scientists are power users who can perform both simple and moderately sophisticated analytical tasks that would previously have required more technical expertise. PyCaret was inspired by the caret library in R programming language.
 
-| Important Links              |                                                                |
-| -------------------------- | -------------------------------------------------------------- |
-| :star: **[Tutorials]**        | New to PyCaret? Checkout our official notebooks!            |
-| :clipboard: **[Example Notebooks]** | Example notebooks created by community.               |
-| :orange_book: **[Official Blog]** | Tutorials and articles by contributors.                      |
-| :books: **[Documentation]**      | The detailed API docs of PyCaret                         |
-| :tv: **[Video Tutorials]**            | Our video tutorial from various events.             |
-| ✈️ **[Cheat sheet]**            | Cheat sheet for all functions across modules.             |
-| :loudspeaker: **[Discussions]**        | Have questions? Engage with community and contributors.|
-| :hammer_and_wrench: **[Changelog]**          | Changes and version history.                 |
-| :deciduous_tree: **[Roadmap]**          | PyCaret's software and community development plan.|
-  
-[tutorials]: https://pycaret.gitbook.io/docs/get-started/tutorials
-[Example notebooks]: https://github.com/pycaret/pycaret/tree/master/examples
-[Official Blog]: https://pycaret.gitbook.io/docs/learn-pycaret/official-blog
-[Documentation]: https://pycaret.gitbook.io
-[video tutorials]: https://pycaret.gitbook.io/docs/learn-pycaret/videos
-[Cheat sheet]: https://pycaret.gitbook.io/docs/learn-pycaret/cheat-sheet
-[Discussions]: https://github.com/pycaret/pycaret/discussions
-[changelog]: https://pycaret.gitbook.io/docs/get-started/release-notes
-[roadmap]: https://github.com/pycaret/pycaret/issues/1756
- 
-# Installation
+# 🚀 Installation
 
-PyCaret's default installation only installs hard dependencies as listed in the [requirements.txt](requirements.txt) file. 
+## 🌐 Option 1: Install via PyPi
+PyCaret is tested and supported on 64-bit systems with:
+- Python 3.7, 3.8, 3.9, and 3.10
+- Ubuntu 16.04 or later
+- Windows 7 or later
+
+You can install PyCaret with Python's pip package manager:
 
 ```python
+# install pycaret
 pip install pycaret
 ```
-To install the full version:
+
+PyCaret's default installation will not install all the optional dependencies automatically. Depending on the use case, you may be interested in one or more extras:
+
+```python
+# install analysis extras
+pip install pycaret[analysis]
+
+# models extras
+pip install pycaret[models]
+
+# install tuner extras
+pip install pycaret[tuner]
+
+# install mlops extras
+pip install pycaret[mlops]
+
+# install parallel extras
+pip install pycaret[parallel]
+
+# install test extras
+pip install pycaret[test]
+
+##
+
+# install multiple extras together
+pip install pycaret[analysis,models]
+```
+
+Check out all [optional dependencies](https://github.com/pycaret/pycaret/blob/master/requirements-optional.txt). If you want to install everything including all the optional dependencies:
 
 ```python
+# install full version
 pip install pycaret[full]
 ```
+## 📄 Option 2: Build from Source
+Install the development version of the library directly from the source. The API may be unstable. It is not recommended for production use.
+
+```python
+pip install git+https://github.com/pycaret/pycaret.git@master --upgrade
+```
+
+## 📦 Option 3: Docker
+Docker creates virtual environments with containers that keep a PyCaret installation separate from the rest of the system. PyCaret docker comes pre-installed with a Jupyter notebook. It can share resources with its host machine (access directories, use the GPU, connect to the Internet, etc.). The PyCaret Docker images are always tested for the latest major releases.
+
+```python
+# default version
+docker run -p 8888:8888 pycaret/slim
+
+# full version
+docker run -p 8888:8888 pycaret/full
+```
+
+## 🏃‍♂️ Quickstart
+
+### 1. Functional API
+```python
+# Classification Functional API Example
+
+# loading sample dataset
+from pycaret.datasets import get_data
+data = get_data('juice')
+
+# init setup
+from pycaret.classification import *
+s = setup(data, target = 'Purchase', session_id = 123)
+
+# model training and selection
+best = compare_models()
+
+# evaluate trained model
+evaluate_model(best)
+
+# predict on hold-out/test set
+pred_holdout = predict_model(best)
+
+# predict on new data
+new_data = data.copy().drop('Purchase', axis = 1)
+predictions = predict_model(best, data = new_data)
 
+# save model
+save_model(best, 'best_pipeline')
+```
+
+### 2. OOP API
+
+```python
+# Classification OOP API Example
+
+# loading sample dataset
+from pycaret.datasets import get_data
+data = get_data('juice')
+
+# init setup
+from pycaret.classification import ClassificationExperiment
+s = ClassificationExperiment()
+s.setup(data, target = 'Purchase', session_id = 123)
+
+# model training and selection
+best = s.compare_models()
+
+# evaluate trained model
+s.evaluate_model(best)
+
+# predict on hold-out/test set
+pred_holdout = s.predict_model(best)
+
+# predict on new data
+new_data = data.copy().drop('Purchase', axis = 1)
+predictions = s.predict_model(best, data = new_data)
+
+# save model
+s.save_model(best, 'best_pipeline')
+```
+
+
+## 📁 Modules
 <div align="center">
 
-# Supervised Workflow
-  
-  Classification           |  Regression
+## **Classification**
+
+  Functional API           |  OOP API
 :-------------------------:|:-------------------------:
-![](docs/images/pycaret_classification.png)  | ![](docs/images/pycaret_regression.png)
+![](docs/images/classification_functional.png)  | ![](docs/images/classification_OOP.png)
 
- # Unsupervised Workflow
-  
-  Clustering               |  Anomaly Detection
+## **Regression**
+
+  Functional API           |  OOP API
 :-------------------------:|:-------------------------:
-![](docs/images/pycaret_clustering.png)  |  ![](docs/images/pycaret_anomaly.png)  
-  
-<div align="left">
+![](docs/images/regression_functional.png)  | ![](docs/images/regression_OOP.png)
 
-# ⚡ PyCaret Time Series Module
-  
-PyCaret time series module is now available with the main pycaret installation. Staying true to simplicity of PyCaret, it is consistent with our existing API and fully loaded with functionalities. Statistical testing, model training and selection (30+ algorithms), model analysis, automated hyperparameter tuning, experiment logging, deployment on cloud, and more. All of this with only few lines of code (just like the other modules of pycaret). 
-  
-| Important Links              |                                                                |
-| -------------------------- | -------------------------------------------------------------- |
-| :star: **[Time Series Quickstart]**        | Get started with Time Series Analysis         |
-| :books: **[Time Series Notebooks]**        | New to Time Series? Checkout our official (detailed) notebooks!            |
-| :tv: **[Time Series Video Tutorials]**            | Our video tutorial from various events.             |
-| :question: **[Time Series FAQs]**        |   Have questions? Queck out the FAQ's     |
-| :hammer_and_wrench: **[Time Series API Interface]**        |   The detailed API interface for the Time Series Module          |
-| :deciduous_tree: **[Time Series Features and Roadmap]**          | PyCaret's software and community development plan.|
-
-[Time Series Quickstart]: https://pycaret.gitbook.io/docs/get-started/quickstart#time-series
-[Time Series Notebooks]: https://pycaret.gitbook.io/docs/get-started/tutorials
-[Time Series Video Tutorials]: https://pycaret.gitbook.io/docs/learn-pycaret/videos#pycaret-time-series-module
-[Time Series FAQs]: https://github.com/pycaret/pycaret/discussions/categories/faqs?discussions_q=category%3AFAQs+label%3Atime_series
-[Time Series API Interface]: https://pycaret.readthedocs.io/en/latest/api/time_series.html
-[Time Series Features and Roadmap]: https://github.com/pycaret/pycaret/issues/1648
-  
-# Installation
-  
- ```
- pip install --pre pycaret
- ```  
+## **Time Series**
+
+  Functional API           |  OOP API
+:-------------------------:|:-------------------------:
+![](docs/images/time_series_functional.png)  | ![](docs/images/time_series_OOP.png)
 
-![alt text](docs/images/pycaret_ts_quickdemo.gif)  
+## **Clustering**
 
-# Who should use PyCaret?
+  Functional API           |  OOP API
+:-------------------------:|:-------------------------:
+![](docs/images/clustering_functional.png)  | ![](docs/images/clustering_OOP.png)
+
+## **Anomaly Detection**
+
+  Functional API           |  OOP API
+:-------------------------:|:-------------------------:
+![](docs/images/anomaly_functional.png)  | ![](docs/images/anomaly_OOP.png)
+
+<div align="left">
+
+# 👥 Who should use PyCaret?
 PyCaret is an open source library that anybody can use. In our view the ideal target audience of PyCaret is: <br />
 
 - Experienced Data Scientists who want to increase productivity.
 - Citizen Data Scientists who prefer a low code machine learning solution.
 - Data Science Professionals who want to build rapid prototypes.
 - Data Science and Machine Learning students and enthusiasts.
-  
-# PyCaret GPU support
-With PyCaret >= 2.2, you can train models on GPU and speed up your workflow by 10x. To train models on GPU simply pass `use_gpu = True` in the setup function. There is no change in the use of the API, however, in some cases, additional libraries have to be installed as they are not installed with the default version or the full version. As of the latest release, the following models can be trained on GPU:
 
-- Extreme Gradient Boosting (requires no further installation)
-- CatBoost (requires no further installation)
+# 🎮 Training on GPUs
+To train models on the GPU, simply pass use_gpu = True in the setup function. There is no change in the use of the API; however, in some cases, additional libraries have to be installed. The following models can be trained on GPUs:
+
+- Extreme Gradient Boosting
+- CatBoost
 - Light Gradient Boosting Machine requires [GPU installation](https://lightgbm.readthedocs.io/en/latest/GPU-Tutorial.html)
 - Logistic Regression, Ridge Classifier, Random Forest, K Neighbors Classifier, K Neighbors Regressor, Support Vector Machine, Linear Regression, Ridge Regression, Lasso Regression requires [cuML >= 0.15](https://github.com/rapidsai/cuml)
 
-# PyCaret Intel sklearnex support
+# 🖥️ PyCaret Intel sklearnex support
 You can apply [Intel optimizations](https://github.com/intel/scikit-learn-intelex) for machine learning algorithms and speed up your workflow. To train models with Intel optimizations use `sklearnex` engine. There is no change in the use of the API, however, installation of Intel sklearnex is required:
 
-```pip install scikit-learn-intelex```
-
-# License
-PyCaret is completely free and open-source and licensed under the [MIT](https://github.com/pycaret/pycaret/blob/master/LICENSE) license. 
+```python
+pip install scikit-learn-intelex
+```
 
-# Contributors
+# 🤝 Contributors
 <a href="https://github.com/pycaret/pycaret/graphs/contributors">
-  <img src="https://contributors-img.web.app/image?repo=pycaret/pycaret" width = 500/>
+  <img src="https://contributors-img.web.app/image?repo=pycaret/pycaret" width = 800/>
 </a>
 
+# 📝 License
+PyCaret is completely free and open-source and licensed under the [MIT](https://github.com/pycaret/pycaret/blob/master/LICENSE) license.
+
+# ℹ️ More Information
+
+| Important Links              |            Description                                       |
+| -------------------------- | -------------------------------------------------------------- |
+| :star: **[Tutorials]**        | Tutorials developed and maintained by core developers       |
+| :clipboard: **[Example Notebooks]** | Example notebooks created by community               |
+| :orange_book: **[Blog]** | Official blog by creator of PyCaret                      |
+| :books: **[Documentation]**      | API docs                              |
+| :tv: **[Videos]**            | Video resources             |
+| ✈️ **[Cheat sheet]**            | Community Cheat sheet            |
+| :loudspeaker: **[Discussions]**        | Community Discussion board on GitHub|
+| :hammer_and_wrench: **[Release Notes]**          | Release Notes          |
+
+[tutorials]: https://pycaret.gitbook.io/docs/get-started/tutorials
+[Example notebooks]: https://github.com/pycaret/examples
+[Blog]: https://pycaret.gitbook.io/docs/learn-pycaret/official-blog
+[Documentation]: https://pycaret.gitbook.io/docs/
+[Videos]: https://pycaret.gitbook.io/docs/learn-pycaret/videos
+[Cheat sheet]: https://pycaret.gitbook.io/docs/learn-pycaret/cheat-sheet
+[Discussions]: https://github.com/pycaret/pycaret/discussions
+[Release Notes]: https://github.com/pycaret/pycaret/releases
+
```

## Comparing `pycaret-3.0.0rc9.dist-info/RECORD` & `pycaret-3.0.1.dist-info/RECORD`

 * *Files 7% similar despite different names*

```diff
@@ -1,113 +1,111 @@
-pycaret/__init__.py,sha256=wMFJkGLemm_O3q6Xl-9hlLr01IshDeIx6hnpUoW_ihI,665
-pycaret/datasets.py,sha256=tQxMZ5cBoD01Fttg1_75opVollKyujqZ0fx6fMHYaZE,4729
+pycaret/__init__.py,sha256=tttg9XMNmWmnrkGnpS4NRlRPadF593LDG1vLM_wBSCM,634
+pycaret/datasets.py,sha256=-ES0Its29g1RUAbP50qeY4aMZ8cqRx7IpzRWonnJyss,4728
 pycaret/distributions.py,sha256=VlhXMw6tOYRGLh0KUSXJn7q--3Zf2_tiM1gXJjW80RU,162
 pycaret/anomaly/__init__.py,sha256=OEe2CpJj_QhX8uHFMhGoBAPnWElokW6LCvvMdto7nqE,805
-pycaret/anomaly/functional.py,sha256=5rVSUmunFJk9gUZAjC_4GZCLtZQXuPqJc3_XSGeJHco,41436
+pycaret/anomaly/functional.py,sha256=4sWxlNKCoMlI3NZPgvE8nT2vCY0drwYneZCSdHLdMYc,41625
 pycaret/anomaly/oop.py,sha256=ftNZ0MUSO7dzjsgG1rt5eYToNJ9sg6HSb3Qs0HdUM74,5121
 pycaret/classification/__init__.py,sha256=ilUtYYnpTK7bSvEq2481GjrSApAhRMuUW5QLCYg8oic,1747
-pycaret/classification/functional.py,sha256=4HUTXVxeUJ1JP2QIEdI2-KY3gs9d2eDc7IQTc-mgbII,116237
-pycaret/classification/oop.py,sha256=TcD_flKHuMmoLTwPUTbVSH_ZQ2p-1q1vqxy5TDJ_iuU,130305
+pycaret/classification/functional.py,sha256=XbPwg5PwVmi4DviGe77opEoKHm8VTsBVcO6KiGqKVEE,116404
+pycaret/classification/oop.py,sha256=Jp9haOOGRpuxeOzIXQ203_bJcXFqQaglIr7lD1J9dN4,130585
 pycaret/clustering/__init__.py,sha256=c1p2J9NlWqdCcCAXNK7Ok27yjr0G5QPP_nKdelvA3Fo,1013
-pycaret/clustering/functional.py,sha256=woFGEGFxpxkoRU4t3w1xx_Q_b66b5E89bWlzC5eZtlc,46874
+pycaret/clustering/functional.py,sha256=d3UgMUBOdg79upiMgZu-IJPTheMyZEDG_7IVDCqe-30,46863
 pycaret/clustering/oop.py,sha256=L5NUbbPKoSlT5yycr6JinvinDVEFlMzzfnLNtkqqinw,10407
 pycaret/containers/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 pycaret/containers/base_container.py,sha256=-Jbf44ocowRP7npZVTdxF0PL_4x21etbpB7TnUvoXNI,3929
 pycaret/containers/metrics/__init__.py,sha256=NVjDXHFAplPNkBIRYenhNd7wVr8nUtHnkMnoEMqhnDI,465
-pycaret/containers/metrics/anomaly.py,sha256=m4qzui0nfXFj3TPxy1uvHxiFXW5wWB-XLpnYhg1LQz8,6391
+pycaret/containers/metrics/anomaly.py,sha256=zbAfcTinVblqkzAifZaLWMo1ynRVVPNptVORpWLuSms,6390
 pycaret/containers/metrics/base_metric.py,sha256=zua7bQC6DRtcoLS6dr0Dg0a1KhWK4SoGNyg0nD9uMws,3780
-pycaret/containers/metrics/classification.py,sha256=O0GHkKSb1yxH3Zuwnt_7OdVu0Cb5TG17yEVvOTzzRq4,10466
-pycaret/containers/metrics/clustering.py,sha256=A8_LsWr-Z4dUyDgKuPABhv8Jr1HJcidvTIjhbztSvkI,8111
-pycaret/containers/metrics/regression.py,sha256=F9R9KFP5sdYCo_3CDA5Z3PrG3qakZQP_A8F8_ctUN04,9483
-pycaret/containers/metrics/time_series.py,sha256=I4y-HJcXCdKDr-nrrZ2lVWNu43MCkEv1JSNroik9reM,11225
+pycaret/containers/metrics/classification.py,sha256=e8ta1j4yQ70OuG5kCvwfg-ctBfFucQGN5uuJ2KCky1k,10567
+pycaret/containers/metrics/clustering.py,sha256=pG502DenBldLhkR764QwDdZvXPa5H1ApjPrNTtONlgM,8110
+pycaret/containers/metrics/regression.py,sha256=Z1QWvPTjIxvSsv7B_IvOXUQHS_CZarb7PHPq4KVNqLk,9480
+pycaret/containers/metrics/time_series.py,sha256=cyfs_krowttCWnXOJ3B602D-GTGpatXvcStIa15UHZg,11222
 pycaret/containers/models/__init__.py,sha256=P8z6bpyTsSs731eGaNnazEKO-_uVG3GoiwWawOUVrIs,453
-pycaret/containers/models/anomaly.py,sha256=foHvRKwYl70U1zAh9D0UqdZy-Zqyzi4nSqVBJvUX1fg,13138
+pycaret/containers/models/anomaly.py,sha256=cyMPBOroU-OOpog9iPpidONvEYv0x_zN1WoAEN1ApHw,13053
 pycaret/containers/models/base_model.py,sha256=dHO9nobtr-rxFH4ibBB7i75jR6_LoL5U1OT32_Py54Q,7622
-pycaret/containers/models/classification.py,sha256=z6-UrXYJ76Jp4P_mY4WqoUMvPuQrwZxysPPtmNU_j1g,53330
-pycaret/containers/models/clustering.py,sha256=4CwI7v2-cjET-6-XeH9srmoJtIFt6_7pYEQ5rtfiXt0,14622
-pycaret/containers/models/regression.py,sha256=zf4iljxPmnliYszo9nNRgD4geC715OfIYcQfm6bJ2JY,62807
-pycaret/containers/models/time_series.py,sha256=WaHKRDYFqkYJB--bVoK_deAzefT9vaYKaNQKlzO0sS8,104790
+pycaret/containers/models/classification.py,sha256=Xdkbpn6VK7AeGZJ4neNThE3hJpToUKpCHZIepYopqNE,53230
+pycaret/containers/models/clustering.py,sha256=QUi5TUtL0XDK0RYaoWJgGliTDTWQZAmMd4UwbbkT3sk,14621
+pycaret/containers/models/regression.py,sha256=BynwbcP2VKP12SyI7dE02ntYlh5y5cFgcXaLNl5sbSY,62707
+pycaret/containers/models/time_series.py,sha256=Ll804Jdtv1lcZrFIvlYCF7L_yabFzFgim0e8nh_0mzY,106861
 pycaret/internal/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 pycaret/internal/cloudpickle_compat.py,sha256=kB13GLxfFdVXgdA1EHAn8k9NCG4WaQuBZlDWJNXhawM,385
-pycaret/internal/cuml_wrappers.py,sha256=uRDaDimsWGe6icTwOPAbztEXf4nVOn0UG8akN4pp7Y8,4271
+pycaret/internal/cuml_wrappers.py,sha256=blu6WfbJlrfz49hS051DarJKBYIVzbahvYZbhZN7vAA,4269
 pycaret/internal/distributions.py,sha256=X5FFQh1eZJjWEmaq1KoYy86tx_6MYKBWV-EKI9fmY1U,12818
-pycaret/internal/ensemble.py,sha256=kCnPSM261ODqNalqk_1KGOnnQ5bVcVSiShnbNli4jP0,4550
-pycaret/internal/logging.py,sha256=2WGu5n-dGO0bjPkzlelYptqoNBWJ7YcRACtOYj7XOSY,5533
-pycaret/internal/memory.py,sha256=vlEAhdO3San0CHRj2tHlIG8nI8cPjqAUlDIZMVJK8pg,15524
+pycaret/internal/logging.py,sha256=3Fu3dRm_r_dGMWPzAg1UuZgXaEOKxVMrVoeeoR_eFvE,6284
+pycaret/internal/memory.py,sha256=wFq52GSCMXpjJu_CS9Mk74n8ps7cd4V6zZXZPubl1-A,17163
 pycaret/internal/meta_estimators.py,sha256=phsAHqiBvKUIy74gpYU_NR63BmOuAoWf6Fe_89aLqpU,8211
-pycaret/internal/metrics.py,sha256=D0RRmoSe22WXvw1m4UEU5NXGCi0l2lTewe6WcyZ0hM0,8757
-pycaret/internal/persistence.py,sha256=gxZShnj5fH482gE4LDg3UjVrJPLbqzki4mCnEMhAdSo,25532
-pycaret/internal/pipeline.py,sha256=YUc0P3Z68WOklEXUChSF-IZmtqBL8vfPdXgKSO8S1tE,19970
+pycaret/internal/metrics.py,sha256=t8cF3Do3L-mLubEZkApnBM6AGkpDt4iOWda807dHnGA,10086
+pycaret/internal/persistence.py,sha256=KCGU1ArlJe75je_ad9o0KXlqnJl1jwIL-EkutcHFj5A,25541
+pycaret/internal/pipeline.py,sha256=R3zTrNW6SEl_pmn4KkDpHzNmGm-NtPnmqJcIMp40Hvg,20325
 pycaret/internal/tunable.py,sha256=dGBlafvfPFaRmDJo9sHW54x-hya6IMRRmVHXIIFRaYQ,45347
 pycaret/internal/validation.py,sha256=TGx-H1sYD-BqhD3QhiqTDVrR-2TXP9PB8ob2mOrlCfQ,1990
 pycaret/internal/display/__init__.py,sha256=rXlSlTvzx0-JB98iQFxB-qJ0gndYslUbQczCL_0iFsE,181
 pycaret/internal/display/display.py,sha256=niKCThQPDtCUX9VDZ2j026bsqA25KBdWIjPbsupOoW0,3375
 pycaret/internal/display/display_backend.py,sha256=PbThdx5BnteGTiQEJNe_Xiliv_7fqiW3-17AdkyS70c,5854
 pycaret/internal/display/display_component.py,sha256=QYcnycpgj1gPnHnKJCORSjIi90zrS6WEXWgPkVoAsy0,1632
 pycaret/internal/display/progress_bar.py,sha256=-5pZevGGdXtJ_cqBb9a1yaa6DVXoSIAUdHViOo7ueBw,4678
 pycaret/internal/parallel/__init__.py,sha256=dII-sTT-XHfE3Hx_NGQpokcHOGO3GbG8NTgmmH0QZmY,46
 pycaret/internal/parallel/parallel_backend.py,sha256=9nEyXfVWf79en-An6ZQ4nVnpsCjracqBmXKrybYnCB8,1468
 pycaret/internal/patches/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-pycaret/internal/patches/pyod.py,sha256=XDgv8HLV2o_ViC9SgZyUf3Omog-VUvH6q7UC4OILYXU,1201
 pycaret/internal/patches/sklearn.py,sha256=nFkc7KyZAzVSmEVsBgrZkFxgf8zFncISX-MS5YvDUpI,3239
 pycaret/internal/patches/yellowbrick.py,sha256=cjV4X_Yu7AYlnZ11fhqLC0PzimUf0Y2LU08106__O8U,392
 pycaret/internal/plots/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 pycaret/internal/plots/helper.py,sha256=WO2Q7gKxnX6YWNxMhuKnYEBfsmn-CjLXS3DPNPXKlPo,4956
 pycaret/internal/plots/residual_plots.py,sha256=Zo_-cnhbOGacMF7KOGxLO7WNS81vF2BJbOdAlXe7P5s,28091
-pycaret/internal/plots/time_series.py,sha256=_n39L3qDIVXurXB7-Kuhv6EkGVfRZXpJPTlTllYOvkU,46969
+pycaret/internal/plots/time_series.py,sha256=gNEvAbyyHr2L5n_PKrITs72R_vUVSo10mSyeFgpdico,46967
 pycaret/internal/plots/yellowbrick.py,sha256=1iMsv6ZM0DQp5GBkHq7iBCnsDDVTOoW70xrFYNZjDKM,3517
 pycaret/internal/plots/utils/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-pycaret/internal/plots/utils/time_series.py,sha256=8fOwTcAeb88D3yzmOG0hKZXY-cBXbqRHOyLya0JDd9k,39887
+pycaret/internal/plots/utils/time_series.py,sha256=2S2v6jId_oybpAYy7ti-YTQVGEo1HVyIVcvvaXQyFgU,39887
 pycaret/internal/preprocess/__init__.py,sha256=xORlfezSHrKZ-X-YKQjaYeMM9GHtBrzUMqZor6Pt7eI,258
 pycaret/internal/preprocess/iterative_imputer.py,sha256=r8licKvF9LbX-Bg7oItTZxj_lVvehdvYSeXqdY2qT8A,20788
-pycaret/internal/preprocess/preprocessor.py,sha256=aK-_sCO5zvtXe0RORmewR1DpUZ2ZaqmpxzpVuwxelGI,39411
-pycaret/internal/preprocess/transformers.py,sha256=WslltxQ_rNs9MwQBWBfxTE8T4tPJHugSvs8rjShl5NQ,21374
+pycaret/internal/preprocess/preprocessor.py,sha256=pWhbltMZTIBGXOP9aVMuaMun5MZ7z1lbfkx1z4uU8ww,39991
+pycaret/internal/preprocess/transformers.py,sha256=sre1ACVlRt_askc7Bk5IrvW90-5qzUKSXu113CyCXPc,21958
 pycaret/internal/preprocess/target/TransformedTargetClassifier.py,sha256=ahv3-E13ayWW7tkarnkc8uTfBBoHTcBYHilqwJImm3Y,6667
 pycaret/internal/preprocess/target/TransformedTargetRegressor.py,sha256=4OstkMklDZAuHuBp_mfc0tWtU50nQQ98W8Ly3tXgOHo,1189
 pycaret/internal/preprocess/target/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 pycaret/internal/preprocess/target/utils.py,sha256=pWkGVwLBBQQCKFGF905GJtw7QENKOsGIxIqG2Wxxa2k,2055
 pycaret/internal/preprocess/time_series/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 pycaret/internal/preprocess/time_series/forecasting/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 pycaret/internal/preprocess/time_series/forecasting/preprocessor.py,sha256=pFH3YjPp9a8OOpSjXp4tI-KpsAFWvrMosTPm60xI95Q,12435
 pycaret/internal/pycaret_experiment/__init__.py,sha256=AqSGshQ7FiLeDbYHSvi88F4L7ZKUuDbKq_GzfusUevg,316
-pycaret/internal/pycaret_experiment/non_ts_supervised_experiment.py,sha256=9Kd42RkD58a2gyP9cfW57dWtcnbhf_Q4yAlSOe2mSQ8,3131
-pycaret/internal/pycaret_experiment/pycaret_experiment.py,sha256=-T941L77zrYr08SbAvYQqm_wuGkTzaKOkCQ9_II01V0,18784
-pycaret/internal/pycaret_experiment/supervised_experiment.py,sha256=S-_1A_GSseQJPvK5br6fvQysGOR4NDbvlcSFKmppZ70,215837
-pycaret/internal/pycaret_experiment/tabular_experiment.py,sha256=8wKPtFW30wf9dJ3aR-yr7tgmA3xx2MUkp_ph8Nj559k,110937
+pycaret/internal/pycaret_experiment/non_ts_supervised_experiment.py,sha256=DX1EJ13SaYq7w84QAe8xc3KYlV65qiBeSiZ6N0yuZWo,3220
+pycaret/internal/pycaret_experiment/pycaret_experiment.py,sha256=5taWGvVia_g3xWLpKPNvYH-8hhKlirsshb9Tmjl6OHI,18945
+pycaret/internal/pycaret_experiment/supervised_experiment.py,sha256=zCRiGupQNqzHPVvf6ffHE3IYxIktnked8VoDi68XhFA,217220
+pycaret/internal/pycaret_experiment/tabular_experiment.py,sha256=gp5QK_5zrdE4gulNA_dKBLdyCwa4BIJB8oYludZys4k,110969
 pycaret/internal/pycaret_experiment/ts_supervised_experiment.py,sha256=X8op2OeEVi0Ujz90CcNyb2zaHuNmqr_y_jJg5rUBFuA,6873
-pycaret/internal/pycaret_experiment/unsupervised_experiment.py,sha256=cz1wSbdeGtCtms4sPU9vgDt7e64xBn-r4YchlFatFrI,52825
+pycaret/internal/pycaret_experiment/unsupervised_experiment.py,sha256=n59t3jmtM43l-_n3QD7HXAkAo06plXh8eKVtEhQpHiA,53024
 pycaret/internal/tests/__init__.py,sha256=N5QbV-Z1-5pxhN-BrynpyCEHN0-nFuNrdfrQCYd62z4,1340
-pycaret/internal/tests/stats.py,sha256=uCD9Q4B0f3rXmjvKx_j5_EYxmYWMOkThI1CdfOv93CQ,5820
-pycaret/internal/tests/time_series.py,sha256=GGDboK9csToG-z1o9cxekSp8EM4No_B7QO9eZ9KX39M,21686
+pycaret/internal/tests/stats.py,sha256=C7eMF1ZKmHiP00VB15e1M7zh7NygX9rBo8gkw2ISgbE,5840
+pycaret/internal/tests/time_series.py,sha256=KL2Qh3JK-A0BKrZ_AQBz5kAEZdMjtIq0ArhCgipbsLg,21716
 pycaret/loggers/__init__.py,sha256=-7Qi2CfkZGFzJJb0EaM2PMOudP_9re-g4SSipl9vRqs,375
-pycaret/loggers/base_logger.py,sha256=DNBB1IesVc--V8lN97kcN2n-XpFAnIw08cNGRaNINNQ,1009
-pycaret/loggers/comet_logger.py,sha256=STnRDwsbpdBqJHwntDsMbBOCGCWAn7f4P8-74a9sWo8,2417
+pycaret/loggers/base_logger.py,sha256=eRsBfr2DYkh3OmAkfOAH0KOHSRsySKvPfQyhc6Pz7JY,1485
+pycaret/loggers/comet_logger.py,sha256=XkitOSJ3eN_H4mjzCnRovqDw_09t4hqzJNVfgP7sAnY,2499
 pycaret/loggers/dagshub_logger.py,sha256=Z-Bq7LYsX1yZ7x3xySaBCj8o5UfbNS_NLuAdyGmEYW4,3846
 pycaret/loggers/dashboard_logger.py,sha256=TBUWZIPIrQAOoEWxosLnh22MKuTebluc5pU9Bzw3t9c,11906
-pycaret/loggers/mlflow_logger.py,sha256=udIFwyodDhJo5ez4N3LsFJUhMD6ZL6T-i7RKR7RzxTo,5505
-pycaret/loggers/wandb_logger.py,sha256=eTSFy8yxvqzduO0ydFdMlBl8vpWKNKsLSDgglYm7KM4,2740
+pycaret/loggers/mlflow_logger.py,sha256=wm7RXoEQO8Qo1nkczWi2izosJ1jnYYnXfnKgsEwy47U,5419
+pycaret/loggers/wandb_logger.py,sha256=N9XeiijYC_zsMMy-i3dxaBw2pqM9-H8nR0y_GnHTtwc,2717
 pycaret/parallel/__init__.py,sha256=zhmDoch5DgVYjFevdBE-cqM8PZ5miLDMq7p5Tpuu1VY,184
-pycaret/parallel/fugue_backend.py,sha256=36Fn-h-aCSGLxCBwg62K6cSagtfLFqGQ7XioRp86OMo,6932
+pycaret/parallel/fugue_backend.py,sha256=ztfN-5FrckAE8kunljMwXImFA5XNz5G-0ypQsgwDSJo,6965
 pycaret/regression/__init__.py,sha256=jBgJhDvgyeP2gb94qVk-ZN8S9r16sd4pixU-R0BPo6A,1637
-pycaret/regression/functional.py,sha256=i6JHEMPcp61YvX_9Et8EYtyjyrnDjgGucJj6goKlIII,105411
-pycaret/regression/oop.py,sha256=PeJTf9SiXQzD53Jy4ObR0vEgy0nCsgfiviRHmJuCjyQ,107182
+pycaret/regression/functional.py,sha256=rAcwT9HO2tBQBMp3fEFXpbXd_HKgEbZGPLMMRjJMXVc,105586
+pycaret/regression/oop.py,sha256=WkEK_vstlW4Ska9qpdvNHx7OFtWEZODReTMxCfE4uLU,107460
 pycaret/time_series/__init__.py,sha256=vCdnxHyG0nef3wDARrpE11ooYF9NhpjnL33Hayv3QJQ,1157
 pycaret/time_series/forecasting/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-pycaret/time_series/forecasting/functional.py,sha256=Pd2X2tNcDSF1HeC3RyNF8zP_Vm7q2B-n4FnV7zdiIuM,79820
-pycaret/time_series/forecasting/oop.py,sha256=bmUowDa0yXiPdi5ftSLTEKjBrStopZPlItv5VFjegHc,218772
-pycaret/utils/__init__.py,sha256=WoFRwo2iqx-K7yuxRv_8pnnAqOqsLxOi6mPC5gHNZ28,494
+pycaret/time_series/forecasting/functional.py,sha256=H5naFPFz7mrIdY4GCqff-VIFBelrsHOx39NGiGZkyN4,81666
+pycaret/time_series/forecasting/oop.py,sha256=tKmzQe8uKxauwrERfvNXDlXM7Xk_ws-PrkZApuPqqk4,225922
+pycaret/utils/__init__.py,sha256=28pekyiQihEipLnYM5m_e7L1RqkaRucXJVH_2B-BaWs,329
 pycaret/utils/_dependencies.py,sha256=NwiwjrsRKvxw9pdIHSMQpbnqS1G_mu0PjJm_fJ3O4ws,5418
 pycaret/utils/_show_versions.py,sha256=fPPjF-3TcLOqE_xZppy3CtltcFf6wc7HPjhqIbbG_lI,3719
 pycaret/utils/constants.py,sha256=O7DFn0_2HKGeOj_ax1TAq1IbXO9HlTbtpHfYzz68V-8,729
-pycaret/utils/datetime.py,sha256=RRQn1L9OS8K7D3h6TPgZ8w-cImbvXKpupr-2DXkOFxY,4281
-pycaret/utils/generic.py,sha256=M6pW93ocwbR43P70I4sZd1LtwjXaZMtjrGp0IDLpfcU,36408
-pycaret/utils/time_series/__init__.py,sha256=pQ5IYm8YwqrP7ZoxyLrc7p6hnV-_zIjgEYREDdZpeeM,15785
+pycaret/utils/datetime.py,sha256=VHZ9fM1QIggCDPwo_vqlciaDyP84YHHYkUJKEkAsrd8,4315
+pycaret/utils/generic.py,sha256=xj1x_yj78ScvqCy506yJuDLx-F4diiCAGGjswLk-Gao,36571
+pycaret/utils/time_series/__init__.py,sha256=UTTMg6ybn83vqC8sQxDvmJG4KT8QveqJ14TnneROrmE,18663
 pycaret/utils/time_series/exceptions.py,sha256=z-GT69lcNVJV3cYX3tFW7pi9JeT2kKarNX9TZcoPWuk,129
 pycaret/utils/time_series/forecasting/__init__.py,sha256=Fi9C4d9WN91Es0ZZAOI1gLCvcCwcJl_zpuJ4Abf-TfY,6813
-pycaret/utils/time_series/forecasting/model_selection.py,sha256=V-mNZaGVfQ9ZBe6ErSEFj4qSmCrwFC5rEdSf5-5mcVg,27871
+pycaret/utils/time_series/forecasting/model_selection.py,sha256=yGrD0KD2t2P4xWPFp2e6Mh7aECe2F7SB_JGZgX1LKR0,27874
 pycaret/utils/time_series/forecasting/models.py,sha256=lJ9K0FDHDRS1-3-KatMPRgG_qkE1oxvKlU6Suymx8bs,4817
 pycaret/utils/time_series/forecasting/pipeline.py,sha256=Bue2iESwqBd1ruKtaG5-k99MS1V3cKlvdVqy17Ffsr4,9372
-pycaret-3.0.0rc9.dist-info/LICENSE,sha256=dA2DJH3KUlICbkqA-wSp5Edmt2GUXEfQaK7qqZtgf1k,1085
-pycaret-3.0.0rc9.dist-info/METADATA,sha256=YSPptZUVypemVGQiaFkQetWBYFz8hwCR7Li2uC9LtA8,15832
-pycaret-3.0.0rc9.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
-pycaret-3.0.0rc9.dist-info/top_level.txt,sha256=j0FvMjIfC1u7otX8fR5JwH5G5ra54yHcm2QsOSudXJQ,8
-pycaret-3.0.0rc9.dist-info/RECORD,,
+pycaret-3.0.1.dist-info/LICENSE,sha256=dA2DJH3KUlICbkqA-wSp5Edmt2GUXEfQaK7qqZtgf1k,1085
+pycaret-3.0.1.dist-info/METADATA,sha256=mWipOQS23oo4rFGjk3y4cIG6ZZC0tpZY51looRVQTdw,16960
+pycaret-3.0.1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+pycaret-3.0.1.dist-info/top_level.txt,sha256=j0FvMjIfC1u7otX8fR5JwH5G5ra54yHcm2QsOSudXJQ,8
+pycaret-3.0.1.dist-info/RECORD,,
```

